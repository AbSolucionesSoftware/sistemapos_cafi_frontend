(this.webpackJsonpsistemapos_cafi_frontend=this.webpackJsonpsistemapos_cafi_frontend||[]).push([[0],{682:function(e,t){},684:function(e,t){},695:function(e,t){},697:function(e,t){},724:function(e,t){},726:function(e,t){},727:function(e,t){},732:function(e,t){},734:function(e,t){},740:function(e,t){},742:function(e,t){},761:function(e,t){},773:function(e,t){},776:function(e,t){},808:function(e,t,a){},809:function(e,t,a){"use strict";a.r(t);var n,c,r,i,o,s,l=a(2),d=a.n(l),j=a(53),u=a.n(j),b=a(3),p=a(946),m=a(943),O=a(945),x=a(126),h=a(62),_=a(10),f=a(13),g=a(4),v=a(7),C=a.n(v),y=a(864),S=a(95),F=a(865),w=a(868),I=a(869),k=a(861),z=a(863),N=a(16),P=a(166),D=Object(P.d)(n||(n=Object(N.a)(["\n\tmutation crearUsuario($input: CrearUsuarioInput) {\n\t\tcrearUsuario(input: $input) {\n\t\t\t_id\n\t\t\tnumero_usuario\n\t\t\tnombre\n\t\t\ttelefono\n\t\t\tcelular\n\t\t\temail\n\t\t\tturno_en_caja_activo\n\t\t\tdireccion {\n\t\t\t\tcalle\n\t\t\t\tno_ext\n\t\t\t\tno_int\n\t\t\t\tcodigo_postal\n\t\t\t\tcolonia\n\t\t\t\tmunicipio\n\t\t\t\tlocalidad\n\t\t\t\testado\n\t\t\t\tpais\n\t\t\t}\n\t\t\timagen\n\t\t\testado_usuario\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t\taccesos {\n\t\t\t\tmi_empresa {\n\t\t\t\t\tdatos_empresa {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tinformacion_fiscal {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcompras {\n\t\t\t\t\tabrir_compra {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcompras_realizadas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcompras_espera {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttesoreria {\n\t\t\t\t\tcuentas_empresa {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tegresos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tabonos_proveedores {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tabonos_clientes {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treportes {\n\t\t\t\t\treporte_historial_cajas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_turnos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_compras {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_ventas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\trerporte_almacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_corte_caja {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_tesoreria {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tventas {\n\t\t\t\t\tcancelar_venta {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tprecios_productos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tpre_corte {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcotizaciones {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tadministrador {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\teliminar_ventas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tproducto_rapido {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfacturacion {\n\t\t\t\t\tgenerar_cdfi {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcdfi_realizados {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tregistro_series_cdfi {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\talmacenes {\n\t\t\t\t\talmacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\ttraspasos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tinventario_almacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcatalogos {\n\t\t\t\t\tclientes {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tusuarios {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tproductos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tmarcas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcontabilidad {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tprovedores {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcajas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tdepartamentos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcentro_costos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tconceptos_almacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcategorias {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcolores {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcolores {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\ttallas_numeros {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"]))),E=Object(P.d)(c||(c=Object(N.a)(["\n\tquery obtenerUsuarios($sucursal: String!, $filtro: String) {\n\t\tobtenerUsuarios(sucursal: $sucursal, filtro: $filtro) {\n\t\t\t_id\n\t\t\tnumero_usuario\n\t\t\tnombre\n\t\t\ttelefono\n\t\t\tcelular\n\t\t\tturno_en_caja_activo\n\t\t\temail\n\t\t\tdireccion {\n\t\t\t\tcalle\n\t\t\t\tno_ext\n\t\t\t\tno_int\n\t\t\t\tcodigo_postal\n\t\t\t\tcolonia\n\t\t\t\tmunicipio\n\t\t\t\tlocalidad\n\t\t\t\testado\n\t\t\t\tpais\n\t\t\t}\n\t\t\timagen\n\t\t\testado_usuario\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t\taccesos {\n\t\t\t\tmi_empresa {\n\t\t\t\t\tdatos_empresa {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tinformacion_fiscal {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcompras {\n\t\t\t\t\tabrir_compra {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcompras_realizadas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcompras_espera {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttesoreria {\n\t\t\t\t\tcuentas_empresa {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tegresos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tabonos_proveedores {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tabonos_clientes {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treportes {\n\t\t\t\t\treporte_historial_cajas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_turnos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_compras {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_ventas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\trerporte_almacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_corte_caja {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_tesoreria {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tventas {\n\t\t\t\t\tcancelar_venta {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tprecios_productos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tpre_corte {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcotizaciones {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tadministrador {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\teliminar_ventas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tproducto_rapido {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\talmacenes {\n\t\t\t\t\talmacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\ttraspasos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tinventario_almacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfacturacion {\n\t\t\t\t\tgenerar_cdfi {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcdfi_realizados {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tregistro_series_cdfi {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcatalogos {\n\t\t\t\t\tclientes {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tusuarios {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tproductos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tmarcas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcontabilidad {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tprovedores {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcajas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tdepartamentos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcentro_costos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tconceptos_almacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcategorias {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcolores {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\ttallas_numeros {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"]))),A=Object(P.d)(r||(r=Object(N.a)(["\n\tmutation actualizarUsuario($input: ActualizarUsuarioInput, $id: ID!) {\n\t\tactualizarUsuario(id: $id, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),T=Object(P.d)(i||(i=Object(N.a)(["\n\tmutation logearUsuario($input: LogearUsuarioInput) {\n\t\tlogearUsuario(input: $input) {\n\t\t\ttoken\n\t\t}\n\t}\n"]))),W=Object(P.d)(o||(o=Object(N.a)(["\n\tquery ObtenerAccesoPermiso($input: ObtenerAccesoPermisosInput) {\n\t\tobtenerAccesoPermiso(input: $input) {\n\t\t\tpermiso_concedido\n\t\t\tdepartamento\n        \tsubDepartamento\n\t\t}\n\t}\t\t\n"]))),$=(Object(P.d)(s||(s=Object(N.a)(["\n\tmutation asignarAccesosUsuario($input: CrearArregloDeAccesosInput, $id: ID!) {\n\t\tasignarAccesosUsuario(id: $id, input: $input) {\n\t\t\tmessage\n\t\t}\n}\n"]))),a(810)),R=a(954),V=a(452),M=a.n(V),L=a(453),U=a.n(L),B=a(0),q=Object(k.a)((function(e){return{snack:{zIndex:"".concat(99999,"!important")}}}));function J(e){var t=e.alert,a=e.setAlert,n=q();return Object(B.jsx)($.a,{children:Object(B.jsx)(R.a,{className:n.snack,anchorOrigin:{vertical:"top",horizontal:"center"},open:t.open,onClose:function(){a({open:!1,status:t.status,message:""})},autoHideDuration:3e3,message:Object(B.jsxs)(p.a,{display:"flex",children:["success"===t.status?Object(B.jsx)(M.a,{style:{color:"#22bb33"}}):Object(B.jsx)(U.a,{style:{color:"red"}}),Object(B.jsx)(p.a,{mr:1}),Object(B.jsx)(S.a,{children:t.message})]})})})}var G=a(454),H=a(819),Y=a(827),K=a(826),Q=a(867),X=a(494),Z=a(129),ee=a.n(Z),te=a(156),ae=a.n(te),ne=Object(k.a)((function(e){return{margin:{marginTop:e.spacing(2),marginBottom:e.spacing(2)},containerImagen:{maxWidth:170,maxHeight:170},imagen:{width:"100%",height:"100%"}}}));var ce={receta_farmacia:!1,clave_producto_sat:{Name:"",Value:""}},re={monedero:!1,monedero_electronico:0,iva_activo:!0,ieps_activo:!1,ieps:0,iva:16,granel:!1,inventario:{inventario_minimo:0,inventario_maximo:0,unidad_de_inventario:"Pz",codigo_unidad:"H87"},precio_de_compra:{precio_con_impuesto:0,precio_sin_impuesto:0,iva:0,ieps:0},unidad_de_compra:{unidad:"Pz",codigo_unidad:"H87",cantidad:1,precio_unitario_sin_impuesto:0,precio_unitario_con_impuesto:0}},ie={codigo_barras:"",unidad:"Pz",codigo_unidad:"H87",cantidad:1,precio:0,descuento_activo:null,precio_unidad:{numero_precio:0,precio_neto:0,precio_venta:0,unidad_mayoreo:0,iva_precio:0,ieps_precio:0,utilidad:0,precio_general:0,cantidad_unidad:0,unidad_maxima:!1},unidad_principal:!0,default:!0},oe={codigo_barras:"",unidad:"Caja",codigo_unidad:"XBX",cantidad:1,precio:0,descuento_activo:null,precio_unidad:{numero_precio:0,precio_neto:0,precio_venta:0,unidad_mayoreo:0,iva_precio:0,ieps_precio:0,utilidad:0,precio_general:0,cantidad_unidad:0,unidad_maxima:!1},unidad_principal:!1,default:!1},se=[{numero_precio:1,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:2,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:3,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:4,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:5,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:6,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0}],le=[],de={id_almacen:"",almacen:"",cantidad:0,fecha_de_expiracion:""},je={},ue={precio_piezas:[],precio_cajas:[],precio_costales:[]},be=[],pe=[],me=[],Oe={index:"",image:""},xe={error:!1,message:""},he=[],_e=[],fe=Object(l.createContext)(),ge=function(e){var t=e.children,a=Object(l.useState)(ce),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(re),o=Object(g.a)(i,2),s=o[0],j=o[1],u=Object(l.useState)(ie),b=Object(g.a)(u,2),p=b[0],m=b[1],O=Object(l.useState)(oe),x=Object(g.a)(O,2),h=x[0],_=x[1],f=Object(l.useState)(se),v=Object(g.a)(f,2),C=v[0],y=v[1],S=Object(l.useState)(le),F=Object(g.a)(S,2),w=F[0],I=F[1],k=Object(l.useState)(de),z=Object(g.a)(k,2),N=z[0],P=z[1],D=Object(l.useState)(je),E=Object(g.a)(D,2),A=E[0],T=E[1],W=Object(l.useState)(ue),$=Object(g.a)(W,2),R=$[0],V=$[1],M=Object(l.useState)(be),L=Object(g.a)(M,2),U=L[0],q=L[1],J=Object(l.useState)(pe),G=Object(g.a)(J,2),H=G[0],Y=G[1],K=Object(l.useState)(me),Q=Object(g.a)(K,2),X=Q[0],Z=Q[1],ee=Object(l.useState)(Oe),te=Object(g.a)(ee,2),ae=te[0],ne=te[1],ge=Object(l.useState)(xe),ve=Object(g.a)(ge,2),Ce=ve[0],ye=ve[1],Se=Object(l.useState)(he),Fe=Object(g.a)(Se,2),we=Fe[0],Ie=Fe[1],ke=Object(l.useState)(null),ze=Object(g.a)(ke,2),Ne=ze[0],Pe=ze[1],De=Object(l.useState)(!1),Ee=Object(g.a)(De,2),Ae=Ee[0],Te=Ee[1],We=Object(l.useState)(_e),$e=Object(g.a)(We,2),Re=$e[0],Ve=$e[1],Me=Object(l.useState)([]),Le=Object(g.a)(Me,2),Ue=Le[0],Be=Le[1],qe=d.a.useState(!1),Je=Object(g.a)(qe,2),Ge=Je[0],He=Je[1],Ye=Object(l.useState)({message:"",status:"",open:!1}),Ke=Object(g.a)(Ye,2),Qe=Ke[0],Xe=Ke[1],Ze=Object(l.useState)([]),et=Object(g.a)(Ze,2),tt=et[0],at=et[1],nt=Object(l.useState)([]),ct=Object(g.a)(nt,2),rt=ct[0],it=ct[1],ot=Object(l.useState)([]),st=Object(g.a)(ot,2),lt=st[0],dt=st[1],jt=Object(l.useState)([]),ut=Object(g.a)(jt,2),bt=ut[0],pt=ut[1],mt=Object(l.useState)(!1),Ot=Object(g.a)(mt,2),xt=Ot[0],ht=Ot[1];return Object(B.jsx)(fe.Provider,{value:{datos_generales:c,setDatosGenerales:r,precios:s,setPrecios:j,almacen_inicial:N,setAlmacenInicial:P,imagenes:H,setImagenes:Y,imagenes_eliminadas:X,setImagenesEliminadas:Z,onPreview:ae,setOnPreview:ne,validacion:Ce,setValidacion:ye,preciosP:C,setPreciosP:y,preciosPlazos:R,setPreciosPlazos:V,unidadesVenta:w,setUnidadesVenta:I,centro_de_costos:A,setCentroDeCostos:T,unidadVentaXDefecto:p,setUnidadVentaXDefecto:m,subcategorias:U,setSubcategorias:q,subcostos:we,setSubcostos:Ie,selectedDate:Ne,setSelectedDate:Pe,update:Ae,setUpdate:Te,presentaciones:Re,setPresentaciones:Ve,presentaciones_eliminadas:Ue,setPresentacionesEliminadas:Be,actualizarLista:Ge,setActualizarLista:He,alert:Qe,setAlert:Xe,datosPreciosProducto:tt,setDatosPreciosProducto:at,preciosDescuentos:rt,setPreciosDescuentos:it,preciosProductos:lt,setPreciosProductos:dt,datosEnDescuentos:bt,setDatosEnDescuentos:pt,almacen_existente:xt,setAlmacenExistente:ht,unidadVentaSecundaria:h,setUnidadVentaSecundaria:_},children:t})},ve=a(9),Ce=a(456),ye=a.n(Ce),Se=a(69),Fe=a(27),we=a(889),Ie=a(888),ke=a(948),ze=a(890),Ne=Object(l.createContext)(),Pe=function(e){var t=e.children,a=Object(l.useState)({nombre_empresa:"",nombre_dueno:"",telefono_dueno:"",celular:"",correo_empresa:"",nombre_fiscal:"",rfc:"",regimen_fiscal:"",curp:"",info_adicio:"",direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},direccionFiscal:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},datosBancarios:{cuenta:"",sucursal:"",clave_banco:""},imagen:null}),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)({error:!1,message:""}),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1];return Object(B.jsx)(Ne.Provider,{value:{empresa:c,setEmpresa:r,toUpdate:s,setToUpdate:d,error:b,setError:p,update:x,setUpdate:h},children:t})},De=a(887),Ee=a(875),Ae=a(877),Te=a(18),We=a.n(Te),$e=a(870),Re=a(956),Ve=a(871),Me=a(951),Le=a(872),Ue=a(873),Be=a(143),qe=a(458),Je=a(821),Ge=Object(k.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff",backgroundColor:"rgba(0, 0, 0, 0.3)"}}}));function He(e){var t=e.loading,a=(e.setLoading,Ge());return Object(B.jsx)("div",{children:Object(B.jsx)(Je.a,{className:a.backdrop,open:t,children:Object(B.jsx)(I.a,{color:"inherit"})})})}var Ye,Ke,Qe=a(457),Xe=a.n(Qe);function Ze(e){e.error;var t=e.altura;return t||(t=400),Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:t,children:[Object(B.jsx)(Xe.a,{style:{fontSize:100,color:"rgba(17,85,204, 0.7)"}}),Object(B.jsx)(S.a,{align:"center",style:{fontSize:18,color:"rgba(17,85,204)"},children:"Hubo un problema"})]})}var et=Object(P.d)(Ye||(Ye=Object(N.a)(["\n  query obtenerEmpresa($id: ID!) {\n    obtenerEmpresa(id: $id) {\n      _id\n      nombre_empresa\n      nombre_dueno\n      telefono_dueno\n      celular\n      correo_empresa\n      limite_timbres\n      timbres_usados\n      sello_sat\n      nombre_cer\n      nombre_key\n      imagen\n      nombre_fiscal\n      rfc\n      regimen_fiscal\n      curp\n      info_adicio\n      valor_puntos\n      direccion {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      direccionFiscal {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      datosBancarios {\n        cuenta\n        sucursal\n        clave_banco\n      }\n      vender_sin_inventario\n    }\n  }\n"]))),tt=Object(P.d)(Ke||(Ke=Object(N.a)(["\n  mutation actualizarEmpresa($id: ID!, $input: EditarEmpresa) {\n    actualizarEmpresa(id: $id, input: $input) {\n      _id\n      nombre_empresa\n      nombre_dueno\n      telefono_dueno\n      celular\n      correo_empresa\n      limite_timbres\n      timbres_usados\n      sello_sat\n      nombre_cer\n      nombre_key\n      imagen\n      nombre_fiscal\n      rfc\n      regimen_fiscal\n      curp\n      info_adicio\n      valor_puntos\n      direccion {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      direccionFiscal {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      datosBancarios {\n        cuenta\n        sucursal\n        clave_banco\n      }\n    }\n  }\n"]))),at=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},subtitle:{marginLeft:"10px",width:"100%"},require:{"& .requerido":{color:"red"}},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:"150px",height:"150px",border:"dashed 2px black",borderRadius:"100%"},avatar:{width:"90%",height:"90%","& > .icon":{fontSize:100}}}}));function nt(e){var t=JSON.parse(localStorage.getItem("sesionCafi")),a=at(),n=d.a.useState(!1),c=Object(g.a)(n,2),r=c[0],i=c[1],o=Object(l.useState)(!1===t.accesos.mi_empresa.datos_empresa.editar),s=Object(g.a)(o,1)[0],j=Object(l.useState)(""),u=Object(g.a)(j,2),m=u[0],O=u[1],x=d.a.useState(!1),h=Object(g.a)(x,2),v=h[0],I=h[1],k=d.a.useState(Object(l.useState)({error:!1,message:""})),N=Object(g.a)(k,2),P=N[0],D=N[1],E=Object(l.useState)({message:"",status:"",open:!1}),A=Object(g.a)(E,2),T=A[0],W=A[1],$=Object(l.useContext)(Ne),R=$.empresa,V=$.update,M=$.setEmpresa,L=$.setUpdate,U=Object(z.a)(tt),q=Object(g.a)(U,1)[0],G=Object(qe.a)(et,{variables:{id:t.empresa._id}}),H=G.loading,Y=G.data,K=G.refetch,Q=G.error,X=Object(l.useState)({nombre_empresa:"",nombre_dueno:"",telefono_dueno:"",celular:"",correo_empresa:"",valor_puntos:"",nombre_fiscal:"",rfc:"",regimen_fiscal:"",curp:"",info_adicio:"",direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},direccionFiscal:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},datosBancarios:{cuenta:"",sucursal:"",clave_banco:""},imagen:null,vender_sin_inventario:!1}),Z=Object(g.a)(X,2),ee=Z[0],te=Z[1];Object(l.useEffect)((function(){try{K()}catch(e){}}),[V,K]),Object(l.useEffect)((function(){try{i(H)}catch(e){}}),[H]),Object(l.useEffect)((function(){try{void 0!==Y&&M(Y.obtenerEmpresa)}catch(e){}}),[Y,M]),Object(l.useEffect)((function(){try{I(Q)}catch(e){}}),[Q]),Object(l.useEffect)((function(){try{te({nombre_empresa:R.nombre_empresa,nombre_dueno:R.nombre_dueno,telefono_dueno:R.telefono_dueno,celular:R.celular,valor_puntos:R.valor_puntos,correo_empresa:R.correo_empresa,direccion:R.direccion,imagen:R.imagen,vender_sin_inventario:R.vender_sin_inventario})}catch(e){}}),[R]);var ae=function(){var e=Object(f.a)(C.a.mark((function e(){var a,n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i(!0),e.next=4,q({variables:{id:t.empresa._id,input:ee}});case 4:a=Object(b.a)(Object(b.a)({},t.empresa),ee),(n=Object(b.a)({},t)).empresa=a,localStorage.setItem("sesionCafi",JSON.stringify(n)),L(!0),i(!1),W({message:"Se han actualizado correctamente los datos.",status:"success",open:!0}),D(!1),e.next=20;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors),W({message:"Hubo un error",status:"error",open:!0}),i(!1);case 20:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}(),ne=function(e){try{var t=e.target.value;"valor_puntos"===e.target.name&&(t=parseFloat(t)),te(Object(b.a)(Object(b.a)({},ee),{},Object(_.a)({},e.target.name,t)))}catch(Q){}},ce=function(e){te(Object(b.a)(Object(b.a)({},ee),{},{direccion:Object(b.a)(Object(b.a)({},ee.direccion),{},Object(_.a)({},e.target.name,e.target.value))}))},re=Object(l.useCallback)((function(e){var t=new FileReader;t.readAsDataURL(e[0]),t.onload=function(){var e=t.result;O(e)},te(Object(b.a)(Object(b.a)({},ee),{},{imagen:e[0]}))}),[ee,te]),ie=Object(Be.a)({accept:"image/jpeg, image/png",noKeyboard:!0,onDrop:re}),oe=ie.getRootProps,se=ie.getInputProps;return Object(B.jsxs)("div",{children:[Object(B.jsx)(J,{alert:T,setAlert:W}),Object(B.jsx)(He,{loading:r,setLoading:i}),v?Object(B.jsx)(Ze,{error:v}):Object(B.jsxs)(y.a,{style:{marginTop:8},children:[Object(B.jsxs)($e.a,{container:!0,spacing:3,className:a.require,children:[Object(B.jsx)($e.a,{item:!0,md:2,xs:12,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:Object(B.jsxs)(p.a,Object(b.a)(Object(b.a)({className:a.avatarContainer},oe()),{},{children:[Object(B.jsx)("input",Object(b.a)({},se())),m?Object(B.jsx)(Re.a,{className:a.avatar,src:"".concat(m)}):Object(B.jsx)(Re.a,{className:a.avatar,src:"".concat(R.imagen)})]}))}),Object(B.jsxs)($e.a,{item:!0,md:5,xs:12,className:a.require,children:[Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsxs)("b",{children:[Object(B.jsx)("span",{className:"requerido",children:"* "}),"Nombre de empresa"]})}),Object(B.jsx)(F.a,{fullWidth:!0,disabled:s,type:"text",size:"small",error:P.error&&!ee.nombre_empresa,name:"nombre_empresa",variant:"outlined",value:ee.nombre_empresa?ee.nombre_empresa:"",helperText:P.error&&"El campo nombre es obligatorio"!==P.message?P.message:"",onChange:ne})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsxs)("b",{children:[Object(B.jsx)("span",{className:"requerido",children:"* "}),"Nombre due\xf1o"]})}),Object(B.jsx)(F.a,{fullWidth:!0,disabled:s,type:"text",size:"small",error:P.error&&!ee.nombre_dueno,name:"nombre_dueno",variant:"outlined",value:ee.nombre_dueno?ee.nombre_dueno:"",helperText:P.error&&"El campo nombre es obligatorio"!==P.message?P.message:"",onChange:ne})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Tel\xe9fono"})}),Object(B.jsx)(F.a,{fullWidth:!0,disabled:s,size:"small",name:"telefono_dueno",variant:"outlined",value:ee.telefono_dueno?ee.telefono_dueno:"",onChange:ne})]})]}),Object(B.jsxs)($e.a,{item:!0,md:5,xs:12,children:[Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Celular"})}),Object(B.jsx)(F.a,{fullWidth:!0,disabled:s,size:"small",name:"celular",variant:"outlined",value:ee.celular?ee.celular:"",onChange:ne})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"E-mail"})}),Object(B.jsx)(F.a,{fullWidth:!0,disabled:s,size:"small",name:"correo_empresa",variant:"outlined",value:ee.correo_empresa?ee.correo_empresa:"",onChange:ne})]}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:4,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Valor de puntos"})}),Object(B.jsx)(F.a,{inputMode:"numeric",type:"number",disabled:s,size:"small",name:"valor_puntos",variant:"outlined",value:ee.valor_puntos?ee.valor_puntos:"",onChange:ne})]}),Object(B.jsx)($e.a,{item:!0,md:8,style:{display:"flex",alignItems:"center"},children:Object(B.jsx)(Ve.a,{control:Object(B.jsx)(Me.a,{disabled:s,checked:ee.vender_sin_inventario,onChange:function(e){te(Object(b.a)(Object(b.a)({},ee),{},{vender_sin_inventario:e.target.checked}))},name:"checkedA"}),label:"Vender productos sin inventario"})})]})})]})]}),Object(B.jsxs)(p.a,{mt:3,mb:2,children:[Object(B.jsx)(S.a,{className:a.subtitle,children:Object(B.jsx)("b",{children:"Domicilio empresa"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:3,className:a.require,children:[Object(B.jsxs)($e.a,{item:!0,md:4,children:[Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Calle"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"calle",variant:"outlined",disabled:s,value:ee.direccion.calle?ee.direccion.calle:"",onChange:ce})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Num. Ext"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"no_ext",variant:"outlined",disabled:s,value:ee.direccion.no_ext?ee.direccion.no_ext:"",onChange:ce})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Num. Int"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"no_int",variant:"outlined",disabled:s,value:ee.direccion.no_int?ee.direccion.no_int:"",onChange:ce})]})]}),Object(B.jsxs)($e.a,{item:!0,md:4,children:[Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"C.P."})," "]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"codigo_postal",variant:"outlined",disabled:s,value:ee.direccion.codigo_postal?ee.direccion.codigo_postal:"",onChange:ce})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Colonia"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"colonia",variant:"outlined",disabled:s,value:ee.direccion.colonia?ee.direccion.colonia:"",onChange:ce})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Municipio"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"municipio",variant:"outlined",disabled:s,value:ee.direccion.municipio?ee.direccion.municipio:"",onChange:ce})]})]}),Object(B.jsxs)($e.a,{item:!0,md:4,children:[Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Localidad"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"localidad",variant:"outlined",disabled:s,value:ee.direccion.localidad?ee.direccion.localidad:"",onChange:ce})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Estado"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"estado",variant:"outlined",disabled:s,value:ee.direccion.estado?ee.direccion.estado:"",onChange:ce})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Pais"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"pais",variant:"outlined",disabled:s,value:ee.direccion.pais?ee.direccion.pais:"",onChange:ce})]})]})]}),!1===t.accesos.mi_empresa.datos_empresa.editar?null:Object(B.jsxs)(Ue.a,{style:{marginTop:15,width:"100%",justifyContent:"center"},children:[Object(B.jsx)(w.a,{onClick:function(){e.setOpen(!1)},color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{onClick:function(){return ae()},color:"primary",variant:"contained",children:"Guardar"})]})]})]})}var ct,rt,it,ot,st,lt,dt,jt,ut,bt,pt,mt=a(824),Ot=a(885),xt=a(14),ht=a.n(xt),_t=[{Value:"G01",Name:"Adquisici\xf3n de mercanc\xedas"},{Value:"G02",Name:"Devoluciones, descuentos o bonificaciones"},{Value:"G03",Name:"Gastos en general"},{Value:"I01",Name:"Construcciones"},{Value:"I02",Name:"Mobiliario y equipo de oficina por inversiones"},{Value:"I03",Name:"Equipo de transporte"},{Value:"I04",Name:"Equipo de c\xf3mputo y accesorios"},{Value:"I05",Name:"Dados, troqueles, moldes, matrices y herramental"},{Value:"I06",Name:"Comunicaciones telef\xf3nicas"},{Value:"I07",Name:"Comunicaciones satelitales"},{Value:"I08",Name:"Otra maquinaria y equipo"},{Value:"D01",Name:"Honorarios m\xe9dicos, dentales y gastos hospitalarios"},{Value:"D02",Name:"Gastos m\xe9dicos por incapacidad o discapacidad"},{Value:"D03",Name:"Gastos funerales."},{Value:"D04",Name:"Donativos"},{Value:"D05",Name:"Intereses reales efectivamente pagados por cr\xe9ditos hipotecarios (casa habitaci\xf3n)."},{Value:"D06",Name:"Aportaciones voluntarias al SAR."},{Value:"D07",Name:"Primas por seguros de gastos m\xe9dicos."},{Value:"D08",Name:"Gastos de transportaci\xf3n escolar obligatoria."},{Value:"D09",Name:"Dep\xf3sitos en cuentas para el ahorro, primas que tengan como base planes de pensiones."},{Value:"D10",Name:"Pagos por servicios educativos (colegiaturas)"},{Value:"P01",Name:"Por definir"}],ft=[{NameId:1,Name:"Factura",Value:"I"},{NameId:2,Name:"Nota de Cr\xe9dito",Value:"E"},{NameId:14,Name:"Complemento de pago",Value:"P"}],gt=[{Value:"MXN",Name:"Peso Mexicano"},{Value:"EUR",Name:"Euro"},{Value:"USD",Name:"Dolar Americano"}],vt=[{Name:"Efectivo",Value:"01"},{Name:"Cheque nominativo",Value:"02"},{Name:"Transferencia electr\xf3nica de fondos",Value:"03"},{Name:"Tarjeta de cr\xe9dito",Value:"04"},{Name:"Monedero electr\xf3nico",Value:"05"},{Name:"Dinero electr\xf3nico",Value:"06"},{Name:"Vales de despensa",Value:"08"},{Name:"Tarjeta de d\xe9bito",Value:"28"},{Name:"Aplicaci\xf3n de anticipos",Value:"30"},{Name:"Por definir",Value:"99"}],Ct=[{Value:"PPD",Name:"Pago en parcialidades \xf3 diferido"},{Value:"PUE",Name:"Pago en una sola exhibici\xf3n"}],yt=[{Natural:!1,Moral:!0,Name:"General de Ley Personas Morales",Value:"601"},{Natural:!1,Moral:!0,Name:"Personas Morales con Fines no Lucrativos",Value:"603"},{Natural:!0,Moral:!1,Name:"Sueldos y Salarios e Ingresos Asimilados a Salarios",Value:"605"},{Natural:!0,Moral:!1,Name:"Arrendamiento",Value:"606"},{Natural:!1,Moral:!0,Name:"R\xe9gimen de Enajenaci\xf3n o Adquisici\xf3n de Bienes",Value:"607"},{Natural:!0,Moral:!1,Name:"Dem\xe1s ingresos",Value:"608"},{Natural:!0,Moral:!0,Name:"Residentes en el Extranjero sin Establecimiento Permanente en M\xe9xico",Value:"610"},{Natural:!0,Moral:!1,Name:"Ingresos por Dividendos (socios y accionistas)",Value:"611"},{Natural:!0,Moral:!1,Name:"Personas F\xedsicas con Actividades Empresariales y Profesionales",Value:"612"},{Natural:!0,Moral:!1,Name:"Ingresos por intereses",Value:"614"},{Natural:!0,Moral:!1,Name:"R\xe9gimen de los ingresos por obtenci\xf3n de premios",Value:"615"},{Natural:!0,Moral:!1,Name:"Sin obligaciones fiscales",Value:"616"},{Natural:!1,Moral:!0,Name:"Sociedades Cooperativas de Producci\xf3n que optan por diferir sus ingresos",Value:"620"},{Natural:!0,Moral:!1,Name:"Incorporaci\xf3n Fiscal",Value:"621"},{Natural:!0,Moral:!0,Name:"Actividades Agr\xedcolas, Ganaderas, Silv\xedcolas y Pesqueras",Value:"622"},{Natural:!1,Moral:!0,Name:"Opcional para Grupos de Sociedades",Value:"623"},{Natural:!1,Moral:!0,Name:"Coordinados",Value:"624"},{Natural:!0,Moral:!1,Name:"R\xe9gimen de las Actividades Empresariales con ingresos a trav\xe9s de Plataformas Tecnol\xf3gicas",Value:"625"},{Natural:!1,Moral:!0,Name:"Hidrocarburos",Value:"628"},{Natural:!0,Moral:!1,Name:"De los Reg\xedmenes Fiscales Preferentes y de las Empresas Multinacionales",Value:"629"},{Natural:!0,Moral:!1,Name:"Enajenaci\xf3n de acciones en bolsa de valores",Value:"630"}],St=a(950),Ft=a(886),wt=a(876),It=a(874),kt=a(878),zt=a(879),Nt=a(880),Pt=a(881),Dt=a(882),Et=Object(P.d)(ct||(ct=Object(N.a)(["\n  mutation crearFactura($input: CrearFacturaInput) {\n    crearFactura(input: $input) {\n      message\n      success\n      pdf\n      xml\n    }\n  }\n"]))),At=Object(P.d)(rt||(rt=Object(N.a)(["\n  mutation crearSerieCFDI($input: CrearSerieCfdiInput!) {\n    crearSerieCFDI(input: $input) {\n      message\n      success\n    }\n  }\n"]))),Tt=Object(P.d)(it||(it=Object(N.a)(["\n  mutation modificarDefaultSerie($id: ID!, $empresa: ID!, $sucursal: ID!) {\n    modificarDefaultSerie(id: $id, empresa: $empresa, sucursal: $sucursal) {\n      message\n    }\n  }\n"]))),Wt=Object(P.d)(ot||(ot=Object(N.a)(["\n  mutation eliminarSerie($id: ID!) {\n    eliminarSerie(id: $id) {\n      message\n    }\n  }\n"]))),$t=Object(P.d)(st||(st=Object(N.a)(["\n  query obtenerSeriesCdfi($empresa: ID!, $sucursal: ID!) {\n    obtenerSeriesCdfi(empresa: $empresa, sucursal: $sucursal) {\n      message\n      success\n      seriesCfdi {\n        _id\n        serie\n        folio\n        default\n      }\n    }\n  }\n"]))),Rt=Object(P.d)(lt||(lt=Object(N.a)(["\n  mutation crearCSDS($input: CrearCSDSInput!) {\n    crearCSDS(input: $input) {\n      message\n      success\n    }\n  }\n"]))),Vt=Object(P.d)(dt||(dt=Object(N.a)(["\n  mutation eliminarCSD($rfc: String, $empresa: ID!) {\n    eliminarCSD(rfc: $rfc, empresa: $empresa) {\n      message\n    }\n  }\n"])));Object(P.d)(jt||(jt=Object(N.a)(["\n  query obtenerCatalogosSAT($input: CrearFacturaInput!) {\n    obtenerCatalogosSAT(input: $input) {\n      message\n      currencies {\n        Decimals\n        PrecisionRate\n        Name\n        Value\n      }\n      paymentForms {\n        Name\n        Value\n      }\n      paymentMethods {\n        Name\n        Value\n      }\n      fiscalRegimens {\n        Natural\n        Moral\n        Name\n        Value\n      }\n      cfdiTypes {\n        NameId\n        Name\n        Value\n      }\n    }\n  }\n"]))),Object(P.d)(ut||(ut=Object(N.a)(["\n  query obtenerProductosOServicios($input: CrearFacturaInput!) {\n    obtenerProductosOServicios(input: $input) {\n      message\n      productosOServicios {\n        DangerousMaterial\n        Complement\n        Name\n        Value\n      }\n    }\n  }\n"]))),Object(P.d)(bt||(bt=Object(N.a)(["\n  query obtenerCodigoPostal($input: CrearFacturaInput!) {\n    obtenerCodigoPostal(input: $input) {\n      message\n      codigoPostal {\n        StateCode\n        MunicipalityCode\n        LocationCode\n        Name\n        Value\n      }\n    }\n  }\n"]))),Object(P.d)(pt||(pt=Object(N.a)(["\n  query obtenerCfdiUses($input: CrearFacturaInput!) {\n    obtenerCfdiUses(input: $input) {\n      message\n      cfdiUses {\n        message\n        Natural\n        Moral\n        Name\n        Value\n      }\n    }\n  }\n"])));function Mt(e){var t=e.datosEmpresa,a=e.firma_disabled,n=e.refetch,c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(l.useState)(!1),i=Object(g.a)(r,2),o=i[0],s=i[1],d=Object(l.useState)({certificate:"",private_key:"",private_key_password:"",rfc:c&&t.rfc?t.rfc:"",empresa:c&&c.empresa._id?c.empresa._id:"",sucursal:c&&c.sucursal._id?c.sucursal._id:""}),j=Object(g.a)(d,2),u=j[0],m=j[1],O=Object(l.useState)(!1),x=Object(g.a)(O,2),h=x[0],v=x[1],y=Object(l.useState)(!1),k=Object(g.a)(y,2),N=k[0],P=k[1],D=Object(l.useState)({message:"",status:"",open:!1}),E=Object(g.a)(D,2),A=E[0],T=E[1],W=function(){s(!1),m({certificate:"",private_key:"",private_key_password:"",rfc:c&&t.rfc?t.rfc:"",empresa:c&&c.empresa._id?c.empresa._id:"",sucursal:c&&c.sucursal._id?c.sucursal._id:""})},$=Object(z.a)(Rt),R=Object(g.a)($,1)[0],V=function(e){var t=e.target,a=t.name,n=t.files;m(Object(b.a)(Object(b.a)({},u),{},Object(_.a)({},a,n[0])))},M=function(e){return new Promise((function(t){var a="",n=new FileReader;n.readAsDataURL(e),n.onload=function(){a=n.result,t(a)}}))},L=function(){var e=Object(f.a)(C.a.mark((function e(){var t,a,c,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.certificate&&u.private_key&&u.private_key_password&&u.rfc){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t=Object(b.a)({},u),a=t.certificate,c=t.private_key,e.next=8,M(a).then((function(e){var n=e.split(",");t.certificate=n[1],t.nombre_cer=a.name})).catch((function(e){console.log(e)}));case 8:return e.next=10,M(c).then((function(e){var a=e.split(",");t.private_key=a[1],t.nombre_key=c.name})).catch((function(e){console.log(e)}));case 10:return P(!0),e.next=13,R({variables:{input:{certificate:t.certificate,private_key:t.private_key,private_key_password:t.private_key_password,rfc:t.rfc,empresa:t.empresa,sucursal:t.sucursal,nombre_cer:t.nombre_cer,nombre_key:t.nombre_key}}});case 13:r=e.sent,T({message:"\xa1Listo! ".concat(r.data.crearCSDS.message),status:"success",open:!0}),P(!1),W(),n(),e.next=26;break;case 20:e.prev=20,e.t0=e.catch(2),P(!1),T({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 26:case"end":return e.stop()}}),e,null,[[2,20]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(J,{alert:A,setAlert:T}),Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{onClick:function(){return s(!0)},color:"inherit",startIcon:Object(B.jsx)(It.a,{}),disabled:a,children:"Agregar CSD"})}),Object(B.jsxs)(Ee.a,{maxWidth:"xs",fullWidth:!0,open:o,onClose:function(){return W()},children:[Object(B.jsx)(wt.a,{children:"Registrar firma digital"}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(p.a,{mb:2,children:t.rfc?Object(B.jsx)(S.a,{children:"RFC: ".concat(t.rfc)}):Object(B.jsx)(S.a,{color:"error",children:"*No tienes registrado un RFC"})}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsxs)(S.a,{children:["Archivo *.cer ",Object(B.jsx)("b",{children:"Certificado de la firma Digital"})]}),Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(F.a,{fullWidth:!0,value:u.certificate?u.certificate.name:"",size:"small",variant:"outlined",InputProps:{endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)("label",{htmlFor:"archivo-cer-sello-digital",children:Object(B.jsx)(w.a,{startIcon:Object(B.jsx)(kt.a,{}),color:"primary",component:"span",disableElevation:!0,children:"Upload"})})}),readOnly:!0}}),Object(B.jsx)("input",{accept:".cer",style:{display:"none"},id:"archivo-cer-sello-digital",multiple:!0,type:"file",name:"certificate",onChange:V})]})]}),Object(B.jsxs)(p.a,{width:"100%",mt:2,children:[Object(B.jsxs)(S.a,{children:["Archivo *.key ",Object(B.jsx)("b",{children:"Llave Privada de la Firma Digital"})]}),Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(F.a,{fullWidth:!0,value:u.private_key?u.private_key.name:"",size:"small",variant:"outlined",InputProps:{endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)("label",{htmlFor:"archivo-key-llave_privada",children:Object(B.jsx)(w.a,{startIcon:Object(B.jsx)(kt.a,{}),color:"primary",component:"span",disableElevation:!0,children:"Upload"})})}),readOnly:!0}}),Object(B.jsx)("input",{accept:".key",style:{display:"none"},id:"archivo-key-llave_privada",multiple:!0,type:"file",name:"private_key",onChange:V})]})]}),Object(B.jsxs)(p.a,{width:"100%",my:2,children:[Object(B.jsxs)(S.a,{children:["Contrase\xf1a de la llave ",Object(B.jsx)("b",{children:"Privada de la Firma Digital"})]}),Object(B.jsx)(p.a,{display:"flex",alignItems:"center",children:Object(B.jsx)(F.a,{fullWidth:!0,type:h?"text":"password",size:"small",variant:"outlined",name:"private_key_password",onChange:function(e){m(Object(b.a)(Object(b.a)({},u),{},{private_key_password:e.target.value}))},InputProps:{endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(X.a,{onClick:function(){return v(!h)},onMouseDown:function(e){return e.preventDefault()},edge:"end",children:h?Object(B.jsx)(zt.a,{}):Object(B.jsx)(Nt.a,{})})})}})})]})]}),Object(B.jsxs)(Ue.a,{style:{justifyContent:"center"},children:[Object(B.jsx)(w.a,{startIcon:Object(B.jsx)(Pt.a,{}),size:"large",onClick:function(){return W()},children:"Cancelar"}),Object(B.jsx)(w.a,{startIcon:N?Object(B.jsx)(I.a,{size:20}):Object(B.jsx)(Dt.a,{}),color:"primary",size:"large",onClick:function(){return L()},disabled:N||!u.rfc,children:"Guardar"})]})]})]})}var Lt=a(884),Ut=a(883);function Bt(e){var t=e.datosEmpresa,a=e.refetch,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)({rfc:t&&t.rfc?t.rfc:"",empresa:n&&n.empresa._id?n.empresa._id:""}),d=Object(g.a)(s,2),j=d[0],u=d[1],b=Object(l.useState)(!1),m=Object(g.a)(b,2),O=m[0],x=m[1],h=Object(l.useState)({message:"",status:"",open:!1}),_=Object(g.a)(h,2),v=_[0],y=_[1],S=function(){o(!1),u({rfc:n&&t.rfc?t.rfc:"",empresa:n&&n.empresa._id?n.empresa._id:""})},F=Object(z.a)(Vt),k=Object(g.a)(F,1)[0],N=function(){var e=Object(f.a)(C.a.mark((function e(){var t;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j.rfc){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,x(!0),e.next=6,k({variables:{rfc:j.rfc,empresa:j.empresa}});case 6:t=e.sent,y({message:"\xa1Listo! ".concat(t.data.eliminarCSD.message),status:"success",open:!0}),x(!1),S(),a(),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(2),x(!1),y({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 19:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(J,{alert:v,setAlert:y}),Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{onClick:function(){return o(!0)},color:"inherit",startIcon:Object(B.jsx)(Ut.a,{}),children:"Remover CSD"})}),Object(B.jsxs)(Ee.a,{maxWidth:"xs",fullWidth:!0,open:i,onClose:function(){return S()},children:[Object(B.jsx)(wt.a,{children:"Eliminar Firma Digital"}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(Lt.a,{children:"Se eliminara el CSD registrado con el RFC ".concat(t.rfc)})}),Object(B.jsxs)(Ue.a,{style:{justifyContent:"center"},children:[Object(B.jsx)(w.a,{startIcon:Object(B.jsx)(Pt.a,{}),size:"large",onClick:function(){return S()},children:"Cancelar"}),Object(B.jsx)(w.a,{startIcon:O?Object(B.jsx)(I.a,{size:20}):Object(B.jsx)(Ut.a,{}),color:"secondary",size:"large",onClick:function(){return N()},disabled:O||!j.rfc,children:"Eliminar"})]})]})]})}var qt=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},subtitle:{marginLeft:"10px",width:"100%"},require:{"& span":{color:"red"}}}}));function Jt(e){var t=qt(),a=d.a.useState(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=d.a.useState(!1),o=Object(g.a)(i,2),s=o[0],j=o[1],u=d.a.useState(Object(l.useState)({error:!1,message:""})),m=Object(g.a)(u,2),O=m[0],x=m[1],h=Object(l.useState)({message:"",status:"",open:!1}),v=Object(g.a)(h,2),I=v[0],k=v[1],N=JSON.parse(localStorage.getItem("sesionCafi")),P=Object(l.useState)(!1===N.accesos.mi_empresa.informacion_fiscal.editar),D=Object(g.a)(P,1)[0],E=Object(l.useContext)(Ne),A=E.empresa,T=E.setEmpresa,W=Object(z.a)(tt),$=Object(g.a)(W,1)[0],R=Object(l.useState)(!1),V=Object(g.a)(R,2),M=V[0],L=V[1],U=Object(l.useState)({nombre_fiscal:"",rfc:"",curp:"",info_adicio:"",regimen_fiscal:"",direccionFiscal:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},datosBancarios:{cuenta:"",sucursal:"",clave_banco:""}}),q=Object(g.a)(U,2),G=q[0],Y=q[1],K=Object(qe.a)(et,{variables:{id:N.empresa._id}}),Q=K.loading,X=K.data,Z=K.refetch,ee=K.error;Object(l.useEffect)((function(){try{j(ee)}catch(e){}}),[ee]),Object(l.useEffect)((function(){try{if(void 0!==X){T(X.obtenerEmpresa);var e=N;e.empresa=X.obtenerEmpresa,localStorage.setItem("sesionCafi",JSON.stringify(e)),X.obtenerEmpresa.rfc?L(!1):L(!0)}}catch(t){}}),[X,T,N]),Object(l.useEffect)((function(){try{j(ee)}catch(e){}}),[ee]),Object(l.useEffect)((function(){try{r(Q)}catch(e){}}),[Q]),Object(l.useEffect)((function(){try{Y({nombre_fiscal:A.nombre_fiscal,rfc:A.rfc,curp:A.curp,info_adicio:A.info_adicio,regimen_fiscal:A.regimen_fiscal,sello_sat:A.sello_sat,nombre_cer:A.nombre_cer,nombre_key:A.nombre_key,limite_timbres:A.limite_timbres,timbres_usados:A.timbres_usados,direccionFiscal:{calle:A.direccionFiscal.calle,no_ext:A.direccionFiscal.no_ext,no_int:A.direccionFiscal.no_int,codigo_postal:A.direccionFiscal.codigo_postal,colonia:A.direccionFiscal.colonia,municipio:A.direccionFiscal.municipio,localidad:A.direccionFiscal.localidad,estado:A.direccionFiscal.estado,pais:A.direccionFiscal.pais},datosBancarios:{cuenta:A.datosBancarios.cuenta,sucursal:A.datosBancarios.sucursal,clave_banco:A.datosBancarios.clave_banco}})}catch(e){}}),[A]);var te=function(){var e=Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),e.next=4,$({variables:{id:N.empresa._id,input:G}});case 4:r(!1),k({message:"Se han actualizado correctamente los datos.",status:"success",open:!0}),x(!1),Z(),e.next=16;break;case 10:e.prev=10,e.t0=e.catch(0),r(!1),k({message:"Hubo un error",status:"error",open:!0}),console.log(e.t0),e.t0.response?console.log(e.t0.response):e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 16:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),ae=function(e){Y(Object(b.a)(Object(b.a)({},G),{},Object(_.a)({},e.target.name,e.target.value)))},ne=function(e){Y(Object(b.a)(Object(b.a)({},G),{},{direccionFiscal:Object(b.a)(Object(b.a)({},G.direccionFiscal),{},Object(_.a)({},e.target.name,e.target.value))}))},ce=function(e){Y(Object(b.a)(Object(b.a)({},G),{},{datosBancarios:Object(b.a)(Object(b.a)({},G.datosBancarios),{},Object(_.a)({},e.target.name,e.target.value))}))};return Object(B.jsxs)("div",{children:[Object(B.jsx)(J,{alert:I,setAlert:k}),Object(B.jsx)(He,{loading:c,setLoading:r}),s?Object(B.jsx)(Ze,{error:s}):Object(B.jsxs)(y.a,{children:[Object(B.jsxs)($e.a,{container:!0,spacing:1,children:[Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,className:t.require,children:[Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsxs)("b",{children:[" ",Object(B.jsx)("span",{children:"* "}),"Nombre fiscal"]})}),Object(B.jsx)(F.a,{fullWidth:!0,disabled:D,type:"text",size:"small",error:O.error&&!G.nombre_fiscal,name:"nombre_fiscal",variant:"outlined",value:G.nombre_fiscal?G.nombre_fiscal:"",helperText:O.error&&"El campo nombre es obligatorio"!==O.message?O.message:"",onChange:ae})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"RFC"})}),Object(B.jsx)(F.a,{fullWidth:!0,disabled:D,size:"small",name:"rfc",variant:"outlined",value:G.rfc?G.rfc:"",onChange:ae})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:"R\xe9gimen fiscal"}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",name:"regimen_fiscal",children:Object(B.jsxs)(mt.a,{value:G.regimen_fiscal?G.regimen_fiscal:"",name:"regimen_fiscal",onChange:ae,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),yt.map((function(e,t){return Object(B.jsx)(Ot.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]})})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"CURP"})}),Object(B.jsx)(F.a,{disabled:D,fullWidth:!0,size:"small",name:"curp",variant:"outlined",value:G.curp?G.curp:"",onChange:ae})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Info. Adicional"})}),Object(B.jsx)(F.a,{disabled:D,fullWidth:!0,size:"small",name:"info_adicio",variant:"outlined",value:G.info_adicio?G.info_adicio:"",onChange:ae,multiline:!0})]})]}),Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsx)(S.a,{className:t.subtitle,children:Object(B.jsx)("b",{children:"Firma digital"})}),Object(B.jsx)(Le.a,{}),Object(B.jsx)(p.a,{m:1,children:!0===G.sello_sat?Object(B.jsx)(St.a,{severity:"success",action:Object(B.jsx)(Bt,{firma_disabled:M,datosEmpresa:G,refetch:Z}),children:Object(B.jsx)(Ft.a,{children:"Firma Digital Activa"})}):Object(B.jsxs)(St.a,{severity:"info",action:Object(B.jsx)(Mt,{firma_disabled:M,datosEmpresa:G,refetch:Z}),children:[Object(B.jsx)(Ft.a,{children:"Sin Firma Digital"}),"Sin esta firma no prodr\xe1s realizar facturas",M?Object(B.jsx)("li",{children:"Necesitas tener un RFC registrado"}):null]})}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Archivo *.cer"})}),Object(B.jsx)(F.a,{disabled:!0,fullWidth:!0,size:"small",variant:"outlined"})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Archivo *.key"})}),Object(B.jsx)(F.a,{disabled:!0,fullWidth:!0,size:"small",variant:"outlined"})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Fecha de registro"})}),Object(B.jsx)(F.a,{disabled:!0,fullWidth:!0,size:"small",variant:"outlined"})]})]})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{className:t.subtitle,children:Object(B.jsx)("b",{children:"Domicilio"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,xs:12,sm:4,children:[Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Calle"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"calle",variant:"outlined",disabled:D,value:G.direccionFiscal.calle?G.direccionFiscal.calle:"",onChange:ne})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Num. Ext"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"no_ext",variant:"outlined",disabled:D,value:G.direccionFiscal.no_ext?G.direccionFiscal.no_ext:"",onChange:ne})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Num. Int"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"no_int",variant:"outlined",disabled:D,value:G.direccionFiscal.no_int?G.direccionFiscal.no_int:"",onChange:ne})]})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,sm:4,children:[Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"C.P."})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"codigo_postal",variant:"outlined",disabled:D,value:G.direccionFiscal.codigo_postal?G.direccionFiscal.codigo_postal:"",onChange:ne})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Colonia"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"colonia",variant:"outlined",disabled:D,value:G.direccionFiscal.colonia?G.direccionFiscal.colonia:"",onChange:ne})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Municipio"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"municipio",variant:"outlined",disabled:D,value:G.direccionFiscal.municipio?G.direccionFiscal.municipio:"",onChange:ne})]})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,sm:4,children:[Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Localidad"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"localidad",variant:"outlined",disabled:D,value:G.direccionFiscal.localidad?G.direccionFiscal.localidad:"",onChange:ne})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Estado"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"estado",variant:"outlined",disabled:D,value:G.direccionFiscal.estado?G.direccionFiscal.estado:"",onChange:ne})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Pais"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"pais",variant:"outlined",disabled:D,value:G.direccionFiscal.pais?G.direccionFiscal.pais:"",onChange:ne})]})]})]}),Object(B.jsxs)(p.a,{mt:1,children:[Object(B.jsx)(S.a,{className:t.subtitle,children:Object(B.jsx)("b",{children:"Datos bancarios"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,xs:12,md:4,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Cuenta"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"cuenta",variant:"outlined",disabled:D,value:G.datosBancarios.cuenta?G.datosBancarios.cuenta:"",onChange:ce})]})}),Object(B.jsx)($e.a,{item:!0,xs:12,md:4,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Sucursal"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"sucursal",variant:"outlined",disabled:D,value:G.datosBancarios.sucursal?G.datosBancarios.sucursal:"",onChange:ce})]})}),Object(B.jsx)($e.a,{item:!0,xs:12,md:4,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Clave de banco"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"clave_banco",variant:"outlined",disabled:D,value:G.datosBancarios.clave_banco?G.datosBancarios.clave_banco:"",onChange:ce})]})})]}),!1===N.accesos.mi_empresa.informacion_fiscal.editar?null:Object(B.jsxs)(Ue.a,{m:2,style:{marginTop:10,width:"100%",justifyContent:"center"},children:[Object(B.jsx)(w.a,{onClick:function(){e.setOpen(!1)},color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{onClick:function(){return te()},color:"primary",variant:"contained",children:"Guardar"})]})]})]})}var Gt,Ht,Yt,Kt,Qt,Xt=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},subtitle:{marginLeft:"10px",width:"100%"},require:{"& span":{color:"red"}},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",border:"dashed 2px black",borderRadius:"100%"},avatar:{width:"90%",height:"90%","& > .icon":{fontSize:100}}}})),Zt=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function ea(){var e=Xt(),t=Object(l.useState)(0),a=Object(g.a)(t,2),n=a[0],c=a[1],r=Object(l.useState)(!1),i=Object(g.a)(r,2),o=i[0],s=i[1],d=function(){s(!1)},j=function(){return 1===n?Object(B.jsx)(Jt,{setOpen:s}):Object(B.jsx)(nt,{setOpen:s})};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){s(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Fe.j,{className:e.icon})}),"Datos de empresa"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:o,onClose:d,TransitionComponent:Zt,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Datos"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:d,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsx)(p.a,{children:Object(B.jsxs)(ke.a,{indicatorColor:"primary",value:n,onChange:function(e,t){c(t)},"aria-label":"simple tabs example",centered:!0,children:[Object(B.jsx)(ze.a,{label:"Datos empresa",value:0}),Object(B.jsx)(ze.a,{label:"Datos fiscales",value:1})]})}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(j,{})})]})]})}var ta=Object(P.d)(Gt||(Gt=Object(N.a)(["\n    query ObtenerSucursalesEmpresa($id: ID!){\n        obtenerSucursalesEmpresa(id: $id){\n            _id\n            nombre_sucursal\n            descripcion\n            usuario_sucursal\n            direccion{\n                calle\n                no_ext\n                no_int\n                codigo_postal\n                colonia\n                municipio\n                localidad\n                estado\n                pais\n            }\n            cuenta_sucursal {\n                dinero_actual\n            }         \n        }\n    }\n"]))),aa=Object(P.d)(Ht||(Ht=Object(N.a)(["\n    query obtenerDatosSucursal($id: ID!){\n        obtenerDatosSucursal(id: $id){\n            _id\n            nombre_sucursal\n            descripcion\n            usuario_sucursal\n            direccion{\n                calle\n                no_ext\n                no_int\n                codigo_postal\n                colonia\n                municipio\n                localidad\n                estado\n                pais\n            }\n            cuenta_sucursal {\n                dinero_actual\n            }         \n        }\n    }\n"]))),na=Object(P.d)(Yt||(Yt=Object(N.a)(["\n  mutation editarSucursal($id: ID!, $input: EditarSucursal) {\n    editarSucursal(id: $id, input: $input) {\n         _id\n            nombre_sucursal\n            descripcion\n            usuario_sucursal\n            direccion{\n                calle\n                no_ext\n                no_int\n                codigo_postal\n                colonia\n                municipio\n                localidad\n                estado\n                pais\n            }\n            cuenta_sucursal {\n                dinero_actual\n            }         \n        }\n    }\n"]))),ca=Object(P.d)(Kt||(Kt=Object(N.a)(["\n    mutation CrearMovimientoCuenta($input: CrearMovimientoCuentaInput, $empresa: ID!, $sucursal: ID!, $tipo: Boolean){\n        crearMovimientoCuenta(input: $input, empresa: $empresa, sucursal: $sucursal, tipo: $tipo){\n            message\n        }\n    }\n"]))),ra=Object(P.d)(Qt||(Qt=Object(N.a)(["\n    query ObtenerHistorialCuenta($empresa: ID!, $sucursal: ID!, $input: ObtenerHistorialCuenta, $tipo: Boolean){\n        obtenerHistorialCuenta(empresa: $empresa, sucursal: $sucursal, input: $input, tipo: $tipo){\n            tipo_movimiento\n            id_usuario\n            numero_caja\n            id_Caja\n            numero_usuario_creador\n            nombre_usuario_creador\n            horario_turno\n            concepto\n            comentarios\n            montos_en_caja { \n                monto_efectivo{\n                    monto \n                }\n            }\n            fecha_movimiento{\n                completa\n            }\n            empresa\n            sucursal             \n        }\n    }\n"]))),ia=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},subtitle:{marginLeft:"10px",width:"100%"},require:{"& span":{color:"red"}},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",border:"dashed 2px black",borderRadius:"100%"},avatar:{width:"90%",height:"90%","& > .icon":{fontSize:100}}}})),oa=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function sa(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=ia(),a=d.a.useState(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(!1===e.accesos.mi_empresa.datos_empresa.editar),o=Object(g.a)(i,1)[0],s=Object(l.useState)(""),j=Object(g.a)(s,2),u=(j[0],j[1]),m=d.a.useState(!1),O=Object(g.a)(m,2),x=O[0],h=O[1],v=d.a.useState(!1),I=Object(g.a)(v,2),k=I[0],N=I[1],P=d.a.useState(Object(l.useState)({error:!1,message:""})),D=Object(g.a)(P,2),E=D[0],A=D[1],T=Object(l.useState)({message:"",status:"",open:!1}),W=Object(g.a)(T,2),$=W[0],R=W[1],V=Object(z.a)(na),M=Object(g.a)(V,1)[0],L=Object(qe.a)(aa,{variables:{id:e.sucursal._id}}),U=L.loading,q=L.data,G=L.refetch,H=L.error,Y=Object(l.useState)({nombre_sucursal:"",descripcion:"",telefono:"",direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""}}),K=Object(g.a)(Y,2),Q=K[0],X=K[1];Object(l.useEffect)((function(){try{G()}catch(e){}}),[G]),Object(l.useEffect)((function(){try{r(U)}catch(e){}}),[U]),Object(l.useEffect)((function(){try{void 0!==q&&X(q.obtenerDatosSucursal[0])}catch(e){}}),[q,X]),Object(l.useEffect)((function(){try{N(H)}catch(e){}}),[H]);var Z=function(){var t=Object(f.a)(C.a.mark((function t(){return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r(!0),t.next=4,M({variables:{id:e.empresa._id,input:Q}});case 4:r(!1),R({message:"Se han actualizado correctamente los datos.",status:"success",open:!0}),A(!1),t.next=15;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0),t.t0.networkError?console.log(t.t0.networkError.result):t.t0.graphQLErrors&&console.log(t.t0.graphQLErrors),R({message:"Hubo un error",status:"error",open:!0}),r(!1);case 15:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),ee=function(){h(!1)},te=function(e){X(Object(b.a)(Object(b.a)({},Q),{},Object(_.a)({},e.target.name,e.target.value)))},ae=function(e){X(Object(b.a)(Object(b.a)({},Q),{},{direccion:Object(b.a)(Object(b.a)({},Q.direccion),{},Object(_.a)({},e.target.name,e.target.value))}))},ne=Object(l.useCallback)((function(e){var t=new FileReader;t.readAsDataURL(e[0]),t.onload=function(){var e=t.result;u(e)},X(Object(b.a)(Object(b.a)({},Q),{},{imagen:e[0]}))}),[Q,X]),ce=Object(Be.a)({accept:"image/jpeg, image/png",noKeyboard:!0,onDrop:ne});ce.getRootProps,ce.getInputProps;return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){h(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Fe.j,{className:t.icon})}),"Datos de sucursal"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:x,onClose:ee,TransitionComponent:oa,children:[Object(B.jsx)(J,{alert:$,setAlert:R}),Object(B.jsx)(He,{loading:c,setLoading:r}),Object(B.jsx)(Ie.a,{className:t.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:t.title,children:"Datos"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:ee,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsx)(Ae.a,{children:k?Object(B.jsx)(Ze,{error:k}):Object(B.jsxs)(y.a,{style:{marginTop:8},children:[Object(B.jsx)($e.a,{container:!0,spacing:3,className:t.require,children:Object(B.jsxs)($e.a,{item:!0,md:4,flexdirection:"row",children:[Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsxs)("b",{children:[Object(B.jsx)("span",{children:"* "}),"Nombre de empresa"]})}),Object(B.jsx)(F.a,{fullWidth:!0,disabled:o,type:"text",size:"small",error:E.error&&!Q.nombre_sucursal,name:"nombre_empresa",variant:"outlined",value:Q.nombre_sucursal?Q.nombre_sucursal:"",helperText:E.error&&"El campo nombre es obligatorio"!==E.message?E.message:"",onChange:te})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Descripci\xf3n"})}),Object(B.jsx)(F.a,{fullWidth:!0,disabled:o,type:"text",size:"small",error:E.error&&!Q.descripcion,name:"nombre_dueno",variant:"outlined",value:Q.descripcion?Q.descripcion:"",helperText:E.error&&"El campo nombre es obligatorio"!==E.message?E.message:"",onChange:te})]})]})}),Object(B.jsxs)(p.a,{mt:5,children:[Object(B.jsx)(S.a,{className:t.subtitle,children:Object(B.jsx)("b",{children:"Domicilio"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:3,className:t.require,children:[Object(B.jsxs)($e.a,{item:!0,md:4,children:[Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Calle"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"calle",variant:"outlined",disabled:o,value:Q.direccion.calle?Q.direccion.calle:"",onChange:ae})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Num. Ext"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"no_ext",variant:"outlined",disabled:o,value:Q.direccion.no_ext?Q.direccion.no_ext:"",onChange:ae})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Num. Int"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"no_int",variant:"outlined",disabled:o,value:Q.direccion.no_int?Q.direccion.no_int:"",onChange:ae})]})]}),Object(B.jsxs)($e.a,{item:!0,md:4,children:[Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"C.P."})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"codigo_postal",variant:"outlined",disabled:o,value:Q.direccion.codigo_postal?Q.direccion.codigo_postal:"",onChange:ae})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Colonia"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"colonia",variant:"outlined",disabled:o,value:Q.direccion.colonia?Q.direccion.colonia:"",onChange:ae})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Municipio"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"municipio",variant:"outlined",disabled:o,value:Q.direccion.municipio?Q.direccion.municipio:"",onChange:ae})]})]}),Object(B.jsxs)($e.a,{item:!0,md:4,children:[Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Localidad"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"localidad",variant:"outlined",disabled:o,value:Q.direccion.localidad?Q.direccion.localidad:"",onChange:ae})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Estado"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"estado",variant:"outlined",disabled:o,value:Q.direccion.estado?Q.direccion.estado:"",onChange:ae})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Pais"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"pais",variant:"outlined",disabled:o,value:Q.direccion.pais?Q.direccion.pais:"",onChange:ae})]})]})]})]})}),!1===e.accesos.mi_empresa.datos_empresa.editar?null:Object(B.jsxs)(Ue.a,{style:{justifyContent:"center"},children:[Object(B.jsx)(w.a,{onClick:ee,color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{onClick:function(){return Z()},color:"primary",variant:"contained",autoFocus:!0,children:"Guardar"})]})]})]})}function la(){var e=JSON.parse(localStorage.getItem("sesionCafi"));return Object(B.jsx)("div",{children:Object(B.jsx)(Pe,{children:Object(B.jsxs)($e.a,{container:!0,spacing:5,justifyContent:"center",children:[Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(sa,{})})}),!1===e.accesos.mi_empresa.datos_empresa.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(ea,{})})})]})})})}var da=a(20),ja=a(953),ua=a(820),ba=a(891),pa=a(893),ma=a(894),Oa=a(895),xa=a(896),ha=a(899),_a=a(892),fa=a(897),ga=a(898),va=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},Ca=function(e){for(var t="",a="0123456789",n=a.length,c=0;c<e;c++)t+=a.charAt(Math.floor(Math.random()*n));return t},ya=function(e){return e?new Date(e).toLocaleDateString("es-MX",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):null},Sa=function(e){return e?new Date(e).toLocaleDateString("es-MX",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):null},Fa=function(e){if(e){return parseFloat(e).toFixed(2).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}return 0},wa=function e(t){if(Array.isArray(t))return t.map(e);if(null!==t&&"object"===typeof t){var a={};for(var n in t)"__typename"!==n&&(a[n]=e(t[n]));return a}return t},Ia=function(){var e=Object(f.a)(C.a.mark((function e(t){var a,n,c,r,i;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,a=JSON.parse(localStorage.getItem("DatosVentas")),n=null===a?[]:a.productos,c=!1,r={producto:{},index:0},i=0;case 6:if(!(i<n.length)){e.next=21;break}if("undefined"===typeof n[i].codigo_barras){e.next=14;break}if(n[i].codigo_barras!==t.codigo_barras){e.next=12;break}return r={producto:n[i],index:i},c=!0,e.abrupt("return",{producto_found:r,found:c});case 12:e.next=18;break;case 14:if(n[i].id_producto.datos_generales.clave_alterna!==t.id_producto.datos_generales.clave_alterna){e.next=18;break}return r={producto:n[i],index:i},c=!0,e.abrupt("return",{producto_found:r,found:c});case 18:i++,e.next=6;break;case 21:return e.abrupt("return",{producto_found:r,found:c});case 24:return e.prev=24,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(t){return e.apply(this,arguments)}}(),ka=function(){var e=Object(f.a)(C.a.mark((function e(t){var a,n,c,r,i,o,s,l,d,j,u,b,p,m,O,x,h,_,f;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.newP,n=t.cantidad,c=t.granel,r=t.origen,i=t.precio_boolean,o=void 0!==i&&i,s=t.precio,e.prev=1,0,0,0,0,0,0,0,O=n>0?n:1,x=c.granel?parseFloat(c.valor):1,h=o?s:a.descuento_activo?a.descuento:a.precio_unidad,_=!0===h.unidad_maxima?h.cantidad_unidads:1,u=h.iva_precio*_,b=h.ieps_precio*_,j=u+b,l=h.precio_venta*_,d=h.precio_neto*_,m=a.id_producto.precios.monedero?a.id_producto.precios.monedero_electronico*_:0,p=d-a.precio_unidad.precio_neto,f={ivaCalculo:parseFloat((u*x*O).toFixed(2)),iepsCalculo:parseFloat((b*x*O).toFixed(2)),impuestoCalculo:parseFloat((j*x*O).toFixed(2)),subtotalCalculo:parseFloat((l*x*O).toFixed(2)),totalCalculo:parseFloat((d*x*O).toFixed(2)),monederoCalculo:parseFloat((m*x*O).toFixed(2)),descuentoCalculo:parseFloat((p*x*O).toFixed(2)),newP:a},"Ventas1"===r?(a.cantidad_venta=1,a.granel_producto=c,a.precio_a_vender=f.totalCalculo,a.precio_actual_producto=parseFloat(h.precio_neto.toFixed(2)),a.precio_actual_object={cantidad_unidad:h.cantidad_unidad?h.cantidad_unidad:1,numero_precio:h.numero_precio?h.numero_precio:1,unidad_maxima:!!h.unidad_maxima&&h.unidad_maxima,precio_general:h.precio_general?h.precio_general:0,precio_neto:h.precio_neto?h.precio_neto:0,precio_venta:h.precio_venta?h.precio_venta:0,iva_precio:h.iva_precio?h.iva_precio:0,ieps_precio:h.ieps_precio?h.ieps_precio:0,utilidad:h.utilidad?h.utilidad:0,porciento:h.porciento?h.porciento:0,dinero_descontado:h.dinero_descontado?h.dinero_descontado:0}):"Ventas2"===r&&(a.granel_producto=c,a.precio_a_vender=f.totalCalculo,a.precio_anterior=a.precio_actual_producto),e.abrupt("return",f);case 19:return e.prev=19,e.t0=e.catch(1),console.log(e.t0),e.abrupt("return",!1);case 23:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(t){return e.apply(this,arguments)}}(),za=function(){var e=Object(f.a)(C.a.mark((function e(t){var a,n,c,r,i;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t){e.next=3;break}return e.abrupt("return",!1);case 3:if(a=t.cantidad_venta,n=t.id_producto.precios.precios_producto.filter((function(e){return e.unidad_mayoreo>0&&e.precio_neto>0})),c={found:!1,pricing:0,number_pricing:0,object_prising:{}},r=n.length,!t.precio_seleccionado){e.next=9;break}return e.abrupt("return",c);case 9:if(!(a<t.id_producto.precios.precios_producto[1].unidad_mayoreo)){e.next=11;break}return e.abrupt("return",c={found:!0,pricing:t.descuento_activo?t.descuento.precio_neto:t.id_producto.precios.precios_producto[0].precio_neto,number_pricing:t.id_producto.precios.precios_producto[0].numero_precio,object_prising:t.descuento_activo?t.descuento:t.id_producto.precios.precios_producto[0]});case 11:i=0;case 12:if(!(i<n.length)){e.next=19;break}if(!(i+1===r&&a>=n[i].unidad_mayoreo)){e.next=15;break}return e.abrupt("return",c={found:!0,pricing:n[i].precio_neto,number_pricing:n[i].numero_precio,object_prising:n[i]});case 15:i+1<r&&a>=n[i].unidad_mayoreo&&a<n[i+1].unidad_mayoreo&&(c={found:!0,pricing:n[i].precio_neto,number_pricing:n[i].numero_precio,object_prising:n[i]});case 16:i++,e.next=12;break;case 19:return e.abrupt("return",c);case 22:return e.prev=22,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 26:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(t){return e.apply(this,arguments)}}();function Na(){var e=Object(l.useContext)(fe),t=e.datos_generales,a=e.unidadVentaXDefecto,n=e.setUnidadVentaXDefecto,c=e.unidadVentaSecundaria,r=e.setUnidadVentaSecundaria;return Object(B.jsx)(l.Fragment,{children:Object(B.jsx)(p.a,{children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"C\xf3digo de barras"}),Object(B.jsx)(Oa.a,{children:"Unidad"}),Object(B.jsx)(Oa.a,{children:"Precio"}),Object(B.jsx)(Oa.a,{children:"Cantidad"}),Object(B.jsx)(Oa.a,{children:"Aplicar Descuento"}),Object(B.jsx)(Oa.a,{children:"Unidad Principal"})]})}),Object(B.jsxs)(xa.a,{children:[Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:t.codigo_barras}),Object(B.jsx)(Oa.a,{children:a.unidad}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[a.descuento_activo&&null!==a.descuento_activo?Object(B.jsx)(fa.a,{color:!0===a.descuento_activo?"primary":"action"}):null,Object(B.jsx)(p.a,{mr:1}),Object(B.jsx)(S.a,{children:Object(B.jsxs)("b",{children:["$",Fa(a.descuento_activo&&!0===a.descuento_activo?a.descuento.precio_neto:a.precio)]})})]})}),Object(B.jsx)(Oa.a,{children:a.cantidad}),Object(B.jsx)(Oa.a,{children:a.descuento_activo&&null!==a.descuento_activo?Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Me.a,{checked:!0===a.descuento_activo&&a.descuento_activo,onChange:function(e){return t=e.target.checked,void n(Object(b.a)(Object(b.a)({},a),{},{descuento_activo:t}));var t},inputProps:{"aria-label":"check descuento"},color:"primary",disabled:null===a.descuento_activo}),Object(B.jsxs)(S.a,{color:"primary",children:["%",parseFloat(null!==a.descuento_activo?a.descuento.porciento:0)]})]}):null}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(Me.a,{checked:a.unidad_principal,onChange:function(e){return t=e.target.checked,n(Object(b.a)(Object(b.a)({},a),{},{unidad_principal:!0})),void(t&&r(Object(b.a)(Object(b.a)({},c),{},{unidad_principal:!1})));var t},inputProps:{"aria-label":"primary checkbox"}})})]}),"OTROS"!==t.tipo_producto?null:Object(B.jsx)(Pa,{})]})]})})})})}var Pa=function(){var e=Object(l.useContext)(fe),t=e.precios,a=e.unidadVentaXDefecto,n=e.setUnidadVentaXDefecto,c=e.unidadVentaSecundaria,r=e.setUnidadVentaSecundaria,i=Object(l.useState)(0),o=Object(g.a)(i,2),s=o[0],d=o[1];Object(l.useEffect)((function(){var e=c.descuento_activo&&!0===c.descuento_activo?c.descuento.precio_neto:c.precio;d(e)}),[c]);var j=function(e){var a=c.cantidad,n=c.precio_unidad;if(e&&a){var i=e/a,o=t.iva,s=t.ieps,l=t.unidad_de_compra,d=n.precio_venta,j=n.numero_precio,u=n.unidad_maxima,p=d/a,m=parseFloat("0.".concat(o<10?"0".concat(o):o))+parseFloat("0.".concat(s<10?"0".concat(s):s)),O=parseFloat((i/(m+1)).toFixed(2)),x=parseFloat((O/p*100).toFixed(2)),h=parseFloat((100-x).toFixed(2)),_=parseFloat((p*x/100).toFixed(2)),f=parseFloat((p-_).toFixed(2)),g=parseFloat(_*parseFloat("0.".concat(o<10?"0".concat(o):o)).toFixed(2)),v=parseFloat(_*parseFloat("0.".concat(s<10?"0".concat(s):s)).toFixed(2)),C=l.precio_unitario_sin_impuesto,y=parseFloat(((_-C)/C*100).toFixed(2)),S=parseFloat((_+g+v).toFixed(2)),F=parseFloat((S*a).toFixed(2));r(Object(b.a)(Object(b.a)({},c),{},{descuento:{cantidad_unidad:a,numero_precio:j,unidad_maxima:u,precio_general:F,precio_neto:F,precio_venta:_,iva_precio:g,ieps_precio:v,utilidad:y,porciento:h,dinero_descontado:f}}))}},u=function(e){var a=c.cantidad,n=c.precio_unidad,i=c.descuento;if(s&&a){var o=t.iva,l=t.ieps,j=t.unidad_de_compra,u=(n.precio_venta,n.numero_precio),p=n.unidad_maxima,m=s/a,O=parseFloat("0.".concat(o<10?"0".concat(o):o))+parseFloat("0.".concat(l<10?"0".concat(l):l)),x=parseFloat((m/(O+1)).toFixed(2)),h=parseFloat((x*i.porciento/100).toFixed(2)),_=parseFloat((x-h).toFixed(2)),f=parseFloat(h*parseFloat("0.".concat(o<10?"0".concat(o):o)).toFixed(2)),g=parseFloat(h*parseFloat("0.".concat(l<10?"0".concat(l):l)).toFixed(2)),v=j.precio_unitario_sin_impuesto,C=parseFloat(((h-v)/v*100).toFixed(2)),y=parseFloat((h+f+g).toFixed(2)),S=parseFloat((y*a).toFixed(2));d(S),r(Object(b.a)(Object(b.a)({},c),{},{descuento_activo:e,precio:s,descuento:{cantidad_unidad:a,numero_precio:u,unidad_maxima:p,precio_general:S,precio_neto:S,precio_venta:h,iva_precio:f,ieps_precio:g,utilidad:C,porciento:i.porciento,dinero_descontado:_}}))}},m=function(e){if(""===e.target.value)return r(Object(b.a)(Object(b.a)({},c),{},{unidad_principal:!1,precio:0})),void n(Object(b.a)(Object(b.a)({},a),{},{unidad_principal:!0}));if(c.precio&&c.cantidad){var i=c.cantidad,o=t.iva,l=t.ieps,d=parseFloat("0.".concat(o<10?"0".concat(o):o))+parseFloat("0.".concat(l<10?"0".concat(l):l)),j=parseFloat((s/i).toFixed(2)),u=parseFloat((j/(d+1)).toFixed(2)),p=t.unidad_de_compra.precio_unitario_sin_impuesto,m=parseFloat(u*parseFloat("0.".concat(o<10?"0".concat(o):o)).toFixed(2)),O=parseFloat(u*parseFloat("0.".concat(l<10?"0".concat(l):l)).toFixed(2)),x=parseFloat(((u-p)/p*100).toFixed(2)),h=u*i,_=j*i,f=Object(b.a)(Object(b.a)({},c),{},{precio:s,cantidad:i,precio_unidad:{numero_precio:1,precio_venta:h,precio_neto:_,unidad_mayoreo:0,iva_precio:m,ieps_precio:O,utilidad:x,unidad_maxima:!0,precio_general:s,cantidad_unidad:i}});r(f)}};return Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{width:220,children:Object(B.jsx)(H.a,{variant:"outlined",size:"small",name:"codigo_barras",children:Object(B.jsx)(K.a,{id:"input-codigo-barras",name:"codigo_barras",value:c.codigo_barras,endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(X.a,{size:"small",color:"primary",onClick:function(){return function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();r(Object(b.a)(Object(b.a)({},c),{},{codigo_barras:t}))}()},children:Object(B.jsx)(ga.a,{})})})})})}),Object(B.jsx)(Oa.a,{children:c.unidad}),Object(B.jsx)(Oa.a,{width:200,children:Object(B.jsx)(F.a,{type:"number",name:"precio",variant:"outlined",size:"small",onBlur:function(e){return m(e)},onChange:function(e){var t=e.target.value;t&&(t=parseFloat(t)),console.log(c.descuento_activo,c.descuento_activo),c.descuento_activo&&!0===c.descuento_activo?(console.log("a"),d(t),j(t)):d(t)},value:s,disabled:null!==c.descuento_activo&&!0===c.descuento_activo,InputProps:{inputProps:{min:0},startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"}),endAdornment:Object(B.jsx)(Q.a,{position:"end",children:null!==c.descuento_activo?Object(B.jsx)(fa.a,{color:c.descuento_activo?"primary":"disabled"}):null})}})}),Object(B.jsx)(Oa.a,{width:110,children:Object(B.jsx)(ha.a,{title:Object(B.jsx)(S.a,{variant:"subtitle2",children:"Pz/Kg por Unidad"}),placement:"top",arrow:!0,children:Object(B.jsx)(F.a,Object(_.a)({InputProps:{inputProps:{min:0}},type:"number",variant:"outlined",size:"small",name:"cantidad",onBlur:m,onChange:function(e){var t=e.target.value;t&&(t=parseFloat(t)),r(Object(b.a)(Object(b.a)({},c),{},{cantidad:t}))},value:c.cantidad},"onBlur",(function(e){""===e.target.value&&r(Object(b.a)(Object(b.a)({},c),{},{cantidad:t.unidad_de_compra.cantidad}))})))})}),Object(B.jsx)(Oa.a,{children:null!==c.descuento_activo?Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Me.a,{checked:!!c.descuento_activo&&c.descuento_activo,onChange:function(e){return function(e){var t=e?c.descuento.precio_neto:c.precio;e?u(e):(r(Object(b.a)(Object(b.a)({},c),{},{descuento_activo:e})),d(t))}(e.target.checked)},inputProps:{"aria-label":"check descuento"},color:"primary",disabled:null===c.descuento_activo}),Object(B.jsxs)(S.a,{color:"primary",children:["%",parseFloat(c.descuento&&null!==c.descuento?c.descuento.porciento:0)]})]}):null}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(Me.a,{checked:c.unidad_principal,onChange:function(e){return t=e.target.checked,r(Object(b.a)(Object(b.a)({},c),{},{unidad_principal:!0})),void(t&&n(Object(b.a)(Object(b.a)({},a),{},{unidad_principal:!1})));var t},inputProps:{"aria-label":"primary checkbox"},disabled:0===c.precio})})]})},Da=a(60),Ea=Object(k.a)((function(e){return{precioTitle:{width:e.spacing(20)},marginInput:{marginTop:19},titulos:{fontWeight:500}}}));function Aa(){var e=Object(l.useContext)(fe).preciosP,t=Object(da.a)(e);return Object(B.jsx)(l.Fragment,{children:e.map((function(e,a){return Object(B.jsx)(Ta,{data:e,index:a,newPreciosP:t},a)}))})}var Ta=function(e){var t=e.data,a=e.index,n=e.newPreciosP,c=Ea(),r=Object(l.useContext)(fe),i=r.preciosP,o=r.precios,s=r.unidadVentaXDefecto,d=r.setUnidadVentaXDefecto,j=r.setPreciosP,u=r.unidadVentaSecundaria,m=r.setUnidadVentaSecundaria,O=Object(b.a)({},i[a]),x=Object(l.useState)(!1),h=Object(g.a)(x,2),_=h[0],f=h[1],v=function(){var e=o.iva,t=o.ieps,c=s.descuento,r=s.descuento_activo,i=u.cantidad,l=u.descuento,p=u.descuento_activo,x=o.unidad_de_compra.precio_unitario_sin_impuesto,h=O.utilidad?O.utilidad:0,_=parseFloat((x*(h/100)+x).toFixed(2)),f=_*parseFloat("0.".concat(e<10?"0".concat(e):e)),g=_*parseFloat("0.".concat(t<10?"0".concat(t):t)),v=parseFloat((_+(f+g)).toFixed(2));O.precio_venta=_,O.precio_neto=v,O.iva_precio=f,O.ieps_precio=g;var C=Object(b.a)(Object(b.a)({},s),{},{precio:v,precio_unidad:{numero_precio:O.numero_precio,precio_neto:v,precio_venta:_,unidad_mayoreo:O.unidad_mayoreo,iva_precio:f,ieps_precio:g,utilidad:O.utilidad,unidad_maxima:!1}}),y=Object(b.a)(Object(b.a)({},u),{},{precio:parseFloat((i*v).toFixed(2)),precio_unidad:{numero_precio:O.numero_precio,precio_neto:parseFloat((i*v).toFixed(2)),precio_venta:parseFloat((i*_).toFixed(2)),unidad_mayoreo:O.unidad_mayoreo,iva_precio:f,ieps_precio:g,utilidad:O.utilidad,unidad_maxima:!1}});if(1===O.numero_precio){if(!0===r){var S=_*c.porciento/100,F=S+(S*parseFloat("0.".concat(e<10?"0".concat(e):e))+S*parseFloat("0.".concat(t<10?"0".concat(t):t)));C=Object(b.a)(Object(b.a)({},C),{},{precio:parseFloat(v.toFixed(2)),descuento:Object(b.a)(Object(b.a)({},s.descuento),{},{precio_neto:F})})}if(!0===p){var w=_*l.porciento/100,I=w+(w*parseFloat("0.".concat(e<10?"0".concat(e):e))+w*parseFloat("0.".concat(t<10?"0".concat(t):t)));y=Object(b.a)(Object(b.a)({},y),{},{precio:parseFloat((i*v).toFixed(2)),descuento:Object(b.a)(Object(b.a)({},u.descuento),{},{precio_neto:parseFloat((i*I).toFixed(2))})})}d(C),m(y)}n.splice(a,1,O),j(n)};Object(l.useEffect)((function(){(1===O.numero_precio||O.numero_precio>1&&O.precio_neto)&&v()}),[o.unidad_de_compra.precio_unitario_con_impuesto]);var C=function(e,t){switch(e){case"utilidad":t||(O.utilidad=0,O.precio_neto=O.numero_precio>1?0:o.unidad_de_compra.precio_unitario_con_impuesto,n.splice(a,1,O),j(n),f(!1));break;case"precio_neto":t||(O.precio_neto=O.numero_precio>1?0:o.unidad_de_compra.precio_unitario_con_impuesto,O.utilidad=0,n.splice(a,1,O),j(n),f(!1));break;case"unidad_mayoreo":t||(O.unidad_mayoreo=0,n.splice(a,1,O),j(n))}};return Object(B.jsxs)(p.a,{children:[Object(B.jsxs)(p.a,{display:"flex",my:1,mr:1,children:[Object(B.jsx)(p.a,{alignItems:"flex-end",display:t.numero_precio>1?"none":"flex",children:Object(B.jsx)(S.a,{className:c.precioTitle,children:Object(B.jsx)("b",{children:"Utilidad"})})}),Object(B.jsxs)(p.a,{minWidth:100,children:[Object(B.jsxs)(S.a,{className:c.titulos,children:["Precio ",t.numero_precio]}),Object(B.jsx)(p.a,{mb:2}),Object(B.jsx)(F.a,{disabled:!parseFloat(o.unidad_de_compra.precio_unitario_sin_impuesto),fullWidth:!0,type:"number",InputProps:{inputProps:{min:0},startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"%"})},size:"small",value:O.utilidad,name:"utilidad",variant:"outlined",onChange:function(e){return function(e){if(!e)return O.utilidad="",n.splice(a,1,O),void j(n);var t=o.unidad_de_compra.precio_unitario_sin_impuesto,c=s.descuento,r=s.descuento_activo,i=u.cantidad,l=u.descuento,p=u.descuento_activo,x=o.iva,h=o.ieps,_=t*(e/100)+t,g=_*parseFloat("0.".concat(x<10?"0".concat(x):x)),v=_*parseFloat("0.".concat(h<10?"0".concat(h):h)),C=_+(g+v);O.utilidad=parseFloat(e),O.precio_venta=parseFloat(_.toFixed(2)),O.iva_precio=g,O.ieps_precio=v;var y=o.unidad_de_compra.precio_unitario_con_impuesto;f(C<y&&0!==C),O.precio_neto=parseFloat(C.toFixed(2));var S=Object(b.a)(Object(b.a)({},s),{},{precio:C,precio_unidad:{numero_precio:O.numero_precio,precio_neto:C,precio_venta:_,unidad_mayoreo:O.unidad_mayoreo,iva_precio:g,ieps_precio:v,utilidad:O.utilidad,unidad_maxima:!1}}),F=Object(b.a)(Object(b.a)({},u),{},{precio:parseFloat((i*C).toFixed(2)),precio_unidad:{numero_precio:O.numero_precio,precio_neto:parseFloat((i*C).toFixed(2)),precio_venta:parseFloat((i*_).toFixed(2)),unidad_mayoreo:O.unidad_mayoreo,iva_precio:g,ieps_precio:v,utilidad:O.utilidad,unidad_maxima:!1}});if(1===O.numero_precio){if(!0===r){var w=_*c.porciento/100,I=w+(w*parseFloat("0.".concat(x<10?"0".concat(x):x))+w*parseFloat("0.".concat(h<10?"0".concat(h):h)));S=Object(b.a)(Object(b.a)({},S),{},{precio:parseFloat(C.toFixed(2)),descuento:Object(b.a)(Object(b.a)({},s.descuento),{},{precio_neto:I})}),S=Object(b.a)(Object(b.a)({},F),{},{precio:parseFloat(C.toFixed(2)),descuento:Object(b.a)(Object(b.a)({},u.descuento),{},{precio_neto:I})})}if(!0===p){var k=_*l.porciento/100,z=k+(k*parseFloat("0.".concat(x<10?"0".concat(x):x))+k*parseFloat("0.".concat(h<10?"0".concat(h):h)));F=Object(b.a)(Object(b.a)({},F),{},{precio:parseFloat((i*C).toFixed(2)),descuento:Object(b.a)(Object(b.a)({},u.descuento),{},{precio_neto:parseFloat((i*z).toFixed(2))})})}d(S),m(F)}n.splice(a,1,O),j(n)}(e.target.value)},onBlur:function(){return C("utilidad",O.utilidad)},error:""===O.utilidad})]})]}),Object(B.jsxs)(p.a,{display:"flex",my:2,mr:1,children:[Object(B.jsx)(p.a,{alignItems:"flex-end",display:t.numero_precio>1?"none":"flex",children:Object(B.jsxs)(p.a,{alignItems:"flex-end",flexDirection:"column",display:t.numero_precio>1?"none":"flex",children:[Object(B.jsx)(S.a,{className:c.precioTitle,children:Object(B.jsx)("b",{children:"Precio de venta"})}),Object(B.jsx)(S.a,{className:c.precioTitle,variant:"caption",color:"textSecondary",children:"(precio sin impuestos)"})]})}),Object(B.jsx)(p.a,{pl:1,children:Object(B.jsx)(S.a,{children:Object(B.jsxs)("b",{children:["$",parseFloat(O.precio_venta).toFixed(2)]})})})]}),Object(B.jsxs)(p.a,{display:"flex",my:1,mr:1,children:[Object(B.jsxs)(p.a,{alignItems:"flex-end",flexDirection:"column",display:t.numero_precio>1?"none":"flex",children:[Object(B.jsx)(S.a,{className:c.precioTitle,children:Object(B.jsx)("b",{children:"Precio venta neto"})}),Object(B.jsx)(S.a,{className:c.precioTitle,variant:"caption",color:"textSecondary",children:"(precio con impuestos)"})]}),Object(B.jsx)(p.a,{className:t.numero_precio>1?c.marginInput:"",children:Object(B.jsx)(F.a,{disabled:!parseFloat(o.unidad_de_compra.precio_unitario_sin_impuesto),fullWidth:!0,type:"number",InputProps:{inputProps:{min:0},startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})},size:"small",name:"precio_neto",variant:"outlined",value:O.precio_neto,onChange:function(e){return function(e){if(!e)return O.precio_neto="",n.splice(a,1,O),void j(n);var t=parseFloat(e),c=s.descuento,r=s.descuento_activo,i=u.cantidad,l=u.descuento,p=u.descuento_activo,x=o.iva,h=o.ieps,_=o.unidad_de_compra.precio_unitario_sin_impuesto,g=parseFloat("0.".concat(x<10?"0".concat(x):x))+parseFloat("0.".concat(h<10?"0".concat(h):h)),v=parseFloat((t/(g+1)).toFixed(2)),C=v*parseFloat("0.".concat(x<10?"0".concat(x):x)),y=v*parseFloat("0.".concat(h<10?"0".concat(h):h)),S=(t-(C+y)-_)/_*100;O.precio_neto=t,O.precio_venta=v,O.iva_precio=C,O.ieps_precio=y,O.utilidad=parseFloat(S.toFixed(2));var F=o.unidad_de_compra.precio_unitario_con_impuesto;f(t<F&&0!==t);var w=Object(b.a)(Object(b.a)({},s),{},{precio:t,precio_unidad:{numero_precio:O.numero_precio,precio_neto:t,precio_venta:v,unidad_mayoreo:O.unidad_mayoreo,iva_precio:C,ieps_precio:y,utilidad:O.utilidad,unidad_maxima:!1}}),I=Object(b.a)(Object(b.a)({},u),{},{precio:parseFloat((i*t).toFixed(2)),precio_unidad:{numero_precio:O.numero_precio,precio_neto:parseFloat((i*t).toFixed(2)),precio_venta:parseFloat((i*v).toFixed(2)),unidad_mayoreo:O.unidad_mayoreo,iva_precio:C,ieps_precio:y,utilidad:O.utilidad,unidad_maxima:!1}});if(1===O.numero_precio){if(!0===r){var k=v*c.porciento/100,z=k+(k*parseFloat("0.".concat(x<10?"0".concat(x):x))+k*parseFloat("0.".concat(h<10?"0".concat(h):h)));w=Object(b.a)(Object(b.a)({},w),{},{precio:parseFloat(t.toFixed(2)),descuento:Object(b.a)(Object(b.a)({},s.descuento),{},{precio_neto:z})})}if(!0===p){var N=v*l.porciento/100,P=N+(N*parseFloat("0.".concat(x<10?"0".concat(x):x))+N*parseFloat("0.".concat(h<10?"0".concat(h):h)));I=Object(b.a)(Object(b.a)({},I),{},{precio:parseFloat((i*t).toFixed(2)),descuento:Object(b.a)(Object(b.a)({},u.descuento),{},{precio_neto:parseFloat((i*P).toFixed(2))})})}d(w),m(I)}n.splice(a,1,O),j(n)}(e.target.value)},onBlur:function(){return C("precio_neto",O.precio_neto)},error:""===O.precio_neto||_,helperText:_?"Precio menor a costo":""})})]}),Object(B.jsxs)(p.a,{display:"flex",my:2,mr:1,children:[Object(B.jsx)(p.a,{alignItems:"flex-end",display:t.numero_precio>1?"none":"flex",children:Object(B.jsx)(S.a,{className:c.precioTitle,children:Object(B.jsx)("b",{children:"Unidad por mayoreo"})})}),t.numero_precio>1?Object(B.jsx)(p.a,{children:Object(B.jsx)(F.a,{disabled:!parseFloat(o.unidad_de_compra.precio_unitario_sin_impuesto),fullWidth:!0,type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"unidad_mayoreo",variant:"outlined",value:O.unidad_mayoreo,onChange:function(e){return function(e){if(!e)return O.unidad_mayoreo="",n.splice(a,1,O),void j(n);O.unidad_mayoreo=parseInt(e),n.splice(a,1,O),j(n)}(e.target.value)},onBlur:function(){return C("unidad_mayoreo",O.unidad_mayoreo)},error:""===O.unidad_mayoreo})}):null]})]})},Wa=[{unidad:"Pz",codigo_unidad:"H87"},{unidad:"Caja",codigo_unidad:"XBX"}],$a=[{unidad:"Kg",codigo_unidad:"KGM"},{unidad:"Lt",codigo_unidad:"LTR"},{unidad:"Costal",codigo_unidad:"KGM"}],Ra=function(e,t,a){var n=0,c=0,r=0,i=0,o=0,s=0;return"iva_activo"===e?t?(n=(c=parseFloat(a.precio_de_compra.precio_sin_impuesto))+(r=.16*parseFloat(c))+(i=parseFloat(c)*parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps)),o=c/a.unidad_de_compra.cantidad,s=n/a.unidad_de_compra.cantidad):(n=(c=parseFloat(a.precio_de_compra.precio_sin_impuesto))+(r=0)+(i=parseFloat(c)*parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps)),o=c/a.unidad_de_compra.cantidad,s=n/a.unidad_de_compra.cantidad,a.ieps_activo||(n=0,s=c/a.unidad_de_compra.cantidad)):(s=(n=(c=parseFloat(a.precio_de_compra.precio_sin_impuesto))+(r=parseFloat(c)*parseFloat(t<10?".0"+t:"."+t))+(i=parseFloat(c)*parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps)))/a.unidad_de_compra.cantidad,o=c/a.unidad_de_compra.cantidad),Object(b.a)(Object(b.a)({},a),{},{iva_activo:"iva_activo"===e?t:a.iva_activo,iva:"iva"===e?parseFloat(t):t?16:0,precio_de_compra:Object(b.a)(Object(b.a)({},a.precio_de_compra),{},{precio_sin_impuesto:parseFloat(c.toFixed(2)),iva:parseFloat(r.toFixed(2)),ieps:parseFloat(i.toFixed(2)),precio_con_impuesto:parseFloat(n.toFixed(2))}),unidad_de_compra:Object(b.a)(Object(b.a)({},a.unidad_de_compra),{},{precio_unitario_sin_impuesto:parseFloat(o.toFixed(2)),precio_unitario_con_impuesto:parseFloat(s.toFixed(2))})})},Va=function(e,t,a){var n=0,c=0,r=0,i=0,o=0,s=0;return"ieps_activo"===e?t?(n=(c=parseFloat(a.precio_de_compra.precio_sin_impuesto))+(r=parseFloat(c)*parseFloat(a.iva<10?".0"+a.iva:"."+a.iva))+(i=parseFloat(c)*a.ieps),o=c/a.unidad_de_compra.cantidad,s=n/a.unidad_de_compra.cantidad):(i=0,n=(c=parseFloat(a.precio_de_compra.precio_sin_impuesto))+(r=parseFloat(c)*parseFloat(a.iva<10?".0"+a.iva:"."+a.iva))+i,o=c/a.unidad_de_compra.cantidad,s=n/a.unidad_de_compra.cantidad,a.iva_activo||(n=0,s=c/a.unidad_de_compra.cantidad)):(s=(n=(c=parseFloat(a.precio_de_compra.precio_sin_impuesto))+(r=parseFloat(c)*parseFloat(a.iva<10?".0"+a.iva:"."+a.iva))+(i=parseFloat(c)*parseFloat(t<10?".0"+t:"."+t)))/a.unidad_de_compra.cantidad,o=c/a.unidad_de_compra.cantidad),Object(b.a)(Object(b.a)({},a),{},{ieps_activo:"ieps_activo"===e?t:a.ieps_activo,ieps:"ieps"===e?parseFloat(t):t?a.ieps:0,precio_de_compra:Object(b.a)(Object(b.a)({},a.precio_de_compra),{},{precio_sin_impuesto:parseFloat(c.toFixed(2)),iva:parseFloat(r.toFixed(2)),ieps:parseFloat(i.toFixed(2)),precio_con_impuesto:parseFloat(n.toFixed(2))}),unidad_de_compra:Object(b.a)(Object(b.a)({},a.unidad_de_compra),{},{precio_unitario_sin_impuesto:parseFloat(o.toFixed(2)),precio_unitario_con_impuesto:parseFloat(s.toFixed(2))})})},Ma=Object(k.a)((function(e){return{required:{color:"red"},precioTitle:{width:e.spacing(20),display:"flex",alignItems:"center"},titulos:{fontWeight:500}}}));function La(){var e=Ma(),t=Object(l.useContext)(fe),a=t.precios,n=t.setPrecios,c=t.validacion,r=(t.preciosP,t.update),i=t.unidadVentaXDefecto,o=t.setUnidadVentaXDefecto,s=t.unidadVentaSecundaria,d=t.setUnidadVentaSecundaria,j=function(){var e=Object(f.a)(C.a.mark((function e(t){var c,r,i;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("iva"!==t.target.name||t.target.value){e.next=3;break}return n(Object(b.a)(Object(b.a)({},a),{},{iva:""})),e.abrupt("return");case 3:return c=t.target.name,r="iva_activo"===c?t.target.checked:t.target.value,e.next=7,Ra(c,r,a);case 7:i=e.sent,h(i.precio_de_compra.precio_con_impuesto),I(i.precio_de_compra.precio_sin_impuesto),n(i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(f.a)(C.a.mark((function e(t){var c,r,i;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("ieps"!==t.target.name||t.target.value){e.next=3;break}return n(Object(b.a)(Object(b.a)({},a),{},{ieps:""})),e.abrupt("return");case 3:return c=t.target.name,r="ieps_activo"===c?t.target.checked:t.target.value,e.next=7,Va(c,r,a);case 7:i=e.sent,h(i.precio_de_compra.precio_con_impuesto),I(i.precio_de_compra.precio_sin_impuesto),n(i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=Object(l.useState)(a.precio_de_compra.precio_con_impuesto),O=Object(g.a)(m,2),x=O[0],h=O[1],v=Object(l.useState)(a.precio_de_compra.precio_sin_impuesto),y=Object(g.a)(v,2),w=y[0],I=y[1],k=Object(Da.useDebounce)(x,800),z=Object(g.a)(k,1)[0],N=Object(Da.useDebounce)(w,800),P=Object(g.a)(N,1)[0],D=function(e,t){if("unidad"===e.target.name){var c=t.props.unidad,r=c.codigo_unidad,l=c.unidad,j=a.unidad_de_compra.cantidad*i.precio;"Caja"===l||"Costal"===l?(d(Object(b.a)(Object(b.a)({},s),{},{precio:parseFloat(j.toFixed(2)),codigo_unidad:r,unidad:l,unidad_activa:!0,unidad_principal:!0})),o(Object(b.a)(Object(b.a)({},i),{},{unidad:"Caja"===l?"Pz":"kg",codigo_unidad:"Caja"===l?"H87":"KGM",cantidad:1,precio:i.precio,unidad_principal:!1}))):(o(Object(b.a)(Object(b.a)({},i),{},{unidad:"Pz"===l?"Pz":"Lt"===l?"Lt ":"kg",codigo_unidad:"Pz"===l?"H87":"Lt"===l?"LTR":"KGM",cantidad:1,precio:i.precio,unidad_principal:!0})),d(Object(b.a)(Object(b.a)({},s),{},{precio:parseFloat(j.toFixed(2)),codigo_unidad:"Pz"===l?"XBX":"Lt"===l?"LTR":"KGM",unidad:"Pz"===l?"Caja":"Caja"===l?"LTR":"Costal",unidad_activa:!1,unidad_principal:!1}))),n(Object(b.a)(Object(b.a)({},a),{},{unidad_de_compra:Object(b.a)(Object(b.a)({},a.unidad_de_compra),{},{unidad:l,codigo_unidad:r,cantidad:1}),inventario:Object(b.a)(Object(b.a)({},a.inventario),{},{unidad_de_inventario:l,codigo_unidad:r})}))}else{var u,p;if(a.iva_activo||a.ieps_activo)n(Object(b.a)(Object(b.a)({},a),{},{unidad_de_compra:Object(b.a)(Object(b.a)({},a.unidad_de_compra),{},(u={},Object(_.a)(u,e.target.name,parseFloat(e.target.value)),Object(_.a)(u,"precio_unitario_sin_impuesto",parseFloat((a.precio_de_compra.precio_sin_impuesto/e.target.value).toFixed(2))),Object(_.a)(u,"precio_unitario_con_impuesto",parseFloat((a.precio_de_compra.precio_con_impuesto/e.target.value).toFixed(2))),u))}));else n(Object(b.a)(Object(b.a)({},a),{},{unidad_de_compra:Object(b.a)(Object(b.a)({},a.unidad_de_compra),{},(p={},Object(_.a)(p,e.target.name,parseFloat(e.target.value)),Object(_.a)(p,"precio_unitario_sin_impuesto",parseFloat((a.precio_de_compra.precio_sin_impuesto/e.target.value).toFixed(2))),Object(_.a)(p,"precio_unitario_con_impuesto",parseFloat((a.precio_de_compra.precio_sin_impuesto/e.target.value).toFixed(2))),p))}));"Caja"!==a.unidad_de_compra.unidad&&"Costal"!==a.unidad_de_compra.unidad||d(Object(b.a)(Object(b.a)({},s),{},{cantidad:parseFloat(e.target.value)})),o(Object(b.a)(Object(b.a)({},i),{},{cantidad:1}))}};return Object(l.useEffect)((function(){!function(e){var t,c=0,r=0,i=0,o=0,s=0,l=0;c=parseFloat(e),t=parseFloat(a.iva<10?".0"+a.iva:"."+a.iva)+parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps),i=(r=parseFloat(e)/parseFloat(t+1))*parseFloat(a.iva<10?".0"+a.iva:"."+a.iva),o=r*parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps),l=c/a.unidad_de_compra.cantidad,s=r/a.unidad_de_compra.cantidad,isNaN(s)&&(s=0),isNaN(l)&&(l=0),isNaN(i)&&(i=0),isNaN(o)&&(o=0),I(parseFloat(r.toFixed(2))),n(Object(b.a)(Object(b.a)({},a),{},{precio_de_compra:Object(b.a)(Object(b.a)({},a.precio_de_compra),{},{precio_sin_impuesto:parseFloat(r.toFixed(2)),iva:parseFloat(i.toFixed(2)),ieps:parseFloat(o.toFixed(2)),precio_con_impuesto:parseFloat(c.toFixed(2))}),unidad_de_compra:Object(b.a)(Object(b.a)({},a.unidad_de_compra),{},{precio_unitario_sin_impuesto:parseFloat(s.toFixed(2)),precio_unitario_con_impuesto:parseFloat(l.toFixed(2))})}))}(z)}),[z]),Object(l.useEffect)((function(){!function(e){var t=0,c=0,r=0,i=0,o=0,s=0;t=(c=parseFloat(e))+(r=parseFloat(e)*parseFloat(a.iva<10?".0"+a.iva:"."+a.iva))+(i=parseFloat(e)*parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps)),o=c/a.unidad_de_compra.cantidad,s=t/a.unidad_de_compra.cantidad,a.iva_activo||a.ieps_activo||(t=c,s=c/a.unidad_de_compra.cantidad),isNaN(o)&&(o=0),isNaN(s)&&(s=0),isNaN(r)&&(r=0),isNaN(i)&&(i=0),h(parseFloat(t.toFixed(2))),n(Object(b.a)(Object(b.a)({},a),{},{precio_de_compra:Object(b.a)(Object(b.a)({},a.precio_de_compra),{},{precio_sin_impuesto:parseFloat(c.toFixed(2)),iva:parseFloat(r.toFixed(2)),ieps:parseFloat(i.toFixed(2)),precio_con_impuesto:parseFloat(t.toFixed(2))}),unidad_de_compra:Object(b.a)(Object(b.a)({},a.unidad_de_compra),{},{precio_unitario_sin_impuesto:parseFloat(o.toFixed(2)),precio_unitario_con_impuesto:parseFloat(s.toFixed(2))})}))}(P)}),[P]),Object(B.jsx)(p.a,{children:Object(B.jsxs)("div",{children:[Object(B.jsxs)(p.a,{mb:2,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Impuestos"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{noWrap:!0,className:e.titulos,children:"IVA"}),Object(B.jsx)(F.a,{fullWidth:!0,disabled:!a.iva_activo,type:"number",InputProps:{inputProps:{min:0},startAdornment:Object(B.jsxs)(Q.a,{position:"start",children:[Object(B.jsx)(Me.a,{checked:a.iva_activo,onChange:j,name:"iva_activo"}),Object(B.jsx)(S.a,{children:"%"})]})},size:"small",name:"iva",id:"form-producto-iva",variant:"outlined",value:a.iva,onChange:j,onFocus:function(e){var t=e.target,c=t.name,r=t.value;0===parseFloat(r)&&n(Object(b.a)(Object(b.a)({},a),{},Object(_.a)({},c,"")))},onBlur:function(e){var t=e.target,c=t.name;t.value||n(Object(b.a)(Object(b.a)({},a),{},Object(_.a)({},c,16)))},error:""===a.iva})]})}),Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{noWrap:!0,className:e.titulos,children:"porcentaje IEPS"}),Object(B.jsx)(F.a,{disabled:!a.ieps_activo,fullWidth:!0,type:"number",InputProps:{inputProps:{min:0},startAdornment:Object(B.jsxs)(Q.a,{position:"start",children:[Object(B.jsx)(Me.a,{checked:a.ieps_activo,onChange:u,name:"ieps_activo"}),Object(B.jsx)(S.a,{children:"%"})]})},size:"small",name:"ieps",id:"form-producto-ieps",variant:"outlined",value:a.ieps,onChange:u,onFocus:function(e){var t=e.target,c=t.name,r=t.value;0===parseFloat(r)&&n(Object(b.a)(Object(b.a)({},a),{},Object(_.a)({},c,"")))},onBlur:function(e){var t=e.target,c=t.name;t.value||n(Object(b.a)(Object(b.a)({},a),{},Object(_.a)({},c,0)))},error:""===a.ieps})]})})]}),Object(B.jsxs)(p.a,{my:3,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Precios y unidad de compra"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,sm:4,md:2,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{noWrap:!0,className:e.titulos,children:"Unidad Compra"}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsxs)(H.a,{variant:"outlined",fullWidth:!0,size:"small",error:c.error&&!a.unidad_de_compra.unidad,children:[a.granel?Object(B.jsx)(mt.a,{disabled:r,id:"form-producto-categoria",name:"unidad",value:a.unidad_de_compra.unidad,onChange:D,children:$a.map((function(e,t){return Object(B.jsx)(Ot.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))}):Object(B.jsx)(mt.a,{disabled:r,id:"form-producto-categoria",name:"unidad",value:a.unidad_de_compra.unidad,onChange:D,children:Wa.map((function(e,t){return Object(B.jsx)(Ot.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))}),Object(B.jsx)(ua.a,{children:c.message})]})})]})}),Object(B.jsx)($e.a,{item:!0,sm:4,md:2,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{noWrap:!0,align:"center",className:e.titulos,children:"Unidad Conversion"}),Object(B.jsx)(S.a,{align:"center",variant:"h6",children:Object(B.jsx)("b",{children:"Caja"===a.unidad_de_compra.unidad?"Pz":"Costal"===a.unidad_de_compra.unidad?"Kg":a.unidad_de_compra.unidad})})]})}),Object(B.jsx)($e.a,{item:!0,sm:4,md:2,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsxs)(S.a,{noWrap:!0,className:e.titulos,children:[Object(B.jsx)("span",{className:e.required,children:"* "}),"Factor por Unidad"]}),Object(B.jsx)(F.a,{fullWidth:!0,disabled:"Caja"!==a.unidad_de_compra.unidad&&"Costal"!==a.unidad_de_compra.unidad,type:"number",InputProps:{inputProps:{min:1}},size:"small",error:c.error&&!a.unidad_de_compra.cantidad,name:"cantidad",id:"form-producto-cantidad",variant:"outlined",value:a.unidad_de_compra.cantidad,helperText:c.message,onChange:D})]})}),Object(B.jsx)($e.a,{item:!0,sm:6,md:3,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsxs)(S.a,{noWrap:!0,className:e.titulos,children:[Object(B.jsx)("span",{className:e.required,children:"* "}),"Precio sin impuestos"]}),Object(B.jsx)(F.a,{type:"number",InputProps:{inputProps:{min:0},startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})},fullWidth:!0,size:"small",error:c.error&&!w,name:"precio_sin_impuesto",id:"form-producto-precio_sin_impuesto",variant:"outlined",value:w,helperText:c.message,onChange:function(e){return I(e.target.value)},onFocus:function(e){var t=e.target.value;0===parseFloat(t)&&I("")},onBlur:function(e){e.target.value||I(0)}})]})}),Object(B.jsx)($e.a,{item:!0,sm:6,md:3,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsxs)(S.a,{noWrap:!0,className:e.titulos,children:[Object(B.jsx)("span",{className:e.required,children:"* "}),"Precio con impuestos"]}),Object(B.jsx)(F.a,{fullWidth:!0,disabled:!a.iva_activo&&!a.ieps_activo,type:"number",InputProps:{inputProps:{min:0},startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})},size:"small",error:c.error&&!x,name:"precio_con_impuesto",id:"form-producto-precio_con_impuesto",variant:"outlined",value:x,helperText:c.message,onChange:function(e){return h(e.target.value)},onFocus:function(e){var t=e.target.value;0===parseFloat(t)&&h("")},onBlur:function(e){e.target.value||h(0)}})]})})]}),Object(B.jsx)(p.a,{my:3}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:2,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{align:"center",className:e.titulos,children:"IVA"}),Object(B.jsx)(S.a,{align:"center",variant:"h6",children:Object(B.jsxs)("b",{children:["$ ",parseFloat(a.precio_de_compra.iva).toFixed(2)]})})]})}),Object(B.jsx)($e.a,{item:!0,md:2,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{align:"center",className:e.titulos,children:"IEPS"}),Object(B.jsx)(S.a,{align:"center",variant:"h6",children:Object(B.jsxs)("b",{children:["$ ",parseFloat(a.precio_de_compra.ieps).toFixed(2)]})})]})}),Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{align:"center",className:e.titulos,children:"Precio unitario sin impuestos"}),Object(B.jsx)(S.a,{align:"center",variant:"h6",children:Object(B.jsxs)("b",{children:["$"," ",parseFloat(a.unidad_de_compra.precio_unitario_sin_impuesto).toFixed(2)]})})]})}),Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{align:"center",className:e.titulos,children:"Precio unitario con impuestos"}),Object(B.jsx)(S.a,{align:"center",variant:"h6",children:Object(B.jsxs)("b",{children:["$"," ",parseFloat(a.unidad_de_compra.precio_unitario_con_impuesto).toFixed(2)]})})]})})]}),Object(B.jsxs)(p.a,{my:2,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Precios de venta"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(Aa,{})}),Object(B.jsxs)(p.a,{my:2,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Unidades de venta"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsx)(p.a,{children:Object(B.jsx)(Na,{})})]})})}var Ua=a(903),Ba=a(904),qa=Object(l.createContext)(),Ja=function(e){var t=e.children,a=Object(l.useState)({producto:{},costo:0,cantidad:1,cantidad_regalo:0,unidad_regalo:"",cantidad_total:0,descuento_porcentaje:0,descuento_precio:0,iva_total:0,ieps_total:0,subtotal:0,impuestos:0,total:0,mantener_precio:!0,impuestos_descuento:0,subtotal_descuento:0,total_descuento:0}),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)({productos:[],proveedor:{},en_espera:!1,fecha_registro:ht()().locale("es-mx").format("YYYY-MM-DD"),almacen:{},compra_credito:!1,fecha_vencimiento_credito:ht()().locale("es-mx").format("YYYY-MM-DD"),credito_pagado:!1,saldo_credito_pendiente:0,forma_pago:"",descuento_aplicado:!1,descuento:{porcentaje:0,cantidad_descontada:0,precio_con_descuento:0},subtotal:0,impuestos:0,total:0}),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)([{numero_precio:1,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:2,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:3,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:4,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:5,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:6,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0}]),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(l.useState)({precios:re}),O=Object(g.a)(m,2),x=O[0],h=O[1],_=Object(l.useState)([]),f=Object(g.a)(_,2),v=f[0],C=f[1],y=Object(l.useState)({}),S=Object(g.a)(y,2),F=S[0],w=S[1],I=Object(l.useState)(!1),k=Object(g.a)(I,2),z=k[0],N=k[1],P=Object(l.useState)(0),D=Object(g.a)(P,2),E=D[0],A=D[1],T=Object(l.useState)(1),W=Object(g.a)(T,2),$=W[0],R=W[1],V=Object(l.useState)(!1),M=Object(g.a)(V,2),L=M[0],U=M[1],q=Object(l.useState)(!1),J=Object(g.a)(q,2),G=J[0],H=J[1];return Object(B.jsx)(qa.Provider,{value:{datosProducto:c,setDatosProducto:r,productosCompra:v,setProductosCompra:C,datosCompra:s,setDatosCompra:d,productoOriginal:x,setProductoOriginal:h,preciosVenta:b,setPreciosVenta:p,isEditing:F,setIsEditing:w,editFinish:z,setEditFinish:N,costo:E,setCosto:A,cantidad:$,setCantidad:R,issue:L,setIssue:U,loadingProductos:G,setLoadingProductos:H},children:t})},Ga=a(90),Ha=a.n(Ga),Ya=a(817),Ka=a(336),Qa=a(957),Xa=a(900),Za=a(901),en=a(902),tn=a(142),an=function(e,t){if(e.medida.talla&&t.medida.talla)return e.medida.talla.localeCompare(t.medida.talla)},nn=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},container:{maxHeight:"65vh"},tableRow:{"&.Mui-selected, &.Mui-selected:hover":{backgroundColor:Object(tn.alpha)(e.palette.primary.main,.1)}},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",height:30,width:30,borderRadius:"15%"},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}}}}));function cn(e){var t=e.from,a=e.setOnUpdate,n=e.onUpdate,c=e.withoutPrice,r=e.onlyPrice,i=nn(),o=Object(l.useContext)(fe),s=o.presentaciones,d=(o.setPresentaciones,Object(da.a)(s).sort((function(e,t){return an(e,t)})));return Object(B.jsx)("div",{className:i.root,children:Object(B.jsx)(Ka.a,{className:i.paper,children:Object(B.jsx)(ba.a,{className:i.container,children:Object(B.jsxs)(_a.a,{className:i.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",stickyHeader:!0,children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Existencia"}),Object(B.jsx)(Oa.a,{children:"C\xf3digo de barras"}),Object(B.jsx)(Oa.a,{width:200,children:"Nombre"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Medida"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Color"}),c?null:Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(Oa.a,{children:"Precio"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Aplicar descuento"})]}),r?null:Object(B.jsxs)(l.Fragment,{children:[t&&"compra"===t?Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Existente"}):null,Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Cantidad"})]}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Editar"})]})}),Object(B.jsx)(xa.a,{children:d.map((function(e,i){return Object(B.jsx)(pn,{producto:e,index:i,from:t,setOnUpdate:a,onUpdate:n,withoutPrice:c,onlyPrice:r},i)}))})]})})})})}var rn,on,sn,ln,dn,jn,un,bn,pn=function(e){var t=e.producto,a=e.index,n=e.from,c=e.setOnUpdate,r=e.onUpdate,i=e.withoutPrice,o=e.onlyPrice,s=Object(l.useContext)(fe),d=s.presentaciones,j=s.setPresentaciones,u=s.preciosP,m=s.precios,O=Object(l.useState)(!0),x=Object(g.a)(O,2),h=x[0],_=x[1],f=nn(),v=Object(l.useRef)(null),C=Object(da.a)(d).sort((function(e,t){return an(e,t)})),y=Object(b.a)({},C[a]),F=Object(b.a)({},C[a].descuento),w=Object(b.a)({},t),I=function(e){var t=e.target,n=t.name,c=t.value;if("cantidad"===n){if(!c)return y.cantidad="",y.existencia=!1,C.splice(a,1,y),void j(C);y.existencia="0"!==c,y.cantidad=parseFloat(c)}else if("cantidad_nueva"===n){if(!c)return y.cantidad_nueva="",y.existencia=w.existencia,C.splice(a,1,y),void j(C);y.cantidad_nueva=parseFloat(c),y.existencia=!0}else if("precio"===n){if(!c)return y.precio="",C.splice(a,1,y),void j(C);var r=parseFloat(c),i=m.iva,o=m.ieps,s=parseFloat("0.".concat(i<10?"0".concat(i):i))+parseFloat("0.".concat(o<10?"0".concat(o):o)),l=parseFloat((r/(s+1)).toFixed(2)),d=parseFloat((l*parseFloat("0.".concat(i<10?"0".concat(i):i))).toFixed(2)),u=parseFloat((l*parseFloat("0.".concat(o<10?"0".concat(o):o))).toFixed(2)),b=m.unidad_de_compra.precio_unitario_sin_impuesto,p=parseFloat(((l-b)/b*100).toFixed(2)),O=y.descuento_activo,x=y.descuento;if(O&&!0===O){var h=l*x.porciento/100,_=h+(h*parseFloat("0.".concat(i<10?"0".concat(i):i))+h*parseFloat("0.".concat(o<10?"0".concat(o):o)));F.precio_neto=parseFloat(_.toFixed(2)),y.precio=parseFloat(c),y.descuento=F}else y.precio=parseFloat(c);y.precio_unidad.precio_venta=l,y.precio_unidad.precio_neto=r,y.precio_unidad.utilidad=p,y.precio_unidad.iva_precio=d,y.precio_unidad.ieps_precio=u}else{if(!c)return y.codigo_barras="",C.splice(a,1,y),void j(C);y.codigo_barras=c}C.splice(a,1,y),j(C)},k=function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();y.codigo_barras=t,C.splice(a,1,y),j(C)},z=function(){h?(_(!h),c([].concat(Object(da.a)(r),[a]))):(w.cantidad||(y.cantidad=0),w.cantidad_nueva||(y.cantidad_nueva=0),w.precio||(y.precio=u[0].precio_neto),C.splice(a,1,y),j(C),_(!0),r.splice(r.length-1,1),c(Object(da.a)(r)))};return Object(B.jsxs)(ma.a,{hover:!0,selected:!h,className:f.tableRow,children:[Object(B.jsx)(Oa.a,{align:"center",padding:"checkbox",children:Object(B.jsx)(Me.a,{checked:w.existencia,color:"primary"})}),Object(B.jsx)(Oa.a,{width:220,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(Ya.a,{inputRef:v,onChange:function(e){return I(e)},value:w.codigo_barras,type:"number",name:"codigo_barras",disabled:d.length>0&&!w.nuevo||h}),0===d.length&&w.nuevo||d.length>0&&w.nuevo?Object(B.jsx)(X.a,{color:"primary",size:"small",onClick:function(){return k()},children:Object(B.jsx)(ga.a,{})}):null]})}),Object(B.jsx)(Oa.a,{width:200,children:w.nombre_comercial}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:w.medida._id?Object(B.jsx)(Qa.a,{label:w.medida.talla,color:"primary"}):""}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:w.color._id?Object(B.jsx)(ha.a,{title:w.color.nombre,placement:"top",arrow:!0,TransitionComponent:Xa.a,children:Object(B.jsx)("div",{className:f.colorContainer,style:{backgroundColor:w.color.hex}})}):null}),i?null:Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(Oa.a,{width:110,className:f.input,children:Object(B.jsx)(Ya.a,{inputRef:v,onChange:function(e){return I(e)},disabled:h,value:w.precio,type:"number",name:"precio"})}),Object(B.jsx)(Oa.a,{width:200,children:Object(B.jsx)(p.a,{display:"flex",alignItems:"center",children:void 0!==w.descuento_activo&&null!==w.descuento_activo?Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(Me.a,{checked:!0===w.descuento_activo&&w.descuento_activo,onChange:function(e){return function(e){y.descuento_activo=e;var t=0,n=m.iva,c=m.ieps,r=y.descuento,i=y.precio,o=parseFloat("0.".concat(n<10?"0".concat(n):n))+parseFloat("0.".concat(c<10?"0".concat(c):c)),s=parseFloat((i/(o+1)).toFixed(2));if(e){var l=s*r.porciento/100;t=l+(l*parseFloat("0.".concat(n<10?"0".concat(n):n))+l*parseFloat("0.".concat(c<10?"0".concat(c):c)))}else t=i;F.precio_neto=parseFloat(t.toFixed(2)),y.descuento=F,C.splice(a,1,y),j(C)}(e.target.checked)},icon:Object(B.jsx)(Za.a,{}),checkedIcon:Object(B.jsx)(fa.a,{}),inputProps:{"aria-label":"check descuento"},color:"primary",disabled:null===w.descuento_activo}),Object(B.jsxs)(S.a,{color:!0===w.descuento_activo?"primary":"textSecondary",children:["%",parseFloat(null!==w.descuento?w.descuento.porciento:0)," ","$",parseFloat(null!==w.descuento?w.descuento.precio_neto:0)]})]}):null})})]}),o?null:Object(B.jsx)(l.Fragment,{children:n&&"compra"===n?Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(Oa.a,{padding:"checkbox",children:t.cantidad}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(Ya.a,{inputRef:v,onChange:function(e){return I(e)},disabled:h,value:w.cantidad_nueva,type:"tel",name:"cantidad_nueva"})})]}):Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(Ya.a,{inputRef:v,onChange:function(e){return I(e)},disabled:h,value:w.cantidad,type:"tel",name:"cantidad"})})}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(X.a,{size:"small",onClick:function(){return z()},children:h?Object(B.jsx)(en.a,{}):Object(B.jsx)(Pt.a,{})})})]})},mn=["children","value","index"],On=["precios_producto"],xn=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function hn(e){var t=e.children,a=e.value,n=e.index,c=Object(ve.a)(e,mn);return Object(B.jsx)("div",Object(b.a)(Object(b.a)({style:{height:"80vh"},role:"tabpanel",hidden:a!==n,id:"scrollable-force-tabpanel-".concat(n),"aria-labelledby":"scrollable-force-tab-".concat(n)},c),{},{children:a===n&&Object(B.jsx)(p.a,{p:3,children:t})}))}function _n(e){return{id:"scrollable-force-tab-".concat(e),"aria-controls":"scrollable-force-tabpanel-".concat(e)}}function fn(e){var t=e.agregarCompra,a=e.handleClose,n=e.cargando,c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)([]),d=Object(g.a)(s,2),j=d[0],u=d[1],p=Object(l.useContext)(qa),m=p.datosProducto,O=p.productoOriginal,x=Object(l.useContext)(fe),h=x.precios,_=x.setPrecios,f=x.setUnidadesVenta,v=x.setPreciosP,C=x.setUnidadVentaXDefecto,y=x.setUnidadVentaSecundaria,S=function(){return o(!i)},F=function(){var e=O.precios,t=(e.precios_producto,Object(ve.a)(e,On)),a=O.unidades_de_venta,n=O.unidades_de_venta.filter((function(e){return!1===e.default})),c=O.unidades_de_venta.filter((function(e){return!0===e.default}));_(t),f(a),v(O.precios.precios_producto),C(c[0]),y(n[0]),S()},k=Object(l.useState)(0),z=Object(g.a)(k,2),N=z[0],P=z[1];return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(w.a,{color:"primary",size:"medium",onClick:function(){return function(){S();var e=m.costo/h.unidad_de_compra.cantidad,t=h.precio_de_compra.precio_sin_impuesto/h.unidad_de_compra.cantidad;isNaN(t)&&(t=0),isNaN(e)&&(e=0),_(Object(b.a)(Object(b.a)({},h),{},{precio_de_compra:Object(b.a)(Object(b.a)({},h.precio_de_compra),{},{precio_con_impuesto:m.costo}),unidad_de_compra:Object(b.a)(Object(b.a)({},h.unidad_de_compra),{},{precio_unitario_con_impuesto:parseFloat(e.toFixed(6)),precio_unitario_sin_impuesto:parseFloat(t.toFixed(6))})}))}()},children:"Actualizar precios"}),Object(B.jsxs)(Ee.a,{open:i,TransitionComponent:xn,keepMounted:!0,onClose:function(){return F()},"aria-labelledby":"alert-precios-compra-title","aria-describedby":"alert-precios-compra-description",fullWidth:!0,maxWidth:"lg",children:[m.producto.datos_generales&&"OTROS"!==m.producto.datos_generales.tipo_producto?Object(B.jsx)(wt.a,{style:{padding:0},children:Object(B.jsx)(Ie.a,{position:"static",color:"default",children:Object(B.jsxs)(ke.a,{value:N,onChange:function(e,t){P(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:[Object(B.jsx)(ze.a,Object(b.a)({label:"Precios",icon:Object(B.jsx)(Ua.a,{})},_n(0))),Object(B.jsx)(ze.a,Object(b.a)({label:"Precios Medidas",icon:Object(B.jsx)(Ba.a,{})},_n(1)))]})})}):null,Object(B.jsx)(Ae.a,{children:m.producto.datos_generales&&"OTROS"!==m.producto.datos_generales.tipo_producto?Object(B.jsxs)("div",{children:[Object(B.jsx)(hn,{value:N,index:0,children:Object(B.jsx)(La,{})}),Object(B.jsx)(hn,{value:N,index:1,children:Object(B.jsx)(cn,{from:"compras",datos:m.producto,setOnUpdate:u,onUpdate:j,onlyPrice:!0})})]}):Object(B.jsx)(La,{})}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{color:"inherit",size:"large",startIcon:Object(B.jsx)(Pt.a,{}),onClick:function(){return F()},children:"Cancelar"}),Object(B.jsx)(w.a,{size:"large",onClick:function(){t("actualizar_precios"),a(),S()},startIcon:n?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(Ha.a,{}),color:"primary",variant:"contained",disabled:!h.precio_de_compra.precio_con_impuesto,children:"Aceptar y agregar compra"})]})]})]})}var gn,vn,Cn,yn,Sn,Fn,wn,In,kn=Object(P.d)(rn||(rn=Object(N.a)(["\n  query obtenerConsultasProducto($empresa: ID!, $sucursal: ID!) {\n    obtenerConsultasProducto(empresa: $empresa, sucursal: $sucursal) {\n      categorias {\n        _id\n        categoria\n        subcategorias {\n          _id\n          subcategoria\n        }\n      }\n      departamentos {\n        _id\n        nombre_departamentos\n      }\n      marcas {\n        _id\n        nombre_marca\n      }\n      colores {\n        _id\n        nombre\n        hex\n      }\n      tallas {\n        _id\n        talla\n        tipo\n      }\n      calzados {\n        _id\n        talla\n        tipo\n      }\n      almacenes {\n        _id\n        nombre_almacen\n      }\n      centro_costos {\n        _id\n        cuenta\n        subcuentas {\n          _id\n          subcuenta\n        }\n      }\n      codigos {\n        _id\n        Name\n        Value\n      }\n    }\n  }\n"]))),zn=Object(P.d)(on||(on=Object(N.a)(["\n  mutation crearProducto($input: CrearProductoInput) {\n    crearProducto(input: $input) {\n      message\n    }\n  }\n"]))),Nn=Object(P.d)(sn||(sn=Object(N.a)(["\n  query obtenerProductos(\n    $empresa: ID!\n    $sucursal: ID!\n    $filtro: String\n    $almacen: ID\n    $existencias: Boolean\n  ) {\n    obtenerProductos(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtro: $filtro\n      almacen: $almacen\n      existencias: $existencias\n    ) {\n      _id\n      centro_de_costos {\n        id_cuenta\n        cuenta\n        id_subcuenta\n        subcuenta\n      }\n      unidades_de_venta {\n        _id\n        precio\n        cantidad\n        unidad\n        codigo_unidad\n        unidad_principal\n        codigo_barras\n        id_producto\n        descuento_activo\n        descuento {\n          cantidad_unidad\n          numero_precio\n          unidad_maxima\n          precio_general\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          utilidad\n          porciento\n          dinero_descontado\n        }\n        default\n        precio_unidad {\n          numero_precio\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          unidad_mayoreo\n          utilidad\n          precio_general\n          cantidad_unidad\n          unidad_maxima\n        }\n      }\n      datos_generales {\n        codigo_barras\n        clave_alterna\n        tipo_producto\n        nombre_comercial\n        nombre_generico\n        descripcion\n        id_categoria\n        categoria\n        subcategoria\n        id_subcategoria\n        id_departamento\n        departamento\n        id_marca\n        marca\n        clave_producto_sat {\n          Name\n          Value\n        }\n        receta_farmacia\n      }\n      empresa\n      imagenes {\n        location_imagen\n        extencion_imagen\n        url_imagen\n        key_imagen\n      }\n      precio_plazos {\n        precio_cajas {\n          plazo\n          unidad\n          precio\n          codigo_unidad\n        }\n        precio_piezas {\n          plazo\n          unidad\n          precio\n          codigo_unidad\n        }\n        precio_costales {\n          plazo\n          unidad\n          codigo_unidad\n          precio\n        }\n      }\n      precios {\n        ieps\n        ieps_activo\n        iva\n        iva_activo\n        monedero\n        monedero_electronico\n        precio_de_compra {\n          ieps\n          iva\n          precio_con_impuesto\n          precio_sin_impuesto\n        }\n        precios_producto {\n          numero_precio\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          unidad_mayoreo\n          utilidad\n          precio_general\n          cantidad_unidad\n          unidad_maxima\n        }\n        unidad_de_compra {\n          cantidad\n          precio_unitario_con_impuesto\n          precio_unitario_sin_impuesto\n          unidad\n          codigo_unidad\n        }\n        inventario {\n          inventario_minimo\n          inventario_maximo\n          unidad_de_inventario\n          codigo_unidad\n        }\n        granel\n      }\n      medidas_producto {\n        _id\n        cantidad\n        codigo_unidad\n        unidad\n        almacen\n        descuento_activo\n        descuento {\n          cantidad_unidad\n          numero_precio\n          unidad_maxima\n          precio_general\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          utilidad\n          porciento\n          dinero_descontado\n        }\n        codigo_barras\n        color {\n          _id\n          nombre\n          hex\n        }\n        existencia\n        medida {\n          _id\n          talla\n          tipo\n        }\n        nombre_comercial\n        precio\n        precio_unidad {\n          numero_precio\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          unidad_mayoreo\n          utilidad\n          precio_general\n          cantidad_unidad\n          unidad_maxima\n        }\n      }\n      inventario_general {\n        _id\n        cantidad_existente\n        unidad_inventario\n        codigo_unidad\n        cantidad_existente_maxima\n        unidad_maxima\n        id_almacen_general\n        eliminado\n      }\n      medidas_registradas\n      sucursal\n      usuario\n    }\n  }\n"]))),Pn=Object(P.d)(ln||(ln=Object(N.a)(["\n  mutation actualizarProducto($id: ID!, $input: ActualizarProductoInput) {\n    actualizarProducto(id: $id, input: $input) {\n      message\n    }\n  }\n"]))),Dn=Object(P.d)(dn||(dn=Object(N.a)(["\n  mutation eliminarProducto($id: ID!) {\n    eliminarProducto(id: $id) {\n      message\n    }\n  }\n"]))),En=Object(P.d)(jn||(jn=Object(N.a)(["\n  query obtenerProductosInactivos($empresa: ID!, $sucursal: ID!) {\n    obtenerProductosInactivos(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      producto {\n        _id\n        datos_generales {\n          codigo_barras\n          clave_alterna\n          tipo_producto\n          nombre_comercial\n          nombre_generico\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          ieps\n          ieps_activo\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          precio_de_compra {\n            ieps\n            iva\n            precio_con_impuesto\n            precio_sin_impuesto\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            precio_venta\n            unidad_mayoreo\n            utilidad\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n          }\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n          }\n          granel\n        }\n      }\n      cantidad_existente\n      unidad_de_inventario\n      id_almacen\n      eliminado\n      empresa\n      sucursal\n    }\n  }\n"]))),An=Object(P.d)(un||(un=Object(N.a)(["\n  mutation activarProducto($id: ID!) {\n    activarProducto(id: $id) {\n      message\n    }\n  }\n"]))),Tn=Object(P.d)(bn||(bn=Object(N.a)(["\n  mutation crearProductoRapido($input: CrearProductoRapidoInput) {\n    crearProductoRapido(input: $input) {\n      message\n    }\n  }\n"]))),Wn=a(259),$n=Object(P.d)(gn||(gn=Object(N.a)(["\n\tmutation crearColor($input: CrearColorInput) {\n\t\tcrearColor(input: $input) {\n\t\t\t_id\n\t\t\tnombre\n\t\t\thex\n\t\t\tempresa {\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t\tsucursales_activas\n\t\t\t\tlimite_sucursales\n\t\t\t\t_id\n\t\t\t}\n\t\t}\n\t}\n"]))),Rn=Object(P.d)(vn||(vn=Object(N.a)(["\n\tquery obtenerColores($empresa: ID!) {\n\t\tobtenerColores(empresa: $empresa) {\n\t\t\t_id\n\t\t\tnombre\n\t\t\thex\n\t\t\tempresa {\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t\tsucursales_activas\n\t\t\t\tlimite_sucursales\n\t\t\t\t_id\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t}\n\t}\n"]))),Vn=Object(P.d)(Cn||(Cn=Object(N.a)(["\n\tmutation actualizarColor($input: ActualizarColorInput, $id: ID!) {\n\t\tactualizarColor(id: $id, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Mn=Object(P.d)(yn||(yn=Object(N.a)(["\n\tmutation eliminarColor($id: ID!) {\n\t\teliminarColor(id: $id) {\n\t\t\tmessage\n\t\t}\n\t}\n"])));function Ln(e){var t=e.refetch,a=Object(l.useState)({}),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)({nombre:"",hex:""}),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)({message:"",status:"",open:!1}),u=Object(g.a)(j,2),m=u[0],O=u[1],x=JSON.parse(localStorage.getItem("sesionCafi")),h=Object(l.useState)(!1),_=Object(g.a)(h,2),v=_[0],y=_[1],I=function(){return y(!v)},k=Object(z.a)($n),N=Object(g.a)(k,1)[0],P=function(){var e=Object(f.a)(C.a.mark((function e(a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),s.nombre&&s.hex){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,n=s,e.next=7,N({variables:{input:{nombre:n.nombre,hex:n.hex,empresa:x.empresa._id,sucursal:x.sucursal._id}}});case 7:t(),d({nombre:"",hex:""}),O({message:"\xa1Listo!",status:"success",open:!0}),I(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),O({message:"Hubo un error",status:"error",open:!0});case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",children:Object(B.jsxs)(w.a,{color:"primary",onClick:function(){return I()},children:[Object(B.jsx)(It.a,{}),"nuevo color"]})}),Object(B.jsxs)(Ee.a,{open:v,scroll:"paper",disableEscapeKeyDown:!0,onClose:function(e,t){"backdropClick"!==t&&I()},children:[Object(B.jsx)(Ae.a,{children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(J,{alert:m,setAlert:O}),Object(B.jsx)(Wn.a,{color:c,onChangeComplete:function(e){r(e),d(Object(b.a)(Object(b.a)({},s),{},{hex:e.hex.toUpperCase()}))}}),Object(B.jsxs)(p.a,{mt:2,children:[Object(B.jsx)(S.a,{children:"Color seleccionado:"}),s.hex?Object(B.jsx)(p.a,{bgcolor:s.hex,height:30,width:220}):Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",width:220,children:Object(B.jsx)(S.a,{color:"secondary",children:"NINGUNO"})})]}),Object(B.jsx)(p.a,{my:2,children:Object(B.jsx)("form",{id:"form-registro-color",onSubmit:function(e){return P(e)},children:Object(B.jsx)(F.a,{label:"Nombre del color",variant:"outlined",size:"small",value:s.nombre,onChange:function(e){return d(Object(b.a)(Object(b.a)({},s),{},{nombre:e.target.value.toUpperCase()}))},fullWidth:!0,focused:!0})})})]})}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{variant:"outlined",color:"primary",onClick:function(){return I()},size:"large",children:"Cancelar"}),Object(B.jsx)(w.a,{variant:"contained",color:"primary",type:"submit",form:"form-registro-color",size:"large",startIcon:Object(B.jsx)(Dt.a,{}),children:"Guardar"})]})]})]})}var Un=Object(P.d)(Sn||(Sn=Object(N.a)(["\n\tmutation crearTalla($input: CrearTallaInput) {\n\t\tcrearTalla(input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Bn=Object(P.d)(Fn||(Fn=Object(N.a)(["\n\tquery obtenerTallas($empresa: ID!, $tipo: String! ) {\n\t\tobtenerTallas(empresa: $empresa, tipo: $tipo) {\n\t\t\t_id\n\t\t\ttalla\n\t\t\ttipo\n\t\t\tempresa {\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t\tsucursales_activas\n\t\t\t\tlimite_sucursales\n\t\t\t\t_id\n\t\t\t}\n\t\t}\n\t}\n"]))),qn=Object(P.d)(wn||(wn=Object(N.a)(["\n\tmutation actualizarTalla($input: ActualizarTallaInput, $id: ID!) {\n\t\tactualizarTalla(id: $id, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Jn=Object(P.d)(In||(In=Object(N.a)(["\n\tmutation eliminarTalla($input: ActualizarTallaInput,$id: ID!) {\n\t\teliminarTalla(id: $id, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"])));function Gn(e){var t=e.setMedidasSeleccionadas,a=e.refetch,n=Object(l.useState)(""),c=Object(g.a)(n,2),r=c[0],i=c[1],o=Object(l.useState)(!1),s=Object(g.a)(o,2),d=s[0],j=s[1],u=Object(l.useState)({message:"",status:"",open:!1}),b=Object(g.a)(u,2),m=b[0],O=b[1],x=JSON.parse(localStorage.getItem("sesionCafi")),h=Object(l.useContext)(fe).datos_generales,_=Object(z.a)(Un),v=Object(g.a)(_,1)[0],y=function(){return j(!d)},S=function(){var e=Object(f.a)(C.a.mark((function e(n){var c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),r){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,c=r,e.next=7,v({variables:{input:{talla:c,tipo:h.tipo_producto,empresa:x.empresa._id,sucursal:x.sucursal._id}}});case 7:a(),t([c]),i(""),O({message:"\xa1Listo!",status:"success",open:!0}),y(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),O({message:"Hubo un error",status:"error",open:!0});case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",children:Object(B.jsxs)(w.a,{color:"primary",onClick:function(){return y()},children:[Object(B.jsx)(It.a,{})," Nueva talla"]})}),Object(B.jsxs)(Ee.a,{open:d,scroll:"paper",disableEscapeKeyDown:!0,onClose:function(e,t){"backdropClick"!==t&&y()},children:[Object(B.jsx)(Ae.a,{children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(J,{alert:m,setAlert:O}),Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",my:2,children:Object(B.jsx)("form",{id:"form-registro-color",onSubmit:function(e){return S(e)},children:Object(B.jsx)(F.a,{id:"outlined-error-helper-text",label:"ROPA"===h.tipo_producto?"Talla":"N\xfamero",variant:"outlined",size:"small",focused:!0,fullWidth:!0,value:r,onChange:function(e){return i(e.target.value.toUpperCase())}})})})]})}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{variant:"outlined",color:"primary",onClick:function(){return y()},size:"large",children:"Cancelar"}),Object(B.jsx)(w.a,{variant:"contained",color:"primary",type:"submit",form:"form-registro-color",size:"large",startIcon:Object(B.jsx)(Dt.a,{}),children:"Guardar"})]})]})]})}var Hn=Object(k.a)((function(e){return{colorContainer:{border:"1px solid rgba(0,0,0, .3)",display:"flex",justifyContent:"center",alignItems:"center",height:50,width:50,margin:1,borderRadius:"15%",cursor:"pointer"},titulos:{fontWeight:500}}})),Yn=function(){return Math.floor(9e11*Math.random()+1e11).toString()};function Kn(e){var t=e.obtenerConsultasProducto,a=e.refetch,n=e.from,c=e.withoutPrice,r=Object(l.useContext)(fe),i=r.presentaciones,o=r.datos_generales,s=t.colores,d=t.tallas,j=t.calzados,u=Object(l.useState)([]),b=Object(g.a)(u,2),m=b[0],O=b[1],x=Object(l.useState)([]),h=Object(g.a)(x,2),_=h[0],f=h[1],v="ROPA"===o.tipo_producto?Object(da.a)(d):Object(da.a)(j),C=Object(l.useState)([]),y=Object(g.a)(C,2),F=y[0],w=y[1],I=Hn(),k=Object(l.useCallback)((function(){var e=[],t=[];Object(da.a)(i).forEach((function(a){a.color._id&&e.push(a.color),a.medida._id&&t.push(a.medida)}));var a={},n={},c=e.filter((function(e){var t=!a[e._id];return a[e._id]=!0,t})),r=t.filter((function(e){var t=!n[e._id];return n[e._id]=!0,t}));f(Object(da.a)(c)),O(Object(da.a)(r))}),[i]);return Object(l.useEffect)((function(){k()}),[k]),Object(B.jsx)("div",{children:Object(B.jsxs)(p.a,{children:[Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:6,children:Object(B.jsxs)(p.a,{width:"100%",style:F.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(S.a,{className:I.titulos,children:"ROPA"===o.tipo_producto?"Talla":"N\xfamero"}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(Gn,{setMedidasSeleccionadas:O,refetch:a})]}),Object(B.jsx)($e.a,{container:!0,children:v.map((function(e,t){return Object(B.jsx)(Qn,{talla:e,coloresSeleccionados:_,medidasSeleccionadas:m,setMedidasSeleccionadas:O},t)}))})]})}),Object(B.jsx)($e.a,{item:!0,md:6,children:Object(B.jsxs)(p.a,{width:"100%",style:F.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(S.a,{className:I.titulos,children:"Color"}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(Ln,{refetch:a})]}),Object(B.jsx)($e.a,{container:!0,children:s.map((function(e,t){return Object(B.jsx)(Xn,{color:e,coloresSeleccionados:_,setColoresSeleccionados:f,medidasSeleccionadas:m},t)}))})]})})]}),Object(B.jsx)(p.a,{mt:3}),Object(B.jsx)(cn,{from:n,withoutPrice:c,setOnUpdate:w,onUpdate:F})]})})}var Qn=function(e){var t=e.talla,a=e.coloresSeleccionados,n=e.medidasSeleccionadas,c=e.setMedidasSeleccionadas,r=Hn(),i=Object(Se.a)(),o=Object(l.useContext)(fe),s=o.setPresentaciones,d=o.presentaciones,j=o.datos_generales,u=o.preciosP,b=o.precios,p=o.presentaciones_eliminadas,m=o.setPresentacionesEliminadas,O=o.almacen_existente,x=Object(l.useState)(!1),h=Object(g.a)(x,2),_=h[0],f=h[1],v=Object(l.useCallback)((function(){n.forEach((function(e){e._id===t._id&&f(!0)}))}),[t._id,n]);Object(l.useEffect)((function(){if(O)return v()}),[v]);return Object(B.jsx)($e.a,{item:!0,children:Object(B.jsx)("div",{className:r.colorContainer,onClick:function(){return function(e){var r=Object(da.a)(n);_?r.forEach((function(a,n){a._id===t._id&&(r.splice(n,1),f(e),d.forEach((function(e){e.nuevo||e.medida._id===a._id&&m([].concat(Object(da.a)(p),[e]))})))})):(r.push(t),f(e));var i=[],o=Object(da.a)(d),l=b.iva,O=b.ieps;if(a.length||o.length){if(!a.length&&o.length>0)for(var x=function(e){var t=r[e],a=o.filter((function(e){return e.medida._id===t._id})),n=parseFloat((u[0].precio_venta*parseFloat("0.".concat(l<10?"0".concat(l):l))).toFixed(2)),c=parseFloat((u[0].precio_venta*parseFloat("0.".concat(O<10?"0".concat(O):O))).toFixed(2));a.length?i.push(a[0]):i.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:!1,codigo_barras:Yn(),nombre_comercial:j.nombre_comercial,medida:t,color:{nombre:"",hex:""},precio:u[0].precio_neto,cantidad:0,cantidad_nueva:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:n,ieps_precio:c,utilidad:u[0].utilidad,unidad_maxima:!1}})},h=0;h<r.length;h++)x(h);else if(a.length>0&&1===r.length&&e)for(var g=0;g<o.length;g++)for(var v=0;v<r.length;v++)i.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:o[g].existencia,codigo_barras:o[g].codigo_barras,nombre_comercial:o[g].nombre_comercial,medida:r[v],color:o[g].color,precio:o[g].precio,cantidad:o[g].cantidad,cantidad_nueva:o[g].cantidad_nueva,nuevo:!0,precio_unidad:o[g].precio_unidad});else if(a.length>0&&r.length>0)for(var C=function(e){for(var t=r[e],n=function(e){var n=a[e],c=o.filter((function(e){return e.medida._id===t._id&&n._id===e.color._id})),r=parseFloat((u[0].precio_venta*parseFloat("0.".concat(l<10?"0".concat(l):l))).toFixed(2)),s=parseFloat((u[0].precio_venta*parseFloat("0.".concat(O<10?"0".concat(O):O))).toFixed(2));c.length?i.push(c[0]):i.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:!1,codigo_barras:Yn(),nombre_comercial:j.nombre_comercial,medida:t,color:n,precio:u[0].precio_neto,cantidad:0,cantidad_nueva:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:r,ieps_precio:s,utilidad:u[0].utilidad,unidad_maxima:!1}})},c=0;c<a.length;c++)n(c)},y=0;y<r.length;y++)C(y);else if(a.length>0&&!r.length&&o.filter((function(e){return e.medida._id})).length)for(var S=0;S<o.length;S++){var F=o[S];i.push({_id:F._id,unidad:"Pz",codigo_unidad:"H87",existencia:F.existencia,codigo_barras:F.codigo_barras,nombre_comercial:F.nombre_comercial,medida:{},color:F.color,precio:F.precio,cantidad:F.cantidad,cantidad_nueva:F.cantidad_nueva,nuevo:!0,precio_unidad:F.precio_unidad})}}else for(var w=0;w<r.length;w++){var I=r[w],k=parseFloat((u[0].precio_venta*parseFloat("0.".concat(l<10?"0".concat(l):l))).toFixed(2)),z=parseFloat((u[0].precio_venta*parseFloat("0.".concat(O<10?"0".concat(O):O))).toFixed(2));i.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:!1,codigo_barras:Yn(),nombre_comercial:j.nombre_comercial,medida:I,color:{nombre:"",hex:""},precio:u[0].precio_neto,cantidad:0,cantidad_nueva:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:k,ieps_precio:z,utilidad:u[0].utilidad,unidad_maxima:!1}})}c(Object(da.a)(r)),s(i)}(!_)},style:_?{backgroundColor:i.palette.primary.main}:null,children:Object(B.jsx)(S.a,{variant:"button",style:{color:i.palette.getContrastText(_?i.palette.primary.main:"#FFFFFF"),fontSize:16},children:t.talla})})})},Xn=function(e){var t=e.color,a=e.coloresSeleccionados,n=e.setColoresSeleccionados,c=e.medidasSeleccionadas,r=Hn(),i=Object(Se.a)(),o=Object(l.useContext)(fe),s=o.presentaciones,d=o.setPresentaciones,j=o.datos_generales,u=o.preciosP,b=o.precios,p=o.presentaciones_eliminadas,m=o.setPresentacionesEliminadas,O=o.almacen_existente,x=Object(l.useState)(!1),h=Object(g.a)(x,2),_=h[0],f=h[1],v=Object(l.useCallback)((function(){a.forEach((function(e){e._id===t._id&&f(!0)}))}),[t._id,a]);Object(l.useEffect)((function(){if(O)return v()}),[v]);return Object(B.jsx)($e.a,{item:!0,children:Object(B.jsx)(ha.a,{title:t.nombre,placement:"top",arrow:!0,TransitionComponent:Xa.a,children:Object(B.jsx)("div",{className:r.colorContainer,style:{backgroundColor:t.hex,color:i.palette.getContrastText(t.hex)},onClick:function(){return function(e){_?a.forEach((function(n,c){n._id===t._id&&(a.splice(c,1),f(e),s.forEach((function(e){e.nuevo||e.color._id===n._id&&m([].concat(Object(da.a)(p),[e]))})))})):(a.push(t),f(e));var r=[],i=Object(da.a)(s),o=b.iva,l=b.ieps;if(c.length||i.length){if(!c.length&&i.length>0)for(var O=function(e){var t=a[e],n=i.filter((function(e){return e.color._id===t._id})),c=parseFloat((u[0].precio_venta*parseFloat("0.".concat(o<10?"0".concat(o):o))).toFixed(2)),s=parseFloat((u[0].precio_venta*parseFloat("0.".concat(l<10?"0".concat(l):l))).toFixed(2));n.length?r.push(n[0]):r.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:!1,codigo_barras:Yn(),nombre_comercial:j.nombre_comercial,medida:{},color:t,precio:u[0].precio_neto,cantidad:0,cantidad_nueva:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:c,ieps_precio:s,utilidad:u[0].utilidad,unidad_maxima:!1}})},x=0;x<a.length;x++)O(x);else if(c.length>0&&1===a.length&&e)for(var h=0;h<i.length;h++)for(var g=0;g<a.length;g++)r.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:i[h].existencia,codigo_barras:i[h].codigo_barras,nombre_comercial:i[h].nombre_comercial,medida:i[h].medida,color:a[g],precio:i[h].precio,cantidad:i[h].cantidad,cantidad_nueva:i[h].cantidad_nueva,nuevo:!0,precio_unidad:i[h].precio_unidad});else if(c.length>0&&a.length>0)for(var v=function(e){for(var t=a[e],n=function(e){var a=c[e],n=i.filter((function(e){return e.medida._id===a._id&&t._id===e.color._id})),s=parseFloat((u[0].precio_venta*parseFloat("0.".concat(o<10?"0".concat(o):o))).toFixed(2)),d=parseFloat((u[0].precio_venta*parseFloat("0.".concat(l<10?"0".concat(l):l))).toFixed(2));n.length?r.push(n[0]):r.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:!1,codigo_barras:Yn(),nombre_comercial:j.nombre_comercial,medida:a,color:t,precio:u[0].precio_neto,cantidad:0,cantidad_nueva:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:s,ieps_precio:d,utilidad:u[0].utilidad,unidad_maxima:!1}})},s=0;s<c.length;s++)n(s)},C=0;C<a.length;C++)v(C);else if(c.length>0&&!a.length&&i.filter((function(e){return e.color._id})).length)for(var y=0;y<i.length;y++){var S=i[y];r.push({_id:S._id,unidad:"Pz",codigo_unidad:"H87",existencia:S.existencia,codigo_barras:S.codigo_barras,nombre_comercial:S.nombre_comercial,medida:S.medida,color:{nombre:"",hex:""},precio:S.precio,cantidad:S.cantidad,cantidad_nueva:S.cantidad_nueva,nuevo:!0,precio_unidad:S.precio_unidad})}}else for(var F=0;F<a.length;F++){var w=a[F],I=parseFloat((u[0].precio_venta*parseFloat("0.".concat(o<10?"0".concat(o):o))).toFixed(2)),k=parseFloat((u[0].precio_venta*parseFloat("0.".concat(l<10?"0".concat(l):l))).toFixed(2));r.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:!1,codigo_barras:Yn(),nombre_comercial:j.nombre_comercial,medida:{},color:w,precio:u[0].precio_neto,cantidad:0,cantidad_nueva:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:I,ieps_precio:k,utilidad:u[0].utilidad,unidad_maxima:!1}})}n(Object(da.a)(a)),d(r)}(!_)},children:_?Object(B.jsx)(Dt.a,{}):null})})})},Zn=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function ec(e){var t=e.verificate,a=e.setVerificate,n=Object(l.useState)(!1),c=Object(g.a)(n,2),r=c[0],i=c[1],o=JSON.parse(localStorage.getItem("sesionCafi")),s=Object(l.useContext)(qa),d=s.datosProducto,j=s.datosCompra,u=(s.setLoadingProductos,Object(qe.a)(kn,{variables:{empresa:o.empresa._id,sucursal:o.sucursal._id}})),b=u.loading,p=u.data,m=u.error,O=u.refetch;if(b)return Object(B.jsx)(w.a,{color:"primary",size:"medium",disabled:!0,startIcon:Object(B.jsx)(I.a,{size:16,color:"inherit"}),children:"Medidas"});if(m)return Object(B.jsx)(Ze,{error:m});var x=p.obtenerConsultasProducto,h=function(){i(!r),a(!1)};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(ha.a,{title:"Selecciona medidas y colores",disableHoverListener:!0,open:t,placement:"top",children:Object(B.jsx)(w.a,{color:t?"secondary":"inherit",variant:"outlined",size:"medium",onClick:function(){return h()},startIcon:Object(B.jsx)(Ba.a,{}),disabled:!d.producto.datos_generales,children:"Medidas"})}),Object(B.jsxs)(Ee.a,{open:r,TransitionComponent:Zn,keepMounted:!0,onClose:h,"aria-labelledby":"alert-tallas-compra","aria-describedby":"alert-tallas-compra-description",fullWidth:!0,maxWidth:"lg",children:[Object(B.jsx)(Ae.a,{children:Object(B.jsx)(Kn,{datos:d.producto,obtenerConsultasProducto:x,refetch:O,from:"compra",almacen:j.almacen,withoutPrice:!0})}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{size:"large",onClick:function(){return h()},startIcon:Object(B.jsx)(Dt.a,{}),color:"primary",variant:"contained",children:"Aceptar"})})]})]})}var tc=a(92),ac=a.n(tc),nc=a(911),cc=a(907),rc=a(866),ic=a(822),oc=a(906),sc=a(905),lc=a(116),dc=a.n(lc),jc="QUJTT0xVQ0lPTkVTOkxlb24yMDE4Iw==",uc="https://apisandbox.facturama.mx/";dc.a.ajaxSetup({beforeSend:function(e){e.withCredentials=!0,e.setRequestHeader("Authorization","Basic "+jc)}});var bc,pc,mc,Oc=function(){var e={url:uc};function t(t,a,n){return dc.a.get(e.url+t+"/"+a,void 0,n,"json")}function a(t,a){return dc.a.get(e.url+t,void 0,a,"json")}function n(t,a,n,c){dc.a.ajax({url:e.url+t,type:"POST",dataType:"json",data:JSON.stringify(a),contentType:"application/json",success:n,error:c})}function c(t,a,n,c){dc.a.ajax({url:e.url+t,type:"PUT",data:JSON.stringify(a),contentType:"application/json",success:n,error:c})}function r(t,a,n,c){dc.a.ajax({url:e.url+t+"/"+a,type:"DELETE",async:!1,success:n,error:c})}var i={Clients:{Get:function(e,a){return t("client",e,a)},List:function(e){return a("client",e)},Create:function(e,t,a){n("client",e,t,a)},Remove:function(e,t,a){r("client/",e,t,a)},Update:function(e,t,a,n){c("client/"+e,t,a,n)}},Products:{Get:function(e,a){return t("product",e,a)},List:function(e){return a("product",e)},Create:function(e,t,a){n("product",e,t,a)},Remove:function(e,t,a){r("product/",e,t,a)},Update:function(e,t,a,n){c("product/"+e,t,a,n)}},BranchOffice:{Get:function(e,a){return t("branchOffice",e,a)},List:function(e){return a("branchOffice",e)},Create:function(e,t,a){n("branchOffice",e,t,a)},Remove:function(e,t,a){r("branchOffice",e,t,a)},Update:function(e,t,a,n){c("branchOffice/"+e,t,a,n)}},Series:{List:function(e,a){return t("serie",e,a)},Create:function(e,t,a,c){n("serie/"+e,t,a,c)},Remove:function(e,t,a,n){r("serie/"+e,t,a,n)},Update:function(e,t,a,n,r){c("serie/"+e+"/"+t,a,n,r)}},Cfdi:{Get:function(e,a){return t("cfdi",e,a)},List:function(t,a){return function(t,a,n){return dc.a.get(e.url+t+a,void 0,n,"json")}("cfdi",t,a)},Create:function(e,t,a){n("2/cfdis",e,t,a)},Send:function(t,a){!function(t,a,n){dc.a.ajax({url:e.url+t+a,type:"POST",async:!1,success:n})}("cfdi",t,a)},Cancel:function(e,t,a){r("cfdi",e,t,a)},Download:function(e,a,n,c){t("cfdi/"+e+"/"+a,n,c)},Acuse:function(e,a,n,c){t("acuse/"+e+"/"+a,n,c)}},TaxEntity:{Get:function(e){return a("taxEntity",e)},Update:function(e,t,a){c("taxEntity",e,t,a)},UploadCsd:function(e,t,a){c("taxEntity/UploadCsd",e,t,a)},UploadImage:function(e,t,a){c("taxEntity/UploadLogo",e,t,a)}},Catalogs:{States:function(e,t){return a("catalogs/municipalities?countryCode"+e,t)},Municipalities:function(e,t){return a("catalogs/municipalities?stateCode"+e,t)},Localities:function(e,t){return a("catalogs/localities?stateCode"+e,t)},Neighborhoods:function(e,t){return a("catalogs/neighborhoods?postalCode"+e,t)},ProductsOrServices:function(e,t){return a("catalogs/ProductsOrServices?keyword="+e,t)},PostalCodes:function(e,t){return a("catalogs/PostalCodes?keyword="+e,t)},Units:function(e){return a("catalogs/Units",e)},Currencies:function(e){return a("catalogs/Currencies",e)},Countries:function(e){return a("catalogs/Countries",e)},PaymentForms:function(e){return a("catalogs/PaymentForms",e)},PaymentMethods:function(e){return a("catalogs/PaymentMethods",e)},FederalTaxes:function(e){return a("catalogs/FederalTaxes",e)},FiscalRegimens:function(e){return a("catalogs/FiscalRegimens",e)},CfdiTypes:function(e){return a("catalogs/CfdiTypes",e)},RelationTypes:function(e){return a("catalogs/RelationTypes",e)},CfdiUses:function(e,t){return a("catalogs/CfdiUses?keyword="+e,t)}},getToken:function(){return"Basic "+jc},getBaseUri:function(){return e.url}};return i}(),xc=Object(P.d)(bc||(bc=Object(N.a)(["\n  mutation crearCodigoProducto($input: CodigoCatalogoProductoInput) {\n    crearCodigoProducto(input: $input) {\n      message\n    }\n  }\n"]))),hc=(Object(P.d)(pc||(pc=Object(N.a)(["\n  query obtenerCodigosProducto($empresa: ID!, $sucursal: ID) {\n    obtenerCodigosProducto(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      Name\n      Value\n      empresa {\n        _id\n        nombre_empresa\n      }\n      sucursal {\n        _id\n        nombre_sucursal\n      }\n    }\n  }\n"]))),Object(P.d)(mc||(mc=Object(N.a)(["\n  mutation eliminarCodigoProducto($id: ID!) {\n    eliminarCodigoProducto(id: $id) {\n      message\n    }\n  }\n"])))),_c=a(965),fc=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),gc=Object(k.a)((function(e){return{root:{width:"100%",backgroundColor:e.palette.background.paper},spin_container:{position:"absolute",height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},spin:{zIndex:9999},titulos:{fontWeight:500}}}));function vc(e){var t=e.codigos,a=e.refetch,n=gc(),c=JSON.parse(localStorage.getItem("sesionCafi")),r=d.a.useState(!1),i=Object(g.a)(r,2),o=i[0],s=i[1],j=Object(l.useContext)(fe),u=j.datos_generales,m=j.setDatosGenerales,O=Object(l.useState)(""),x=Object(g.a)(O,2),h=x[0],_=x[1],v=Object(l.useState)([]),y=Object(g.a)(v,2),k=y[0],N=y[1],P=Object(l.useState)(!1),D=Object(g.a)(P,2),E=D[0],A=D[1],T=Object(l.useState)(!1),W=Object(g.a)(T,2),$=W[0],R=W[1],V=Object(l.useState)(!1),M=Object(g.a)(V,2),L=M[0],U=M[1],q=Object(l.useState)({}),G=Object(g.a)(q,2),H=G[0],Y=G[1],K=Object(l.useState)(""),Z=Object(g.a)(K,2),ee=Z[0],te=Z[1],ae=Object(l.useState)({message:"",status:"",open:!1}),ne=Object(g.a)(ae,2),ce=ne[0],re=ne[1],ie=Object(z.a)(xc),oe=Object(g.a)(ie,1)[0],se=Object(z.a)(hc),le=Object(g.a)(se,1)[0],de=function(){Y({}),N([]),_(""),s(!1)},je=Object(_c.a)(h,500),ue=Object(g.a)(je,1)[0],be=function(){var e=Object(f.a)(C.a.mark((function e(t){var n,r,i,o;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.Name,r=t.Value,m(Object(b.a)(Object(b.a)({},u),{},{clave_producto_sat:{Name:n,Value:r}})),e.prev=2,R(!0),e.next=6,oe({variables:{input:{Name:n,Value:r,empresa:c.empresa._id,sucursal:c.sucursal._id}}});case 6:(i=e.sent)&&(o=i.data.crearCodigoProducto.message,re({message:o,status:"success",open:!0}),R(!1),a(),de()),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),R(!1),re({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=Object(f.a)(C.a.mark((function e(t){var n,c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,U(!0),e.next=4,le({variables:{id:t._id}});case 4:(n=e.sent)&&(c=n.data.eliminarCodigoProducto.message,re({message:c,status:"success",open:!0}),m(Object(b.a)(Object(b.a)({},u),{},{clave_producto_sat:{Name:"",Value:""}})),U(!1),a()),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),U(!1),re({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),me=function(){de()},Oe=function(){var e=Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ue){e.next=3;break}return N([]),e.abrupt("return");case 3:return A(!0),e.prev=4,e.next=7,Oc.Catalogs.ProductsOrServices(ue,(function(e){N(e),A(!1)}),(function(e){e&&e.responseJSON&&te(e.responseJSON),A(!1)}));case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(4),e.t0&&e.t0.responseJSON&&te(e.t0.responseJSON.Message),A(!1);case 13:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(){return e.apply(this,arguments)}}();return Object(l.useEffect)((function(){Oe()}),[ue]),Object(B.jsxs)("div",{children:[Object(B.jsx)(J,{alert:ce,setAlert:re}),Object(B.jsx)(S.a,{className:n.titulos,children:"Clave de producto SAT"}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(ja.a,{id:"catalogos-bd-productos",size:"small",options:t,disabled:L,getOptionLabel:function(e){return e.Name?"".concat(e.Value," - ").concat(e.Name):""},fullWidth:!0,renderInput:function(e){return Object(B.jsx)(F.a,Object(b.a)(Object(b.a)({},e),{},{variant:"outlined",InputProps:Object(b.a)(Object(b.a)({},e.InputProps),{},{endAdornment:Object(B.jsxs)(l.Fragment,{children:[L?Object(B.jsx)(I.a,{size:20}):null,e.InputProps.endAdornment]})})}))},renderOption:function(e){return Object(B.jsxs)(l.Fragment,{children:["".concat(e.Value," - ").concat(e.Name),Object(B.jsx)("div",{style:{flexGrow:1}}),Object(B.jsx)(X.a,{size:"small",onClick:function(){return pe(e)},children:Object(B.jsx)(Pt.a,{})})]})},onChange:function(e,t){return function(e){if(!e)return m(Object(b.a)(Object(b.a)({},u),{},{clave_producto_sat:{Name:"",Value:""}})),null;m(Object(b.a)(Object(b.a)({},u),{},{clave_producto_sat:{Name:e.Name,Value:e.Value}}))}(t)},getOptionSelected:function(e,t){return e.Value===t.Value},value:u.clave_producto_sat}),Object(B.jsx)(w.a,{color:"primary",onClick:function(){return s(!0)},children:Object(B.jsx)(sc.a,{})})]}),Object(B.jsxs)(Ee.a,{open:o,TransitionComponent:fc,keepMounted:!0,onClose:me,"aria-labelledby":"alert-dialog-clave-producto",fullWidth:!0,maxWidth:"sm",children:[Object(B.jsx)(wt.a,{id:"alert-dialog-clave-producto",children:Object(B.jsxs)(p.a,{display:"flex",justifyContent:"space-between",children:[Object(B.jsx)(S.a,{variant:"h6",children:"Catalogo de productos y servicios SAT"}),Object(B.jsx)(p.a,{children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){return me()},size:"large",disabled:$,children:Object(B.jsx)(Pt.a,{})})})]})}),$?Object(B.jsx)("div",{className:n.spin_container,children:Object(B.jsx)(I.a,{className:n.spin,size:35})}):null,Object(B.jsxs)("div",{style:$?{pointerEvents:"none",opacity:.4}:null,children:[Object(B.jsxs)(p.a,{p:2,children:[Object(B.jsx)(F.a,{variant:"outlined",label:"producto, servicio o giro de la empresa",fullWidth:!0,size:"small",onChange:function(e){_(e.target.value),te("")},value:h,InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:Object(B.jsx)(sc.a,{color:"disabled"})})},error:!!ee,helperText:ee||""}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(St.a,{severity:"info",children:"Para seleccionar un cliente haz un doble click!"})})]}),Object(B.jsx)(Ae.a,{style:{height:"50vh"},children:Object(B.jsx)(p.a,{my:3,className:n.root,children:E?Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"25vh",children:Object(B.jsx)(I.a,{})}):Object(B.jsx)(rc.a,{dense:!0,component:"nav","aria-label":"main mailbox folders",children:k.map((function(e,t){return Object(B.jsx)($c,{producto:e,busqueda:h,handleOk:be,setSelectedIndex:Y,selectedIndex:H},t)}))})})}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{onClick:function(){return me()},children:"Cancelar"})})]})]})]})}var Cc,yc,Sc,Fc,wc,Ic,kc,zc,Nc,Pc,Dc,Ec,Ac,Tc,Wc,$c=function(e){var t=e.producto,a=e.busqueda,n=e.handleOk,c=e.selectedIndex,r=e.setSelectedIndex,i=a.includes("potacio");return"0"!==t.Value||i?Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(ic.a,{button:!0,selected:c.Value===t.Value,onClick:function(e){return a=e.detail,r(c=t),void(2===a&&n(c));var a,c},children:Object(B.jsx)(oc.a,{primary:"".concat(t.Value," - ").concat(t.Name)})}),Object(B.jsx)(Le.a,{})]}):null},Rc=Object(P.d)(Cc||(Cc=Object(N.a)(["\n\tmutation crearCategoria($input: CrearCategoriasInput) {\n\t\tcrearCategoria(input: $input) {\n\t\t\t_id\n\t\t\tcategoria\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t}\n\t}\n"]))),Vc=Object(P.d)(yc||(yc=Object(N.a)(["\n\tmutation crearSubcategoria($idCategoria: ID!, $input: CrearSubcategoriasInput) {\n\t\tcrearSubcategoria(idCategoria: $idCategoria, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Mc=Object(P.d)(Sc||(Sc=Object(N.a)(["\n\tmutation actualizarCategoria($idCategoria: ID!, $input: ActualizarCategoriasInput) {\n\t\tactualizarCategoria(idCategoria: $idCategoria, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Lc=Object(P.d)(Fc||(Fc=Object(N.a)(["\n\tmutation actualizarSubcategoria($idCategoria: ID!, $idSubcategoria: ID!, $input: ActualizarSubcategoriasInput) {\n\t\tactualizarSubcategoria(idCategoria: $idCategoria, idSubcategoria: $idSubcategoria, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Uc=Object(P.d)(wc||(wc=Object(N.a)(["\n\tquery obtenerCategorias($empresa: ID!, $sucursal: ID!) {\n\t\tobtenerCategorias(empresa: $empresa, sucursal: $sucursal) {\n\t\t\t_id\n\t\t\tcategoria\n\t\t\tsubcategorias {\n\t\t\t\t_id\n\t\t\t\tsubcategoria\n\t\t\t}\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t}\n\t}\n"]))),Bc=Object(P.d)(Ic||(Ic=Object(N.a)(["\n\tmutation eliminarCategoria($idCategoria: ID!) {\n\t\teliminarCategoria(idCategoria: $idCategoria) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),qc=Object(P.d)(kc||(kc=Object(N.a)(["\n\tmutation eliminarSubcategoria($idCategoria: ID!, $idSubcategoria: ID!) {\n\t\teliminarSubcategoria(idCategoria: $idCategoria, idSubcategoria: $idSubcategoria) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Jc=Object(P.d)(zc||(zc=Object(N.a)(["\n\tquery ObtenerDepartamentos($empresa: ID!, $sucursal: ID!){\n        obtenerDepartamentos(empresa: $empresa, sucursal: $sucursal){\n            _id\n            nombre_departamentos\n            empresa{\n                _id\n                nombre_empresa\n            }\n            sucursal{\n                _id\n                nombre_sucursal\n            }\n        }\n    }\n"]))),Gc=Object(P.d)(Nc||(Nc=Object(N.a)(["\n\tmutation CrearDepartamentos($input: DepartamentosInput, $empresa: ID!, $sucursal: ID!){\n        crearDepartamentos(input: $input, empresa: $empresa, sucursal: $sucursal){\n            message\n        }\n    }\n"]))),Hc=Object(P.d)(Pc||(Pc=Object(N.a)(["\n\tmutation ActualzarDepartamentos($input: DepartamentosInput, $id: ID!){\n        actualzarDepartamentos(input: $input, id: $id){\n            message\n        }\n    }\n"]))),Yc=Object(P.d)(Dc||(Dc=Object(N.a)(["\n    mutation EliminarDepartamento($id: ID!){\n        eliminarDepartamento(id: $id){\n            message\n        }\n    }\n\t\n"]))),Kc=Object(P.d)(Ec||(Ec=Object(N.a)(["\n    query ObtenerMarcas($empresa: ID!, $sucursal: ID!){\n        obtenerMarcas(empresa: $empresa, sucursal: $sucursal){\n            _id\n            nombre_marca\n        }\n    }\n"]))),Qc=Object(P.d)(Ac||(Ac=Object(N.a)(["\n    mutation CrearMarca($input: MarcasInput!, $empresa: ID!, $sucursal: ID!){\n        crearMarcas(input: $input, empresa: $empresa, sucursal: $sucursal ){\n            message\n        }\n    }\n"]))),Xc=Object(P.d)(Tc||(Tc=Object(N.a)(["\n    mutation actualzarMarcas($input: MarcasInput, $id: ID! ) {\n\t\tactualzarMarcas(id: $id, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Zc=Object(P.d)(Wc||(Wc=Object(N.a)(["\n\tmutation eliminarMarca($id: ID!, $empresa: ID!, $sucursal: ID!) {\n\t\teliminarMarca(id: $id, empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"])));function er(e){var t=e.tipo,a=e.name,n=e.refetch,c=e.subcategorias,r=e.setSubcategorias,i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(!1),u=Object(g.a)(j,2),p=u[0],m=u[1],O=Object(l.useState)(!1),x=Object(g.a)(O,2),h=x[0],v=x[1],y=Object(l.useState)(""),S=Object(g.a)(y,2),k=S[0],N=S[1],P=JSON.parse(localStorage.getItem("sesionCafi")),D=Object(l.useContext)(fe),E=D.datos_generales,A=D.setDatosGenerales,T=Object(l.useState)({message:"",status:"",open:!1}),W=Object(g.a)(T,2),$=W[0],R=W[1],V=Object(z.a)(Rc),M=Object(g.a)(V,1)[0],L=Object(z.a)(Vc),U=Object(g.a)(L,1)[0],q=Object(z.a)(Gc),G=Object(g.a)(q,1)[0],H=Object(z.a)(Qc),Y=Object(g.a)(H,1)[0],K=function(){d(!s)},Q=function(){var e=Object(f.a)(C.a.mark((function e(i){var o,s,l,d,j,u,p,O,x,h;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.preventDefault(),k){e.next=4;break}return m(!0),e.abrupt("return");case 4:o={input:Object(_.a)({},a,k),empresa:P.empresa._id,sucursal:P.sucursal._id},"categoria"===t&&(o={input:(s={},Object(_.a)(s,a,k),Object(_.a)(s,"empresa",P.empresa._id),Object(_.a)(s,"sucursal",P.sucursal._id),s)}),"subcategoria"===t&&(o={input:Object(_.a)({},a,k),idCategoria:E.id_categoria}),v(!0),e.prev=8,e.t0=t,e.next="categoria"===e.t0?12:"subcategoria"===e.t0?19:"departamento"===e.t0?27:"marca"===e.t0?34:41;break;case 12:return e.next=14,M({variables:o});case 14:return l=e.sent,n(),d=l.data.crearCategoria._id,A(Object(b.a)(Object(b.a)({},E),{},{categoria:k,id_categoria:d})),e.abrupt("break",42);case 19:return e.next=21,U({variables:o});case 21:return j=e.sent,n(),u=j.data.crearSubcategoria.message,r([].concat(Object(da.a)(c),[{_id:u,subcategoria:k}])),A(Object(b.a)(Object(b.a)({},E),{},{subcategoria:k,id_subcategoria:u})),e.abrupt("break",42);case 27:return e.next=29,G({variables:o});case 29:return p=e.sent,n(),O=p.data.crearDepartamentos.message,A(Object(b.a)(Object(b.a)({},E),{},{departamento:k,id_departamento:O})),e.abrupt("break",42);case 34:return e.next=36,Y({variables:o});case 36:return x=e.sent,n(),h=x.data.crearMarcas.message,A(Object(b.a)(Object(b.a)({},E),{},{marca:k,id_marca:h})),e.abrupt("break",42);case 41:return e.abrupt("break",42);case 42:R({message:"\xa1Listo!",status:"success",open:!0}),v(!1),K(),e.next=51;break;case 47:e.prev=47,e.t1=e.catch(8),v(!1),e.t1.message?R({message:e.t1.message,status:"error",open:!0}):R({message:"Hubo un error",status:"error",open:!0});case 51:case"end":return e.stop()}}),e,null,[[8,47]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(w.a,{color:"primary",onClick:function(){return K()},disabled:"subcategoria"===t&&!E.id_categoria,children:Object(B.jsx)(It.a,{})}),Object(B.jsxs)(Ee.a,{open:s,onClose:K,"aria-labelledby":"modal-title-".concat(t),children:[Object(B.jsx)(J,{alert:$,setAlert:R}),Object(B.jsxs)(wt.a,{id:"modal-title-".concat(t),children:["Registrar ",t]}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)("form",{id:"registro-".concat(a),onSubmit:function(e){return Q(e)},children:Object(B.jsx)(F.a,{error:p,name:a,autoFocus:!0,label:t,fullWidth:!0,variant:"outlined",onChange:function(e){N(e.target.value)},helperText:p?"Campo obligatorio":""})})}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:function(){return K()},color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{form:"registro-".concat(a),type:"submit",variant:"contained",color:"primary",endIcon:h?Object(B.jsx)(I.a,{color:"inherit",size:18}):null,children:"Guardar"})]})]})]})}var tr=Object(k.a)((function(e){return{titulos:{fontWeight:500}}}));function ar(e){var t=e.categorias,a=e.refetch,n=tr(),c=Object(l.useContext)(fe),r=c.datos_generales,i=c.setDatosGenerales,o=c.setSubcategorias;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(S.a,{className:n.titulos,children:"Categoria"}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(ja.a,{id:"form-producto-categoria",size:"small",fullWidth:!0,options:t,getOptionLabel:function(e){return e.categoria},renderInput:function(e){return Object(B.jsx)(F.a,Object(b.a)(Object(b.a)({},e),{},{variant:"outlined"}))},onChange:function(e,t){return function(e,t){if(!t)return i(Object(b.a)(Object(b.a)({},r),{},{categoria:"",id_categoria:""})),void o([]);i(Object(b.a)(Object(b.a)({},r),{},{categoria:t.categoria,id_categoria:t._id})),o(t.subcategorias)}(0,t)},getOptionSelected:function(e,t){return e.categoria===t.categoria},value:r.categoria?r:null}),Object(B.jsx)(er,{tipo:"categoria",name:"categoria",refetch:a})]})]})}var nr=Object(k.a)((function(e){return{titulos:{fontWeight:500}}}));function cr(e){var t=e.refetch,a=nr(),n=Object(l.useContext)(fe),c=n.datos_generales,r=n.setDatosGenerales,i=n.subcategorias,o=n.setSubcategorias;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(S.a,{className:a.titulos,children:"Subcategoria"}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(ja.a,{id:"form-producto-subcategoria",size:"small",fullWidth:!0,options:i,getOptionLabel:function(e){return e.subcategoria},renderInput:function(e){return Object(B.jsx)(F.a,Object(b.a)(Object(b.a)({},e),{},{variant:"outlined"}))},onChange:function(e,t){return function(e,t){r(t?Object(b.a)(Object(b.a)({},c),{},{subcategoria:t.subcategoria,id_subcategoria:t._id}):Object(b.a)(Object(b.a)({},c),{},{subcategoria:"",id_subcategoria:""}))}(0,t)},getOptionSelected:function(e,t){return e.subcategoria===t.subcategoria},value:c.subcategoria?c:null}),Object(B.jsx)(er,{tipo:"subcategoria",name:"subcategoria",refetch:t,subcategorias:i,setSubcategorias:o})]})]})}var rr=Object(k.a)((function(e){return{titulos:{fontWeight:500}}}));function ir(e){var t=e.departamentos,a=e.refetch,n=rr(),c=Object(l.useContext)(fe),r=c.datos_generales,i=c.setDatosGenerales;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(S.a,{className:n.titulos,children:"Departamento"}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(ja.a,{id:"form-producto-departamento",size:"small",fullWidth:!0,options:t,getOptionLabel:function(e){return e.nombre_departamentos?e.nombre_departamentos:e.departamento},renderInput:function(e){return Object(B.jsx)(F.a,Object(b.a)(Object(b.a)({},e),{},{variant:"outlined"}))},onChange:function(e,t){return function(e,t){i(t?Object(b.a)(Object(b.a)({},r),{},{departamento:t.nombre_departamentos,id_departamento:t._id}):Object(b.a)(Object(b.a)({},r),{},{departamento:"",id_departamento:""}))}(0,t)},getOptionSelected:function(e,t){return e.nombre_departamentos===t.departamento},value:r.departamento?r:null}),Object(B.jsx)(er,{tipo:"departamento",name:"nombre_departamentos",refetch:a})]})]})}var or=Object(k.a)((function(e){return{titulos:{fontWeight:500}}}));function sr(e){var t=e.marcas,a=e.refetch,n=or(),c=Object(l.useContext)(fe),r=c.datos_generales,i=c.setDatosGenerales;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(S.a,{className:n.titulos,children:"Marca"}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(ja.a,{id:"form-producto-marca",size:"small",fullWidth:!0,options:t,getOptionLabel:function(e){return e.nombre_marca?e.nombre_marca:e.marca},renderInput:function(e){return Object(B.jsx)(F.a,Object(b.a)(Object(b.a)({},e),{},{variant:"outlined"}))},onChange:function(e,t){return function(e,t){i(t?Object(b.a)(Object(b.a)({},r),{},{marca:t.nombre_marca,id_marca:t._id}):Object(b.a)(Object(b.a)({},r),{},{marca:"",id_marca:""}))}(0,t)},getOptionSelected:function(e,t){return e.nombre_marca===t.marca},value:r.marca?r:null}),Object(B.jsx)(er,{tipo:"marca",name:"nombre_marca",refetch:a})]})]})}var lr=Object(k.a)((function(e){return{formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},obligatorio:{color:"red"},titulos:{fontWeight:500},without_arrows:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}}}}));function dr(e){var t=e.obtenerConsultasProducto,a=e.refetch,n=lr(),c=Object(l.useContext)(fe),r=c.datos_generales,i=c.setDatosGenerales,o=c.validacion,s=c.precios,d=c.setPrecios,j=c.centro_de_costos,u=c.setSubcostos,m=Object(l.useContext)(fe),O=m.setSubcategorias,x=m.unidadVentaXDefecto,h=m.setUnidadVentaXDefecto,f=m.unidadVentaSecundaria,g=m.setUnidadVentaSecundaria,v=m.update,C=t.categorias,w=t.departamentos,I=t.marcas,k=t.centro_costos,z=t.codigos,N=function(e){var t=e.target,a=t.name,n=t.value;if("monedero_electronico"===a)return n?void d(Object(b.a)(Object(b.a)({},s),{},Object(_.a)({},a,parseFloat(n)))):void d(Object(b.a)(Object(b.a)({},s),{},Object(_.a)({},a,"")));"codigo_barras"===a&&h(Object(b.a)(Object(b.a)({},x),{},{codigo_barras:n})),"tipo_producto"===a&&"OTROS"!==n&&(d(Object(b.a)(Object(b.a)({},s),{},{granel:!1,inventario:Object(b.a)(Object(b.a)({},s.inventario),{},{unidad_de_inventario:"Pz",codigo_unidad:"H87"}),unidad_de_compra:Object(b.a)(Object(b.a)({},s.unidad_de_compra),{},{unidad:"Pz",codigo_unidad:"H87"})})),h(Object(b.a)(Object(b.a)({},x),{},{unidad:"Pz",codigo_unidad:"H87"})),g(Object(b.a)(Object(b.a)({},f),{},{unidad:"Caja",codigo_unidad:"XBX"}))),i(Object(b.a)(Object(b.a)({},r),{},Object(_.a)({},a,n)))},P=function(e){var t,a,n=e.target,c=n.name,r=n.checked;"monedero"===c&&r?d(Object(b.a)(Object(b.a)({},s),{},{monedero_electronico:1,monedero:r})):"granel"===c&&r?(d(Object(b.a)(Object(b.a)({},s),{},(t={},Object(_.a)(t,c,r),Object(_.a)(t,"inventario",Object(b.a)(Object(b.a)({},s.inventario),{},{unidad_de_inventario:"Kg",codigo_unidad:"KGM"})),Object(_.a)(t,"unidad_de_compra",Object(b.a)(Object(b.a)({},s.unidad_de_compra),{},{unidad:"Kg",codigo_unidad:"KGM"})),t))),h(Object(b.a)(Object(b.a)({},x),{},{unidad:"Kg",codigo_unidad:"KGM"})),g(Object(b.a)(Object(b.a)({},f),{},{unidad:"Costal",codigo_unidad:"KGM"}))):(d(Object(b.a)(Object(b.a)({},s),{},(a={},Object(_.a)(a,c,r),Object(_.a)(a,"inventario",Object(b.a)(Object(b.a)({},s.inventario),{},{unidad_de_inventario:"Pz",codigo_unidad:"H87"})),Object(_.a)(a,"unidad_de_compra",Object(b.a)(Object(b.a)({},s.unidad_de_compra),{},{unidad:"Pz",codigo_unidad:"H87"})),a))),h(Object(b.a)(Object(b.a)({},x),{},{unidad:"Pz",codigo_unidad:"H87"})),g(Object(b.a)(Object(b.a)({},f),{},{unidad:"Caja",codigo_unidad:"XBX"})))};return Object(l.useEffect)((function(){if(v){var e=C.filter((function(e){return e._id===r.id_categoria})),t=k.filter((function(e){return e._id===j.id_cuenta}));e.length>0&&O(e[0].subcategorias),t.length>0&&u(t[0].subcuentas)}}),[v]),Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)(y.a,{maxWidth:"lg",children:[Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:3,xs:12,children:Object(B.jsxs)(H.a,{variant:"outlined",size:"small",name:"codigo_barras",fullWidth:!0,className:n.without_arrows,children:[Object(B.jsx)(S.a,{className:n.titulos,children:"C\xf3digo de barras"}),Object(B.jsx)(K.a,{disabled:v&&r.codigo_barras,style:{padding:0},id:"form-producto-codigo-barras",name:"codigo_barras",value:r.codigo_barras?r.codigo_barras:"",type:"number",onChange:N,endAdornment:Object(B.jsx)(Q.a,{position:"start",children:Object(B.jsx)(X.a,{disabled:v&&r.codigo_barras,onClick:function(){return function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();i(Object(b.a)(Object(b.a)({},r),{},{codigo_barras:t})),h(Object(b.a)(Object(b.a)({},x),{},{codigo_barras:t}))}()},color:"primary",size:"small",children:Object(B.jsx)(cc.a,{})})})})]})}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsxs)(S.a,{className:n.titulos,children:[Object(B.jsx)("span",{className:n.obligatorio,children:"* "}),"Clave alterna"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:o.error&&!r.clave_alterna,name:"clave_alterna",id:"form-producto-clave-alterna",variant:"outlined",value:r.clave_alterna?r.clave_alterna:"",helperText:o.message,onChange:N,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsxs)(S.a,{className:n.titulos,children:[Object(B.jsx)("span",{className:n.obligatorio,children:"* "}),"Tipo de producto"]}),Object(B.jsxs)(H.a,{variant:"outlined",fullWidth:!0,size:"small",error:o.error&&!r.tipo_producto,children:[Object(B.jsxs)(mt.a,{id:"form-producto-tipo",name:"tipo_producto",value:r.tipo_producto?r.tipo_producto:"",onChange:N,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),Object(B.jsx)(Ot.a,{value:"ROPA",children:"ROPA"}),Object(B.jsx)(Ot.a,{value:"CALZADO",children:"CALZADO"}),Object(B.jsx)(Ot.a,{value:"OTROS",children:"OTROS"})]}),Object(B.jsx)(ua.a,{children:o.message})]})]}),Object(B.jsx)($e.a,{item:!0,md:5,xs:12,children:Object(B.jsx)(vc,{codigos:z,refetch:a})}),Object(B.jsxs)($e.a,{item:!0,md:4,xs:12,children:[Object(B.jsxs)(S.a,{className:n.titulos,children:[Object(B.jsx)("span",{className:n.obligatorio,children:"* "}),"Nombre comercial"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:o.error&&!r.nombre_comercial,name:"nombre_comercial",id:"form-producto-nombre-comercial",variant:"outlined",value:r.nombre_comercial?r.nombre_comercial:"",helperText:o.message,onChange:N,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:4,xs:12,children:[Object(B.jsxs)(S.a,{className:n.titulos,children:[Object(B.jsx)("span",{className:n.obligatorio,children:"* "}),"Nombre gen\xe9rico"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:o.error&&!r.nombre_generico,name:"nombre_generico",id:"form-producto-nombre-generico",variant:"outlined",value:r.nombre_generico?r.nombre_generico:"",helperText:o.message,onChange:N,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:4,xs:12,children:[Object(B.jsx)(S.a,{className:n.titulos,children:"Descripci\xf3n"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"descripcion",id:"form-producto-descripcion",variant:"outlined",value:r.descripcion?r.descripcion:"",onChange:N,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsx)($e.a,{item:!0,md:6,xs:12,children:Object(B.jsx)(ar,{refetch:a,categorias:C})}),Object(B.jsx)($e.a,{item:!0,md:6,xs:12,children:Object(B.jsx)(cr,{refetch:a})}),Object(B.jsx)($e.a,{item:!0,md:6,xs:12,children:Object(B.jsx)(ir,{refetch:a,departamentos:w})}),Object(B.jsx)($e.a,{item:!0,md:6,xs:12,children:Object(B.jsx)(sr,{refetch:a,marcas:I})})]}),Object(B.jsx)(p.a,{display:"flex",mt:4,children:Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)($e.a,{item:!0,md:3,xs:12,children:v?null:Object(B.jsxs)(p.a,{children:[Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Granel"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsx)("div",{className:n.formInput,children:Object(B.jsx)(Ve.a,{control:Object(B.jsx)(Me.a,{checked:!!s.granel&&s.granel,onChange:P,name:"granel",disabled:"OTROS"!==r.tipo_producto}),label:"Vender a granel"})})]})}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Farmacia"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsx)("div",{className:n.formInput,children:Object(B.jsx)(Ve.a,{control:Object(B.jsx)(Me.a,{checked:!!r.receta_farmacia&&r.receta_farmacia,onChange:function(e){i(Object(b.a)(Object(b.a)({},r),{},{receta_farmacia:e.target.checked}))},name:"receta_farmacia"}),label:"Necesita receta",name:"receta_farmacia"})})]}),Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Monedero el\xe9ctronico"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsx)(p.a,{children:Object(B.jsxs)(p.a,{className:n.formInput,children:[Object(B.jsx)(Ve.a,{control:Object(B.jsx)(Me.a,{checked:s.monedero,onChange:P,name:"monedero"}),label:"Monedero electr\xf3nico"}),Object(B.jsx)(F.a,{type:"number",InputProps:{inputProps:{min:0}},size:"small",label:"Valor por punto",name:"monedero_electronico",id:"form-producto-monedero_electronico",variant:"outlined",value:s.monedero_electronico,onChange:N,disabled:!s.monedero,onBlur:function(){s.monedero_electronico||d(Object(b.a)(Object(b.a)({},s),{},{monedero_electronico:1}))},error:""===s.monedero_electronico})]})})]})]})})]})})}var jr=a(908),ur=a(909),br=a(465),pr=a.n(br),mr=Object(k.a)((function(e){return{formInputFlex:{display:"flex",width:"100%","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(0),"px ").concat(e.spacing(1),"px")},input:{display:"none"},imagen:{maxHeight:"100%",maxWidth:"100%"}}}));function Or(){var e=mr(),t=Object(l.useContext)(fe),a=t.imagenes,n=t.setImagenes,c=t.setOnPreview,r=t.onPreview,i=a.map((function(e,t){return Object(B.jsx)(Fr,{index:t,imagen:e},t)}));return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsxs)($e.a,{item:!0,md:6,children:[Object(B.jsxs)(p.a,{children:[Object(B.jsx)("input",{accept:"image/*",className:e.input,id:"contained-button-file",type:"file",onChange:function(e){var t=e.target.files;e.target.files.length<1||(n([].concat(Object(da.a)(a),[t[0]])),c({image:URL.createObjectURL(t[0])}))}}),Object(B.jsx)("label",{htmlFor:"contained-button-file",children:Object(B.jsx)(w.a,{variant:"text",color:"primary",component:"span",startIcon:Object(B.jsx)(jr.a,{}),children:"Cargar imagen"})})]}),i]}),Object(B.jsx)($e.a,{item:!0,md:6,children:Object(B.jsxs)(p.a,{display:"flex",minHeight:300,children:[Object(B.jsx)(p.a,{mx:1,children:Object(B.jsx)(Le.a,{orientation:"vertical"})}),Object(B.jsx)(p.a,{width:"100%",height:"50vh",display:"flex",justifyContent:"center",alignItems:"center",children:r.image?Object(B.jsx)("img",{alt:"img-onPreview",src:r.image,className:e.imagen}):Object(B.jsx)(pr.a,{style:{fontSize:150}})})]})})]})})}var xr,hr,_r,fr,gr,vr,Cr,yr,Sr,Fr=function(e){var t=e.imagen,a=e.index,n=mr(),c=t.key_imagen?t.url_imagen:URL.createObjectURL(t),r=Object(l.useContext)(fe),i=r.imagenes,o=r.setImagenes,s=r.setOnPreview,d=r.onPreview,j=r.imagenes_eliminadas,u=r.setImagenesEliminadas,b=Object(l.useState)(!1),m=Object(g.a)(b,2),O=m[0],x=m[1],h=function(){return x(!O)};return Object(B.jsxs)(p.a,{my:2,mr:5,children:[Object(B.jsxs)(p.a,{className:n.formInputFlex,children:[Object(B.jsx)(p.a,{height:70,width:70,children:Object(B.jsx)("img",{alt:"producto-img-prev",src:c,width:"100%"})}),Object(B.jsxs)(p.a,{width:"90%",children:[Object(B.jsx)(S.a,{noWrap:!0,children:t.key_imagen?t.key_imagen:t.name}),t.key_imagen?null:Object(B.jsxs)(S.a,{variant:"caption",children:[t.size," bits"]}),Object(B.jsxs)(p.a,{display:"flex",justifyContent:"flex-end",children:[Object(B.jsx)(w.a,{size:"small",startIcon:Object(B.jsx)(zt.a,{}),onClick:function(){return s({index:a,image:c})},children:"previsualizar"}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(wr,{handleModal:h,open:O,eliminarImagen:function(){t.key_imagen&&u([].concat(Object(da.a)(j),[t])),d.index===a&&s({index:"",image:""});var e=Object(da.a)(i);e.splice(a,1),o(Object(da.a)(e)),h()}})]})]})]}),Object(B.jsx)(Le.a,{})]})},wr=function(e){var t=e.handleModal,a=e.open,n=e.eliminarImagen;return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{size:"small",color:"secondary",startIcon:Object(B.jsx)(ur.a,{}),onClick:function(){return t()},children:"eliminar"}),Object(B.jsxs)(Ee.a,{open:a,onClose:t,children:[Object(B.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:function(){return t()},color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:function(){return n()},children:"Eliminar"})]})]})]})},Ir=Object(l.createContext)(),kr=function(e){var t=e.children,a=Object(l.useState)({nombre_almacen:"",id_usuario_encargado:"",direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""}}),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(!1),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1];return Object(B.jsx)(Ir.Provider,{value:{datosAlmacen:c,setDatosAlmacen:r,update:s,setUpdate:d,error:b,setError:p,openRegistro:x,setOpenRegistro:h},children:t})},zr=Object(P.d)(xr||(xr=Object(N.a)(["\n  mutation CrearAlmacen($input: CrearAlmacen, $id: ID!, $empresa: ID!) {\n    crearAlmacen(input: $input, id: $id, empresa: $empresa) {\n      _id\n    }\n  }\n"]))),Nr=Object(P.d)(hr||(hr=Object(N.a)(["\n  query obtenerAlmacenes($id: ID!) {\n    obtenerAlmacenes(id: $id) {\n      _id\n      nombre_almacen\n      id_usuario_encargado {\n        _id\n        nombre\n      }\n      id_sucursal {\n        _id\n        nombre_sucursal\n        descripcion\n        direccion {\n          calle\n          no_ext\n          no_int\n          codigo_postal\n          colonia\n          municipio\n          localidad\n          estado\n          pais\n        }\n      }\n      direccion {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      default_almacen\n    }\n  }\n"]))),Pr=Object(P.d)(_r||(_r=Object(N.a)(["\n  mutation ActualizarAlmacen($input: EditarAlmacen, $id: ID!) {\n    actualizarAlmacen(input: $input, id: $id) {\n      message\n    }\n  }\n"]))),Dr=Object(P.d)(fr||(fr=Object(N.a)(["\n  mutation eliminarAlmacen($id: ID!) {\n    eliminarAlmacen(id: $id) {\n      message\n    }\n  }\n"]))),Er=Object(P.d)(gr||(gr=Object(N.a)(["\n  query obtenerProductosAlmacenes(\n    $empresa: ID!\n    $sucursal: ID!\n    $filtro: String\n  ) {\n    obtenerProductosAlmacenes(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtro: $filtro\n    ) {\n      _id\n      datos_generales {\n        codigo_barras\n        clave_alterna\n        tipo_producto\n        nombre_comercial\n        nombre_generico\n        descripcion\n        id_categoria\n        categoria\n        subcategoria\n        id_subcategoria\n        id_departamento\n        departamento\n        id_marca\n        marca\n        clave_producto_sat {\n          Name\n          Value\n        }\n        receta_farmacia\n      }\n      precios{\n        inventario{\n          inventario_maximo\n          inventario_minimo\n          unidad_de_inventario\n          codigo_unidad\n        }\n        precio_de_compra{\n          ieps\n          iva\n          precio_con_impuesto\n          precio_sin_impuesto\n        }\n      }\n      medidas_producto {\n        _id\n        cantidad\n        almacen\n        descuento_activo\n        descuento {\n          cantidad_unidad\n          numero_precio\n          unidad_maxima\n          precio_general\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          utilidad\n          porciento\n          dinero_descontado\n        }\n        codigo_barras\n        color {\n          _id\n          nombre\n          hex\n        }\n        existencia\n        medida {\n          _id\n          talla\n          tipo\n        }\n        nombre_comercial\n        precio\n        precio_unidad {\n          numero_precio\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          unidad_mayoreo\n          utilidad\n          precio_general\n          cantidad_unidad\n          unidad_maxima\n        }\n      }\n      existencia_almacenes {\n        _id {\n          producto\n          almacen {\n            _id\n            nombre_almacen\n          }\n        }\n        unidad_inventario\n        cantidad_existente\n      }\n      empresa\n      sucursal\n    }\n  }\n"]))),Ar=Object(P.d)(vr||(vr=Object(N.a)(["\n  query obtenerCategorias($empresa: ID!, $sucursal: ID!) {\n    obtenerCategorias(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      categoria\n      subcategorias {\n        _id\n        subcategoria\n      }\n    }\n  }\n"]))),Tr=Object(P.d)(Cr||(Cr=Object(N.a)(["\n  mutation CrearTraspaso(\n    $input: CrearTraspasoInput\n    $usuario: ID!\n    $empresa: ID!\n  ) {\n    crearTraspaso(input: $input, usuario: $usuario, empresa: $empresa) {\n      message\n      resp\n    }\n  }\n"]))),Wr=Object(P.d)(yr||(yr=Object(N.a)(["\n  query obtenerProductosPorEmpresa($empresa: ID!, $filtro: String) {\n    obtenerProductosPorEmpresa(empresa: $empresa, filtro : $filtro) {\n      _id\n      datos_generales {\n        codigo_barras\n        clave_alterna\n        tipo_producto\n        nombre_comercial\n        nombre_generico\n        descripcion\n        id_categoria\n        categoria\n        subcategoria\n        id_subcategoria\n        id_departamento\n        departamento\n        id_marca\n        marca\n        clave_producto_sat {\n          Name\n          Value\n        }\n        receta_farmacia\n      }\n      precio_plazos {\n        precio_cajas {\n          plazo\n          unidad\n          precio\n        }\n        precio_piezas {\n          plazo\n          unidad\n          precio\n        }\n        precio_costales {\n          plazo\n          unidad\n          precio\n        }\n      }\n      precios {\n        ieps\n        ieps_activo\n        iva\n        iva_activo\n        monedero\n        monedero_electronico\n        precio_de_compra {\n          ieps\n          iva\n          precio_con_impuesto\n          precio_sin_impuesto\n        }\n        precios_producto {\n          numero_precio\n          precio_neto\n          precio_venta\n          unidad_mayoreo\n          utilidad\n          ieps_precio\n          iva_precio\n        }\n        unidad_de_compra {\n          cantidad\n          precio_unitario_con_impuesto\n          precio_unitario_sin_impuesto\n          unidad\n        }\n        inventario {\n          inventario_minimo\n          inventario_maximo\n          unidad_de_inventario\n        }\n        granel\n      }\n      sucursal\n      usuario\n      empresa\n    }\n  }\n"]))),$r=Object(P.d)(Sr||(Sr=Object(N.a)(["\n  query obtenerTraspasos( $input: ConsultaTraspasosInput) {\n    obtenerTraspasos(input: $input) {\n      _id  \n      cantidad\n      \n      id_traspaso{\n        concepto_traspaso{\n          nombre_concepto\n        }\n        fecha_registro\n      }\n      producto{\n        datos_generales{\n          nombre_comercial\n        }\n      }\n      almacen_origen{\n        _id\n        nombre_almacen\n      }\n      almacen_destino{\n        _id\n        nombre_almacen\n      }\n    }\n  }\n"]))),Rr={mi_empresa:{datos_empresa:{ver:!1,agregar:!1,editar:!1,eliminar:!1},informacion_fiscal:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},compras:{abrir_compra:{ver:!1,agregar:!1,editar:!1,eliminar:!1},compras_realizadas:{ver:!1,agregar:!1,editar:!1,eliminar:!1},compras_espera:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},tesoreria:{cuentas_empresa:{ver:!1,agregar:!1,editar:!1,eliminar:!1},egresos:{ver:!1,agregar:!1,editar:!1,eliminar:!1},abonos_proveedores:{ver:!1,agregar:!1,editar:!1,eliminar:!1},abonos_clientes:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},reportes:{reporte_historial_cajas:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_turnos:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_compras:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_ventas:{ver:!1,agregar:!1,editar:!1,eliminar:!1},rerporte_almacen:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_corte_caja:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_tesoreria:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},ventas:{cancelar_venta:{ver:!1,agregar:!1,editar:!1,eliminar:!1},precios_productos:{ver:!1,agregar:!1,editar:!1,eliminar:!1},pre_corte:{ver:!1,agregar:!1,editar:!1,eliminar:!1},cotizaciones:{ver:!1,agregar:!1,editar:!1,eliminar:!1},administrador:{ver:!1,agregar:!1,editar:!1,eliminar:!1},eliminar_ventas:{ver:!1,agregar:!1,editar:!1,eliminar:!1},producto_rapido:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},almacenes:{almacen:{ver:!1,agregar:!1,editar:!1,eliminar:!1},traspasos:{ver:!1,agregar:!1,editar:!1,eliminar:!1},inventario_almacen:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},catalogos:{clientes:{ver:!1,agregar:!1,eliminar:!1,editar:!1},usuarios:{ver:!1,agregar:!1,eliminar:!1,editar:!1},productos:{ver:!1,agregar:!1,eliminar:!1,editar:!1},marcas:{ver:!1,agregar:!1,eliminar:!1,editar:!1},contabilidad:{ver:!1,agregar:!1,eliminar:!1,editar:!1},provedores:{ver:!1,agregar:!1,eliminar:!1,editar:!1},cajas:{ver:!1,agregar:!1,eliminar:!1,editar:!1},departamentos:{ver:!1,agregar:!1,eliminar:!1,editar:!1},centro_costos:{ver:!1,agregar:!1,eliminar:!1,editar:!1},conceptos_almacen:{ver:!1,agregar:!1,eliminar:!1,editar:!1},categorias:{ver:!1,agregar:!1,eliminar:!1,editar:!1},colores:{ver:!1,agregar:!1,eliminar:!1,editar:!1},tallas_numeros:{ver:!1,agregar:!1,eliminar:!1,editar:!1}},facturacion:{generar_cdfi:{ver:!1,agregar:!1,editar:!1,eliminar:!1},cdfi_realizados:{ver:!1,agregar:!1,editar:!1,eliminar:!1},registro_series_cdfi:{ver:!1,agregar:!1,editar:!1,eliminar:!1}}},Vr=Object(l.createContext)(),Mr=function(e){var t=e.children,a=Object(l.useState)({direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},estado_usuario:!0,accesos:Rr}),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)({error:!1,message:""}),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1];return Object(B.jsx)(Vr.Provider,{value:{usuario:c,setUsuario:r,toUpdate:s,setToUpdate:d,error:b,setError:p,update:x,setUpdate:h},children:t})},Lr=Object(k.a)((function(e){return{title:{fontWeight:"500","& span":{color:"red"}},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:150,height:150,border:"dashed 2px #000000"},avatar:{width:135,height:135,"& > .icon":{fontSize:100}}}}));function Ur(e){var t=e.accion,a=Lr(),n=Object(l.useContext)(Vr),c=n.usuario,r=n.setUsuario,i=n.error,o=Object(l.useState)(""),s=Object(g.a)(o,2),d=s[0],j=s[1],u=Object(l.useState)(!1),m=Object(g.a)(u,2),O=m[0],x=m[1],h=Object(l.useCallback)((function(e){var t=new FileReader;t.readAsDataURL(e[0]),t.onload=function(){var e=t.result;j(e)},r(Object(b.a)(Object(b.a)({},c),{},{imagen:e[0]}))}),[c,r]),f=Object(Be.a)({accept:"image/jpeg, image/png",noKeyboard:!0,onDrop:h}),v=f.getRootProps,C=f.getInputProps,y=function(e){"numero_usuario"!==e.target.name?r(Object(b.a)(Object(b.a)({},c),{},Object(_.a)({},e.target.name,e.target.value))):r(Object(b.a)(Object(b.a)({},c),{},Object(_.a)({},e.target.name,parseInt(e.target.value))))},w=function(e){r(Object(b.a)(Object(b.a)({},c),{},{direccion:Object(b.a)(Object(b.a)({},c.direccion),{},Object(_.a)({},e.target.name,e.target.value))}))};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:3,style:{display:"flex",justifyContent:"center",marginTop:"8px"},children:Object(B.jsxs)(p.a,Object(b.a)(Object(b.a)({className:a.avatarContainer},v()),{},{children:[Object(B.jsx)("input",Object(b.a)({},C())),d?Object(B.jsx)(Re.a,{variant:"square",className:a.avatar,src:"".concat(d)}):Object(B.jsx)(Re.a,{variant:"square",className:a.avatar,src:"".concat(c.imagen)})]}))}),Object(B.jsx)($e.a,{item:!0,md:9,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,xs:12,md:12,children:[Object(B.jsxs)(S.a,{className:a.title,children:[Object(B.jsx)("span",{children:"* "}),"Nombre usuario"]}),Object(B.jsx)(F.a,{fullWidth:!0,type:"text",size:"small",error:i.error&&!c.nombre,name:"nombre",variant:"outlined",value:c.nombre?c.nombre:"",helperText:i.error&&"Las contrase\xf1as no coinciden"!==i.message?i.message:"",inputProps:{style:{textTransform:"uppercase"}},onChange:y})]}),"registrar"===t?Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)($e.a,{item:!0,xs:12,md:6,children:[Object(B.jsxs)(S.a,{className:a.title,children:[Object(B.jsx)("span",{children:"* "}),"Contrase\xf1a"]}),Object(B.jsxs)(H.a,{fullWidth:!0,size:"small",error:!(!i.error||c.password)||!(!i.error||"Las contrase\xf1as no coinciden"!==i.message),name:"password",variant:"outlined",children:[Object(B.jsx)(K.a,{name:"password",type:O?"text":"password",value:c.password?c.password:"",onChange:y,endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(X.a,{size:"small","aria-label":"toggle password visibility",onClick:function(){return x(!O)},onMouseDown:function(){return x(!O)},children:O?Object(B.jsx)(ee.a,{color:"primary"}):Object(B.jsx)(ae.a,{color:"primary"})})})}),Object(B.jsx)(ua.a,{children:i.message})]})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:6,children:[Object(B.jsxs)(S.a,{className:a.title,children:[Object(B.jsx)("span",{children:"* "}),"Repetir contrase\xf1a"]}),Object(B.jsxs)(H.a,{fullWidth:!0,size:"small",error:!(!i.error||c.password)||!(!i.error||"Las contrase\xf1as no coinciden"!==i.message),name:"repeatPassword",variant:"outlined",children:[Object(B.jsx)(K.a,{name:"repeatPassword",type:O?"text":"password",value:c.repeatPassword?c.repeatPassword:"",onChange:y,endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(X.a,{size:"small","aria-label":"toggle password visibility",onClick:function(){return x(!O)},onMouseDown:function(){return x(!O)},children:O?Object(B.jsx)(ee.a,{color:"primary"}):Object(B.jsx)(ae.a,{color:"primary"})})})}),Object(B.jsx)(ua.a,{children:i.message})]})]})]}):Object(B.jsx)($e.a,{item:!0,xs:12,md:12,children:Object(B.jsx)(Br,{})})]})}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:4,children:[Object(B.jsxs)(S.a,{className:a.title,children:[Object(B.jsx)("span",{children:"* "}),"Email"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:i.error&&!c.email,name:"email",variant:"outlined",value:c.email?c.email:"",helperText:i.error&&"Las contrase\xf1as no coinciden"!==i.message?i.message:"",onChange:y})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:4,children:[Object(B.jsxs)(S.a,{className:a.title,children:[Object(B.jsx)("span",{children:"* "}),"Num. Telefono"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:i.error&&!c.telefono,name:"telefono",variant:"outlined",value:c.telefono?c.telefono:"",helperText:i.error&&"Las contrase\xf1as no coinciden"!==i.message?i.message:"",onChange:y})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:4,children:[Object(B.jsx)(S.a,{className:a.title,children:"Num. Celular"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"celular",variant:"outlined",value:c.celular?c.celular:"",onChange:y})]})]}),Object(B.jsxs)(p.a,{my:2,children:[Object(B.jsx)(S.a,{className:a.title,children:Object(B.jsx)("b",{children:"Domicilio"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,xs:12,md:3,children:[Object(B.jsx)(S.a,{className:a.title,children:"Calle"}),Object(B.jsx)(F.a,{size:"small",fullWidth:!0,name:"calle",variant:"outlined",value:c.direccion.calle?c.direccion.calle:"",onChange:w,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:3,children:[Object(B.jsx)(S.a,{className:a.title,children:"Colonia"}),Object(B.jsx)(F.a,{size:"small",fullWidth:!0,name:"colonia",variant:"outlined",value:c.direccion.colonia?c.direccion.colonia:"",onChange:w,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:2,children:[Object(B.jsx)(S.a,{className:a.title,children:"Num. Ext"}),Object(B.jsx)(F.a,{size:"small",fullWidth:!0,name:"no_ext",variant:"outlined",value:c.direccion.no_ext?c.direccion.no_ext:"",onChange:w,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:2,children:[Object(B.jsx)(S.a,{className:a.title,children:"Num. Int"}),Object(B.jsx)(F.a,{size:"small",fullWidth:!0,name:"no_int",variant:"outlined",value:c.direccion.no_int?c.direccion.no_int:"",onChange:w,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:2,children:[Object(B.jsx)(S.a,{className:a.title,children:"CP"}),Object(B.jsx)(F.a,{size:"small",fullWidth:!0,name:"codigo_postal",variant:"outlined",value:c.direccion.codigo_postal?c.direccion.codigo_postal:"",onChange:w})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:3,children:[Object(B.jsx)(S.a,{className:a.title,children:"Municipio"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"municipio",variant:"outlined",value:c.direccion.municipio?c.direccion.municipio:"",onChange:w,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:3,children:[Object(B.jsx)(S.a,{className:a.title,children:"Localidad"}),Object(B.jsx)(F.a,{size:"small",fullWidth:!0,name:"localidad",variant:"outlined",value:c.direccion.localidad?c.direccion.localidad:"",onChange:w,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:3,children:[Object(B.jsx)(S.a,{className:a.title,children:"Estado"}),Object(B.jsx)(F.a,{size:"small",fullWidth:!0,name:"estado",variant:"outlined",value:c.direccion.estado?c.direccion.estado:"",onChange:w,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:3,children:[Object(B.jsx)(S.a,{className:a.title,children:"Pais"}),Object(B.jsx)(F.a,{size:"small",fullWidth:!0,name:"pais",variant:"outlined",value:c.direccion.pais?c.direccion.pais:"",onChange:w,inputProps:{style:{textTransform:"uppercase"}}})]})]})]})}var Br=function(){var e=Object(l.useState)(!1),t=Object(g.a)(e,2),a=t[0],n=t[1],c=Lr(),r=Object(l.useContext)(Vr),i=r.usuario,o=r.setUsuario,s=r.error,d=r.setError,j=r.update,u=r.setUpdate,m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1],v=Object(l.useState)(!1),y=Object(g.a)(v,2),F=y[0],k=y[1],N=Object(l.useState)({message:"",status:"",open:!1}),P=Object(g.a)(N,2),D=P[0],E=P[1],T=Object(z.a)(A),W=Object(g.a)(T,1)[0],$=function(){n(!1),d({error:!1,message:""})},R=function(e){o(Object(b.a)(Object(b.a)({},i),{},Object(_.a)({},e.target.name,e.target.value)))},V=function(){var e=Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.password&&i.repeatPassword){e.next=3;break}return d({error:!0,message:"Este campo es requerido"}),e.abrupt("return");case 3:if(i.password===i.repeatPassword){e.next=6;break}return d({error:!0,message:"Las contrase\xf1as no coinciden"}),e.abrupt("return");case 6:return k(!0),e.prev=7,e.next=10,W({variables:{input:{password:i.password,repeatPassword:i.repeatPassword},id:i._id}});case 10:u(!j),E({message:"\xa1Listo!",status:"success",open:!0}),k(!1),$(),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(7),E({message:"Hubo un error",status:"error",open:!0}),k(!1);case 20:case"end":return e.stop()}}),e,null,[[7,16]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(w.a,{color:"primary",variant:"text",onClick:function(){n(!0)},children:"Cambiar contrase\xf1a"}),Object(B.jsxs)(Ee.a,{open:a,onClose:$,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(B.jsx)(J,{alert:D,setAlert:E}),Object(B.jsx)(wt.a,{id:"alert-dialog-title",children:"Cambiar contrase\xf1a"}),Object(B.jsx)(Ae.a,{children:Object(B.jsxs)("form",{autoComplete:"off",children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsxs)(S.a,{className:c.title,children:[Object(B.jsx)("span",{children:"* "}),"Contrase\xf1a"]}),Object(B.jsxs)(H.a,{fullWidth:!0,size:"small",error:!(!s.error||i.password)||!(!s.error||"Las contrase\xf1as no coinciden"!==s.message),name:"password",variant:"outlined",children:[Object(B.jsx)(K.a,{name:"password",type:x?"text":"password",value:i.password?i.password:"",onChange:R,endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(X.a,{size:"small","aria-label":"toggle password visibility",onClick:function(){return h(!x)},onMouseDown:function(){return h(!x)},children:x?Object(B.jsx)(ee.a,{color:"primary"}):Object(B.jsx)(ae.a,{color:"primary"})})})}),Object(B.jsx)(ua.a,{children:s.message})]})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsxs)(S.a,{className:c.title,children:[Object(B.jsx)("span",{children:"* "}),"Repetir contrase\xf1a"]}),Object(B.jsxs)(H.a,{fullWidth:!0,size:"small",error:!(!s.error||i.password)||!(!s.error||"Las contrase\xf1as no coinciden"!==s.message),name:"repeatPassword",variant:"outlined",children:[Object(B.jsx)(K.a,{name:"repeatPassword",type:x?"text":"password",value:i.repeatPassword?i.repeatPassword:"",onChange:R,endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(X.a,{size:"small","aria-label":"toggle password visibility",onClick:function(){return h(!x)},onMouseDown:function(){return h(!x)},children:x?Object(B.jsx)(ee.a,{color:"primary"}):Object(B.jsx)(ae.a,{color:"primary"})})})}),Object(B.jsx)(ua.a,{children:s.message})]})]})]})}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:$,color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{onClick:V,color:"primary",variant:"contained",autoFocus:!0,endIcon:F?Object(B.jsx)(I.a,{color:"inherit",size:25}):null,children:"Confirmar"})]})]})]})};function qr(e){var t=e.arregloAccesos,a=e.obtenerAccesos,n=e.departamento,c=e.subDepartamento;return Object(B.jsxs)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:[Object(B.jsx)(Ve.a,{control:Object(B.jsx)(Me.a,{checked:!!t&&t[n][c].ver,name:"ver",color:"primary",onChange:function(e){return a(e,n,c)}}),label:Object(B.jsx)(p.a,{mr:2,display:"flex",children:"ventas"===n&&"cancelar_venta"!==c?"Autorizar":"Ver"})}),"informacion_fiscal"===c||"datos_empresa"===c||"abrir_compra"===c||"compras_realizadas"===c||"compras_espera"===c||"traspasos"===c||"inventario_almacen"===c||"cuentas_empresa"===c||"generar_cdfi"===c||"cdfi_realizados"===c||"reportes"===n||"ventas"===n||"egresos"===c?null:Object(B.jsx)(Ve.a,{control:Object(B.jsx)(Me.a,{checked:!!t&&t[n][c].agregar,name:"agregar",disabled:!t||!1===t[n][c].ver,color:"primary",onChange:function(e){return a(e,n,c)}}),label:Object(B.jsx)(p.a,{mr:2,display:"flex",children:"Agregar"})}),"cajas"===c||"abrir_compra"===c||"compras_realizadas"===c||"traspasos"===c||"inventario_almacen"===c||"abonos_proveedores"===c||"abonos_clientes"===c||"egresos"===c||"generar_cdfi"===c||"cdfi_realizados"===c||"registro_series_cdfi"===c||"reportes"===n||"ventas"===n&&"cancelar_venta"!==c?null:Object(B.jsx)(Ve.a,{control:Object(B.jsx)(Me.a,{checked:!!t&&t[n][c].editar,name:"editar",disabled:!t||!1===t[n][c].ver,color:"primary",onChange:function(e){return a(e,n,c)}}),label:Object(B.jsx)(p.a,{mr:2,display:"flex",children:"Editar"})}),"informacion_fiscal"===c||"datos_empresa"===c||"abrir_compra"===c||"compras_realizadas"===c||"traspasos"===c||"inventario_almacen"===c||"cuentas_empresa"===c||"abonos_proveedores"===c||"generar_cdfi"===c||"cdfi_realizados"===c||"abonos_clientes"===c||"egresos"===c||"reportes"===n||"ventas"===n?null:Object(B.jsx)(Ve.a,{control:Object(B.jsx)(Me.a,{checked:!!t&&t[n][c].eliminar,name:"eliminar",color:"primary",disabled:!t||!1===t[n][c].ver,onChange:function(e){return a(e,n,c)}}),label:Object(B.jsx)(p.a,{display:"flex",children:"Eliminar"})})]})}function Jr(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(S.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Clientes"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"clientes"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Usuarios"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"usuarios"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Productos"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"productos"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Marcas"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"marcas"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Provedores"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"provedores"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Contabilidad"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"contabilidad"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Cajas"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"cajas"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Departamento"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"departamentos"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Centro de costos"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"centro_costos"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Conceptos almacen"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"conceptos_almacen"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Categorias"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"categorias"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Colores"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"colores"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Tallas y Numeros"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"tallas_numeros"})]})})})})]})}function Gr(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(S.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Datos de Empresa"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"mi_empresa",subDepartamento:"datos_empresa"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Informaci\xf3n Fiscal"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"mi_empresa",subDepartamento:"informacion_fiscal"})]})})})})]})}function Hr(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(S.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Abrir una compra"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"compras",subDepartamento:"abrir_compra"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Compras realizadas"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"compras",subDepartamento:"compras_realizadas"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Compras en espera"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"compras",subDepartamento:"compras_espera"})]})})})})]})}function Yr(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(S.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Almacenes"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"almacenes",subDepartamento:"almacen"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Traspasos"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"almacenes",subDepartamento:"traspasos"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Inventario por almacen"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"almacenes",subDepartamento:"inventario_almacen"})]})})})})]})}function Kr(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(S.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Cuentas"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"tesoreria",subDepartamento:"cuentas_empresa"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Abonos Proveedores"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"tesoreria",subDepartamento:"abonos_proveedores"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Abonos Clientes"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"tesoreria",subDepartamento:"abonos_clientes"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Egresos"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"tesoreria",subDepartamento:"egresos"})]})})})})]})}function Qr(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(S.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Reportes Historiales Cajas"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_historial_cajas"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Reportes turnos usuarios "})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_turnos"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Reportes de compras "})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_compras"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Reportes de ventas "})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_ventas"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Reportes de almacenes "})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"rerporte_almacen"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Reportes de cortes "})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_corte_caja"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Reportes tesoreria "})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_tesoreria"})]})})})})]})}function Xr(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(S.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Cancelar ventas"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"cancelar_venta"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Precios de productos"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"precios_productos"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Pre cortes de caja"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"pre_corte"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Cotizaciones"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"cotizaciones"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Producto Rapido"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"producto_rapido"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Panel de administrador"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"administrador"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Eliminar ventas pendientes"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"eliminar_ventas"})]})})})})]})}function Zr(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(S.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Generar nuevo CDFI"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"facturacion",subDepartamento:"generar_cdfi"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"CDFIs realizados"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"facturacion",subDepartamento:"cdfi_realizados"})]})})})}),Object(B.jsx)(p.a,{p:1,display:"flex",justifyContent:"center",children:Object(B.jsx)(p.a,{width:"80%",children:Object(B.jsx)(Ka.a,{elevation:3,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{ml:1,p:1,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Registrar series CDFI"})})}),Object(B.jsx)(qr,{arregloAccesos:a,obtenerAccesos:t,departamento:"facturacion",subDepartamento:"registro_series_cdfi"})]})})})})]})}var ei=["children","value","index"];function ti(e){var t=e.children,a=e.value,n=e.index,c=Object(ve.a)(e,ei);return Object(B.jsx)("div",Object(b.a)(Object(b.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(B.jsx)(p.a,{p:1,minHeight:"20vh",children:t})}))}function ai(e){return{id:"reg-product-tab-".concat(e),"aria-controls":"tabpanel-reg-product-".concat(e)}}var ni=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper},iconSvg:{width:30},icon:{fontSize:30}}}));function ci(e){var t=e.obtenerAccesos,a=e.arregloAccesos,n=ni(),c=Object(l.useState)({message:"",status:"",open:!1}),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)(0),d=Object(g.a)(s,2),j=d[0],u=d[1];return Object(B.jsxs)(p.a,{children:[Object(B.jsx)(J,{alert:i,setAlert:o}),Object(B.jsx)(Ie.a,{position:"static",color:"transparent",elevation:0,children:Object(B.jsxs)(ke.a,{value:j,onChange:function(e,t){u(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:[Object(B.jsx)(ze.a,Object(b.a)({label:"Mi empresa",icon:Object(B.jsx)(Fe.q,{className:n.icon})},ai(0))),Object(B.jsx)(ze.a,Object(b.a)({label:"Almacenes",icon:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/almacen.svg",alt:"icono almacen",className:n.iconSvg})},ai(1))),Object(B.jsx)(ze.a,Object(b.a)({label:"Compras",icon:Object(B.jsx)(Fe.l,{className:n.icon})},ai(2))),Object(B.jsx)(ze.a,Object(b.a)({label:"Catalogos",icon:Object(B.jsx)(Fe.i,{className:n.icon})},ai(3))),Object(B.jsx)(ze.a,Object(b.a)({label:"Tesoreria",icon:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/money.svg",alt:"icono money",className:n.iconSvg})},ai(4))),Object(B.jsx)(ze.a,Object(b.a)({label:"Reportes",icon:Object(B.jsx)(Fe.r,{className:n.icon})},ai(5))),Object(B.jsx)(ze.a,Object(b.a)({label:"Facturaci\xf3n",icon:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/factura.svg",alt:"icono factura",className:n.iconSvg})},ai(6))),Object(B.jsx)(ze.a,Object(b.a)({label:"Ventas",icon:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cart-add.svg",alt:"icono ventas",className:n.iconSvg})},ai(7)))]})}),Object(B.jsx)(ti,{value:j,index:0,children:Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Gr,{obtenerAccesos:t,arregloAccesos:a})})}),Object(B.jsx)(ti,{value:j,index:1,children:Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Yr,{obtenerAccesos:t,arregloAccesos:a})})}),Object(B.jsx)(ti,{value:j,index:2,children:Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Hr,{obtenerAccesos:t,arregloAccesos:a})})}),Object(B.jsx)(ti,{value:j,index:3,children:Object(B.jsx)(p.a,{p:0,children:Object(B.jsx)(Jr,{obtenerAccesos:t,arregloAccesos:a})})}),Object(B.jsx)(ti,{value:j,index:4,children:Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Kr,{obtenerAccesos:t,arregloAccesos:a})})}),Object(B.jsx)(ti,{value:j,index:5,children:Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Qr,{obtenerAccesos:t,arregloAccesos:a})})}),Object(B.jsx)(ti,{value:j,index:6,children:Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Zr,{obtenerAccesos:t,arregloAccesos:a})})}),Object(B.jsx)(ti,{value:j,index:7,children:Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Xr,{obtenerAccesos:t,arregloAccesos:a})})})]})}var ri=["children","value","index"],ii=["numero_usuario","_id","sucursal","empresa","turno_en_caja_activo","estado_usuario"];function oi(e){var t=e.children,a=e.value,n=e.index,c=Object(ve.a)(e,ri);return Object(B.jsx)("div",Object(b.a)(Object(b.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(B.jsx)(p.a,{minHeight:"70vh",children:t})}))}function si(e){return{id:"reg-product-tab-".concat(e),"aria-controls":"tabpanel-reg-product-".concat(e)}}var li=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},rootPrincipal:{padding:0,margin:0},root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper},iconSvg:{width:50}}}));function di(e){var t=e.accion,a=e.datos,n=e.fromEmergent,c=e.refetch,r=li(),i=Object(l.useContext)(Vr),o=i.usuario,s=i.setUsuario,d=i.setError,j=i.update,u=i.setUpdate,m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1],v=Object(l.useState)(0),y=Object(g.a)(v,2),S=y[0],F=y[1],I=Object(l.useState)(!1),k=Object(g.a)(I,2),N=k[0],P=k[1],E=Object(l.useState)({message:"",status:"",open:!1}),T=Object(g.a)(E,2),W=T[0],$=T[1],R=JSON.parse(localStorage.getItem("sesionCafi")),V=Object(l.useCallback)((function(){s({direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},turno_en_caja_activo:!1,estado_usuario:!0,accesos:Rr})}),[s]),M=function(){h(!0),"registrar"!==t&&s(a)},L=function(){h(!1),V()},U=Object(z.a)(D),q=Object(g.a)(U,1)[0],G=Object(z.a)(A),H=Object(g.a)(G,1)[0],Y=function(){var e=Object(f.a)(C.a.mark((function e(a){var r,i;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),"registrar"!==t){e.next=10;break}if(o.nombre&&o.password&&o.repeatPassword&&o.telefono&&o.email){e.next=5;break}return d({error:!0,message:"Este campo es requerido"}),e.abrupt("return");case 5:if(o.password===o.repeatPassword){e.next=8;break}return d({error:!0,message:"Las contrase\xf1as no coinciden"}),e.abrupt("return");case 8:e.next=14;break;case 10:if(console.log(o),o.nombre&&o.telefono&&o.email){e.next=14;break}return d({error:!0,message:"Este campo es requerido"}),e.abrupt("return");case 14:if(P(!0),e.prev=15,"registrar"!==t){e.next=26;break}return o.numero_usuario=va(1e8,999999999),o.empresa=R.empresa._id,o.sucursal=R.sucursal._id,o.turno_en_caja_activo=!1,r=o,e.next=24,q({variables:{input:r}});case 24:e.next=29;break;case 26:return o.numero_usuario,o._id,o.sucursal,o.empresa,o.turno_en_caja_activo,o.estado_usuario,i=Object(ve.a)(o,ii),e.next=29,H({variables:{input:i,id:o._id}});case 29:u(!j),$({message:"\xa1Listo!",status:"success",open:!0}),d({error:!1,message:""}),P(!1),L(),n&&c(),e.next=41;break;case 37:e.prev=37,e.t0=e.catch(15),$({message:"Hubo un error en el servidor",status:"error",open:!0}),P(!1);case 41:case"end":return e.stop()}}),e,null,[[15,37]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(J,{alert:W,setAlert:$}),"registrar"===t?n?Object(B.jsx)(X.a,{color:"primary",onClick:M,children:Object(B.jsx)(It.a,{})}):Object(B.jsx)(w.a,{color:"primary",variant:"contained",size:"large",onClick:M,startIcon:Object(B.jsx)(It.a,{}),children:"AGREGAR"}):Object(B.jsx)(X.a,{onClick:M,children:Object(B.jsx)(en.a,{})}),Object(B.jsxs)(Ee.a,{open:x,onClose:L,fullWidth:!0,maxWidth:"md",children:[Object(B.jsxs)(p.a,{className:r.root,children:[Object(B.jsx)(He,{loading:N,setLoading:P}),Object(B.jsx)(Ie.a,{position:"static",color:"default",elevation:0,children:Object(B.jsxs)(ke.a,{value:S,onChange:function(e,t){F(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:[Object(B.jsx)(ze.a,Object(b.a)({label:"Informaci\xf3n b\xe1sica",icon:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/perfil.svg",alt:"icono perfil",className:r.iconSvg})},si(0))),Object(B.jsx)(ze.a,Object(b.a)({label:"Permisos",icon:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/permisos.svg",alt:"icono factura",className:r.iconSvg})},si(1))),Object(B.jsx)(p.a,{ml:58,mt:3,children:Object(B.jsx)(p.a,{children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:L,size:"large",children:Object(B.jsx)(We.a,{})})})})]})}),Object(B.jsxs)("form",{id:"form-usuario",onSubmit:Y,children:[Object(B.jsx)(oi,{value:S,index:0,children:Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Ur,{accion:t})})}),Object(B.jsx)(oi,{value:S,index:1,children:Object(B.jsx)(ci,{arregloAccesos:o.accesos,obtenerAccesos:function(e,t,a){var n=e.target,c=n.name,r=n.checked;s(Object(b.a)(Object(b.a)({},o),{},{accesos:Object(b.a)(Object(b.a)({},o.accesos),{},Object(_.a)({},t,Object(b.a)(Object(b.a)({},o.accesos[t]),{},Object(_.a)({},a,Object(b.a)(Object(b.a)({},o.accesos[t][a]),{},Object(_.a)({},c,r))))))}))}})})]})]}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{variant:"contained",color:"primary",type:"submit",form:"form-usuario",size:"large",startIcon:Object(B.jsx)(Ha.a,{}),children:"Guardar"})})]})]})}var ji=["id_usuario_encargado"],ui=["id_usuario_encargado"],bi=["id_sucursal","_id"],pi=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}}));function mi(e){var t,a=e.accion,n=e.datos,c=e.fromEmergent,r=JSON.parse(localStorage.getItem("sesionCafi")),i=Object(z.a)(zr),o=Object(g.a)(i,1)[0],s=Object(z.a)(Pr),d=Object(g.a)(s,1)[0],j=Object(qe.a)(E,{variables:{sucursal:"".concat(r.sucursal._id)}}),u=j.data,m=j.refetch,O=[],x=pi(),h=Object(l.useState)({message:"",status:"",open:!1}),v=Object(g.a)(h,2),I=v[0],k=v[1],N=Object(l.useState)(!1),P=Object(g.a)(N,2),D=P[0],A=P[1],T=Object(l.useContext)(Ir),W=T.datosAlmacen,$=T.setDatosAlmacen,R=T.error,V=T.setError,M=T.update,L=T.setUpdate,U=Object(l.useContext)(fe),q=U.almacen_inicial,G=U.setAlmacenInicial,Y=Object(l.useState)(!1),K=Object(g.a)(Y,2),Q=K[0],Z=K[1],ee=Object(l.useCallback)((function(){$({nombre_almacen:"",id_usuario_encargado:"",direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""}})}),[$]),te=function(){if(A(!0),n){var e={};if(n.id_usuario_encargado){var t=n.id_usuario_encargado;(e=Object(ve.a)(n,ji)).id_usuario_encargado=t._id}else e=n;$(e)}},ae=function(){A(!1),ee()},ne=function(e,t){"id_usuario_encargado"!==e.target.name?$(Object(b.a)(Object(b.a)({},W),{},Object(_.a)({},e.target.name,e.target.value.toUpperCase()))):$(Object(b.a)(Object(b.a)({},W),{},Object(_.a)({},e.target.name,t.props.user._id)))},ce=function(e){$(Object(b.a)(Object(b.a)({},W),{},{direccion:Object(b.a)(Object(b.a)({},W.direccion),{},Object(_.a)({},e.target.name,e.target.value.toUpperCase()))}))},re=function(){var e=Object(f.a)(C.a.mark((function e(){var t,n,c,i,s;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,W.nombre_almacen){e.next=6;break}return V(!0),e.abrupt("return");case 6:if("registrar"!==a){e.next=23;break}if(t={},""!==W.id_usuario_encargado){e.next=15;break}return W.id_usuario_encargado,c=Object(ve.a)(W,ui),e.next=12,o({variables:{input:c,id:r.sucursal._id,empresa:r.empresa._id}});case 12:n=e.sent,e.next=19;break;case 15:return t=W,e.next=18,o({variables:{input:t,id:r.sucursal._id,empresa:r.empresa._id}});case 18:n=e.sent;case 19:i=n.data.crearAlmacen._id,m&&(G(Object(b.a)(Object(b.a)({},q),{},{id_almacen:i,almacen:W.nombre_almacen})),m()),e.next=26;break;case 23:return W.id_sucursal,W._id,s=Object(ve.a)(W,bi),e.next=26,d({variables:{input:s,id:W._id}});case 26:L(!M),k({message:"\xa1Listo!",status:"success",open:!0}),V(!1),Z(!1),ae();case 31:e.next=37;break;case 33:e.prev=33,e.t0=e.catch(0),k({message:"Hubo un error",status:"error",open:!0}),Z(!1);case 37:case"end":return e.stop()}}),e,null,[[0,33]])})));return function(){return e.apply(this,arguments)}}();return u&&(O=u.obtenerUsuarios),Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(J,{alert:I,setAlert:k}),"registrar"===a?c?Object(B.jsx)(X.a,{color:"primary",onClick:te,children:Object(B.jsx)(ac.a,{})}):Object(B.jsx)(w.a,{color:"primary",variant:"contained",size:"large",onClick:te,startIcon:Object(B.jsx)(ac.a,{}),children:"AGREGAR"}):Object(B.jsx)(X.a,{onClick:te,children:Object(B.jsx)(en.a,{})}),Object(B.jsxs)(Ee.a,{open:D,onClose:ae,fullWidth:!0,maxWidth:"md",children:[Object(B.jsx)(He,{loading:Q,setLoading:Z}),Object(B.jsxs)(p.a,{display:"flex",flexDirection:"row",children:[Object(B.jsx)(p.a,{style:{width:"93%"},children:Object(B.jsx)(wt.a,{id:"form-dialog-title",children:"Registro almacen"})}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:ae,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]}),Object(B.jsxs)(y.a,{maxWidth:"md",children:[Object(B.jsxs)("div",{className:x.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"80%",children:[Object(B.jsxs)(S.a,{children:[Object(B.jsx)("span",{style:{color:"red"},children:"* "}),Object(B.jsx)("b",{children:"Nombre Almacen"})]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:R,name:"nombre_almacen",id:"form-producto-codigo-barras",variant:"outlined",value:W.nombre_almacen,onChange:ne,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)(p.a,{width:"100%",display:"flex",flexDirection:"row",children:[Object(B.jsxs)(p.a,{width:"70%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Encargado de almacen"})}),Object(B.jsx)(H.a,{fullWidth:!0,size:"small",variant:"outlined",children:Object(B.jsx)(mt.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",name:"id_usuario_encargado",renderValue:function(e){return e},onChange:ne,children:null===(t=O)||void 0===t?void 0:t.map((function(e,t){return Object(B.jsx)(Ot.a,{value:e.nombre,user:e,children:e.nombre},t)}))})})]}),Object(B.jsx)(p.a,{mt:2,width:"10%",children:Object(B.jsx)(Mr,{children:Object(B.jsx)(di,{accion:"registrar",fromEmergent:!0,refetch:m})})}),Object(B.jsxs)(p.a,{width:"35%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Sucursal"})}),Object(B.jsx)(S.a,{style:{marginTop:"7px"},children:r.sucursal.nombre_sucursal})]})]})]}),Object(B.jsxs)(p.a,{mt:2,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Domicilio"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)("div",{className:x.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Calle"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"calle",variant:"outlined",value:W.direccion.calle,onChange:ce,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"No. exterior"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"no_ext",variant:"outlined",value:W.direccion.no_ext,onChange:ce,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"No. interior "})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"no_int",variant:"outlined",value:W.direccion.no_int,onChange:ce,inputProps:{style:{textTransform:"uppercase"}}})]})]}),Object(B.jsxs)("div",{className:x.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Codigo Postal"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",type:"number",name:"codigo_postal",variant:"outlined",value:W.direccion.codigo_postal,onChange:ce,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Colonia"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"colonia",variant:"outlined",value:W.direccion.colonia,onChange:ce,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Municipio"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"municipio",variant:"outlined",value:W.direccion.municipio,onChange:ce,inputProps:{style:{textTransform:"uppercase"}}})]})]}),Object(B.jsxs)("div",{className:x.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Localidad"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"localidad",variant:"outlined",value:W.direccion.localidad,onChange:ce,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Estado"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"estado",variant:"outlined",value:W.direccion.estado,inputProps:{style:{textTransform:"uppercase"}},onChange:ce})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Pa\xeds"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"pais",variant:"outlined",value:W.direccion.pais,onChange:ce,inputProps:{style:{textTransform:"uppercase"}}})]})]}),Object(B.jsx)(p.a,{m:1,display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{color:"primary",variant:"contained",size:"large",onClick:re,children:"Guardar"})})]})]})]})}var Oi,xi,hi,_i,fi,gi,vi,Ci=Object(k.a)((function(e){return{titulos:{fontWeight:500}}}));function yi(e){var t=e.obtenerConsultasProducto,a=e.refetch,n=Ci(),c=Object(l.useContext)(fe),r=c.datos_generales,i=c.precios,o=c.setPrecios,s=c.almacen_inicial,d=c.setAlmacenInicial,j=(c.selectedDate,c.setSelectedDate,c.update),u=t.almacenes,m=function(e,t){if(e.target.value)if("unidad_de_inventario"!==e.target.name)o(Object(b.a)(Object(b.a)({},i),{},{inventario:Object(b.a)(Object(b.a)({},i.inventario),{},Object(_.a)({},e.target.name,parseFloat(e.target.value)))}));else{var a,n=t.props.unidad,c=n.codigo_unidad,r=n.unidad;o(Object(b.a)(Object(b.a)({},i),{},{inventario:Object(b.a)(Object(b.a)({},i.inventario),{},(a={},Object(_.a)(a,e.target.name,r),Object(_.a)(a,"codigo_unidad",c),a))}))}else o(Object(b.a)(Object(b.a)({},i),{},{inventario:Object(b.a)(Object(b.a)({},i.inventario),{},Object(_.a)({},e.target.name,""))}))};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(p.a,{my:2,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Inventario"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{className:n.titulos,children:"Inventario m\xednimo"}),Object(B.jsx)(F.a,{fullWidth:!0,type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"inventario_minimo",id:"form-producto-inventario_minimo",variant:"outlined",value:i.inventario.inventario_minimo,onChange:m,onFocus:function(e){var t=e.target,a=t.name,n=t.value;0===parseFloat(n)&&o(Object(b.a)(Object(b.a)({},i),{},{inventario:Object(b.a)(Object(b.a)({},i.inventario),{},Object(_.a)({},a,""))}))},onBlur:function(e){var t=e.target,a=t.name;""===t.value&&o(Object(b.a)(Object(b.a)({},i),{},{inventario:Object(b.a)(Object(b.a)({},i.inventario),{},Object(_.a)({},a,0))}))},error:""===i.inventario.inventario_minimo})]})}),Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{className:n.titulos,children:"Inventario m\xe1ximo"}),Object(B.jsx)(F.a,{fullWidth:!0,type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"inventario_maximo",id:"form-producto-inventario_maximo",variant:"outlined",value:i.inventario.inventario_maximo,onChange:m,onFocus:function(e){var t=e.target,a=t.name,n=t.value;0===parseFloat(n)&&o(Object(b.a)(Object(b.a)({},i),{},{inventario:Object(b.a)(Object(b.a)({},i.inventario),{},Object(_.a)({},a,""))}))},onBlur:function(e){var t=e.target,a=t.name;""===t.value&&o(Object(b.a)(Object(b.a)({},i),{},{inventario:Object(b.a)(Object(b.a)({},i.inventario),{},Object(_.a)({},a,0))}))},error:""===i.inventario.inventario_maximo})]})}),Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{className:n.titulos,children:"Unidad de inventario"}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",name:"unidad_de_inventario",children:i.granel?Object(B.jsx)(mt.a,{name:"unidad_de_inventario",value:i.inventario.unidad_de_inventario,onChange:m,children:$a.map((function(e,t){return Object(B.jsx)(Ot.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))}):Object(B.jsx)(mt.a,{name:"unidad_de_inventario",value:i.inventario.unidad_de_inventario,onChange:m,children:Wa.map((function(e,t){return Object(B.jsx)(Ot.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))})})})]})})]}),j?null:"OTROS"===r.tipo_producto?Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(p.a,{my:3,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Almacen incial"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,style:{alignItems:"center"},children:[Object(B.jsx)($e.a,{item:!0,md:6,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsxs)(S.a,{className:n.titulos,children:["Cantidad inicial en ",Object(B.jsx)("b",{children:i.unidad_de_compra.unidad})]}),Object(B.jsx)(p.a,{display:"flex",alignItems:"center",children:Object(B.jsx)(F.a,{fullWidth:!0,type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"cantidad",variant:"outlined",value:s.cantidad,onChange:function(e){e.target.value?"almacen"!==e.target.name?d(Object(b.a)(Object(b.a)({},s),{},Object(_.a)({},e.target.name,parseFloat(e.target.value)))):d(Object(b.a)(Object(b.a)({},s),{},Object(_.a)({},e.target.name,e.target.value))):d(Object(b.a)(Object(b.a)({},s),{},Object(_.a)({},e.target.name,"")))},onFocus:function(e){var t=e.target,a=t.name,n=t.value;0===parseFloat(n)&&d(Object(b.a)(Object(b.a)({},s),{},Object(_.a)({},a,"")))},onBlur:function(e){var t=e.target,a=t.name;""===t.value&&d(Object(b.a)(Object(b.a)({},s),{},Object(_.a)({},a,0)))},error:""===s.cantidad})})]})}),Object(B.jsx)($e.a,{item:!0,md:6,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{className:n.titulos,children:"Almacen"}),Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",name:"almacen",error:s.cantidad>0&&!s.almacen,children:Object(B.jsxs)(mt.a,{name:"almacen",value:s.almacen,onChange:function(e,t){var a;d(Object(b.a)(Object(b.a)({},s),{},(a={},Object(_.a)(a,e.target.name,e.target.value),Object(_.a)(a,t.props.name,t.props.id),a)))},children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Seleccione uno"})}),u?u.map((function(e){return Object(B.jsx)(Ot.a,{name:"id_almacen",value:e.nombre_almacen,id:e._id,children:e.nombre_almacen},e._id)})):Object(B.jsx)(Ot.a,{value:""})]})}),Object(B.jsx)(kr,{children:Object(B.jsx)(mi,{accion:"registrar",refetch:a,fromEmergent:!0})})]})]})})]})]}):null]})}function Si(e,t,a,n){return e.clave_alterna&&e.tipo_producto&&e.nombre_generico&&e.nombre_comercial?t.precio_de_compra.precio_con_impuesto&&t.precio_de_compra.precio_sin_impuesto&&t.unidad_de_compra.cantidad?e.clave_alterna&&e.tipo_producto&&e.nombre_generico&&e.nombre_comercial?a.cantidad>0&&!a.almacen&&"OTROS"===e.tipo_producto?(console.log("si hay cantidad almacen pero no hay almacen seleccionado"),{error:!0,message:"Campo obligatorio",vista3:!0}):{error:!1,message:""}:{error:!0,message:"Campo obligatorio",vista1:!0}:{error:!0,message:"Campo obligatorio",vista2:!0}:t.precio_de_compra.precio_con_impuesto&&t.precio_de_compra.precio_sin_impuesto&&t.unidad_de_compra.cantidad?{error:!0,message:"Campo obligatorio",vista1:!0}:{error:!0,message:"Campo obligatorio",vista1:!0,vista2:!0}}var Fi=Object(P.d)(Oi||(Oi=Object(N.a)(["\n\tmutation crearCuenta($input: CrearCuentasInput) {\n\t\tcrearCuenta(input: $input) {\n\t\t\t_id\n\t\t\tcuenta\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t}\n\t}\n"]))),wi=Object(P.d)(xi||(xi=Object(N.a)(["\n\tmutation crearSubcuenta($idCuenta: ID!, $input: CrearSubcuentasInput) {\n\t\tcrearSubcuenta(idCuenta: $idCuenta, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Ii=Object(P.d)(hi||(hi=Object(N.a)(["\n\tmutation actualizarCuenta($idCuenta: ID!, $input: ActualizarCuentasInput) {\n\t\tactualizarCuenta(idCuenta: $idCuenta, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),ki=Object(P.d)(_i||(_i=Object(N.a)(["\n\tmutation actualizarSubcuenta($idCuenta: ID!, $idSubcuenta: ID!, $input: ActualizarSubcuentasInput) {\n\t\tactualizarSubcuenta(idCuenta: $idCuenta, idSubcuenta: $idSubcuenta, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),zi=Object(P.d)(fi||(fi=Object(N.a)(["\n\tquery obtenerCuentas($empresa: ID!) {\n\t\tobtenerCuentas(empresa: $empresa) {\n\t\t\t_id\n\t\t\tcuenta\n\t\t\tsubcuentas {\n\t\t\t\t_id\n\t\t\t\tsubcuenta\n\t\t\t}\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t}\n\t}\n"]))),Ni=Object(P.d)(gi||(gi=Object(N.a)(["\n\tmutation eliminarCuenta($id: ID!) {\n\t\teliminarCuenta(id: $id) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Pi=Object(P.d)(vi||(vi=Object(N.a)(["\n\tmutation eliminarSubcuenta($idCuenta: ID!, $idSubcuenta: ID!) {\n\t\teliminarSubcuenta(idCuenta: $idCuenta, idSubcuenta: $idSubcuenta) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Di=Object(k.a)((function(e){return{titulos:{fontWeight:500}}}));function Ei(e){var t=e.obtenerConsultasProducto,a=e.refetch,n=Di(),c=Object(l.useContext)(fe),r=c.centro_de_costos,i=c.setCentroDeCostos,o=c.subcostos,s=c.setSubcostos,d=t.centro_costos,j=function(e,t){var a;if(i(Object(b.a)(Object(b.a)({},r),{},(a={},Object(_.a)(a,e.target.name,e.target.value),Object(_.a)(a,t.props.name,t.props.id),a))),t.props.costos){var n=t.props.costos.subcuentas;s(n)}};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(p.a,{my:3,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Centro de costos"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:6,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{className:n.titulos,children:"Cuenta"}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",name:"cuenta",children:Object(B.jsxs)(mt.a,{name:"cuenta",value:r.cuenta?r.cuenta:"",onChange:j,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Seleccione uno"})}),d?d.map((function(e){return Object(B.jsx)(Ot.a,{name:"id_cuenta",value:e.cuenta,id:e._id,costos:e,children:e.cuenta},e._id)})):Object(B.jsx)(Ot.a,{value:""})]})}),Object(B.jsx)(Ai,{tipo:"cuenta",name:"cuenta",refetch:a})]})]})}),Object(B.jsx)($e.a,{item:!0,md:6,xs:12,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{className:n.titulos,children:"Subcuenta"}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",name:"subcuenta",children:Object(B.jsxs)(mt.a,{name:"subcuenta",value:r.subcuenta?r.subcuenta:"",onChange:j,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Seleccione uno"})}),o?o.map((function(e){return Object(B.jsx)(Ot.a,{name:"id_subcuenta",value:e.subcuenta,id:e._id,children:e.subcuenta},e._id)})):Object(B.jsx)(Ot.a,{value:""})]})}),Object(B.jsx)(Ai,{tipo:"subcuenta",name:"subcuenta",refetch:a})]})]})})]})]})}var Ai=function(e){var t=e.tipo,a=e.name,n=e.refetch,c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)(!1),d=Object(g.a)(s,2),j=d[0],u=d[1],p=Object(l.useState)(!1),m=Object(g.a)(p,2),O=m[0],x=m[1],h=Object(l.useState)(""),v=Object(g.a)(h,2),y=v[0],S=v[1],k=JSON.parse(localStorage.getItem("sesionCafi")),N=Object(l.useContext)(fe),P=N.centro_de_costos,D=N.setCentroDeCostos,E=N.subcostos,A=N.setSubcostos,T=Object(l.useState)({message:"",status:"",open:!1}),W=Object(g.a)(T,2),$=W[0],R=W[1],V=Object(z.a)(Fi),M=Object(g.a)(V,1)[0],L=Object(z.a)(wi),U=Object(g.a)(L,1)[0],q=function(){o(!i)},G=function(){var e=Object(f.a)(C.a.mark((function e(c){var r,i,o,s,l,d;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),y){e.next=4;break}return u(!0),e.abrupt("return");case 4:i={input:(r={},Object(_.a)(r,a,y),Object(_.a)(r,"empresa",k.empresa._id),Object(_.a)(r,"sucursal",k.sucursal._id),r)},"subcuenta"===t&&(i={input:Object(_.a)({},a,y),idCuenta:P.id_cuenta}),x(!0),e.prev=7,e.t0=t,e.next="cuenta"===e.t0?11:"subcuenta"===e.t0?18:26;break;case 11:return e.next=13,M({variables:i});case 13:return o=e.sent,n(),s=o.data.crearCuenta._id,D(Object(b.a)(Object(b.a)({},P),{},{cuenta:y,id_cuenta:s})),e.abrupt("break",27);case 18:return e.next=20,U({variables:i});case 20:return l=e.sent,n(),d=l.data.crearSubcuenta._id,A([].concat(Object(da.a)(E),[{_id:d,subcuenta:y}])),D(Object(b.a)(Object(b.a)({},P),{},{subcuenta:y,id_subcuenta:d})),e.abrupt("break",27);case 26:return e.abrupt("break",27);case 27:R({message:"\xa1Listo!",status:"success",open:!0}),x(!1),q(),e.next=36;break;case 32:e.prev=32,e.t1=e.catch(7),R({message:"Hubo un error",status:"error",open:!0}),x(!1);case 36:case"end":return e.stop()}}),e,null,[[7,32]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(w.a,{color:"primary",onClick:function(){return q()},disabled:"subcuenta"===t&&!P.id_cuenta,children:Object(B.jsx)(ac.a,{})}),Object(B.jsxs)(Ee.a,{open:i,onClose:q,"aria-labelledby":"modal-title-".concat(t),children:[Object(B.jsx)(J,{alert:$,setAlert:R}),Object(B.jsxs)(wt.a,{id:"modal-title-".concat(t),children:["Registrar ",t]}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)("form",{id:"registro-".concat(a),onSubmit:function(e){return G(e)},children:Object(B.jsx)(F.a,{error:j,name:a,autoFocus:!0,label:t,fullWidth:!0,variant:"outlined",onChange:function(e){S(e.target.value)},helperText:j?"Campo obligatorio":""})})}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:function(){return q()},color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{form:"registro-".concat(a),type:"submit",variant:"contained",color:"primary",endIcon:O?Object(B.jsx)(I.a,{color:"inherit",size:18}):null,children:"Guardar"})]})]})]})};Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& > .precios-box":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(3),"px")}}}}));var Ti=a(910),Wi=a(912),$i=function(){var e=Object(f.a)(C.a.mark((function e(t,a){var n,c,r,i;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("datos_generales"!==a){e.next=16;break}return n={clave_alterna:t.clave_alterna,tipo_producto:t.tipo_producto,nombre_comercial:t.nombre_comercial,nombre_generico:t.nombre_generico,receta_farmacia:t.receta_farmacia},null!==t.codigo_barras&&""!==t.codigo_barras&&(n=Object(b.a)(Object(b.a)({},n),{},{codigo_barras:t.codigo_barras})),null!==t.descripcion&&""!==t.descripcion&&(n=Object(b.a)(Object(b.a)({},n),{},{descripcion:t.descripcion})),null!==t.id_categoria&&""!==t.id_categoria&&(n=Object(b.a)(Object(b.a)({},n),{},{id_categoria:t.id_categoria})),null!==t.categoria&&""!==t.categoria&&(n=Object(b.a)(Object(b.a)({},n),{},{categoria:t.categoria})),null!==t.subcategoria&&""!==t.subcategoria&&(n=Object(b.a)(Object(b.a)({},n),{},{subcategoria:t.subcategoria})),null!==t.id_subcategoria&&""!==t.id_subcategoria&&(n=Object(b.a)(Object(b.a)({},n),{},{id_subcategoria:t.id_subcategoria})),null!==t.id_departamento&&""!==t.id_departamento&&(n=Object(b.a)(Object(b.a)({},n),{},{id_departamento:t.id_departamento})),null!==t.departamento&&""!==t.departamento&&(n=Object(b.a)(Object(b.a)({},n),{},{departamento:t.departamento})),null!==t.id_marca&&""!==t.id_marca&&(n=Object(b.a)(Object(b.a)({},n),{},{id_marca:t.id_marca})),null!==t.marca&&""!==t.marca&&(n=Object(b.a)(Object(b.a)({},n),{},{marca:t.marca})),null!==t.clave_producto_sat.Name&&(n=Object(b.a)(Object(b.a)({},n),{},{clave_producto_sat:t.clave_producto_sat})),e.abrupt("return",n);case 16:if("unidades_de_venta"!==a){e.next=20;break}for(c=[],r=0;r<t.length;r++)i={_id:t[r]._id,cantidad:t[r].cantidad,id_producto:t[r].id_producto,precio:t[r].precio,unidad_principal:t[r].unidad_principal,unidad:t[r].unidad,codigo_unidad:t[r].codigo_unidad,precio_unidad:t[r].precio_unidad},null!==t[r].codigo_barras&&""!==t[r].codigo_barras&&(i=Object(b.a)(Object(b.a)({},i),{},{codigo_barras:t[r].codigo_barras})),null!==t[r].default&&""!==t[r].default&&(i=Object(b.a)(Object(b.a)({},i),{},{default:t[r].default})),null!==t[r].descuento_activo&&""!==t[r].descuento_activo&&(i=Object(b.a)(Object(b.a)({},i),{},{descuento_activo:t[r].descuento_activo,descuento:t[r].descuento})),c.push(i);return e.abrupt("return",c);case 20:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Ri=["children","value","index"],Vi=["precios_producto"],Mi=[{numero_precio:1,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:2,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:3,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:4,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:5,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:6,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0}];function Li(e){var t=e.children,a=e.value,n=e.index,c=Object(ve.a)(e,Ri);return Object(B.jsx)("div",Object(b.a)(Object(b.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(B.jsx)(p.a,{p:3,height:"70vh",children:t})}))}function Ui(e){return{id:"reg-product-tab-".concat(e),"aria-controls":"tabpanel-reg-product-".concat(e)}}var Bi=Object(k.a)((function(e){return{root_app:{flexGrow:1,backgroundColor:e.palette.background.paper,display:"flex",maxHeight:"80vh"},iconSvg:{width:50},dialogContent:{padding:0},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},tabs:{borderRight:"1px solid ".concat(e.palette.divider)}}}));function qi(e){var t=e.accion,a=e.datos,n=e.productosRefetch,c=e.fromCompra,r=e.getProductos,i=Bi(),o=Object(l.useState)(!1),s=Object(g.a)(o,2),d=s[0],j=s[1],u=Object(l.useState)(0),m=Object(g.a)(u,2),O=m[0],x=m[1],h=Object(l.useContext)(fe),_=h.datos_generales,v=h.setDatosGenerales,y=h.precios,F=h.setPrecios,k=h.validacion,N=h.setValidacion,P=h.preciosP,D=h.setPreciosP,E=h.imagenes,A=h.setImagenes,T=h.setUnidadesVenta,W=h.almacen_inicial,$=h.setAlmacenInicial,R=h.unidadVentaXDefecto,V=h.setUnidadVentaXDefecto,M=h.centro_de_costos,L=h.setCentroDeCostos,U=h.setUpdate,q=h.preciosPlazos,J=h.setPreciosPlazos,G=h.setSubcategorias,H=h.setOnPreview,Y=h.setSubcostos,K=h.imagenes_eliminadas,Q=h.setImagenesEliminadas,Z=h.presentaciones,ee=h.setPresentaciones,te=h.presentaciones_eliminadas,ae=h.setPresentacionesEliminadas,ne=h.setAlmacenExistente,se=(h.almacen_existente,h.unidadVentaSecundaria),be=h.setUnidadVentaSecundaria,pe=JSON.parse(localStorage.getItem("sesionCafi")),me=Object(l.useContext)(fe).setAlert,Oe=Object(l.useState)(!1),xe=Object(g.a)(Oe,2),he=xe[0],_e=xe[1],ge=_.tipo_producto,Ce=Object(z.a)(zn),ye=Object(g.a)(Ce,1)[0],Se=Object(z.a)(Pn),Fe=Object(g.a)(Se,1)[0],we=function(e){j(!d),U(t),e&&t?Pe(e):Ne()},Ie=function(){var e=Object(f.a)(C.a.mark((function e(){var i,o,s,l,d,j;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=Si(_,y,W,0)).error){e.next=4;break}return N(i),e.abrupt("return");case 4:if(N(i),!(Z.length>0)){e.next=11;break}if(Z.filter((function(e){return e.color._id&&e.medida._id})).length===Z.length){e.next=11;break}return N({error:!0,message:"Faltan medidas o colores a tus presentaciones",vista7:!0}),me({message:"Faltan medidas o colores en tus presentaciones",status:"error",open:!0}),e.abrupt("return");case 11:return o=[Object(b.a)({},R),Object(b.a)({},se)],y.precios_producto=P,s=E,t&&(s=Object(da.a)(E).filter((function(e){return!e.key_imagen}))),e.next=17,$i(_,"datos_generales");case 17:return e.t0=e.sent,e.t1=y,e.t2=s,e.t3=K,e.t4=W,e.t5=M,e.next=25,$i(o,"unidades_de_venta");case 25:if(e.t6=e.sent,e.t7=Z,e.t8=te,e.t9=q,e.t10=pe.empresa._id,e.t11=pe.sucursal._id,e.t12=pe._id,l={datos_generales:e.t0,precios:e.t1,imagenes:e.t2,imagenes_eliminadas:e.t3,almacen_inicial:e.t4,centro_de_costos:e.t5,unidades_de_venta:e.t6,presentaciones:e.t7,presentaciones_eliminadas:e.t8,precio_plazos:e.t9,empresa:e.t10,sucursal:e.t11,usuario:e.t12},_e(!0),e.prev=34,!t){e.next=42;break}return e.next=38,Fe({variables:{input:l,id:a._id}});case 38:d=e.sent,me({message:"\xa1Listo! ".concat(d.data.actualizarProducto.message),status:"success",open:!0}),e.next=46;break;case 42:return e.next=44,ye({variables:{input:l}});case 44:j=e.sent,me({message:"\xa1Listo! ".concat(j.data.crearProducto.message),status:"success",open:!0});case 46:_e(!1),we(),c?r():n(),e.next=57;break;case 51:e.prev=51,e.t13=e.catch(34),_e(!1),me({message:"Error: ".concat(e.t13.message),status:"error",open:!0}),console.log(e.t13),e.t13.networkError?console.log(e.t13.networkError.result):e.t13.graphQLErrors&&console.log(e.t13.graphQLErrors);case 57:case"end":return e.stop()}}),e,null,[[34,51]])})));return function(){return e.apply(this,arguments)}}(),Ne=function(){v(ce),F(re),V(ie),be(oe),D(Mi),T(le),$(de),L({}),J(ue),G([]),A([]),H({index:"",image:""}),N({error:!1,message:""}),Y([]),Q([]),ee([]),ae([]),x(0)},Pe=function(e){var t=e.precios,a=(t.precios_producto,Object(ve.a)(t,Vi)),n=e.unidades_de_venta,c=e.unidades_de_venta.filter((function(e){return!1===e.default})),r=e.unidades_de_venta.filter((function(e){return!0===e.default}));v(e.datos_generales),F(a),L(e.centro_de_costos?e.centro_de_costos:je),A(e.imagenes),J(e.precio_plazos),T(n),D(e.precios.precios_producto),V(r[0]),be(c[0]),ee(e.medidas_producto?e.medidas_producto:[]),e.inventario_general.length>0?ne(!0):ne(!1)};window.onkeydown=function(e){114===e.keyCode&&document.getElementById("modal-registro-product").click()};var De=Object(B.jsx)(w.a,{variant:"contained",color:"primary",onClick:function(){return Ie()},size:"large",startIcon:Object(B.jsx)(Ha.a,{}),disabled:!(_.clave_alterna&&_.tipo_producto&&_.nombre_generico&&_.nombre_comercial&&y.precio_de_compra.precio_con_impuesto&&y.precio_de_compra.precio_sin_impuesto&&y.unidad_de_compra.cantidad),children:"Guardar"}),Te=function(){return t||4!==O?t&&"OTROS"===ge&&4===O||t&&"OTROS"!==ge&&5===O?De:Object(B.jsx)(w.a,{variant:"contained",color:"primary",onClick:function(){return x(O+1)},size:"large",endIcon:Object(B.jsx)(Ti.a,{}),disableElevation:!0,children:"Siguiente"}):De};return Object(B.jsxs)(l.Fragment,{children:[t?Object(B.jsx)(X.a,{color:"default",onClick:function(){return we(a)},children:Object(B.jsx)(en.a,{})}):c?Object(B.jsx)(X.a,{color:"primary",onClick:function(){return we()},children:Object(B.jsx)(It.a,{})}):Object(B.jsx)(w.a,{id:"modal-registro-product",color:"primary",variant:"contained",size:"large",onClick:function(){return we()},startIcon:Object(B.jsx)(It.a,{}),children:"Agregar"}),Object(B.jsxs)(Ee.a,{open:d,fullWidth:!0,maxWidth:"lg",scroll:"paper",disableEscapeKeyDown:!0,onClose:function(e,t){"backdropClick"!==t&&we()},children:[Object(B.jsxs)("div",{className:i.root_app,children:[Object(B.jsxs)(ke.a,{style:{minWidth:"200px"},value:O,onChange:function(e,t){x(t)},variant:"scrollable",orientation:"vertical",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",className:i.tabs,children:[Object(B.jsx)(ze.a,Object(b.a)({style:{minWidth:"200px"},label:"Datos generales",icon:Object(B.jsx)(nc.a,{color:"secondary",badgeContent:Object(B.jsx)(S.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!k.error||!k.vista1,children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/portapapeles.svg",alt:"icono registro",className:i.iconSvg})})},Ui(0))),Object(B.jsx)(ze.a,Object(b.a)({style:{minWidth:"200px"},label:"Precios de venta",icon:Object(B.jsx)(nc.a,{color:"secondary",badgeContent:Object(B.jsx)(S.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!k.error||!k.vista2,children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/etiqueta-de-precio.svg",alt:"icono venta",className:i.iconSvg})})},Ui(1))),Object(B.jsx)(ze.a,Object(b.a)({style:{minWidth:"200px"},label:"Inventario y almacen",icon:Object(B.jsx)(nc.a,{color:"secondary",badgeContent:Object(B.jsx)(S.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!k.error||!k.vista3,children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/tarea-completada.svg",alt:"icono almacen",className:i.iconSvg})})},Ui(2))),Object(B.jsx)(ze.a,Object(b.a)({style:{minWidth:"200px"},label:"Centro de costos",icon:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/costos.svg",alt:"icono almacen",className:i.iconSvg})},Ui(3))),Object(B.jsx)(ze.a,Object(b.a)({style:{minWidth:"200px"},label:"Imagenes",icon:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/imagenes.svg",alt:"icono imagenes",className:i.iconSvg})},Ui(4))),t&&"OTROS"!==_.tipo_producto?Object(B.jsx)(ze.a,Object(b.a)({style:{minWidth:"200px"},label:"Tallas y colores",icon:Object(B.jsx)(nc.a,{color:"secondary",badgeContent:Object(B.jsx)(S.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!k.error||!k.vista7,children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/tallas-colores.svg",alt:"icono colores",className:i.iconSvg})})},Ui(5))):null]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(p.a,{m:1,display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){return we()},size:"large",children:Object(B.jsx)(Pt.a,{})})}),Object(B.jsxs)(Ae.a,{className:i.dialogContent,children:[Object(B.jsx)(Je.a,{className:i.backdrop,open:he,children:Object(B.jsx)(I.a,{color:"inherit"})}),Object(B.jsx)(Ji,{value:O})]})]})]}),Object(B.jsxs)(Ue.a,{style:{display:"flex",justifyContent:"space-between"},children:[Object(B.jsx)(w.a,{variant:"outlined",color:"primary",onClick:function(){return x(O-1)},size:"large",startIcon:Object(B.jsx)(Wi.a,{}),disabled:0===O,children:"Anterior"}),Object(B.jsx)(Te,{})]})]})]})}var Ji=function(e){var t=e.value,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(qe.a)(kn,{variables:{empresa:a.empresa._id,sucursal:a.sucursal._id},fetchPolicy:"network-only"}),c=n.loading,r=n.data,i=n.error,o=n.refetch;if(Object(l.useEffect)((function(){return function(){o()}}),[o]),c)return Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:[Object(B.jsx)(I.a,{}),Object(B.jsx)(S.a,{variant:"h6",children:"Cargando..."})]});if(i)return Object(B.jsx)(Ze,{error:i});var s=r.obtenerConsultasProducto;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(Li,{value:t,index:0,children:Object(B.jsx)(dr,{obtenerConsultasProducto:s,refetch:o})}),Object(B.jsx)(Li,{value:t,index:1,children:Object(B.jsx)(La,{})}),Object(B.jsx)(Li,{value:t,index:2,children:Object(B.jsx)(yi,{obtenerConsultasProducto:s,refetch:o})}),Object(B.jsx)(Li,{value:t,index:3,children:Object(B.jsx)(Ei,{obtenerConsultasProducto:s,refetch:o})}),Object(B.jsx)(Li,{value:t,index:4,children:Object(B.jsx)(Or,{})}),Object(B.jsx)(Li,{value:t,index:5,children:Object(B.jsx)(Kn,{obtenerConsultasProducto:s,refetch:o})})]})},Gi=a(246);function Hi(){var e=Object(l.useContext)(qa).preciosVenta;return Object(B.jsx)("div",{children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{"aria-label":"simple table",size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{style:{minWidth:150},children:"Precios de venta"}),[1,2,3,4,5,6].map((function(e,t){return Object(B.jsx)(Oa.a,{style:{minWidth:100},children:e},t)}))]})}),Object(B.jsx)(xa.a,{children:["Utilidad","Precio de venta"].map((function(t,a){return Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{style:{border:0},children:Object(B.jsx)("b",{children:t})}),e.map((function(e,a){return Object(B.jsx)(Yi,{data:e,index:a,tipo:t},a)}))]},a)}))})]})})})}var Yi=function(e){var t=e.data,a=e.tipo,n=e.index,c=Object(l.useContext)(qa),r=c.preciosVenta,i=c.setPreciosVenta,o=c.datosProducto,s=c.productoOriginal.precios,d=Object(l.useState)(t.precio_neto),j=Object(g.a)(d,2),u=j[0],p=j[1],m=Object(b.a)({},r[n]),O=Object(da.a)(r),x=o.costo/s.unidad_de_compra.cantidad,h=s.precio_de_compra.precio_sin_impuesto/s.unidad_de_compra.cantidad;isNaN(h)&&(h=0),isNaN(x)&&(x=0);var _=Object(l.useCallback)((function(){if(m.numero_precio===t.numero_precio){m.precio_neto=x,p(x);var e=(t.utilidad?t.utilidad:0)/100,a=parseFloat((h*e+h).toFixed(2));if(m.precio_venta=parseFloat(a.toFixed(2)),s.iva_activo||s.ieps_activo){var c=x+x*e;m.precio_neto=parseFloat(c.toFixed(2)),p(parseFloat(c.toFixed(2)))}else m.precio_neto=parseFloat(a.toFixed(2)),p(parseFloat(a.toFixed(2)));O.splice(n,1,m),i(O)}}),[o.costo,o.cantidad]);switch(Object(l.useEffect)((function(){(1===t.numero_precio||t.numero_precio>1&&u)&&_()}),[_]),a){case"Utilidad":return Object(B.jsxs)(Oa.a,{style:{border:0},children:[t.utilidad,"%"]});case"Precio de venta":return Object(B.jsxs)(Oa.a,{style:{border:0},children:["$",parseFloat(u).toFixed(2)]});default:return null}},Ki=a(914);function Qi(){var e=Object(l.useContext)(qa),t=e.datosProducto,a=e.setDatosProducto,n=e.productoOriginal,c=Object(l.useContext)(fe).presentaciones,r=n.precios,i=r.iva,o=r.ieps,s=r.precio_de_compra,d=s.precio_sin_impuesto,j=s.precio_con_impuesto,u=s.iva,m=s.ieps,O=u+m,x=t.costo-O,h=0,_=0;if(c.length>0){if(c.forEach((function(e){var t=e.cantidad_nueva;_+=t||0})),isNaN(_))return;h=_}else h=t.cantidad;var f=x*h;return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)(p.a,{display:"flex",width:200,children:[Object(B.jsx)(F.a,{variant:"outlined",size:"small",fullWidth:!0,inputMode:"numeric",onChange:function(e){return function(e){if(e&&0!==parseFloat(e)){var n=parseFloat(e),c=Math.round(n/f*100),r=f-n,s=parseFloat(r)*parseFloat(i<10?".0"+i:"."+i),l=parseFloat(r)*parseFloat(o<10?".0"+o:"."+o),p=s+l,x=r+p;a(Object(b.a)(Object(b.a)({},t),{},{impuestos_descuento:p,descuento_porcentaje:parseFloat(c),descuento_precio:parseFloat(n.toFixed(2)),subtotal_descuento:parseFloat(r.toFixed(2)),total_descuento:parseFloat(x.toFixed(2)),iva_total:parseFloat(s.toFixed(2)),ieps_total:parseFloat(l.toFixed(2))}))}else a(Object(b.a)(Object(b.a)({},t),{},{impuestos_descuento:O*h,descuento_porcentaje:0,descuento_precio:0,subtotal_descuento:d*h,total_descuento:j*h,iva_total:u*h,ieps_total:m*h}))}(e.target.value)},disabled:!t.producto.datos_generales,value:t.descuento_precio,InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})}}),Object(B.jsx)(p.a,{mr:1}),Object(B.jsx)(F.a,{variant:"outlined",size:"small",fullWidth:!0,inputMode:"numeric",onChange:function(e){return function(e){if(e&&0!==parseFloat(e)){var n=parseFloat(e),c=Math.round(f*n/100),r=f-c,s=parseFloat(r)*parseFloat(i<10?".0"+i:"."+i),l=parseFloat(r)*parseFloat(o<10?".0"+o:"."+o),p=s+l,x=r+p;a(Object(b.a)(Object(b.a)({},t),{},{impuestos_descuento:parseFloat(p.toFixed(2)),descuento_porcentaje:parseFloat(n),descuento_precio:parseFloat(c.toFixed(2)),subtotal_descuento:parseFloat(r.toFixed(2)),total_descuento:parseFloat(x.toFixed(2)),iva_total:parseFloat(s.toFixed(2)),ieps_total:parseFloat(l.toFixed(2))}))}else a(Object(b.a)(Object(b.a)({},t),{},{impuestos_descuento:O*h,descuento_porcentaje:0,descuento_precio:0,subtotal_descuento:d*h,total_descuento:j*h,iva_total:u*h,ieps_total:m*h}))}(e.target.value)},disabled:!t.producto.datos_generales,value:t.descuento_porcentaje,InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"%"})}})]})})}var Xi=Object(l.createContext)(),Zi=function(e){var t=e.children,a=Object(l.useState)({direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},estado_cliente:!0}),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(!1),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1],_=Object(l.useState)([]),f=Object(g.a)(_,2),v=f[0],C=f[1],y=Object(l.useState)(!1),S=Object(g.a)(y,2),F=S[0],w=S[1];return Object(B.jsx)(Xi.Provider,{value:{cliente:c,setCliente:r,toUpdate:s,setToUpdate:d,error:b,setError:p,update:x,setUpdate:h,setUpdateClientVenta:w,updateClientVenta:F,clientes:v,setClientes:C},children:t})},eo=Object(k.a)((function(e){return{avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:150,height:150,border:"dashed 2px #000000"},avatar:{width:135,height:135,"& > .icon":{fontSize:100}},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}},title:{fontWeight:"500","& span":{color:"red"}}}}));function to(e){var t=e.tipo,a=e.accion,n=eo(),c=Object(l.useContext)(Xi),r=c.cliente,i=c.setCliente,o=c.error,s=Object(l.useState)(""),d=Object(g.a)(s,2),j=d[0],u=d[1],m=Object(l.useCallback)((function(e){var t=new FileReader;t.readAsDataURL(e[0]),t.onload=function(){var e=t.result;u(e)},i(Object(b.a)(Object(b.a)({},r),{},{imagen:e[0]}))}),[r,i]),O=Object(Be.a)({accept:"image/jpeg, image/png",noKeyboard:!0,onDrop:m}),x=O.getRootProps,h=O.getInputProps,f=function(e){var t=e.target,a=t.name,n=t.value;i(Object(b.a)(Object(b.a)({},r),{},Object(_.a)({},a,n)))},v=function(e){var t=e.target,a=t.name,n=t.value;i(Object(b.a)(Object(b.a)({},r),{},{direccion:Object(b.a)(Object(b.a)({},r.direccion),{},Object(_.a)({},a,n))}))};return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)($e.a,{container:!0,className:n.input,children:[Object(B.jsx)($e.a,{item:!0,md:3,xs:12,style:{display:"flex",justifyContent:"center",marginTop:"8px"},children:Object(B.jsxs)(p.a,Object(b.a)(Object(b.a)({className:n.avatarContainer},x()),{},{children:[Object(B.jsx)("input",Object(b.a)({},h())),j?Object(B.jsx)(Re.a,{variant:"square",className:n.avatar,src:"".concat(j)}):Object(B.jsx)(Re.a,{variant:"square",className:n.avatar,src:"".concat(r.imagen)})]}))}),Object(B.jsx)($e.a,{item:!0,md:9,xs:12,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:["registrar"===a?null:Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsx)(S.a,{className:n.title,children:"N. Cliente"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"numero_cliente",variant:"outlined",value:r.numero_cliente?r.numero_cliente:"",onChange:f,disabled:!0,type:"number"})]}),Object(B.jsxs)($e.a,{item:!0,md:"registrar"===a?12:9,xs:12,children:[Object(B.jsxs)(S.a,{className:n.title,children:[Object(B.jsx)("span",{children:"* "}),"Nombre Cliente"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:o&&!r.nombre_cliente,name:"nombre_cliente",variant:"outlined",value:r.nombre_cliente?r.nombre_cliente:"",helperText:o?"Campo Requerido":"",onChange:f,inputProps:{style:{textTransform:"uppercase"}}})]}),"CLIENTE"===t?null:Object(B.jsxs)($e.a,{item:!0,md:4,xs:12,children:[Object(B.jsxs)(S.a,{className:n.title,children:[Object(B.jsx)("span",{children:"* "}),"Representante"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:o&&!r.representante,name:"representante",variant:"outlined",value:r.representante?r.representante:"",helperText:o?"Campo Requerido":"",onChange:f,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:"CLIENTE"===t?6:4,xs:12,children:[Object(B.jsxs)(S.a,{className:n.title,children:[Object(B.jsx)("span",{children:"* "}),"Clave(Tarjeta de puntos)"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:o&&!r.clave_cliente,name:"clave_cliente",variant:"outlined",value:r.clave_cliente?r.clave_cliente:"",helperText:o?"Campo Requerido":"",onChange:f,InputProps:{endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(X.a,{color:"primary",size:"small",onClick:function(){return function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();i(Object(b.a)(Object(b.a)({},r),{},{clave_cliente:t}))}()},children:Object(B.jsx)(ga.a,{})})}),disabled:!0},type:"number"})]}),Object(B.jsxs)($e.a,{item:!0,md:"CLIENTE"===t?6:4,xs:12,children:[Object(B.jsx)(S.a,{className:n.title,children:"Fecha nacimiento"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fecha_nacimiento",variant:"outlined",type:"date",onChange:f,value:r.fecha_nacimiento?r.fecha_nacimiento:""})]})]})}),Object(B.jsx)($e.a,{item:!0,md:12,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsx)(S.a,{className:n.title,children:"CURP"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"curp",variant:"outlined",value:r.curp?r.curp:"",onChange:f,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsxs)(S.a,{className:n.title,children:[Object(B.jsx)("span",{children:"* "}),"Email"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:o&&!r.email,name:"email",variant:"outlined",value:r.email?r.email:"",helperText:o?"Campo Requerido":"",onChange:f})]}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsxs)(S.a,{className:n.title,children:[Object(B.jsx)("span",{children:"* "}),"Num. Telefono"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:o&&!r.telefono,name:"telefono",variant:"outlined",value:r.telefono?r.telefono:"",helperText:o?"Campo Requerido":"",onChange:f,type:"number"})]}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsx)(S.a,{className:n.title,children:"Num. Celular"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"celular",variant:"outlined",value:r.celular?r.celular:"",onChange:f,type:"number"})]})]})}),Object(B.jsxs)($e.a,{item:!0,md:12,children:[Object(B.jsxs)(p.a,{my:2,children:[Object(B.jsx)(S.a,{className:n.title,children:Object(B.jsx)("b",{children:"Domicilio"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsxs)(S.a,{className:n.title,children:[Object(B.jsx)("span",{children:"* "}),"Calle"]}),Object(B.jsx)(F.a,{size:"small",fullWidth:!0,error:o&&!r.direccion.calle,name:"calle",variant:"outlined",value:r.direccion.calle?r.direccion.calle:"",helperText:o?"Campo Requerido":"",onChange:v,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsxs)(S.a,{className:n.title,children:[Object(B.jsx)("span",{children:"* "}),"Num. Ext"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.no_ext,name:"no_ext",variant:"outlined",value:r.direccion.no_ext?r.direccion.no_ext:"",helperText:o?"Campo Requerido":"",onChange:v,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsx)(S.a,{className:n.title,children:"Num. Int"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"no_int",variant:"outlined",value:r.direccion.no_int?r.direccion.no_int:"",onChange:v,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsxs)(S.a,{className:n.title,children:[Object(B.jsx)("span",{children:"* "}),"C\xf3digo postal"]}),Object(B.jsx)(F.a,{size:"small",fullWidth:!0,error:o&&!r.direccion.codigo_postal,name:"codigo_postal",variant:"outlined",value:r.direccion.codigo_postal?r.direccion.codigo_postal:"",helperText:o?"Campo Requerido":"",onChange:v})]}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsxs)(S.a,{className:n.title,children:[Object(B.jsx)("span",{children:"* "}),"Colonia"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.colonia,name:"colonia",variant:"outlined",value:r.direccion.colonia?r.direccion.colonia:"",helperText:o?"Campo Requerido":"",onChange:v,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsxs)(S.a,{className:n.title,children:[Object(B.jsx)("span",{children:"* "}),"Municipio"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.municipio,name:"municipio",variant:"outlined",value:r.direccion.municipio?r.direccion.municipio:"",helperText:o?"Campo Requerido":"",onChange:v,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsx)(S.a,{className:n.title,children:"Localidad"}),Object(B.jsx)(F.a,{size:"small",name:"localidad",variant:"outlined",value:r.direccion.localidad?r.direccion.localidad:"",onChange:v,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsxs)(S.a,{className:n.title,children:[Object(B.jsx)("span",{children:"* "}),"Estado"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.estado,name:"estado",variant:"outlined",value:r.direccion.estado?r.direccion.estado:"",helperText:o?"Campo Requerido":"",onChange:v,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsxs)(S.a,{className:n.title,children:[Object(B.jsx)("span",{children:"* "}),"Pais"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.pais,name:"pais",variant:"outlined",value:r.direccion.pais?r.direccion.pais:"",helperText:o?"Campo Requerido":"",onChange:v,inputProps:{style:{textTransform:"uppercase"}}})]})]})]})]})})}var ao,no,co,ro,io=Object(k.a)((function(e){return{title:{fontWeight:"500"}}}));function oo(e){var t=e.tipo,a=e.cliente_base,n=io(),c=Object(l.useContext)(Xi),r=c.cliente,i=c.setCliente,o=a?a.credito_disponible:0,s=(a?a.limite_credito:0)-o,d=function(e){var t=e.target.name;if("numero_descuento"!==t)if("limite_credito"!==t)i(Object(b.a)(Object(b.a)({},r),{},Object(_.a)({},e.target.name,e.target.value)));else{var a,n=parseInt(e.target.value)-s;i(Object(b.a)(Object(b.a)({},r),{},(a={},Object(_.a)(a,e.target.name,parseInt(e.target.value)),Object(_.a)(a,"credito_disponible",n),a)))}else i(Object(b.a)(Object(b.a)({},r),{},Object(_.a)({},e.target.name,parseInt(e.target.value))))};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{my:3,children:Object(B.jsxs)(St.a,{severity:"info",children:["Si deseas hacer facturas a este cliente el ",Object(B.jsx)("b",{children:"RFC"})," y la"," ",Object(B.jsx)("b",{children:"Razon social"})," son obligatorios."]})}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Cr\xe9dito utilizado:"})," $"," ",s?Fa(s):0]})}),Object(B.jsx)($e.a,{item:!0,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Cr\xe9dito disponible:"})," $"," ",r.credito_disponible?Fa(r.credito_disponible):0]})})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsx)(S.a,{className:n.title,children:"RFC"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"rfc",variant:"outlined",value:r.rfc?r.rfc:"",onChange:d,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsx)(S.a,{className:n.title,children:"Razon social"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"razon_social",variant:"outlined",value:r.razon_social?r.razon_social:"",onChange:d,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:4,xs:12,children:[Object(B.jsx)(S.a,{className:n.title,children:"Descuento"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"numero_descuento",variant:"outlined",value:r.numero_descuento?r.numero_descuento:"",onChange:d})]}),Object(B.jsxs)($e.a,{item:!0,md:4,xs:12,children:[Object(B.jsx)(S.a,{className:n.title,children:"Limite de cr\xe9dito"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"limite_credito",variant:"outlined",value:r.limite_credito?r.limite_credito:"",onChange:d,error:s>r.limite_credito})]}),Object(B.jsxs)($e.a,{item:!0,md:4,xs:12,children:[Object(B.jsx)(S.a,{className:n.title,children:"D\xedas de cr\xe9dito"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"dias_credito",variant:"outlined",value:r.dias_credito?r.dias_credito:"",onChange:d,inputProps:{style:{textTransform:"uppercase"}}})]})]}),"CLIENTE"!==t?Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(p.a,{my:3,children:[Object(B.jsx)(S.a,{className:n.title,children:"Datos bancarios"}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsx)(S.a,{className:n.title,children:"Banco"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"banco",variant:"outlined",value:r.banco?r.banco:"",onChange:d,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsx)(S.a,{className:n.title,children:"No. de Cuenta Bancaria"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"numero_cuenta",variant:"outlined",value:r.numero_cuenta?r.numero_cuenta:"",onChange:d})]})]})]}):null]})}var so,lo,jo,uo,bo,po,mo=Object(P.d)(ao||(ao=Object(N.a)(["\n\tmutation crearCliente($input: CrearClienteInput) {\n\t\tcrearCliente(input: $input) {\n\t\t\t_id\n\t\t\tnumero_cliente\n\t\t\tclave_cliente\n\t\t\trepresentante\n\t\t\tnombre_cliente\n\t\t\trfc\n\t\t\tcurp\n\t\t\ttelefono\n\t\t\tcelular\n\t\t\temail\n\t\t\tnumero_descuento\n\t\t\tlimite_credito\n\t\t\tdias_credito\n\t\t\trazon_social\n\t\t\tdireccion {\n\t\t\t\tcalle\n\t\t\t\tno_ext\n\t\t\t\tno_int\n\t\t\t\tcodigo_postal\n\t\t\t\tcolonia\n\t\t\t\tmunicipio\n\t\t\t\tlocalidad\n\t\t\t\testado\n\t\t\t\tpais\n\t\t\t}\n\t\t\timagen\n\t\t\testado_cliente\n\t\t\ttipo_cliente\n\t\t}\n\t}\n"]))),Oo=Object(P.d)(no||(no=Object(N.a)(["\n\tquery obtenerClientes($tipo: String!, $filtro: String, $empresa: ID!, $eliminado: Boolean) {\n\t\tobtenerClientes(tipo: $tipo, filtro: $filtro, empresa: $empresa, eliminado: $eliminado) {\n\t\t\t_id\n\t\t\tnumero_cliente\n\t\t\tclave_cliente\n\t\t\trepresentante\n\t\t\tnombre_cliente\n\t\t\trfc\n\t\t\tcurp\n\t\t\ttelefono\n\t\t\tcelular\n\t\t\temail\n\t\t\tnumero_descuento\n\t\t\tlimite_credito\n\t\t\tcredito_disponible\n\t\t\tdias_credito\n\t\t\trazon_social\n\t\t\tdireccion {\n\t\t\t\tcalle\n\t\t\t\tno_ext\n\t\t\t\tno_int\n\t\t\t\tcodigo_postal\n\t\t\t\tcolonia\n\t\t\t\tmunicipio\n\t\t\t\tlocalidad\n\t\t\t\testado\n\t\t\t\tpais\n\t\t\t}\n\t\t\timagen\n\t\t\testado_cliente\n\t\t\ttipo_cliente\n\t\t\tbanco\n\t\t\tnumero_cuenta\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t\tsucursales_activas\n\t\t\t\tlimite_sucursales\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t\tmonedero_electronico\n\t\t\tfecha_nacimiento\n    \t\tfecha_registro\n\t\t\teliminado\n\t\t}\n\t}\n"]))),xo=Object(P.d)(co||(co=Object(N.a)(["\n\tmutation actualizarCliente($input: ActualizarClienteInput, $id: ID!) {\n\t\tactualizarCliente(id: $id, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),ho=Object(P.d)(ro||(ro=Object(N.a)(["\n\tmutation eliminarCliente($id: ID!) {\n\t\teliminarCliente(id: $id) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),_o=["numero_cliente","_id","clave_cliente","sucursal","empresa"];function fo(e){var t=e.tipo,a=e.accion,n=e.datos,c=e.refetch,r=e.fromCompras,i=e.ventas,o=e.handleClickOpen,s=Object(l.useContext)(Xi),d=s.cliente,j=s.setCliente,u=s.setError,m=s.updateClientVenta,O=s.setUpdateClientVenta,x=s.update,h=s.setUpdate,_=Object(l.useState)(!1),v=Object(g.a)(_,2),F=v[0],I=v[1],k=Object(l.useState)(!1),N=Object(g.a)(k,2),P=N[0],D=N[1],E=Object(l.useState)({message:"",status:"",open:!1}),A=Object(g.a)(E,2),T=A[0],W=A[1],$=JSON.parse(localStorage.getItem("sesionCafi")),R=Object(l.useCallback)((function(){j({direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},estado_cliente:!0})}),[j]),V=function(){I(!0),n&&j(n)},M=function(){I(!1),R()},L=Object(z.a)(mo),U=Object(g.a)(L,1)[0],q=Object(z.a)(xo),G=Object(g.a)(q,1)[0],H=function(){var e=Object(f.a)(C.a.mark((function e(r){var s,l,j,p,_,f,g;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),(s=Object(b.a)({},d)).clave_cliente&&s.nombre_cliente&&s.telefono&&s.email&&s.direccion.calle&&s.direccion.municipio&&s.direccion.estado&&s.direccion.pais){e.next=8;break}if("CLIENTE"===t||s.representante){e.next=6;break}return u(!0),e.abrupt("return");case 6:return u(!0),e.abrupt("return");case 8:if(!(n.limite_credito-n.credito_disponible>s.limite_credito)){e.next=12;break}return W({message:"Cr\xe9dito utilizado es mayor al l\xedmite de cr\xe9dito",status:"error",open:!0}),e.abrupt("return");case 12:if(D(!0),e.prev=13,"registrar"!==a){e.next=26;break}return s.tipo_cliente=t,s.empresa=$.empresa._id,s.sucursal=$.sucursal._id,"CLIENTE"===t&&(s.representante=""),l=s,e.next=22,U({variables:{input:l}});case 22:j=e.sent,!0===i&&(_=JSON.parse(localStorage.getItem("DatosVentas")),f=null===_?{}:_,localStorage.setItem("DatosVentas",JSON.stringify({subTotal:void 0===f.subTotal?0:f.subTotal,total:void 0===f.total?0:f.total,impuestos:void 0===f.impuestos?0:f.impuestos,iva:void 0===f.iva?0:f.iva,ieps:void 0===f.ieps?0:f.ieps,descuento:void 0===f.descuento?0:f.descuento,monedero:void 0===f.monedero?0:f.monedero,cliente:j.data.crearCliente,venta_cliente:!0,productos:(null===(p=f.productos)||void 0===p?void 0:p.length)>0?f.productos:[],tipo_emision:f.tipo_emision?f.tipo_emision:"TICKET"})),O(!m),M(),o()),e.next=29;break;case 26:return s.numero_cliente,s._id,s.clave_cliente,s.sucursal,s.empresa,g=Object(ve.a)(s,_o),e.next=29,G({variables:{input:g,id:s._id}});case 29:c&&c(),h(!x),W({message:"\xa1Listo!",status:"success",open:!0}),u(!1),D(!1),M(),e.next=43;break;case 37:e.prev=37,e.t0=e.catch(13),W({message:e.t0.message,status:"error",open:!0}),D(!1),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 43:case"end":return e.stop()}}),e,null,[[13,37]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(J,{alert:T,setAlert:W}),"registrar"===a?r?Object(B.jsx)(X.a,{color:"primary",onClick:V,children:Object(B.jsx)(It.a,{})}):Object(B.jsx)(w.a,{color:"primary",variant:"contained",size:"large",onClick:V,startIcon:Object(B.jsx)(It.a,{}),children:"Agregar"}):Object(B.jsx)(X.a,{onClick:V,children:Object(B.jsx)(en.a,{})}),Object(B.jsxs)(Ee.a,{open:F,onClose:function(e,t){"backdropClick"!==t&&M()},fullWidth:!0,maxWidth:"md",children:[Object(B.jsxs)(wt.a,{style:{padding:0},children:[Object(B.jsx)(He,{loading:P,setLoading:D}),Object(B.jsx)(Ie.a,{position:"static",color:"default",elevation:0,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",children:"registrar"===a?"Registrar":"Actualizar"}),Object(B.jsx)(p.a,{flexGrow:1}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",size:"large",onClick:function(){return M()},children:Object(B.jsx)(Pt.a,{})})]})})]}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(y.a,{children:Object(B.jsxs)("form",{id:"crear-cliente-form",onSubmit:H,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Informaci\xf3n b\xe1sica"})}),Object(B.jsx)(Le.a,{}),Object(B.jsx)(to,{tipo:t,accion:a}),Object(B.jsx)(p.a,{my:2}),Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Informaci\xf3n de credito"})}),Object(B.jsx)(Le.a,{}),Object(B.jsx)(oo,{tipo:t,accion:a,cliente_base:n})]})})}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{variant:"contained",color:"primary",size:"large",startIcon:Object(B.jsx)(Dt.a,{}),type:"submit",form:"crear-cliente-form",children:"Guardar"})})]})]})}var go=Object(P.d)(so||(so=Object(N.a)(["\n  mutation crearCompra(\n    $input: CrearCompraInput\n    $empresa: ID!\n    $sucursal: ID!\n    $usuario: ID!\n  ) {\n    crearCompra(\n      input: $input\n      empresa: $empresa\n      sucursal: $sucursal\n      usuario: $usuario\n    ) {\n      message\n    }\n  }\n"]))),vo=Object(P.d)(lo||(lo=Object(N.a)(["\n  mutation crearCompraEnEspera(\n    $input: CrearCompraInput\n    $empresa: ID!\n    $sucursal: ID!\n    $usuario: ID!\n  ) {\n    crearCompraEnEspera(\n      input: $input\n      empresa: $empresa\n      sucursal: $sucursal\n      usuario: $usuario\n    ) {\n      message\n    }\n  }\n"]))),Co=Object(P.d)(jo||(jo=Object(N.a)(["\n  query obtenerComprasRealizadas(\n    $empresa: ID!\n    $sucursal: ID!\n    $filtro: String\n    $fecha: String\n  ) {\n    obtenerComprasRealizadas(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtro: $filtro\n      fecha: $fecha\n    ) {\n      _id\n      usuario {\n        _id\n        numero_usuario\n        nombre\n        estado_usuario\n      }\n      empresa {\n        _id\n        nombre_empresa\n      }\n      sucursal {\n        _id\n        nombre_sucursal\n      }\n      proveedor {\n        id_proveedor {\n          _id\n          numero_cliente\n          clave_cliente\n          nombre_cliente\n          telefono\n          email\n        }\n        numero_cliente\n        clave_cliente\n        nombre_cliente\n      }\n      productos {\n        _id\n        id_compra\n        id_traspaso\n        id_producto\n        producto {\n          almacen_inicial {\n            almacen\n            cantidad\n            fecha_de_expiracion\n            id_almacen\n          }\n          datos_generales {\n            codigo_barras\n            clave_alterna\n            tipo_producto\n            nombre_comercial\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat {\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n          precios {\n            ieps\n            ieps_activo\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            granel\n            inventario {\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n            }\n            precio_de_compra {\n              precio_con_impuesto\n              precio_sin_impuesto\n              iva\n              ieps\n            }\n            precios_producto {\n              numero_precio\n              precio_neto\n              precio_venta\n              unidad_mayoreo\n              utilidad\n            }\n            unidad_de_compra {\n              cantidad\n              precio_unitario_con_impuesto\n              precio_unitario_sin_impuesto\n              unidad\n            }\n          }\n          unidades_de_venta {\n            _id\n            cantidad\n            codigo_barras\n            id_producto\n            precio\n            unidad\n            unidad_principal\n          }\n        }\n        concepto\n        cantidad\n        cantidad_regalo\n        cantidad_total\n        costo\n        descuento_porcentaje\n        descuento_precio\n        impuestos\n        mantener_precio\n        subtotal\n        total\n        medida {\n          id_medida\n          medida\n          tipo\n        }\n        color {\n          id_color\n          color\n          hex\n        }\n        unidad\n        id_unidad_venta\n        empresa\n        sucursal\n        usuario\n        year_registro\n        numero_semana_year\n        numero_mes_year\n        fecha_registro\n      }\n      almacen {\n        id_almacen {\n          _id\n          nombre_almacen\n          id_usuario_encargado {\n            _id\n            numero_usuario\n            nombre\n          }\n        }\n        nombre_almacen\n      }\n      compra_credito\n      credito_pagado\n      saldo_credito_pendiente\n      fecha_vencimiento_credito\n      subtotal\n      impuestos\n      total\n      year_registro\n      numero_semana_year\n      numero_mes_year\n      fecha_registro\n    }\n  }\n"]))),yo=Object(P.d)(uo||(uo=Object(N.a)(["\n  query obtenerComprasEnEspera($empresa: ID!, $sucursal: ID!, $filtro: String) {\n    obtenerComprasEnEspera(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtro: $filtro\n    ) {\n      _id\n      en_espera\n      proveedor {\n        id_proveedor\n        clave_cliente\n        numero_cliente\n        nombre_cliente\n      }\n      almacen {\n        id_almacen\n        nombre_almacen\n      }\n      productos {\n        producto {\n          almacen_inicial {\n            almacen\n            cantidad\n            fecha_de_expiracion\n            id_almacen\n          }\n          datos_generales {\n            codigo_barras\n            clave_alterna\n            tipo_producto\n            nombre_comercial\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat {\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n          precios {\n            ieps\n            ieps_activo\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            precio_de_compra {\n              ieps\n              iva\n              precio_con_impuesto\n              precio_sin_impuesto\n            }\n            precios_producto {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n            unidad_de_compra {\n              cantidad\n              precio_unitario_con_impuesto\n              precio_unitario_sin_impuesto\n              unidad\n            }\n            inventario {\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n            }\n            granel\n          }\n          imagenes {\n            url_imagen\n            location_imagen\n            key_imagen\n            extencion_imagen\n          }\n          centro_de_costos {\n            cuenta\n            id_cuenta\n            id_subcuenta\n            subcuenta\n          }\n          precio_plazos {\n            precio_cajas {\n              plazo\n              unidad\n              precio\n            }\n            precio_costales {\n              plazo\n              unidad\n              precio\n            }\n            precio_piezas {\n              plazo\n              unidad\n              precio\n            }\n          }\n          empresa\n          sucursal\n          usuario\n          unidades_de_venta {\n            _id\n            precio\n            cantidad\n            unidad\n            unidad_principal\n            codigo_barras\n            id_producto\n            descuento {\n              cantidad_unidad\n              numero_precio\n              unidad_maxima\n              precio_general\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              porciento\n              dinero_descontado\n            }\n            descuento_activo\n            default\n            precio_unidad {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n          presentaciones {\n            _id\n            almacen\n            cantidad\n            cantidad_nueva\n            codigo_barras\n            color {\n              hex\n              nombre\n              _id\n            }\n            descuento {\n              cantidad_unidad\n              numero_precio\n              unidad_maxima\n              precio_general\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              porciento\n              dinero_descontado\n            }\n            descuento_activo\n            existencia\n            medida {\n              talla\n              tipo\n              _id\n            }\n            nombre_comercial\n            precio\n            precio_unidad {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n        }\n        id_producto\n        cantidad\n        cantidad_regalo\n        unidad_regalo\n        cantidad_total\n        iva_total\n        ieps_total\n        costo\n        descuento_porcentaje\n        descuento_precio\n        impuestos\n        mantener_precio\n        subtotal\n        total\n        subtotal_descuento\n        total_descuento\n      }\n      impuestos\n      subtotal\n      total\n      fecha_registro\n    }\n  }\n"]))),So=Object(P.d)(bo||(bo=Object(N.a)(["\n  query obtenerConsultaGeneralCompras($empresa: ID!, $sucursal: ID!) {\n    obtenerConsultaGeneralCompras(empresa: $empresa, sucursal: $sucursal) {\n      productos {\n        _id\n        datos_generales {\n          codigo_barras\n          clave_alterna\n          tipo_producto\n          nombre_comercial\n          nombre_generico\n          descripcion\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          ieps\n          ieps_activo\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n          }\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          precio_de_compra {\n            precio_con_impuesto\n            precio_sin_impuesto\n            iva\n            ieps\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            precio_venta\n            unidad_mayoreo\n            utilidad\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n          }\n          granel\n        }\n        imagenes {\n          url_imagen\n          location_imagen\n          key_imagen\n          extencion_imagen\n        }\n        centro_de_costos {\n          cuenta\n          id_cuenta\n          id_subcuenta\n          subcuenta\n        }\n        precio_plazos {\n          precio_cajas {\n            plazo\n            unidad\n            precio\n          }\n          precio_costales {\n            plazo\n            unidad\n            precio\n          }\n          precio_piezas {\n            plazo\n            unidad\n            precio\n          }\n        }\n        unidades_de_venta {\n          _id\n          precio\n          cantidad\n          concepto\n          unidad\n          unidad_principal\n          codigo_barras\n          id_producto\n          empresa\n          sucursal\n          descuento {\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n          descuento_activo\n          default\n        }\n        inventario_general {\n          _id\n          cantidad_existente\n          unidad_inventario\n          cantidad_existente_maxima\n          unidad_maxima\n        }\n        medidas_producto {\n          _id\n          cantidad\n          codigo_barras\n          color {\n            hex\n            nombre\n            _id\n          }\n          existencia\n          medida {\n            talla\n            tipo\n            _id\n          }\n          nombre_comercial\n          precio\n        }\n        medidas_registradas\n        empresa\n        sucursal\n        usuario\n      }\n      proveedores {\n        _id\n        numero_cliente\n        clave_cliente\n        representante\n        nombre_cliente\n        rfc\n        curp\n        telefono\n        celular\n        email\n        numero_descuento\n        limite_credito\n        dias_credito\n        razon_social\n        direccion {\n          calle\n          no_ext\n          no_int\n          codigo_postal\n          colonia\n          municipio\n          localidad\n          estado\n          pais\n        }\n        imagen\n        estado_cliente\n        tipo_cliente\n        banco\n        numero_cuenta\n        empresa {\n          _id\n        }\n        sucursal {\n          _id\n        }\n      }\n      almacenes {\n        _id\n        nombre_almacen\n        default_almacen\n        id_usuario_encargado {\n          _id\n          numero_usuario\n          nombre\n          email\n          imagen\n          estado_usuario\n        }\n        id_sucursal {\n          _id\n          nombre_sucursal\n          usuario_sucursal\n        }\n        direccion {\n          calle\n          no_ext\n          no_int\n          codigo_postal\n          colonia\n          municipio\n          localidad\n          estado\n          pais\n        }\n      }\n    }\n  }\n"]))),Fo=Object(P.d)(po||(po=Object(N.a)(["\n  mutation eliminarCompraEnEspera($id: ID!) {\n    eliminarCompraEnEspera(id: $id) {\n      message\n    }\n  }\n"]))),wo=a(913),Io={producto:{},costo:0,cantidad:0,cantidad_regalo:0,unidad_regalo:"",cantidad_total:0,descuento_porcentaje:0,descuento_precio:0,iva_total:0,ieps_total:0,subtotal:0,impuestos:0,total:0,mantener_precio:!0,impuestos_descuento:0,subtotal_descuento:0,total_descuento:0},ko={productos:[],proveedor:{},en_espera:!1,fecha_registro:ht()().locale("es-mx").format(),almacen:{},compra_credito:!1,fecha_vencimiento_credito:ht()().locale("es-mx").format(),credito_pagado:!1,saldo_credito_pendiente:0,forma_pago:"",descuento_aplicado:!1,descuento:{porcentaje:0,cantidad_descontada:0,precio_con_descuento:0},subtotal:0,impuestos:0,total:0},zo=[{numero_precio:1,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:2,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:3,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:4,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:5,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:6,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0}],No={precios:re},Po=[];function Do(e){var t=e.getProductos,a=(e.status,JSON.parse(localStorage.getItem("sesionCafi"))),n=Object(l.useContext)(qa),c=n.datosCompra,r=n.setDatosCompra,i=n.setDatosProducto,o=n.productosCompra,s=Object(l.useContext)(fe),d=s.setDatosGenerales,j=s.setPrecios,u=s.setValidacion,m=s.setPreciosP,O=s.setImagenes,x=s.setUnidadesVenta,h=s.almacen_inicial,f=s.setAlmacenInicial,g=s.setUnidadVentaXDefecto,v=s.setUnidadVentaSecundaria,C=s.setCentroDeCostos,y=s.setPreciosPlazos,S=s.setSubcategorias,w=s.setOnPreview,k=s.setSubcostos,z=s.setImagenesEliminadas,N=s.setPresentaciones,P=s.setPresentacionesEliminadas,D=Object(qe.a)(So,{variables:{sucursal:a.sucursal._id,empresa:a.empresa._id}}),E=D.loading,A=D.data,T=D.error,W=D.refetch,$=function(e,a){a?"proveedor"===e?r(Object(b.a)(Object(b.a)({},c),{},{proveedor:{id_proveedor:a._id,nombre_cliente:a.nombre_cliente,numero_cliente:a.numero_cliente,clave_cliente:a.clave_cliente}})):(i(Io),R(),r(Object(b.a)(Object(b.a)({},c),{},{almacen:{id_almacen:a._id,nombre_almacen:a.nombre_almacen,default_almacen:a.default_almacen}})),f(Object(b.a)(Object(b.a)({},h),{},{id_almacen:a._id,almacen:a.nombre_almacen,default_almacen:a.default_almacen})),t(a._id)):r(Object(b.a)(Object(b.a)({},c),{},Object(_.a)({},e,{})))},R=function(){d(ce),j(re),g(ie),v(oe),m(se),x([]),f(de),C({}),y(ue),S([]),O([]),w({index:"",image:""}),u({error:!1,message:""}),k([]),z([]),N([]),P([])},V=Object(B.jsx)($e.a,{item:!0,xs:12,md:4,children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(F.a,{size:"small",fullWidth:!0,value:"Error",error:!0,disabled:!0,variant:"outlined"}),Object(B.jsx)(X.a,{disabled:!0,children:Object(B.jsx)(wo.a,{fontSize:"default"})})]})}),M=Object(B.jsx)($e.a,{item:!0,xs:12,md:4,children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(F.a,{size:"small",fullWidth:!0,disabled:!0,value:"Cargando...",variant:"outlined"}),Object(B.jsx)(X.a,{disabled:!0,children:Object(B.jsx)(I.a,{size:24})})]})});if(E)return Object(B.jsxs)($e.a,{container:!0,spacing:2,alignItems:"center",children:[M,M,M]});if(T)return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)($e.a,{container:!0,spacing:2,alignItems:"center",children:[V,V,V]})});var L=A.obtenerConsultaGeneralCompras,U=L.almacenes,q=L.proveedores;return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)($e.a,{container:!0,spacing:2,alignItems:"center",children:[Object(B.jsx)($e.a,{item:!0,xs:12,md:4,children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(ja.a,{disabled:o.length>0,id:"combo-box-proveedor",size:"small",fullWidth:!0,options:q,getOptionLabel:function(e){return e.nombre_cliente},renderInput:function(e){return Object(B.jsx)(F.a,Object(b.a)(Object(b.a)({},e),{},{label:"Proveedor",variant:"outlined"}))},onChange:function(e,t){return $("proveedor",t)},getOptionSelected:function(e){return e.nombre_cliente},value:c.proveedor.nombre_cliente?c.proveedor:null}),Object(B.jsx)(fo,{accion:"registrar",tipo:"PROVEEDOR",refetch:W,fromCompras:!0})]})}),Object(B.jsx)($e.a,{item:!0,xs:12,md:4,children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(ja.a,{disabled:o.length>0,id:"combo-box-almacen",size:"small",fullWidth:!0,options:U,getOptionLabel:function(e){return e.nombre_almacen},renderInput:function(e){return Object(B.jsx)(F.a,Object(b.a)(Object(b.a)({},e),{},{label:"Almacen",variant:"outlined"}))},onChange:function(e,t){return $("almacen",t)},getOptionSelected:function(e){return e.nombre_almacen},value:c.almacen.nombre_almacen?c.almacen:null}),Object(B.jsx)(kr,{children:Object(B.jsx)(mi,{accion:"registrar",fromEmergent:!0,refetch:W})})]})}),Object(B.jsx)($e.a,{item:!0,xs:12,md:4,children:Object(B.jsx)(p.a,{display:"flex",alignItems:"center",children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",variant:"outlined",type:"date",onChange:function(e){r(Object(b.a)(Object(b.a)({},c),{},{fecha_registro:e.target.value}))},value:c.fecha_registro})})})]})})}function Eo(){var e=Object(l.useContext)(qa).datosProducto;return Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,children:[Object(B.jsx)(S.a,{style:{fontSize:16},children:"Subtotal:"}),Object(B.jsx)(S.a,{style:{fontSize:18},children:Object(B.jsxs)("b",{children:["$",Fa(e.subtotal_descuento)]})})]}),Object(B.jsxs)($e.a,{item:!0,children:[Object(B.jsx)(S.a,{style:{fontSize:16},children:"Impuestos:"}),Object(B.jsx)(S.a,{style:{fontSize:18},children:Object(B.jsxs)("b",{children:["$",Fa(e.impuestos_descuento)]})})]}),Object(B.jsxs)($e.a,{item:!0,children:[Object(B.jsx)(S.a,{style:{fontSize:16},children:"Descuento:"}),Object(B.jsx)(S.a,{style:{fontSize:18},children:Object(B.jsxs)("b",{children:[e.descuento_porcentaje,"%"]})})]}),Object(B.jsxs)($e.a,{item:!0,children:[Object(B.jsx)(S.a,{style:{fontSize:16},children:"Total:"}),Object(B.jsx)(S.a,{style:{fontSize:18},children:Object(B.jsxs)("b",{children:["$",Fa(e.total_descuento)]})})]})]})}var Ao=function(e){var t=e.productoOriginal,a=e.porcentaje,n=e.cantidad,c=e.costo,r=t.precios,i=r.iva,o=r.ieps,s=r.precio_de_compra,l=s.precio_sin_impuesto,d=s.precio_con_impuesto,j=s.iva,u=s.ieps,b=j+u,p=(c-b)*n,m=Math.round(p*a/100),O=p-m,x=parseFloat(O)*parseFloat(i<10?".0"+i:"."+i),h=parseFloat(O)*parseFloat(o<10?".0"+o:"."+o),_=x+h;return{result:{iva_precio:x,ieps_precio:h,impuestos:_,porcentaje:a,cantidad_descontada:m,subtotal_con_descuento:O,total:O+_},anterior:{impuesto_actual:b,precio_sin_impuesto:l,precio_con_impuesto:d,cantidad:n,iva_precio_actual:j,ieps_precio_actual:u}}},To=["precios_producto"];function Wo(e){var t=e.status,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(l.useContext)(qa),c=n.datosProducto,r=n.setDatosProducto,i=n.productosCompra,o=n.setProductosCompra,s=n.datosCompra,d=n.productoOriginal,j=n.setProductoOriginal,u=n.setPreciosVenta,m=n.setDatosCompra,O=n.isEditing,x=n.setIsEditing,h=n.editFinish,v=n.setEditFinish,y=n.costo,k=n.setCosto,z=n.cantidad,N=n.setCantidad,P=n.loadingProductos,D=n.setLoadingProductos,E=Object(l.useContext)(fe),A=E.datos_generales,T=E.setDatosGenerales,W=E.precios,$=E.setPrecios,R=E.setValidacion,V=E.preciosP,M=E.setPreciosP,L=E.imagenes,U=E.setImagenes,q=E.setUnidadesVenta,G=E.almacen_inicial,Y=E.setAlmacenInicial,K=E.unidadVentaXDefecto,Z=E.setUnidadVentaXDefecto,ee=E.unidadVentaSecundaria,te=E.setUnidadVentaSecundaria,ae=E.centro_de_costos,ne=E.setCentroDeCostos,se=E.preciosPlazos,le=E.setPreciosPlazos,be=E.setSubcategorias,pe=E.setOnPreview,me=E.setSubcostos,Oe=E.imagenes_eliminadas,xe=E.setImagenesEliminadas,he=E.presentaciones,_e=E.setPresentaciones,ge=E.presentaciones_eliminadas,Ce=E.setPresentacionesEliminadas,ye=E.setAlmacenExistente,Se=Object(l.useState)(!1),Fe=Object(g.a)(Se,2),we=Fe[0],Ie=Fe[1],ke=0;"enEspera"===t&&s&&(ke=1);var ze=Object(l.useState)(!1),Ne=Object(g.a)(ze,2),Pe=Ne[0],De=Ne[1],Ee=Object(Gi.a)(),Ae=Object(l.useState)(),Te=Object(g.a)(Ae,2),We=Te[0],Re=Te[1],Ve=Object(l.useState)({message:"",status:"",open:!1}),Me=Object(g.a)(Ve,2),Le=Me[0],Ue=Me[1],Be=function(){var e=Object(f.a)(C.a.mark((function e(t){var n,c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t||s.almacen._id,D(!0),e.next=5,Ee.query({query:Nn,variables:{almacen:n,empresa:a.empresa._id,sucursal:a.sucursal._id},fetchPolicy:"network-only"});case 5:c=e.sent,D(!1),Re(c.data),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),D(!1),Ue({message:"Hubo un error al cargar los productos",status:"error",open:!0});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),qe=Object(Da.useDebounce)(y,500),Je=Object(g.a)(qe,1)[0],Ge=Object(Da.useDebounce)(z,500),He=Object(g.a)(Ge,1)[0];if(Object(l.useEffect)((function(){We&&function(e){var t=Ao({productoOriginal:d,porcentaje:c.descuento_porcentaje,cantidad:c.cantidad,costo:parseFloat(e)}),a=t.result,n=t.anterior;if(!e)return void r(Object(b.a)(Object(b.a)({},c),{},{costo:0,impuestos_descuento:n.impuesto_actual*n.cantidad,subtotal_descuento:n.precio_sin_impuesto*n.cantidad,total_descuento:n.precio_con_impuesto*n.cantidad,iva_total:n.iva_precio_actual*n.cantidad,ieps_total:n.ieps_precio_actual*n.cantidad}));r(Object(b.a)(Object(b.a)({},c),{},{costo:parseFloat(e),iva_total:parseFloat(a.iva_precio.toFixed(2)),ieps_total:parseFloat(a.ieps_precio.toFixed(2)),impuestos_descuento:parseFloat(a.impuestos.toFixed(2)),descuento_porcentaje:a.porcentaje?parseFloat(a.porcentaje):0,descuento_precio:a.cantidad_descontada?parseFloat(a.cantidad_descontada.toFixed(2)):0,subtotal_descuento:parseFloat(a.subtotal_con_descuento.toFixed(2)),total_descuento:parseFloat(a.total.toFixed(2))}))}(Je)}),[Je]),Object(l.useEffect)((function(){We&&Qe(He)}),[He]),Object(l.useEffect)((function(){if(he.length>0){var e=0,t=0;he.forEach((function(a){var n=a.cantidad_nueva;e+=n||0,isNaN(e)&&(t=0),t=e})),t&&Qe(t)}}),[he]),Object(l.useEffect)((function(){1===ke&&Be(s.almacen._id)}),[ke]),P)return Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"20vh",children:[Object(B.jsx)(I.a,{}),Object(B.jsx)(S.a,{variant:"h5",children:"Cargando"})]});var Ye=[];We&&(Ye=We.obtenerProductos);var Ke=function(e){if(!e)return r(Io),k(0),N(0),void tt();var t=e.precios.precio_de_compra,a=t.ieps,n=t.iva,i=t.precio_con_impuesto,o=t.precio_sin_impuesto,s=n+a;r(Object(b.a)(Object(b.a)({},c),{},{producto:e,id_producto:e._id,costo:i,cantidad:"OTROS"===e.datos_generales.tipo_producto?1:0,unidad_regalo:e.precios.unidad_de_compra.unidad,descuento_porcentaje:0,descuento_precio:0,subtotal:o,impuestos:parseFloat(s.toFixed(6)),total:i,subtotal_descuento:o,total_descuento:i})),et(e),k(i),N("OTROS"===e.datos_generales.tipo_producto?1:0),j(e),u(e.precios.precios_producto)};function Qe(e){var t=Ao({productoOriginal:d,porcentaje:c.descuento_porcentaje,cantidad:e,costo:c.costo}),a=t.result,n=t.anterior;r(e?Object(b.a)(Object(b.a)({},c),{},{cantidad:parseFloat(e),iva_total:parseFloat(a.iva_precio.toFixed(2)),ieps_total:parseFloat(a.ieps_precio.toFixed(2)),impuestos_descuento:parseFloat(a.impuestos.toFixed(2)),descuento_porcentaje:a.porcentaje?parseFloat(a.porcentaje):0,descuento_precio:a.cantidad_descontada?parseFloat(a.cantidad_descontada.toFixed(2)):0,subtotal_descuento:parseFloat(a.subtotal_con_descuento.toFixed(2)),total_descuento:parseFloat(a.total.toFixed(2))}):Object(b.a)(Object(b.a)({},c),{},{cantidad:"",impuestos_descuento:n.impuesto_actual*n.cantidad,subtotal_descuento:n.precio_sin_impuesto*n.cantidad,total_descuento:n.precio_con_impuesto*n.cantidad,iva_total:n.iva_precio_actual*n.cantidad,ieps_total:n.ieps_precio_actual*n.cantidad}))}var Xe=function(e){var t=e.target,a=t.value,n=t.name;r(Object(b.a)(Object(b.a)({},c),{},Object(_.a)({},n,a)))};var Ze=function(){var e=Object(f.a)(C.a.mark((function e(t){var n,l,d,u,p,_,f,g,y,S,F,w,I,z,P,D,E,T,$,R,M,U,B,q,J,H,Y,Q,X,Z,te,ne,ce,ie;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(b.a)({},s),l=Object(b.a)({},c),d=Object(b.a)({},A),u=Object(da.a)(he),p=Object(b.a)({},W),_=Object(da.a)(V),f=Object(b.a)({},G),g=Object(b.a)({},ae),y=Object(da.a)(ge),S=Object(b.a)({},se),De(!0),l.producto.datos_generales&&n.proveedor.nombre_cliente&&n.almacen.nombre_almacen){e.next=14;break}return De(!1),e.abrupt("return");case 14:if("OTROS"===d.tipo_producto){e.next=26;break}if(!(u.length>0)){e.next=23;break}if(u.filter((function(e){return e.color._id&&e.medida._id&&e.existencia})).length===u.length){e.next=21;break}return Ie(!0),De(!1),e.abrupt("return");case 21:e.next=26;break;case 23:return Ie(!0),De(!1),e.abrupt("return");case 26:return F=[Object(b.a)({},K),Object(b.a)({},ee)],l.mantener_precio=!t,p.precios_producto=_,e.next=31,$i(d,"datos_generales");case 31:return e.t0=e.sent,e.t1=p,e.t2=L,e.t3=Oe,e.t4=f,e.t5=g,e.next=39,$i(F,"unidades_de_venta");case 39:e.t6=e.sent,e.t7=u,e.t8=y,e.t9=S,e.t10=a.empresa._id,e.t11=a.sucursal._id,e.t12=a._id,w={datos_generales:e.t0,precios:e.t1,imagenes:e.t2,imagenes_eliminadas:e.t3,almacen_inicial:e.t4,centro_de_costos:e.t5,unidades_de_venta:e.t6,presentaciones:e.t7,presentaciones_eliminadas:e.t8,precio_plazos:e.t9,empresa:e.t10,sucursal:e.t11,usuario:e.t12},l.producto=w,"OTROS"!==l.producto.datos_generales.tipo_producto?l.cantidad_total=l.cantidad:(I=l.cantidad_regalo,z=l.cantidad,P=l.unidad_regalo,D=l.producto.precios.unidad_de_compra.cantidad,T=z*D+(E="Pz"===P||"Kg"===P||"Lt"===P?I:I*D),D>1?(l.cantidad_regalo=E/D,l.cantidad_total=T/D):(l.cantidad_regalo=E,l.cantidad_total=T)),l.impuestos=l.impuestos_descuento,l.subtotal=l.subtotal_descuento,l.total=l.total_descuento,O.producto?($=Object(da.a)(i),n.impuestos-=O.producto.impuestos,n.subtotal-=O.producto.subtotal,n.total-=O.producto.total,R=parseFloat((n.subtotal+=l.subtotal).toFixed(2)),M=parseFloat((n.impuestos+=l.impuestos).toFixed(2)),U=parseFloat((n.total+=l.total).toFixed(2)),$.splice(O.index,1,l),o($),m(Object(b.a)(Object(b.a)({},n),{},{subtotal:R,impuestos:M,total:U})),x({}),v(!h),j({precios:re}),r(Io),k(0),N(0),De(!1)):(B=i.map((function(e,t){return e.id_producto===l.id_producto?{prod_exist:e,index:t}:""})).filter(Boolean),B.length>0?(q=Object(da.a)(i),J=B[0],H=J.index,Y=J.prod_exist,n.subtotal-=Y.subtotal,n.impuestos-=Y.impuestos,n.total-=Y.total,Q=parseFloat((n.subtotal+=l.subtotal).toFixed(2)),X=parseFloat((n.impuestos+=l.impuestos).toFixed(2)),Z=parseFloat((n.total+=l.total).toFixed(2)),q.splice(H,1,l),o(q),m(Object(b.a)(Object(b.a)({},n),{},{subtotal:Q,impuestos:X,total:Z}))):(te=Object(da.a)(i),ne=parseFloat((n.subtotal+=l.subtotal).toFixed(2)),ce=parseFloat((n.impuestos+=l.impuestos).toFixed(2)),ie=parseFloat((n.total+=l.total).toFixed(2)),te.splice(0,0,l),o(te),m(Object(b.a)(Object(b.a)({},n),{},{subtotal:ne,impuestos:ce,total:ie}))),j({precios:re}),r(Io),k(0),N(0),De(!1));case 53:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),et=function(e){var t=e.precios,a=(t.precios_producto,Object(ve.a)(t,To)),n=e.unidades_de_venta,c=n.filter((function(e){return!1===e.default})),r=n.filter((function(e){return!0===e.default}));T(e.datos_generales),$(a),ne(e.centro_de_costos?e.centro_de_costos:je),U(e.imagenes),le(e.precio_plazos),q(n),M(e.precios.precios_producto),Z(r[0]),te(c[0]),_e(e.medidas_producto?e.medidas_producto:[]),s.almacen.id_almacen&&0===e.medidas_producto.length&&Y(Object(b.a)(Object(b.a)({},G),{},{id_almacen:s.almacen.id_almacen,almacen:s.almacen.nombre_almacen})),e.inventario_general.length>0?ye(!0):ye(!1)},tt=function(){T(ce),$(re),Z(ie),te(oe),M(Mi),q([]),Y(de),ne({}),le(ue),be([]),U([]),pe({index:"",image:""}),R({error:!1,message:""}),me([]),xe([]),_e([]),Ce([])};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(J,{alert:Le,setAlert:Ue}),Object(B.jsx)(Do,{status:t,getProductos:Be}),Object(B.jsx)(p.a,{my:1}),Object(B.jsxs)($e.a,{container:!0,spacing:1,alignItems:"center",children:[Object(B.jsxs)($e.a,{item:!0,children:[Object(B.jsx)(S.a,{children:"C\xf3digo de barras"}),Object(B.jsx)(p.a,{width:200,children:Object(B.jsx)(ja.a,{id:"combo-box-producto-codigo",size:"small",fullWidth:!0,options:Ye,getOptionLabel:function(e){return e.datos_generales.codigo_barras?e.datos_generales.codigo_barras:"N/A"},renderInput:function(e){return Object(B.jsx)(F.a,Object(b.a)(Object(b.a)({},e),{},{variant:"outlined"}))},onChange:function(e,t){return Ke(t)},getOptionSelected:function(e,t){return e._id===t._id},value:c.producto.datos_generales?c.producto:null,disabled:!s.almacen.id_almacen||!s.proveedor.id_proveedor})})]}),Object(B.jsxs)($e.a,{item:!0,children:[Object(B.jsx)(S.a,{children:"Producto"}),Object(B.jsxs)(p.a,{display:"flex",width:250,alignItems:"center",children:[Object(B.jsx)(ja.a,{id:"combo-box-producto-nombre",size:"small",fullWidth:!0,options:Ye,getOptionLabel:function(e){return e.datos_generales.nombre_comercial},renderInput:function(e){return Object(B.jsx)(F.a,Object(b.a)(Object(b.a)({},e),{},{variant:"outlined"}))},onChange:function(e,t){return Ke(t)},getOptionSelected:function(e,t){return e._id===t._id},value:c.producto.datos_generales?c.producto:null,disabled:!s.almacen.id_almacen||!s.proveedor.id_proveedor}),s.almacen.id_almacen&&s.proveedor.id_proveedor?Object(B.jsx)(qi,{accion:!1,getProductos:Be,fromCompra:!0}):Object(B.jsx)(X.a,{disabled:!0,children:Object(B.jsx)(ac.a,{})})]})]}),Object(B.jsxs)($e.a,{item:!0,children:[Object(B.jsx)(S.a,{children:"Clave"}),Object(B.jsx)(p.a,{width:140,children:Object(B.jsx)(ja.a,{id:"combo-box-producto-clave",size:"small",fullWidth:!0,options:Ye,getOptionLabel:function(e){return e.datos_generales.clave_alterna},renderInput:function(e){return Object(B.jsx)(F.a,Object(b.a)(Object(b.a)({},e),{},{variant:"outlined"}))},onChange:function(e,t){return Ke(t)},getOptionSelected:function(e,t){return e._id===t._id},value:c.producto.datos_generales?c.producto:null,disabled:!s.almacen.id_almacen||!s.proveedor.id_proveedor})})]}),Object(B.jsxs)($e.a,{item:!0,children:[Object(B.jsx)(S.a,{children:"Costo"}),Object(B.jsx)(p.a,{width:100,children:Object(B.jsx)(F.a,{inputMode:"decimal",name:"costo",variant:"outlined",size:"small",fullWidth:!0,disabled:!c.producto.datos_generales,value:y,onChange:function(e){return k(e.target.value)},InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})}})})]}),c.producto.datos_generales&&"OTROS"===c.producto.datos_generales.tipo_producto?Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)($e.a,{item:!0,children:[Object(B.jsx)(S.a,{children:"Unidad"}),Object(B.jsx)(p.a,{width:100,children:Object(B.jsx)(F.a,{variant:"outlined",size:"small",fullWidth:!0,"aria-readonly":"true",value:c.producto.precios.unidad_de_compra.unidad,disabled:!0})})]}),Object(B.jsxs)($e.a,{item:!0,children:[Object(B.jsx)(S.a,{children:"Cantidad"}),Object(B.jsx)(p.a,{width:100,children:Object(B.jsx)(F.a,{name:"cantidad",variant:"outlined",size:"small",fullWidth:!0,type:"number",InputProps:{inputProps:{min:1}},disabled:!c.producto.datos_generales,value:z,onChange:function(e){return N(e.target.value)}})})]}),Object(B.jsxs)($e.a,{item:!0,children:[Object(B.jsx)(S.a,{children:"Cant. regalo"}),Object(B.jsx)(p.a,{width:100,children:Object(B.jsx)(F.a,{name:"cantidad_regalo",variant:"outlined",size:"small",fullWidth:!0,inputMode:"numeric",disabled:!c.producto.datos_generales,value:c.cantidad_regalo,onChange:function(e){return t=e.target.value,void r(t?Object(b.a)(Object(b.a)({},c),{},{cantidad_regalo:parseFloat(t)}):Object(b.a)(Object(b.a)({},c),{},{cantidad_regalo:""}));var t}})})]}),Object(B.jsxs)($e.a,{item:!0,children:[Object(B.jsx)(S.a,{children:"Unidad. regalo"}),Object(B.jsx)(p.a,{width:100,children:Object(B.jsx)(H.a,{variant:"outlined",size:"small",name:"unidad_regalo",fullWidth:!0,children:c.producto.precios.granel?Object(B.jsxs)(mt.a,{id:"select-unidad-regalo",disabled:!c.producto.datos_generales,name:"unidad_regalo",value:c.unidad_regalo,onChange:Xe,children:[Object(B.jsx)(Ot.a,{value:"Kg",children:"Kg"}),Object(B.jsx)(Ot.a,{value:"Costal",children:"Costal"}),Object(B.jsx)(Ot.a,{value:"Lt",children:"Lt"})]}):Object(B.jsxs)(mt.a,{id:"select-unidad-regalo",disabled:!c.producto.datos_generales,name:"unidad_regalo",value:c.unidad_regalo,onChange:Xe,children:[Object(B.jsx)(Ot.a,{value:"Caja",children:"Caja"}),Object(B.jsx)(Ot.a,{value:"Pz",children:"Pz"})]})})})]})]}):Object(B.jsxs)($e.a,{item:!0,children:[Object(B.jsx)(S.a,{children:"Cantidad total"}),Object(B.jsx)(p.a,{width:110,children:Object(B.jsx)(F.a,{name:"cantidad",variant:"outlined",size:"small",fullWidth:!0,type:"number",disabled:!0,value:c.cantidad})})]}),Object(B.jsxs)($e.a,{item:!0,children:[Object(B.jsx)(S.a,{children:"Descuento"}),Object(B.jsx)(Qi,{})]})]}),Object(B.jsx)(p.a,{mt:1,children:Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)($e.a,{item:!0,xs:12,md:7,padding:"checkbox",children:Object(B.jsx)(Hi,{})}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:5,style:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(Eo,{})}),Object(B.jsxs)(p.a,{display:"flex",children:[c.producto.datos_generales&&"OTROS"!==c.producto.datos_generales.tipo_producto?Object(B.jsx)(ec,{verificate:we,setVerificate:Ie}):null,Object(B.jsx)(p.a,{mx:1}),c.costo!==d.precios.precio_de_compra.precio_con_impuesto?Object(B.jsx)(Ro,{agregarCompra:Ze,cargando:Pe}):Object(B.jsx)(w.a,{style:P?{pointerEvents:"none",opacity:.4}:null,variant:"contained",color:"primary",startIcon:Pe?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(ac.a,{}),disableElevation:!0,disabled:!c.producto.datos_generales||("OTROS"===c.producto.datos_generales.tipo_producto?!(s.proveedor.nombre_cliente&&s.almacen.nombre_almacen&&c.costo&&c.cantidad):!(s.proveedor.nombre_cliente&&s.almacen.nombre_almacen&&c.costo)),onClick:function(){return Ze()},children:O.producto?"Actualizar ":"Agregar a compra"})]})]})]})})]})}var $o=Object(l.forwardRef)((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),Ro=function(e){var t=e.agregarCompra,a=e.cargando,n=Object(l.useState)(!1),c=Object(g.a)(n,2),r=c[0],i=c[1],o=Object(l.useContext)(qa),s=o.datosProducto,d=o.datosCompra,j=o.isEditing,u=o.loadingProductos,b=function(){i(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{style:u?{pointerEvents:"none",opacity:.4}:null,variant:"contained",color:"primary",startIcon:Object(B.jsx)(ac.a,{}),disableElevation:!0,disabled:!s.producto.datos_generales||("OTROS"===s.producto.datos_generales.tipo_producto?!(d.proveedor.nombre_cliente&&d.almacen.nombre_almacen&&s.costo&&s.cantidad):!(d.proveedor.nombre_cliente&&d.almacen.nombre_almacen&&s.costo)),onClick:function(){i(!0)},children:j.producto?"Actualizar ":"Agregar a compra"}),Object(B.jsxs)(Ee.a,{open:r,TransitionComponent:$o,keepMounted:!0,onClose:function(){return b()},"aria-labelledby":"modal-agregar-compra",children:[Object(B.jsx)(wt.a,{id:"modal-agregar-compra",style:{padding:0},children:Object(B.jsxs)(St.a,{severity:"info",icon:Object(B.jsx)(Ki.a,{style:{fontSize:30}}),style:{padding:16},children:[Object(B.jsx)(Ft.a,{style:{fontSize:20},children:"El costo es diferente al precio de compra actual"}),Object(B.jsx)(S.a,{style:{fontSize:18},children:"\xbfDesea actualizar los precios o mantenerlos?"})]})}),Object(B.jsxs)(Ue.a,{style:{display:"flex",justifyContent:"center"},children:[Object(B.jsx)(w.a,{onClick:function(){return b()},color:"default",children:"Cancelar"}),Object(B.jsx)(w.a,{onClick:function(){t(),b()},color:"primary",children:"Mantener"}),Object(B.jsx)(fn,{cargando:a,handleClose:b,agregarCompra:t})]})]})]})},Vo=a(466),Mo=a.n(Vo),Lo=a(915),Uo=["precios_producto"],Bo=function(e,t,a){var n=t.setDatosGenerales,c=t.setPrecios,r=t.setValidacion,i=t.setPreciosP,o=t.setImagenes,s=t.setUnidadesVenta,l=t.almacen_inicial,d=t.setAlmacenInicial,j=t.setUnidadVentaXDefecto,u=t.setUnidadVentaSecundaria,p=t.setCentroDeCostos,m=t.setPreciosPlazos,O=t.setSubcategorias,x=t.setOnPreview,h=t.setSubcostos,_=t.setImagenesEliminadas,f=t.setPresentaciones,g=t.setPresentacionesEliminadas,v=t.datosCompra;if("SET"===e){var C=a.precios,y=(C.precios_producto,Object(ve.a)(C,Uo)),S=a.unidades_de_venta,F=S.filter((function(e){return!1===e.default})),w=S.filter((function(e){return!0===e.default}));n(a.datos_generales),c(y),p(a.centro_de_costos?a.centro_de_costos:je),o(a.imagenes),m(a.precio_plazos),s(S),i(a.precios.precios_producto),j(w[0]),u(F[0]),f(a.presentaciones?a.presentaciones:[]),v.almacen.id_almacen&&0===a.presentaciones.length&&d(Object(b.a)(Object(b.a)({},l),{},{id_almacen:v.almacen.id_almacen,almacen:v.almacen.nombre_almacen}))}else n(ce),c(re),j(ie),u(oe),i(Mi),s([]),d(de),p({}),m(ue),O([]),o([]),x({index:"",image:""}),r({error:!1,message:""}),h([]),_([]),f([]),g([])},qo=Object(k.a)({root:{width:"100%"},container:{height:"40vh"}});function Jo(){var e=qo(),t=Object(l.useContext)(qa),a=t.productosCompra,n=t.loadingProductos,c=t.datosCompra,r=Object(da.a)(a);return Object(B.jsxs)(Ka.a,{className:e.root,variant:"outlined",children:[Object(B.jsx)(ba.a,{className:e.container,style:n?{pointerEvents:"none",opacity:.4}:null,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"C\xf3digo de barras"}),Object(B.jsx)(Oa.a,{children:"Producto"}),Object(B.jsx)(Oa.a,{children:"Precio de compra"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Cantidad"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Cantidad regalo"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Cantidad total"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Presentaciones"}),Object(B.jsx)(Oa.a,{children:"IVA Total"}),Object(B.jsx)(Oa.a,{children:"IEPS Total"}),Object(B.jsx)(Oa.a,{children:"Editar"}),Object(B.jsx)(Oa.a,{children:"Remover"})]})}),Object(B.jsx)(xa.a,{children:r.map((function(e,t){return Object(B.jsx)(Go,{producto:e,index:t},t)}))})]})}),Object(B.jsxs)($e.a,{container:!0,spacing:2,justifyContent:"flex-end",children:[Object(B.jsx)($e.a,{item:!0,children:Object(B.jsxs)(S.a,{style:{fontSize:18},children:["Subtotal:"," ",Object(B.jsxs)("b",{children:["$",c.subtotal?Fa(c.subtotal):0]})]})}),Object(B.jsx)($e.a,{item:!0,children:Object(B.jsxs)(S.a,{style:{fontSize:18},children:["Impuestos:"," ",Object(B.jsxs)("b",{children:["$",c.impuestos?Fa(c.impuestos):0]})]})}),Object(B.jsx)($e.a,{item:!0,children:Object(B.jsx)(S.a,{style:{fontSize:18},children:Object(B.jsxs)("b",{children:["Total: $",c.total?Fa(c.total):0]})})})]})]})}var Go=function(e){var t=e.producto,a=e.index,n=Object(l.useContext)(qa),c=n.datosCompra,r=n.setDatosProducto,i=n.setProductoOriginal,o=n.setPreciosVenta,s=n.isEditing,d=n.setIsEditing,j=n.editFinish,u=n.setCosto,b=n.setCantidad,p=n.setIssue,m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1],_=Object(l.useContext)(fe),f={setDatosGenerales:_.setDatosGenerales,setPrecios:_.setPrecios,setValidacion:_.setValidacion,setPreciosP:_.setPreciosP,setImagenes:_.setImagenes,setUnidadesVenta:_.setUnidadesVenta,almacen_inicial:_.almacen_inicial,setAlmacenInicial:_.setAlmacenInicial,setUnidadVentaXDefecto:_.setUnidadVentaXDefecto,setUnidadVentaSecundaria:_.setUnidadVentaSecundaria,setCentroDeCostos:_.setCentroDeCostos,setPreciosPlazos:_.setPreciosPlazos,setSubcategorias:_.setSubcategorias,setOnPreview:_.setOnPreview,setSubcostos:_.setSubcostos,setImagenesEliminadas:_.setImagenesEliminadas,setPresentaciones:_.setPresentaciones,setPresentacionesEliminadas:_.setPresentacionesEliminadas,datosCompra:c};Object(l.useEffect)((function(){h(!1)}),[j]),Object(l.useEffect)((function(){t.cantidad&&p(!1)}),[t.cantidad]);var v=t.producto.precios.unidad_de_compra.unidad,C=t.cantidad,y=t.cantidad_regalo,S=t.cantidad_total;return Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:x||!C,style:s.producto&&!x?{pointerEvents:"none",opacity:.4}:null,children:[Object(B.jsx)(Oa.a,{children:t.producto.datos_generales&&t.producto.datos_generales.codigo_barras?t.producto.datos_generales.codigo_barras:"-"}),Object(B.jsx)(Oa.a,{children:t.producto.datos_generales.nombre_comercial}),Object(B.jsx)(Oa.a,{width:180,children:C?Object(B.jsxs)("b",{children:["$ ",Fa(t.total)]}):Object(B.jsx)(Lo.a,{color:"error"})}),Object(B.jsxs)(Oa.a,{children:[C,Object(B.jsxs)("b",{children:["(",v,")"]})]}),Object(B.jsxs)(Oa.a,{children:[y,Object(B.jsxs)("b",{children:["(",v,")"]})]}),Object(B.jsxs)(Oa.a,{children:[S,Object(B.jsxs)("b",{children:["(",v,")"]})]}),Object(B.jsx)(Oa.a,{children:t.producto.presentaciones.length>0?t.producto.presentaciones.length:"N/A"}),Object(B.jsx)(Oa.a,{width:140,children:"".concat(t.producto.precios.iva,"% - $").concat(t.iva_total?Fa(t.iva_total):0)}),Object(B.jsx)(Oa.a,{width:140,children:"".concat(t.producto.precios.ieps,"% - $").concat(t.ieps_total?Fa(t.ieps_total):0)}),Object(B.jsx)(Oa.a,{width:50,children:x?Object(B.jsx)(X.a,{color:"inherit",size:"small",onClick:function(){return h(!1),d({}),r(Io),Bo("RESET",f),u(0),void b(1)},children:Object(B.jsx)(Pt.a,{})}):Object(B.jsx)(X.a,{color:"primary",size:"small",onClick:function(){return h(!0),d({producto:t,index:a,finish:!1}),r(t),Bo("SET",f,t.producto),i(t.producto),o(t.producto.precios.precios_producto),u(t.costo),void b(t.cantidad)},children:Object(B.jsx)(en.a,{})})}),Object(B.jsx)(Oa.a,{width:50,children:Object(B.jsx)(Yo,{index:a,isSelected:x})})]})},Ho=Object(l.forwardRef)((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),Yo=function(e){var t=e.index,a=e.isSelected,n=Object(l.useContext)(qa),c=n.productosCompra,r=n.setProductosCompra,i=n.datosCompra,o=n.setDatosCompra,s=Object(l.useState)(!1),d=Object(g.a)(s,2),j=d[0],u=d[1],p=function(){u(!1)};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(X.a,{color:"secondary",size:"small",onClick:function(){u(!0)},disabled:a,children:Object(B.jsx)(Mo.a,{})}),Object(B.jsxs)(Ee.a,{open:j,TransitionComponent:Ho,keepMounted:!0,onClose:p,"aria-labelledby":"modal-eliminar-compra",children:[Object(B.jsx)(wt.a,{id:"modal-eliminar-compra",children:"Seguro que quiere eliminar esto de la lista?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:p,color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{onClick:function(){var e=Object(da.a)(c),a=e.splice(t,1);o(Object(b.a)(Object(b.a)({},i),{},{subtotal:i.subtotal-a[0].subtotal,impuestos:i.impuestos-a[0].impuestos,total:i.total-a[0].total})),r(Object(da.a)(e)),p()},color:"secondary",children:"Aceptar"})]})]})]})},Ko=a(916),Qo=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Xo(e){var t=e.realizarCompraBD,a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(!1),u=Object(g.a)(j,2),m=u[0],O=u[1],x=Object(l.useState)([]),h=Object(g.a)(x,2),_=h[0],f=h[1],v=Object(l.useContext)(qa),C=v.productosCompra,y=v.datosCompra,k=v.setDatosCompra,z=v.issue,N={subtotal:0,impuestos:0,total:0,descuento_aplicado:!1,porcentaje:0,cantidad_descontada:0,precio_con_descuento:0},P=Object(l.useState)(N),D=Object(g.a)(P,2),E=D[0],A=D[1],T=function(){return r(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{autoFocus:!0,color:"primary",variant:"contained",size:"large",onClick:function(){return r(!0)},disabled:!C.length||z,startIcon:Object(B.jsx)(Dt.a,{}),children:"Guardar"}),Object(B.jsxs)(Ee.a,{open:c,TransitionComponent:Qo,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&T()},"aria-labelledby":"dialog-confirmacion-compra","aria-describedby":"dialog-confirmacion-compra-description",fullWidth:!0,maxWidth:"xs",children:[Object(B.jsx)(wt.a,{style:{padding:0},children:Object(B.jsx)(p.a,{m:1,display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){return T()},size:"small",disabled:s,children:Object(B.jsx)(Pt.a,{style:{fontSize:30}})})})}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(p.a,{my:2,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:12,children:[Object(B.jsx)(Ve.a,{control:Object(B.jsx)(Me.a,{checked:m,onChange:function(e){return O(e.target.checked)}}),label:"Compra a cr\xe9dito"}),Object(B.jsx)(S.a,{children:"Fecha de vencimiento del cr\xe9dito"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",variant:"outlined",type:"date",onChange:function(e){k(Object(b.a)(Object(b.a)({},y),{},{fecha_vencimiento_credito:e.target.value}))},disabled:!m,value:y.fecha_vencimiento_credito})]}),Object(B.jsx)($e.a,{item:!0,md:12,children:Object(B.jsxs)(H.a,{variant:"outlined",fullWidth:!0,size:"small",name:"forma_pago",children:[Object(B.jsx)(Y.a,{id:"forma_pago",children:"Forma de pago"}),Object(B.jsx)(mt.a,{labelId:"forma_pago",value:y.forma_pago,name:"forma_pago",onChange:function(e){return t=e.target.value,void k(Object(b.a)(Object(b.a)({},y),{},{forma_pago:t}));var t},label:"Forma de pago",children:vt.map((function(e,t){return Object(B.jsx)(Ot.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))})]})}),Object(B.jsx)($e.a,{item:!0,md:12,children:Object(B.jsx)(Ve.a,{control:Object(B.jsx)(Me.a,{checked:E.descuento_aplicado,onChange:function(e){return t=e.target.checked,void A(t?Object(b.a)(Object(b.a)({},E),{},{descuento_aplicado:t}):Object(b.a)(Object(b.a)({},E),{},{subtotal:y.subtotal,total:y.total,descuento_aplicado:t,porcentaje:0,cantidad_descontada:0,precio_con_descuento:0}));var t},name:"descuento_aplicado"}),label:"Aplicar descuento"})}),Object(B.jsx)($e.a,{item:!0,md:4,children:Object(B.jsx)(F.a,{variant:"outlined",size:"small",fullWidth:!0,onChange:function(e){return function(e){if(e&&0!==parseFloat(e)){var t=parseFloat(e),a=Math.round(t/y.subtotal*100);A(Object(b.a)(Object(b.a)({},E),{},{porcentaje:a,cantidad_descontada:t}))}else A(Object(b.a)(Object(b.a)({},E),{},{porcentaje:0,cantidad_descontada:0}))}(e.target.value)},disabled:!E.descuento_aplicado,value:E.cantidad_descontada,InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})}})}),Object(B.jsx)($e.a,{item:!0,md:4,children:Object(B.jsx)(F.a,{variant:"outlined",type:"number",size:"small",fullWidth:!0,onChange:function(e){return function(e){if(e&&0!==parseFloat(e)){var t=parseFloat(e),a=Math.round(y.subtotal*t/100);A(Object(b.a)(Object(b.a)({},E),{},{porcentaje:t,cantidad_descontada:a}))}else A(Object(b.a)(Object(b.a)({},E),{},{porcentaje:0,cantidad_descontada:0}))}(e.target.value)},disabled:!E.descuento_aplicado,value:E.porcentaje,InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"%"})}})}),Object(B.jsx)($e.a,{item:!0,md:4,children:Object(B.jsx)(w.a,{variant:"contained",color:"primary",onClick:function(){return function(){for(var e=Object(da.a)(C),t=Object(b.a)({},N),a=E.porcentaje,n=E.cantidad_descontada,c=E.descuento_aplicado,r=[],i=0;i<e.length;i++){var o=e[i],s=Object(b.a)({},o),l=s.producto.precios,d=l.iva,j=l.ieps,u=s.subtotal,p=Math.round(u*a/100),m=u-p,O=parseFloat(m)*parseFloat(d<10?".0"+d:"."+d),x=parseFloat(m)*parseFloat(j<10?".0"+j:"."+j),h=O+x,_=m+h;s.iva_total=O,s.ieps_total=x,s.descuento_porcentaje=a,s.descuento_precio=p,s.impuestos=h,s.subtotal=m,s.total=_,t.impuestos+=h,t.subtotal+=m,t.total+=_,r.push(s)}f(r),t.porcentaje=a,t.cantidad_descontada=n,t.descuento_aplicado=c,A(t)}()},children:"Recalcular"})}),Object(B.jsx)($e.a,{item:!0,md:4,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Subtotal:"})," $"+Fa(E.subtotal?E.subtotal:y.subtotal)]})}),Object(B.jsx)($e.a,{item:!0,md:4,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Impuestos:"})," $"+Fa(E.impuestos?E.impuestos:y.impuestos)]})}),Object(B.jsx)($e.a,{item:!0,md:4,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Total:"})," $"+Fa(E.total?E.total:y.total)]})})]})})}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{onClick:function(){O(!1),f([]),A(N),t(!1,m,T,d,E,_)},variant:"contained",color:"primary",startIcon:s?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(Dt.a,{}),disabled:s||!y.forma_pago,children:"Guardar"})})]})]})}var Zo=["descuento_aplicado","subtotal","total","impuestos"],es=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100}}})),ts=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function as(e){var t=e.compra,a=e.status,n=e.handleOpenDetalles,c=e.refetchEspera,r=es(),i=d.a.useState(!1),o=Object(g.a)(i,2),s=o[0],l=o[1],j=function(){l(!0)};return Object(B.jsxs)("div",{children:["enEspera"===a?Object(B.jsx)(w.a,{fullWidth:!0,onClick:j,color:"primary",variant:"contained",size:"large",startIcon:Object(B.jsx)(Dt.a,{}),children:"continuar compra"}):Object(B.jsx)(w.a,{fullWidth:!0,onClick:j,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Fe.m,{className:r.icon})}),"Abrir una compra"]})}),Object(B.jsx)(Ja,{children:Object(B.jsx)(ns,{open:s,handleClose:function(){l(!1),"enEspera"===a&&(n(),c())},status:a,compra:t})})]})}var ns=function(e){var t=e.open,a=e.handleClose,n=e.compra,c=e.status,r=es(),i=Object(l.useContext)(qa),o=i.productosCompra,s=i.datosCompra,d=i.setDatosProducto,j=i.setProductosCompra,u=i.setDatosCompra,m=i.setProductoOriginal,O=i.setPreciosVenta,x=Object(l.useState)(!1),h=Object(g.a)(x,2),_=h[0],v=h[1],y=JSON.parse(localStorage.getItem("sesionCafi")),F=Object(l.useState)({message:"",status:"",open:!1}),I=Object(g.a)(F,2),k=I[0],N=I[1],P=Object(l.useState)(!1),D=Object(g.a)(P,2),E=D[0],A=D[1],T=Object(z.a)(go),W=Object(g.a)(T,1)[0],$=Object(z.a)(vo),R=Object(g.a)($,1)[0],V=function(){d(Io),j(Po),u(ko),m(No),O(zo)};Object(l.useEffect)((function(){"enEspera"===c&&n&&!0===t&&(u(n),j(n.productos))}),[t]);var M=function(){var e=Object(f.a)(C.a.mark((function e(t,a,n,r,i,l){var d,j,u,p,m,O;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=Object(b.a)({},s),j=Object(da.a)(o),u=j,"enEspera"===c&&(u=j.map((function(e){return delete e.conflicto,e})),delete d.empresa,delete d.sucursal,delete d.usuario),A(!0),a&&r(!0),e.prev=6,d.productos=u,!t){e.next=16;break}return d.en_espera=!0,e.next=12,R({variables:{input:d,empresa:y.empresa._id,sucursal:y.sucursal._id,usuario:y._id}});case 12:p=e.sent,N({message:"\xa1Listo! ".concat(p.data.crearCompraEnEspera.message),status:"success",open:!0}),e.next=22;break;case 16:return a&&(d.compra_credito=!0,d.saldo_credito_pendiente=d.total),i.descuento_aplicado&&(i.descuento_aplicado,i.subtotal,i.total,i.impuestos,m=Object(ve.a)(i,Zo),d.productos=l,d.descuento_aplicado=i.descuento_aplicado,d.subtotal=i.subtotal,d.impuestos=i.impuestos,d.total=i.total,d.descuento=m),e.next=20,W({variables:{input:d,empresa:y.empresa._id,sucursal:y.sucursal._id,usuario:y._id}});case 20:O=e.sent,N({message:"\xa1Listo! ".concat(O.data.crearCompra.message),status:"success",open:!0});case 22:A(!1),V(),n&&(n(),r(!1)),e.next=34;break;case 27:e.prev=27,e.t0=e.catch(6),A(!1),N({message:"Error de servidor",status:"error",open:!0}),n&&(n(),r(!1)),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 34:case"end":return e.stop()}}),e,null,[[6,27]])})));return function(t,a,n,c,r,i){return e.apply(this,arguments)}}(),L=function(){o.length>0?v(!_):(V(),a())};return Object(B.jsxs)(Ee.a,{fullScreen:!0,open:t,onClose:a,TransitionComponent:ts,children:[Object(B.jsx)(wt.a,{style:{padding:0},children:Object(B.jsx)(Ie.a,{className:r.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:r.title,children:"Nueva compra"}),Object(B.jsxs)(p.a,{m:1,children:[Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:L,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})}),Object(B.jsx)(cs,{handleClose:a,handleToggleDelete:L,openDelete:_})]})]})})}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(J,{alert:k,setAlert:N}),Object(B.jsx)(He,{loading:E,setLoading:A}),Object(B.jsx)(Wo,{status:c}),Object(B.jsx)(p.a,{my:2}),Object(B.jsx)(Jo,{})]}),Object(B.jsxs)(Ue.a,{style:{justifyContent:"enEspera"===c?"flex-end":"space-between"},children:["enEspera"===c?null:Object(B.jsx)(w.a,{autoFocus:!0,color:"primary",variant:"contained",size:"large",onClick:function(){return M(!0)},disabled:!o.length,startIcon:Object(B.jsx)(Ko.a,{}),children:"Compra en espera"}),Object(B.jsx)(Xo,{realizarCompraBD:M})]})]})},cs=function(e){var t=e.handleClose,a=e.handleToggleDelete,n=e.openDelete,c=Object(l.useContext)(qa),r=c.setProductosCompra,i=c.setDatosCompra,o=c.setPreciosVenta,s=c.setProductoOriginal,d=c.setDatosProducto;return Object(B.jsx)("div",{children:Object(B.jsxs)(Ee.a,{open:n,TransitionComponent:ts,keepMounted:!0,onClose:a,"aria-labelledby":"modal-eliminar-compra",children:[Object(B.jsx)(wt.a,{id:"modal-eliminar-compra",children:"\xbfQuieres cancelar esta compra?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:a,color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{onClick:function(){d(Io),i(ko),o(zo),s(No),r(Po),a(),t()},color:"secondary",children:"Aceptar"})]})]})})},rs=a(125),is=a.n(rs),os=a(917),ss=a(52),ls=a.n(ss),ds=ls.a.ExcelFile,js=ls.a.ExcelFile.ExcelSheet,us=ls.a.ExcelFile.ExcelColumn;function bs(e){var t=e.compra,a=t.almacen,n=t.proveedor,c=t.fecha_registro,r=t.subtotal,i=t.impuestos,o=t.total,s=t.productos,d=[{almacen:a.nombre_almacen,proveedor:n.nombre_cliente,fecha_registro:ya(c),subtotal:Fa(r),impuestos:Fa(i),total:Fa(o)}],j=s.map((function(e){var t=e.producto,a=e.medida,n=e.color,c=e.unidad,r=e.cantidad,i=e.Cantidad_regalo,o=e.cantidad_total,s=e.descuento_precio,l=e.descuento_porcentaje,d=e.subtotal,j=e.impuestos,u=e.total;return{producto:t.datos_generales.nombre_comercial,medida:a?a.medida:"N/A",color:n?n.color:"N/A",unidad:c,cantidad:r,Cantidad_regalo:i,cantidad_total:o,descuento_precio:s,descuento_porcentaje:l,subtotal:Fa(d),impuestos:Fa(j),total:Fa(u)}}));return Object(B.jsx)(l.Fragment,{children:Object(B.jsx)($e.a,{children:Object(B.jsx)($e.a,{item:!0,children:Object(B.jsxs)(ds,{element:Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{variant:"contained",color:"primary",startIcon:Object(B.jsx)(os.a,{}),children:"Exportar a Excel"})}),filename:"Detalle de compra",children:[Object(B.jsxs)(js,{data:d,name:"Detalle compra",children:[Object(B.jsx)(us,{label:"Almacen",value:"almacen"}),Object(B.jsx)(us,{label:"Proveedor",value:"proveedor"}),Object(B.jsx)(us,{label:"Fecha de compra",value:"fecha_registro"}),Object(B.jsx)(us,{label:"Subtotal",value:"subtotal"}),Object(B.jsx)(us,{label:"Impuestos",value:"impuestos"}),Object(B.jsx)(us,{label:"Total",value:"total"})]}),Object(B.jsxs)(js,{data:j,name:"Productos de la compra",children:[Object(B.jsx)(us,{label:"Producto",value:"producto"}),Object(B.jsx)(us,{label:"Medida",value:"medida"}),Object(B.jsx)(us,{label:"Color",value:"color"}),Object(B.jsx)(us,{label:"Unidad",value:"unidad"}),Object(B.jsx)(us,{label:"Cantidad",value:"cantidad"}),Object(B.jsx)(us,{label:"Cantidad de regalo",value:"cantidad_regalo"}),Object(B.jsx)(us,{label:"Cantidad total",value:"cantidad_total"}),Object(B.jsx)(us,{label:"Precio de descuento",value:"descuento_precio"}),Object(B.jsx)(us,{label:"Porcentaje de descuento",value:"descuento_porcentaje"}),Object(B.jsx)(us,{label:"Subtotal",value:"subtotal"}),Object(B.jsx)(us,{label:"Impuestos",value:"impuestos"}),Object(B.jsx)(us,{label:"Total",value:"total"})]})]})})})})}var ps=Object(k.a)({root:{width:"100%"},container:{height:"50vh"}});function ms(e){var t=e.compra,a=ps(),n=Object(Se.a)(),c=t.productos,r=Object(l.useState)(""),i=Object(g.a)(r,2),o=i[0],s=i[1],d=Object(l.useState)([]),j=Object(g.a)(d,2),u=j[0],b=j[1];return Object(l.useEffect)((function(){b(c.filter((function(e){return e.producto.datos_generales.nombre_comercial.toLowerCase().includes(o.toLowerCase())})))}),[o,c]),Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(p.a,{mb:1,display:"flex",children:[Object(B.jsxs)(S.a,{style:{marginRight:16},children:[Object(B.jsx)("b",{children:"Proveedor: "}),t.proveedor.nombre_cliente]}),Object(B.jsxs)(S.a,{style:{marginRight:16},children:[Object(B.jsx)("b",{children:"Almacen: "}),t.almacen.nombre_almacen]}),Object(B.jsx)(S.a,{style:{marginRight:16},children:Object(B.jsxs)("b",{children:["Subtotal: $",t.subtotal]})}),Object(B.jsx)(S.a,{style:{marginRight:16},children:Object(B.jsxs)("b",{children:["Impuestos: $",t.impuestos]})}),Object(B.jsx)(S.a,{style:{marginRight:16},children:Object(B.jsxs)("b",{children:["Total: $",t.total]})}),!0===t.compra_credito?Object(B.jsx)(Qa.a,{label:!0===t.credito_pagado?"Credito pagado":"Saldo pendiente: $".concat(Fa(t.saldo_credito_pendiente)),color:!0===t.credito_pagado?"primary":"secondary",variant:"outlined"}):null]}),Object(B.jsx)(p.a,{mb:2,display:"flex",children:Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)($e.a,{item:!0,sm:6,xs:12,children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",onChange:function(e){return t=e.target.value,s(t);var t},InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:Object(B.jsx)(is.a,{color:"action"})})}})}),Object(B.jsx)($e.a,{item:!0,sm:6,xs:12,children:Object(B.jsx)(bs,{compra:t})})]})}),Object(B.jsx)(Ka.a,{className:a.root,children:Object(B.jsx)(ba.a,{className:a.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Producto"}),Object(B.jsx)(Oa.a,{children:"Medida"}),Object(B.jsx)(Oa.a,{children:"Color"}),Object(B.jsx)(Oa.a,{children:"Unidad"}),Object(B.jsx)(Oa.a,{children:"Cantidad"}),Object(B.jsx)(Oa.a,{children:"C. regalo"}),Object(B.jsx)(Oa.a,{children:"C. total"}),Object(B.jsx)(Oa.a,{children:"Descuento"}),Object(B.jsx)(Oa.a,{children:"Subtotal"}),Object(B.jsx)(Oa.a,{children:"Impuestos"}),Object(B.jsx)(Oa.a,{children:"Total"})]})}),Object(B.jsx)(xa.a,{children:u.map((function(e,t){return Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:e.producto.datos_generales.nombre_comercial}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:e.medida&&e.medida.medida?e.medida.medida:"N/A"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:e.color&&e.color.hex?Object(B.jsx)(Qa.a,{label:e.color.color,size:"small",style:{backgroundColor:e.color.hex,color:n.palette.getContrastText(e.color.hex)}}):"N/A"}),Object(B.jsx)(Oa.a,{children:e.unidad}),Object(B.jsx)(Oa.a,{children:e.cantidad}),Object(B.jsx)(Oa.a,{children:e.cantidad_regalo}),Object(B.jsx)(Oa.a,{children:e.cantidad_total}),Object(B.jsx)(Oa.a,{children:"$".concat(e.descuento_precio," - %").concat(e.descuento_porcentaje)}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(e.subtotal)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(e.impuestos)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(e.total)]})})]},t)}))})]})})})]})}var Os=a(918),xs=Object(k.a)({root:{width:"100%"},container:{height:"72vh"}});function hs(e){var t=e.obtenerComprasRealizadas,a=xs();return Object(B.jsx)(Ka.a,{className:a.root,variant:"outlined",children:Object(B.jsx)(ba.a,{className:a.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Almacen"}),Object(B.jsx)(Oa.a,{children:"Proveedor"}),Object(B.jsx)(Oa.a,{children:"Fecha de compra"}),Object(B.jsx)(Oa.a,{children:"Compra a credito"}),Object(B.jsx)(Oa.a,{children:"Subtotal"}),Object(B.jsx)(Oa.a,{children:"Impuestos"}),Object(B.jsx)(Oa.a,{children:"Total"}),Object(B.jsx)(Oa.a,{children:"Productos"})]})}),Object(B.jsx)(xa.a,{children:t.map((function(e,t){return Object(B.jsx)(_s,{compra:e},t)}))})]})})})}var _s=function(e){var t=e.compra,a=t.almacen,n=t.proveedor,c=t.fecha_registro,r=t.compra_credito,i=t.credito_pagado,o=t.subtotal,s=t.impuestos,l=t.total;return Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:a.nombre_almacen}),Object(B.jsx)(Oa.a,{children:n.nombre_cliente}),Object(B.jsx)(Oa.a,{children:ya(c)}),Object(B.jsx)(Oa.a,{children:!0===r?Object(B.jsx)(Qa.a,{label:!0===i?"Credito: Pagado":"Credito: Pendiente",color:!0===i?"primary":"secondary",variant:"outlined"}):null}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(o)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(s)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(l)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(gs,{compra:t})})]})},fs=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),gs=function(e){var t=e.compra,a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=function(){r(!c)};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(X.a,{onClick:function(){return i()},children:Object(B.jsx)(Os.a,{})}),Object(B.jsxs)(Ee.a,{open:c,onClose:i,fullWidth:!0,maxWidth:"lg",TransitionComponent:fs,children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(S.a,{variant:"h6",style:{flexGrow:1},children:"Datos de venta"}),Object(B.jsx)(w.a,{variant:"text",color:"primary",onClick:i,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(ms,{compra:t})}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{variant:"text",color:"primary",size:"large",startIcon:Object(B.jsx)(Dt.a,{}),onClick:function(){return i()},children:"Aceptar"})})]})]})},vs=a(919),Cs=ls.a.ExcelFile,ys=ls.a.ExcelFile.ExcelSheet,Ss=ls.a.ExcelFile.ExcelColumn;function Fs(e){var t=e.obtenerComprasRealizadas,a=e.filtro,n=e.filtroFecha,c=t.map((function(e){var t=e.almacen,a=e.proveedor,n=e.fecha_registro,c=e.subtotal,r=e.impuestos,i=e.total;return{almacen:t.nombre_almacen,proveedor:a.nombre_cliente,fecha_registro:ya(n),subtotal:Fa(c),impuestos:Fa(r),total:Fa(i)}})),r="";return a&&n.fecha?r="Lista de compras realizadas desde hace ".concat(n.since," y filtradas por ").concat(a):a&&!n.fecha?r="Lista de compras realizadas filtradas por ".concat(a):!a&&n.fecha?r="Lista de compras realizadas desde hace ".concat(n.since):a||n.fecha||(r="Lista de compras realizadas"),Object(B.jsx)(l.Fragment,{children:Object(B.jsx)($e.a,{children:Object(B.jsx)($e.a,{item:!0,children:Object(B.jsx)(Cs,{element:Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{variant:"contained",color:"primary",startIcon:Object(B.jsx)(os.a,{}),children:"Exportar a Excel"})}),filename:r,children:Object(B.jsxs)(ys,{data:c,name:r,children:[Object(B.jsx)(Ss,{label:"Almacen",value:"almacen"}),Object(B.jsx)(Ss,{label:"Proveedor",value:"proveedor"}),Object(B.jsx)(Ss,{label:"Fecha de compra",value:"fecha_registro"}),Object(B.jsx)(Ss,{label:"Subtotal",value:"subtotal"}),Object(B.jsx)(Ss,{label:"Impuestos",value:"impuestos"}),Object(B.jsx)(Ss,{label:"Total",value:"total"})]})})})})})}var ws=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}})),Is=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function ks(){var e=ws(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Fe.g,{className:e.icon})}),"Compras realizadas"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Is,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Compras realizadas"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsx)(y.a,{maxWidth:"xl",children:Object(B.jsx)(zs,{})})]})]})}var zs=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(l.useState)(""),a=Object(g.a)(t,2),n=a[0],c=a[1],r=Object(l.useState)({fecha:"",since:"todos"}),i=Object(g.a)(r,2),o=i[0],s=i[1],d=Object(l.useRef)(null),j=Object(l.useRef)(null),u=Object(qe.a)(Co,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,fecha:o.fecha},fetchPolicy:"network-only"}),b=u.loading,m=u.data,O=u.error,x=u.refetch;if(b)return Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:[Object(B.jsx)(I.a,{}),Object(B.jsx)(S.a,{variant:"h5",children:"Cargando"})]});if(O)return Object(B.jsx)(Ze,{error:O,altura:300});var h=[];m&&(h=m.obtenerComprasRealizadas);return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{my:3,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsx)("form",{onSubmit:function(e){return function(e,t){e.preventDefault(),x({filtro:t,fecha:o.fecha}),c(t)}(e,e.target[0].value)},children:Object(B.jsx)(F.a,{inputRef:d,fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",InputProps:{endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(X.a,{type:"submit",color:"primary",size:"medium",children:Object(B.jsx)(vs.a,{})})})}})})}),Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsxs)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:[Object(B.jsx)(Y.a,{id:"label-select-fecha-filter",children:"Filtrar desde..."}),Object(B.jsxs)(mt.a,{inputRef:j,labelId:"label-select-fecha-filter",value:o.since,onChange:function(e){return function(e){switch(e){case"7 dias":s({since:e,fecha:ht()().subtract(7,"d").format()}),x({filtro:n,fecha:ht()().subtract(7,"d").format()});break;case"2 semanas":s({since:e,fecha:ht()().subtract(2,"w").format()}),x({filtro:n,fecha:ht()().subtract(2,"w").format()});break;case"1 mes":s({since:e,fecha:ht()().subtract(1,"M").format()}),x({filtro:n,fecha:ht()().subtract(1,"M").format()});break;case"3 meses":s({since:e,fecha:ht()().subtract(3,"M").format()}),x({filtro:n,fecha:ht()().subtract(3,"M").format()});break;case"6 meses":s({since:e,fecha:ht()().subtract(6,"M").format()}),x({filtro:n,fecha:ht()().subtract(6,"M").format()});break;case"8 meses":s({since:e,fecha:ht()().subtract(8,"M").format()}),x({filtro:n,fecha:ht()().subtract(8,"M").format()});break;case"1 a\xf1o":s({since:e,fecha:ht()().subtract(1,"y").format()}),x({filtro:n,fecha:ht()().subtract(1,"y").format()});break;default:s({since:"todos",fecha:""}),x({filtro:n,fecha:""})}}(e.target.value)},label:"Filtrar desde...",children:[Object(B.jsx)(Ot.a,{value:"todos",children:Object(B.jsx)("em",{children:"Todos los registros"})}),Object(B.jsx)(Ot.a,{value:"7 dias",children:"hace 7 d\xedas"}),Object(B.jsx)(Ot.a,{value:"2 semanas",children:"hace 2 semanas"}),Object(B.jsx)(Ot.a,{value:"1 mes",children:"hace 1 mes"}),Object(B.jsx)(Ot.a,{value:"3 meses",children:"hace 3 meses"}),Object(B.jsx)(Ot.a,{value:"6 meses",children:"hace 6 meses"}),Object(B.jsx)(Ot.a,{value:"8 meses",children:"hace 8 meses"}),Object(B.jsx)(Ot.a,{value:"1 a\xf1o",children:"hace 1 a\xf1o"})]})]})}),Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsx)(Fs,{obtenerComprasRealizadas:h,filtro:n,filtroFecha:o})})]})}),n||o.fecha?Object(B.jsxs)(p.a,{display:"flex",mb:1,children:[Object(B.jsx)(S.a,{variant:"h6",children:"Resultados de:"}),Object(B.jsx)(p.a,{mr:1}),n?Object(B.jsx)(Qa.a,{variant:"outlined",size:"medium",label:n,onDelete:function(){x({filtro:"",fecha:o.fecha}),c(""),d.current.value=""}}):null,Object(B.jsx)(p.a,{mx:1}),o.fecha?Object(B.jsx)(Qa.a,{variant:"outlined",size:"medium",label:"Desde hace ".concat(o.since),onDelete:function(){x({filtro:n,fecha:""}),s({since:"todos",fecha:""}),j.current.value="todos"}}):null]}):null,Object(B.jsx)(hs,{obtenerComprasRealizadas:h})]})},Ns=a(920),Ps=a(922),Ds=a(921),Es=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function As(e){var t=e.compra,a=e.nuevoArray,n=e.setNuevoArray,c=e.setVerificado,r=Object(l.useState)(!1),i=Object(g.a)(r,2),o=i[0],s=i[1],d=Object(l.useState)(!1),j=Object(g.a)(d,2),u=j[0],b=j[1],p=function(){s(!0)},m=function(){u&&c(!0),s(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{variant:"contained",color:"primary",onClick:function(){return p()},startIcon:Object(B.jsx)(Ns.a,{}),children:"Continuar compra"}),Object(B.jsx)(Ee.a,{open:o,TransitionComponent:Es,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&m()},"aria-labelledby":"dialog-verificarcompra-title","aria-describedby":"dialog-verificarcompra-description",fullWidth:!0,maxWidth:"sm",children:Object(B.jsx)(Ts,{handleClose:m,compra:t,handleClickOpen:p,open:o,nuevoArray:a,setNuevoArray:n,setSuccess:b})})]})}var Ts=function(e){var t=e.handleClose,a=e.compra,n=e.handleClickOpen,c=e.open,r=(e.nuevoArray,e.setNuevoArray),i=e.setSuccess,o=Object(l.useState)(!1),s=Object(g.a)(o,2),d=s[0],j=s[1],u=JSON.parse(localStorage.getItem("sesionCafi")),m=0,O=Object(Ds.a)(Nn,{variables:{empresa:u.empresa._id,sucursal:u.sucursal._id,almacen:a.almacen.id_almacen},fetchPolicy:"network-only"}),x=Object(g.a)(O,2),h=x[0],_=x[1],f=_.loading,v=_.data,C=_.error;if(v&&(m=1),Object(l.useEffect)((function(){c&&0===m&&(h(),m=1)}),[n]),Object(l.useEffect)((function(){v&&function(){j(!0);for(var e=a.productos,t=Object(da.a)(e),n=!1,c=function(a){var c=e[a],r=Object(b.a)({},c),i=Object(b.a)({},c.producto),o=y.filter((function(e){return e._id===r.id_producto})),s=i.precios,l=i.unidades_de_venta,d=i.presentaciones,j=o[0].precios,u=o[0].unidades_de_venta,p=o[0].medidas_producto;s.unidad_de_compra.cantidad===j.unidad_de_compra.cantidad&&s.unidad_de_compra.precio_unitario_con_impuesto===j.unidad_de_compra.precio_unitario_con_impuesto&&s.unidad_de_compra.unidad===j.unidad_de_compra.unidad||(i.precios=j,r.producto=i,r.conflicto=!0,t[a]=r,n=!0);var m=l.filter((function(e){return!0===e.default})),O=u.filter((function(e){return!0===e.default}));if(m[0].cantidad===O[0].cantidad&&m[0].precio===O[0].precio&&m[0].unidad===O[0].unidad||(i.unidades_de_venta=u,r.producto=i,r.conflicto=!0,t[a]=r,n=!0),d.length>0)if(p.length>0)if(d.length===p.length)for(var x=0;x<d.length;x++)for(var h=d[x],_=0;_<p.length;_++){var f=p[_];h.medida._id===f.medida._id&&h.color._id===f.color._id&&h.almacen===f.almacen&&(h.cantidad===f.cantidad&&h.precio===f.precio||(i.presentaciones=p,r.producto=i,r.conflicto=!0,t[a]=r,n=!0))}else i.presentaciones=p,r.producto=i,r.conflicto=!0,t[a]=r,n=!0;else r.conflicto=!0,t[a]=r,n=!0},o=0;o<e.length;o++)c(o);var s=[],l=0,d=0,u=0;if(n){for(var p=function(e){var a=Object(b.a)({},t[e]);if("OTROS"!==a.producto.datos_generales.tipo_producto)a.producto.presentaciones.length>0?(a.cantidad=0,a.producto.presentaciones.forEach((function(e){var t=e.cantidad,n=e.cantidad_nueva,c=n||0;a.cantidad+=t+c})),isNaN(a.cantidad)&&(a.cantidad=0),a.cantidad_total=a.cantidad):(a.cantidad=0,a.cantidad_total=a.cantidad);else{var n=a.cantidad_regalo,c=a.cantidad,r=a.unidad_regalo,i=a.producto.precios.unidad_de_compra.cantidad,o="Pz"===r||"Kg"===r||"Lt"===r?n:n*i,j=c*i+o;i>1?(a.cantidad_regalo=o/i,a.cantidad_total=j/i):(a.cantidad_regalo=o,a.cantidad_total=j)}var p=a.producto.precios.precio_de_compra,m=p.iva,O=p.ieps,x=p.precio_con_impuesto,h=p.precio_sin_impuesto;a.total_con_descuento=x,a.costo=x,a.iva_total=m*a.cantidad_total,a.ieps_total=O*a.cantidad_total,a.impuestos=(m+O)*a.cantidad_total,a.subtotal=h*a.cantidad_total,a.total=x*a.cantidad_total,a.descuento_porcentaje>0&&(a.descuento_precio=Math.round(x*a.descuento_porcentaje/100),a.total_con_descuento=x-a.descuento_precio),l+=a.subtotal,d+=a.impuestos,u+=a.total_con_descuento*a.cantidad_total,s.push(a)},m=0;m<t.length;m++)p(m);r({_id:a._id,almacen:a.almacen,proveedor:a.proveedor,productos:s,en_espera:a.en_espera,fecha_registro:a.fecha_registro,impuestos:d,subtotal:l,total:u})}else r(a);setTimeout((function(){j(!1),i(!0)}),1500)}()}),[v]),f)return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(Ae.a,{style:{height:150,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[Object(B.jsx)(Lt.a,{id:"dialog-verificarcompra-description",children:"Si ya no hay existencias en tu producto se marcaran en la tabla y se quitaran al retomar la compra para no causar conflictos, podras editar tu compra mas adelante"}),Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(I.a,{size:18,color:"primary",style:{marginRight:8}}),"Obteniendo productos de la Base de datos..."]})]}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{onClick:t,color:"inherit",children:"Cancelar"})})]});if(C)return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(Ae.a,{children:Object(B.jsx)(Ze,{error:C,altura:130})}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{onClick:t,color:"inherit",children:"Cerrar"})})]});var y=[];return v&&(y=v.obtenerProductos),Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(Ae.a,{style:{height:150,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[Object(B.jsx)(Lt.a,{id:"dialog-verificarcompra-description",children:"Si ya no hay existencias en tu producto se marcaran en la tabla y se quitaran al retomar la compra para no causar conflictos, podras editar tu compra mas adelante"}),d?Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(I.a,{size:18,color:"primary",style:{marginRight:8}}),"Verificando existencias en tus productos..."]}):null,d?null:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Ps.a,{color:"primary",style:{marginRight:8}}),"Listo, producto verificados"]})]}),Object(B.jsx)(Ue.a,{children:d?Object(B.jsx)(w.a,{onClick:t,color:"inherit",children:"Cancelar"}):Object(B.jsx)(w.a,{onClick:t,color:"primary",startIcon:Object(B.jsx)(Dt.a,{}),children:"Aceptar"})})]})},Ws=a(923),$s=Object(k.a)({root:{width:"100%"},container:{height:"50vh"}});function Rs(e){var t=e.compra,a=e.setAlert,n=e.refetch,c=e.handleOpenDetalles,r=$s(),i=Object(Se.a)(),o=Object(l.useState)(Object(b.a)({},t)),s=Object(g.a)(o,2),d=s[0],j=s[1],u=d.productos,m=JSON.parse(localStorage.getItem("sesionCafi")),O=Object(l.useState)(""),x=Object(g.a)(O,2),h=x[0],_=x[1],f=Object(l.useState)([]),v=Object(g.a)(f,2),C=v[0],y=v[1],w=Object(l.useState)(),I=Object(g.a)(w,2),k=I[0],z=I[1],N=Object(l.useState)(!1),P=Object(g.a)(N,2),D=P[0],E=P[1];return Object(l.useEffect)((function(){y(u.filter((function(e){return e.producto.datos_generales.nombre_comercial.toLowerCase().includes(h.toLowerCase())})))}),[h,u]),Object(l.useEffect)((function(){D&&k&&j(k)}),[D]),Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(p.a,{mb:1,display:"flex",children:[Object(B.jsxs)(S.a,{style:{marginRight:16},children:[Object(B.jsx)("b",{children:"Proveedor: "}),d.proveedor.nombre_cliente]}),Object(B.jsxs)(S.a,{style:{marginRight:16},children:[Object(B.jsx)("b",{children:"Almacen: "}),d.almacen.nombre_almacen]}),Object(B.jsx)(S.a,{style:{marginRight:16},children:Object(B.jsxs)("b",{children:["Subtotal: $",parseFloat(d.subtotal).toFixed(2)]})}),Object(B.jsx)(S.a,{style:{marginRight:16},children:Object(B.jsxs)("b",{children:["Impuestos: $",parseFloat(d.impuestos).toFixed(2)]})}),Object(B.jsx)(S.a,{style:{marginRight:16},children:Object(B.jsxs)("b",{children:["Total: $",Fa(parseFloat(d.total).toFixed(2))]})})]}),Object(B.jsx)(p.a,{mb:2,display:"flex",children:Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)($e.a,{item:!0,sm:6,xs:12,children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",onChange:function(e){return t=e.target.value,_(t);var t},InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:Object(B.jsx)(is.a,{color:"action"})})}})}),Object(B.jsx)($e.a,{item:!0,sm:6,xs:12,children:Object(B.jsxs)(p.a,{display:"flex",justifyContent:"flex-end",children:[!1===m.accesos.compras.compras_espera.eliminar?null:Object(B.jsx)(Ms,{compra:d,setAlert:a,refetch:n,handleOpenDetalles:c}),Object(B.jsx)(p.a,{mx:1}),!1===m.accesos.compras.compras_espera.editar?null:D?Object(B.jsx)(as,{compra:d,status:"enEspera",handleOpenDetalles:c,refetchEspera:n}):Object(B.jsx)(As,{compra:d,nuevoArray:k,setNuevoArray:z,setVerificado:E})]})})]})}),Object(B.jsx)(Ka.a,{className:r.root,variant:"outlined",children:Object(B.jsx)(ba.a,{className:r.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[D?Object(B.jsx)(Oa.a,{}):null,Object(B.jsx)(Oa.a,{children:"Producto"}),Object(B.jsx)(Oa.a,{children:"Medida"}),Object(B.jsx)(Oa.a,{children:"Color"}),Object(B.jsx)(Oa.a,{children:"Unidad"}),Object(B.jsx)(Oa.a,{children:"Cantidad"}),Object(B.jsx)(Oa.a,{children:"C. regalo"}),Object(B.jsx)(Oa.a,{children:"C. total"}),Object(B.jsx)(Oa.a,{children:"Descuento"}),Object(B.jsx)(Oa.a,{children:"Subtotal"}),Object(B.jsx)(Oa.a,{children:"Impuestos"}),Object(B.jsx)(Oa.a,{children:"Total"})]})}),Object(B.jsx)(xa.a,{children:C.map((function(e,t){return Object(B.jsxs)(ma.a,{tabIndex:-1,selected:e.conflicto,children:[D?Object(B.jsx)(Oa.a,{style:{paddingTop:0,paddingBottom:0},children:e.conflicto?Object(B.jsx)(Lo.a,{color:"primary"}):Object(B.jsx)(Ps.a,{style:{color:i.palette.success.main}})}):null,Object(B.jsx)(Oa.a,{children:e.producto.datos_generales.nombre_comercial}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:e.medida&&e.medida.medida?e.medida.medida:"N/A"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:e.color&&e.color.hex?Object(B.jsx)(Qa.a,{label:e.color.color,size:"small",style:{backgroundColor:e.color.hex,color:i.palette.getContrastText(e.color.hex)}}):"N/A"}),Object(B.jsx)(Oa.a,{children:e.unidad}),Object(B.jsx)(Oa.a,{children:e.cantidad}),Object(B.jsx)(Oa.a,{children:e.cantidad_regalo}),Object(B.jsx)(Oa.a,{children:e.cantidad_total}),Object(B.jsx)(Oa.a,{children:"$".concat(e.descuento_precio," - %").concat(e.descuento_porcentaje)}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(e.subtotal)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(e.impuestos)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(e.total)]})})]},t)}))})]})})})]})}var Vs=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),Ms=function(e){var t=e.compra,a=e.setAlert,n=e.refetch,c=e.handleOpenDetalles,r=Object(l.useState)(!1),i=Object(g.a)(r,2),o=i[0],s=i[1],d=Object(l.useState)(!1),j=Object(g.a)(d,2),u=j[0],b=j[1],p=Object(z.a)(Fo),m=Object(g.a)(p,1)[0],O=function(){s(!o)},x=function(){var e=Object(f.a)(C.a.mark((function e(){var r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.prev=1,e.next=4,m({variables:{id:t._id}});case 4:r=e.sent,a({message:"\xa1Listo! ".concat(r.data.eliminarCompraEnEspera.message),status:"success",open:!0}),n(),b(!1),O(),c(),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0),b(!1),a({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(w.a,{color:"secondary",startIcon:Object(B.jsx)(Ws.a,{}),onClick:function(){return O()},children:"Eliminar compra"}),Object(B.jsxs)(Ee.a,{open:o,onClose:O,TransitionComponent:Vs,children:[Object(B.jsx)(wt.a,{children:"\xbfDesea eliminar esta compra?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{variant:"text",color:"inherit",size:"large",startIcon:Object(B.jsx)(We.a,{}),onClick:function(){return O()},children:"Cancelar"}),Object(B.jsx)(w.a,{variant:"text",color:"secondary",size:"large",disabled:u,startIcon:u?Object(B.jsx)(I.a,{size:18,color:"inherit"}):Object(B.jsx)(Dt.a,{}),onClick:function(){return x()},children:"Eliminar"})]})]})]})},Ls=Object(k.a)({root:{width:"100%"},container:{height:"75vh"}});function Us(e){var t=e.obtenerComprasEnEspera,a=e.refetch,n=Ls(),c=Object(l.useState)({message:"",status:"",open:!1}),r=Object(g.a)(c,2),i=r[0],o=r[1],s=JSON.parse(localStorage.getItem("sesionCafi"));return Object(B.jsxs)(Ka.a,{className:n.root,variant:"outlined",children:[Object(B.jsx)(J,{alert:i,setAlert:o}),Object(B.jsx)(ba.a,{className:n.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Almacen"}),Object(B.jsx)(Oa.a,{children:"Proveedor"}),Object(B.jsx)(Oa.a,{children:"Fecha de compra"}),Object(B.jsx)(Oa.a,{children:"Subtotal"}),Object(B.jsx)(Oa.a,{children:"Impuestos"}),Object(B.jsx)(Oa.a,{children:"Total"}),Object(B.jsx)(Oa.a,{children:"Detalles"}),!1===s.accesos.compras.compras_espera.elimina?null:Object(B.jsx)(Oa.a,{children:"Eliminar"})]})}),Object(B.jsx)(xa.a,{children:t.map((function(e,t){return Object(B.jsx)(Bs,{compra:e,refetch:a,setAlert:o},t)}))})]})})]})}var Bs=function(e){var t=e.compra,a=e.refetch,n=e.setAlert,c=t.almacen,r=t.proveedor,i=t.fecha_registro,o=t.subtotal,s=t.impuestos,l=t.total,d=JSON.parse(localStorage.getItem("sesionCafi"));return Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:c.nombre_almacen}),Object(B.jsx)(Oa.a,{children:r.nombre_cliente}),Object(B.jsx)(Oa.a,{children:ya(i)}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(o)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(s)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(l)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(Js,{compra:t,refetch:a,setAlert:n})}),!1===d.accesos.compras.compras_espera.eliminar?null:Object(B.jsx)(Oa.a,{children:Object(B.jsx)(Gs,{compra:t,refetch:a,setAlert:n})})]})},qs=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),Js=function(e){var t=e.compra,a=e.setAlert,n=e.refetch,c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=function(){o(!i)};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(X.a,{onClick:function(){return s()},children:Object(B.jsx)(Os.a,{})}),Object(B.jsxs)(Ee.a,{open:i,onClose:s,fullWidth:!0,maxWidth:"lg",TransitionComponent:qs,children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(S.a,{variant:"h6",style:{flexGrow:1},children:"Datos de compra en espera"}),Object(B.jsx)(w.a,{variant:"text",color:"primary",onClick:s,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(Rs,{compra:t,refetch:n,setAlert:a,handleOpenDetalles:s})})]})]})},Gs=function(e){var t=e.compra,a=e.setAlert,n=e.refetch,c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)(!1),d=Object(g.a)(s,2),j=d[0],u=d[1],b=Object(z.a)(Fo),p=Object(g.a)(b,1)[0],m=function(){o(!i)},O=function(){var e=Object(f.a)(C.a.mark((function e(){var c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,p({variables:{id:t._id}});case 4:c=e.sent,a({message:"\xa1Listo! ".concat(c.data.eliminarCompraEnEspera.message),status:"success",open:!0}),n(),u(!1),m(),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0),u(!1),a({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 16:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(X.a,{onClick:function(){return m()},children:Object(B.jsx)(Ws.a,{color:"error"})}),Object(B.jsxs)(Ee.a,{open:i,onClose:m,TransitionComponent:qs,children:[Object(B.jsx)(wt.a,{children:"\xbfDesea eliminar esta compra?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{variant:"text",color:"inherit",size:"large",startIcon:Object(B.jsx)(We.a,{}),onClick:function(){return m()},children:"Cancelar"}),Object(B.jsx)(w.a,{variant:"text",color:"secondary",size:"large",disabled:j,startIcon:j?Object(B.jsx)(I.a,{size:18,color:"inherit"}):Object(B.jsx)(Dt.a,{}),onClick:function(){return O()},children:"Eliminar"})]})]})]})},Hs=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100}}})),Ys=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Ks(){var e=Hs(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Fe.k,{className:e.icon})}),"Compras en espera"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Ys,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Compras en espera"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsx)(y.a,{maxWidth:"xl",children:Object(B.jsx)(Qs,{})})]})]})}var Qs=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(l.useState)(""),a=Object(g.a)(t,2),n=a[0],c=a[1],r=Object(l.useRef)(null),i=Object(qe.a)(yo,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,filtro:n},fetchPolicy:"network-only"}),o=i.loading,s=i.data,d=i.error,j=i.refetch;if(o)return Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:[Object(B.jsx)(I.a,{}),Object(B.jsx)(S.a,{variant:"h5",children:"Cargando"})]});if(d)return Object(B.jsx)(Ze,{error:d,altura:300});var u=[];s&&(u=s.obtenerComprasEnEspera);return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{my:3,maxWidth:500,children:Object(B.jsx)("form",{onSubmit:function(e){return function(e,t){e.preventDefault(),j({filtro:t}),c(t)}(e,e.target[0].value)},children:Object(B.jsx)(F.a,{inputRef:r,fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",InputProps:{endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(X.a,{type:"submit",color:"primary",size:"medium",children:Object(B.jsx)(vs.a,{})})})}})})}),Object(B.jsx)(Us,{obtenerComprasEnEspera:u,refetch:j})]})};function Xs(){var e=JSON.parse(localStorage.getItem("sesionCafi"));return Object(B.jsx)(y.a,{maxWidth:"md",children:Object(B.jsxs)($e.a,{container:!0,spacing:3,justifyContent:"center",children:[!1===e.accesos.compras.abrir_compra.ver?null:Object(B.jsx)($e.a,{item:!0,md:4,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(as,{})})}),!1===e.accesos.compras.compras_realizadas.ver?null:Object(B.jsx)($e.a,{item:!0,md:4,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(ks,{})})}),!1===e.accesos.compras.compras_espera.ver?null:Object(B.jsx)($e.a,{item:!0,md:4,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Ks,{})})})]})})}var Zs=a(497),el=a(924),tl=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),al=Object(k.a)({root:{width:"100%"},container:{height:"75vh"}});function nl(e){var t=e.user,a=e.tipo,n=e.filtro,c=e.ventas,r=e.handleClickOpen,i=al(),o=Object(l.useContext)(Xi),s=o.setUpdateClientVenta,d=o.updateClientVenta,j=o.update,u=Object(_c.a)(n,1e3),b=Object(g.a)(u,1)[0],m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=(O[1],JSON.parse(localStorage.getItem("sesionCafi"))),_=Object(qe.a)(Oo,{variables:{tipo:a,filtro:b,empresa:h.empresa._id,eliminado:!1},fetchPolicy:"network-only"}),f=_.loading,v=_.data,C=_.error,y=_.refetch;Object(l.useEffect)((function(){y()}),[j,y]);var F=Object(l.useState)(!1),k=Object(g.a)(F,2),z=k[0],N=k[1],P=Object(l.useState)({}),D=Object(g.a)(P,2),E=D[0],A=D[1],T=Object(l.useState)({message:"",status:"",open:!1}),W=Object(g.a)(T,2),$=W[0],R=W[1],V=function(e,t){c&&!x&&(N(!0),A(e))};if(f)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",width:"120vh",children:Object(B.jsx)(I.a,{})});if(C)return Object(B.jsx)(Ze,{error:C});var M=v.obtenerClientes;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(J,{alert:$,setAlert:R}),Object(B.jsxs)(Ka.a,{className:i.root,variant:"outlined",children:[Object(B.jsx)(ba.a,{className:i.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{width:"110",children:"No. Cliente"}),Object(B.jsx)(Oa.a,{width:"100",children:"Clave"}),Object(B.jsx)(Oa.a,{width:"200",children:"Nombre"}),Object(B.jsx)(Oa.a,{width:"150",children:"Correo"}),Object(B.jsx)(Oa.a,{width:"200",children:"Fecha Registro"}),"EMPLEADO"===t?null:Object(B.jsx)(Oa.a,{width:"100",children:"Estado"}),Object(B.jsx)(Oa.a,{width:"50",children:"Editar"}),"EMPLEADO"===t?null:Object(B.jsx)(Oa.a,{width:"50",children:"Eliminar"})]})}),Object(B.jsx)(xa.a,{children:M.map((function(e,a){return Object(B.jsx)(cl,{user:t,datos:e,handleClickOpenModal:V,setAlert:R,refetch:y,ventas:c,dataSelectRowClient:E},a)}))})]})}),Object(B.jsxs)(Ee.a,{open:z,onClose:function(){return N(!1)},"aria-labelledby":"select-dialog-cliente-venta","aria-describedby":"select-cliente-venta-description",children:[Object(B.jsx)(wt.a,{id:"select-dialog-cliente-venta",children:"\xbfEstas seguro que desea seleccionar este cliente?"}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(S.a,{children:"Cliente: ".concat(E.nombre_cliente)}),Object(B.jsx)(S.a,{children:"N\xfamero de clave: ".concat(E.clave_cliente)}),Object(B.jsx)(Lt.a,{id:"select-cliente-venta-description",children:"Al seleccionar el cliente se colocara en la venta."})]}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:function(){return N(!1)},color:"primary",autoFocus:!0,children:"cancelar"}),Object(B.jsx)(w.a,{onClick:function(){return function(){try{var e,t=JSON.parse(localStorage.getItem("DatosVentas")),a=null===t?{}:t;localStorage.setItem("DatosVentas",JSON.stringify({subTotal:void 0===a.subTotal?0:a.subTotal,total:void 0===a.total?0:a.total,impuestos:void 0===a.impuestos?0:a.impuestos,iva:void 0===a.iva?0:a.iva,ieps:void 0===a.ieps?0:a.ieps,descuento:void 0===a.descuento?0:a.descuento,monedero:void 0===a.monedero?0:a.monedero,cliente:E,venta_cliente:!0,productos:(null===(e=a.productos)||void 0===e?void 0:e.length)>0?a.productos:[],tipo_emision:a.tipo_emision?a.tipo_emision:"TICKET"})),s(!d),N(!z),r()}catch(C){console.log(C)}}()},color:"primary",children:"Aceptar"})]})]})]})]})}var cl=function(e){var t=e.datos,a=e.user,n=e.handleClickOpenModal,c=e.setAlert,r=e.refetch,i=e.ventas,o=e.dataSelectRowClient,s=JSON.parse(localStorage.getItem("sesionCafi")),d=Object(l.useContext)(Xi),j=d.update,u=d.setUpdate,b=Object(l.useState)(!1),p=Object(g.a)(b,2),m=p[0],O=p[1],x=Object(z.a)(xo),h=Object(g.a)(x,1)[0],_=function(){var e=Object(f.a)(C.a.mark((function e(a){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.prev=1,e.next=4,h({variables:{input:{estado_cliente:a.target.checked},id:t._id}});case 4:u(!j),O(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),O(!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)(ma.a,{role:"checkbox",tabIndex:-1,onClick:function(e){return n(t,e)},hover:i,style:i?{cursor:"pointer"}:null,selected:i&&o.numero_cliente===t.numero_cliente,children:[Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.numero_cliente})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.clave_cliente})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.nombre_cliente})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.email})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:Sa(t.fecha_registro)})}),"EMPLEADO"===a?null:Object(B.jsx)(Oa.a,{children:m?Object(B.jsx)(I.a,{size:30}):Object(B.jsx)(el.a,{checked:t.estado_cliente,onChange:_,color:"primary"})}),Object(B.jsx)(Oa.a,{width:50,children:!1===s.accesos.catalogos.clientes.editar?null:Object(B.jsx)(fo,{tipo:"CLIENTE",accion:"actualizar",datos:t,refetch:r})}),Object(B.jsx)(Oa.a,{width:50,children:!1===s.accesos.catalogos.clientes.editar?null:Object(B.jsx)(rl,{datos:t,setAlert:c,refetch:r})})]})})},rl=function(e){var t=e.datos,a=e.setAlert,n=e.refetch,c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(z.a)(ho),d=Object(g.a)(s,1)[0],j=Object(l.useState)(!1),u=Object(g.a)(j,2),b=u[0],p=u[1],m=function(){o(!1)},O=function(){var e=Object(f.a)(C.a.mark((function e(){var c,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,d({variables:{id:t._id}});case 4:(c=e.sent)&&(r=c.data.eliminarCliente.message,a({message:r,status:"success",open:!0}),n()),p(!1),m(),e.next=18;break;case 10:if(e.prev=10,e.t0=e.catch(1),console.log(e.t0),p(!1),!e.t0.message){e.next=17;break}return a({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 17:a({message:"Hubo un error",status:"error",open:!0});case 18:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{color:"secondary",onClick:function(){o(!0)},children:Object(B.jsx)(ur.a,{})}),Object(B.jsxs)(Ee.a,{open:i,TransitionComponent:tl,keepMounted:!0,onClose:function(){return m()},"aria-labelledby":"alert-eliminar-cliente",children:[Object(B.jsx)(wt.a,{id:"alert-eliminar-cliente",children:"\xbfEst\xe1 seguro de eliminar esto?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:function(){return m()},color:"inherit",disabled:b,children:"Cancelar"}),Object(B.jsx)(w.a,{onClick:function(){return O()},color:"secondary",disabled:b,startIcon:b?Object(B.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Eliminar"})]})]})]})},il=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},root:{display:"flex",paddingLeft:e.spacing(2)}}})),ol=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function sl(){var e=il(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(""),o=Object(g.a)(i,2),s=o[0],d=o[1],j=function(){r(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{onClick:function(){r(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Fe.h,{className:e.icon})}),"Cliente"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:c,onClose:j,TransitionComponent:ol,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Cliente"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:j,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsx)(p.a,{mx:4,my:3,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:6,xs:8,children:Object(B.jsxs)(Ka.a,{className:e.root,children:[Object(B.jsx)(Zs.a,{fullWidth:!0,placeholder:"Buscar cliente...",onChange:function(e){return d(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&d(e.target.defaultValue)},value:s}),Object(B.jsx)(X.a,{onClick:function(){return d(s)},children:Object(B.jsx)(sc.a,{})})]})}),Object(B.jsx)($e.a,{item:!0,md:6,xs:4,style:{display:"flex",justifyContent:"flex-end"},children:!1===t.accesos.catalogos.clientes.agregar?null:Object(B.jsx)(fo,{tipo:"CLIENTE",accion:"registrar"})})]})}),Object(B.jsx)(p.a,{mx:4,children:Object(B.jsx)(nl,{tipo:"CLIENTE",filtro:s})})]})]})}var ll,dl,jl,ul,bl=a(251),pl=a.n(bl),ml=a(958),Ol=Object(P.d)(ll||(ll=Object(N.a)(["\n\tmutation CrearDescuentoUnidad($input: ObjetoDescuentoUnidadesInput!){\n        crearDescuentoUnidad(input: $input){\n            message\n        }\n  }\n"]))),xl=(Object(P.d)(dl||(dl=Object(N.a)(["\n\tmutation ActualizarDescuentoUnidad($input: ObjetoDescuentoUnidadesInput!){\n        actualizarDescuentoUnidad(input: $input){\n            message\n        }\n    }\n"]))),Object(P.d)(jl||(jl=Object(N.a)(["\n\tmutation DesactivarDescuentoUnidad($input: ActivarDescuentoUnidades , $id: ID!){\n        desactivarDescuentoUnidad(input: $input, id: $id){\n            message\n        }\n    }\n"])))),hl=Object(P.d)(ul||(ul=Object(N.a)(["\n\tmutation ELiminarDescuentoUnidad( $id: ID!){\n        eliminarDescuentoUnidad( id: $id){\n            message\n        }\n    }\n"]))),_l=[{id:"cantidad",label:"Cantidad"},{id:"tipo",label:"Tipo"},{id:"precio",label:"Precio U."},{id:"precioDes",label:"Precio Desc."},{id:"descuento",label:"% Desc."},{id:"eliminar",label:"Eliminar"},{id:"activo",label:"Activo"}];function fl(e){var t=e.onSelectAllClick,a=e.numSelected,n=e.rowCount,c=e.datosPrecios,r=!1;return null===c||void 0===c||c.forEach((function(e){if(e.medida)return r=!0})),Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(Me.a,{indeterminate:a>0&&a<n,checked:n>0&&a===n,onChange:t,inputProps:{"aria-label":"select all desserts"}})}),_l.map((function(e){return Object(B.jsx)(Oa.a,{align:e.numeric?"right":"left",padding:e.disablePadding?"none":"default",children:e.label},e.id)})),!0===r?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Oa.a,{children:"Talla"}),Object(B.jsx)(Oa.a,{children:"Color"})]}):null]})})}var gl=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{height:300},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",display:"flex",justifyContent:"center",alignItems:"center",height:30,width:30,margin:1,borderRadius:"15%",cursor:"pointer"}}}));function vl(e){var t=e.value,a=e.datos,n=e.setCleanList,c=e.cleanList,r=e.verificarDatos,i=e.setPrecioPrueba,o=e.productosRefetch,s=e.setLoading,d=e.loading,j=gl(),u=Object(l.useContext)(fe),b=u.datosPreciosProducto,p=u.setPreciosProductos,m=u.setDatosPreciosProducto,O=Object(l.useState)({message:"",status:"",open:!1}),x=Object(g.a)(O,2),h=x[0],_=x[1],f=parseFloat((100-t).toFixed(6)),v=Object(l.useState)([]),C=Object(g.a)(v,2),y=C[0],S=C[1],F=Object(l.useState)(0),w=Object(g.a)(F,2),I=w[0],k=(w[1],Object(l.useState)(5)),z=Object(g.a)(k,2),N=z[0];z[1];a&&(a.medidas_producto.length>0?m(a.medidas_producto):m(a.unidades_de_venta));var P=function(e,t){var a=y.indexOf(t),n=[];-1===a?n=n.concat(y,t):0===a?n=n.concat(y.slice(1)):a===y.length-1?n=n.concat(y.slice(0,-1)):a>0&&(n=n.concat(y.slice(0,a),y.slice(a+1))),i(0===n.length?0:n),p(n),r(n),S(n)};Object(l.useEffect)((function(){S([]),n(!1)}),[c]);var D=N-Math.min(N,b.length-I*N);return Object(B.jsxs)("div",{className:j.root,children:[Object(B.jsx)(J,{alert:h,setAlert:_}),Object(B.jsxs)(Ka.a,{className:j.paper,children:[Object(B.jsx)(He,{loading:d,setLoading:s}),Object(B.jsx)(ba.a,{className:j.table,children:Object(B.jsxs)(_a.a,{className:j.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"a dense table",children:[Object(B.jsx)(fl,{classes:j,numSelected:y.length,onSelectAllClick:function(e){if(e.target.checked){var t=b.map((function(e){return e}));return S(t),r(t),void p(t)}p([]),S([])},rowCount:b.length,datosPrecios:b}),Object(B.jsxs)(xa.a,{children:[b.map((function(e,n){var c,r=(c=e,-1!==y.indexOf(c)),i="enhanced-table-checkbox-".concat(n);return Object(B.jsx)(Cl,{setLoading:s,productosRefetch:o,handleClick:P,selected:y,row:e,setAlert:_,porcentaje:f,value:t,datos:a,isItemSelected:r,labelId:i},e._id)})),D>0&&Object(B.jsx)(ma.a,{style:{height:53*D},children:Object(B.jsx)(Oa.a,{colSpan:6})})]})]})})]})]})}function Cl(e){var t,a,n,c,r=e.row,i=e.value,o=e.isItemSelected,s=e.setLoading,d=e.datos,j=e.labelId,u=e.setAlert,b=e.porcentaje,p=e.productosRefetch,m=e.handleClick,O=e.selected,x=gl(),h=Object(Se.a)(),_=Object(l.useState)(!1),v=Object(g.a)(_,2),y=v[0],S=v[1],F=Object(l.useContext)(fe).setDatosPreciosProducto,w=Object(z.a)(xl),I=Object(g.a)(w,1)[0],k=Object(z.a)(hl),N=Object(g.a)(k,1)[0],P=function(){var e=Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.prev=1,e.next=4,I({variables:{input:{descuento_activo:!r.descuento_activo},id:r._id}});case 4:s(!1),p(),u({message:"Estado de descuento actualizado",status:"success",open:!0}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),u({message:"Ocurrio un problema en el servidor",status:"error",open:!0});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),D=function(){S(!y),E()},E=function(){d.medidas_producto.length>0?(F(d.medidas_producto),s(!1)):(F(d.unidades_de_venta),s(!1))},A=function(){var e=Object(f.a)(C.a.mark((function e(){var t;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.prev=1,p(),e.next=5,N({variables:{id:r._id}});case 5:t=e.sent,D(),E(),u({message:t.data.eliminarDescuentoUnidad.message,status:"success",open:!0}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),u({message:e.t0.message,status:"error",open:!0});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox","aria-checked":o,tabIndex:-1,selected:o,children:[Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(Me.a,{onClick:function(e){m(e,r)},checked:o,inputProps:{"aria-labelledby":j}})}),Object(B.jsx)(Oa.a,{align:"center",children:r.cantidad}),Object(B.jsx)(Oa.a,{align:"center",children:null===r||void 0===r?void 0:r.unidad}),Object(B.jsx)(Oa.a,{align:"center",children:r.precio}),Object(B.jsx)(Oa.a,{align:"center",children:!0===o&&O.length>1?Object(B.jsxs)("b",{style:{color:"green"},children:[" $",parseFloat((r.precio*b/100).toFixed(2))," "]}):null===r.descuento?0:Object(B.jsxs)("b",{style:{color:"green"},children:[" $",r.descuento.precio_neto," "]})}),Object(B.jsx)(Oa.a,{align:"center",children:!0===o&&O.length>1?Object(B.jsxs)("b",{style:{color:"red"},children:[" ",i,"% "]}):r.descuento&&null!==r.descuento?Object(B.jsxs)("b",{style:{color:"red"},children:[" ",r.descuento.porciento,"% "]}):0}),Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)(yl,{row:r,handleModal:D,openModal:y,handleDelete:A})}),Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)(el.a,{onChange:P,color:"primary",disabled:!r.descuento||0===r.descuento.porciento,defaultChecked:!!r.descuento_activo&&r.descuento_activo,name:"descuento_activo",inputProps:{"aria-label":"secondary checkbox"}},r._id)},r._id),r.medida?Object(B.jsx)(Oa.a,{align:"center",children:null===r||void 0===r||null===(t=r.medida)||void 0===t?void 0:t.talla}):null,r.color?Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)(ha.a,{title:null===r||void 0===r||null===(a=r.color)||void 0===a?void 0:a.nombre,placement:"top",arrow:!0,TransitionComponent:Xa.a,children:Object(B.jsx)("div",{className:x.colorContainer,style:{backgroundColor:null===r||void 0===r||null===(n=r.color)||void 0===n?void 0:n.hex,color:h.palette.getContrastText(null===r||void 0===r||null===(c=r.color)||void 0===c?void 0:c.hex)}})})}):null]},r._id)}var yl=function(e){var t=e.row,a=e.handleModal,n=e.openModal,c=e.handleDelete;return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{color:"secondary",onClick:a,disabled:!t.descuento||0===t.descuento.porciento,children:Object(B.jsx)(ur.a,{})}),Object(B.jsxs)(Ee.a,{open:n,onClose:a,children:[Object(B.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:a,color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:c,children:"Eliminar"})]})]})]})},Sl=Object(k.a)((function(e){return{avatarGroup:{"& > .MuiAvatarGroup-avatar":{width:e.spacing(8),height:e.spacing(8)}},root:{width:400},rootSlice:{width:350},margin:{height:e.spacing(3)},rootTable:{height:300}}}));function Fl(e){var t=e.datos,a=e.productosRefetch,n=Object(z.a)(Ol),c=Object(g.a)(n,1)[0],r=Object(l.useContext)(fe),i=r.setDatosPreciosProducto,o=r.preciosDescuentos,s=r.setPreciosDescuentos,d=r.preciosProductos,j=r.setPreciosProductos,u=t.precios.iva,b=t.precios.ieps,m=t.precios.unidad_de_compra.precio_unitario_sin_impuesto,O=Object(l.useState)({message:"",status:"",open:!1}),x=Object(g.a)(O,2),h=x[0],_=x[1],v=Object(l.useState)(!1),y=Object(g.a)(v,2),I=y[0],k=y[1],N=Object(l.useState)(!1),P=Object(g.a)(N,2),D=P[0],E=P[1],A=Object(l.useState)(!1),T=Object(g.a)(A,1)[0],W=Object(l.useState)(!1),$=Object(g.a)(W,2),R=$[0],V=$[1],M=Object(l.useState)(0),L=Object(g.a)(M,2),U=L[0],q=L[1],G=Object(l.useState)(0),H=Object(g.a)(G,2),Y=H[0],K=H[1],Q=Sl(),Z=function(){t.medidas_producto.length>0?(i(t.medidas_producto),V(!1)):(i(t.unidades_de_venta),V(!1)),q(0),K(0),o.splice(0,o.length)},ee=function(){k(!I),Z()},te=Object(l.useCallback)((function(e){for(var t=0;t<e.length;t++)e[t].descuento&&0!==e[t].descuento.porciento&&(K(e[t].descuento.porciento),1===e.length&&q(e[t].descuento.precio_neto))}),[t]),ae=[];var ne=function(){var e=Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return V(!0),e.prev=1,e.next=4,c({variables:{input:{descuentos:o}}});case 4:Z(),a(),K(0),j([]),s([]),E(!D),_({message:"\xa1Listo descuentos realizados!",status:"success",open:!0}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),_({message:"\xa1Oh no, ocurrio un problema con el servidor!",status:"error",open:!0});case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(J,{alert:h,setAlert:_}),Object(B.jsx)(X.a,{color:function(){if(t.medidas_producto.length>0)for(var e=0;e<t.medidas_producto.length;e++){var a;return!0===(null===(a=t.medidas_producto[e])||void 0===a?void 0:a.descuento_activo)?"primary":"default"}else for(var n=0;n<t.unidades_de_venta.length;n++){var c;return!0===(null===(c=t.unidades_de_venta[n])||void 0===c?void 0:c.descuento_activo)?"primary":"default"}}(),onClick:ee,disabled:t.inventario_general&&t.inventario_general.length>0&&!0===t.inventario_general[0].eliminado,children:Object(B.jsx)(pl.a,{})}),Object(B.jsxs)(Ee.a,{open:I,onClose:Z,fullWidth:!0,maxWidth:"lg",children:[Object(B.jsx)(He,{loading:R,setLoading:V}),Object(B.jsx)(wt.a,{children:Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)(p.a,{flexGrow:1,display:"flex",alignItems:"center",children:"Descuento de Producto"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:ee,size:"large",children:Object(B.jsx)(We.a,{})})})]})}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(p.a,{textAlign:"center",children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Nombre comercial: "}),t.datos_generales.nombre_comercial?t.datos_generales.nombre_comercial:"-"]})}),Object(B.jsx)(p.a,{textAlign:"center",children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Nombre gen\xe9rico: "}),t.datos_generales.nombre_generico?t.datos_generales.nombre_generico:"-"]})}),Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)($e.a,{item:!0,lg:8,md:6,xs:12,children:Object(B.jsx)(p.a,{p:1,children:Object(B.jsx)(vl,{verificarDatos:te,productosRefetch:a,datos:t,value:Y,cleanList:D,setCleanList:E,setPrecioPrueba:q,setLoading:V,loading:R})})}),Object(B.jsxs)($e.a,{item:!0,lg:4,md:6,xs:12,children:[Object(B.jsx)(p.a,{mt:5,dislay:"flex",justifyContent:"center",children:Object(B.jsxs)("div",{className:Q.root,children:[Object(B.jsx)(p.a,{textAlign:"center",children:Object(B.jsx)(S.a,{id:"discrete-slider-always",gutterBottom:!0,children:Object(B.jsx)("b",{children:"Porcentaje de descuento"})})}),Object(B.jsx)(p.a,{my:5}),Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",justifyItems:"center",className:Q.rootSlice,children:Object(B.jsx)(ml.a,{disabled:0===d.length,getAriaValueText:function(e){return"".concat(e)},value:Y.toFixed(2),"aria-labelledby":"discrete-slider-small-steps",valueLabelDisplay:"auto",onChange:function(e,t){K(t),o.splice(0,o.length);for(var a=0;a<d.length;a++){var n,c,r=parseFloat((100-t).toFixed(2)),i=d[a].precio_unidad.cantidad_unidad;n=parseFloat((d[a].precio_unidad.precio_venta*r/100).toFixed(2)),c=parseFloat((d[a].precio_unidad.precio_venta-n).toFixed(2));var l=parseFloat(n*parseFloat("0.".concat(u<10?"0".concat(u):u)).toFixed(2)),j=parseFloat(n*parseFloat("0.".concat(b<10?"0".concat(b):b)).toFixed(2)),p=parseFloat(((n-m)/m*100).toFixed(2)),O=parseFloat((n+l+j).toFixed(2)),x=parseFloat((O*i).toFixed(2));ae={_id:d[a]._id,descuento_activo:!0,descuento:{cantidad_unidad:i,numero_precio:d[a].precio_unidad.numero_precio,unidad_maxima:d[a].precio_unidad.unidad_maxima,precio_general:x,precio_neto:O,precio_venta:n,iva_precio:l,ieps_precio:j,utilidad:p,porciento:t,dinero_descontado:c}},q(O),1!==d.length?o.push(ae):s([ae])}}})})]})}),Object(B.jsx)(p.a,{mt:5,display:"flex",justifyContent:"center",children:1===d.length?Object(B.jsxs)("div",{children:[Object(B.jsx)(S.a,{children:"Precio con Descuento"}),Object(B.jsx)(F.a,{type:"number",InputProps:{inputProps:{min:0}},size:"small",variant:"outlined",value:U,onChange:function(e){return function(e){var t=parseFloat(e.target.value);if(1===d.length){q(t);var a,n,c=parseFloat("0.".concat(u<10?"0".concat(u):u))+parseFloat("0.".concat(b<10?"0".concat(b):b)),r=parseFloat((t/(c+1)).toFixed(2)),i=d[0].precio_unidad.cantidad_unidad,o=parseFloat((r/d[0].precio_unidad.precio_venta*100).toFixed(2)),l=parseFloat((100-o).toFixed(2));n=parseFloat((d[0].precio_unidad.precio_venta*o/100).toFixed(2)),a=parseFloat((d[0].precio_unidad.precio_venta-n).toFixed(2));var j=parseFloat(n*parseFloat("0.".concat(u<10?"0".concat(u):u)).toFixed(2)),p=parseFloat(n*parseFloat("0.".concat(b<10?"0".concat(b):b)).toFixed(2)),O=parseFloat(((n-m)/m*100).toFixed(2)),x=parseFloat((n+j+p).toFixed(2)),h=parseFloat((x*i).toFixed(2));ae={_id:d[0]._id,descuento_activo:!0,descuento:{cantidad_unidad:i,numero_precio:d[0].precio_unidad.numero_precio,unidad_maxima:d[0].precio_unidad.unidad_maxima,precio_general:h,precio_neto:x,precio_venta:n,iva_precio:j,ieps_precio:p,utilidad:O,porciento:l,dinero_descontado:a}},K(l),s([ae])}}(e)}})]}):null}),Object(B.jsx)(p.a,{mt:2,display:"flex",justifyContent:"center",children:Object(B.jsx)(w.a,{disabled:0===d.length||!0===T,variant:"contained",color:"primary",size:"large",onClick:ne,children:"Guardar"})})]})]})]})]})]})}var wl=Object(l.forwardRef)((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Il(e){var t=e.datos,a=e.productosRefetch,n=Object(l.useState)(!1),c=Object(g.a)(n,2),r=c[0],i=c[1],o=Object(l.useState)(!1),s=Object(g.a)(o,2),d=s[0],j=s[1],u=(JSON.parse(localStorage.getItem("sesionCafi")),Object(l.useContext)(fe)),b=u.actualizarLista,p=u.setActualizarLista,m=u.setAlert,O=Object(z.a)(Dn),x=Object(g.a)(O,1)[0],h=function(){return i(!r)},_=function(){var e=Object(f.a)(C.a.mark((function e(){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.prev=1,e.next=4,x({variables:{id:t._id}});case 4:n=e.sent,p(!b),a(),m({message:"\xa1Listo! ".concat(n.data.eliminarProducto.message),status:"success",open:!0}),j(!1),h(),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),m({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),j(!1),h();case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(X.a,{onClick:function(){return h()},disabled:!(!t.inventario_general||0!==t.inventario_general.length)||!0===t.inventario_general[0].eliminado,children:Object(B.jsx)(ur.a,{color:t.inventario_general&&0===t.inventario_general.length||!0===t.inventario_general[0].eliminado?"disabled":"error"})}),Object(B.jsxs)(Ee.a,{open:r,TransitionComponent:wl,keepMounted:!0,onClose:function(){return h()},"aria-labelledby":"alert-dialog-delete-producto",children:[Object(B.jsx)(wt.a,{id:"alert-dialog-delete-producto",children:"\xbfEst\xe1s seguro de eliminar este producto?"}),Object(B.jsxs)(Ue.a,{style:{display:"flex",justifyContent:"center"},children:[Object(B.jsx)(w.a,{onClick:function(){return h()},color:"inherit",children:"Cancelar"}),Object(B.jsx)(w.a,{onClick:function(){return _()},color:"secondary",startIcon:d?Object(B.jsx)(I.a,{color:"inherit",size:20}):null,children:"Eliminar"})]})]})]})}var kl=Object(k.a)({root:{width:"100%"},container:{maxHeight:"70vh","& ::-webkit-scrollbar":{display:"none"}},avatar:{width:130,height:130}});function zl(e){var t=e.obtenerProductos,a=e.productosRefetch,n=kl();return Object(B.jsx)("div",{className:n.root,children:Object(B.jsx)(ba.a,{className:n.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,"aria-label":"sticky table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Codigo barras"}),Object(B.jsx)(Oa.a,{children:"Clave alterna"}),Object(B.jsx)(Oa.a,{children:"Nombre comercial"}),Object(B.jsx)(Oa.a,{children:"Existencia"}),Object(B.jsx)(Oa.a,{children:"Tipo"}),Object(B.jsx)(Oa.a,{children:"Editar"}),Object(B.jsx)(Oa.a,{children:"Descuento"}),Object(B.jsx)(Oa.a,{children:"Eliminar"})]})}),Object(B.jsx)(xa.a,{className:"hide-scroll",children:t.map((function(e,t){return Object(B.jsx)(Nl,{producto:e,productosRefetch:a},t)}))})]})})})}var Nl=function(e){var t=e.producto,a=e.productosRefetch,n=JSON.parse(localStorage.getItem("sesionCafi"));return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:t.datos_generales.codigo_barras}),Object(B.jsx)(Oa.a,{children:t.datos_generales.clave_alterna}),Object(B.jsx)(Oa.a,{children:t.datos_generales.nombre_comercial}),Object(B.jsx)(Oa.a,{children:t.inventario_general.map((function(e){return"".concat(e.cantidad_existente," ").concat(e.unidad_inventario)}))}),Object(B.jsx)(Oa.a,{children:t.datos_generales.tipo_producto}),Object(B.jsx)(Oa.a,{align:"center",padding:"checkbox",children:!1===n.accesos.catalogos.productos.editar?null:Object(B.jsx)(qi,{accion:!0,datos:t,productosRefetch:a})}),Object(B.jsx)(Oa.a,{align:"center",padding:"checkbox",children:Object(B.jsx)(Fl,{datos:t,productosRefetch:a})}),Object(B.jsx)(Oa.a,{align:"center",padding:"checkbox",children:!1===n.accesos.catalogos.productos.agregar?null:Object(B.jsx)(Il,{datos:t,productosRefetch:a})})]})})},Pl=a(927),Dl=a(925),El=a(926),Al=Object(l.forwardRef)((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Tl(e){var t=e.productosActivosRefetch,a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=function(){return r(!c)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{disableElevation:!0,color:"primary",onClick:i,size:"large",startIcon:Object(B.jsx)(Dl.a,{}),children:"Productos inactivos"}),Object(B.jsxs)(Ee.a,{open:c,TransitionComponent:Al,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&i()},"aria-labelledby":"dialog-productos-eliminados",maxWidth:"md",fullWidth:!0,children:[Object(B.jsx)(wt.a,{id:"dialog-productos-eliminados",children:Object(B.jsxs)(p.a,{display:"flex",justifyContent:"space-between",children:[Object(B.jsx)(S.a,{variant:"h6",children:"Productos inactivos"}),Object(B.jsx)(w.a,{variant:"contained",onClick:i,color:"secondary",children:Object(B.jsx)(Pt.a,{})})]})}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(Wl,{productosActivosRefetch:t})})]})]})}var Wl=function(e){var t=e.productosActivosRefetch,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(l.useContext)(fe).actualizarLista,c=Object(qe.a)(En,{variables:{sucursal:a.sucursal._id,empresa:a.empresa._id}}),r=c.loading,i=c.data,o=c.error,s=c.refetch;if(Object(l.useEffect)((function(){s()}),[s,n]),r)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})});if(o)return Object(B.jsx)(Ze,{error:o});if(!r&&!o&&!i)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(S.a,{variant:"h6",children:"No hay productos inactivos"})});var d=i.obtenerProductosInactivos;return Object(B.jsx)(p.a,{height:"60vh",children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{"aria-label":"simple table",size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{align:"left",children:"C\xf3digo de barras"}),Object(B.jsx)(Oa.a,{align:"left",children:"Clave alterna"}),Object(B.jsx)(Oa.a,{children:"Nombre comercial"}),Object(B.jsx)(Oa.a,{align:"right",children:"Reactivar"})]})}),Object(B.jsx)(xa.a,{children:d.map((function(e,a){return Object(B.jsx)($l,{datos:e,refetch:s,productosActivosRefetch:t},a)}))})]})})})},$l=function(e){var t=e.datos,a=e.refetch,n=e.productosActivosRefetch,c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)(!1),d=Object(g.a)(s,2),j=d[0],u=d[1],b=t.producto.datos_generales,p=Object(l.useContext)(fe).setAlert,m=Object(z.a)(An),O=Object(g.a)(m,1)[0],x=function(){return o(!i)},h=function(){var e=Object(f.a)(C.a.mark((function e(){var c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,O({variables:{id:t._id}});case 4:c=e.sent,a(),n(),p({message:"\xa1Listo! ".concat(c.data.activarProducto.message),status:"success",open:!0}),u(!1),x(),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),p({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),u(!1);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{align:"left",children:b.codigo_barras}),Object(B.jsx)(Oa.a,{align:"left",children:b.clave_alterna}),Object(B.jsx)(Oa.a,{children:b.nombre_comercial}),Object(B.jsx)(Oa.a,{align:"right",children:j?Object(B.jsx)(X.a,{color:"primary",disabled:!0,onClick:x,children:Object(B.jsx)(I.a,{size:26})}):Object(B.jsx)(X.a,{color:"primary",onClick:x,children:Object(B.jsx)(El.a,{})})})]}),Object(B.jsxs)(Ee.a,{open:i,onClose:x,"aria-labelledby":"reactivar-producto-dialog",children:[Object(B.jsx)(wt.a,{id:"reactivar-producto-dialog",children:"Se reactivar\xe1 este producto"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:x,color:"inherit",children:"Cancelar"}),Object(B.jsx)(w.a,{onClick:function(){return h()},color:"primary",autoFocus:!0,children:"Aceptar"})]})]})]})},Rl=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},iconSvg:{width:100},root:{flexGrow:1,backgroundColor:e.palette.background.paper}}})),Vl=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Ml(){var e=Rl(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=Object(l.useContext)(fe),i=r.alert,o=r.setAlert,s=function(){c(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/productos.svg",alt:"icono ropa",className:e.iconSvg})}),"Productos"]})}),Object(B.jsx)(J,{alert:i,setAlert:o}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:s,TransitionComponent:Vl,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Productos"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:s,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsx)(Ll,{})]})]})}var Ll=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(l.useState)(""),a=Object(g.a)(t,2),n=a[0],c=a[1],r=Object(l.useState)(""),i=Object(g.a)(r,2),o=i[0],s=i[1],d=Object(l.useState)(!0),j=Object(g.a)(d,2),u=j[0],b=j[1],m=Object(l.useState)(0),O=Object(g.a)(m,2),x=O[0],h=O[1],_=Rl(),f=Object(qe.a)(Nn,{variables:{sucursal:e.sucursal._id,empresa:e.empresa._id,filtro:n,existencias:u},fetchPolicy:"network-only"}),v=f.loading,C=f.data,y=f.error,S=f.refetch;if(v)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})});if(y)return Object(B.jsx)(Ze,{error:y});var F=C.obtenerProductos;return Object(B.jsxs)("div",{children:[Object(B.jsxs)(p.a,{mx:4,my:3,display:"flex",children:[Object(B.jsx)(p.a,{style:{width:"500px"},children:Object(B.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),""===o)return c(""),void S({filtro:""});c(o)},style:{display:"flex",alignItems:"center"},children:[Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsx)(K.a,{id:"search-producto",type:"text",value:o,onChange:function(e){return s(e.target.value)},endAdornment:Object(B.jsx)(Q.a,{position:"start",children:Object(B.jsx)(X.a,{type:"submit","aria-label":"search producto",edge:"end",children:Object(B.jsx)(sc.a,{})})})})}),""!==n?Object(B.jsx)(X.a,{color:"primary",onClick:function(){return s(""),c(""),void S({filtro:""})},children:Object(B.jsx)(Pl.a,{})}):null]})}),Object(B.jsx)(p.a,{flexGrow:1}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(Tl,{productosActivosRefetch:S}),Object(B.jsx)(p.a,{mx:1}),!1===e.accesos.catalogos.productos.agregar?null:Object(B.jsx)(qi,{accion:!1,productosRefetch:S})]})]}),Object(B.jsxs)(p.a,{mx:4,children:[Object(B.jsx)("div",{className:_.root,children:Object(B.jsxs)(ke.a,{indicatorColor:"primary",value:x,onChange:function(e,t){h(t),b(0===t)},"aria-label":"simple tabs example",children:[Object(B.jsx)(ze.a,{label:"Productos de Sucursal"}),Object(B.jsx)(ze.a,{label:"Todos los productos"})]})}),Object(B.jsx)(zl,{obtenerProductos:F,productosRefetch:S})]})]})};function Ul(){return Object(B.jsx)(ge,{children:Object(B.jsx)(Ml,{})})}var Bl=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"50vh"}}}));function ql(e){var t=e.tipo,a=e.datos,n=e.toUpdate,c=e.setToUpdate,r=e.setValue,i=e.refetch,o=JSON.parse(localStorage.getItem("sesionCafi")),s=Bl(),d=Object(l.useState)(""),j=Object(g.a)(d,2),u=j[0],b=j[1],m=Object(l.useState)([]),O=Object(g.a)(m,2),x=O[0],h=O[1],_=Object(l.useState)({status:"",message:"",open:!1}),f=Object(g.a)(_,2),v=f[0],C=f[1];return Object(l.useEffect)((function(){h(a.filter((function(e){return e.talla.toLowerCase().includes(u.toLowerCase())})))}),[u,a]),Object(B.jsxs)("div",{className:s.root,children:[Object(B.jsx)(J,{alert:v,setAlert:C}),Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",mb:1,children:Object(B.jsx)(F.a,{fullWidth:!0,placeholder:"Buscar...",variant:"outlined",size:"small",onChange:function(e){return b(e.target.value)}})}),Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{className:s.container,children:Object(B.jsxs)(_a.a,{className:s.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"ROPA"===t?"Talla":"N\xfamero"}),!1===o.accesos.catalogos.tallas_numeros.editar?null:Object(B.jsx)(Oa.a,{padding:"default",children:"Editar"}),!1===o.accesos.catalogos.tallas_numeros.eliminar?null:Object(B.jsx)(Oa.a,{padding:"default",children:"Eliminar"})]})}),Object(B.jsx)(xa.a,{children:x.map((function(e,a){return Object(B.jsx)(Jl,{row:e,setAlert:C,tipo:t,toUpdate:n,setToUpdate:c,setValue:r,refetch:i},a)}))})]})})})]})}var Jl=function(e){var t=e.row,a=e.setAlert,n=e.tipo,c=e.toUpdate,r=e.setToUpdate,i=e.setValue,o=e.refetch,s=JSON.parse(localStorage.getItem("sesionCafi")),d=Object(l.useState)(!1),j=Object(g.a)(d,2),u=j[0],b=j[1],p=function(){return b(!u)},m=Object(z.a)(Jn),O=Object(g.a)(m,1)[0],x=function(){var e=Object(f.a)(C.a.mark((function e(){var c,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O({variables:{id:t._id,input:{tipo:n,talla:""}}});case 3:c=e.sent,r={message:c.data.eliminarTalla.message,status:"success",open:!0},a(r),o(),p(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),p(),a({message:e.t0.message,status:"error",open:!0});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),h=function(e){if(!e)return r(""),void i("");r(e._id),i(e.talla)};return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)(ma.a,{role:"checkbox",tabIndex:-1,selected:c===t._id,children:[Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:t.talla})})}),!1===s.accesos.catalogos.tallas_numeros.editar?null:Object(B.jsx)(Oa.a,{padding:"checkbox",children:c===t._id?Object(B.jsx)(X.a,{onClick:function(){return h()},children:Object(B.jsx)(Pt.a,{})}):Object(B.jsx)(X.a,{onClick:function(){return h(t)},children:Object(B.jsx)(en.a,{})})}),!1===s.accesos.catalogos.tallas_numeros.eliminar?null:Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(Gl,{handleModal:p,openModal:u,handleDelete:x})})]})})},Gl=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete;return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{color:"secondary",onClick:t,children:Object(B.jsx)(ur.a,{})}),Object(B.jsxs)(Ee.a,{open:a,onClose:t,children:[Object(B.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"Eliminar"})]})]})]})};function Hl(e){var t=e.tipo,a=Object(l.useState)(""),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(""),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)({message:"",status:"",open:!1}),u=Object(g.a)(j,2),b=u[0],m=u[1],O=JSON.parse(localStorage.getItem("sesionCafi")),x=Object(l.useState)({loading:!1,tipo:""}),h=Object(g.a)(x,2),_=h[0],v=h[1],y=Object(qe.a)(Bn,{variables:{empresa:O.empresa._id,tipo:t}}),S=y.loading,k=y.data,N=y.error,P=y.refetch,D=Object(z.a)(Un),E=Object(g.a)(D,1)[0],A=Object(z.a)(qn),T=Object(g.a)(A,1)[0];if(S)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})});if(N)return Object(B.jsx)(Ze,{error:N});var W=k.obtenerTallas,$=function(){var e=Object(f.a)(C.a.mark((function e(a){var n,i,o,l;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),c){e.next=3;break}return e.abrupt("return");case 3:if(v({loading:!0,tipo:t}),e.prev=4,i=c,!s){e.next=17;break}if(!1!==O.accesos.catalogos.tallas_numeros.editar){e.next=11;break}return e.abrupt("return",m({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 11:return o=wa(i),e.next=14,T({variables:{input:{talla:o,tipo:t},id:s}});case 14:n=e.sent;case 15:e.next=24;break;case 17:if(!1!==O.accesos.catalogos.tallas_numeros.agregar){e.next=21;break}return e.abrupt("return",m({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 21:return e.next=23,E({variables:{input:{talla:i,tipo:t,empresa:O.empresa._id,sucursal:O.sucursal._id}}});case 23:n=e.sent;case 24:P(),r(""),d(""),v({loading:!1,tipo:""}),l=s?{message:n.data.actualizarTalla.message,status:"success",open:!0}:{message:n.data.crearTalla.message,status:"success",open:!0},m(l),e.next=39;break;case 32:if(e.prev=32,e.t0=e.catch(4),v({loading:!1,tipo:""}),!e.t0.message){e.next=38;break}return m({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 38:m({message:"Hubo un error",status:"error",open:!0});case 39:case"end":return e.stop()}}),e,null,[[4,32]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(p.a,{children:[Object(B.jsx)(J,{alert:b,setAlert:m}),Object(B.jsx)(p.a,{my:2,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,justifyContent:"center",children:[Object(B.jsx)($e.a,{item:!0,children:"ROPA"===t?Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/shirt.svg",alt:"icono tallas",style:{width:40}}):Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/shoes.svg",alt:"icono numeros",style:{width:40}})}),Object(B.jsx)($e.a,{item:!0,children:Object(B.jsx)("form",{id:"form-talla",onSubmit:$,children:Object(B.jsx)(F.a,{id:"outlined-error-helper-text",label:"ROPA"===t?"Talla":"N\xfamero",variant:"outlined",size:"small",value:c,onChange:function(e){return r(e.target.value)},inputProps:{style:{textTransform:"uppercase"}},disabled:_.loading})})}),Object(B.jsx)($e.a,{item:!0,children:Object(B.jsx)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,type:"submit",form:"form-talla",disabled:_.loading&&_.tipo===t,startIcon:_.loading&&_.tipo===t?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(It.a,{}),children:"Guardar"})})]})}),Object(B.jsx)(ql,{datos:W,tipo:t,toUpdate:s,setToUpdate:d,setValue:r,refetch:P})]})}var Yl=a(467),Kl=a.n(Yl),Ql=Object(k.a)((function(e){return{snack:{zIndex:"".concat(99999,"!important")}}}));function Xl(e){var t=e.texto,a=(e.width,Ql(),Object(l.useState)(!1)),n=Object(g.a)(a,2),c=n[0],r=n[1];return Object(B.jsxs)(p.a,{children:[Object(B.jsx)(w.a,{variant:"outline",color:"secondary",onClick:function(){return r(!0)},size:"large",children:Object(B.jsx)(Kl.a,{style:{fontSize:35,color:"white"}})}),Object(B.jsx)(R.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:c,onClose:function(){r(!1)},autoHideDuration:1e4,message:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{mr:1}),Object(B.jsx)(S.a,{children:t})]})})]})}var Zl,ed,td,ad,nd=Object(k.a)((function(e){return{root:{flexGrow:1,width:"100%",height:"100vh",backgroundColor:e.palette.background.paper},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},iconSvg:{width:100},icon:{fontSize:100}}})),cd=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function rd(){var e=nd(),t=Object(l.useState)(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){return c(!n)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:r,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/tallas.svg",alt:"icono ropa",className:e.iconSvg})}),"Tallas y numeros"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:cd,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Tallas y n\xfameros"}),Object(B.jsxs)(p.a,{m:1,flexDirection:"row",display:"flex",children:[Object(B.jsx)(Xl,{texto:"En este apartado se registran las  tallas y/o n\xfameros que se asignar\xe1n a un producto tipo Ropa o Calzado seg\xfan sea el caso ."}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})]})}),Object(B.jsx)(y.a,{children:Object(B.jsx)(p.a,{children:Object(B.jsxs)($e.a,{container:!0,spacing:5,children:[Object(B.jsx)($e.a,{item:!0,md:6,xs:12,children:Object(B.jsx)(Hl,{tipo:"ROPA"})}),Object(B.jsx)($e.a,{item:!0,md:6,xs:12,children:Object(B.jsx)(Hl,{tipo:"CALZADO"})})]})})})]})]})}var id=Object(P.d)(Zl||(Zl=Object(N.a)(["\n    query obtenerContabilidad($empresa: ID!){\n        obtenerContabilidad(empresa: $empresa){\n                _id\n            nombre_servicio\n            empresa{\n                _id\n                nombre_empresa\n            }\n                sucursal{\n                _id\n                nombre_sucursal\n            }\n        }\n    }\n"]))),od=Object(P.d)(ed||(ed=Object(N.a)(["\n    mutation CrearContabilidad($input: ContabilidadInput, $empresa: ID!, $sucursal: ID!, $usuario: ID!){\n        crearContabilidad(input:$input,empresa:$empresa,sucursal:$sucursal, usuario:$usuario){\n            message\n        }\n    }\n"]))),sd=Object(P.d)(td||(td=Object(N.a)(["\n    mutation ActualizarContabilidad($input: ContabilidadInput, $id: ID!){\n        actualzarContabilidad(input: $input, id: $id){\n            message\n        }\n    }\n"]))),ld=Object(P.d)(ad||(ad=Object(N.a)(["\n    mutation EliminarContabilidad($id: ID!){\n        eliminarContabilidad(id: $id){\n            message\n        }\n    }\n"]))),dd=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"55vh"}}}));function jd(e){var t=e.setData,a=e.setIdService,n=e.idService,c=e.setAccion,r=e.updateData,i=e.setAlert,o=dd(),s=JSON.parse(localStorage.getItem("sesionCafi")),d=Object(l.useState)(!1),j=Object(g.a)(d,2),u=j[0],b=j[1],m=function(){return b(!u)},O=[],x=Object(qe.a)(id,{variables:{empresa:s.empresa._id}}),h=x.loading,_=x.data,v=x.error,y=x.refetch,S=Object(z.a)(ld),F=Object(g.a)(S,1)[0];Object(l.useEffect)((function(){y()}),[r,y]),_&&(O=_.obtenerContabilidad);var w=function(){var e=Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F({variables:{id:n}});case 3:y(),i({message:"\xa1Listo!",status:"success",open:!0}),m(),a(""),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),i({message:e.t0.message,status:"error",open:!0});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return v?Object(B.jsx)(Ze,{error:v}):h?Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})}):Object(B.jsxs)("div",{className:o.root,children:[Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{className:o.container,children:Object(B.jsxs)(_a.a,{className:o.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Servicios"}),!1===s.accesos.catalogos.contabilidad.editar?null:Object(B.jsx)(Oa.a,{padding:"default",children:"Editar"}),!1===s.accesos.catalogos.contabilidad.eliminar?null:Object(B.jsx)(Oa.a,{padding:"default",children:"Eliminar"})]})}),Object(B.jsx)(xa.a,{children:O.map((function(e,n){return Object(B.jsxs)(ma.a,{role:"checkbox",tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:e.nombre_servicio}),!1===s.accesos.catalogos.contabilidad.editar?null:Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(X.a,{onClick:function(){c(!1),a(e._id),t({nombre_servicio:e.nombre_servicio})},children:Object(B.jsx)(en.a,{})})}),!1===s.accesos.catalogos.contabilidad.eliminar?null:Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(X.a,{onClick:function(){a(e._id),m()},children:Object(B.jsx)(ur.a,{})})})]},e._id)}))})]})})}),Object(B.jsx)(ud,{handleModal:m,openModal:u,handleDelete:w})]})}var ud=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete;return Object(B.jsx)("div",{children:Object(B.jsxs)(Ee.a,{open:a,onClose:t,children:[Object(B.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"Eliminar"})]})]})})},bd=Object(k.a)({root:{width:"100%"},flexGrow:{flexGrow:1}});function pd(){var e=bd(),t=Object(l.useState)(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=Object(l.useState)({nombre_servicio:""}),i=Object(g.a)(r,2),o=i[0],s=i[1],d=Object(l.useState)({message:"",status:"",open:!1}),j=Object(g.a)(d,2),u=j[0],m=j[1],O=Object(l.useState)(!1),x=Object(g.a)(O,2),h=x[0],v=x[1],y=JSON.parse(localStorage.getItem("sesionCafi")),k=Object(l.useState)(!0),N=Object(g.a)(k,2),P=N[0],D=N[1],E=Object(l.useState)(""),A=Object(g.a)(E,2),T=A[0],W=A[1],$=Object(l.useState)(!1),R=Object(g.a)($,2),V=R[0],M=R[1],L=Object(z.a)(od),U=Object(g.a)(L,1)[0],q=Object(z.a)(sd),G=Object(g.a)(q,1)[0],H=function(){var e=Object(f.a)(C.a.mark((function e(t){var a,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),o.nombre_servicio){e.next=3;break}return e.abrupt("return");case 3:if(e.prev=3,M(!0),o.nombre_servicio){e.next=10;break}return v(!0),e.abrupt("return");case 10:if(a=o,!P){e.next=20;break}if(!1!==y.accesos.catalogos.contabilidad.agregar){e.next=16;break}return e.abrupt("return",m({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 16:return e.next=18,U({variables:{input:a,empresa:y.empresa._id,sucursal:y.sucursal._id,usuario:y._id}});case 18:e.next=28;break;case 20:if(!1!==y.accesos.catalogos.contabilidad.editar){e.next=24;break}return e.abrupt("return",m({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 24:return r=wa(a),e.next=27,G({variables:{input:r,id:T}});case 27:D(!0);case 28:m({message:"\xa1Listo!",status:"success",open:!0}),s({nombre_servicio:""}),c(!n),W(""),M(!1);case 33:e.next=42;break;case 35:if(e.prev=35,e.t0=e.catch(3),M(!1),!e.t0.message){e.next=41;break}return m({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 41:m({message:"Hubo un error",status:"error",open:!0});case 42:case"end":return e.stop()}}),e,null,[[3,35]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{className:e.root,children:[Object(B.jsx)(J,{alert:u,setAlert:m}),Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Tipo de Servicio"})}),Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",mb:2,children:[Object(B.jsx)("form",{id:"form-contabilidad",onSubmit:H,children:Object(B.jsx)(F.a,{error:h,id:"outlined-error-helper-text",variant:"outlined",size:"small",name:"nombre_servicio",value:o.nombre_servicio,onChange:function(e){s(Object(b.a)(Object(b.a)({},o),{},Object(_.a)({},e.target.name,e.target.value)))},inputProps:{style:{textTransform:"uppercase",width:"400px"}},disabled:V})}),Object(B.jsx)(p.a,{ml:1}),Object(B.jsx)(w.a,{color:"primary",variant:"contained",size:"large",type:"submit",form:"form-contabilidad",disableElevation:!0,startIcon:V?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(It.a,{}),children:"Guardar"})]}),Object(B.jsx)(jd,{setData:s,idService:T,setIdService:W,setAccion:D,updateData:n,setAlert:m})]})}var md=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),Od=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function xd(){var e=md(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/contabilidad.svg",alt:"icono numero calzado",className:e.icon})}),"Contabilidad"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Od,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Contabilidad"}),Object(B.jsxs)(p.a,{m:1,display:"flex",flexDirection:"row",children:[Object(B.jsx)(Xl,{texto:"En este apartado se registran conceptos para pagos."}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})]})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(y.a,{maxWidth:"md",children:Object(B.jsx)(pd,{})})})]})]})}var hd=[{id:1,label:"No. Cliente",minWidth:100},{id:2,label:"Clave",minWidth:100},{id:3,label:"Nombre",minWidth:150},{id:4,label:"Razon Social",minWidth:150},{id:5,label:"Correo",minWidth:150},{id:6,label:"Fecha registro",minWidth:100},{id:7,label:"Estado",minWidth:100}],_d=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),fd=Object(k.a)({root:{width:"100%"},container:{height:"74vh"},avatar:{width:130,height:130}});function gd(e){var t=e.obtenerClientes,a=e.refetch,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(l.useState)({message:"",status:"",open:!1}),r=Object(g.a)(c,2),i=r[0],o=r[1],s=fd();return Object(B.jsxs)(Ka.a,{className:s.root,variant:"outlined",children:[Object(B.jsx)(J,{alert:i,setAlert:o}),Object(B.jsx)(ba.a,{className:s.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,"aria-label":"sticky table",size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[hd.map((function(e){return Object(B.jsx)(Oa.a,{align:e.align,children:e.label},e.id)})),!1===n.accesos.catalogos.provedores.editar?null:Object(B.jsx)(Oa.a,{align:"right",children:"Editar"},9),!1===n.accesos.catalogos.provedores.eliminar?null:Object(B.jsx)(Oa.a,{align:"right",children:"Eliminar"},10)]})}),Object(B.jsx)(xa.a,{children:t.map((function(e,t){return Object(B.jsx)(vd,{datos:e,setAlert:o,refetch:a},t)}))})]})})]})}var vd=function(e){var t=e.datos,a=e.setAlert,n=e.refetch,c=JSON.parse(localStorage.getItem("sesionCafi"));return Object(B.jsxs)(ma.a,{role:"checkbox",tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.numero_cliente})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.clave_cliente})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.nombre_cliente})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.razon_social})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.email})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:Sa(t.fecha_registro)})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.estado_cliente?"Activo":"Inactivo"})}),!1===c.accesos.catalogos.provedores.editar?null:Object(B.jsx)(Oa.a,{width:50,children:Object(B.jsx)(fo,{tipo:"PRROVEEDOR",accion:"actualizar",datos:t,refetch:n})}),!1===c.accesos.catalogos.provedores.eliminar?null:Object(B.jsx)(Oa.a,{width:50,children:Object(B.jsx)(Cd,{datos:t,setAlert:a,refetch:n})})]})},Cd=function(e){var t=e.datos,a=e.setAlert,n=e.refetch,c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(z.a)(ho),d=Object(g.a)(s,1)[0],j=Object(l.useState)(!1),u=Object(g.a)(j,2),b=u[0],p=u[1],m=function(){o(!1)},O=function(){var e=Object(f.a)(C.a.mark((function e(){var c,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,d({variables:{id:t._id}});case 4:(c=e.sent)&&(r=c.data.eliminarCliente.message,a({message:r,status:"success",open:!0}),n()),p(!1),m(),e.next=18;break;case 10:if(e.prev=10,e.t0=e.catch(1),console.log(e.t0),p(!1),!e.t0.message){e.next=17;break}return a({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 17:a({message:"Hubo un error",status:"error",open:!0});case 18:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{color:"secondary",onClick:function(){o(!0)},children:Object(B.jsx)(ur.a,{})}),Object(B.jsxs)(Ee.a,{open:i,TransitionComponent:_d,keepMounted:!0,onClose:function(){return m()},"aria-labelledby":"alert-eliminar-cliente",children:[Object(B.jsx)(wt.a,{id:"alert-eliminar-cliente",children:"\xbfEst\xe1 seguro de eliminar esto?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:function(){return m()},color:"inherit",disabled:b,children:"Cancelar"}),Object(B.jsx)(w.a,{onClick:function(){return O()},color:"secondary",disabled:b,startIcon:b?Object(B.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Eliminar"})]})]})]})},yd=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},root:{display:"flex",paddingLeft:e.spacing(2)}}})),Sd=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Fd(){var e=yd(),t=Object(l.useState)(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/distribution.svg",alt:"icono numero calzado",className:e.icon})}),"Proveedores"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Sd,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Proveedores"}),Object(B.jsxs)(p.a,{m:1,display:"flex",flexDirection:"row",children:[Object(B.jsx)(Xl,{texto:"En este apartado se registran los proveedores que se podr\xe1n seleccionar en la compra de un producto."}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})]})}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(Td,{})})]})]})}var wd,Id,kd,zd,Nd,Pd,Dd,Ed,Ad,Td=function(){var e=yd(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(l.useState)(""),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(""),o=Object(g.a)(i,2),s=o[0],d=o[1],j=JSON.parse(localStorage.getItem("sesionCafi")),u=Object(qe.a)(Oo,{variables:{tipo:"PROVEEDOR",filtro:c,empresa:j.empresa._id,eliminado:!1},fetchPolicy:"network-only"}),b=u.loading,m=u.data,O=u.error,x=u.refetch;if(b)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})});if(O)return Object(B.jsx)(Ze,{error:O});var h=m.obtenerClientes;return Object(B.jsxs)(p.a,{my:3,children:[Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:6,xs:8,children:Object(B.jsxs)(Ka.a,{className:e.root,children:[Object(B.jsx)(Zs.a,{fullWidth:!0,placeholder:"Buscar proveedor...",onChange:function(e){return d(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&r(e.target.defaultValue)},value:s}),Object(B.jsx)(X.a,{onClick:function(){return r(s)},children:Object(B.jsx)(sc.a,{})})]})}),Object(B.jsx)($e.a,{item:!0,md:6,xs:4,style:{display:"flex",justifyContent:"flex-end"},children:!1===t.accesos.catalogos.provedores.ver?null:Object(B.jsx)(fo,{tipo:"PROVEEDOR",accion:"registrar",refetch:x})})]}),Object(B.jsx)(p.a,{mt:3,children:Object(B.jsx)(gd,{obtenerClientes:h,refetch:x})})]})},Wd=Object(P.d)(wd||(wd=Object(N.a)(["\n    mutation CrearCaja($input: CrearCajasInput!, $empresa: ID!, $sucursal: ID!){\n        crearCaja(input: $input, empresa: $empresa, sucursal: $sucursal){\n            message\n        }\n    }\n"]))),$d=Object(P.d)(Id||(Id=Object(N.a)(["\n    query ObtenerCajasSucursales($empresa: ID!, $sucursal: ID!){\n        obtenerCajasSucursal(empresa: $empresa, sucursal: $sucursal){\n            _id\n            numero_caja\n            activa\n            usuario_creador {\n            numero_usuario\n            nombre\n            email\n            }\n            cantidad_efectivo_actual\n            usuario_en_caja {\n            _id\n            numero_usuario\n            nombre\n            email\n            }\n             \n        }\n    }\n"]))),Rd=Object(P.d)(kd||(kd=Object(N.a)(["\n    mutation CrearHistorialCaja($input: CrearHistorialCajasInput!, $empresa: ID!, $sucursal: ID!){\n        crearHistorialCaja(input: $input, empresa: $empresa, sucursal: $sucursal){\n            message\n        }\n    }\n"]))),Vd=Object(P.d)(zd||(zd=Object(N.a)(["\n    query ObtenerHistorialCaja($input: HistorialCajasInput, $id_Caja: ID!,$empresa: ID!, $sucursal: ID!){\n        obtenerHistorialCaja(input: $input, id_Caja: $id_Caja,empresa: $empresa, sucursal: $sucursal){\n            tipo_movimiento\n            concepto\n            horario_turno\n            numero_caja\n            numero_usuario_creador\n            nombre_usuario_creador\n            hora_moviento{\n                hora\n                minutos\n                segundos\n                completa\n            }\n            fecha_movimiento{\n                year\n                mes\n                dia\n                no_dia_year\n                no_semana_year\n                completa\n            }\n            montos_en_caja{\n                monto_efectivo{\n                    monto \n                }\n                monto_tarjeta_credito{\n                    monto \n                }\n                monto_tarjeta_debito{\n                    monto \n                }\n                monto_creditos{\n                    monto \n                }\n                monto_monedero{\n                    monto \n                }\n                monto_transferencia{\n                    monto \n                }\n                monto_cheques{\n                    monto \n                }\n                monto_vales_despensa{\n                    monto \n                }\n            }\n        }\n    }\n"]))),Md=Object(P.d)(Nd||(Nd=Object(N.a)(["\n\tmutation eliminarCaja($id: ID!) {\n\t\teliminarCaja(id: $id) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Ld=(Object(P.d)(Pd||(Pd=Object(N.a)(["\n\tmutation ActualizarCaja($input: EditarCaja, $id: ID!) {\n\t\tactualizarCaja(id: $id, input: $input) {\n            _id\n            numero_caja\n            activa\n        }\n    }\n"]))),Object(P.d)(Dd||(Dd=Object(N.a)(["\n    query ObtenerPreCorteCaja($empresa: ID!, $sucursal: ID!, $input: PreCortesDeCajaInput){\n        obtenerPreCorteCaja(empresa: $empresa, sucursal: $sucursal, input: $input){\n            monto_efectivo_precorte         \n        }\n    }\n"])))),Ud=Object(P.d)(Ed||(Ed=Object(N.a)(["\n    query ObtenerCortesDeCaja($empresa: ID!, $sucursal: ID!, $input: FiltroCorteDeCajaInput){\n        obtenerCortesDeCaja(empresa: $empresa, sucursal: $sucursal, input: $input){\n            concepto\n            token_turno_user\n            numero_caja\n            horario_en_turno\n            id_caja\n            hora_salida{\n                completa\n            }\n            fecha_salida{\n                completa\n            }\n            fecha_movimiento\n            usuario_en_turno{\n                nombre\n                telefono\n                email\n                numero_usuario\n            }\n            montos_en_caja{\n                monto_efectivo{\n                    monto \n                }\n                monto_tarjeta_credito{\n                    monto \n                }\n                monto_tarjeta_debito{\n                    monto \n                }\n                monto_creditos{\n                    monto \n                }\n                monto_monedero{\n                    monto \n                }\n                monto_transferencia{\n                    monto \n                }\n                monto_cheques{\n                    monto \n                }\n                monto_vales_despensa{\n                    monto \n                }\n            }\n            sucursal{\n                nombre_sucursal\n            }\n        }\n    }\n"]))),Bd=Object(P.d)(Ad||(Ad=Object(N.a)(["\n    query ObtenerCorteCaja($empresa: ID!, $sucursal: ID!, $input: CorteDeCajaInput){\n        obtenerCorteCaja(empresa: $empresa, sucursal: $sucursal, input: $input){\n            montos_en_sistema{\n                monto_efectivo\n                monto_tarjeta_debito\n                monto_tarjeta_credito\n                monto_creditos\n                monto_monedero\n                monto_transferencia\n                monto_cheques\n                monto_vales_despensa\n            }\n        }\n    }\n"]))),qd=a(812),Jd=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"55vh"}}}));function Gd(e){var t=e.obtenerCajasSucursal,a=e.setAlert,n=e.refetch,c=JSON.parse(localStorage.getItem("sesionCafi")),r=Jd();return Object(B.jsx)("div",{className:r.root,children:Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{className:r.container,children:Object(B.jsxs)(_a.a,{className:r.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Cajas"}),!1===c.accesos.catalogos.cajas.eliminar?null:Object(B.jsx)(Oa.a,{padding:"default",children:"Eliminar"})]})}),Object(B.jsx)(xa.a,{children:t.map((function(e){return Object(B.jsx)(Yd,{row:e,permisos:c,setAlert:a,refetch:n},e.numero_caja)}))})]})})})})}var Hd=Object(qd.a)((function(e){return{badge:{color:function(e){return e.props.color},background:function(e){return e.props.color},boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(nc.a),Yd=function(e){var t=e.row,a=e.permisos,n=e.setAlert,c=e.refetch,r={color:t.activa?"#44b700":"red"};return Object(B.jsxs)(ma.a,{role:"checkbox",tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(Hd,{overlap:"circle",props:r,anchorOrigin:{vertical:"top",horizontal:"left"},variant:"dot"}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsxs)(p.a,{children:["CAJA ",t.numero_caja]})]})}),!1===a.accesos.catalogos.cajas.eliminar?null:Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(Kd,{data:t,setAlert:n,refetch:c})})]})},Kd=function(e){var t=e.data,a=e.setAlert,n=e.refetch,c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)(!1),d=Object(g.a)(s,2),j=d[0],u=d[1],b=function(){return o(!1)},p=Object(z.a)(Md),m=Object(g.a)(p,1)[0],O=function(){var e=Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u(!0),e.next=4,m({variables:{id:t._id}});case 4:n(),a({message:"\xa1Listo!",status:"success",open:!0}),u(!1),b(),e.next=18;break;case 10:if(e.prev=10,e.t0=e.catch(0),u(!1),b(),!e.t0.message){e.next=17;break}return a({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 17:a({message:"Hubo un error",status:"error",open:!0});case 18:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{onClick:function(){return o(!0)},disabled:t.activa,children:Object(B.jsx)(ur.a,{})}),Object(B.jsxs)(Ee.a,{open:i,onClose:b,children:[Object(B.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:b,color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:function(){return O()},startIcon:j?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(ur.a,{}),children:"Eliminar"})]})]})]})};function Qd(){var e=d.a.useState(!1),t=Object(g.a)(e,2),a=t[0],n=t[1],c=Object(l.useState)({message:"",status:"",open:!1}),r=Object(g.a)(c,2),i=r[0],o=r[1],s=JSON.parse(localStorage.getItem("sesionCafi")),j=[],u=Object(z.a)(Wd),b=Object(g.a)(u,1)[0],m=Object(qe.a)($d,{variables:{empresa:s.empresa._id,sucursal:s.sucursal._id}}),O=m.data,x=m.refetch,h=function(){var e=Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n(!0),e.next=4,b({variables:{input:{usuario_creador:s._id,numero_usuario_creador:s.numero_usuario,nombre_usuario_creador:s.nombre},empresa:s.empresa._id,sucursal:s.sucursal._id}});case 4:x(),o({message:"\xa1Listo!",status:"success",open:!0}),n(!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),o({message:"Hubo un error",status:"error",open:!0}),n(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return O&&(j=O.obtenerCajasSucursal),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(J,{alert:i,setAlert:o}),Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",my:2,children:!1===s.accesos.catalogos.cajas.agregar?null:Object(B.jsx)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:function(){return h()},disabled:a,startIcon:a?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(It.a,{}),children:"Agregar"})}),Object(B.jsx)(Gd,{obtenerCajasSucursal:j,setAlert:o,refetch:x})]})}var Xd=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),Zd=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function ej(){var e=Xd(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/cajas.svg",alt:"icono numero calzado",className:e.icon})}),"Cajas"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Zd,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Cajas"}),Object(B.jsxs)(p.a,{m:1,display:"flex",flexDirection:"row",children:[Object(B.jsx)(Xl,{texto:"En este apartado se registran las cajas necesarias para realizar los movimientos operativos de ventas."}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})]})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(y.a,{maxWidth:"sm",children:Object(B.jsx)(Qd,{})})})]})]})}var tj=[{id:1,label:"No. Usuario",minWidth:100},{id:3,label:"Nombre",minWidth:150},{id:5,label:"Correo",minWidth:150},{id:7,label:"Estado",minWidth:100,align:"right"}],aj=Object(k.a)({root:{width:"100%"},container:{height:"75vh"},avatar:{width:130,height:130}});function nj(e){var t=e.sucursal,a=e.filtro,n=aj(),c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(l.useContext)(Vr).update,i=Object(qe.a)(E,{variables:{sucursal:t,filtro:a}}),o=i.loading,s=i.data,d=i.error,j=i.refetch;if(Object(l.useEffect)((function(){j()}),[r,j]),o)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})});if(d)return Object(B.jsx)(Ze,{error:d});var u=s.obtenerUsuarios;return Object(B.jsx)(Ka.a,{className:n.root,variant:"outlined",children:Object(B.jsx)(ba.a,{className:n.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"sticky table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[tj.map((function(e){return Object(B.jsx)(Oa.a,{align:e.align,children:e.label},e.id)})),!1===c.accesos.catalogos.usuarios.editar?null:Object(B.jsx)(Oa.a,{align:"right",children:"Editar"},9),!1===c.accesos.catalogos.usuarios.eliminar?null:Object(B.jsx)(Oa.a,{align:"right",children:"Eliminar"},10)]})}),Object(B.jsx)(xa.a,{children:u.map((function(e,t){return Object(B.jsx)(cj,{datos:e},t)}))})]})})})}var cj=function(e){var t=e.datos,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(l.useContext)(Vr),c=n.update,r=n.setUpdate,i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(z.a)(A),u=Object(g.a)(j,1)[0],b=function(){var e=Object(f.a)(C.a.mark((function e(a){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,e.next=4,u({variables:{input:{estado_usuario:a.target.checked},id:t._id}});case 4:r(!c),d(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),d(!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(ma.a,{role:"checkbox",tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.numero_usuario})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.nombre})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.email})}),Object(B.jsx)(Oa.a,{align:"right",children:s?Object(B.jsx)(I.a,{size:30}):Object(B.jsx)(el.a,{checked:t.estado_usuario,onChange:b,color:"primary"})}),!1===a.accesos.catalogos.usuarios.editar?null:Object(B.jsx)(Oa.a,{width:50,children:Object(B.jsx)(di,{accion:"actualizar",datos:t})}),!1===a.accesos.catalogos.usuarios.eliminar?null:Object(B.jsx)(Oa.a,{width:50,children:Object(B.jsx)(X.a,{color:"secondary",children:Object(B.jsx)(ur.a,{})})})]})},rj=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},root:{display:"flex",paddingLeft:e.spacing(2)}}})),ij=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function oj(){var e=rj(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=d.a.useState(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(""),o=Object(g.a)(i,2),s=o[0],j=o[1],u=Object(l.useState)(""),b=Object(g.a)(u,2),m=b[0],O=b[1],x=JSON.parse(localStorage.getItem("sesionCafi")),h=function(){r(!1)};return Object(B.jsx)("div",{children:Object(B.jsxs)(Mr,{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){r(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/usuarios.svg",alt:"icono numero calzado",className:e.icon})}),"Usuarios"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:c,onClose:h,TransitionComponent:ij,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Usuarios"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:h,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsx)(p.a,{mt:3,display:"flex",justifyContent:"space-between",children:Object(B.jsxs)(y.a,{children:[Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,xs:8,md:6,children:Object(B.jsxs)(Ka.a,{className:e.root,children:[Object(B.jsx)(Zs.a,{fullWidth:!0,placeholder:"Buscar cliente...",onChange:function(e){return O(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&j(e.target.defaultValue)},value:m}),Object(B.jsx)(X.a,{onClick:function(){return j(m)},children:Object(B.jsx)(sc.a,{})})]})}),Object(B.jsx)($e.a,{item:!0,xs:4,md:6,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",children:!1===t.accesos.catalogos.usuarios.agregar?null:Object(B.jsx)(di,{accion:"registrar",datos:void 0})})})]}),Object(B.jsx)(p.a,{my:3,children:Object(B.jsx)(nj,{sucursal:x.sucursal._id,filtro:s})})]})})]})]})})}var sj=Object(l.createContext)(),lj=function(e){var t=e.children,a=Object(l.useState)({nombre_departamentos:""}),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(!1),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(l.useState)(!0),O=Object(g.a)(m,2),x=O[0],h=O[1],_=Object(l.useState)(!1),f=Object(g.a)(_,2),v=f[0],C=f[1],y=Object(l.useState)(""),S=Object(g.a)(y,2),F=S[0],w=S[1],I=Object(l.useState)({message:"",status:"",open:!1}),k=Object(g.a)(I,2),z=k[0],N=k[1],P=Object(l.useState)(!1),D=Object(g.a)(P,2),E=D[0],A=D[1];return Object(B.jsx)(sj.Provider,{value:{data:c,setData:r,update:s,setUpdate:d,error:b,setError:p,openRegistro:v,setOpenRegistro:C,accion:x,setAccion:h,idDepartamento:F,setIdDepartamento:w,alert:z,setAlert:N,loading:E,setLoading:A},children:t})},dj=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"55vh"}}}));function jj(){var e=dj(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=[],n=Object(l.useContext)(sj),c=n.update,r=n.setData,i=Object(qe.a)(Jc,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id}}),o=i.data,s=i.loading,d=i.error,j=i.refetch;return Object(l.useEffect)((function(){j()}),[c,j]),s?Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})}):d?Object(B.jsx)(Ze,{error:d}):(o&&(a=o.obtenerDepartamentos),Object(B.jsx)("div",{className:e.root,children:Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{className:e.container,children:Object(B.jsxs)(_a.a,{className:e.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Departamentos"}),!1===t.accesos.catalogos.departamentos.editar?null:Object(B.jsx)(Oa.a,{padding:"default",children:"Editar"}),!1===t.accesos.catalogos.departamentos.eliminar?null:Object(B.jsx)(Oa.a,{padding:"default",children:"Eliminar"})]})}),Object(B.jsx)(xa.a,{children:a.map((function(e,t){return Object(B.jsx)(uj,{row:e,setData:r,refetch:j},t)}))})]})})})}))}var uj=function(e){var t=e.row,a=e.setData,n=e.refetch,c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(l.useState)(!1),i=Object(g.a)(r,2),o=(i[0],i[1]),s=Object(l.useContext)(sj),d=s.setAccion,j=s.setIdDepartamento,u=s.idDepartamento;return Object(B.jsxs)(ma.a,{role:"checkbox",tabIndex:-1,selected:u===t._id,children:[Object(B.jsx)(Oa.a,{children:t.nombre_departamentos}),!1===c.accesos.catalogos.departamentos.editar?null:Object(B.jsx)(Oa.a,{padding:"checkbox",children:u===t._id?Object(B.jsx)(X.a,{onClick:function(){return j(""),d(!0),o(!1),void a({nombre_departamentos:""})},children:Object(B.jsx)(Pt.a,{})}):Object(B.jsx)(X.a,{onClick:function(){return j(t._id),d(!1),a({nombre_departamentos:t.nombre_departamentos}),void o(!0)},children:Object(B.jsx)(en.a,{})})}),!1===c.accesos.catalogos.departamentos.eliminar?null:Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(bj,{data:t,refetch:n})})]})},bj=function(e){var t=e.data,a=e.refetch,n=Object(l.useState)(!1),c=Object(g.a)(n,2),r=c[0],i=c[1],o=Object(l.useState)(),s=Object(g.a)(o,2),d=s[0],j=s[1],u=function(){return i(!r)},b=Object(l.useContext)(sj).setAlert,p=Object(z.a)(Yc),m=Object(g.a)(p,1)[0],O=function(){var e=Object(f.a)(C.a.mark((function e(){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.prev=1,e.next=4,m({variables:{id:t._id}});case 4:"false"===(n=e.sent).data.eliminarDepartamento.message?b({message:"Departamento eliminado con exito",status:"success",open:!0}):b({message:n.data.eliminarDepartamento.message,status:"error",open:!0}),a(),j(!1),i(!1),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0),b({message:"Hubo un error",status:"error",open:!0}),j(!1);case 16:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{onClick:function(){u()},children:Object(B.jsx)(ur.a,{})}),Object(B.jsxs)(Ee.a,{open:r,onClose:u,children:[Object(B.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:u,color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:O,startIcon:d?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(ur.a,{}),children:"Eliminar"})]})]})]})};function pj(){var e=Object(l.useContext)(sj),t=e.data,a=e.setData,n=e.update,c=e.setUpdate,r=e.error,i=e.setError,o=e.accion,s=e.setAccion,d=e.idDepartamento,j=e.setIdDepartamento,u=e.setAlert,m=e.alert,O=JSON.parse(localStorage.getItem("sesionCafi")),x=Object(l.useState)(!1),h=Object(g.a)(x,2),v=h[0],y=h[1],S=Object(z.a)(Gc),k=Object(g.a)(S,1)[0],N=Object(z.a)(Hc),P=Object(g.a)(N,1)[0],D=function(){var e=Object(f.a)(C.a.mark((function e(r){var l;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),e.prev=1,t.nombre_departamentos){e.next=7;break}return i(!0),e.abrupt("return");case 7:if(y(!0),l=t,!o){e.next=18;break}if(!1!==O.accesos.catalogos.departamentos.agregar){e.next=14;break}return e.abrupt("return",u({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 14:return e.next=16,k({variables:{input:l,empresa:O.empresa._id,sucursal:O.sucursal._id}});case 16:e.next=24;break;case 18:if(!1!==O.accesos.catalogos.departamentos.editar){e.next=22;break}return e.abrupt("return",u({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 22:return e.next=24,P({variables:{input:l,id:d}});case 24:c(!n),s(!0),j(""),a({nombre_departamentos:""}),u({message:"\xa1Listo!",status:"success",open:!0}),i(!1),y(!1);case 31:e.next=41;break;case 33:if(e.prev=33,e.t0=e.catch(1),console.log(e.t0),y(!1),!e.t0.message){e.next=40;break}return u({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 40:u({message:"Hubo un error",status:"error",open:!0});case 41:case"end":return e.stop()}}),e,null,[[1,33]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(p.a,{children:[Object(B.jsx)(J,{alert:m,setAlert:u}),Object(B.jsx)("form",{onSubmit:D,children:Object(B.jsxs)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",my:2,children:[Object(B.jsx)(F.a,{id:"outlined-error-helper-text",label:"Nombre departamento",value:t.nombre_departamentos,name:"nombre_departamentos",variant:"outlined",size:"small",fullWidth:!0,onChange:function(e){a(Object(b.a)(Object(b.a)({},t),{},Object(_.a)({},e.target.name,e.target.value)))},error:r,disabled:v,inputProps:{style:{textTransform:"uppercase"}}}),Object(B.jsx)(p.a,{ml:1}),Object(B.jsx)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,type:"submit",disabled:v,startIcon:v?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(It.a,{}),children:"Agregar"})]})}),Object(B.jsx)(jj,{})]})}var mj=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),Oj=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function xj(){var e=mj(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(B.jsx)("div",{children:Object(B.jsxs)(lj,{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/departamentos.svg",alt:"icono numero calzado",className:e.icon})}),"Departamentos"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Oj,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Departamentos"}),Object(B.jsxs)(p.a,{m:1,display:"flex",flexDirection:"row",children:[Object(B.jsx)(Xl,{texto:"En este apartado se registran los departamentos que se le podr\xe1 asignar a un producto."}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})]})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(y.a,{maxWidth:"sm",children:Object(B.jsx)(pj,{accion:"registrar"})})})]})]})})}var hj=a(28),_j=a(955),fj=a(928),gj=a(930),vj=a(929),Cj=Object(k.a)((function(e){return{root:{width:"100%"},flexGrow:{flexGrow:1},selected:{background:Object(hj.d)(e.palette.secondary.main,.1)}}}));function yj(){var e=Cj(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(l.useState)(""),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(""),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(!1),u=Object(g.a)(j,2),b=u[0],m=u[1],O=Object(l.useState)({message:"",status:"",open:!1}),x=Object(g.a)(O,2),h=x[0],_=x[1],v=Object(qe.a)(Uc,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id}}),y=v.loading,k=v.data,N=v.error,P=v.refetch,D=Object(z.a)(Rc),E=Object(g.a)(D,1)[0],A=Object(z.a)(Mc),T=Object(g.a)(A,1)[0],W=function(){var e=Object(f.a)(C.a.mark((function e(a){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),c){e.next=3;break}return e.abrupt("return");case 3:if(m(!0),e.prev=4,s){e.next=15;break}if(!1!==t.accesos.catalogos.categorias.agregar){e.next=11;break}return m(!1),e.abrupt("return",_({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 11:return e.next=13,E({variables:{input:{categoria:c,empresa:t.empresa._id,sucursal:t.sucursal._id}}});case 13:e.next=23;break;case 15:if(!1!==t.accesos.catalogos.categorias.editar){e.next=20;break}return m(!1),e.abrupt("return",_({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 20:return n=wa(c),e.next=23,T({variables:{input:{categoria:n},idCategoria:s}});case 23:P(),_({message:"\xa1Listo!",status:"success",open:!0}),m(!1),r(""),d(""),e.next=37;break;case 30:if(e.prev=30,e.t0=e.catch(4),m(!1),!e.t0.message){e.next=36;break}return _({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 36:_({message:"Hubo un error",status:"error",open:!0});case 37:case"end":return e.stop()}}),e,null,[[4,30]])})));return function(t){return e.apply(this,arguments)}}();if(y)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})});if(N)return Object(B.jsx)(Ze,{error:N});var $=k.obtenerCategorias.map((function(e,t){return Object(B.jsx)(Sj,{categoria:e,setToUpdateID:d,setCategoria:r,refetch:P,toUpdateID:s},t)}));return Object(B.jsxs)("div",{className:e.root,children:[Object(B.jsx)(J,{alert:h,setAlert:_}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Categoria"})}),Object(B.jsx)("form",{onSubmit:W,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,sm:6,xs:12,children:Object(B.jsx)(F.a,{value:c,variant:"outlined",size:"small",onChange:function(e){r(e.target.value)},fullWidth:!0,inputProps:{style:{textTransform:"uppercase"}},disabled:b})}),Object(B.jsx)($e.a,{item:!0,sm:6,xs:12,children:Object(B.jsx)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,type:"submit",disabled:b,startIcon:b?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(It.a,{}),children:"Guardar"})})]})})]}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(S.a,{variant:"h6",children:"Categorias"})}),Object(B.jsx)(p.a,{mb:5,children:$})]})}var Sj=function(e){var t=e.categoria,a=e.setToUpdateID,n=e.setCategoria,c=e.refetch,r=e.toUpdateID,i=Cj(),o=JSON.parse(localStorage.getItem("sesionCafi")),s=Object(l.useState)(""),d=Object(g.a)(s,2),j=d[0],u=d[1],b=Object(l.useState)(!1),m=Object(g.a)(b,2),O=m[0],x=m[1],h=Object(l.useState)({message:"",status:"",open:!1}),_=Object(g.a)(h,2),v=_[0],y=_[1],k=Object(z.a)(Vc),N=Object(g.a)(k,1)[0],P=Object(z.a)(Lc),D=Object(g.a)(P,1)[0],E=t.subcategorias.map((function(e){return Object(B.jsx)(Fj,{idCategoria:t._id,subcategoria:e,setToUpdateID:a,toUpdateID:r,setSubcategoria:u,setAlert:y,refetch:c},e._id)})),A=function(){var e=Object(f.a)(C.a.mark((function e(n){var i,s,l;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),j){e.next=3;break}return e.abrupt("return");case 3:if(x(!0),i="",e.prev=5,r){e.next=18;break}if(!1!==o.accesos.catalogos.categorias.agregar){e.next=12;break}return x(!1),e.abrupt("return",y({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 12:return e.next=14,N({variables:{input:{subcategoria:j},idCategoria:t._id}});case 14:s=e.sent,i="false"===s.data.crearSubcategoria.message?{message:"\xa1Listo!",status:"success",open:!0}:{message:s.data.crearSubcategoria.message,status:"error",open:!0};case 16:e.next=28;break;case 18:if(!1!==o.accesos.catalogos.categorias.editar){e.next=23;break}return x(!1),e.abrupt("return",y({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 23:return l=wa(j),e.next=26,D({variables:{input:{subcategoria:l},idCategoria:t._id,idSubcategoria:r}});case 26:s=e.sent,i="false"===s.data.actualizarSubcategoria.message?{message:"\xa1Listo!",status:"success",open:!0}:{message:s.data.actualizarSubcategoria.message,status:"error",open:!0};case 28:c(),y(i),x(!1),u(""),a(""),e.next=42;break;case 35:if(e.prev=35,e.t0=e.catch(5),x(!1),!e.t0.message){e.next=41;break}return y({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 41:y({message:"Hubo un error",status:"error",open:!0});case 42:case"end":return e.stop()}}),e,null,[[5,35]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(J,{alert:v,setAlert:y}),Object(B.jsxs)(_j.a,{children:[Object(B.jsx)(fj.a,{style:{height:32},className:r&&r===t._id?i.selected:"",expandIcon:Object(B.jsx)(vj.a,{}),"aria-label":"Expand","aria-controls":"categoria-action-".concat(t._id),id:"categoria-".concat(t._id),children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",width:"100%",children:[Object(B.jsx)(S.a,{children:t.categoria}),Object(B.jsx)("div",{className:i.flexGrow}),!1===o.accesos.catalogos.categorias.editar?null:r&&r===t._id?Object(B.jsx)(X.a,{onClick:function(e){e.stopPropagation(),a(""),n("")},onFocus:function(e){return e.stopPropagation()},children:Object(B.jsx)(Pt.a,{})}):Object(B.jsx)(X.a,{onClick:function(e){window.scrollTo(0,0),e.stopPropagation(),a(t._id),n(t.categoria)},onFocus:function(e){return e.stopPropagation()},children:Object(B.jsx)(en.a,{})}),!1===o.accesos.catalogos.categorias.eliminar?null:Object(B.jsx)(wj,{idCategoria:t._id,refetch:c,tipo:"categoria",setAlert:y})]})}),Object(B.jsx)(gj.a,{children:Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(Le.a,{}),Object(B.jsx)(p.a,{mb:2}),Object(B.jsx)("form",{onSubmit:A,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,sm:6,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Subcategorias"})}),Object(B.jsx)(F.a,{value:j,variant:"outlined",size:"small",onChange:function(e){u(e.target.value)},fullWidth:!0,inputProps:{style:{textTransform:"uppercase"}},disabled:O})]}),Object(B.jsx)($e.a,{item:!0,sm:6,style:{display:"flex",alignItems:"flex-end"},children:Object(B.jsx)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:A,disabled:O,startIcon:O?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(It.a,{}),children:"Guardar"})})]})}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(S.a,{variant:"h6",children:"Subcategorias"})}),E]})})]})]})},Fj=function(e){var t=e.subcategoria,a=e.idCategoria,n=e.toUpdateID,c=e.setToUpdateID,r=e.setSubcategoria,i=e.setAlert,o=e.refetch,s=JSON.parse(localStorage.getItem("sesionCafi")),d=Cj();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",borderRadius:3,px:1,className:n&&n===t._id?d.selected:"",children:[Object(B.jsx)(S.a,{children:t.subcategoria}),Object(B.jsx)("div",{className:d.flexGrow}),!1===s.accesos.catalogos.categorias.editar?null:n&&n===t._id?Object(B.jsx)(X.a,{onClick:function(e){e.stopPropagation(),c(""),r("")},onFocus:function(e){return e.stopPropagation()},children:Object(B.jsx)(Pt.a,{})}):Object(B.jsx)(X.a,{onClick:function(e){e.stopPropagation(),c(t._id),r(t.subcategoria)},onFocus:function(e){return e.stopPropagation()},children:Object(B.jsx)(en.a,{})}),!1===s.accesos.catalogos.categorias.eliminar?null:Object(B.jsx)(wj,{idCategoria:a,subcategoria:t,refetch:o,tipo:"subcategoria",setAlert:i})]}),Object(B.jsx)(Le.a,{})]})},wj=function(e){var t=e.idCategoria,a=e.subcategoria,n=e.refetch,c=e.tipo,r=e.setAlert,i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(!1),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(z.a)(Bc),O=Object(g.a)(m,1)[0],x=Object(z.a)(qc),h=Object(g.a)(x,1)[0],_=function(e){e.stopPropagation(),d(!1)},v=function(){var e=Object(f.a)(C.a.mark((function e(i){var o,s,l;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.stopPropagation(),p(!0),o={},e.prev=3,"categoria"!==c){e.next=11;break}return e.next=7,h({variables:{idCategoria:t,idSubcategoria:a._id}});case 7:s=e.sent,o="false"===s.data.eliminarSubcategoria.message?{message:"\xa1Listo!",status:"success",open:!0}:{message:s.data.eliminarSubcategoria.message,status:"error",open:!0},e.next=15;break;case 11:return e.next=13,O({variables:{idCategoria:t}});case 13:l=e.sent,o="false"===l.data.eliminarCategoria.message?{message:"\xa1Listo!",status:"success",open:!0}:{message:l.data.eliminarCategoria.message,status:"error",open:!0};case 15:p(!1),r(o),n(),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(3),p(!1),r({message:"Hubo un error",status:"error",open:!0});case 24:case"end":return e.stop()}}),e,null,[[3,20]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{color:"secondary",onClick:function(e){return t=e,console.log(t),t.stopPropagation(),void d(!0);var t},children:Object(B.jsx)(ur.a,{})}),Object(B.jsxs)(Ee.a,{open:s,onClose:function(e){return _(e)},children:[Object(B.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:function(e){return _(e)},color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:function(e){return v(e)},disabled:b,startIcon:b?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(ur.a,{}),children:"Eliminar"})]})]})]})},Ij=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),kj=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function zj(){var e=Ij(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/categorias.svg",alt:"icono numero calzado",className:e.icon})}),"Categorias"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:kj,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Categorias"}),Object(B.jsxs)(p.a,{m:1,display:"flex",flexDirection:"row",children:[Object(B.jsx)(Xl,{texto:"En este apartado se registran las categorias que se podr\xe1n asignar a un producto."}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})]})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(y.a,{maxWidth:"md",children:Object(B.jsx)(yj,{})})})]})]})}var Nj=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"60vh"}}}));function Pj(e){var t=e.datos,a=e.toUpdate,n=e.setToUpdate,c=e.setValues,r=e.refetch,i=Nj(),o=JSON.parse(localStorage.getItem("sesionCafi")),s=Object(l.useState)(""),d=Object(g.a)(s,2),j=d[0],u=d[1],b=Object(l.useState)([]),m=Object(g.a)(b,2),O=m[0],x=m[1],h=Object(l.useState)({status:"",message:"",open:!1}),_=Object(g.a)(h,2),f=_[0],v=_[1];return Object(l.useEffect)((function(){x(t.filter((function(e){return e.nombre.toLowerCase().includes(j.toLowerCase())})))}),[j,t]),Object(B.jsxs)("div",{className:i.root,children:[Object(B.jsx)(J,{alert:f,setAlert:v}),Object(B.jsxs)(Ka.a,{className:i.paper,children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(F.a,{fullWidth:!0,placeholder:"Buscar...",variant:"outlined",size:"small",onChange:function(e){return u(e.target.value)}})}),Object(B.jsx)(ba.a,{className:i.container,children:Object(B.jsxs)(_a.a,{className:i.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Color"}),Object(B.jsx)(Oa.a,{children:"Nombre"}),!1===o.accesos.catalogos.colores.editar?null:Object(B.jsx)(Oa.a,{padding:"default",children:"Editar"}),!1===o.accesos.catalogos.colores.eliminar?null:Object(B.jsx)(Oa.a,{padding:"default",children:"Eliminar"})]})}),Object(B.jsx)(xa.a,{children:O.map((function(e,t){return Object(B.jsx)(Dj,{row:e,setAlert:v,toUpdate:a,setToUpdate:n,setValues:c,refetch:r},t)}))})]})})]})]})}var Dj=function(e){var t=e.row,a=e.setAlert,n=e.toUpdate,c=e.setToUpdate,r=e.setValues,i=e.refetch,o=JSON.parse(localStorage.getItem("sesionCafi")),s=Object(l.useState)(!1),d=Object(g.a)(s,2),j=d[0],u=d[1],b=Object(l.useState)(!1),m=Object(g.a)(b,2),O=m[0],x=m[1],h=function(){return u(!j)},_=Object(z.a)(Mn),v=Object(g.a)(_,1)[0],y=function(){var e=Object(f.a)(C.a.mark((function e(){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,x(!0),e.next=4,v({variables:{id:t._id}});case 4:n=e.sent,i(i),a({message:n.data.eliminarColor.message,status:"success",open:!0}),x(!1),h(),e.next=18;break;case 11:if(e.prev=11,e.t0=e.catch(0),x(!1),!e.t0.message){e.next=17;break}return a({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 17:a({message:"Hubo un error",status:"error",open:!0});case 18:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),F=function(e){if(!e)return c(""),void r({nombre:"",hex:""});c(e._id),r({nombre:e.nombre,hex:e.hex})};return Object(B.jsxs)(ma.a,{role:"checkbox",tabIndex:-1,selected:n===t._id,children:[Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(p.a,{width:30,height:25,bgcolor:t.hex,borderRadius:"10%"})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:t.nombre})})}),!1===o.accesos.catalogos.colores.editar?null:Object(B.jsx)(Oa.a,{padding:"checkbox",children:n===t._id?Object(B.jsx)(X.a,{onClick:function(){return F()},children:Object(B.jsx)(Pt.a,{})}):Object(B.jsx)(X.a,{onClick:function(){return F(t)},children:Object(B.jsx)(en.a,{})})}),!1===o.accesos.catalogos.colores.eliminar?null:Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(Ej,{handleModal:h,openModal:j,handleDelete:y,loading:O})})]})},Ej=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete,c=e.loading;return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{color:"secondary",onClick:t,children:Object(B.jsx)(ur.a,{})}),Object(B.jsxs)(Ee.a,{open:a,onClose:t,children:[Object(B.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,disabled:c,startIcon:c?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(ur.a,{}),children:"Eliminar"})]})]})]})};function Aj(){var e=Object(l.useState)({}),t=Object(g.a)(e,2),a=t[0],n=t[1],c=Object(l.useState)(""),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)({nombre:"",hex:""}),d=Object(g.a)(s,2),j=d[0],u=d[1],m=Object(l.useState)({message:"",status:"",open:!1}),O=Object(g.a)(m,2),x=O[0],h=O[1],_=JSON.parse(localStorage.getItem("sesionCafi")),v=Object(l.useState)(!1),y=Object(g.a)(v,2),S=y[0],k=y[1],N=Object(l.useState)(!1),P=Object(g.a)(N,2),D=P[0],E=P[1],A=Object(qe.a)(Rn,{variables:{empresa:_.empresa._id}}),T=A.loading,W=A.data,$=A.error,R=A.refetch,V=Object(z.a)($n),M=Object(g.a)(V,1)[0],L=Object(z.a)(Vn),U=Object(g.a)(L,1)[0];if(T)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})});if($)return Object(B.jsx)(Ze,{error:$});var q=W.obtenerColores,G=function(){var e=Object(f.a)(C.a.mark((function e(t){var a,n,c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),j.nombre&&j.hex){e.next=4;break}return k(!0),e.abrupt("return");case 4:if(k(!1),E(!0),e.prev=6,a=j,!i){e.next=19;break}if(!1!==_.accesos.catalogos.colores.editar){e.next=13;break}return e.abrupt("return",h({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 13:return e.next=15,U({variables:{input:{nombre:a.nombre,hex:a.hex},id:i}});case 15:c=e.sent,n=c.data.actualizarColor.message;case 17:e.next=26;break;case 19:if(!1!==_.accesos.catalogos.colores.agregar){e.next=23;break}return e.abrupt("return",h({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 23:return e.next=25,M({variables:{input:{nombre:a.nombre,hex:a.hex,empresa:_.empresa._id,sucursal:_.sucursal._id}}});case 25:n="\xa1Listo!. Color creado.";case 26:R(),u({nombre:"",hex:""}),o(""),E(!1),h({message:n,status:"success",open:!0}),e.next=40;break;case 33:if(e.prev=33,e.t0=e.catch(6),E(!1),!e.t0.message){e.next=39;break}return h({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 39:h({message:"Hubo un error",status:"error",open:!0});case 40:case"end":return e.stop()}}),e,null,[[6,33]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(p.a,{display:"flex",justifyContent:"center",children:[Object(B.jsx)(J,{alert:x,setAlert:h}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,sm:5,xs:12,style:{display:"flex",justifyContent:"center"},children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(Wn.a,{color:a,onChangeComplete:function(e){n(e),u(Object(b.a)(Object(b.a)({},j),{},{hex:e.hex.toUpperCase()}))}}),Object(B.jsxs)(p.a,{my:5,children:[Object(B.jsx)("form",{id:"form-colores",onSubmit:G,children:Object(B.jsx)(F.a,{label:"Nombre del color",variant:"outlined",size:"small",value:j.nombre,onChange:function(e){return u(Object(b.a)(Object(b.a)({},j),{},{nombre:e.target.value}))},inputProps:{style:{textTransform:"uppercase"}},InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:j.hex?Object(B.jsx)(p.a,{border:1,borderRadius:2,bgcolor:j.hex,height:20,width:20}):Object(B.jsx)(p.a,{border:1,style:S&&!j.hex?{borderColor:"red"}:{borderColor:"black"},borderRadius:2,height:20,width:20})})},fullWidth:!0,error:!!S&&!j.nombre,disabled:D,helperText:S?j.nombre?"":"Campo obligatorio":""})}),Object(B.jsx)(p.a,{my:1}),Object(B.jsx)(w.a,{color:"primary",variant:"contained",size:"large",fullWidth:!0,type:"submit",form:"form-colores",startIcon:D?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(It.a,{}),disabled:D,children:i?"Actualizar":"Guardar"})]})]})}),Object(B.jsx)($e.a,{item:!0,sm:7,xs:12,children:Object(B.jsx)(Pj,{datos:q,toUpdate:i,setToUpdate:o,setValues:u,refetch:R})})]})]})}var Tj=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),Wj=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function $j(){var e=Tj(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/colores.svg",alt:"icono numero calzado",className:e.icon})}),"Colores"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Wj,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Colores"}),Object(B.jsxs)(p.a,{m:1,display:"flex",flexDirection:"row",children:[Object(B.jsx)(Xl,{texto:"En este apartado se registran los colores que se le podr\xe1n asignar a un producto."}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})]})}),Object(B.jsx)(p.a,{mt:4,children:Object(B.jsx)(y.a,{maxWidth:"md",children:Object(B.jsx)(Aj,{})})})]})]})}var Rj=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)}}}));function Vj(e){var t=e.updateData,a=e.toUpdate,n=e.setToUpdate,c=e.setData,r=Rj(),i=Object(l.useState)(0),o=Object(g.a)(i,2),s=(o[0],o[1],Object(l.useState)(8)),d=Object(g.a)(s,2),j=(d[0],d[1],Object(l.useState)({status:"",message:"",open:!1})),u=Object(g.a)(j,2),b=u[0],p=u[1],m=JSON.parse(localStorage.getItem("sesionCafi")),O=[],x=Object(qe.a)(Kc,{variables:{empresa:m.empresa._id,sucursal:m.sucursal._id}}),h=x.data,_=x.refetch;Object(l.useEffect)((function(){_()}),[_,t]),h&&(O=h.obtenerMarcas);return Object(B.jsxs)("div",{className:r.root,children:[Object(B.jsx)(J,{alert:b,setAlert:p}),Object(B.jsx)(Ka.a,{className:r.paper,children:Object(B.jsx)(ba.a,{style:{height:"72vh"},children:Object(B.jsxs)(_a.a,{className:r.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Marca"}),!1===m.accesos.catalogos.marcas.editar?null:Object(B.jsx)(Oa.a,{padding:"default",children:"Editar"}),!1===m.accesos.catalogos.marcas.eliminar?null:Object(B.jsx)(Oa.a,{padding:"default",children:"Eliminar"})]})}),Object(B.jsx)(xa.a,{children:O.map((function(e,t){return Object(B.jsx)(Mj,{setAlert:p,refetch:_,datos:e,toUpdate:a,setToUpdate:n,setData:c},t)}))})]})})})]})}var Mj=function(e){var t=e.datos,a=(e.updateData,e.toUpdate),n=e.setAlert,c=e.setToUpdate,r=e.setData,i=e.refetch,o=JSON.parse(localStorage.getItem("sesionCafi")),s=Object(l.useState)(!1),d=Object(g.a)(s,2),j=d[0],u=d[1],b=function(){return u(!j)},p=Object(z.a)(Zc),m=Object(g.a)(p,1)[0],O=function(){var e=Object(f.a)(C.a.mark((function e(){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m({variables:{id:t._id,empresa:o.empresa._id,sucursal:o.sucursal._id}});case 3:"false"===(a=e.sent).data.eliminarMarca.message?n({message:"Marca eliminada con exito",status:"success",open:!0}):n({message:a.data.eliminarMarca.message,status:"error",open:!0}),i(),b(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),n({message:e.t0.message,status:"error",open:!0});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),x=function(e){if(!e)return c(""),r(""),void i();i(),c(e._id),r(e)};return Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:a===t._id,children:[Object(B.jsx)(Oa.a,{children:t.nombre_marca}),!1===o.accesos.catalogos.marcas.editar?null:Object(B.jsx)(Oa.a,{padding:"checkbox",children:a===t._id?Object(B.jsx)(X.a,{onClick:function(){return x()},children:Object(B.jsx)(Pt.a,{})}):Object(B.jsx)(X.a,{onClick:function(){return x(t)},children:Object(B.jsx)(en.a,{})})}),!1===o.accesos.catalogos.marcas.eliminar?null:Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(Lj,{handleModal:b,openModal:j,handleDelete:O})})]})},Lj=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete;return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{color:"secondary",onClick:t,children:Object(B.jsx)(ur.a,{})}),Object(B.jsxs)(Ee.a,{open:a,onClose:t,children:[Object(B.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"Eliminar"})]})]})]})},Uj=Object(l.createContext)(),Bj=function(e){var t=e.children,a=Object(l.useState)({nombre_marca:""}),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(!1),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1];return Object(B.jsx)(Uj.Provider,{value:{datosMarcas:c,setDatosMarcas:r,update:s,setUpdate:d,error:b,setError:p,openRegistro:x,setOpenRegistro:h},children:t})};function qj(){var e=Object(l.useState)({message:"",status:"",open:!1}),t=Object(g.a)(e,2),a=t[0],n=t[1],c=Object(l.useState)({nombre_marca:""}),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)(""),d=Object(g.a)(s,2),j=d[0],u=d[1],m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1],v=Object(l.useState)(!1),y=Object(g.a)(v,2),S=y[0],I=y[1],k=Object(l.useContext)(Uj),N=k.error,P=k.setError,D=JSON.parse(localStorage.getItem("sesionCafi")),E=Object(z.a)(Qc),A=Object(g.a)(E,1)[0],T=Object(z.a)(Xc),W=Object(g.a)(T,1)[0],$=function(){var e=Object(f.a)(C.a.mark((function e(){var t,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i.nombre_marca){e.next=6;break}return P(!0),e.abrupt("return");case 6:if(!j){e.next=17;break}if(!1!==D.accesos.catalogos.marcas.editar){e.next=11;break}return e.abrupt("return",n({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n !",status:"error",open:!0}));case 11:return t=wa(i),e.next=14,W({variables:{input:{nombre_marca:t.nombre_marca},id:j}});case 14:o("");case 15:e.next=25;break;case 17:if(!1!==D.accesos.catalogos.marcas.agregar){e.next=21;break}return e.abrupt("return",n({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n !",status:"error",open:!0}));case 21:return a=i,e.next=24,A({variables:{input:a,empresa:D.empresa._id,sucursal:D.sucursal._id}});case 24:o("");case 25:u(""),I(!S),h(!1),n({message:"\xa1Listo!",status:"success",open:!0}),P(!1);case 30:e.next=40;break;case 32:if(e.prev=32,e.t0=e.catch(0),console.log(e.t0),h(!1),!e.t0.message){e.next=39;break}return n({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 39:n({message:"Hubo un error",status:"error",open:!0});case 40:case"end":return e.stop()}}),e,null,[[0,32]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(He,{loading:x}),Object(B.jsx)(J,{alert:a,setAlert:n}),Object(B.jsxs)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",my:2,children:[Object(B.jsx)(F.a,{id:"outlined-error-helper-text",label:"Nombre de marca",value:i.nombre_marca?i.nombre_marca:"",name:"nombre_marca",variant:"outlined",size:"small",fullWidth:!0,inputProps:{style:{textTransform:"uppercase"}},onChange:function(e){o(Object(b.a)(Object(b.a)({},i),{},Object(_.a)({},e.target.name,e.target.value)))},error:N,onKeyPress:function(e){"Enter"===e.key&&$()}}),Object(B.jsx)(p.a,{ml:1}),Object(B.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:$,children:[Object(B.jsx)(It.a,{}),"Guardar"]})]}),Object(B.jsx)(Vj,{toUpdate:j,setToUpdate:u,updateData:S,setData:o})]})}var Jj=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),Gj=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100}}}));function Hj(){var e=Gj(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(B.jsx)("div",{children:Object(B.jsxs)(Bj,{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Fe.n,{className:e.icon})}),"Marcas"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Jj,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Marcas"}),Object(B.jsxs)(p.a,{m:1,display:"flex",flexDirection:"row",children:[Object(B.jsx)(Xl,{texto:"En este apartado se registran las marcas que se asignar\xe1n a un producto."}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})]})}),Object(B.jsx)(p.a,{mt:4,children:Object(B.jsx)(y.a,{maxWidth:"md",children:Object(B.jsx)(qj,{})})})]})]})})}var Yj=Object(k.a)((function(e){return{root:{width:"100%"},flexGrow:{flexGrow:1},selected:{background:Object(hj.d)(e.palette.secondary.main,.1)}}}));function Kj(){var e=Yj(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(l.useState)(""),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(""),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(!1),u=Object(g.a)(j,2),b=u[0],m=u[1],O=Object(l.useState)({message:"",status:"",open:!1}),x=Object(g.a)(O,2),h=x[0],_=x[1],v=Object(qe.a)(zi,{variables:{empresa:t.empresa._id}}),y=v.loading,k=v.data,N=v.error,P=v.refetch,D=Object(z.a)(Fi),E=Object(g.a)(D,1)[0],A=Object(z.a)(Ii),T=Object(g.a)(A,1)[0];if(y)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})});if(N)return Object(B.jsx)(Ze,{error:N});var W=k.obtenerCuentas.map((function(e,t){return Object(B.jsx)(tu,{cuenta:e,setToUpdateID:d,setCuenta:r,refetch:P,toUpdateID:s},t)})),$=function(){var e=Object(f.a)(C.a.mark((function e(){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=2;break}return e.abrupt("return");case 2:if(m(!0),e.prev=3,s){e.next=14;break}if(!1!==t.accesos.catalogos.centro_costos.agregar){e.next=10;break}return m(!1),e.abrupt("return",_({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 10:return e.next=12,E({variables:{input:{cuenta:c,empresa:t.empresa._id,sucursal:t.sucursal._id}}});case 12:e.next=22;break;case 14:if(!1!==t.accesos.catalogos.centro_costos.editar){e.next=19;break}return m(!1),e.abrupt("return",_({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 19:return a=wa(c),e.next=22,T({variables:{input:{cuenta:a},idCuenta:s}});case 22:P(),_({message:"\xa1Listo!",status:"success",open:!0}),m(!1),r(""),d(""),e.next=33;break;case 29:e.prev=29,e.t0=e.catch(3),_({message:"Hubo un error",status:"error",open:!0}),m(!1);case 33:case"end":return e.stop()}}),e,null,[[3,29]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{className:e.root,children:[Object(B.jsx)(J,{alert:h,setAlert:_}),Object(B.jsx)(He,{loading:b,setLoading:m}),Object(B.jsx)(S.a,{variant:"h6",children:"Cuentas"}),Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",mb:2,children:[Object(B.jsx)(F.a,{value:c,variant:"outlined",inputProps:{style:{textTransform:"uppercase"}},size:"small",style:{width:"35%"},onKeyPress:function(e){try{"Enter"===e.key&&$()}catch(N){}},onChange:function(e){r(e.target.value)}}),Object(B.jsx)(p.a,{ml:1}),Object(B.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:$,children:[Object(B.jsx)(It.a,{}),"Guardar"]})]}),W]})}var Qj,Xj,Zj,eu,tu=function(e){var t=e.cuenta,a=e.setToUpdateID,n=e.setCuenta,c=e.refetch,r=e.toUpdateID,i=JSON.parse(localStorage.getItem("sesionCafi")),o=Yj(),s=Object(l.useState)(""),d=Object(g.a)(s,2),j=d[0],u=d[1],b=Object(l.useState)(!1),m=Object(g.a)(b,2),O=m[0],x=m[1],h=Object(l.useState)({message:"",status:"",open:!1}),_=Object(g.a)(h,2),v=_[0],y=_[1],I=Object(z.a)(Ni),k=Object(g.a)(I,1)[0],N=Object(z.a)(wi),P=Object(g.a)(N,1)[0],D=Object(z.a)(ki),E=Object(g.a)(D,1)[0],A=null!==t.subcuentas?t.subcuentas.map((function(e){return Object(B.jsx)(au,{idCuenta:t._id,subcuenta:e,setToUpdateID:a,toUpdateID:r,setSubcuenta:u,refetch:c},e._id)})):Object(B.jsx)("div",{}),T=function(){var e=Object(f.a)(C.a.mark((function e(){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j){e.next=2;break}return e.abrupt("return");case 2:if(x(!0),e.prev=3,r){e.next=14;break}if(!1!==i.accesos.catalogos.centro_costos.agregar){e.next=10;break}return x(!1),e.abrupt("return",y({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 10:return e.next=12,P({variables:{input:{subcuenta:j},idCuenta:t._id}});case 12:e.next=22;break;case 14:if(!1!==i.accesos.catalogos.centro_costos.editar){e.next=19;break}return x(!1),e.abrupt("return",y({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 19:return n=wa(j),e.next=22,E({variables:{input:{subcuenta:n},idCuenta:t._id,idSubcuenta:r}});case 22:c(),y({message:"\xa1Listo!",status:"success",open:!0}),x(!1),u(""),a(""),e.next=33;break;case 29:e.prev=29,e.t0=e.catch(3),y({message:"Hubo un error",status:"error",open:!0}),x(!1);case 33:case"end":return e.stop()}}),e,null,[[3,29]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(f.a)(C.a.mark((function e(t){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.prev=1,e.next=4,k({variables:{id:t}});case 4:c(),y({message:"\xa1Listo!",status:"success",open:!0}),x(!1),n(""),a(""),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),y({message:"Hubo un error",status:"error",open:!0}),x(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(J,{alert:v,setAlert:y}),Object(B.jsx)(He,{loading:O,setLoading:x}),Object(B.jsxs)(_j.a,{children:[Object(B.jsx)(fj.a,{className:r&&r===t._id?o.selected:"",expandIcon:Object(B.jsx)(vj.a,{}),"aria-label":"Expand","aria-controls":"cuenta-action-".concat(t._id),id:"cuenta-".concat(t._id),children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",width:"100%",children:[Object(B.jsx)(S.a,{style:{fontSize:15},children:t.cuenta}),Object(B.jsx)("div",{className:o.flexGrow}),r&&r===t._id?Object(B.jsx)(X.a,{onClick:function(e){e.stopPropagation(),a(""),n("")},onFocus:function(e){return e.stopPropagation()},children:Object(B.jsx)(Pt.a,{})}):!1===i.accesos.catalogos.centro_costos.editar?null:Object(B.jsx)(X.a,{onClick:function(e){e.stopPropagation(),a(t._id),n(t.cuenta)},onFocus:function(e){return e.stopPropagation()},children:Object(B.jsx)(en.a,{})}),!1===i.accesos.catalogos.centro_costos.eliminar?null:Object(B.jsx)(X.a,{onClick:function(){return W(t._id)},onFocus:function(e){return e.stopPropagation()},children:Object(B.jsx)(ur.a,{})})]})}),Object(B.jsx)(gj.a,{children:Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(Le.a,{}),Object(B.jsx)(p.a,{mb:2}),Object(B.jsxs)(p.a,{ml:5,width:"100%",display:"flex",children:[Object(B.jsx)(S.a,{variant:"h6",style:{fontSize:20},children:"Subcuenta"}),Object(B.jsx)(p.a,{mr:2}),Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",mb:2,children:[Object(B.jsx)(F.a,{value:j,variant:"outlined",size:"small",onChange:function(e){u(e.target.value)},onKeyPress:function(e){try{"Enter"===e.key&&T()}catch(t){}},inputProps:{style:{textTransform:"uppercase"}}}),Object(B.jsx)(p.a,{ml:1}),Object(B.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:T,children:[Object(B.jsx)(It.a,{}),"Guardar"]})]})]}),null!==t.subcuentas?Object(B.jsx)(p.a,{ml:5,children:A}):Object(B.jsx)("div",{})]})})]})]})},au=function(e){var t=e.idCuenta,a=e.subcuenta,n=e.toUpdateID,c=e.setToUpdateID,r=e.setSubcuenta,i=e.refetch,o=JSON.parse(localStorage.getItem("sesionCafi")),s=Yj(),d=Object(l.useState)(!1),j=Object(g.a)(d,2),u=j[0],b=j[1],m=Object(l.useState)({message:"",status:"",open:!1}),O=Object(g.a)(m,2),x=O[0],h=O[1],_=Object(z.a)(Pi),v=Object(g.a)(_,1)[0],y=function(){var e=Object(f.a)(C.a.mark((function e(a){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.prev=1,e.next=4,v({variables:{idCuenta:t,idSubcuenta:a}});case 4:i(),h({message:"\xa1Listo!",status:"success",open:!0}),b(!1),r(""),c(""),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),h({message:"Hubo un error",status:"error",open:!0}),b(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(J,{alert:x,setAlert:h}),Object(B.jsx)(He,{loading:u,setLoading:b}),Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",borderRadius:3,px:1,className:n&&n===a._id?s.selected:"",children:[Object(B.jsx)(S.a,{children:a.subcuenta}),Object(B.jsx)("div",{className:s.flexGrow}),!1===o.accesos.catalogos.centro_costos.editar?null:n&&n===a._id?Object(B.jsx)(X.a,{onClick:function(e){e.stopPropagation(),c(""),r("")},onFocus:function(e){return e.stopPropagation()},children:Object(B.jsx)(Pt.a,{})}):Object(B.jsx)(X.a,{onClick:function(e){e.stopPropagation(),c(a._id),r(a.subcuenta)},onFocus:function(e){return e.stopPropagation()},children:Object(B.jsx)(en.a,{})}),!1===o.accesos.catalogos.centro_costos.eliminar?null:Object(B.jsx)(X.a,{onClick:function(){return y(a._id)},onFocus:function(e){return e.stopPropagation()},children:Object(B.jsx)(ur.a,{})})]}),Object(B.jsx)(Le.a,{})]})},nu=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),cu=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function ru(){var e=nu(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/costos.svg",alt:"icono numero calzado",className:e.icon})}),"Centro de costos"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:cu,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Centro de costos"}),Object(B.jsxs)(p.a,{m:1,display:"flex",flexDirection:"row",children:[Object(B.jsx)(Xl,{texto:"En este apartado podr\xe1s registrar tus cuentas y subcuentas que utilizar\xe1s al momento de llevar tu control financiero. Por ejemplo: Compras, Ventas."}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})]})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(y.a,{maxWidth:"md",children:Object(B.jsx)(Kj,{})})})]})]})}var iu=Object(P.d)(Qj||(Qj=Object(N.a)(["\n    query ObtenerConceptosAlmacen($empresa: ID!, $sucursal: ID!){\n        obtenerConceptosAlmacen(empresa: $empresa, sucursal: $sucursal){\n                _id\n            nombre_concepto\n            destino\n            origen\n            editable\n            empresa{\n                _id\n                nombre_empresa\n            }\n                sucursal{\n                _id\n                nombre_sucursal\n            }\n        }\n    }\n"]))),ou=Object(P.d)(Xj||(Xj=Object(N.a)(["\n    mutation CrearConceptoAlmacen($input: ConceptoAlmacenInput, $empresa: ID!, $sucursal: ID!, $usuario: ID!){\n        crearConceptoAlmacen(input:$input,empresa:$empresa,sucursal:$sucursal, usuario:$usuario){\n            message\n        }\n    }\n"]))),su=Object(P.d)(Zj||(Zj=Object(N.a)(["\n    mutation ActualizarConceptoAlmacen($input: ConceptoAlmacenInput, $id: ID!){\n        actualizarConceptoAlmacen(input: $input, id: $id){\n            message\n        }\n    }\n"]))),lu=Object(P.d)(eu||(eu=Object(N.a)(["\n    mutation EliminarConceptoAlmacen($id: ID!){\n        eliminarConceptoAlmacen(id: $id){\n            message\n        }\n    }\n"]))),du=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)}}}));function ju(e){var t=e.setData,a=e.setIdConcepto,n=e.idConcepto,c=e.setAccion,r=e.updateData,i=e.setAlert,o=du(),s=Object(l.useState)(0),d=Object(g.a)(s,2),j=(d[0],d[1],Object(l.useState)(10)),u=Object(g.a)(j,2),b=(u[0],u[1],JSON.parse(localStorage.getItem("sesionCafi"))),m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1],_=function(){return h(!x)},v=[],y=Object(qe.a)(iu,{variables:{empresa:b.empresa._id,sucursal:b.sucursal._id}}),S=y.loading,F=y.data,w=y.error,k=y.refetch,N=Object(z.a)(lu),P=Object(g.a)(N,1)[0];Object(l.useEffect)((function(){k()}),[r,k]),F&&(v=F.obtenerConceptosAlmacen);var D=function(){var e=Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P({variables:{id:n}});case 3:k(),i({message:"\xa1Listo!",status:"success",open:!0}),_(),a(""),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),i({message:e.t0.message,status:"error",open:!0});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return w?Object(B.jsx)(Ze,{error:w}):S?Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})}):Object(B.jsxs)("div",{className:o.root,children:[Object(B.jsx)(Ka.a,{className:o.paper,children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{className:o.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Concepto almac\xe9n"}),Object(B.jsx)(Oa.a,{padding:"default",children:"Origen"}),Object(B.jsx)(Oa.a,{padding:"default",children:"Destino"}),!1===b.accesos.catalogos.conceptos_almacen.editar?null:Object(B.jsx)(Oa.a,{padding:"default",children:"Editar"}),!1===b.accesos.catalogos.conceptos_almacen.eliminar?null:Object(B.jsx)(Oa.a,{padding:"default",children:"Eliminar"})]})}),Object(B.jsx)(xa.a,{children:v.map((function(e,n){return Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:e.nombre_concepto}),Object(B.jsx)(Oa.a,{children:e.origen}),Object(B.jsx)(Oa.a,{children:e.destino}),!1===b.accesos.catalogos.conceptos_almacen.editar?null:Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(X.a,{onClick:function(){c(!1),a(e._id),t({nombre_concepto:e.nombre_concepto,origen:e.origen,destino:e.destino})},disabled:!e.editable,children:Object(B.jsx)(en.a,{})})}),!1===b.accesos.catalogos.conceptos_almacen.eliminar?null:Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(X.a,{onClick:function(){a(e._id),_()},disabled:!e.editable,children:Object(B.jsx)(ur.a,{})})})]},e._id)}))})]})})}),Object(B.jsx)(uu,{handleModal:_,openModal:x,handleDelete:D})]})}var uu=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete;return Object(B.jsx)("div",{children:Object(B.jsxs)(Ee.a,{open:a,onClose:t,children:[Object(B.jsx)(wt.a,{children:"Eliminar este concepto afectar\xe1 c\xe1lculos de estados de resultado ,\xbfSeguro que quieres eliminar esto?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"Eliminar"})]})]})})},bu=Object(k.a)((function(e){return{root:{width:"100%"},flexGrow:{flexGrow:1},formControl:{marginLeft:e.spacing(5),marginBottom:e.spacing(3),minWidth:200,maxWidth:200}}})),pu={PaperProps:{style:{maxHeight:908,width:400}}},mu=["SUMA","RESTA","N/A"];function Ou(e,t,a){return console.log(t),{fontWeight:-1===t.indexOf(e)?a.typography.fontWeightRegular:a.typography.fontWeightMedium}}function xu(){var e=bu(),t=Object(Se.a)(),a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)({nombre_concepto:"",destino:"",origen:""}),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)({message:"",status:"",open:!1}),u=Object(g.a)(j,2),m=u[0],O=u[1],x=Object(l.useState)(!1),h=Object(g.a)(x,2),v=h[0],y=h[1],I=JSON.parse(localStorage.getItem("sesionCafi")),k=Object(l.useState)(!0),N=Object(g.a)(k,2),P=N[0],D=N[1],E=Object(l.useState)(""),A=Object(g.a)(E,2),T=A[0],W=A[1],$=Object(z.a)(ou),R=Object(g.a)($,1)[0],V=Object(z.a)(su),M=Object(g.a)(V,1)[0],L=Object(l.useState)(!1),U=Object(g.a)(L,2),q=U[0],G=U[1],K=function(){var e=Object(f.a)(C.a.mark((function e(){var t;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,G(!1),s.nombre_concepto&&s.origen&&s.destino){e.next=7;break}return y(!0),e.abrupt("return");case 7:if(t=s,!P){e.next=17;break}if(!1!==I.accesos.catalogos.conceptos_almacen.agregar){e.next=13;break}return e.abrupt("return",O({message:"Lo sentimos no tienes los permisos autorizados",status:"error",open:!0}));case 13:return e.next=15,R({variables:{input:t,empresa:I.empresa._id,sucursal:I.sucursal._id,usuario:I._id}});case 15:e.next=24;break;case 17:if(!1!==I.accesos.catalogos.conceptos_almacen.editar){e.next=21;break}return e.abrupt("return",O({message:"Lo sentimos no tienes los permisos autorizados",status:"error",open:!0}));case 21:return e.next=23,M({variables:{input:t,id:T}});case 23:D(!0);case 24:O({message:"\xa1Listo!",status:"success",open:!0}),d({nombre_concepto:"",origen:"",destino:""}),y(!1),r(!c),W("");case 29:e.next=34;break;case 31:e.prev=31,e.t0=e.catch(0),O({message:e.t0.message,status:"error",open:!0});case 34:case"end":return e.stop()}}),e,null,[[0,31]])})));return function(){return e.apply(this,arguments)}}(),Q=function(e){var t=e.handleModal,a=e.openModal,n=e.handleSubmit;return Object(B.jsx)("div",{children:Object(B.jsxs)(Ee.a,{open:a,onClose:t,children:[Object(B.jsx)(wt.a,{children:"Editar este concepto afectar\xe1 c\xe1lculos de estados de resultado ,\xbfSeguro que quieres editar esto?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"Editar"})]})]})})};return Object(B.jsxs)("div",{className:e.root,children:[Object(B.jsx)(p.a,{flexDirection:"row",children:Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)(J,{alert:m,setAlert:O}),Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",mb:2,children:[Object(B.jsx)(S.a,{children:"Concepto "}),Object(B.jsx)(F.a,{error:v,id:"outlined-error-helper-text",variant:"outlined",size:"small",name:"nombre_concepto",style:{marginLeft:2},value:s.nombre_concepto,onChange:function(e){d(Object(b.a)(Object(b.a)({},s),{},Object(_.a)({},e.target.name,e.target.value)))},onKeyPress:function(e){"Enter"===e.key&&K()},inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)(H.a,{className:e.formControl,children:[Object(B.jsx)(Y.a,{id:"origen-label",children:"Origen"}),Object(B.jsx)(mt.a,{error:v,labelId:"origen-label",id:"origen-name",value:s.origen,onChange:function(e){d(Object(b.a)(Object(b.a)({},s),{},{origen:e.target.value}))},input:Object(B.jsx)(Ya.a,{}),MenuProps:pu,children:mu.map((function(e){return Object(B.jsx)(Ot.a,{value:e,style:Ou(e,s.origen,t),children:e},e)}))})]}),Object(B.jsxs)(H.a,{className:e.formControl,children:[Object(B.jsx)(Y.a,{id:"destino-label",children:"Destino"}),Object(B.jsx)(mt.a,{error:v,labelId:"destino-label",id:"destino-name",value:s.destino,onChange:function(e){d(Object(b.a)(Object(b.a)({},s),{},{destino:e.target.value}))},input:Object(B.jsx)(Ya.a,{}),MenuProps:pu,children:mu.map((function(e){return Object(B.jsx)(Ot.a,{value:e,style:Ou(e,s.destino,t),children:e},e)}))})]}),Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",mb:2,children:[Object(B.jsx)(p.a,{ml:5}),Object(B.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",onClick:function(){return P?K():G(!0)},disableElevation:!0,children:[Object(B.jsx)(It.a,{}),"Guardar"]})]})]})}),Object(B.jsx)(ju,{setData:d,idConcepto:T,setIdConcepto:W,setAccion:D,updateData:c,setAlert:O}),Object(B.jsx)(Q,{handleModal:function(){return G(!q)},openModal:q,handleSubmit:K})]})}var hu=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),_u=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function fu(){var e=hu(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/conceptosAlmacen.svg",alt:"icono numero calzado",className:e.icon})}),"Conceptos Almac\xe9n"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:_u,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Conceptos almac\xe9n"}),Object(B.jsxs)(p.a,{m:1,display:"flex",flexDirection:"row",children:[Object(B.jsx)(Xl,{texto:"En este apartado podr\xe1s registrar los conceptos que definir\xe1n la acci\xf3n para los traspasos entre almacenes."}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})]})}),Object(B.jsx)(p.a,{mt:4,alignSelf:"center",children:Object(B.jsx)(y.a,{children:Object(B.jsx)(xu,{})})})]})]})}function gu(){var e=JSON.parse(localStorage.getItem("sesionCafi"));return Object(B.jsx)(y.a,{children:Object(B.jsxs)($e.a,{container:!0,spacing:5,justifyContent:"center",children:[!1===e.accesos.catalogos.clientes.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(sl,{})})}),!1===e.accesos.catalogos.productos.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Ul,{})})}),!1===e.accesos.catalogos.tallas_numeros.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(rd,{})})}),!1===e.accesos.catalogos.contabilidad.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(xd,{})})}),!1===e.accesos.catalogos.provedores.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Fd,{})})}),!1===e.accesos.catalogos.cajas.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(ej,{})})}),!1===e.accesos.catalogos.usuarios.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(oj,{})})}),!1===e.accesos.catalogos.departamentos.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(xj,{})})}),!1===e.accesos.catalogos.categorias.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(zj,{})})}),!1===e.accesos.catalogos.colores.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)($j,{})})}),!1===e.accesos.catalogos.marcas.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Hj,{})})}),!1===e.accesos.catalogos.centro_costos.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(ru,{})})}),!1===e.accesos.catalogos.conceptos_almacen.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(fu,{})})})]})})}var vu=Object(l.createContext)(),Cu=function(e){var t=e.children,a=Object(l.useState)({message:"",status:"",open:!1}),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)([]),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)([]),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1];return Object(B.jsx)(vu.Provider,{value:{alert:c,setAlert:r,cuentas:s,setCuentas:d,reload:x,setReload:h,cuenta:b,setCuenta:p},children:t})},yu=a(468),Su=a.n(yu),Fu=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},formComboBox:{height:"50%"},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}}}})),wu=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Iu(e){var t=e.cuenta,a=e.refetch,n=e.tipo,c=JSON.parse(localStorage.getItem("sesionCafi")),r=JSON.parse(localStorage.getItem("turnoEnCurso")),i=Object(z.a)(ca),o=Object(g.a)(i,1)[0],s=Fu(),d=Object(l.useState)({message:"",status:"",open:!1}),j=Object(g.a)(d,2),u=j[0],m=j[1],O=Object(l.useState)([]),x=Object(g.a)(O,2),h=x[0],v=x[1],y=Object(l.useState)(!1),I=Object(g.a)(y,2),k=I[0],N=I[1],P=function(){N(!k)},D=function(e){v(Object(b.a)(Object(b.a)({},h),{},Object(_.a)({},e.target.name,e.target.value)))},E={tipo_movimiento:"RETIRO"===h.tipo_movimiento?"CUENTA-RETIRO":"CUENTA-DEPOSITO",id_usuario:c._id,rol_movimiento:!0===n?"CUENTA-EMPRESA":"CUENTA",numero_caja:r?parseInt(r.numero_caja):0,id_Caja:r?r.id_caja:null,numero_usuario_creador:c.numero_usuario.toString(),nombre_usuario_creador:c.nombre,horario_turno:r?r.horario_turno:null,concepto:h.concepto,hora_moviento:{hora:ht()().format("hh"),minutos:ht()().format("mm"),segundos:ht()().format("ss"),completa:ht()().format("HH:mm:ss")},fecha_movimiento:{year:ht()().format("YYYY"),mes:ht()().format("MM"),dia:ht()().format("DD"),no_semana_year:ht()().week().toString(),no_dia_year:ht()().dayOfYear().toString(),completa:ht()().locale("es-mx").format()},montos_en_caja:{monto_efectivo:{monto:parseFloat(h.cantidad),metodo_pago:"01"},monto_tarjeta_debito:{monto:0,metodo_pago:"28"},monto_tarjeta_credito:{monto:0,metodo_pago:"04"},monto_creditos:{monto:0,metodo_pago:"99"},monto_monedero:{monto:0,metodo_pago:"05"},monto_transferencia:{monto:0,metodo_pago:"03"},monto_cheques:{monto:0,metodo_pago:"02"},monto_vales_despensa:{monto:0,metodo_pago:"08"}},comentarios:h.comentarios},A=function(){var e=Object(f.a)(C.a.mark((function e(){var r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,h.concepto&&h.tipo_movimiento&&h.cantidad){e.next=4;break}return m({message:"Por favor complete los datos",status:"error",open:!0}),e.abrupt("return",null);case 4:return e.next=6,o({variables:{input:E,empresa:c.empresa._id,sucursal:t._id,tipo:n}});case 6:r=e.sent,a(),v([]),P(),m({message:r.data.crearMovimientoCuenta.message,status:"success",open:!0}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),m({message:e.t0.message,status:"error",open:!0});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{children:Object(B.jsx)(X.a,{color:"primary",onClick:P,size:"small",children:Object(B.jsx)(Su.a,{style:{fontSize:35}})})}),Object(B.jsx)(J,{alert:u,setAlert:m}),Object(B.jsxs)(Ee.a,{open:k,TransitionComponent:wu,maxWidth:"sm",fullWidth:!0,children:[Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(p.a,{textAlign:"center",p:1,children:Object(B.jsx)(S.a,{variant:"h5",children:"Movimiento en Cuenta"})}),Object(B.jsxs)("div",{className:s.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Usuario"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"usuario",variant:"outlined",disabled:!0,value:null===c||void 0===c?void 0:c.nombre})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Fecha y hora"}),Object(B.jsx)(F.a,{fullWidth:!0,disabled:!0,size:"small",value:ht()().format("D MMMM YYYY, h:mm:ss"),name:"fecha_movimiento",variant:"outlined"})]})]}),Object(B.jsx)("div",{className:s.formInputFlex,children:Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Movimiento a Realizar"}),Object(B.jsxs)(mt.a,{className:s.formComboBox,size:"small",variant:"outlined",name:"tipo_movimiento",onChange:D,fullWidth:!0,children:[Object(B.jsx)(Ot.a,{value:"",children:"Ninguno"}),Object(B.jsx)(Ot.a,{value:"DEPOSITO",children:"Deposito"}),Object(B.jsx)(Ot.a,{value:"RETIRO",children:"Retiro"})]})]})}),Object(B.jsxs)("div",{className:s.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Cantidad"}),Object(B.jsx)(F.a,{className:s.input,fullWidth:!0,onChange:D,size:"small",type:"number",name:"cantidad",variant:"outlined"})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Concepto"}),Object(B.jsx)(F.a,{fullWidth:!0,onChange:D,size:"small",name:"concepto",variant:"outlined"})]})]}),Object(B.jsx)("div",{className:s.formInputFlex,children:Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Comentarios"}),Object(B.jsx)(F.a,{className:s.input,fullWidth:!0,onChange:D,size:"small",multiline:!0,rows:2,type:"number",name:"monto_movimiento",variant:"outlined"})]})})]}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{color:"primary",variant:"outlined",onClick:A,size:"large",children:"Realizar"}),Object(B.jsx)(w.a,{color:"secondary",variant:"outlined",onClick:P,size:"large",children:"Cancelar"})]})]})]})}var ku=[{id:"movimiento",label:"Origen Movimiento",minWidth:100},{id:"fecha",label:"Fecha",minWidth:100},{id:"name",label:"Usuario",minWidth:150},{id:"cantidad",label:"Cantidad",minWidth:150},{id:"concepto",label:"Concepto",minWidth:150},{id:"tipo",label:"Tipo Movimiento",minWidth:100}],zu=Object(k.a)((function(e){return{root:{width:"100%",height:"50vh"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},formComboBox:{height:"50%"},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}}})),Nu=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Pu(e){var t,a=e.cuenta,n=e.tipo,c=JSON.parse(localStorage.getItem("sesionCafi"));ht.a.locale("es");var r=zu(),i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)([]),u=Object(g.a)(j,2),m=u[0],O=u[1],x=Object(Da.useDebounce)(m,500),h=Object(g.a)(x,1)[0],f=function(){d(!s),O([]),I()},v=Object(qe.a)(ra,{variables:{input:{fecha_inicio:m.fecha_inicio?m.fecha_inicio:"",fecha_fin:m.fecha_fin?m.fecha_fin:"",usuario:h.usuario?h.usuario:"",tipo_movimiento:m.tipo_movimiento?m.tipo_movimiento:""},empresa:c.empresa._id,sucursal:a._id,tipo:n}}),C=v.data,y=(v.error,v.loading),I=v.refetch,k=[];C&&(k=C.obtenerHistorialCuenta);var z=function(e){O(Object(b.a)(Object(b.a)({},m),{},Object(_.a)({},e.target.name,e.target.value)))};return Object(l.useEffect)((function(){I()}),[I]),Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{children:Object(B.jsx)(w.a,{color:"primary",onClick:f,size:"small",endIcon:Object(B.jsx)(ee.a,{style:{fontSize:35}}),children:"Ver"})}),Object(B.jsxs)(Ee.a,{open:s,TransitionComponent:Nu,maxWidth:"lg",fullWidth:!0,children:[Object(B.jsx)(p.a,{m:1,display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:f,size:"large",children:Object(B.jsx)(We.a,{})})}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(p.a,{textAlign:"center",p:1,children:Object(B.jsx)(S.a,{variant:"h6",children:"Historial de cuenta"})}),Object(B.jsx)(p.a,{children:Object(B.jsxs)("div",{className:r.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Fecha inicio:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",type:"date",name:"fecha_inicio",onChange:z,variant:"outlined"})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Fecha fin:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",type:"date",onChange:z,name:"fecha_fin",variant:"outlined"})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Usuario:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",onChange:z,name:"usuario",variant:"outlined"})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Tipo Movimiento:"}),Object(B.jsxs)(mt.a,{className:r.formComboBox,size:"small",variant:"outlined",name:"tipo_movimiento",onChange:z,fullWidth:!0,children:[Object(B.jsx)(Ot.a,{value:"TODOS",children:"Ninguno"}),Object(B.jsx)(Ot.a,{value:"CUENTA-DEPOSITO",children:"Deposito"}),Object(B.jsx)(Ot.a,{value:"CUENTA-RETIRO",children:"Retiro"})]})]})]})}),Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Ka.a,{className:r.root,children:Object(B.jsx)(ba.a,{className:r.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:ku.map((function(e){return Object(B.jsx)(Oa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(B.jsx)(xa.a,{children:null===(t=k)||void 0===t?void 0:t.map((function(e,t){return Object(B.jsx)(Du,{row:e,loading:y},t)}))})]})})})})]}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{color:"secondary",variant:"outlined",onClick:f,size:"large",children:"Cancelar"})})]})]})}function Du(e){var t=e.row;return e.loading?Object(B.jsx)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:Object(B.jsx)(I.a,{})}):Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",handleClickOpen:!0,tabIndex:-1,children:[Object(B.jsxs)(Oa.a,{children:["Caja ",""!==t.numero_caja?t.numero_caja:""]}),Object(B.jsx)(Oa.a,{children:ht()(null===t||void 0===t?void 0:t.fecha_movimiento.completa).format("D MMMM YYYY")}),Object(B.jsx)(Oa.a,{children:null===t||void 0===t?void 0:t.nombre_usuario_creador}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{style:{fontSize:17},children:["$",Fa(t.montos_en_caja.monto_efectivo.monto)]})}),Object(B.jsx)(Oa.a,{children:null===t||void 0===t?void 0:t.concepto}),Object(B.jsx)(Oa.a,{children:"CUENTA-DEPOSITO"===(null===t||void 0===t?void 0:t.tipo_movimiento)?"DEPOSITO":"RETIRO"})]})}var Eu=[{id:"name",label:"Origen",minWidth:150,align:"left"},{id:"tipo",label:"Tipo Cuenta",minWidth:150,align:"left"},{id:"dinero",label:"Dinero Existencia",minWidth:100,align:"left"},{id:"movimiento",label:"Realizar Movimiento",minWidth:100,align:"center"},{id:"historial",label:"Historial",minWidth:100,align:"center"}],Au=Object(k.a)((function(e){return{root:{width:"100%",height:"50vh"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function Tu(){var e,t,a,n,c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(qe.a)(ta,{variables:{id:c.empresa._id}}),i=r.data,o=(r.error,r.loading),s=r.refetch,l=Object(qe.a)(et,{variables:{id:c.empresa._id}}),d=Au(),j=[],u=[];return l.data&&(u=l.data.obtenerEmpresa),i&&(j=i.obtenerSucursalesEmpresa),o&&l.loading?Object(B.jsx)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"50vh",children:Object(B.jsx)(I.a,{})}):Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Ka.a,{className:d.root,children:Object(B.jsx)(ba.a,{className:d.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:Eu.map((function(e){return Object(B.jsx)(Oa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(B.jsxs)(xa.a,{children:[Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",handleClickOpen:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:null===(e=u)||void 0===e?void 0:e.nombre_empresa}),Object(B.jsx)(Oa.a,{children:"CUENTA PRINCIPAL"}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{style:{fontSize:17},children:["$",Fa(null===(t=u)||void 0===t||null===(a=t.cuenta_empresa)||void 0===a?void 0:a.dinero_actual)]})}),!1===c.accesos.tesoreria.cuentas_empresa.editar?Object(B.jsx)(Oa.a,{align:"center",children:"  "}):Object(B.jsxs)(Oa.a,{align:"center",children:[" ",Object(B.jsx)(Iu,{cuenta:u,refetch:l.refetch,tipo:!0})," "]}),Object(B.jsxs)(Oa.a,{align:"center",children:[" ",Object(B.jsx)(Pu,{cuenta:u,tipo:!0})," "]})]}),null===(n=j)||void 0===n?void 0:n.map((function(e,t){return Object(B.jsx)(Wu,{refetch:s,cuenta:e,loading:o},t)}))]})]})})})})}function Wu(e){var t,a=e.cuenta,n=e.refetch,c=JSON.parse(localStorage.getItem("sesionCafi"));return Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",handleClickOpen:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:a.nombre_sucursal}),Object(B.jsx)(Oa.a,{children:"SUCURSAL"}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{style:{fontSize:17},children:["$",Fa(null===a||void 0===a||null===(t=a.cuenta_sucursal)||void 0===t?void 0:t.dinero_actual)]})}),!1===c.accesos.tesoreria.cuentas_empresa.editar?Object(B.jsx)(Oa.a,{align:"center",children:"  "}):Object(B.jsxs)(Oa.a,{align:"center",children:[" ",Object(B.jsx)(Iu,{cuenta:a,refetch:n,tipo:!1})," "]}),Object(B.jsxs)(Oa.a,{align:"center",children:[" ",Object(B.jsx)(Pu,{cuenta:a,tipo:!1})," "]})]})}var $u,Ru,Vu=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},buttons:{"& > *":{margin:"0px ".concat(e.spacing(1),"px")}}}})),Mu=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Lu(){var e=Vu(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){return c(!n)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:r,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/retiro-de-dinero.svg",alt:"icono retiro",className:e.icon})}),"Cuentas de Empresa"]})}),Object(B.jsxs)(Ee.a,{open:n,TransitionComponent:Mu,maxWidth:"lg",fullWidth:!0,children:[Object(B.jsx)(p.a,{m:1,display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{})})}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(p.a,{textAlign:"center",children:Object(B.jsx)(S.a,{variant:"h6",children:"Cuentas de empresa"})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(Tu,{})})]})]})]})}var Uu=Object(P.d)($u||($u=Object(N.a)(["\n    query ObtenerHistorialEgresos($input: ObtenerHistorialEgresosInput, $empresa: ID!, $sucursal: ID!){\n        obtenerHistorialEgresos(input: $input, empresa: $empresa, sucursal: $sucursal){\n            folio_egreso\n            folio_factura\n            empresa_distribuidora\n            provedor\n            productos {\n                cantidad_productos\n                precio_unitario\n                producto\n                total\n            }\n            categoria\n            subCategoria\n            metodo_pago\n            fecha_compra\n            fecha_registro\n            fecha_vencimiento\n            observaciones\n            compra_credito\n            credito_pagado\n            saldo_credito_pendiente\n            saldo_total\n            numero_usuario_creador\n            nombre_usuario_creador\n            id_user\n            empresa\n            sucursal         \n        }\n    }\n"]))),Bu=Object(P.d)(Ru||(Ru=Object(N.a)(["\n    mutation CrearEgreso($input: CrearEgresosInput, $empresa: ID!, $sucursal: ID!){\n        crearEgreso(input: $input, empresa: $empresa, sucursal: $sucursal){\n            message\n        }\n    }\n"]))),qu=a(128),Ju=a.n(qu),Gu=a(959),Hu=[{id:"cantidad",label:"Cantidad",minWidth:100},{id:"nombre",label:"Nombre",minWidth:100},{id:"precioU",label:"Precio Unitario",minWidth:100},{id:"total",label:"Total",minWidth:100}],Yu=Object(k.a)((function(e){return{root:{width:"100%"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(1),flex:1},table:{minWidth:650}}}));function Ku(e){var t=e.productos,a=e.borrarProducto,n=Yu(),c=Object(l.useState)(0),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)(3),d=Object(g.a)(s,2),j=d[0],u=d[1];return Object(B.jsxs)(Ka.a,{className:n.root,children:[Object(B.jsx)(ba.a,{className:n.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,className:n.table,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Hu.map((function(e){return Object(B.jsx)(Oa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)})),Object(B.jsx)(Oa.a,{align:"center",style:{minWidth:100},children:"Eliminar"})]})}),Object(B.jsx)(xa.a,{children:t.slice(i*j,i*j+j).map((function(e,t){return Object(B.jsx)(Qu,{index:t,producto:e,borrarProducto:a})}))})]})}),Object(B.jsx)(Gu.a,{rowsPerPageOptions:[],component:"div",count:t.length,rowsPerPage:j,page:i,onPageChange:function(e,t){o(t)},onRowsPerPageChange:function(e){u(+e.target.value),o(0)}})]})}function Qu(e){var t=e.index,a=e.producto,n=e.borrarProducto;return Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:null===a||void 0===a?void 0:a.cantidad_productos}),Object(B.jsx)(Oa.a,{children:null===a||void 0===a?void 0:a.producto}),Object(B.jsxs)(Oa.a,{children:["$",Fa(null===a||void 0===a?void 0:a.precio_unitario)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(null===a||void 0===a?void 0:a.total)]}),Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)(X.a,{"aria-label":"delete",size:"small",onClick:function(){return n(t)},children:Object(B.jsx)(Ju.a,{fontSize:"medium"})})})]})}var Xu=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(0),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},formComboBox:{height:"50%"},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}}}}));function Zu(e){e.tipo;var t,a=e.handleClickOpen,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(l.useContext)(vu).setAlert,r=Object(z.a)(Bu),i=Object(g.a)(r,1)[0],o=Xu(),s=Object(l.useState)(!1),d=Object(g.a)(s,2),j=d[0],u=d[1],m=Object(l.useState)([]),O=Object(g.a)(m,2),x=O[0],h=O[1],v=Object(l.useState)(0),y=Object(g.a)(v,2),I=y[0],k=y[1],N=Object(l.useState)([]),P=Object(g.a)(N,2),D=P[0],E=P[1],A=Object(l.useState)([]),T=Object(g.a)(A,2),W=T[0],$=T[1],R=Object(l.useState)([]),V=Object(g.a)(R,2),M=V[0],L=V[1],U=Object(qe.a)(zi,{variables:{empresa:n.empresa._id}}),q=[];U.data&&(q=U.data.obtenerCuentas);var J=function(e){h(Object(b.a)(Object(b.a)({},x),{},Object(_.a)({},e.target.name,e.target.value)))},G=function(e){$(Object(b.a)(Object(b.a)({},W),{},Object(_.a)({},e.target.name,e.target.value)))};Object(l.useEffect)((function(){Y(),L(M),u(!1)}),[j,M]);var Y=function(){for(var e=0,t=0;t<M.length;t++)e+=M[t].total;k(e)},Z={folio_egreso:x.folio_egreso,folio_factura:x.folio_factura,empresa_distribuidora:x.empresa_distribuidora,provedor:x.provedor,productos:x.productos?x.productos:[],categoria:x.categoria,subCategoria:x.subCategoria,metodo_pago:x.metodo_pago,fecha_compra:x.fecha_compra,fecha_vencimiento:x.fecha_vencimiento0?x.fecha_vencimiento:"",observaciones:x.observaciones,compra_credito:!!x.compra_credito&&x.compra_credito,credito_pagado:!!x.credito_pagado&&x.credito_pagado,saldo_credito_pendiente:x.saldo_credito_pendiente?x.saldo_credito_pendiente:0,numero_usuario_creador:n.numero_usuario.toString(),nombre_usuario_creador:n.nombre,id_user:n._id,saldo_total:I||0},ee=function(){var e=Object(f.a)(C.a.mark((function e(){var t;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,x.folio_egreso){e.next=4;break}return c({message:"Por favor genere un folio.",status:"error",open:!0}),e.abrupt("return",null);case 4:return e.next=6,i({variables:{input:Z,empresa:n.empresa._id,sucursal:n.sucursal._id}});case 6:t=e.sent,a(),h([]),c({message:t.data.crearEgreso.message,status:"success",open:!0}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),c({message:e.t0.message,status:"error",open:!0});case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(p.a,{p:1,children:[Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Datos Generales"})})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)("div",{className:o.formInputFlex,children:[Object(B.jsx)(p.a,{width:"100%",children:Object(B.jsxs)(H.a,{variant:"outlined",size:"small",name:"folio_egreso",fullWidth:!0,children:[Object(B.jsx)(S.a,{children:"Folio"}),Object(B.jsx)(K.a,{style:{padding:0},id:"form-producto-codigo-barras",name:"folio_egreso",value:x.folio_egreso?x.folio_egreso:"",onChange:J,endAdornment:Object(B.jsx)(Q.a,{position:"start",children:Object(B.jsx)(X.a,{onClick:function(){return function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();h(Object(b.a)(Object(b.a)({},x),{},{folio_egreso:t}))}()},color:"primary",size:"small",children:Object(B.jsx)(cc.a,{})})})})]})}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"ID Factura:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"id_factura",variant:"outlined",onChange:J})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Fecha de Compra:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fecha_compra",variant:"outlined",onChange:J,type:"date",InputLabelProps:{shrink:!0}})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Metodo de pago:"}),Object(B.jsxs)(mt.a,{className:o.formComboBox,size:"small",variant:"outlined",onChange:J,name:"metodo_pago",fullWidth:!0,children:[Object(B.jsx)(Ot.a,{value:"TARJETA",children:"Tarjeta"}),Object(B.jsx)(Ot.a,{value:"EFECTIVO",children:"Efectivo"}),Object(B.jsx)(Ot.a,{value:"CHEQUE",children:"Cheque"}),Object(B.jsx)(Ot.a,{value:"TRANSFERENCIA",children:"Transferencia"}),Object(B.jsx)(Ot.a,{value:"MONEDERO ELECTRONICO",children:"Monedero electronico"})]})]})]}),Object(B.jsxs)("div",{className:o.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Categoria:"}),Object(B.jsxs)(mt.a,{className:o.formComboBox,size:"small",variant:"outlined",onChange:J,name:"categoria",fullWidth:!0,children:[Object(B.jsx)(Ot.a,{value:"Ninguno",onClick:function(){return E([])},children:"Ninguno"}),null===(t=q)||void 0===t?void 0:t.map((function(e){return Object(B.jsx)(Ot.a,{onClick:function(){return function(e){E(e.subcuentas)}(e)},value:e.cuenta,children:e.cuenta},e._id)}))]})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"SubCatergoria:"}),Object(B.jsxs)(mt.a,{className:o.formComboBox,size:"small",variant:"outlined",onChange:J,name:"subCategoria",fullWidth:!0,children:[Object(B.jsx)(Ot.a,{value:"Ninguno",children:"Ninguno"}),null===D||void 0===D?void 0:D.map((function(e){return Object(B.jsx)(Ot.a,{value:e.subcuenta,children:e.subcuenta})}))]})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Empresa:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"empresa_distribuidora",onChange:J,variant:"outlined"})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Provedor: "}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"provedor",onChange:J,variant:"outlined"})]})]}),Object(B.jsxs)(p.a,{p:1,mt:1,children:[Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Productos Adquiridos"})})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)("div",{className:o.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Cantidad:"}),Object(B.jsx)(F.a,{fullWidth:!0,className:o.input,size:"small",name:"cantidad_productos",value:W.cantidad_productos?W.cantidad_productos:"",onChange:G,variant:"outlined",type:"number"})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Producto:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"producto",value:W.producto?W.producto:"",onChange:G,variant:"outlined"})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Precio Unitario:"}),Object(B.jsx)(F.a,{className:o.input,fullWidth:!0,size:"small",name:"precio_unitario",value:W.precio_unitario?W.precio_unitario:"",onChange:G,variant:"outlined",type:"number"})]}),Object(B.jsx)(p.a,{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(w.a,{variant:"outlined",size:"large",color:"primary",onClick:function(){var e={cantidad_productos:parseFloat(W.cantidad_productos),precio_unitario:parseFloat(W.precio_unitario),producto:W.producto,total:parseFloat(W.cantidad_productos)*parseFloat(W.precio_unitario)};M.push(e),h(Object(b.a)(Object(b.a)({},x),{},{productos:M})),Y(),$([])},startIcon:Object(B.jsx)(ac.a,{}),children:"Agregar"})})]}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsx)(Ku,{productos:M,borrarProducto:function(e){M.forEach((function(t,a,n){e===a&&M.splice(e,1)})),u(!0)}})}),Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",p:1,children:Object(B.jsxs)(S.a,{variant:"h6",children:["Total: $",Fa(I)]})}),Object(B.jsx)("div",{className:o.formInputFlex,children:Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Observaci\xf3nes:"}),Object(B.jsx)(F.a,{multiline:!0,rows:2,fullWidth:!0,size:"small",name:"observaciones",onChange:J,variant:"outlined"})]})}),Object(B.jsxs)(p.a,{display:"flex",justifyContent:"flex-end",children:[Object(B.jsx)(p.a,{p:1,children:Object(B.jsx)(w.a,{size:"large",variant:"contained",color:"primary",onClick:ee,children:"Guardar Egreso"})}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsx)(w.a,{size:"large",variant:"contained",color:"secondary",children:"Cancelar"})})]})]})}var eb=["children","value","index"];function tb(e){var t=e.children,a=e.value,n=e.index,c=Object(ve.a)(e,eb);return Object(B.jsx)("div",Object(b.a)(Object(b.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(B.jsx)(p.a,{p:3,minHeight:"70vh",children:t})}))}var ab=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper},iconSvg:{width:50},iconSize:{fontSize:40,color:e.palette.info.main},buttons:{"& > *":{margin:"0px ".concat(e.spacing(1),"px")}}}}));function nb(e){var t,a=e.handleClickOpen,n=JSON.parse(localStorage.getItem("sesionCafi")),c=ab(),r=(Object(l.useContext)(vu).setAlert,Object(l.useState)(0)),i=Object(g.a)(r,2),o=i[0],s=i[1];return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)("div",{className:c.root,children:[Object(B.jsx)(Ie.a,{position:"static",color:"default",elevation:0,children:Object(B.jsxs)(ke.a,{value:o,onChange:function(e,t){s(t)},variant:"scrollable",scrollButtons:"on",textColor:"primary",indicatorColor:"primary","aria-label":"scrollable force tabs example",children:[Object(B.jsx)(ze.a,Object(b.a)({label:"Egreso a Contado",icon:Object(B.jsx)(Fe.e,{className:c.iconSize})},(t=0,{id:"reg-product-tab-".concat(t),"aria-controls":"tabpanel-reg-product-".concat(t)}))),Object(B.jsx)($e.a,{container:!0,justifyContent:"flex-end",children:Object(B.jsxs)(p.a,{mt:4,children:[Object(B.jsxs)(S.a,{children:["Usuario: ",Object(B.jsx)("b",{children:n.nombre})]}),Object(B.jsx)(p.a,{children:Object(B.jsx)("b",{children:ht()().format("D MMMM YYYY")})})]})}),Object(B.jsx)($e.a,{children:Object(B.jsx)(p.a,{mt:3,ml:5,display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:a,size:"large",children:Object(B.jsx)(We.a,{})})})})]})}),Object(B.jsx)(tb,{value:o,index:0,children:Object(B.jsx)(Zu,{handleClickOpen:a,tipo:"CONTADO"})})]})})}var cb=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},root:{flexGrow:1,width:"100%",height:"100vh",backgroundColor:e.palette.background.paper},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)},iconSize:{fontSize:40,color:e.palette.info.main},iconSizeSecond:{width:40}}})),rb=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function ib(){var e=cb(),t=Object(l.useState)(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){return c(!n)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:r,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/income.svg",alt:"icono egreso",className:e.icon})}),"Egresos"]})}),Object(B.jsx)(Ee.a,{open:n,TransitionComponent:rb,fullWidth:!0,maxWidth:"lg",children:Object(B.jsx)(nb,{handleClickOpen:r})})]})}var ob,sb,lb,db=[{id:"cantidad",label:"Cantidad",minWidth:80},{id:"cantidadR",label:"Cant. Regalo",minWidth:80},{id:"nombre",label:"Producto",minWidth:80},{id:"precio",label:"Precio",minWidth:80},{id:"total",label:"Total",minWidth:80}],jb=Object(k.a)((function(e){return{root:{width:"100%",height:"45vh"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}));function ub(e){var t=e.productos,a=jb();return Object(B.jsx)(Ka.a,{className:a.root,children:Object(B.jsx)(ba.a,{className:a.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:db.map((function(e){return Object(B.jsx)(Oa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(B.jsx)(xa.a,{children:null===t||void 0===t?void 0:t.map((function(e,t){return Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:e.cantidad}),Object(B.jsx)(Oa.a,{children:e.cantidad_regalo}),Object(B.jsx)(Oa.a,{children:e.producto.datos_generales.nombre_comercial}),Object(B.jsx)(Oa.a,{children:e.costo}),Object(B.jsx)(Oa.a,{children:e.total})]},t)}))})]})})})}var bb=Object(P.d)(ob||(ob=Object(N.a)(["\n  query ObtenerHistorialAbonos(\n    $empresa: ID!\n    $sucursal: ID!\n    $input: ObtenerHistorialAbonosInput\n  ) {\n    obtenerHistorialAbonos(\n      empresa: $empresa\n      sucursal: $sucursal\n      input: $input\n    ) {\n      numero_caja\n      id_Caja\n      horario_turno\n      tipo_movimiento\n      rol_movimiento\n      fecha_movimiento {\n        completa\n      }\n      numero_usuario_creador\n      nombre_usuario_creador\n      monto_total_abonado\n      numero_cliente\n      nombre_cliente\n      telefono_cliente\n      email_cliente\n      montos_en_caja {\n        monto_efectivo {\n          monto\n        }\n        monto_tarjeta_credito {\n          monto\n        }\n        monto_tarjeta_debito {\n          monto\n        }\n        monto_creditos {\n          monto\n        }\n        monto_monedero {\n          monto\n        }\n        monto_transferencia {\n          monto\n        }\n        monto_cheques {\n          monto\n        }\n        monto_vales_despensa {\n          monto\n        }\n      }\n    }\n  }\n"]))),pb=Object(P.d)(sb||(sb=Object(N.a)(["\n  query historialVentasACredito(\n    $empresa: ID!\n    $sucursal: ID!\n    $idCliente: ID\n  ) {\n    historialVentasACredito(\n      empresa: $empresa\n      sucursal: $sucursal\n      idCliente: $idCliente\n    ) {\n      _id\n      folio\n      cliente {\n        _id\n        numero_cliente\n        clave_cliente\n        representante\n        nombre_cliente\n        rfc\n        curp\n        telefono\n        celular\n        email\n        numero_descuento\n        limite_credito\n        dias_credito\n        razon_social\n        direccion {\n          calle\n          no_ext\n          no_int\n          codigo_postal\n          colonia\n          municipio\n          localidad\n          estado\n          pais\n        }\n        imagen\n        eliminado\n        banco\n        numero_cuenta\n        monedero_electronico\n        credito_disponible\n      }\n      descuento\n      ieps\n      impuestos\n      iva\n      monedero\n      subTotal\n      total\n      venta_cliente\n      credito\n      descuento_general_activo\n      id_caja {\n        _id\n        numero_caja\n        activa\n      }\n      fecha_de_vencimiento_credito\n      dias_de_credito_venta\n      saldo_credito_pendiente\n      credito_pagado\n      empresa\n      sucursal\n      usuario {\n        _id\n        numero_usuario\n        nombre\n      }\n      productos {\n        _id\n        producto {\n          _id\n          datos_generales {\n            codigo_barras\n            clave_alterna\n            tipo_producto\n            nombre_comercial\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat {\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n          precios {\n            ieps\n            ieps_activo\n            inventario {\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n              codigo_unidad\n            }\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            precio_de_compra {\n              precio_con_impuesto\n              precio_sin_impuesto\n              iva\n              ieps\n            }\n            precios_producto {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n            unidad_de_compra {\n              cantidad\n              precio_unitario_con_impuesto\n              precio_unitario_sin_impuesto\n              unidad\n              codigo_unidad\n            }\n            granel\n            litros\n          }\n          imagenes {\n            url_imagen\n            location_imagen\n            key_imagen\n            extencion_imagen\n          }\n          centro_de_costos {\n            cuenta\n            id_cuenta\n            id_subcuenta\n            subcuenta\n          }\n          precio_plazos {\n            precio_cajas {\n              plazo\n              unidad\n              codigo_unidad\n              precio\n            }\n            precio_costales {\n              plazo\n              unidad\n              codigo_unidad\n              precio\n            }\n            precio_piezas {\n              plazo\n              unidad\n              codigo_unidad\n              precio\n            }\n          }\n          unidades_de_venta {\n            _id\n            precio\n            cantidad\n            concepto\n            unidad\n            codigo_unidad\n            unidad_principal\n            codigo_barras\n            codigo_barras\n            id_producto\n            empresa\n            sucursal\n            descuento {\n              cantidad_unidad\n              numero_precio\n              unidad_maxima\n              precio_general\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              porciento\n              dinero_descontado\n            }\n            descuento_activo\n            default\n            precio_unidad {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n          inventario_general {\n            _id\n            cantidad_existente\n            unidad_inventario\n            codigo_unidad\n            cantidad_existente_maxima\n            unidad_maxima\n            id_almacen_general\n            eliminado\n          }\n          medidas_producto {\n            _id\n            cantidad\n            cantidad_nueva\n            almacen\n            codigo_barras\n            color {\n              hex\n              nombre\n              _id\n            }\n            descuento {\n              cantidad_unidad\n              numero_precio\n              unidad_maxima\n              precio_general\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              porciento\n              dinero_descontado\n            }\n            descuento_activo\n            existencia\n            medida {\n              talla\n              tipo\n              _id\n            }\n            nombre_comercial\n            precio\n            precio_unidad {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n          empresa\n          sucursal\n        }\n        concepto\n        cantidad\n        iva_total\n        ieps_total\n        subtotal\n        impuestos\n        total\n        medida {\n          id_medida\n          medida\n          tipo\n        }\n        color {\n          id_color\n          color\n          hex\n        }\n        cantidad_venta\n        granel_producto {\n          granel\n          valor\n        }\n        precio\n        precio_a_vender\n        precio_actual_producto\n        default\n        unidad\n        codigo_unidad\n        id_unidad_venta {\n          _id\n          precio\n          cantidad\n          concepto\n          unidad\n          codigo_unidad\n          unidad_principal\n          unidad_activa\n          codigo_barras\n          id_producto\n          descuento {\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n          descuento_activo\n          default\n          precio_unidad {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n        }\n        inventario_general {\n          _id\n          cantidad_existente\n          unidad_inventario\n          codigo_unidad\n          cantidad_existente_maxima\n          unidad_maxima\n          id_almacen_general\n          eliminado\n        }\n        year_registro\n        fecha_registro\n        precio_unidad {\n          numero_precio\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          unidad_mayoreo\n          utilidad\n          precio_general\n          cantidad_unidad\n          unidad_maxima\n        }\n        precio_actual_object {\n          cantidad_unidad\n          numero_precio\n          unidad_maxima\n          unidad_mayoreo\n          precio_general\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          utilidad\n          porciento\n          dinero_descontado\n        }\n      }\n      fecha_registro\n      factura {\n        id_cfdi\n        serie\n        currency\n        expedition_place\n        folio\n        cfdi_type\n        payment_form\n        payment_method\n        logo_url\n        date\n        issuer {\n          FiscalRegime\n          Rfc\n          Name\n        }\n        receiver {\n          Rfc\n          Name\n          CfdiUse\n        }\n        items {\n          ProductCode\n          IdentificationNumber\n          Description\n          Unit\n          UnitCode\n          UnitPrice\n          Quantity\n          Subtotal\n          Discount\n          Taxes {\n            Total\n            Name\n            Base\n            Rate\n            IsRetention\n          }\n          Total\n        }\n        original_string\n        sub_total\n        total\n        discount\n        fecha_registro\n        empresa\n        sucursal\n      }\n      montos_en_caja {\n        monto_efectivo {\n          monto\n          metodo_pago\n        }\n        monto_tarjeta_debito {\n          monto\n          metodo_pago\n        }\n        monto_tarjeta_credito {\n          monto\n          metodo_pago\n        }\n        monto_creditos {\n          monto\n          metodo_pago\n        }\n        monto_monedero {\n          monto\n          metodo_pago\n        }\n        monto_transferencia {\n          monto\n          metodo_pago\n        }\n        monto_cheques {\n          monto\n          metodo_pago\n        }\n        monto_vales_despensa {\n          monto\n          metodo_pago\n        }\n      }\n      status\n      abonos {\n        numero_caja\n        id_Caja\n        horario_turno\n        tipo_movimiento\n        rol_movimiento\n        fecha_movimiento {\n          completa\n        }\n        numero_usuario_creador\n        nombre_usuario_creador\n        monto_total_abonado\n        numero_cliente\n        nombre_cliente\n        telefono_cliente\n        email_cliente\n        montos_en_caja {\n          monto_efectivo {\n            monto\n          }\n          monto_tarjeta_credito {\n            monto\n          }\n          monto_tarjeta_debito {\n            monto\n          }\n          monto_creditos {\n            monto\n          }\n          monto_monedero {\n            monto\n          }\n          monto_transferencia {\n            monto\n          }\n          monto_cheques {\n            monto\n          }\n          monto_vales_despensa {\n            monto\n          }\n        }\n      }\n    }\n  }\n"]))),mb=Object(P.d)(lb||(lb=Object(N.a)(["\n  mutation CrearAbono($empresa: ID!, $sucursal: ID!, $input: CrearAbonoInput) {\n    crearAbono(empresa: $empresa, sucursal: $sucursal, input: $input) {\n      message\n    }\n  }\n"]))),Ob=[{id:"fecha",label:"Fecha de abono",minWidth:170,align:"center"},{id:"cliente",label:"Nombre",minWidth:170,align:"center"},{id:"abono",label:"Cantidad abonada",minWidth:170,align:"right"}],xb=Object(k.a)((function(e){return{root:{width:"100%",height:"45vh"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}));function hb(e){var t,a=e.cuenta,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(l.useContext)(vu).reload,r=xb(),i=Object(qe.a)(bb,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id,input:{fecha_inicio:"",fecha_fin:"",usuario:"",id_cliente:a.proveedor.id_proveedor._id,id_egreso:"",rol_movimiento:"PROVEEDOR",id_compra:a._id}},fetchPolicy:"network-only"}),o=(i.loading,i.data),s=(i.error,i.refetch),d=[];return o&&(d=o.obtenerHistorialAbonos),Object(l.useEffect)((function(){s()}),[c]),Object(B.jsx)(Ka.a,{className:r.root,children:Object(B.jsx)(ba.a,{className:r.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:Ob.map((function(e){return Object(B.jsx)(Oa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(B.jsx)(xa.a,{children:null===(t=d)||void 0===t?void 0:t.map((function(e,t){return Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:ht()(e.fecha_movimiento.completa).format("D MMMM YYYY")}),Object(B.jsx)(Oa.a,{align:"center",children:e.nombre_cliente}),Object(B.jsx)(Oa.a,{align:"right",children:Object(B.jsxs)("b",{children:["$",e.monto_total_abonado]})})]},t)}))})]})})})}var _b=a(469),fb=a.n(_b),gb=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),vb=Object(k.a)((function(e){return{input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(.5),"px")},"& .obligatorio":{color:"red"},paddingTop:0,alignItems:"center",justifyItems:"center"}}}));function Cb(e){var t=e.cuenta,a=Object(z.a)(mb),n=Object(g.a)(a,1)[0],c=Object(l.useContext)(vu),r=c.setReload,i=c.setAlert,o=JSON.parse(localStorage.getItem("sesionCafi")),s=vb(),d=Object(l.useState)(!1),j=Object(g.a)(d,2),u=j[0],b=j[1],m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1],_=Object(l.useState)(""),v=Object(g.a)(_,2),y=v[0],I=v[1],k=Object(l.useState)(""),N=Object(g.a)(k,2),P=N[0],D=N[1],E={tipo_movimiento:"ABONO",rol_movimiento:"PROVEEDOR",fecha_movimiento:{year:ht()().format("YYYY"),mes:ht()().format("MM"),dia:ht()().format("DD"),no_semana_year:ht()().week().toString(),no_dia_year:ht()().dayOfYear().toString(),completa:ht()().locale("es-mx").format()},monto_total_abonado:parseFloat(y),montos_en_caja:{monto_efectivo:{monto:"01"===P?parseFloat(y):0,metodo_pago:"01"},monto_tarjeta_debito:{monto:"28"===P?parseFloat(y):0,metodo_pago:"28"},monto_tarjeta_credito:{monto:"04"===P?parseFloat(y):0,metodo_pago:"04"},monto_creditos:{monto:"99"===P?parseFloat(y):0,metodo_pago:"99"},monto_monedero:{monto:"05"===P?parseFloat(y):0,metodo_pago:"05"},monto_transferencia:{monto:"03"===P?parseFloat(y):0,metodo_pago:"03"},monto_cheques:{monto:"02"===P?parseFloat(y):0,metodo_pago:"02"},monto_vales_despensa:{monto:"08"===P?parseFloat(y):0,metodo_pago:"08"}},metodo_de_pago:{clave:"",metodo:""},id_usuario:o._id,numero_usuario_creador:o.numero_usuario,nombre_usuario_creador:o.nombre,id_cliente:t.proveedor.id_proveedor._id,numero_cliente:t.proveedor.numero_cliente,nombre_cliente:t.proveedor.nombre_cliente,telefono_cliente:t.proveedor.id_proveedor.telefono,email_cliente:t.proveedor.id_proveedor.email,id_compra:t._id},A=function(){var e=Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h(!0),e.prev=1,""!==y&&""!==P){e.next=6;break}return i({message:"Por favor complete los datos",status:"error",open:!0}),h(!1),e.abrupt("return");case 6:return e.next=9,n({variables:{empresa:o.empresa._id,sucursal:o.sucursal._id,input:E}});case 9:r(!0),I(""),D(""),i({message:"Abono registrado con exito",status:"success",open:!0}),T(),h(!1),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(1),T(),h(!1),i({message:"Ocurrio un problema en el servidor",status:"error",open:!0});case 22:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(){return e.apply(this,arguments)}}(),T=function(){r(!0),b(!u)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{size:"large",variant:"outlined",fullWidth:!0,color:"primary",startIcon:Object(B.jsx)(fb.a,{style:{fontSize:35}}),onClick:T,children:Object(B.jsx)(S.a,{variant:"h6",children:"Abonar"})}),Object(B.jsxs)(Ee.a,{open:u,TransitionComponent:gb,keepMounted:!0,onClose:T,fullWidth:!0,maxWidth:"xs",children:[Object(B.jsx)(He,{loading:x,setLoading:h}),Object(B.jsx)(wt.a,{id:"alert-dialog-slide-title",children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{p:1,flexGrow:1,children:"Registrar nuevo abono"}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:T,size:"large",children:Object(B.jsx)(We.a,{})})})]})}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsxs)(p.a,{width:"100%",mt:2,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Cantidad a abonar:"})}),Object(B.jsx)(F.a,{fullWidth:!0,className:s.input,onChange:function(e){return I(e.target.value)},value:y,size:"small",name:"abono_recibir",variant:"outlined",type:"number"})]}),Object(B.jsx)("div",{className:s.formInputFlex,children:Object(B.jsxs)(p.a,{width:"100%",mt:2,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Metodo de pago:"})}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsxs)(mt.a,{width:"100%",name:"metodo_pago",variant:"outlined",value:P||"",onChange:function(e){return D(e.target.value)},children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),vt.map((function(e,t){return Object(B.jsx)(Ot.a,{value:e.Value,children:e.Name},t)}))]})})]})}),Object(B.jsxs)(p.a,{width:"100%",mt:2,display:"flex",children:[Object(B.jsx)(p.a,{flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Total cuenta"})})}),Object(B.jsx)(S.a,{style:{color:"#9B9B9B"},variant:"h6",children:Object(B.jsxs)("b",{children:["$",Fa(t.total)]})})]}),Object(B.jsxs)(p.a,{width:"100%",display:"flex",children:[Object(B.jsx)(p.a,{flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Total abonado"})})}),Object(B.jsx)(S.a,{style:{color:"green"},variant:"h6",children:Object(B.jsxs)("b",{children:["$",Fa(t.total-t.saldo_credito_pendiente)]})})]}),Object(B.jsxs)(p.a,{width:"100%",display:"flex",children:[Object(B.jsx)(p.a,{flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Total restante"})})}),Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsxs)("b",{children:["$",Fa(t.saldo_credito_pendiente)]})})]})]}),Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignContent:"center",p:2,children:Object(B.jsx)(w.a,{size:"large",variant:"contained",color:"primary",style:{fontSize:18},onClick:A,children:"Registrar Abono"})})]})]})}var yb=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}}}));function Sb(e){var t=e.handleClick,a=e.cuenta,n=JSON.parse(localStorage.getItem("sesionCafi")),c=yb();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(Ie.a,{className:c.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:c.title,children:"Detalles de cuenta"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:t,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsxs)("div",{className:c.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"100%",p:1,children:[Object(B.jsxs)(p.a,{width:"100%",display:"flex",p:.5,children:[Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Nombre de proveedor: "})," "]}),Object(B.jsx)(S.a,{style:{paddingLeft:5},children:a.proveedor.id_proveedor.nombre_cliente})]}),Object(B.jsxs)(p.a,{width:"100%",display:"flex",p:.5,children:[Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Clave proveedor: "})," "]}),Object(B.jsx)(S.a,{style:{paddingLeft:5},children:a.proveedor.id_proveedor.clave_cliente})]})]}),Object(B.jsxs)(p.a,{width:"100%",p:1,children:[Object(B.jsxs)(p.a,{width:"100%",display:"flex",p:.5,children:[Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Nombre de usuario: "})," "]}),Object(B.jsx)(S.a,{style:{paddingLeft:5},children:a.usuario.nombre})]}),Object(B.jsxs)(p.a,{width:"100%",display:"flex",p:.5,children:[Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Numero usuario: "})," "]}),Object(B.jsx)(S.a,{style:{paddingLeft:5},children:a.usuario.numero_usuario})]})]}),Object(B.jsxs)(p.a,{width:"100%",p:1,children:[Object(B.jsxs)(p.a,{width:"100%",display:"flex",p:.5,children:[Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Fecha compra: "})," "]}),Object(B.jsx)(S.a,{style:{paddingLeft:5},children:ht()(a.fecha_registro).format("D MMMM YYYY")})]}),Object(B.jsxs)(p.a,{width:"100%",display:"flex",p:.5,children:[Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Fecha vencimiento: "})," "]}),Object(B.jsx)(S.a,{style:{paddingLeft:5},children:ht()(a.fecha_vencimiento_credito).format("D MMMM YYYY")})]})]}),!1===n.accesos.tesoreria.abonos_proveedores.editar?null:Object(B.jsx)(p.a,{width:"60%",p:1,display:"flex",alignItems:"center",children:Object(B.jsx)(Cb,{cuenta:a})})]}),Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsxs)($e.a,{item:!0,lg:6,xs:12,children:[Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(S.a,{variant:"h6",children:"Lista de abonos"})}),Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(hb,{cuenta:a})}),Object(B.jsx)(p.a,{p:1,mr:3,display:"flex",justifyContent:"flex-end",children:Object(B.jsxs)(S.a,{variant:"h6",children:["Total abonado: ",Object(B.jsxs)("b",{style:{color:"#9B9B9B"},children:["$",a.total-a.saldo_credito_pendiente]})]})}),Object(B.jsx)(p.a,{p:1,mr:3,display:"flex",justifyContent:"flex-end",children:Object(B.jsxs)(S.a,{variant:"h6",children:["Restante: ",Object(B.jsxs)("b",{style:{color:"green"},children:["$",Fa(a.saldo_credito_pendiente)]})]})})]}),Object(B.jsxs)($e.a,{item:!0,lg:6,xs:12,children:[Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(S.a,{variant:"h6",children:"Lista de compra"})}),Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(ub,{productos:a.productos})}),Object(B.jsx)(p.a,{p:1,mr:3,display:"flex",justifyContent:"flex-end",children:Object(B.jsxs)(S.a,{variant:"h6",children:["Total a liquidar: ",Object(B.jsxs)("b",{style:{color:"red"},children:["$",Fa(a.total)]})]})})]})]})]})}var Fb=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},appBar:{position:"relative"}}}));function wb(e){var t=e.cuenta,a=(e.refetch,JSON.parse(localStorage.getItem("sesionCafi"))),n=Object(l.useContext)(vu),c=n.setAlert,r=n.setReload,i=Object(z.a)(mb),o=Object(g.a)(i,1)[0],s=Object(l.useState)(!1),d=Object(g.a)(s,2),j=d[0],u=d[1],b=Object(l.useState)(0),m=Object(g.a)(b,2),O=m[0],x=m[1],h=Object(l.useState)(0),_=Object(g.a)(h,2),v=_[0],y=_[1],I=Object(l.useState)(0),k=Object(g.a)(I,2),N=k[0],P=k[1],D=Object(l.useState)(!1),E=Object(g.a)(D,2),A=E[0],T=E[1],W=Object(l.useState)(""),$=Object(g.a)(W,2),R=$[0],V=$[1],M=function(){u(!j),y(0),P(0),x(0)},L=Fb();var U={tipo_movimiento:"ABONO",rol_movimiento:"PROVEEDOR",fecha_movimiento:{year:ht()().format("YYYY"),mes:ht()().format("MM"),dia:ht()().format("DD"),no_semana_year:ht()().week().toString(),no_dia_year:ht()().dayOfYear().toString(),completa:ht()().locale("es-mx").format()},monto_total_abonado:parseFloat(t.saldo_credito_pendiente),descuento:{porciento_descuento:O,dinero_descontado:N,total_con_descuento:v},montos_en_caja:{monto_efectivo:{monto:"01"===R?parseFloat(0===v?t.saldo_credito_pendiente:v):0,metodo_pago:"01"},monto_tarjeta_debito:{monto:"28"===R?parseFloat(0===v?t.saldo_credito_pendiente:v):0,metodo_pago:"28"},monto_tarjeta_credito:{monto:"04"===R?parseFloat(0===v?t.saldo_credito_pendiente:v):0,metodo_pago:"04"},monto_creditos:{monto:"99"===R?parseFloat(0===v?t.saldo_credito_pendiente:v):0,metodo_pago:"99"},monto_monedero:{monto:"05"===R?parseFloat(0===v?t.saldo_credito_pendiente:v):0,metodo_pago:"05"},monto_transferencia:{monto:"03"===R?parseFloat(0===v?t.saldo_credito_pendiente:v):0,metodo_pago:"03"},monto_cheques:{monto:"02"===R?parseFloat(0===v?t.saldo_credito_pendiente:v):0,metodo_pago:"02"},monto_vales_despensa:{monto:"08"===R?parseFloat(0===v?t.saldo_credito_pendiente:v):0,metodo_pago:"08"}},metodo_de_pago:{clave:"",metodo:""},numero_usuario_creador:a.numero_usuario,nombre_usuario_creador:a.nombre,id_cliente:t.proveedor.id_proveedor._id,numero_cliente:t.proveedor.numero_cliente,nombre_cliente:t.proveedor.nombre_cliente,telefono_cliente:t.proveedor.id_proveedor.telefono,email_cliente:t.proveedor.id_proveedor.email,id_compra:t._id},q=function(){var e=Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(T(!0),e.prev=1,""!==R){e.next=6;break}return c({message:"Por favor complete el metodo de pago",status:"error",open:!0}),T(!1),e.abrupt("return");case 6:return e.next=9,o({variables:{empresa:a.empresa._id,sucursal:a.sucursal._id,input:U}});case 9:r(!0),V(""),c({message:"Cuenta liquidada con exito",status:"success",open:!0}),M(),T(!1),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(1),M(),T(!1),c({message:"Ocurrio un problema en el servidor",status:"error",open:!0});case 21:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{size:"medium",variant:"outlined",color:"primary",startIcon:Object(B.jsx)(Ha.a,{}),onClick:M,children:"Liquidar"}),Object(B.jsxs)(Ee.a,{open:j,fullWidth:!0,maxWidth:"xs",onClose:M,"aria-labelledby":"draggable-dialog-title",children:[Object(B.jsx)(He,{loading:A,setLoading:T}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{flexGrow:1,p:2,children:Object(B.jsx)(S.a,{variant:"h6",className:L.title,children:"Liquidar Cuenta"})}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:M,size:"large",children:Object(B.jsx)(We.a,{})})})]}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(S.a,{children:"Aplica un descuento por pronto pago a tu cuenta"}),Object(B.jsx)(p.a,{mt:1,textAlign:"center",children:Object(B.jsx)(S.a,{id:"discrete-slider-always",gutterBottom:!0,children:Object(B.jsx)("b",{children:"Porcentaje de descuento"})})}),Object(B.jsx)(p.a,{ml:1,mr:1,mb:2,children:Object(B.jsx)(ml.a,{getAriaValueText:function(e){return"".concat(e)},valueLabelFormat:O.toFixed(2),"aria-labelledby":"discrete-slider-small-steps",valueLabelDisplay:"auto",onChange:function(e,a){x(a);var n=parseFloat((100-a).toFixed(2)),c=parseFloat((t.saldo_credito_pendiente*n/100).toFixed(2)),r=parseFloat((t.saldo_credito_pendiente-c).toFixed(2));y(c),P(r)}})}),Object(B.jsxs)(p.a,{width:"100%",textAlign:"center",children:[Object(B.jsx)(S.a,{id:"discrete-slider-always",gutterBottom:!0,children:Object(B.jsx)("b",{children:"Dinero a liquidar con descuento"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"descuento",variant:"outlined",value:v||0,onChange:function(e){var a=parseFloat(e.target.value),n=parseFloat((100*a/t.saldo_credito_pendiente).toFixed(2)),c=parseFloat((t.saldo_credito_pendiente-a).toFixed(2));y(a),P(c),x(n)}})]}),Object(B.jsxs)(p.a,{width:"100%",mt:2,textAlign:"center",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Metodo de pago:"})}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsxs)(mt.a,{width:"100%",name:"metodo_pago",variant:"outlined",onChange:function(e){return V(e.target.value)},children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),vt.map((function(e,t){return Object(B.jsx)(Ot.a,{value:e.Value,children:e.Name},t)}))]})})]}),Object(B.jsxs)(p.a,{display:"flex",mt:2,children:[Object(B.jsx)(p.a,{flexGrow:1,children:Object(B.jsx)(S.a,{children:"Total cuenta: "})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{children:Object(B.jsxs)("b",{children:["$",Fa(t.total)]})})})]}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{flexGrow:1,children:Object(B.jsx)(S.a,{children:"Saldo pendiente: "})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{children:Object(B.jsxs)("b",{children:["$",Fa(t.saldo_credito_pendiente)]})})})]}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{flexGrow:1,children:Object(B.jsx)(S.a,{children:"Dinero Descontado: "})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{children:Object(B.jsxs)("b",{children:["$",Fa(N)]})})})]}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{flexGrow:1,children:Object(B.jsx)(S.a,{children:"Porciento Descontado: "})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{children:Object(B.jsxs)("b",{children:[Fa(O),"%"]})})})]}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h6",children:"Total a pagar:"})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsxs)("b",{style:{color:"green"},children:["$",Fa(0===v?t.saldo_credito_pendiente:v)]})})})]})]}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{onClick:q,color:"primary",variant:"contained",size:"large",children:"Liquidar"})})]})]})}a(99);var Ib=[{id:"fecha",label:"Fecha Compra",minWidth:100,align:"center"},{id:"provedor",label:"Provedor",minWidth:100,align:"center"},{id:"abonado",label:"Abonado",minWidth:100,align:"center"},{id:"restante",label:"Restante",minWidth:100,align:"center"},{id:"total",label:"Total",minWidth:100,align:"center"}],kb=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}})),zb=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Nb(e){var t=e.loading,a=Object(l.useContext)(vu).cuentas,n=kb();return t?Object(B.jsx)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"50vh",children:Object(B.jsx)(I.a,{})}):Object(B.jsx)(l.Fragment,{children:Object(B.jsx)("div",{className:n.root,children:Object(B.jsx)(Ka.a,{className:n.paper,children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{className:n.table,"aria-labelledby":"tableTitle",stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Ib.map((function(e){return Object(B.jsx)(Oa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)})),Object(B.jsx)(Oa.a,{align:"center",style:{minWidth:100},children:"Liquidar"})]})}),Object(B.jsx)(xa.a,{children:null===a||void 0===a?void 0:a.map((function(e,a){if(!1===e.credito_pagado)return Object(B.jsx)(Pb,{loading:t,cuentaSelect:e},a)}))})]})})})})})}function Pb(e){var t=e.cuentaSelect,a=e.loading,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=function(){o(!i)};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,onClick:function(e){return function(e){try{clearTimeout(void 0),2===e.detail&&s()}catch(t){}}(e)},children:[Object(B.jsx)(Oa.a,{align:"center",children:ht()(t.fecha_registro).format("D MMMM YYYY")}),Object(B.jsx)(Oa.a,{align:"center",children:t.proveedor.id_proveedor.nombre_cliente}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",Fa(t.total-t.saldo_credito_pendiente)]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",Fa(t.saldo_credito_pendiente)]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",Fa(t.total)]}),!1===n.accesos.tesoreria.abonos_proveedores.editar?Object(B.jsx)(Oa.a,{align:"center"}):Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)(wb,{cuenta:t})})]}),Object(B.jsx)(Ee.a,{fullScreen:!0,open:i,onClose:s,TransitionComponent:zb,children:Object(B.jsx)(Sb,{cuenta:t,loading:a,handleClick:s})})]})}var Db=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},rootSearch:{display:"flex",paddingLeft:e.spacing(2)}}})),Eb=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Ab(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(l.useContext)(vu),a=t.reload,n=t.setReload,c=t.setCuentas,r=Db(),i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(""),u=Object(g.a)(j,2),b=(u[0],u[1]),m=Object(l.useRef)(null),O=Object(qe.a)(Co,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,fecha:""},fetchPolicy:"network-only"}),x=O.loading,h=O.data,_=(O.error,O.refetch);h&&c(h.obtenerComprasRealizadas),Object(l.useEffect)((function(){_(),n(!1)}),[a,_]);var f=function(){return d(!s)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:f,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/salary.svg",alt:"icono abono",className:r.icon})}),"Abonos de provedores"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:s,onClose:f,TransitionComponent:Eb,children:[Object(B.jsx)(Ie.a,{className:r.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:r.title,children:"Abonos a Provedores"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:f,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsx)(p.a,{display:"flex",p:2,children:Object(B.jsx)(p.a,{minWidth:"70%",children:Object(B.jsx)("form",{onSubmit:function(e){return function(e,t){e.preventDefault(),_({filtro:t,fecha:""}),b(t)}(e,e.target[0].value)},children:Object(B.jsx)(F.a,{inputRef:m,fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",InputProps:{endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(X.a,{type:"submit",color:"primary",size:"medium",children:Object(B.jsx)(is.a,{})})})}})})})}),Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Nb,{loading:x,refetch:_})})]})]})}var Tb=Object(l.createContext)(),Wb=function(e){var t=e.children,a=Object(l.useState)({message:"",status:"",open:!1}),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)([]),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(!1),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1],_=Object(l.useState)(""),f=Object(g.a)(_,2),v=f[0],C=f[1],y=Object(l.useState)([]),S=Object(g.a)(y,2),F=S[0],w=S[1];return Object(l.useEffect)((function(){console.log(F)}),[F]),Object(B.jsx)(Tb.Provider,{value:{alert:c,setAlert:r,ventas:s,setVentas:d,reload:b,setReload:p,openAbonar:x,setOpenAbonar:h,selectedClient:v,setSelectedClient:C,abonos:F,setAbonos:w},children:t})};a(966),Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},appBar:{position:"relative"}}}));var $b=[],Rb=[{id:"folio",numeric:!1,disablePadding:!0,label:"Folio"},{id:"fecha",numeric:!1,disablePadding:!0,label:"Fecha"},{id:"fechaVencimiento",numeric:!1,disablePadding:!0,label:"Fecha de vencimiento"},{id:"cantidadProductos",numeric:!1,disablePadding:!0,label:"Cantidad de productos"},{id:"totalVenta",numeric:!0,disablePadding:!0,label:"Total venta"},{id:"faltaPagar",numeric:!0,disablePadding:!0,label:"Falta por pagar"}];function Vb(e){var t=e.onSelectAllClick,a=e.numSelected,n=e.rowCount;return Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(Me.a,{indeterminate:a>0&&a<n,checked:n>0&&a===n,onChange:t,inputProps:{"aria-label":"select all desserts"}})}),Rb.map((function(e){return Object(B.jsx)(Oa.a,{align:e.numeric?"right":"left",children:e.label},e.id)}))]})})}var Mb=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function Lb(e){var t=Mb(),a=Object(l.useState)([]),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)([]),o=Object(g.a)(i,2),s=(o[0],o[1],Object(l.useState)(0)),d=Object(g.a)(s,1)[0],j=Object(l.useState)(10),u=Object(g.a)(j,1)[0],b=Object(l.useContext)(Tb).setVentas;Math.min(u,$b.length-d*u);return Object(B.jsx)("div",{className:t.root,children:Object(B.jsx)(Ka.a,{className:t.paper,children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{className:t.table,"aria-labelledby":"tableTitle",stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(Vb,{classes:t,numSelected:c.length,onSelectAllClick:function(e){if(e.target.checked){var t=$b.map((function(e){return e.name}));r(t)}else r([])},rowCount:$b.length}),Object(B.jsx)(xa.a,{children:e.rows.map((function(e,t){var a,n=(a=e,-1!==c.indexOf(a)),i="enhanced-table-checkbox-".concat(t);return Object(B.jsxs)(ma.a,{hover:!0,onClick:function(t){return function(e,t){try{var a=[],n=c.indexOf(t);console.log(c,n),-1===n?a=a.concat(c,t):0===n?a=a.concat(c.slice(1)):n===c.length-1?a=a.concat(c.slice(0,-1)):n>0&&(a=a.concat(c.slice(0,n),c.slice(n+1))),r(a),b(a)}catch(i){}}(0,e)},role:"checkbox","aria-checked":n,tabIndex:-1,selected:n,children:[Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(Me.a,{checked:n,inputProps:{"aria-labelledby":i}})}),Object(B.jsx)(Oa.a,{id:i,children:e.folio}),Object(B.jsx)(Oa.a,{children:" ".concat(Sa(e.fecha_registro))}),Object(B.jsx)(Oa.a,{children:e.fecha_de_vencimiento_credito}),Object(B.jsx)(Oa.a,{align:"center",children:e.productos.length}),Object(B.jsx)(Oa.a,{align:"right",children:e.total}),Object(B.jsx)(Oa.a,{align:"right",children:e.saldo_credito_pendiente})]},t)}))})]})})})})}var Ub=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Bb(){var e=Object(l.useState)(!1),t=Object(g.a)(e,2),a=t[0],n=t[1],c=function(){n(!a)};return Object(B.jsxs)(p.a,{m:1,children:[Object(B.jsx)(w.a,{size:"large",variant:"contained",color:"primary",onClick:c,children:"Liquidar"}),Object(B.jsxs)(Ee.a,{open:a,TransitionComponent:Ub,keepMounted:!0,onClose:c,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description",children:[Object(B.jsx)(wt.a,{id:"alert-dialog-slide-title",children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-start",children:"Abono a recibir por cuenta"}),Object(B.jsx)(p.a,{ml:3,display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:c,size:"large",children:Object(B.jsx)(We.a,{})})})]})}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Cuenta No. 2501265"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"nombre_comercial",id:"form-producto-nombre-comercial",variant:"outlined",value:"$150,000.00 Mx"})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Cuenta No. 2501265"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"nombre_comercial",id:"form-producto-nombre-comercial",variant:"outlined",value:"$150,000.00 Mx"})]}),Object(B.jsx)(p.a,{width:"100%",p:1,mt:1,children:Object(B.jsx)(S.a,{children:"Nombre de Cliente: SUTANO"})}),Object(B.jsx)(p.a,{width:"100%",p:1,children:Object(B.jsx)(S.a,{children:"Total a abonar:  $15,100"})}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsxs)(St.a,{severity:"info",children:["Si desea editar el abono del cliente, ",Object(B.jsx)("br",{}),"procure este sea mayor al establecido"]})})]}),Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignContent:"center",p:2,children:Object(B.jsx)(w.a,{size:"large",variant:"contained",color:"primary",style:{fontSize:16},onClick:c,children:"Registrar Abono"})})]})]})}var qb=a(470),Jb=a.n(qb),Gb=a(471),Hb=a.n(Gb),Yb=a(931),Kb=a(933),Qb=a(932),Xb=Object(k.a)({}),Zb=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function ep(e){var t=Xb(),a=Object(Se.a)(),n=function(){e.setOpenDetalle(!e.openDetalle)};return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)(Ee.a,{open:e.openDetalle,onClose:n,fullWidth:!0,maxWidth:"lg",TransitionComponent:Zb,children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(S.a,{variant:"h6",style:{flexGrow:1},children:"Datos de compra"}),Object(B.jsx)(w.a,{variant:"text",color:"primary",onClick:n,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(Ka.a,{className:t.root,children:Object(B.jsx)(ba.a,{className:t.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Producto"}),Object(B.jsx)(Oa.a,{children:"Medida"}),Object(B.jsx)(Oa.a,{children:"Color"}),Object(B.jsx)(Oa.a,{children:"Unidad"}),Object(B.jsx)(Oa.a,{children:"Cantidad"}),Object(B.jsx)(Oa.a,{children:"C. regalo"}),Object(B.jsx)(Oa.a,{children:"C. total"}),Object(B.jsx)(Oa.a,{children:"Subtotal"}),Object(B.jsx)(Oa.a,{children:"Impuestos"}),Object(B.jsx)(Oa.a,{children:"Total"})]})}),Object(B.jsx)(xa.a,{children:e.datos.productos.map((function(e,t){return Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:e.producto.datos_generales.nombre_comercial}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:e.medida&&e.medida.medida?e.medida.medida:"N/A"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:e.color&&e.color.hex?Object(B.jsx)(Qa.a,{label:e.color.color,size:"small",style:{backgroundColor:e.color.hex,color:a.palette.getContrastText(e.color.hex)}}):"N/A"}),Object(B.jsx)(Oa.a,{children:e.unidad}),Object(B.jsx)(Oa.a,{children:e.cantidad}),Object(B.jsx)(Oa.a,{children:e.cantidad_regalo}),Object(B.jsx)(Oa.a,{children:e.cantidad_total}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(e.subtotal)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(e.impuestos)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(e.total)]})})]},t)}))})]})})})}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{variant:"text",color:"primary",size:"large",startIcon:Object(B.jsx)(Dt.a,{}),onClick:function(){return n()},children:"Aceptar"})})]})})}var tp=Object(k.a)({root:{minWidth:332,maxWidth:332,height:260,maxHeight:260},content:{height:210},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:16},pos:{marginBottom:12}});function ap(e){var t=Object(l.useContext)(Tb),a=t.abonos,n=t.setAbonos,c=tp(),r=e.datos,i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(0),u=Object(g.a)(j,2),b=u[0],m=u[1];return Object(B.jsxs)(p.a,{sx:{display:"flex",flexWrap:"wrap",alignContent:"stretch",p:1,m:1},children:[Object(B.jsxs)(Yb.a,{className:c.root,children:[Object(B.jsxs)(Qb.a,{className:c.content,children:[Object(B.jsxs)(p.a,{display:"flex",flexDirection:"row",m:1,justifyContent:"space-between",children:[Object(B.jsx)(S.a,{className:c.title,color:"textSecondary",children:Object(B.jsx)("b",{children:"Fecha de venta "})}),Object(B.jsx)(S.a,{className:c.title,color:"textSecondary",children:" ".concat(Sa(r.fecha_registro))})]}),Object(B.jsxs)(p.a,{display:"flex",flexDirection:"row",m:1,justifyContent:"space-between",children:[Object(B.jsx)(S.a,{className:c.title,color:"textSecondary",children:Object(B.jsx)("b",{children:"Folio "})}),Object(B.jsx)(S.a,{className:c.title,color:"textSecondary",children:r.folio})]}),r.abonos.length?Object(B.jsxs)(p.a,{display:"flex",flexDirection:"row",m:1,children:[Object(B.jsx)(S.a,{className:c.title,color:"textSecondary",children:Object(B.jsx)("b",{children:"\xdaltimo abono "})}),Object(B.jsx)(S.a,{className:c.title,color:"textSecondary",children:r.abonos[r.abonos.length].fecha_movimiento.completa})]}):Object(B.jsx)("div",{}),Object(B.jsxs)(p.a,{display:"flex",flexDirection:"row",m:1,justifyContent:"space-between",children:[Object(B.jsx)(S.a,{className:c.title,color:"textSecondary",children:Object(B.jsx)("b",{children:"Total venta "})}),Object(B.jsxs)(S.a,{className:c.title,color:"textSecondary",children:["$",Fa(r.total)]})]}),Object(B.jsxs)(p.a,{display:"flex",flexDirection:"row",m:1,justifyContent:"space-between",children:[Object(B.jsx)(S.a,{className:c.title,color:"textSecondary",children:Object(B.jsx)("b",{children:"Debe "})}),Object(B.jsxs)(S.a,{className:c.title,color:"textSecondary",ml:2,children:["$",Fa(r.saldo_credito_pendiente)]})]}),Object(B.jsxs)(p.a,{display:"flex",flexDirection:"row",m:1,justifyContent:"space-between",children:[Object(B.jsx)(S.a,{style:{marginTop:5,marginRight:10},children:Object(B.jsx)("b",{children:"Abonar "})}),Object(B.jsx)(F.a,{style:{width:"45%",marginLeft:15},type:"number",size:"small",variant:"outlined",onChange:function(e){m(e.target.value);var t=a,c=!1;t.forEach((function(t){t.idVenta===r._id&&(t.cantidad_abonar=e.target.value,c=!0)})),c||t.push({idVenta:r._id,cantidad_abonar:e.target.value}),n(t)},value:b})]})]}),Object(B.jsxs)(Kb.a,{style:{justifyContent:"flex-end"},children:[Object(B.jsx)(X.a,{"aria-label":"delete",onClick:function(){return console.log(a)},children:Object(B.jsx)(Jb.a,{})}),Object(B.jsx)(X.a,{"aria-label":"delete",onClick:function(){return d(!0)},children:Object(B.jsx)(Hb.a,{})})]})]}),Object(B.jsx)(ep,{openDetalle:s,setOpenDetalle:d,datos:r})]})}var np=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(6),"px ").concat(e.spacing(4),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}})),cp=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function rp(){var e=Object(l.useContext)(Tb),t=e.openAbonar,a=e.setOpenAbonar,n=e.ventas,c=e.selectedClient,r=np(),i=function(){a(!t)};return Object(B.jsxs)(p.a,{m:1,children:[Object(B.jsx)(w.a,{size:"large",variant:"contained",color:"primary",onClick:i,children:"Abonar"}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:t,onClose:i,TransitionComponent:cp,children:[Object(B.jsx)(Ie.a,{className:r.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:r.title,children:"Detalle de cuenta"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:i,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsxs)("div",{className:r.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"40%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"N\xfamero de Cliente"})}),Object(B.jsx)(p.a,{mt:1,children:Object(B.jsx)(S.a,{children:c.numero_cliente})})]}),Object(B.jsxs)(p.a,{width:"55%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Nombre de Cliente"})}),Object(B.jsx)(p.a,{mt:1,children:Object(B.jsx)(S.a,{children:c.nombre_cliente})})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Domicilio"})}),Object(B.jsx)(p.a,{mt:1,children:Object(B.jsxs)(S.a,{children:[c.direccion.calle,"  ",c.direccion.no_ext]})})]})]}),Object(B.jsx)($e.a,{container:!0,children:n.map((function(e){return Object(B.jsx)(ap,{datos:e})}))})]})]})}var ip=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},titleSelect:{marginLeft:e.spacing(1),flex:1,fontSize:18},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},iconSize:{width:32}}})),op=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function sp(){var e=ip(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=JSON.parse(localStorage.getItem("sesionCafi")),i=Object(l.useContext)(Tb),o=Object(l.useContext)(Xi).clientes,s=Object(l.useState)(""),j=Object(g.a)(s,2),u=(j[0],j[1],Object(l.useState)([])),m=Object(g.a)(u,2),O=m[0],x=m[1],h=(Object(l.useRef)(null),function(){return c(!n)}),_=Object(qe.a)(pb,{variables:{empresa:r.empresa._id,sucursal:r.sucursal._id,idCliente:i.selectedClient._id}});return Object(l.useEffect)((function(){_.data&&x(_.data.historialVentasACredito)}),[_.data]),Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:h,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/salary.svg",alt:"icono abono",className:e.icon})}),"Abonos de Clientes"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:h,TransitionComponent:op,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Abonos de Clientes"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:h,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsxs)($e.a,{item:!0,lg:5,children:[Object(B.jsx)(p.a,{ml:2,mt:1,children:Object(B.jsx)(S.a,{className:e.titleSelect,color:"textPrimary",gutterBottom:!0,children:Object(B.jsx)("b",{children:"Seleccionar cliente "})})}),Object(B.jsx)(p.a,{ml:3,style:{width:"80%"},children:Object(B.jsx)(ja.a,{id:"combo-box-producto-codigo",size:"small",fullWidth:!0,options:o,getOptionLabel:function(e){return e.nombre_cliente?e.nombre_cliente:"N/A"},renderInput:function(e){return Object(B.jsx)(F.a,Object(b.a)(Object(b.a)({},e),{},{variant:"outlined"}))},onChange:function(e,t){return function(e){try{console.log(e);var t=null!==e?e:"";i.setSelectedClient(t)}catch(a){console.log(a)}}(t)},getOptionSelected:function(e,t){return e.nombre_cliente===t.nombre_cliente},value:i.selectedClient?i.selectedClient:null})})]}),i.ventas.length>0?Object(B.jsx)($e.a,{item:!0,lg:7,children:Object(B.jsxs)(p.a,{mt:1,mr:2,display:"flex",justifyContent:"flex-end",alignContent:"space-between",children:[Object(B.jsx)(rp,{}),Object(B.jsx)(Bb,{})]})}):Object(B.jsx)("div",{})]}),Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Lb,{rows:O})})]})]})}function lp(){var e=Object(l.useContext)(vu),t=e.alert,a=e.setAlert,n=JSON.parse(localStorage.getItem("sesionCafi"));return Object(B.jsxs)(y.a,{children:[Object(B.jsx)(J,{alert:t,setAlert:a}),Object(B.jsxs)($e.a,{container:!0,spacing:2,justifyContent:"center",children:[!1===n.accesos.tesoreria.cuentas_empresa.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Lu,{})})}),!1===n.accesos.tesoreria.egresos.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(ib,{})})}),!1===n.accesos.tesoreria.abonos_proveedores.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Ab,{})})}),!1===n.accesos.tesoreria.abonos_clientes.ver?null:Object(B.jsx)(Wb,{children:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(sp,{})})})})]})]})}function dp(){return Object(B.jsx)(Cu,{children:Object(B.jsx)(lp,{})})}var jp,up,bp,pp,mp,Op,xp,hp,_p=Object(l.createContext)(),fp=function(e){var t=e.children,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(l.useState)({serie:"",currency:"MXN",expedition_place:"",folio:"",cfdi_type:"I",payment_form:"",payment_method:"",logo_url:a?a.imagen:"",date:"0",issuer:{FiscalRegime:a?a.empresa.regimen_fiscal:"",Rfc:a?a.empresa.rfc:"",Name:a?a.empresa.nombre_fiscal:""},receiver:{Rfc:"",Name:"",CfdiUse:""},items:[],empresa:a?a.empresa._id:"",sucursal:a?a.sucursal._id:""}),c=Object(g.a)(n,2),r=c[0],i=c[1],o=Object(l.useState)(null),s=Object(g.a)(o,2),d=s[0],j=s[1],u=Object(l.useState)([]),b=Object(g.a)(u,2),p=b[0],m=b[1],O=Object(l.useState)(!1),x=Object(g.a)(O,2),h=x[0],_=x[1],f=Object(l.useState)(""),v=Object(g.a)(f,2),C=v[0],y=v[1],S=Object(l.useState)({status:!1,message:""}),F=Object(g.a)(S,2),w=F[0],I=F[1];return Object(B.jsx)(_p.Provider,{value:{datosFactura:r,setDatosFactura:i,cp_valido:h,setCPValido:_,codigo_postal:C,setCodigoPostal:y,error_validation:w,setError:I,venta_factura:d,setVentaFactura:j,productos:p,setProductos:m},children:t})},gp=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function vp(e){var t=e.productos,a=e.open,n=e.handleClose;return Object(B.jsx)("div",{children:Object(B.jsxs)(Ee.a,{open:a,TransitionComponent:gp,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&n()},children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{style:{display:"flex"},children:[Object(B.jsx)(S.a,{variant:"h6",children:"Productos sin CLAVE del catalogo SAT"}),Object(B.jsx)(p.a,{flexGrow:1}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",size:"large",onClick:function(){return n()},children:Object(B.jsx)(Pt.a,{})})]})}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(Lt.a,{children:"Hay productos sin clave de catalogo de productos del sat, sin esta clave no puede realizar facturas"}),Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{style:{maxHeight:"40vh"},children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"C\xf3digo de barras"}),Object(B.jsx)(Oa.a,{children:"Clave alterna"}),Object(B.jsx)(Oa.a,{children:"Producto"})]})}),Object(B.jsx)(xa.a,{children:t.map((function(e,t){var a=e.id_producto.datos_generales;return Object(B.jsxs)(ma.a,{role:"checkbox",tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:a.codigo_barras})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:a.clave_alterna})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:a.nombre_comercial})})]},t)}))})]})})})]}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{onClick:function(){return n()},color:"inherit",size:"large",children:"Cerrar"})})]})})}Object(P.d)(jp||(jp=Object(N.a)(["\n  query ObtenerConsultaGeneralVentas($empresa: ID!, $sucursal: ID!) {\n    obtenerConsultaGeneralVentas(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      precio\n      cantidad\n      concepto\n      unidad\n      unidad_principal\n      codigo_barras\n      descuento {\n        porciento\n        dinero_descontado\n        precio_con_descuento\n      }\n      descuento_activo\n      default\n      id_producto {\n        datos_generales {\n          nombre_comercial\n          codigo_barras\n          tipo_producto\n          clave_alterna\n        }\n      }\n      inventario_general {\n        cantidad_existente\n        unidad_inventario\n        cantidad_existente_maxima\n        unidad_maxima\n        \n      }\n    }\n  }\n"])));var Cp=Object(P.d)(up||(up=Object(N.a)(["\n  query ObtenerUnProductoVentas(\n    $empresa: ID!\n    $sucursal: ID!\n    $datosProductos: ID!\n  ) {\n    obtenerUnProductoVentas(\n      empresa: $empresa\n      sucursal: $sucursal\n      datosProductos: $datosProductos\n    ) {\n      _id\n      precio\n      cantidad\n      concepto\n      unidad\n      unidad_principal\n      codigo_barras\n      codigo_unidad\n      precio_unidad {\n        numero_precio\n        precio_neto\n        precio_venta\n        iva_precio\n        ieps_precio\n        unidad_mayoreo\n        precio_general\n        cantidad_unidad\n        unidad_maxima\n      }\n      descuento {\n        cantidad_unidad\n        numero_precio\n        unidad_maxima\n        precio_general\n        precio_neto\n        precio_venta\n        iva_precio\n        ieps_precio\n        utilidad\n        dinero_descontado\n        porciento\n      }\n      medida {\n        talla\n        tipo\n        _id\n      }\n      color {\n        hex\n        nombre\n        _id\n      }\n      descuento_activo\n      default\n      id_producto {\n        imagenes {\n          url_imagen\n        }\n        _id\n        datos_generales {\n          nombre_comercial\n          codigo_barras\n          tipo_producto\n          clave_alterna\n          nombre_generico\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          ieps\n          ieps_activo\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n            codigo_unidad\n          }\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          precio_de_compra {\n            precio_con_impuesto\n            precio_sin_impuesto\n            iva\n            ieps\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n            codigo_unidad\n          }\n        }\n      }\n      inventario_general {\n        cantidad_existente\n        unidad_inventario\n        cantidad_existente_maxima\n        unidad_maxima\n        codigo_unidad\n      }\n    }\n  }\n"]))),yp=Object(P.d)(bp||(bp=Object(N.a)(["\n  query ObtenerProductosVentas(\n    $empresa: ID!\n    $sucursal: ID!\n    $input: ObtenerProductosVentasInput\n  ) {\n    obtenerProductosVentas(\n      empresa: $empresa\n      sucursal: $sucursal\n      input: $input\n    ) {\n      _id\n      precio\n      cantidad\n      concepto\n      unidad\n      unidad_principal\n      codigo_barras\n      codigo_unidad\n      precio_unidad {\n        numero_precio\n        precio_neto\n        precio_venta\n        iva_precio\n        ieps_precio\n        unidad_mayoreo\n        precio_general\n        cantidad_unidad\n        unidad_maxima\n      }\n      descuento {\n        cantidad_unidad\n        numero_precio\n        unidad_maxima\n        precio_general\n        precio_neto\n        precio_venta\n        iva_precio\n        ieps_precio\n        utilidad\n        dinero_descontado\n        porciento\n      }\n      medida {\n        talla\n        tipo\n        _id\n      }\n      color {\n        hex\n        nombre\n        _id\n      }\n      descuento_activo\n      default\n      id_producto {\n        imagenes {\n          url_imagen\n        }\n        _id\n        datos_generales {\n          nombre_comercial\n          codigo_barras\n          tipo_producto\n          clave_alterna\n          nombre_generico\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          ieps\n          ieps_activo\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n            codigo_unidad\n          }\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          precio_de_compra {\n            precio_con_impuesto\n            precio_sin_impuesto\n            iva\n            ieps\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n            codigo_unidad\n          }\n        }\n      }\n      inventario_general {\n        cantidad_existente\n        unidad_inventario\n        cantidad_existente_maxima\n        unidad_maxima\n        codigo_unidad\n        id_almacen_general\n      }\n    }\n  }\n"]))),Sp=Object(P.d)(pp||(pp=Object(N.a)(["\n  query ObtenerClientesVentas($empresa: ID!, $sucursal: ID!) {\n    obtenerClientesVentas(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      numero_cliente\n      clave_cliente\n      nombre_cliente\n      rfc\n      curp\n      telefono\n      celular\n      email\n      numero_descuento\n      limite_credito\n      dias_credito\n      razon_social\n      direccion {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      imagen\n      banco\n      numero_cuenta\n      monedero_electronico\n      credito_disponible\n    }\n  }\n"]))),Fp=Object(P.d)(mp||(mp=Object(N.a)(["\n  mutation createVenta(\n    $input: CrearVentasInput!\n    $empresa: ID!\n    $sucursal: ID!\n    $usuario: ID!\n    $caja: ID!\n  ) {\n    createVenta(\n      input: $input\n      empresa: $empresa\n      sucursal: $sucursal\n      usuario: $usuario\n      caja: $caja\n    ) {\n      message\n    }\n  }\n"]))),wp=Object(P.d)(Op||(Op=Object(N.a)(["\nquery obtenerVentasSucursal($empresa: ID!, $sucursal: ID!, $filtros: filtrosObtenerVentas ) {\n\t\tobtenerVentasSucursal(empresa: $empresa, sucursal: $sucursal, filtros: $filtros) {\n\t\t\t_id\n      folio\n      cliente {\n        _id\n        numero_cliente\n        clave_cliente\n        representante\n        nombre_cliente\n        rfc\n        curp\n        telefono\n        celular\n        email\n        numero_descuento\n        limite_credito\n        dias_credito\n        razon_social\n        direccion{\n          calle\n          no_ext\n          no_int\n          codigo_postal\n          colonia\n          municipio\n          localidad\n          estado\n          pais\n        }\n        imagen\n        eliminado\n        banco\n        numero_cuenta\n        monedero_electronico\n        credito_disponible\n      }\n      descuento\n      ieps\n      impuestos\n      iva\n      monedero\n      subTotal\n      total\n      venta_cliente\n      credito\n      descuento_general_activo\n      id_caja{\n        _id\n        numero_caja\n        activa\n      }\n      fecha_de_vencimiento_credito\n      dias_de_credito_venta\n      empresa\n      sucursal\n      usuario{\n        _id\n        numero_usuario\n        nombre\n      }\n      productos{\n        _id\n        id_producto{\n          _id\n          datos_generales{\n            codigo_barras\n            clave_alterna\n            tipo_producto\n            nombre_comercial\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat{\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n          precios{\n            ieps\n            ieps_activo\n            inventario{\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n              codigo_unidad\n            }\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            precio_de_compra{\n              precio_con_impuesto\n              precio_sin_impuesto\n              iva\n              ieps\n            }\n            precios_producto{\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n            unidad_de_compra{\n              cantidad\n              precio_unitario_con_impuesto\n              precio_unitario_sin_impuesto\n              unidad\n              codigo_unidad\n            }\n            granel\n            litros\n          }\n          imagenes{\n            url_imagen\n            location_imagen\n            key_imagen\n            extencion_imagen\n          }\n          centro_de_costos{\n            cuenta\n            id_cuenta\n            id_subcuenta\n            subcuenta\n          }\n          precio_plazos{\n            precio_cajas{\n              plazo\n              unidad\n              codigo_unidad\n              precio\n            }\n            precio_costales{\n              plazo\n              unidad\n              codigo_unidad\n              precio\n            }\n            precio_piezas{\n              plazo\n              unidad\n              codigo_unidad\n              precio\n            }\n          }\n          unidades_de_venta{\n            _id\n            precio\n            cantidad\n            concepto\n            unidad\n            codigo_unidad\n            unidad_principal\n            codigo_barras\n            codigo_barras\n            id_producto\n            empresa\n            sucursal\n            descuento{\n              cantidad_unidad\n              numero_precio\n              unidad_maxima\n              precio_general\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              porciento\n              dinero_descontado\n            }\n            descuento_activo\n            default\n            precio_unidad{\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n          inventario_general{\n            _id\n            cantidad_existente\n            unidad_inventario\n            codigo_unidad\n            cantidad_existente_maxima\n            unidad_maxima\n            id_almacen_general\n            eliminado\n          }\n          medidas_producto{\n            _id\n            cantidad\n            cantidad_nueva\n            almacen\n            codigo_barras\n            color{\n              hex\n              nombre\n              _id\n            }\n            descuento{\n              cantidad_unidad\n              numero_precio\n              unidad_maxima\n              precio_general\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              porciento\n              dinero_descontado\n            }\n            descuento_activo\n            existencia\n            medida{\n              talla\n              tipo\n              _id\n            }\n            nombre_comercial\n            precio\n            precio_unidad{\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n          empresa\n          sucursal\n        }\n        concepto\n        cantidad\n        iva_total\n        ieps_total\n        subtotal\n        impuestos\n        total\n        medida{\n          id_medida\n          medida\n          tipo\n        }\n        color{\n          id_color\n          color\n          hex\n        }\n        cantidad_venta\n        granel_producto{\n          granel\n          valor\n        }\n        precio\n        precio_a_vender\n        precio_actual_producto\n        default\n        unidad\n        codigo_unidad\n        id_unidad_venta{\n          _id\n          precio\n          cantidad\n          concepto\n          unidad\n          codigo_unidad\n          unidad_principal\n          unidad_activa\n          codigo_barras\n          id_producto\n          descuento{\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n          descuento_activo\n          default\n          precio_unidad{\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n        }\n        inventario_general{\n          _id\n          cantidad_existente\n          unidad_inventario\n          codigo_unidad\n          cantidad_existente_maxima\n          unidad_maxima\n          id_almacen_general\n          eliminado\n        }\n        year_registro\n        fecha_registro\n        precio_unidad{\n          numero_precio\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          unidad_mayoreo\n          utilidad\n          precio_general\n          cantidad_unidad\n          unidad_maxima\n        }\n        precio_actual_object{\n          cantidad_unidad\n          numero_precio\n          unidad_maxima\n          unidad_mayoreo\n          precio_general\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          utilidad\n          porciento\n          dinero_descontado\n        }\n      }\n      fecha_registro\n      factura{\n        id_cfdi\n        serie\n        currency\n        expedition_place\n        folio\n        cfdi_type\n        payment_form\n        payment_method\n        logo_url\n        date\n        issuer{\n          FiscalRegime\n          Rfc\n          Name\n        }\n        receiver{\n          Rfc\n          Name\n          CfdiUse\n        }\n        items{\n          ProductCode\n          IdentificationNumber\n          Description\n          Unit\n          UnitCode\n          UnitPrice\n          Quantity\n          Subtotal\n          Discount\n          Taxes{\n            Total\n            Name\n            Base\n            Rate\n            IsRetention\n          }\n          Total\n        }\n        original_string\n        sub_total\n        total\n        discount\n        fecha_registro\n        empresa\n        sucursal\n      }\n      montos_en_caja{\n        monto_efectivo{\n          monto\n          metodo_pago\n        }\n        monto_tarjeta_debito{\n          monto\n          metodo_pago\n        }\n        monto_tarjeta_credito{\n          monto\n          metodo_pago\n        }\n        monto_creditos{\n          monto\n          metodo_pago\n        }\n        monto_monedero{\n          monto\n          metodo_pago\n        }\n        monto_transferencia{\n          monto\n          metodo_pago\n        }\n        monto_cheques{\n          monto\n          metodo_pago\n        }\n        monto_vales_despensa{\n          monto\n          metodo_pago\n        }\n      }\n      status\n      tipo_emision\n      forma_pago\n      metodo_pago\n\t\t}\n\t}\n"]))),Ip=Object(P.d)(xp||(xp=Object(N.a)(["\nquery obtenerVentasReportes($empresa: ID!, $sucursal: ID!, $filtros: filtrosReportesVentas ) {\n\t\tobtenerVentasReportes(empresa: $empresa, sucursal: $sucursal, filtros: $filtros) {\n\t\t\t_id\n      id_compra\n      id_traspaso\n      id_producto\n      id_proveedor\n      id_almacen\n      almacen {\n        id_almacen\n        nombre_almacen\n      }\n      proveedor {\n        _id\n        clave_cliente\n        numero_cliente\n        nombre_cliente\n      }\n      producto {\n        almacen_inicial {\n          almacen\n          cantidad\n          fecha_de_expiracion\n          id_almacen\n        }\n        datos_generales {\n          codigo_barras\n          clave_alterna\n          tipo_producto\n          nombre_comercial\n          nombre_generico\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          ieps\n          ieps_activo\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          granel\n          litros\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n            codigo_unidad\n          }\n          precio_de_compra {\n            precio_con_impuesto\n            precio_sin_impuesto\n            iva\n            ieps\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            unidad\n            codigo_unidad\n          }\n        }\n        unidades_de_venta {\n          cantidad\n          codigo_barras\n          id_producto\n          precio\n          unidad\n          unidad_principal\n          _id\n          precio_unidad {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n        }\n      }\n      concepto\n      cantidad\n      cantidad_regalo\n      unidad_regalo\n      cantidad_total\n      iva_total\n      ieps_total\n      costo\n      descuento_porcentaje\n      descuento_precio\n      compra_credito\n      venta_credito\n      forma_pago\n      impuestos\n      mantener_precio\n      subtotal\n      total\n      medida {\n        id_medida\n        medida\n        tipo\n      }\n      color {\n        id_color\n        color\n        hex\n      }\n      unidad\n      id_unidad_venta\n      empresa\n      sucursal\n      usuario\n      year_registro\n      numero_semana_year\n      numero_mes_year\n      fecha_registro\n\t\t}\n\t}\n"]))),kp=Object(P.d)(hp||(hp=Object(N.a)(["\n  mutation cancelarVentasSucursal(\n    $empresa: ID!\n    $sucursal: ID!\n    $folio: String!\n  \t$input: cancelarVentaInput\n  ) {\n    cancelarVentasSucursal(\n      empresa: $empresa\n      sucursal: $sucursal\n      folio: $folio\n      input: $input\n    ) {\n      message\n    }\n  }\n"]))),zp=["productos"],Np=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),Pp=Object(k.a)((function(e){return{container:{height:"50vh"}}}));function Dp(){var e=Object(l.useState)(!1),t=Object(g.a)(e,2),a=t[0],n=t[1],c=function(){return n(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{onClick:function(){return n(!0)},size:"small",children:Object(B.jsx)(sc.a,{})}),Object(B.jsxs)(Ee.a,{maxWidth:"md",fullWidth:!0,open:a,onClose:function(e,t){"backdropClick"!==t&&c()},TransitionComponent:Np,children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{style:{display:"flex"},children:[Object(B.jsx)(S.a,{variant:"h6",children:"Selecionar venta"}),Object(B.jsx)(p.a,{flexGrow:1}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",size:"large",onClick:function(){return c()},children:Object(B.jsx)(Pt.a,{})})]})}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(Ep,{handleClose:c})}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{onClick:function(){return c()},children:"Cancelar"})})]})]})}var Ep=function(e){var t=e.handleClose,a=Object(l.useState)(""),n=Object(g.a)(a,2),c=n[0],r=n[1],i=JSON.parse(localStorage.getItem("sesionCafi")),o=Object(l.useState)(!1),s=Object(g.a)(o,2),d=s[0],j=s[1],u=Object(l.useState)([]),b=Object(g.a)(u,2),m=b[0],O=b[1],x=Object(Da.useDebounce)(c,500),h=Object(g.a)(x,1)[0],_=Object(qe.a)(wp,{variables:{empresa:i.empresa._id,sucursal:i.sucursal._id,filtro:h},fetchPolicy:"network-only"});return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(vp,{productos:m,open:d,handleClose:function(){return j(!1)}}),Object(B.jsx)(p.a,{mb:2,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,sm:8,xs:12,children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",placeholder:"Buscar por: Folio, cliente, clave o nombre",variant:"outlined",onChange:function(e){return r(e.target.value)},value:c})}),Object(B.jsx)($e.a,{item:!0,sm:4,xs:12,children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",variant:"outlined",type:"date",onChange:function(e){return r(e.target.value)}})})]})}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(St.a,{severity:"info",children:"Para seleccionar una venta haz un doble click!"})}),Object(B.jsx)(Ap,{resultado_ventas:_,handleClose:t,setProductosSinClave:O,openProductosClaves:function(){return j(!0)}})]})},Ap=function(e){var t=e.resultado_ventas,a=e.handleClose,n=e.setProductosSinClave,c=e.openProductosClaves,r=Pp(),i=Object(l.useState)(""),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useContext)(_p),u=j.setVentaFactura,m=j.setProductos,O=t.loading,x=t.data,h=t.error;if(O)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",children:Object(B.jsx)(I.a,{})});if(h)return Object(B.jsx)(Ze,{});var _=x.obtenerVentasSucursal;return Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{className:r.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Folio"}),Object(B.jsx)(Oa.a,{children:"Cliente"}),Object(B.jsx)(Oa.a,{children:"Usuario"}),Object(B.jsx)(Oa.a,{children:"Caja"}),Object(B.jsx)(Oa.a,{children:"Descuento"}),Object(B.jsx)(Oa.a,{children:"Subtotal"}),Object(B.jsx)(Oa.a,{children:"Impuestos"}),Object(B.jsx)(Oa.a,{children:"Total"})]})}),Object(B.jsx)(xa.a,{children:_.map((function(e,t){return Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:e.folio===s,onClick:function(t){return function(e,t){if(d(t.folio),2===e){console.log(t);var r=t.productos.filter((function(e){return!e.id_producto.datos_generales.clave_producto_sat.Value}));if(r.length>0)return n(r),void c();var i=Object(b.a)({},t),o=(i.productos,Object(ve.a)(i,zp)),s=Object(da.a)(t.productos);u(o),m(s),a()}}(t.detail,e)},children:[Object(B.jsx)(Oa.a,{children:e.folio}),Object(B.jsx)(Oa.a,{children:null!==e.cliente?e.cliente.nombre_cliente:"-"}),Object(B.jsx)(Oa.a,{children:e.usuario.nombre}),Object(B.jsx)(Oa.a,{children:e.id_caja.numero_caja}),Object(B.jsxs)(Oa.a,{children:["$",e.descuento?Fa(e.descuento):0]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.subTotal)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.impuestos)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.total)]})]},t)}))})]})})})};function Tp(){var e=d.a.useState(!1),t=Object(g.a)(e,2),a=t[0],n=t[1],c=d.a.useContext(_p),r=c.cp_valido,i=c.setCPValido,o=(c.codigo_postal,c.setCodigoPostal),s=c.error_validation,l=d.a.useState(""),j=Object(g.a)(l,2),u=j[0],b=j[1],p=Object(Da.useDebounce)(u,500),m=Object(g.a)(p,1)[0],O=d.a.useCallback(function(){var e=Object(f.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,n(!0),e.next=6,Oc.Catalogs.PostalCodes(t,(function(e){return e}));case 6:(a=e.sent)&&(i(!0),n(!1),o(a[0].Value)),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),n(!1),i(!1),o("");case 15:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),[]);return d.a.useEffect((function(){O(m)}),[m]),Object(B.jsx)(d.a.Fragment,{children:Object(B.jsx)("form",{onSubmit:O,children:Object(B.jsx)(F.a,{fullWidth:!0,name:"expedition_place",size:"small",variant:"outlined",value:u,label:"C\xf3digo postal",onChange:function(e){return b(e.target.value)},InputProps:{endAdornment:Object(B.jsx)(Q.a,{position:"end",children:u?a?Object(B.jsx)(I.a,{size:20}):r?Object(B.jsx)(Ps.a,{color:"primary"}):Object(B.jsx)(Lo.a,{color:"error"}):Object(B.jsx)("div",{})})},error:!(!s.status||u)||!!u&&!r,helperText:s.status&&!u?s.message:u?r?"":"Introduce un CP valido":""})})})}var Wp=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),$p=Object(k.a)((function(e){return{container:{height:"50vh"}}}));function Rp(){var e=Object(l.useState)(!1),t=Object(g.a)(e,2),a=t[0],n=t[1],c=function(){return n(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{onClick:function(){return n(!0)},size:"small",children:Object(B.jsx)(sc.a,{})}),Object(B.jsxs)(Ee.a,{maxWidth:"md",fullWidth:!0,open:a,onClose:function(e,t){"backdropClick"!==t&&c()},TransitionComponent:Wp,children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{style:{display:"flex"},children:[Object(B.jsx)(S.a,{variant:"h6",children:"Selecionar cliente"}),Object(B.jsx)(p.a,{flexGrow:1}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",size:"large",onClick:function(){return c()},children:Object(B.jsx)(Pt.a,{})})]})}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(Vp,{handleClose:c})}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{size:"large",onClick:function(){return c()},children:"Cancelar"})})]})]})}var Vp=function(e){var t=e.handleClose,a=Object(l.useState)(""),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=JSON.parse(localStorage.getItem("sesionCafi")),u=Object(_c.a)(c,500),b=Object(g.a)(u,1)[0],m=Object(qe.a)(Oo,{variables:{tipo:"CLIENTE",filtro:b,empresa:j.empresa._id,eliminado:!1},fetchPolicy:"network-only"}),O=function(){d(!1)};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(Ee.a,{open:s,TransitionComponent:Wp,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&O()},children:[Object(B.jsx)(Ae.a,{children:Object(B.jsx)(St.a,{severity:"info",children:"Deber registrar un RFC y RAZON SOCIAL a este cliente."})}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{onClick:function(){return O()},color:"primary",children:"Aceptar"})})]}),Object(B.jsxs)(p.a,{mb:2,display:"flex",alignItems:"center",children:[Object(B.jsx)(F.a,{fullWidth:!0,size:"small",placeholder:"Buscar por: Numero de cliente, clave o nombre",variant:"outlined",onChange:function(e){return r(e.target.value)},value:c}),Object(B.jsx)(fo,{tipo:"CLIENTE",accion:"registrar",refetch:m.refetch})]}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(St.a,{severity:"info",children:"Para seleccionar un cliente haz un doble click!"})}),Object(B.jsx)(Mp,{handleClose:t,resultado_clientes:m,openAlertRFC:function(){d(!0)}})]})},Mp=function(e){var t=e.handleClose,a=e.resultado_clientes,n=e.openAlertRFC,c=$p(),r=Object(l.useState)(""),i=Object(g.a)(r,2),o=i[0],s=i[1],d=Object(l.useContext)(_p),j=d.datosFactura,u=d.setDatosFactura,m=a.loading,O=a.data,x=a.error,h=a.refetch;if(m)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",children:Object(B.jsx)(I.a,{})});if(x)return Object(B.jsx)(Ze,{});var _=O.obtenerClientes;return Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{className:c.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{minwidth:"100",children:"No. Cliente"}),Object(B.jsx)(Oa.a,{minwidth:"100",children:"Clave"}),Object(B.jsx)(Oa.a,{minwidth:"150",children:"Nombre"}),Object(B.jsx)(Oa.a,{minwidth:"150",children:"Razon Social"}),Object(B.jsx)(Oa.a,{minwidth:"150",children:"RFC"}),Object(B.jsx)(Oa.a,{minwidth:"150",children:"Editar Cliente"})]})}),Object(B.jsx)(xa.a,{children:_.map((function(e,a){return Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",tabIndex:-1,onClick:function(a){return function(e,a){if(s(a.nombre_cliente),2===e){if(!a.rfc)return void n();u(Object(b.a)(Object(b.a)({},j),{},{receiver:Object(b.a)(Object(b.a)({},j.receiver),{},{Name:a.nombre_cliente,Rfc:a.rfc})})),t()}}(a.detail,e)},selected:e.nombre_cliente===o,children:[Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:e.numero_cliente})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:e.clave_cliente})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:e.nombre_cliente})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:e.razon_social})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:e.rfc?e.rfc:Object(B.jsx)(Lo.a,{color:"primary"})})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(fo,{tipo:"CLIENTE",accion:"actualizar",datos:e,refetch:h})})]},a)}))})]})})})};function Lp(e){var t=e.serie_default,a=Object(l.useContext)(_p),n=a.datosFactura,c=a.setDatosFactura,r=a.error_validation,i=a.venta_factura;Object(l.useEffect)((function(){var e=t[0],a=e.folio,r=e.serie;c(Object(b.a)(Object(b.a)({},n),{},{folio:a.toString(),serie:r}))}),[]);var o=function(e){var t=e.target,a=t.name,r=t.value;console.log(a,r),c(Object(b.a)(Object(b.a)({},n),{},Object(_.a)({},a,r)))};return Object(B.jsxs)("div",{children:[Object(B.jsxs)($e.a,{container:!0,spacing:5,children:[Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsxs)(p.a,{mb:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Emisor: ".concat(n.issuer.Name)})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:4,xs:12,children:[Object(B.jsx)(S.a,{children:"RFC"}),Object(B.jsx)(F.a,{size:"small",variant:"outlined",fullWidth:!0,value:n.issuer.Rfc,disabled:!0,error:r.status&&!n.issuer.Rfc,helperText:r.status&&!n.issuer.Rfc?r.message:""})]}),Object(B.jsxs)($e.a,{item:!0,md:4,xs:12,children:[Object(B.jsx)(S.a,{children:"Regimen fiscal"}),Object(B.jsx)(H.a,{fullWidth:!0,size:"small",variant:"outlined",children:Object(B.jsx)(F.a,{size:"small",variant:"outlined",fullWidth:!0,value:n.issuer.FiscalRegime,disabled:!0,error:r.status&&!n.issuer.FiscalRegime,helperText:r.status&&!n.issuer.FiscalRegime?r.message:""})})]})]})]}),Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsxs)(p.a,{mb:1,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Receptor"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:4,xs:12,children:[Object(B.jsx)(S.a,{children:"Cliente"}),Object(B.jsx)(F.a,{value:n.receiver.Name,placeholder:"Selecciona un cliente",fullWidth:!0,size:"small",variant:"outlined",InputProps:{endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(Rp,{})}),readOnly:!0,disabled:!0},error:r.status&&!n.receiver.Name,helperText:r.status&&!n.receiver.Name?r.message:""})]}),Object(B.jsxs)($e.a,{item:!0,md:4,xs:12,children:[Object(B.jsx)(S.a,{children:"RFC"}),Object(B.jsx)(F.a,{size:"small",variant:"outlined",fullWidth:!0,value:n.receiver.Rfc,disabled:!0,error:r.status&&!n.receiver.Rfc,helperText:r.status&&!n.receiver.Rfc?r.message:""})]})]})]})]}),Object(B.jsxs)(p.a,{mt:1,mb:2,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Datos factura"})}),Object(B.jsx)(Le.a,{})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,xs:12,sm:4,md:3,children:Object(B.jsx)(F.a,Object(_.a)({value:n.cliente,placeholder:"Selecciona venta a facturar",fullWidth:!0,size:"small",label:"Folio Venta",variant:"outlined",InputProps:{endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(Dp,{})}),readOnly:!0,disabled:!0}},"value",i?i.folio:""))}),Object(B.jsx)($e.a,{item:!0,xs:12,sm:4,md:1,children:Object(B.jsx)(F.a,{value:n.folio,label:"Folio",fullWidth:!0,size:"small",variant:"outlined",disabled:!0,error:r.status&&!n.folio,helperText:r.status&&!n.folio?r.message:""})}),Object(B.jsx)($e.a,{item:!0,xs:12,sm:4,md:1,children:Object(B.jsx)(F.a,{value:n.serie,label:"Serie",fullWidth:!0,size:"small",variant:"outlined",disabled:!0,error:r.status&&!n.serie,helperText:r.status&&!n.serie?r.message:""})}),Object(B.jsx)($e.a,{item:!0,xs:12,sm:4,md:2,children:Object(B.jsxs)(H.a,{variant:"outlined",fullWidth:!0,size:"small",name:"cfdi_type",error:r.status&&!n.cfdi_type,children:[Object(B.jsx)(Y.a,{id:"cfdi_type",children:"Tipo de CFDI"}),Object(B.jsxs)(mt.a,{labelId:"cfdi_type",value:n.cfdi_type,name:"cfdi_type",onChange:o,label:"tipo de CFDI",children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),ft.map((function(e,t){return Object(B.jsx)(Ot.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(B.jsx)(ua.a,{children:r.status&&!n.cfdi_type?r.message:""})]})}),Object(B.jsx)($e.a,{item:!0,xs:12,sm:4,md:2,children:Object(B.jsxs)(H.a,{variant:"outlined",fullWidth:!0,size:"small",name:"currency",error:r.status&&!n.currency,children:[Object(B.jsx)(Y.a,{id:"moneda",children:"Moneda"}),Object(B.jsxs)(mt.a,{labelId:"moneda",value:n.currency,name:"currency",onChange:o,label:"moneda",children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),gt.map((function(e,t){return Object(B.jsx)(Ot.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(B.jsx)(ua.a,{children:r.status&&!n.currency?r.message:""})]})}),Object(B.jsx)($e.a,{item:!0,xs:12,sm:4,md:3,children:Object(B.jsx)(Tp,{})})]})]})}var Up=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Bp(e){var t=e.venta,a=e.producto,n=e.index,c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useContext)(_p),d=s.setVentaFactura,j=s.setProductos,u=s.productos,m=Object(l.useState)(Object(b.a)({},a)),O=Object(g.a)(m,2),x=O[0],h=O[1],v=Object(l.useState)(Object(b.a)({},t)),y=Object(g.a)(v,2),I=y[0],k=y[1],z=Object(l.useState)(x.cantidad_venta),N=Object(g.a)(z,2),P=N[0],D=N[1],E=Object(l.useState)(x.precio_actual_object.precio_neto),A=Object(g.a)(E,2),T=A[0],W=A[1],$=Object(l.useState)(!1),R=Object(g.a)($,2),V=R[0],M=R[1],L=function(){o(!1)},U=function(){var e=Object(f.a)(C.a.mark((function e(t){var a,n,c,r,i,o,s,l,d,j,u,p,m,O,f,g,v,y,S,F,w,z,N,E,A;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target,n=a.name,c=a.value,"cantidad_venta"===n?D(c):W(c),c){e.next=4;break}return e.abrupt("return");case 4:return r=Object(b.a)({},I),i=Object(b.a)({},x),o=Object(b.a)({},i),s=o.precio_actual_object,l=o.cantidad_venta,d=o.granel_producto,j=Object(b.a)({},i.id_producto),u=j.precios,e.next=10,ka({newP:i,cantidad:l,granel:d,precio_boolean:!0,precio:s});case 10:if(p=e.sent,r.iva=r.iva-p.ivaCalculo,r.ieps=r.ieps-p.iepsCalculo,r.impuestos=r.impuestos-p.impuestoCalculo,r.subTotal=r.subTotal-p.subtotalCalculo,r.total=r.total-p.totalCalculo,r.monedero=r.monedero-p.monederoCalculo,"cantidad_venta"!==n){e.next=25;break}return e.next=20,ka({newP:i,cantidad:parseFloat(c),granel:d,precio_boolean:!0,precio:s});case 20:m=e.sent,i.cantidad_venta=parseFloat(c),h(Object(b.a)(Object(b.a)({},i),{},Object(_.a)({},n,parseFloat(c)))),e.next=46;break;case 25:return O=parseFloat(c),f=u.iva,g=u.ieps,v=parseFloat("0.".concat(f<10?"0".concat(f):f))+parseFloat("0.".concat(g<10?"0".concat(g):g)),y=parseFloat((O/l).toFixed(2)),S=parseFloat((y/(v+1)).toFixed(2)),F=parseFloat(S*parseFloat("0.".concat(f<10?"0".concat(f):f)).toFixed(2)),w=parseFloat(S*parseFloat("0.".concat(g<10?"0".concat(g):g)).toFixed(2)),z=u.unidad_de_compra.precio_unitario_sin_impuesto,N=parseFloat(((S-z)/z*100).toFixed(2)),E=Object(b.a)({},s),A=w+F,E.ieps_precio=w,E.iva_precio=F,E.precio_venta=S,E.precio_neto=y,E.utilidad=N,s.unidad_maxima&&(s.precio_general=O),e.next=44,ka({newP:i,cantidad:l,granel:d,precio_boolean:!0,precio:E});case 44:m=e.sent,h(Object(b.a)(Object(b.a)({},i),{},{precio_actual_object:E,ieps_total:E.ieps_precio*P,iva_total:E.iva_precio*P,precio_a_vender:E.precio_neto*P,precio_actual_producto:E.precio_neto*P,subtotal:E.precio_venta*P,impuestos:A*P,total:E.precio_neto*P}));case 46:r.iva=r.iva+m.ivaCalculo,r.ieps=r.ieps+m.iepsCalculo,r.impuestos=r.impuestos+m.impuestoCalculo,r.subTotal=r.subTotal+m.subtotalCalculo,r.total=r.total+m.totalCalculo,r.monedero=r.monedero+m.monederoCalculo,k(r);case 53:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(e){M(!e)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{size:"small",onClick:function(){o(!0)},children:Object(B.jsx)(en.a,{})}),Object(B.jsxs)(Ee.a,{open:i,TransitionComponent:Up,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&L()},fullWidth:!0,maxWidth:"md",children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{style:{display:"flex"},children:[Object(B.jsx)(S.a,{variant:"h6",children:x.id_producto.datos_generales.nombre_comercial}),Object(B.jsx)(p.a,{flexGrow:1}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",size:"large",onClick:function(){return L(),h(a),k(t),D(a.cantidad_venta),void W(a.precio_actual_object.precio_neto)},children:Object(B.jsx)(Pt.a,{})})]})}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(p.a,{mb:2,children:Object(B.jsxs)(p.a,{mb:2,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Producto"})}),Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{style:{width:50},children:"Cantidad"}),Object(B.jsx)(Oa.a,{style:{width:50},children:"Precio"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Subtotal"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Impuestos"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Total"})]})}),Object(B.jsx)(xa.a,{children:Object(B.jsxs)(ma.a,{tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:Object(B.jsx)(F.a,{variant:"outlined",size:"small",value:P,type:"number",name:"cantidad_venta",InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:x.unidad})},onChange:U,placeholder:a?a.cantidad_venta.toString():"",onBlur:function(e){return q(e.target.value)},error:V&&!P})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(F.a,{variant:"outlined",size:"small",value:T,type:"number",name:"precio_neto",InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})},onChange:U,placeholder:a.precio_actual_object.precio_neto.toString(),onBlur:function(e){return q(e.target.value)},error:V&&!T})}),Object(B.jsxs)(Oa.a,{children:["$",Fa(x.subtotal)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(x.impuestos)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(x.total)]})]})})]})})]})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Venta"})})}),Object(B.jsx)(Le.a,{}),Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{style:{width:50},children:"IVA"}),Object(B.jsx)(Oa.a,{style:{width:50},children:"IEPS"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Subtotal"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Impuestos"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Total"})]})}),Object(B.jsx)(xa.a,{children:Object(B.jsxs)(ma.a,{tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(I.iva)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(I.ieps)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:[" $",Fa(I.subTotal)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(I.impuestos)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:[" $",Fa(I.total)]})})]})})]})})]}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{onClick:function(){return function(){if(!V){var e=Object(da.a)(u);e.splice(n,1,x),d(I),j(e),L()}}()},variant:"contained",color:"primary",children:"Guardar"})})]})]})}var qp=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Jp(e){var t=e.venta,a=e.producto,n=e.index,c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useContext)(_p),d=s.setVentaFactura,j=s.setProductos,u=s.productos,p=a.id_producto.datos_generales,m=function(){o(!1)},O=function(){var e=Object(f.a)(C.a.mark((function e(){var c,r,i,o,s,l,p,O,x,h,_,f,g,v,y,S,F,w;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object(b.a)({},t),r=Object(da.a)(u),i=a.cantidad_venta,o=a.granel_producto,s=a.precio_actual_object,l=c.iva,p=c.ieps,O=c.impuestos,x=c.subTotal,h=c.total,_=c.monedero,e.next=6,ka({newP:a,cantidad:i,granel:o,precio_boolean:!0,precio:s});case 6:f=e.sent,console.log(f),g=f.ivaCalculo,v=f.iepsCalculo,y=f.impuestoCalculo,S=f.subtotalCalculo,F=f.totalCalculo,w=f.monederoCalculo,c.iva=l-g,c.ieps=p-v,c.impuestos=O-y,c.subTotal=x-S,c.total=h-F,c.monedero=_-w,r.splice(n,1),d(c),j(r),m();case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{size:"small",onClick:function(){o(!0)},children:Object(B.jsx)(Pt.a,{})}),Object(B.jsxs)(Ee.a,{open:i,TransitionComponent:qp,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&m()},children:[Object(B.jsx)(wt.a,{children:"\xbfEst\xe1 seguro de eliminar este producto?"}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{style:{width:100},children:"Producto"}),Object(B.jsx)(Oa.a,{style:{width:50},children:"Cantidad"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Subtotal"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Impuestos"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Total"})]})}),Object(B.jsx)(xa.a,{children:Object(B.jsxs)(ma.a,{tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:p.nombre_comercial}),Object(B.jsx)(Oa.a,{children:a.cantidad_venta}),Object(B.jsxs)(Oa.a,{children:["$",Fa(a.subtotal)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(a.impuestos)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(a.total)]})]})})]})})}),Object(B.jsxs)(Ue.a,{style:{justifyContent:"center"},children:[Object(B.jsx)(w.a,{onClick:function(){return m()},color:"inherit",children:"Cancelar"}),Object(B.jsx)(w.a,{onClick:function(){return O()},color:"secondary",children:"Eliminar"})]})]})]})}var Gp=Object(k.a)({root:{width:"100%"},container:{height:"36vh"}});function Hp(){var e=Gp(),t=Object(l.useContext)(_p),a=t.venta_factura,n=t.productos;return a?Object(B.jsxs)(Ka.a,{className:e.root,variant:"elevation",children:[Object(B.jsx)(p.a,{textAlign:"center",children:Object(B.jsx)(S.a,{variant:"button",children:"Detalles de Venta"})}),Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{style:{width:250},children:"Folio"}),Object(B.jsx)(Oa.a,{style:{width:50},children:"Cliente"}),Object(B.jsx)(Oa.a,{style:{width:50},children:"Descuento"}),Object(B.jsx)(Oa.a,{style:{width:50},children:"IVA"}),Object(B.jsx)(Oa.a,{style:{width:50},children:"IEPS"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Subtotal"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Impuestos"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Total"}),Object(B.jsx)(Oa.a,{style:{width:50},children:"Usuario"}),Object(B.jsx)(Oa.a,{style:{width:50},children:"Caja"})]})}),Object(B.jsx)(xa.a,{children:Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(B.jsx)(Oa.a,{style:{width:200},children:a.folio}),Object(B.jsx)(Oa.a,{style:{width:50},children:null!==a.cliente?a.cliente.nombre_cliente:"-"}),Object(B.jsxs)(Oa.a,{style:{width:200},children:["$",Fa(a.descuento)]}),Object(B.jsxs)(Oa.a,{style:{width:200},children:["$",a.iva?Fa(a.iva):0]}),Object(B.jsxs)(Oa.a,{style:{width:200},children:["$",a.ieps?Fa(a.ieps):0]}),Object(B.jsxs)(Oa.a,{style:{width:200},children:["$",Fa(a.subTotal)]}),Object(B.jsxs)(Oa.a,{style:{width:200},children:["$",Fa(a.impuestos)]}),Object(B.jsxs)(Oa.a,{style:{width:200},children:["$",Fa(a.total)]}),Object(B.jsx)(Oa.a,{style:{width:200},children:a.usuario.nombre}),Object(B.jsx)(Oa.a,{style:{width:200},children:a.id_caja.numero_caja})]})})]})}),Object(B.jsx)(p.a,{textAlign:"center",mt:1,children:Object(B.jsx)(S.a,{variant:"button",children:"Productos de Venta"})}),Object(B.jsx)(ba.a,{className:e.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{style:{width:250},children:"Producto"}),Object(B.jsx)(Oa.a,{style:{width:50},children:"Cantidad"}),Object(B.jsx)(Oa.a,{style:{width:50},children:"IVA"}),Object(B.jsx)(Oa.a,{style:{width:50},children:"IEPS"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Subtotal"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Impuestos"}),Object(B.jsx)(Oa.a,{style:{width:100},children:"Total"}),Object(B.jsx)(Oa.a,{style:{width:50},children:"Modificar"}),Object(B.jsx)(Oa.a,{style:{width:50},children:"Eliminar"})]})}),Object(B.jsx)(xa.a,{children:n.map((function(e,t){return Object(B.jsx)(Yp,{venta:a,producto:e,index:t},t)}))})]})})]}):null}var Yp=function(e){var t=e.venta,a=e.producto,n=e.index,c=a.id_producto.datos_generales;return Object(B.jsxs)(ma.a,{tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:c.nombre_comercial}),Object(B.jsx)(Oa.a,{children:a.cantidad_venta}),Object(B.jsxs)(Oa.a,{children:["$",Fa(a.iva_total)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(a.ieps_total)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(a.subtotal)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(a.impuestos)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(a.total)]}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(Bp,{venta:t,producto:a,index:n})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(Jp,{venta:t,producto:a,index:n})})]})},Kp=JSON.parse(localStorage.getItem("sesionCafi")),Qp={serie:"",currency:"MXN",expedition_place:"",folio:"",cfdi_type:"I",payment_form:"",payment_method:"",logo_url:Kp?Kp.imagen:"",date:"0",issuer:{FiscalRegime:Kp?Kp.empresa.regimen_fiscal:"",Rfc:Kp?Kp.empresa.rfc:"",Name:Kp?Kp.empresa.nombre_fiscal:""},receiver:{Rfc:"",Name:"",CfdiUse:""},items:[],empresa:Kp?Kp.empresa._id:"",sucursal:Kp?Kp.sucursal._id:""},Xp=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Zp(e){var t=e.setAlert,a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=(o[0],o[1]),d=Object(l.useContext)(_p),j=d.datosFactura,u=(d.setDatosFactura,d.codigo_postal,d.setCodigoPostal,d.productos),m=(d.setProductosFactura,d.setError),O=Object(z.a)(Et),x=Object(g.a)(O,1)[0],h=function(){r(!1)},_=function(){var e=Object(f.a)(C.a.mark((function e(){var a,n,c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object(b.a)({},j),n=[],u.forEach((function(e){console.log(e);var t=e.id_producto.precios,a=t.iva,c=t.ieps,r=[];e.iva_total&&r.push({Total:e.iva_total,Name:"IVA",Base:e.precio_a_vender,Rate:"0.".concat(a<10?"0".concat(a):a),IsRetention:"true"}),e.ieps_total&&r.push({Total:e.ieps_total,Name:"IEPS",Base:e.precio_a_vender,Rate:"0.".concat(c<10?"0".concat(c):c),IsRetention:"true"}),n.push({ProductCode:e.id_producto.datos_generales.clave_producto_sat.Value,IdentificationNumber:e.id_producto._id,Description:e.id_producto.datos_generales.nombre_comercial,UnitCode:e.codigo_unidad,UnitPrice:e.precio_actual_object.precio_venta,Quantity:e.cantidad_venta,Subtotal:e.subtotal,Discount:e.precio_actual_object.dinero_descontado?e.precio_actual_object.dinero_descontado:0,Taxes:r,Total:e.total})})),console.log(n),e.abrupt("return");case 15:return m({status:!1,message:""}),e.next=18,x({variables:{input:a}});case 18:c=e.sent,console.log("result",c),s(!1),t({message:"\xa1Listo! ".concat(c.data.crearFactura.message),status:"success",open:!0}),e.next=30;break;case 24:e.prev=24,e.t0=e.catch(0),console.log(e.t0),console.log(e.t0.response),s(!1),e.t0.response?t({message:e.t0.response,status:"error",open:!0}):e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 30:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{color:"primary",variant:"contained",startIcon:Object(B.jsx)(Ha.a,{}),size:"large",onClick:function(){r(!0)},children:"Guardar"}),Object(B.jsxs)(Ee.a,{open:c,TransitionComponent:Xp,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&h()},fullWidth:!0,maxWidth:"xs",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",m:1,children:Object(B.jsx)(w.a,{onClick:function(){return h()},size:"large",color:"secondary",variant:"contained",children:Object(B.jsx)(Pt.a,{})})}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(em,{})}),Object(B.jsx)(Ue.a,{style:{justifyContent:"center"},children:Object(B.jsx)(w.a,{startIcon:Object(B.jsx)(Dt.a,{}),onClick:function(){return _()},variant:"contained",color:"primary",children:"Guardar"})})]})]})}var em=function(){var e,t=Object(l.useContext)(_p),a=t.datosFactura,n=t.setDatosFactura,c=t.error_validation,r=function(e){var t=e.target,c=t.name,r=t.value;console.log(c,r),n(Object(b.a)(Object(b.a)({},a),{},Object(_.a)({},c,r)))};return Object(B.jsxs)(p.a,{children:[Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:"Fecha de facturaci\xf3n"}),Object(B.jsxs)(H.a,{variant:"outlined",fullWidth:!0,size:"small",name:"date",error:c.status&&!a.date,children:[Object(B.jsxs)(mt.a,{value:a.date,name:"date",onChange:r,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona una fecha"})}),Object(B.jsx)(Ot.a,{value:"0",children:ht()().format("LL")}),Object(B.jsx)(Ot.a,{value:"1",children:ht()().subtract(1,"d").format("LL")}),Object(B.jsx)(Ot.a,{value:"2",children:ht()().subtract(2,"d").format("LL")})]}),Object(B.jsx)(ua.a,{children:c.status&&!a.date?c.message:""})]})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:"Forma de pago"}),Object(B.jsxs)(H.a,{variant:"outlined",fullWidth:!0,size:"small",name:"payment_form",error:c.status&&!a.payment_form,children:[Object(B.jsxs)(mt.a,{value:a.payment_form,name:"payment_form",onChange:r,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),vt.map((function(e,t){return Object(B.jsx)(Ot.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(B.jsx)(ua.a,{children:c.status&&!a.payment_form?c.message:""})]})]}),Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsx)(S.a,{children:"M\xe9todo de pago"}),Object(B.jsxs)(H.a,{variant:"outlined",fullWidth:!0,size:"small",name:"payment_method",error:c.status&&!a.payment_method,children:[Object(B.jsxs)(mt.a,{value:a.payment_method,name:"payment_method",onChange:r,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),Ct.map((function(e,t){return Object(B.jsx)(Ot.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(B.jsx)(ua.a,{children:c.status&&!a.payment_method?c.message:""})]})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{children:"Uso de CFDi"}),Object(B.jsxs)(H.a,(e={fullWidth:!0,size:"small",variant:"outlined"},Object(_.a)(e,"fullWidth",!0),Object(_.a)(e,"error",c.status&&!a.receiver.CfdiUse),Object(_.a)(e,"children",[Object(B.jsxs)(mt.a,{value:a.receiver.CfdiUse,name:"CfdiUse",onChange:function(e){var t=e.target,c=t.name,r=t.value;n(Object(b.a)(Object(b.a)({},a),{},{receiver:Object(b.a)(Object(b.a)({},a.receiver),{},Object(_.a)({},c,r))}))},children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),_t.map((function(e,t){return Object(B.jsx)(Ot.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(B.jsx)(ua.a,{children:c.status&&!a.receiver.CfdiUse?c.message:""})]),e))]})]})},tm=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function am(e){var t=e.open,a=e.setOpen,n=e.handleCloseFactura,c=Object(l.useContext)(_p),r=c.setDatosFactura,i=c.setCodigoPostal,o=c.setProductos,s=c.setVentaFactura,d=c.setCPValido,j=c.setError,u=function(){a(!1)},b=function(){r(Qp),s(null),o([]),i(""),d(!1),j({status:!1,message:""}),u(),n()};return Object(B.jsx)("div",{children:Object(B.jsxs)(Ee.a,{open:t,TransitionComponent:tm,keepMounted:!0,onClose:function(){return u()},children:[Object(B.jsx)(wt.a,{children:"\xbfEst\xe1s seguro de cancelar esta factura?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:function(){return u()},children:"Cerrar"}),Object(B.jsx)(w.a,{onClick:function(){return b()},color:"primary",children:"Cancelar Factura"})]})]})})}var nm=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}})),cm=Object(l.forwardRef)((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function rm(){var e=Object(l.useState)(!1),t=Object(g.a)(e,2),a=t[0],n=t[1],c=function(){n(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){n(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",mb:2,children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/factura-2.png",alt:"icono Factura",style:{width:100}})}),"Generar nuevo CFDI"]})}),Object(B.jsx)(Ee.a,{fullScreen:!0,open:a,onClose:function(){return c()},disableEscapeKeyDown:!0,TransitionComponent:cm,children:Object(B.jsx)(fp,{children:Object(B.jsx)(im,{handleClose:c})})})]})}var im=function(e){var t,a=e.handleClose,n=nm(),c=Object(l.useContext)(_p).venta_factura,r=d.a.useState(!1),i=Object(g.a)(r,2),o=i[0],s=i[1],j=Object(l.useState)({message:"",status:"",open:!1}),u=Object(g.a)(j,2),b=u[0],m=u[1],O=function(){null!==c?s(!0):a()};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(Ie.a,{className:n.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:n.title,children:"Generar nuevo CFDI"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,(t={variant:"contained",color:"inherit",onClick:function(){return O()}},Object(_.a)(t,"color","secondary"),Object(_.a)(t,"size","large"),Object(_.a)(t,"children",Object(B.jsx)(We.a,{style:{fontSize:30}})),t))})]})}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(J,{alert:b,setAlert:m}),Object(B.jsx)(om,{})]}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(Zp,{setAlert:m})}),Object(B.jsx)(am,{open:o,setOpen:s,handleCloseFactura:a})]})},om=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(qe.a)($t,{variables:{sucursal:e.sucursal._id,empresa:e.empresa._id},fetchPolicy:"network-only"}),a=t.loading,n=t.data,c=t.error;if(a)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})});if(c)return Object(B.jsx)(Ze,{error:c});var r=n.obtenerSeriesCdfi.seriesCfdi,i=[];return(i=r.filter((function(e){return!0===e.default}))).length||(i=[{folio:"",serie:""}],console.log(i)),Object(B.jsxs)(l.Fragment,{children:[r.length?null:Object(B.jsx)(St.a,{severity:"warning",children:"No tienes Series CFDI registradas"}),Object(B.jsx)(p.a,{my:2,children:Object(B.jsx)(Lp,{serie_default:i})}),Object(B.jsx)(Hp,{})]})},sm=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function lm(e){var t=e.refetch,a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)({folio:"",serie:"",default:!1}),o=Object(g.a)(i,2),s=o[0],d=o[1],j=JSON.parse(localStorage.getItem("sesionCafi")),u=Object(l.useState)({message:"",status:"",open:!1}),m=Object(g.a)(u,2),O=m[0],x=m[1],h=Object(l.useState)(!1),v=Object(g.a)(h,2),y=v[0],k=v[1],N=Object(z.a)(At),P=Object(g.a)(N,1)[0],D=function(){r(!1),d({folio:"",serie:"",default:!1})},E=function(e){var t=e.target,a=t.name,n=t.value;d(Object(b.a)(Object(b.a)({},s),{},Object(_.a)({},a,n)))},A=function(){var e=Object(f.a)(C.a.mark((function e(){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.folio&&s.serie){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,k(!0),e.next=6,P({variables:{input:{serie:s.serie,folio:parseInt(s.folio),default:s.default,empresa:j.empresa._id,sucursal:j.sucursal._id}}});case 6:a=e.sent,x({message:"\xa1Listo! ".concat(a.data.crearSerieCFDI.message),status:"success",open:!0}),t(),k(!1),D(),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(2),k(!1),x({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 19:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(J,{alert:O,setAlert:x}),Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{onClick:function(){r(!0)},color:"primary",variant:"contained",size:"large",startIcon:Object(B.jsx)(It.a,{}),children:"Nueva serie"})}),Object(B.jsxs)(Ee.a,{maxWidth:"xs",fullWidth:!0,open:c,onClose:function(){return D()},TransitionComponent:sm,children:[Object(B.jsx)(wt.a,{children:"Registrar nueva serie"}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Serie para CDFI:"}),Object(B.jsx)(p.a,{display:"flex",alignItems:"center",children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",variant:"outlined",name:"serie",onChange:E})})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Folio Inicial:"}),Object(B.jsx)(p.a,{display:"flex",alignItems:"center",children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",variant:"outlined",name:"folio",onChange:E})})]}),Object(B.jsx)(Ve.a,{style:{marginTop:8},control:Object(B.jsx)(Me.a,{checked:s.default,onChange:function(e){var t=e.target,a=t.name,n=t.checked;d(Object(b.a)(Object(b.a)({},s),{},Object(_.a)({},a,n)))},name:"default"}),label:"Serie predeterminada"})]}),Object(B.jsxs)(Ue.a,{style:{justifyContent:"center"},children:[Object(B.jsx)(w.a,{startIcon:Object(B.jsx)(Pt.a,{}),onClick:function(){return D()},children:"Cancelar"}),Object(B.jsx)(w.a,{color:"primary",startIcon:y?Object(B.jsx)(I.a,{size:20}):Object(B.jsx)(Dt.a,{}),disabled:!s.serie||!s.folio||y,onClick:function(){return A()},children:"Guardar"})]})]})]})}var dm=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),jm=Object(k.a)((function(e){return{container:{height:"80vh"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}}));function um(e){var t=e.obtenerSeriesCdfi,a=e.refetch,n=jm(),c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)({message:"",status:"",open:!1}),d=Object(g.a)(s,2),j=d[0],u=d[1],b=JSON.parse(localStorage.getItem("sesionCafi")),p=t.seriesCfdi,m=Object(z.a)(Tt),O=Object(g.a)(m,1)[0],x=function(){var e=Object(f.a)(C.a.mark((function e(t,n){var c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.prev=1,e.next=4,O({variables:{id:n._id,empresa:b.empresa._id,sucursal:b.sucursal._id}});case 4:c=e.sent,a(),o(!1),u({message:"\xa1Listo! ".concat(c.data.modificarDefaultSerie.message),status:"success",open:!0}),o(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),o(!1),u({message:"Error: ".concat(e.t0.message),status:"success",open:!0});case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,a){return e.apply(this,arguments)}}();return Object(B.jsxs)(Ka.a,{variant:"outlined",children:[Object(B.jsx)(Je.a,{className:n.backdrop,open:i,children:Object(B.jsx)(I.a,{color:"inherit"})}),Object(B.jsx)(J,{alert:j,setAlert:u}),Object(B.jsx)(ba.a,{className:n.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Serie"}),Object(B.jsx)(Oa.a,{children:"Folio"}),Object(B.jsx)(Oa.a,{children:"Predeterminado"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Eliminar"})]})}),Object(B.jsx)(xa.a,{children:p.map((function(e,t){return Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:e.serie}),Object(B.jsx)(Oa.a,{children:e.folio}),Object(B.jsx)(Oa.a,{align:"center",padding:"checkbox",children:Object(B.jsx)(Me.a,{checked:e.default,onChange:function(t){return x(t.target.checked,e)},name:"checkedA"})}),Object(B.jsx)(Oa.a,{align:"center",padding:"checkbox",children:!1===b.accesos.facturacion.registro_series_cdfi.eliminar?null:Object(B.jsx)(bm,{row:e,refetch:a,setAlert:u})})]},t)}))})]})})]})}var bm=function(e){var t=e.row,a=e.refetch,n=e.setAlert,c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)(!1),d=Object(g.a)(s,2),j=d[0],u=d[1],b=Object(z.a)(Wt),p=Object(g.a)(b,1)[0],m=function(){return o(!1)},O=function(){var e=Object(f.a)(C.a.mark((function e(){var c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,p({variables:{id:t._id}});case 4:c=e.sent,a(),u(!1),m(),n({message:"\xa1Listo! ".concat(c.data.eliminarSerie.message),status:"success",open:!0}),u(!1),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),u(!1),n({message:"Error: ".concat(e.t0.message),status:"success",open:!0});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(X.a,{"aria-label":"delete",size:"small",onClick:function(){return o(!0)},disabled:t.default,children:Object(B.jsx)(Ju.a,{})}),Object(B.jsxs)(Ee.a,{open:i,onClose:function(){return m()},TransitionComponent:dm,children:[Object(B.jsx)(wt.a,{children:"Se eliminara esta serie"}),Object(B.jsxs)(Ue.a,{style:{justifyContent:"center"},children:[Object(B.jsx)(w.a,{startIcon:Object(B.jsx)(Pt.a,{}),onClick:function(){return m()},children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",disabled:j,startIcon:j?Object(B.jsx)(I.a,{size:20}):Object(B.jsx)(Dt.a,{}),onClick:function(){return O()},children:"Eliminar"})]})]})]})},pm=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),mm=Object(l.forwardRef)((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Om(){JSON.parse(localStorage.getItem("sesionCafi"));var e=pm(),t=Object(l.useState)(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!n)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:r,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",mb:2,children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/factura-1.png",alt:"icono Factura",style:{width:100}})}),"Registrar Series CFDI"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:mm,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Seleccion de Series para CFDI"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{color:"secondary",variant:"contained",onClick:r,size:"large",children:Object(B.jsx)(We.a,{})})})]})}),Object(B.jsx)(xm,{})]})]})}var xm=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(qe.a)($t,{variables:{sucursal:e.sucursal._id,empresa:e.empresa._id},fetchPolicy:"network-only"}),a=t.loading,n=t.data,c=t.error,r=t.refetch;if(a)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})});if(c)return Object(B.jsx)(Ze,{error:c});var i=n.obtenerSeriesCdfi;return Object(B.jsxs)(y.a,{maxWidth:"md",children:[Object(B.jsx)(p.a,{my:2,children:!1===e.accesos.facturacion.registro_series_cdfi.agregar?null:Object(B.jsx)(lm,{refetch:r})}),Object(B.jsx)(um,{obtenerSeriesCdfi:i,refetch:r})]})},hm=ls.a.ExcelFile,_m=ls.a.ExcelFile.ExcelSheet,fm=ls.a.ExcelFile.ExcelColumn;function gm(e){var t=e.compra,a=t.almacen,n=t.proveedor,c=t.fecha_registro,r=t.subtotal,i=t.impuestos,o=t.total,s=t.productos,d=[{almacen:a.nombre_almacen,proveedor:n.nombre_cliente,fecha_registro:ya(c),subtotal:Fa(r),impuestos:Fa(i),total:Fa(o)}],j=s.map((function(e){var t=e.producto,a=e.medida,n=e.color,c=e.unidad,r=e.cantidad,i=e.Cantidad_regalo,o=e.cantidad_total,s=e.descuento_precio,l=e.descuento_porcentaje,d=e.subtotal,j=e.impuestos,u=e.total;return{producto:t.datos_generales.nombre_comercial,medida:a?a.medida:"N/A",color:n?n.color:"N/A",unidad:c,cantidad:r,Cantidad_regalo:i,cantidad_total:o,descuento_precio:s,descuento_porcentaje:l,subtotal:Fa(d),impuestos:Fa(j),total:Fa(u)}}));return Object(B.jsx)(l.Fragment,{children:Object(B.jsx)($e.a,{children:Object(B.jsx)($e.a,{item:!0,children:Object(B.jsxs)(hm,{element:Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{variant:"contained",color:"primary",startIcon:Object(B.jsx)(os.a,{}),children:"Exportar a Excel"})}),filename:"Detalle de compra",children:[Object(B.jsxs)(_m,{data:d,name:"Detalle compra",children:[Object(B.jsx)(fm,{label:"Almacen",value:"almacen"}),Object(B.jsx)(fm,{label:"Proveedor",value:"proveedor"}),Object(B.jsx)(fm,{label:"Fecha de compra",value:"fecha_registro"}),Object(B.jsx)(fm,{label:"Subtotal",value:"subtotal"}),Object(B.jsx)(fm,{label:"Impuestos",value:"impuestos"}),Object(B.jsx)(fm,{label:"Total",value:"total"})]}),Object(B.jsxs)(_m,{data:j,name:"Productos de la compra",children:[Object(B.jsx)(fm,{label:"Producto",value:"producto"}),Object(B.jsx)(fm,{label:"Medida",value:"medida"}),Object(B.jsx)(fm,{label:"Color",value:"color"}),Object(B.jsx)(fm,{label:"Unidad",value:"unidad"}),Object(B.jsx)(fm,{label:"Cantidad",value:"cantidad"}),Object(B.jsx)(fm,{label:"Cantidad de regalo",value:"cantidad_regalo"}),Object(B.jsx)(fm,{label:"Cantidad total",value:"cantidad_total"}),Object(B.jsx)(fm,{label:"Precio de descuento",value:"descuento_precio"}),Object(B.jsx)(fm,{label:"Porcentaje de descuento",value:"descuento_porcentaje"}),Object(B.jsx)(fm,{label:"Subtotal",value:"subtotal"}),Object(B.jsx)(fm,{label:"Impuestos",value:"impuestos"}),Object(B.jsx)(fm,{label:"Total",value:"total"})]})]})})})})}var vm=Object(k.a)({root:{width:"100%"},container:{height:"50vh"}});function Cm(e){var t=e.compra,a=vm(),n=Object(Se.a)(),c=t.productos,r=Object(l.useState)(""),i=Object(g.a)(r,2),o=i[0],s=i[1],d=Object(l.useState)([]),j=Object(g.a)(d,2),u=j[0],b=j[1];return Object(l.useEffect)((function(){b(c.filter((function(e){return e.producto.datos_generales.nombre_comercial.toLowerCase().includes(o.toLowerCase())})))}),[o,c]),Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(p.a,{mb:1,display:"flex",children:[Object(B.jsxs)(S.a,{style:{marginRight:16},children:[Object(B.jsx)("b",{children:"Proveedor: "}),t.proveedor.nombre_cliente]}),Object(B.jsxs)(S.a,{style:{marginRight:16},children:[Object(B.jsx)("b",{children:"Almacen: "}),t.almacen.nombre_almacen]}),Object(B.jsx)(S.a,{style:{marginRight:16},children:Object(B.jsxs)("b",{children:["Subtotal: $",t.subtotal]})}),Object(B.jsx)(S.a,{style:{marginRight:16},children:Object(B.jsxs)("b",{children:["Impuestos: $",t.impuestos]})}),Object(B.jsx)(S.a,{style:{marginRight:16},children:Object(B.jsxs)("b",{children:["Total: $",t.total]})})]}),Object(B.jsx)(p.a,{mb:2,display:"flex",children:Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)($e.a,{item:!0,sm:6,xs:12,children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",onChange:function(e){return t=e.target.value,s(t);var t},InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:Object(B.jsx)(is.a,{color:"action"})})}})}),Object(B.jsx)($e.a,{item:!0,sm:6,xs:12,children:Object(B.jsx)(gm,{compra:t})})]})}),Object(B.jsx)(Ka.a,{className:a.root,children:Object(B.jsx)(ba.a,{className:a.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Producto"}),Object(B.jsx)(Oa.a,{children:"Medida"}),Object(B.jsx)(Oa.a,{children:"Color"}),Object(B.jsx)(Oa.a,{children:"Unidad"}),Object(B.jsx)(Oa.a,{children:"Cantidad"}),Object(B.jsx)(Oa.a,{children:"C. regalo"}),Object(B.jsx)(Oa.a,{children:"C. total"}),Object(B.jsx)(Oa.a,{children:"Descuento"}),Object(B.jsx)(Oa.a,{children:"Subtotal"}),Object(B.jsx)(Oa.a,{children:"Impuestos"}),Object(B.jsx)(Oa.a,{children:"Total"})]})}),Object(B.jsx)(xa.a,{children:u.map((function(e,t){return Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:e.producto.datos_generales.nombre_comercial}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:e.medida&&e.medida.medida?e.medida.medida:"N/A"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:e.color&&e.color.hex?Object(B.jsx)(Qa.a,{label:e.color.color,size:"small",style:{backgroundColor:e.color.hex,color:n.palette.getContrastText(e.color.hex)}}):"N/A"}),Object(B.jsx)(Oa.a,{children:e.unidad}),Object(B.jsx)(Oa.a,{children:e.cantidad}),Object(B.jsx)(Oa.a,{children:e.cantidad_regalo}),Object(B.jsx)(Oa.a,{children:e.cantidad_total}),Object(B.jsx)(Oa.a,{children:"$".concat(e.descuento_precio," - %").concat(e.descuento_porcentaje)}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(e.subtotal)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(e.impuestos)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(e.total)]})})]},t)}))})]})})})]})}var ym=Object(k.a)({root:{width:"100%"},container:{height:"72vh"}});function Sm(e){var t=e.obtenerComprasRealizadas,a=ym();return Object(B.jsx)(Ka.a,{className:a.root,variant:"outlined",children:Object(B.jsx)(ba.a,{className:a.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Almacen"}),Object(B.jsx)(Oa.a,{children:"Proveedor"}),Object(B.jsx)(Oa.a,{children:"Fecha de compra"}),Object(B.jsx)(Oa.a,{children:"Subtotal"}),Object(B.jsx)(Oa.a,{children:"Impuestos"}),Object(B.jsx)(Oa.a,{children:"Total"}),Object(B.jsx)(Oa.a,{children:"Productos"})]})}),Object(B.jsx)(xa.a,{children:t.map((function(e,t){return Object(B.jsx)(Fm,{compra:e},t)}))})]})})})}var Fm=function(e){var t=e.compra,a=t.almacen,n=t.proveedor,c=t.fecha_registro,r=t.subtotal,i=t.impuestos,o=t.total;return Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:a.nombre_almacen}),Object(B.jsx)(Oa.a,{children:n.nombre_cliente}),Object(B.jsx)(Oa.a,{children:ya(c)}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(r)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(i)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsxs)("b",{children:["$",Fa(o)]})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(Im,{compra:t})})]})},wm=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),Im=function(e){var t=e.compra,a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=function(){r(!c)};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(X.a,{onClick:function(){return i()},children:Object(B.jsx)(Os.a,{})}),Object(B.jsxs)(Ee.a,{open:c,onClose:i,fullWidth:!0,maxWidth:"lg",TransitionComponent:wm,children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(S.a,{variant:"h6",style:{flexGrow:1},children:"Datos de compra"}),Object(B.jsx)(w.a,{variant:"text",color:"primary",onClick:i,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(Cm,{compra:t})}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{variant:"text",color:"primary",size:"large",startIcon:Object(B.jsx)(Dt.a,{}),onClick:function(){return i()},children:"Aceptar"})})]})]})},km=ls.a.ExcelFile,zm=ls.a.ExcelFile.ExcelSheet,Nm=ls.a.ExcelFile.ExcelColumn;function Pm(e){var t=e.obtenerComprasRealizadas,a=e.filtro,n=e.filtroFecha,c=t.map((function(e){var t=e.almacen,a=e.proveedor,n=e.fecha_registro,c=e.subtotal,r=e.impuestos,i=e.total;return{almacen:t.nombre_almacen,proveedor:a.nombre_cliente,fecha_registro:ya(n),subtotal:Fa(c),impuestos:Fa(r),total:Fa(i)}})),r="";return a&&n.fecha?r="Lista de compras realizadas desde hace ".concat(n.since," y filtradas por ").concat(a):a&&!n.fecha?r="Lista de compras realizadas filtradas por ".concat(a):!a&&n.fecha?r="Lista de compras realizadas desde hace ".concat(n.since):a||n.fecha||(r="Lista de compras realizadas"),Object(B.jsx)(l.Fragment,{children:Object(B.jsx)($e.a,{children:Object(B.jsx)($e.a,{item:!0,children:Object(B.jsx)(km,{element:Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{variant:"contained",color:"primary",startIcon:Object(B.jsx)(os.a,{}),children:"Exportar a Excel"})}),filename:r,children:Object(B.jsxs)(zm,{data:c,name:r,children:[Object(B.jsx)(Nm,{label:"Almacen",value:"almacen"}),Object(B.jsx)(Nm,{label:"Proveedor",value:"proveedor"}),Object(B.jsx)(Nm,{label:"Fecha de compra",value:"fecha_registro"}),Object(B.jsx)(Nm,{label:"Subtotal",value:"subtotal"}),Object(B.jsx)(Nm,{label:"Impuestos",value:"impuestos"}),Object(B.jsx)(Nm,{label:"Total",value:"total"})]})})})})})}var Dm=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}})),Em=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Am(){var e=Dm(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",mb:2,children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/factura-3.png",alt:"icono Factura",style:{width:100}})})}),"CFDis realizados"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Em,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"CFDis realizados"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsx)(y.a,{maxWidth:"xl",children:Object(B.jsx)(Tm,{})})]})]})}var Tm=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(l.useState)(""),a=Object(g.a)(t,2),n=a[0],c=a[1],r=Object(l.useState)({fecha:"",since:"todos"}),i=Object(g.a)(r,2),o=i[0],s=i[1],d=Object(l.useRef)(null),j=Object(l.useRef)(null),u=Object(qe.a)(Co,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,fecha:o.fecha},fetchPolicy:"network-only"}),b=u.loading,m=u.data,O=u.error,x=u.refetch;if(b)return Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:[Object(B.jsx)(I.a,{}),Object(B.jsx)(S.a,{variant:"h5",children:"Cargando"})]});if(O)return Object(B.jsx)(Ze,{error:O,altura:300});var h=[];m&&(h=m.obtenerComprasRealizadas);return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{my:3,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsx)("form",{onSubmit:function(e){return function(e,t){e.preventDefault(),x({filtro:t,fecha:o.fecha}),c(t)}(e,e.target[0].value)},children:Object(B.jsx)(F.a,{inputRef:d,fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",InputProps:{endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(X.a,{type:"submit",color:"primary",size:"medium",children:Object(B.jsx)(vs.a,{})})})}})})}),Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsxs)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:[Object(B.jsx)(Y.a,{id:"label-select-fecha-filter",children:"Filtrar desde..."}),Object(B.jsxs)(mt.a,{inputRef:j,labelId:"label-select-fecha-filter",value:o.since,onChange:function(e){return function(e){switch(e){case"7 dias":s({since:e,fecha:ht()().subtract(7,"d").format()}),x({filtro:n,fecha:ht()().subtract(7,"d").format()});break;case"2 semanas":s({since:e,fecha:ht()().subtract(2,"w").format()}),x({filtro:n,fecha:ht()().subtract(2,"w").format()});break;case"1 mes":s({since:e,fecha:ht()().subtract(1,"M").format()}),x({filtro:n,fecha:ht()().subtract(1,"M").format()});break;case"3 meses":s({since:e,fecha:ht()().subtract(3,"M").format()}),x({filtro:n,fecha:ht()().subtract(3,"M").format()});break;case"6 meses":s({since:e,fecha:ht()().subtract(6,"M").format()}),x({filtro:n,fecha:ht()().subtract(6,"M").format()});break;case"8 meses":s({since:e,fecha:ht()().subtract(8,"M").format()}),x({filtro:n,fecha:ht()().subtract(8,"M").format()});break;case"1 a\xf1o":s({since:e,fecha:ht()().subtract(1,"y").format()}),x({filtro:n,fecha:ht()().subtract(1,"y").format()});break;default:s({since:"todos",fecha:""}),x({filtro:n,fecha:""})}}(e.target.value)},label:"Filtrar desde...",children:[Object(B.jsx)(Ot.a,{value:"todos",children:Object(B.jsx)("em",{children:"Todos los registros"})}),Object(B.jsx)(Ot.a,{value:"7 dias",children:"hace 7 d\xedas"}),Object(B.jsx)(Ot.a,{value:"2 semanas",children:"hace 2 semanas"}),Object(B.jsx)(Ot.a,{value:"1 mes",children:"hace 1 mes"}),Object(B.jsx)(Ot.a,{value:"3 meses",children:"hace 3 meses"}),Object(B.jsx)(Ot.a,{value:"6 meses",children:"hace 6 meses"}),Object(B.jsx)(Ot.a,{value:"8 meses",children:"hace 8 meses"}),Object(B.jsx)(Ot.a,{value:"1 a\xf1o",children:"hace 1 a\xf1o"})]})]})}),Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsx)(Pm,{obtenerComprasRealizadas:h,filtro:n,filtroFecha:o})})]})}),n||o.fecha?Object(B.jsxs)(p.a,{display:"flex",mb:1,children:[Object(B.jsx)(S.a,{variant:"h6",children:"Resultados de:"}),Object(B.jsx)(p.a,{mr:1}),n?Object(B.jsx)(Qa.a,{variant:"outlined",size:"medium",label:n,onDelete:function(){x({filtro:"",fecha:o.fecha}),c(""),d.current.value=""}}):null,Object(B.jsx)(p.a,{mx:1}),o.fecha?Object(B.jsx)(Qa.a,{variant:"outlined",size:"medium",label:"Desde hace ".concat(o.since),onDelete:function(){x({filtro:n,fecha:""}),s({since:"todos",fecha:""}),j.current.value="todos"}}):null]}):null,Object(B.jsx)(Sm,{obtenerComprasRealizadas:h})]})};function Wm(){var e=JSON.parse(localStorage.getItem("sesionCafi"));return Object(B.jsx)("div",{children:Object(B.jsx)(y.a,{children:Object(B.jsxs)($e.a,{container:!0,spacing:2,justifyContent:"center",children:[!1===e.accesos.facturacion.generar_cdfi.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(rm,{})})}),!1===e.accesos.facturacion.cdfi_realizados.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Am,{})})}),!1===e.accesos.facturacion.registro_series_cdfi.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Om,{})})})]})})})}var $m=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Rm(e){var t=e.datos,a=e.refetch,n=d.a.useState(!1),c=Object(g.a)(n,2),r=c[0],i=c[1],o=d.a.useState(!1),s=Object(g.a)(o,2),l=s[0],j=s[1],u=d.a.useState({message:"",status:"",open:!1}),b=Object(g.a)(u,2),p=b[0],m=b[1],O=Object(z.a)(Dr),x=Object(g.a)(O,1)[0],h=function(){i(!1)},_=function(){var e=Object(f.a)(C.a.mark((function e(){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.prev=1,e.next=4,x({variables:{id:t._id}});case 4:n=e.sent,j(!1),m({message:n.data.eliminarAlmacen.message,status:"success",open:!0}),a(),h(),e.next=20;break;case 11:if(e.prev=11,e.t0=e.catch(1),j(!1),!e.t0.message){e.next=18;break}return m({message:e.t0.message,status:"error",open:!0}),h(),e.abrupt("return");case 18:m({message:"Hubo un error",status:"error",open:!0}),h();case 20:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(X.a,{color:"secondary",onClick:function(){i(!0)},disabled:t.default_almacen,children:Object(B.jsx)(ur.a,{})}),Object(B.jsx)(J,{alert:p,setAlert:m}),Object(B.jsxs)(Ee.a,{open:r,TransitionComponent:$m,keepMounted:!0,onClose:h,"aria-labelledby":"eliminarAlmacen-dialog",children:[Object(B.jsx)(wt.a,{id:"eliminarAlmacen-dialog",children:"\xbfEst\xe1s seguro de eliminar esto?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:h,color:"inherit",disabled:l,children:"Cancelar"}),Object(B.jsx)(w.a,{onClick:_,color:"secondary",disabled:l,startIcon:l?Object(B.jsx)(I.a,{color:"inherit",size:20}):null,children:"Eliminar"})]})]})]})}var Vm=Object(k.a)({table:{minWidth:650},root:{width:"100%",heigth:"75%"},container:{maxHeight:"77vh","& ::-webkit-scrollbar":{display:"none"}}}),Mm=[{id:1,label:"Nombre",minWidth:100},{id:2,label:"Encargado",minWidth:100},{id:3,label:"Sucursal",minWidth:150},{id:13,label:"Editar",minWidth:50,align:"right"},{id:14,label:"Eliminar",minWidth:50,align:"right"}];function Lm(){var e=Vm(),t=Object(l.useContext)(Ir).update,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(qe.a)(Nr,{variables:{id:a.sucursal._id}}),c=n.loading,r=n.data,i=n.error,o=n.refetch;if(Object(l.useEffect)((function(){o()}),[t,o]),c)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})});if(i)return Object(B.jsx)(Ze,{error:i});var s=r.obtenerAlmacenes;return Object(B.jsx)(Ka.a,{className:e.root,children:Object(B.jsx)(ba.a,{component:Ka.a,className:e.container,children:Object(B.jsxs)(_a.a,{className:e.table,"aria-label":"a dense table",size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:Mm.map((function(e){return Object(B.jsx)(Oa.a,{align:e.align,children:e.label},e.id)}))})}),Object(B.jsx)(xa.a,{children:s.map((function(e,t){return Object(B.jsx)(Um,{datos:e,refetch:o},t)}))})]})})})}var Um=function(e){var t=e.datos,a=e.refetch,n=JSON.parse(localStorage.getItem("sesionCafi"));return Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.nombre_almacen})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.id_usuario_encargado?t.id_usuario_encargado.nombre:"Sin encargado"})}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(S.a,{children:t.id_sucursal.nombre_sucursal})}),Object(B.jsx)(Oa.a,{width:50,children:!1===n.accesos.almacenes.almacen.editar?null:Object(B.jsx)(mi,{accion:"actualizar",datos:t})}),Object(B.jsx)(Oa.a,{width:50,children:!1===n.accesos.almacenes.almacen.eliminar?null:Object(B.jsx)(Rm,{datos:t,refetch:a})})]})},Bm=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100}}})),qm=Object(l.forwardRef)((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Jm(){var e=Bm(),t=d.a.useState(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=JSON.parse(localStorage.getItem("sesionCafi")),i=function(){c(!1)};return Object(B.jsx)("div",{children:Object(B.jsxs)(kr,{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Fe.m,{className:e.icon})}),"Almacenes"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:i,TransitionComponent:qm,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Agregar almacen"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:i,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsx)(p.a,{m:3,display:"flex",justifyContent:"flex-end",children:!1===r.accesos.almacenes.almacen.agregar?null:Object(B.jsx)(mi,{accion:"registrar"})}),Object(B.jsx)(p.a,{mx:4,children:Object(B.jsx)(Lm,{})})]})]})})}var Gm=a(961),Hm=a(934),Ym=a(952),Km=a.p+"static/media/almacen.31993015.svg",Qm=a(12),Xm=a(960),Zm=a(472),eO=a.n(Zm),tO=Object(l.createContext)(),aO=function(e){var t=e.children,a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(!1),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(l.useState)([]),O=Object(g.a)(m,2),x=O[0],h=O[1],_=Object(l.useState)([]),f=Object(g.a)(_,2),v=f[0],C=f[1],y=Object(l.useState)([]),S=Object(g.a)(y,2),F=S[0],w=S[1],I=Object(l.useState)([]),k=Object(g.a)(I,2),z=k[0],N=k[1],P=Object(l.useState)([]),D=Object(g.a)(P,2),E=D[0],A=D[1];return Object(B.jsx)(tO.Provider,{value:{update:c,setUpdate:r,error:s,setError:d,openRegistro:b,setOpenRegistro:p,productos:x,setProductos:h,productosTras:z,setProductosTras:N,productosTo:v,setProductosTo:C,productosEmpTo:F,setProductosEmpTo:w,dataExcel:E,setDataExcel:A},children:t})},nO=function(e,t){if(e.medida.talla&&t.medida.talla)return e.medida.talla.localeCompare(t.medida.talla)},cO=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},container:{},tableRow:{"&.Mui-selected, &.Mui-selected:hover":{backgroundColor:Object(tn.fade)(e.palette.primary.main,.1)}},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",height:30,width:30,borderRadius:"15%"}}}));function rO(e){var t=e.productoData,a=e.datos,n=e.setOnUpdate,c=e.onUpdate,r=e.setNew_medidas,i=cO();Object(da.a)(a).sort((function(e,t){return nO(e,t)}));return Object(B.jsx)("div",{className:i.root,children:Object(B.jsx)(Ka.a,{className:i.paper,children:Object(B.jsx)(ba.a,{className:i.container,children:Object(B.jsxs)(_a.a,{className:i.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",stickyHeader:!0,children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Existencia"}),Object(B.jsx)(Oa.a,{children:"C\xf3digo de barras"}),Object(B.jsx)(Oa.a,{width:200,children:"Nombre"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Medida"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Color"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Precio"}),Object(B.jsx)(l.Fragment,{children:Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Cantidad"})}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Editar"})]})}),Object(B.jsx)(xa.a,{children:a.map((function(e,i){return Object(B.jsx)(iO,{productoData:t,producto:e,index:i,datos:a,setNew_medidas:r,setOnUpdate:n,onUpdate:c},i)}))})]})})})})}var iO=function(e){var t=e.productoData,a=e.producto,n=e.index,c=e.datos,r=e.setNew_medidas,i=(e.from,e.setOnUpdate),o=e.onUpdate,s=(e.withoutPrice,e.onlyPrice,Object(l.useState)(!0)),d=Object(g.a)(s,2),j=d[0],u=d[1],m=cO(),O=Object(l.useRef)(null),x=Object(da.a)(c).sort((function(e,t){return nO(e,t)})),h=Object(b.a)({},x[n]),_={},f=Object(b.a)({},a),v=function(e){var a=e.target,c=a.name,i=a.value;if("cantidad"===c){if(!i)return h.medida.cantidad="",h.medida.existencia=!1,x.splice(n,1,h),void r(r);h.medida.cantidad=parseFloat(i),h.medida.existencia=!0}else if("nuevaCantidad"===c){if(!i)return h.nuevaCantidad="",h.medida.existencia=f.medida.existencia,x.splice(n,1,h),void r(x);h.nuevaCantidad=parseFloat(i),h.medida.existencia=!0}else if("precio"===c){if(!i)return h.medida.precio=0,x.splice(n,1,h),void r(x);var o=parseFloat(i),s=t.precios,l=s.iva,d=s.ieps,j=parseFloat("0.".concat(l<10?"0".concat(l):l))+parseFloat("0.".concat(d<10?"0".concat(d):d)),u=parseFloat((o/(j+1)).toFixed(2)),b=parseFloat((u*parseFloat("0.".concat(l<10?"0".concat(l):l))).toFixed(2)),p=parseFloat((u*parseFloat("0.".concat(d<10?"0".concat(d):d))).toFixed(2)),m=t.precios.unidad_de_compra.precio_unitario_sin_impuesto,O=parseFloat(((u-m)/m*100).toFixed(2)),g=h.descuento_activo,v=h.descuento;if(g&&!0===g){var C=u*v.porciento/100,y=C+(C*parseFloat("0.".concat(l<10?"0".concat(l):l))+C*parseFloat("0.".concat(d<10?"0".concat(d):d)));_.precio_neto=parseFloat(y.toFixed(2)),h.medida.precio=parseFloat(i),h.medida.descuento=_}else h.medida.precio=parseFloat(i);h.medida.precio_unidad.precio_venta=u,h.medida.precio_unidad.precio_neto=o,h.medida.precio_unidad.utilidad=O,h.medida.precio_unidad.iva_precio=b,h.medida.precio_unidad.ieps_precio=p}else if("descuento"===c)h.medida.descuento=i;else{if(!i)return h.medida.codigo_barras="",x.splice(n,1,h),void r(x);h.medida.codigo_barras=i}x.splice(n,1,h),r(x)},C=function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();h.medida.codigo_barras=t},y=function(){j?(u(!j),i([].concat(Object(da.a)(o),[n]))):(f.medida.cantidad||(h.medida.cantidad=0),f.nuevaCantidad||(h.nuevaCantidad=0),f.precio||(h.precio=f.precio),x.splice(n,1,h),r(x),u(!0),o.splice(o.length-1,1),i(Object(da.a)(o)))};return Object(B.jsxs)(ma.a,{hover:!0,selected:!j,className:m.tableRow,children:[Object(B.jsx)(Oa.a,{align:"center",padding:"checkbox",children:Object(B.jsx)(Me.a,{checked:f.medida.existencia,color:"primary"})}),Object(B.jsx)(Oa.a,{width:220,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(Ya.a,{inputRef:O,onChange:function(e){return v(e)},value:f.medida.codigo_barras,type:"number",name:"codigo_barras",disabled:!(!c.medidas_registradas||f.medida.nuevo)||j}),!c.medidas_registradas&&f.medida.nuevo||c.medidas_registradas&&f.medida.nuevo?Object(B.jsx)(X.a,{color:"primary",size:"small",onClick:function(){return C()},children:Object(B.jsx)(ga.a,{})}):null]})}),Object(B.jsx)(Oa.a,{width:200,children:f.medida.nombre_comercial}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:f.medida.medida._id?Object(B.jsx)(Qa.a,{label:f.medida.medida.talla,color:"primary"}):""}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:f.medida.color._id?Object(B.jsx)(ha.a,{title:f.medida.color.nombre,placement:"top",arrow:!0,TransitionComponent:Xa.a,children:Object(B.jsx)("div",{className:m.colorContainer,style:{backgroundColor:f.medida.color.hex}})}):null}),Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(Oa.a,{width:110,children:Object(B.jsx)(Ya.a,{inputRef:O,inputMode:"numeric",type:"number",onChange:function(e){return v(e)},disabled:j,value:f.medida.precio,name:"precio"})}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(Ya.a,{inputRef:O,onChange:function(e){return v(e)},disabled:j,value:f.nuevaCantidad,type:"tel",name:"nuevaCantidad"})})]}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(X.a,{size:"small",onClick:function(){return y()},children:j?Object(B.jsx)(en.a,{}):Object(B.jsx)(Pt.a,{})})})]})},oO=Object(k.a)((function(e){return{colorContainer:{border:"1px solid rgba(0,0,0, .3)",display:"flex",justifyContent:"center",alignItems:"center",height:50,width:50,margin:1,borderRadius:"15%",cursor:"pointer"}}})),sO=function(){return Math.floor(9e11*Math.random()+1e11).toString()};function lO(e){var t=e.producto,a=e.new_medidas,n=e.setNew_medidas,c=e.obtenerConsultasProducto,r=e.refetch,i=Object(l.useState)([]),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)([]),u=Object(g.a)(j,2),b=u[0],m=u[1],O=Object(l.useState)([]),x=Object(g.a)(O,2),h=x[0],_=x[1],f=Object(l.useCallback)((function(){var e=[],t=[];Object(da.a)(a).forEach((function(a){a.medida.color._id&&e.push(a.medida.color),a.medida.medida._id&&t.push(a.medida.medida)}));var n={},c={},r=e.filter((function(e){var t=!n[e._id];return n[e._id]=!0,t})),i=t.filter((function(e){var t=!c[e._id];return c[e._id]=!0,t}));m(Object(da.a)(r)),d(Object(da.a)(i))}),[a,m,d]);return Object(l.useEffect)((function(){f()}),[f]),Object(B.jsx)("div",{children:Object(B.jsxs)(p.a,{alignContent:"center",m:5,children:[Object(B.jsxs)($e.a,{container:!0,spacing:4,children:[Object(B.jsx)($e.a,{item:!0,md:6,children:Object(B.jsxs)(p.a,{width:"100%",style:h.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(S.a,{children:"ROPA"===t.datos_generales.tipo_producto?"Talla":"N\xfamero"}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(Gn,{setMedidasSeleccionadas:d,refetch:r})]}),"ROPA"===t.datos_generales.tipo_producto?void 0!==c.tallas?Object(B.jsx)($e.a,{container:!0,children:c.tallas.map((function(e,c){return Object(B.jsx)(dO,{producto:t,talla:e,coloresSeleccionados:b,medidasSeleccionadas:s,setMedidasSeleccionadas:d,datos:a,setNew_medidas:n},c)}))}):Object(B.jsx)("div",{}):void 0!==c.calzados?Object(B.jsx)($e.a,{container:!0,children:c.calzados.map((function(e,c){return Object(B.jsx)(dO,{producto:t,talla:e,coloresSeleccionados:b,medidasSeleccionadas:s,setMedidasSeleccionadas:d,datos:a,setNew_medidas:n},c)}))}):Object(B.jsx)("div",{})]})}),Object(B.jsx)($e.a,{item:!0,md:6,children:Object(B.jsxs)(p.a,{width:"100%",style:h.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(S.a,{children:"Color"}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(Ln,{refetch:r})]}),void 0!==c.colores?Object(B.jsx)($e.a,{container:!0,children:c.colores.map((function(e,c){return Object(B.jsx)(jO,{producto:t,color:e,coloresSeleccionados:b,setColoresSeleccionados:m,medidasSeleccionadas:s,datos:a,setNew_medidas:n},c)}))}):Object(B.jsx)("div",{})]})})]}),Object(B.jsx)(p.a,{mt:2}),Object(B.jsx)(rO,{productoData:t,datos:a,setOnUpdate:_,onUpdate:h,setNew_medidas:n})]})})}var dO=function(e){var t=e.producto,a=e.talla,n=e.coloresSeleccionados,c=e.setMedidasSeleccionadas,r=e.medidasSeleccionadas,i=e.setNew_medidas,o=e.datos,s=oO(),d=Object(Se.a)(),j=Object(l.useState)(!1),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(l.useCallback)((function(){r.forEach((function(e){e._id===a._id&&p(!0)}))}),[a._id,r]);Object(l.useEffect)((function(){if(o)return m()}),[o,m]);return Object(B.jsx)($e.a,{item:!0,children:Object(B.jsx)("div",{className:s.colorContainer,onClick:function(){return function(e){var s=Object(da.a)(r);b?s.forEach((function(t,n){t._id===a._id&&(s.splice(n,1),p(e))})):(s.push(a),p(e));var l=[],d=Object(da.a)(o),j=t.precios,u=j.iva,m=j.ieps;if(n.length||d.length){if(!n.length&&d.length>0)for(var O=function(e){var a=s[e],n=d.filter((function(e){return e.medida.medida._id===a._id})),c=parseFloat((t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(u<10?"0".concat(u):u))).toFixed(2)),r=parseFloat((t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(m<10?"0".concat(m):m))).toFixed(2));n.length?l.push(n[0]):l.push({medida:{existencia:!1,codigo_barras:sO(),nombre_comercial:t.datos_generales.nombre_comercial,medida:a,color:{nombre:"",hex:""},precio:t.precios.precios_producto[0].precio_neto,cantidad:0,precio_unidad:{numero_precio:1,precio_venta:t.precios.precios_producto[0].precio_venta,precio_neto:t.precios.precios_producto[0].precio_neto,unidad_mayoreo:0,iva_precio:c,ieps_precio:r,utilidad:t.precios.precios_producto[0].utilidad,unidad_maxima:!1}},nuevaCantidad:0})},x=0;x<s.length;x++)O(x);else if(n.length>0&&1===s.length&&e)for(var h=0;h<d.length;h++)for(var _=0;_<s.length;_++)l.push({medida:{existencia:d[h].medida.existencia,codigo_barras:d[h].medida.codigo_barras,nombre_comercial:d[h].medida.nombre_comercial,medida:s[_],color:d[h].medida.color,precio:d[h].medida.precio,cantidad:d[h].medida.cantidad,precio_unidad:d[h].medida.precio_unidad},nuevaCantidad:d[h].nuevaCantidad});else if(n.length>0&&s.length>0)for(var f=function(e){for(var a=s[e],c=function(e){var c=n[e],r=d.filter((function(e){return e.medida.medida._id===a._id&&c._id===e.medida.color._id})),i=parseFloat((t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(u<10?"0".concat(u):u))).toFixed(2)),o=parseFloat((t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(m<10?"0".concat(m):m))).toFixed(2));r.length?l.push(r[0]):l.push({medida:{existencia:!1,codigo_barras:sO(),nombre_comercial:t.datos_generales.nombre_comercial,medida:a,color:c,precio:t.precios.precios_producto[0].precio_neto,cantidad:0,precio_unidad:{numero_precio:1,precio_venta:t.precios.precios_producto[0].precio_venta,precio_neto:t.precios.precios_producto[0].precio_neto,unidad_mayoreo:0,iva_precio:i,ieps_precio:o,utilidad:t.precios.precios_producto[0].utilidad,unidad_maxima:!1}},nuevaCantidad:0})},r=0;r<n.length;r++)c(r)},g=0;g<s.length;g++)f(g);else if(n.length>0&&!s.length){var v=d.filter((function(e){return e.medida.medida._id}));if(v.length)for(var C=0;C<d.length;C++){var y=d[C];l.push({medida:{existencia:y.medida.existencia,codigo_barras:y.medida.codigo_barras,nombre_comercial:y.medida.nombre_comercial,medida:y.medida.medida,color:y.medida.color,precio:y.medida.precio,cantidad:y.medida.cantidad,precio_unidad:y.precio_unidad},nuevaCantidad:y.nuevaCantidad})}}}else for(var S=0;S<s.length;S++){var F=s[S],w=parseFloat((t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(u<10?"0".concat(u):u))).toFixed(2)),I=parseFloat((t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(m<10?"0".concat(m):m))).toFixed(2));l.push({medida:{existencia:!1,codigo_barras:sO(),nombre_comercial:t.datos_generales.nombre_comercial,medida:F,color:{nombre:"",hex:""},precio:t.precios.precios_producto[0].precio_neto,cantidad:0,precio_unidad:{numero_precio:1,precio_venta:t.precios.precios_producto[0].precio_venta,precio_neto:t.precios.precios_producto[0].precio_neto,unidad_mayoreo:0,iva_precio:w,ieps_precio:I,utilidad:t.precios.precios_producto[0].utilidad,unidad_maxima:!1}},nuevaCantidad:0})}c(Object(da.a)(s)),i(l)}(!b)},style:b?{backgroundColor:d.palette.primary.main}:null,children:Object(B.jsx)(S.a,{variant:"button",style:{color:d.palette.getContrastText(b?d.palette.primary.main:"#FFFFFF"),fontSize:16},children:a.talla})})})},jO=function(e){var t=e.producto,a=e.color,n=e.coloresSeleccionados,c=e.setColoresSeleccionados,r=e.medidasSeleccionadas,i=e.datos,o=e.setNew_medidas,s=oO(),d=Object(Se.a)(),j=Object(l.useState)(!1),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(l.useCallback)((function(){n.forEach((function(e){e._id===a._id&&p(!0)}))}),[a._id,n]);Object(l.useEffect)((function(){if(t)return m()}),[t,m]);return Object(B.jsx)($e.a,{item:!0,children:Object(B.jsx)(ha.a,{title:a.nombre,placement:"top",arrow:!0,TransitionComponent:Xa.a,children:Object(B.jsx)("div",{className:s.colorContainer,style:{backgroundColor:a.hex,color:d.palette.getContrastText(a.hex)},onClick:function(){return function(e){b?n.forEach((function(t,c){t._id===a._id&&(n.splice(c,1),p(e))})):(n.push(a),p(e));var s=[],l=Object(da.a)(i),d=t.precios,j=d.iva,u=d.ieps;if(r.length||l.length){if(!r.length&&l.length>0)for(var m=function(e){var a=n[e],c=l.filter((function(e){return e.medida.color._id===a._id})),r=parseFloat((t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(j<10?"0".concat(j):j))).toFixed(2)),i=parseFloat((t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(u<10?"0".concat(u):u))).toFixed(2));c.length?s.push(c[0]):s.push({medida:{existencia:!1,codigo_barras:sO(),nombre_comercial:t.datos_generales.nombre_comercial,medida:{},color:a,precio:t.precios.precios_producto[0].precio_neto,cantidad:0,precio_unidad:{numero_precio:1,precio_venta:t.precios.precios_producto[0].precio_venta,precio_neto:t.precios.precios_producto[0].precio_neto,unidad_mayoreo:0,iva_precio:r,ieps_precio:i,utilidad:t.precios.precios_producto[0].utilidad,unidad_maxima:!1}},nuevaCantidad:0})},O=0;O<n.length;O++)m(O);else if(r.length>0&&1===n.length&&e)for(var x=0;x<l.length;x++)for(var h=0;h<n.length;h++)s.push({medida:{existencia:l[x].medida.existencia,codigo_barras:l[x].medida.codigo_barras,nombre_comercial:l[x].medida.nombre_comercial,medida:l[x].medida.medida,color:n[h],precio:l[x].medida.precio,cantidad:l[x].medida.cantidad,precio_unidad:l[x].medida.precio_unidad},nuevaCantidad:l[x].nuevaCantidad});else if(r.length>0&&n.length>0)for(var _=function(e){for(var a=n[e],c=function(e){var n=r[e],c=l.filter((function(e){return e.medida.medida._id===n._id&&a._id===e.medida.color._id})),i=parseFloat((t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(j<10?"0".concat(j):j))).toFixed(2)),o=parseFloat((t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(u<10?"0".concat(u):u))).toFixed(2));c.length?s.push(c[0]):s.push({medida:{existencia:!1,codigo_barras:sO(),nombre_comercial:t.datos_generales.nombre_comercial,medida:n,color:a,precio:t.precios.precios_producto[0].precio_neto,cantidad:0,precio_unidad:{numero_precio:1,precio_venta:t.precios.precios_producto[0].precio_venta,precio_neto:t.precios.precios_producto[0].precio_neto,unidad_mayoreo:0,iva_precio:i,ieps_precio:o,utilidad:t.precios.precios_producto[0].utilidad,unidad_maxima:!1}},nuevaCantidad:0})},i=0;i<r.length;i++)c(i)},f=0;f<n.length;f++)_(f);else if(r.length>0&&!n.length){var g=l.filter((function(e){return e.medida.color._id}));if(g.length)for(var v=0;v<l.length;v++){var C=l[v];s.push({medida:{existencia:C.medida.existencia,codigo_barras:C.medida.codigo_barras,nombre_comercial:C.medida.nombre_comercial,medida:C.medida.medida,color:{nombre:"",hex:""},precio:C.medida.precio,cantidad:C.medida.cantidad,precio_unidad:C.medida.precio_unidad},nuevaCantidad:C.nuevaCantidad})}}}else for(var y=0;y<n.length;y++){var S=n[y],F=parseFloat((t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(j<10?"0".concat(j):j))).toFixed(2)),w=parseFloat((t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(u<10?"0".concat(u):u))).toFixed(2));s.push({medida:{existencia:!1,codigo_barras:sO(),nombre_comercial:t.datos_generales.nombre_comercial,medida:{},color:S,precio:t.precios.precios_producto[0].precio_neto,cantidad:0,precio_unidad:{numero_precio:1,precio_venta:t.precios.precios_producto[0].precio_venta,precio_neto:t.precios.precios_producto[0].precio_neto,unidad_mayoreo:0,iva_precio:F,ieps_precio:w,utilidad:t.precios.precios_producto[0].utilidad,unidad_maxima:!1}},nuevaCantidad:0})}c(Object(da.a)(n)),o(s)}(!b)},children:b?Object(B.jsx)(Dt.a,{}):null})})})},uO=Object(k.a)((function(e){return{root:{alignSelf:"center",width:"90%",paddingLeft:e.spacing(2),paddingRight:e.spacing(1)},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:"100%",maxWidth:"100%"},tableRow:{"&.Mui-selected, &.Mui-selected:hover":{backgroundColor:Object(tn.fade)(e.palette.primary.main,.1)}},cell:{align:"center"},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",height:30,width:30,borderRadius:"15%"}}}));function bO(e){var t=e.producto,a=e.setOnUpdate,n=e.onUpdate,c=e.new_medidas,r=e.setNew_medidas,i=uO();return Object(B.jsx)("div",{className:i.root,children:Object(B.jsx)(Ka.a,{className:i.paper,children:Object(B.jsx)(ba.a,{style:{height:400},children:Object(B.jsxs)(_a.a,{className:i.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Medida"}),Object(B.jsx)(Oa.a,{children:"Color"}),Object(B.jsx)(Oa.a,{children:"Cantidad existente"}),Object(B.jsx)(Oa.a,{children:"Cantidad a traspasar"})]})}),Object(B.jsx)(xa.a,{children:t.medidas_producto.map((function(e,i){return Object(B.jsx)(pO,{idProducto:t._id,medida:e,index:i,setOnUpdate:a,onUpdate:n,new_medidas:c,setNew_medidas:r},i)}))})]})})})})}var pO=function(e){var t=e.medida,a=e.index,n=(e.setOnUpdate,e.onUpdate,e.new_medidas),c=e.setNew_medidas,r=e.idProducto,i=Object(l.useState)(!0),o=Object(g.a)(i,2),s=o[0],d=(o[1],uO()),j=Object(l.useState)(0),u=Object(g.a)(j,2),p=u[0],m=u[1],O=Object(l.useState)(0),x=Object(g.a)(O,2),h=x[0],f=(x[1],Object(b.a)({},t)),v=Object(l.useContext)(tO).productosTras;Object(l.useEffect)((function(){return v.forEach((function(e){if(e.product_selected._id!==r);else{var a=[],n=null;for(var i in e.new_medidas)Object.hasOwnProperty.call(e.new_medidas,i)&&(n=e.new_medidas[i],a.push(n),t._id===n.medida._id&&m(n.nuevaCantidad));c(e.new_medidas)}})),function(){}}),[v]);return Object(B.jsxs)(ma.a,{selected:!s,className:d.tableRow,children:[Object(B.jsx)(Oa.a,{children:f.medida._id?Object(B.jsx)(Qa.a,{label:f.medida.talla,color:"primary"}):""}),Object(B.jsx)(Oa.a,{style:{width:"20%"},children:f.color._id?Object(B.jsx)(ha.a,{title:f.color.nombre,placement:"top",arrow:!0,TransitionComponent:Xa.a,children:Object(B.jsx)("div",{className:d.colorContainer,style:{backgroundColor:f.color.hex}})}):null}),Object(B.jsx)(Oa.a,{className:d.cell,style:{width:"25%"},children:t.cantidad}),Object(B.jsx)(Oa.a,{style:{width:"25%"},children:Object(B.jsx)(F.a,{size:"small",variant:"outlined",InputProps:{inputProps:{min:0}},inputMode:"numeric",type:"number",value:p,onChange:function(e){return function(e){var r=h>0?parseInt(e-h):e;r<=t.cantidad&&(m(e),c(Object(b.a)(Object(b.a)({},n),{},Object(_.a)({},a,{medida:t,nuevaCantidad:parseInt(r)}))))}(e.target.value)},name:"nuevaCantidad"})})]})};function mO(e){var t=e.classes,a=e.order,n=e.orderBy,c=e.onRequestSort,r=e.add?[{id:"codeBarras",numeric:!1,disablePadding:!1,label:"C\xf3digo de barras"},{id:"name",numeric:!1,disablePadding:!0,label:"Nombre"},{id:"tipo",numeric:!0,disablePadding:!1,label:"Tipo"},{id:"cantidad",numeric:!0,disablePadding:!1,label:"Cantidad"}]:[{id:"codeBarras",numeric:!1,disablePadding:!1,label:"C\xf3digo de barras"},{id:"name",numeric:!1,disablePadding:!0,label:"Nombre"},{id:"tipo",numeric:!0,disablePadding:!1,label:"Tipo"},{id:"cantidad",numeric:!0,disablePadding:!1,label:"Cantidad"},{id:"solo",numeric:!0,disablePadding:!1,label:" "}];return Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:r.map((function(e){return Object(B.jsx)(Oa.a,{align:"left",sortDirection:n===e.id&&a,children:Object(B.jsxs)(Xm.a,{active:n===e.id,direction:n===e.id?a:"asc",onClick:(r=e.id,function(e){c(e,r)}),children:[e.label,n===e.id?Object(B.jsx)("span",{className:t.visuallyHidden,children:"desc"===a?"sorted descending":"sorted ascending"}):null]})},e.id);var r}))})})}var OO=Object(k.a)((function(e){return{root:{paddingLeft:e.spacing(2),paddingRight:e.spacing(1),maxWidth:650},input:{width:180},inputCantidad:{width:120,height:10},inputCantidadTable:{width:"20%",height:10},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(hj.f)(e.palette.primary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},title:{fontSize:16,flex:"1",display:"flex",flexWrap:"wrap"}}})),xO=function(e){var t=Object(l.useState)([]),a=Object(g.a)(t,2),n=a[0],c=a[1],r=Object(l.useContext)(tO),i=r.setProductosTras,o=r.productosTras,s=function(){try{e.setOpenTallas(),e.setproduct_selected(void 0)}catch(t){}};return Object(l.useEffect)((function(){var t=[];o.forEach((function(a){if(a.product_selected._id===e.product_selected._id){var n=null;for(var c in a.new_medidas)Object.hasOwnProperty.call(a.new_medidas,c)&&(n=a.new_medidas[c],t.push(n))}})),c(t)}),[o,e.product_selected._id]),Object(B.jsxs)(Ee.a,{open:e.openTallas,TransitionComponent:hO,fullWidth:!0,maxWidth:"md",children:[Object(B.jsx)(p.a,{m:1,display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){return s()},size:"large",children:Object(B.jsx)(We.a,{})})}),null===e.almacenOrigen?Object(B.jsx)("div",{children:Object(B.jsx)(lO,{obtenerConsultasProducto:e.obtenerConsultasProducto,refetch:e.obtenerConsultasProducto.refetch,producto:e.product_selected,new_medidas:n,setNew_medidas:c})}):Object(B.jsx)("div",{children:Object(B.jsx)(bO,{producto:e.product_selected,new_medidas:n,setNew_medidas:c,add:e.add})}),Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",m:1,mr:5,children:Object(B.jsx)(w.a,{variant:"contained",color:"primary",style:{width:"20%"},onClick:function(){var t=n,a=0;try{var r;r=null!==e.almacenOrigen?{_id:e.product_selected._id,datos_generales:e.product_selected.datos_generales,medidas_producto:e.product_selected.medidas_producto,inventario_general:e.product_selected.inventario_general,unidades_de_venta:e.product_selected.unidades_de_venta,precios:e.product_selected.precios,empresa:e.product_selected.empresa,sucursal:e.product_selected.sucursal,usuario:e.product_selected.usuario}:{_id:e.product_selected._id,datos_generales:e.product_selected.datos_generales,precios:e.product_selected.precios,medidas_producto:[],inventario_general:[{unidad_maxima:""}],unidades_de_venta:[],empresa:e.product_selected.empresa,sucursal:e.product_selected.sucursal,usuario:e.product_selected.usuario};var l=!1,d=o,j=[];for(var u in t)a+=t[u].nuevaCantidad,j.push(t[u]);if(a>0){if(d.length){if(d.forEach((function(t){if(t.product_selected._id===e.product_selected._id)return l=!0,t.new_medidas=j,void(t.cantidad_total=a)})),!l){var b={product_selected:r,new_medidas:j,cantidad_total:parseInt(a),unidad_maxima:!1};d.push(b)}}else{var p={product_selected:r,new_medidas:j,cantidad_total:parseInt(a),unidad_maxima:!1};d.push(p)}i(Object(da.a)(d)),c([]),s()}}catch(m){}},children:"AGREGAR"})})]})},hO=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),_O=function(e){var t=OO(),a=Object(l.useState)(""),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=e.product_selected,u=e.setproduct_selected,b=e.tipoPieza,m=e.update,O=Object(l.useContext)(tO),x=O.setProductosTras,h=O.productosTras,f=function(t){try{if(e.setError({error:!1,mensaje:""}),0===t||""===t)return;var a=h.find((function(e){return e.product_selected._id===j._id}));if(a){var n=parseFloat(t);return e.add?void 0!==j.inventario_general?b.piezas?n<=j.inventario_general[0].cantidad_existente?a.cantidad_total=n:e.setError({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente del producto seleccionado."}):n<=j.inventario_general[0].cantidad_existente_maxima?a.cantidad_total=n:e.setError({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente del producto seleccionado."}):a.cantidad_total=n:a.cantidad_total=parseFloat(t),void x(Object(da.a)(h))}var c={_id:e.product_selected._id,datos_generales:e.product_selected.datos_generales,inventario_general:e.product_selected.inventario_general,unidades_de_venta:e.product_selected.unidades_de_venta,medidas_producto:e.product_selected.medidas_producto,precios:e.product_selected.precios,empresa:e.product_selected.empresa,sucursal:e.product_selected.sucursal,usuario:e.product_selected.usuario};if(void 0!==j.inventario_general)if(t<=j.inventario_general[0].cantidad_existente){var r={product_selected:c,new_medidas:[],cantidad_total:t,unidad_maxima:b.cajas};x([].concat(Object(da.a)(h),[r]))}else e.setError({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente."});else{var i={product_selected:c,new_medidas:[],cantidad_total:t,unidad_maxima:b.cajas};x([].concat(Object(da.a)(h),[i]))}return void u(void 0)}catch(o){}};Object(l.useEffect)((function(){try{e.add&&e.setOpenTallas(!0),r(e.cant)}catch(t){}}),[j]);var v,C,y=function(){try{var e={Pz:{unidad_maxima:null,unidad_minima:"Pz"},Caja:{unidad_maxima:"Caja",unidad_minima:"Pz"},Kg:{unidad_maxima:null,unidad_minima:"Kg"},Costal:{unidad_maxima:"Costal",unidad_minima:"Kg"},Lt:{unidad_maxima:null,unidad_minima:"Lt"}};return Object(B.jsxs)(p.a,{flexDirection:"row",display:"flex",children:[Object(B.jsxs)(p.a,{flexDirection:"row",children:[Object(B.jsx)(Me.a,{checked:b.piezas,color:"primary",onChange:function(){m(),r(0)},disabled:null===e[j.precios.unidad_de_compra.unidad].unidad_maxima}),Object(B.jsx)(S.a,{color:"primary",style:{marginLeft:10},children:e[j.precios.unidad_de_compra.unidad].unidad_minima})]}),null!==e[j.precios.unidad_de_compra.unidad].unidad_maxima?Object(B.jsxs)(p.a,{flexDirection:"row",children:[Object(B.jsx)(Me.a,{checked:b.cajas,color:"primary",onChange:function(){m(),r(0)}}),Object(B.jsxs)(S.a,{color:"primary",style:{marginLeft:10},children:[e[j.precios.unidad_de_compra.unidad].unidad_maxima," "]})]}):Object(B.jsx)("div",{})]})}catch(t){}};return Object(B.jsxs)(we.a,{className:Object(Qm.a)(t.root,Object(_.a)({},t.highlight,void 0!==j&&e.add)),children:[Object(B.jsxs)($e.a,{container:!0,children:[void 0!==j&&e.add?Object(B.jsx)(p.a,{style:{width:"100%"},children:Object(B.jsx)(S.a,{className:t.title,color:"inherit",variant:"subtitle2",children:j.datos_generales.nombre_comercial})}):Object(B.jsxs)(p.a,{style:{width:"100%"},flexDirection:"row",display:"flex",children:[Object(B.jsx)(S.a,{className:t.title,variant:"h6",id:"tableTitle",component:"div",children:e.title}),h.length>0&&!e.add?Object(B.jsx)(ha.a,{title:"Eliminar todos",children:Object(B.jsx)(X.a,{"aria-label":"delete",onClick:function(){return d(!0)},children:Object(B.jsx)(Ju.a,{})})}):Object(B.jsx)("div",{})]}),void 0!==j?Object(B.jsxs)(p.a,{children:[e.error.error?Object(B.jsx)(S.a,{color:"inherit",children:e.error.mensaje}):Object(B.jsx)("div",{}),e.add&&"OTROS"===j.datos_generales.tipo_producto?Object(B.jsxs)($e.a,{container:!0,justifyContent:"space-evenly",ml:1,children:[null===e.almacenOrigen?Object(B.jsx)(y,{}):Object(B.jsxs)(p.a,{flexDirection:"row",display:"flex",children:[Object(B.jsxs)(p.a,{flexDirection:"row",children:[Object(B.jsx)(Me.a,{checked:b.piezas,color:"primary",onChange:function(){m(),r(0)},disabled:null===e.product_selected.inventario_general[0].cantidad_existente_maxima}),Object(B.jsx)(S.a,{color:"primary",style:{marginLeft:10},children:e.product_selected.inventario_general[0].unidad_inventario})]}),null!==e.product_selected.inventario_general[0].unidad_maxima?Object(B.jsxs)(p.a,{flexDirection:"row",children:[Object(B.jsx)(Me.a,{checked:b.cajas,color:"primary",onChange:function(){m(),r(0)}}),Object(B.jsxs)(S.a,{color:"primary",style:{marginLeft:10},children:[""+e.product_selected.inventario_general[0].unidad_maxima," "]})]}):Object(B.jsx)("div",{})]}),Object(B.jsxs)(p.a,{width:"180px",ml:2,children:[Object(B.jsx)(S.a,{color:"primary",children:"Cantidad"}),Object(B.jsx)(F.a,{className:t.inputCantidad,size:"small",name:"cantidad",variant:"outlined",type:"number",InputProps:{inputProps:{min:0}},value:c,onKeyPress:function(e){try{"Enter"===e.key&&f(parseFloat(e.target.value))}catch(t){}},onChange:function(t){return function(t){e.setError({error:!1,mensaje:""});var a=""!==t?parseFloat(t):0;try{return null!==e.almacenOrigen?b.piezas?a<=j.inventario_general[0].cantidad_existente?void r(0!==a?a:""):void e.setError({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente."}):a<=j.inventario_general[0].cantidad_existente_maxima?void r(0!==a?a:""):void e.setError({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente."}):void r(a)}catch(n){}}(t.target.value)}}),Object(B.jsx)(ha.a,{title:"Agregar",children:Object(B.jsx)(X.a,{"aria-label":"add",onClick:function(){return f(c)},children:Object(B.jsx)(ac.a,{})})})]}),e.almacenOrigen?Object(B.jsx)(p.a,{width:"150px",children:null!==e.product_selected.inventario_general[0].cantidad_existente_maxima?Object(B.jsx)(S.a,{color:"primary",style:{flexWrap:"wrap"},children:(v=e.product_selected.inventario_general[0].cantidad_existente_maxima,C=e.product_selected.inventario_general[0].unidad_maxima,{Caja:"Cantidad existente en cajas: "+v,Costal:"Cantidad existente en costales: "+v}[C])}):Object(B.jsx)("div",{})}):Object(B.jsx)("div",{})]}):Object(B.jsx)("div",{children:Object(B.jsx)(xO,{openTallas:e.openTallas,setOpenTallas:e.setOpenTallas,setproduct_selected:u,product_selected:j,almacenOrigen:e.almacenOrigen,obtenerConsultasProducto:e.obtenerConsultasProducto,refetch:e.refetch})})]}):Object(B.jsx)("div",{})]}),Object(B.jsxs)(Ee.a,{open:s,onClose:function(){return d(!1)},children:[Object(B.jsx)(wt.a,{children:"\xbfEst\xe1 seguro de realizar esta acci\xf3n?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:function(){return d(!1)},color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:function(){return function(){try{u(void 0),x([])}catch(e){}}()},children:"Eliminar"})]})]})]})},fO=Object(k.a)((function(e){return{root:{marginLeft:e.spacing(1),marginRight:e.spacing(1)},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:600,maxWidth:600},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function gO(e){var t=fO(),a=Object(l.useState)("asc"),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)("calories"),o=Object(g.a)(i,2),s=o[0],j=o[1],u=Object(l.useState)(void 0),m=Object(g.a)(u,2),O=m[0],x=m[1],h=Object(l.useState)(!1),_=Object(g.a)(h,2),f=_[0],v=_[1],C=Object(l.useState)(0),y=Object(g.a)(C,2),S=y[0],w=y[1],I=Object(l.useState)({error:!1,mensaje:""}),k=Object(g.a)(I,2),z=k[0],N=k[1],P=d.a.useState(0),D=Object(g.a)(P,2),E=D[0],A=(D[1],Object(l.useState)(5)),T=Object(g.a)(A,2),W=T[0],$=(T[1],Object(l.useState)({piezas:!0,cajas:!1})),R=Object(g.a)($,2),V=R[0],M=R[1],L=JSON.parse(localStorage.getItem("sesionCafi")),U=Object(l.useContext)(tO),q=U.productosTras,J=U.productosTo,G=U.productosEmpTo,H=U.setProductosTras,Y=Object(qe.a)(kn,{variables:{empresa:L.empresa._id,sucursal:L.sucursal._id}}),K=e.add?e.almacenOrigen?J:G:q,Q=function(t,a,n){if(N({error:!1,mensaje:""}),"OTROS"===a.datos_generales.tipo_producto){var c=0;q.forEach((function(e){e.product_selected._id===a._id&&(c=e.cantidad_total)})),w(e.add?c:n)}if(void 0!==O){var r=O._id===a._id;x(r?void 0:a)}else x(a)},Z=function(t,a){try{var n=q.find((function(e){return e.product_selected._id===a._id}));if(0===t||""===t)return void(n.cantidad_total=0);if(n){var c=parseFloat(t+n.cantidad_total);return e.add?void 0!==a.inventario_general?V.piezas?c<=a.inventario_general[0].cantidad_existente?n.cantidad_total=c:N({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente del producto seleccionado."}):c<=a.inventario_general[0].cantidad_existente_maxima?n.cantidad_total=c:N({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente del producto seleccionado."}):n.cantidad_total=c:n.cantidad_total=parseFloat(t),void H(Object(da.a)(q))}return}catch(z){}};var ee=W-Math.min(W,K.length-E*W);return Object(B.jsx)("div",{className:t.root,children:Object(B.jsxs)(Ka.a,{className:t.paper,children:[Object(B.jsx)(_O,{product_selected:O,setproduct_selected:x,openTallas:f,setOpenTallas:v,error:z,setError:N,title:e.title,add:e.add,almacenOrigen:e.almacenOrigen,productosTras:q,tipoPieza:V,update:function(){M(Object(b.a)(Object(b.a)({},V),{},{piezas:!V.piezas,cajas:!V.cajas}))},cant:S,obtenerConsultasProducto:Y.data?Y.data.obtenerConsultasProducto:[],refetch:Y.refetch?Y.refetch:null}),Object(B.jsx)(ba.a,{style:{height:"50vh"},children:Object(B.jsxs)(_a.a,{className:t.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"a dense table",children:[Object(B.jsx)(mO,{classes:t,product_selected:O,add:e.add,order:c,orderBy:s,handleSelectAllClick:function(e){e.target.checked?x(e.target.checked):x([])},onRequestSort:function(e,t){r(s===t&&"asc"===c?"desc":"asc"),j(t)},rowCount:K.length}),Object(B.jsxs)(xa.a,{children:[K.map((function(t,a){var n,c=(n=!0===e.add?t._id:t.product_selected._id,void 0!==O&&!(O._id!==n)),r="enhanced-table-checkbox-".concat(a);return e.add?e.almacenOrigen?Object(B.jsxs)(ma.a,{hover:!0,onClick:function(e){return Q(0,t)},role:"checkbox","aria-checked":c,tabIndex:-1,selected:c,children:[Object(B.jsx)(Oa.a,{id:r,scope:"row",children:null==t.datos_generales.codigo_barras?"SIN C\xd3DIGO":t.datos_generales.codigo_barras}),Object(B.jsx)(Oa.a,{component:"th",id:r,scope:"row",children:t.datos_generales.nombre_comercial}),Object(B.jsxs)(Oa.a,{align:"left",children:[" ",t.datos_generales.tipo_producto]}),Object(B.jsxs)(Oa.a,{align:"left",children:[" ",t.inventario_general[0].cantidad_existente,"  ",t.inventario_general[0].unidad_inventario," "]})]},!0===e.add?t._id:t.product_selected._id):Object(B.jsxs)(ma.a,{hover:!0,onClick:function(e){return Q(0,t)},role:"checkbox","aria-checked":c,tabIndex:-1,selected:c,children:[Object(B.jsx)(Oa.a,{id:r,scope:"row",children:null==t.datos_generales.codigo_barras?"SIN C\xd3DIGO":t.datos_generales.codigo_barras}),Object(B.jsx)(Oa.a,{component:"th",id:r,scope:"row",children:t.datos_generales.nombre_comercial}),Object(B.jsxs)(Oa.a,{align:"left",children:[" ",t.datos_generales.tipo_producto]}),Object(B.jsx)(Oa.a,{align:"left",children:" N/A"})]},t._id):Object(B.jsxs)(ma.a,{hover:!0,onClick:function(e){return Q(0,t.product_selected,t.cantidad_total)},role:"checkbox","aria-checked":c,tabIndex:-1,selected:c,children:[Object(B.jsx)(Oa.a,{id:r,component:"th",width:100,children:null==t.product_selected.datos_generales.codigo_barras?"SIN C\xd3DIGO":t.product_selected.datos_generales.codigo_barras}),Object(B.jsx)(Oa.a,{id:r,width:200,children:t.product_selected.datos_generales.nombre_comercial}),Object(B.jsxs)(Oa.a,{align:"left",children:[" ",t.product_selected.datos_generales.tipo_producto]}),"OTROS"===t.product_selected.datos_generales.tipo_producto?Object(B.jsx)(Oa.a,{align:"left",width:20,children:Object(B.jsx)(F.a,{size:"small",name:"cantidad",variant:"outlined",type:"number",InputProps:{inputProps:{min:0}},value:t.cantidad_total,onChange:function(a){return function(t,a){if(N({error:!1,mensaje:""}),""!==t){var n=parseFloat(t);try{if(null===e.almacenOrigen)return void Z(n,a);if(V.piezas){if(n<=a.inventario_general[0].cantidad_existente)return void Z(n,a)}else if(n<=a.inventario_general[0].cantidad_existente_maxima)return void Z(n,a)}catch(z){console.log(z)}}else Z("",a)}(a.target.value,t.product_selected)}})}):Object(B.jsxs)(Oa.a,{align:"left",children:[" ",t.cantidad_total]}),Object(B.jsx)(Oa.a,{align:"left",width:10,children:Object(B.jsxs)(p.a,{flexDirection:"row",display:"flex",style:{width:75},children:["OTROS"!==t.product_selected.datos_generales.tipo_producto?Object(B.jsx)(ha.a,{title:"Editar",children:Object(B.jsx)(X.a,{"aria-label":"edit",onClick:function(){return function(e){try{"OTROS"!==e.datos_generales.tipo_producto&&v(!0)}catch(z){}}(t.product_selected)},children:Object(B.jsx)(eO.a,{})})}):Object(B.jsx)("div",{}),Object(B.jsx)(ha.a,{title:"Eliminar",children:Object(B.jsx)(X.a,{"aria-label":"delete",onClick:function(){return function(e){try{var t=[];q.length&&(t=q),H(t.filter((function(t){return t.product_selected._id!==e._id})))}catch(z){}}(t.product_selected)},children:Object(B.jsx)(Ju.a,{})})})]})})]},!0===e.add?t._id:t.product_selected._id)})),ee>0&&Object(B.jsx)(ma.a,{style:{height:53*ee},children:Object(B.jsx)(Oa.a,{colSpan:6})})]})]})})]})})}var vO=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:50},imagen:{width:50},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& span":{color:"red"}},subtitle:{marginLeft:"10px",width:"50%"},boxUpData:{height:80},formControl:{margin:e.spacing(1),minWidth:300,maxWidth:300},selected2:{width:"50%",height:50},selected:{width:"50%",height:50},input:{width:"100%"},inputBox:{margin:20,marginTop:5,marginBottom:10},button:{margin:e.spacing(3),marginTop:e.spacing(2),marginBottom:e.spacing(0)},boxControl:{margin:e.spacing(2.5),marginTop:0,minWidth:"20%",maxWidth:"20%",minHeight:20},centerControl:{marginTop:10}}}));function CO(e,t,a){return{fontWeight:-1===t.indexOf(e)?a.typography.fontWeightRegular:a.typography.fontWeightMedium}}var yO=Object(l.forwardRef)((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),SO={PaperProps:{style:{maxHeight:908,width:400}}},FO=["Barco","Moto","Carro","Camioneta"],wO=["Datos traspaso","Seleccionar productos"];function IO(e){var t=vO(),a=Object(Se.a)(),n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(l.useContext)(tO),r=c.setProductos,i=c.setProductosTras,o=c.setProductosTo,s=c.setProductosEmpTo,d=c.productosTras,j=Object(l.useState)({message:"",status:"",open:!1}),u=Object(g.a)(j,2),m=u[0],O=u[1],x=Object(l.useState)(!1),h=Object(g.a)(x,2),_=h[0],v=h[1],y=Object(l.useState)(!1),I=Object(g.a)(y,2),k=I[0],N=I[1],P=Object(l.useState)(""),D=Object(g.a)(P,2),E=D[0],A=D[1],T=Object(_c.a)(E,700),W=Object(g.a)(T,1)[0],$=Object(l.useState)(!1),R=Object(g.a)($,2),V=R[0],M=R[1],L=Object(l.useState)(null),U=Object(g.a)(L,2),q=U[0],G=U[1],Z=Object(l.useState)(!1),ee=Object(g.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(l.useState)(!1),ce=Object(g.a)(ne,2),re=ce[0],ie=ce[1],oe=Object(l.useState)(null),se=Object(g.a)(oe,2),le=se[0],de=se[1],je=Object(l.useState)(null),ue=Object(g.a)(je,2),be=ue[0],pe=ue[1],me=Object(l.useState)([]),Oe=Object(g.a)(me,2),xe=Oe[0],he=Oe[1],_e=Object(l.useState)(""),fe=Object(g.a)(_e,2),ge=fe[0],ve=fe[1],Ce=Object(l.useState)(""),ye=Object(g.a)(Ce,2),ke=ye[0],ze=ye[1],Ne=Object(l.useState)(""),Pe=Object(g.a)(Ne,2),De=Pe[0],Ae=Pe[1],Te=Object(l.useState)(0),We=Object(g.a)(Te,2),Re=We[0],Ve=We[1],Me=Object(l.useState)(new Set),Be=Object(g.a)(Me,2),Je=Be[0],Ge=Be[1],Ye=Object(l.useState)(!1),Ke=Object(g.a)(Ye,2),Qe=Ke[0],Xe=Ke[1],Ze=Object(z.a)(Tr),et=Object(g.a)(Ze,1)[0],tt=[],at=[],nt=Object(qe.a)(Nr,{variables:{id:n.sucursal._id},fetchPolicy:"network-only"}),ct=Object(qe.a)(iu,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id},fetchPolicy:"network-only"}),rt=Object(qe.a)(Ar,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id},fetchPolicy:"network-only"}),it=Object(qe.a)(Nn,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id,filtro:W,almacen:le?le._id:"",existencias:!0},fetchPolicy:"network-only"}),ot=Object(qe.a)(Wr,{variables:{empresa:n.empresa._id,filtro:W},fetchPolicy:"network-only"}),st=Object(l.useCallback)(Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{it.refetch()}catch(t){}case 1:case"end":return e.stop()}}),e)}))),[it]);Object(l.useEffect)((function(){le&&(he(nt.data.obtenerAlmacenes.filter((function(e){return e._id!==le._id}))),st())}),[le]);var lt=Object(l.useCallback)(Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{ot.refetch()}catch(t){console.log("errorObtenerProductosEmpresa",t)}case 1:case"end":return e.stop()}}),e)}))),[ot]);Object(l.useEffect)((function(){try{null!==q&&("N/A"===q.origen?lt():st())}catch(e){console.log("conceptoTraspaso",e)}}),[q]),Object(l.useEffect)((function(){null!==q&&("N/A"===q.destino?M(null!==le):"N/A"===q.origen?M(null!==be):M(null!==le&&null!==be))}),[q,le,be]),Object(l.useEffect)((function(){ot.data&&s(ot.data.obtenerProductosPorEmpresa)}),[ot.data,s]),Object(l.useEffect)((function(){if(it.data)return r(it.data.obtenerProductos),void o(it.data.obtenerProductos)}),[it,r,o]),Object(l.useEffect)((function(){N(!0),rt.refetch(),N(!1)}),[rt]);var dt=function(){v(!1)},jt=function(e){return Je.has(e)},ut=function(){Ve((function(e){return e-1}))};ct.data&&(tt=ct.data.obtenerConceptosAlmacen),nt.data&&(at=nt.data.obtenerAlmacenes);var bt=function(){Xe(!Qe)},pt=function(){var t=Object(f.a)(C.a.mark((function t(){var a,c;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!d.length){t.next=12;break}return Xe(!1),N(!0),a={variables:{input:{concepto_traspaso:{_id:q._id,nombre_concepto:q.nombre_concepto,destino:q.destino,origen:q.origen,editable:q.editable},almacen_origen:null!==le?{_id:le._id,nombre_almacen:le.nombre_almacen,default_almacen:le.default_almacen}:{_id:"",nombre_almacen:"",default_almacen:!1},almacen_destino:null!==be?{_id:be._id,nombre_almacen:be.nombre_almacen,default_almacen:be.default_almacen}:{_id:"",nombre_almacen:"",default_almacen:!1},productos:d,datos_transporte:{transporte:ge,placas:ke,nombre_encargado:De},sucursalOrigen:n.sucursal._id,sucursalDestino:n.sucursal._id,fecha_registro:ht()().locale("es-mx").format()},usuario:n._id,empresa:n.empresa._id}},t.next=7,et(a);case 7:c=t.sent,O({message:c.data.crearTraspaso.message,status:c.data.crearTraspaso.resp,open:!0}),"error"!==c.data.crearTraspaso.resp&&(i([]),de(null),pe(null),G(null),ut()),t.next=13;break;case 12:O({message:"No es posible realizar un traspaso sin agregar productos.",status:"error",open:!0});case 13:e.refetch(),N(!1),t.next=24;break;case 17:t.prev=17,t.t0=t.catch(0),N(!1),Xe(!1),console.log(t.t0),void 0!==t.t0.networkError?console.log("traspaso networkError",t.t0.networkError.result):void 0!==t.t0.graphQLErrors&&console.log("traspaso graphQLErrors",t.t0.graphQLErrors),O({message:"Ocurri\xf3 un error al realizar el traspaso...",status:"error",open:!0});case 24:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(){return t.apply(this,arguments)}}();return Object(B.jsx)(B.Fragment,{children:Object(B.jsxs)(p.a,{sx:{width:"100%"},children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){v(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsxs)($e.a,{container:!0,justifyContent:"center",children:[Object(B.jsx)($e.a,{item:!0,xs:12,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Fe.a,{className:t.icon})})}),Object(B.jsx)($e.a,{item:!0,md:6,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:Km,alt:"icono almacen",className:t.imagen})})}),Object(B.jsx)($e.a,{item:!0,md:6,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:Km,alt:"icono almacen",className:t.imagen})})})]}),"Traspasos"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:_,onClose:dt,TransitionComponent:yO,children:[Object(B.jsx)(He,{loading:k,setLoading:N}),Object(B.jsx)(Ie.a,{className:t.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:t.title,children:"Traspasos"}),Object(B.jsx)(p.a,{mx:3,children:Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:dt,children:Object(B.jsx)(Pt.a,{style:{fontSize:30}})})})}),Object(B.jsx)(X.a,{edge:"start",color:"inherit",onClick:dt,"aria-label":"close"})]})}),Object(B.jsx)(p.a,{style:{width:"50%",alignSelf:"center",alignContent:"center",alignItems:"center"},children:Object(B.jsx)(Gm.a,{activeStep:Re,children:wO.map((function(e,t){var a={};return jt(t)&&(a.completed=!1),Object(B.jsx)(Hm.a,Object(b.a)(Object(b.a)({},a),{},{children:Object(B.jsx)(Ym.a,Object(b.a)(Object(b.a)({},{}),{},{children:e}))}),e)}))})}),Object(B.jsxs)(p.a,{children:[0===Re?Object(B.jsx)($e.a,{container:!0,justify:"center",children:Object(B.jsx)($e.a,{item:!0,lg:6,children:Object(B.jsxs)(p.a,{children:[Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{className:t.subtitle,children:Object(B.jsx)("b",{children:"Datos traspaso"})}),Object(B.jsx)(Le.a,{}),Object(B.jsxs)(p.a,{mt:2,style:{display:"flex",width:"100%",justifyContent:"center"},children:[Object(B.jsxs)(p.a,{m:3,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Usuario"})}),Object(B.jsxs)(S.a,{children:[" ",n.nombre," "]})]}),Object(B.jsxs)(p.a,{m:3,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Sucursal"})}),Object(B.jsxs)(S.a,{children:[" ",n.sucursal.nombre_sucursal," "]})]}),Object(B.jsxs)(p.a,{m:3,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Fecha"})}),Object(B.jsxs)(S.a,{children:["  ",ht()().format("MM/DD/YYYY")," "]})]})]}),Object(B.jsxs)(p.a,{m:2,style:{width:"100%",justifyContent:"center"},children:[Object(B.jsx)(p.a,{style:{width:"100%"},children:Object(B.jsxs)(H.a,{className:t.formControl,children:[Object(B.jsx)(Y.a,{id:"concepto-label",children:"Concepto traspaso"}),Object(B.jsx)(mt.a,{labelId:"concepto-label",id:"concepto-name",value:q||"",onChange:function(e){try{var t=e.target.value;he([]),at=[],de(null),pe(null),"N/A"===t.origen?he(nt.data.obtenerAlmacenes):he([]),ae("N/A"!==t.origen),ie("N/A"!==t.destino),G(t)}catch(a){}},input:Object(B.jsx)(Ya.a,{}),MenuProps:SO,children:tt.map((function(e){return Object(B.jsx)(Ot.a,{value:e,children:e.nombre_concepto},e._id)}))})]})}),null!==q?Object(B.jsxs)(p.a,{style:{display:"flex"},children:[te?Object(B.jsx)(p.a,{children:Object(B.jsxs)(H.a,{className:t.formControl,children:[Object(B.jsx)(Y.a,{id:"almacen-origen-label",children:"Almac\xe9n origen"}),Object(B.jsx)(mt.a,{labelId:"almacen-origen-label",id:"almacen-origen-name",value:le||"",onChange:function(e){console.log(e.target.value),de(e.target.value),i([])},input:Object(B.jsx)(Ya.a,{}),MenuProps:SO,children:at.map((function(e){return Object(B.jsx)(Ot.a,{value:e,children:e.nombre_almacen},e._id)}))})]})}):Object(B.jsx)(B.Fragment,{}),re?Object(B.jsxs)(H.a,{className:t.formControl,children:[Object(B.jsx)(Y.a,{id:"almacen-destino-label",children:"Almac\xe9n destino"}),Object(B.jsx)(mt.a,{labelId:"almacen-destino-label",id:"almacen-destino-name",value:be||"",onChange:function(e){pe(e.target.value),i([])},input:Object(B.jsx)(Ya.a,{}),MenuProps:SO,children:xe.map((function(e){return Object(B.jsx)(Ot.a,{value:e,children:e.nombre_almacen},e._id)}))})]}):Object(B.jsx)(B.Fragment,{})]}):Object(B.jsx)(B.Fragment,{})]})]}),Object(B.jsxs)(p.a,{className:t.centerControl,style:{width:"100%"},children:[Object(B.jsx)(S.a,{className:t.subtitle,children:Object(B.jsx)("b",{children:"Datos transporte traspaso"})}),Object(B.jsx)(Le.a,{}),Object(B.jsxs)($e.a,{justify:"center",children:[Object(B.jsxs)(H.a,{className:t.formControl,style:{marginTop:15},children:[Object(B.jsx)(Y.a,{id:"transporte-label",children:"Transporte"}),Object(B.jsx)(mt.a,{labelId:"transporte-label",id:"transporte-name",value:ge,onChange:function(e){ve(e.target.value)},input:Object(B.jsx)(Ya.a,{}),MenuProps:SO,children:FO.map((function(e){return Object(B.jsx)(Ot.a,{value:e,style:CO(e,ge,a),children:e},e)}))})]}),Object(B.jsxs)(p.a,{justify:"center",children:[Object(B.jsxs)(H.a,{className:t.formControl,children:[Object(B.jsx)(S.a,{children:"Placas"}),Object(B.jsx)(F.a,{fullWidth:!0,className:t.input,type:"text",size:"small",name:"placas",variant:"outlined",value:ke.toUpperCase(),onChange:function(e){return ze(e.target.value)}})]}),Object(B.jsxs)(H.a,{className:t.formControl,children:[Object(B.jsx)(S.a,{children:"Nombre de encargado de transporte"}),Object(B.jsx)(F.a,{fullWidth:!0,className:t.input,type:"text",size:"small",name:"nombreQuien",variant:"outlined",value:De,onChange:function(e){return Ae(e.target.value)}})]})]})]})]})]})})}):Object(B.jsx)(p.a,{children:Object(B.jsxs)(p.a,{ml:1,style:{width:"100%"},children:[Object(B.jsxs)(p.a,{ml:2,children:[Object(B.jsx)(S.a,{className:t.subtitle,children:Object(B.jsx)("b",{children:"Buscar producto"})}),Object(B.jsx)(p.a,{style:{width:"35%"},children:Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsx)(K.a,{id:"search-producto",type:"text",value:E,onChange:function(e){return A(e.target.value)},endAdornment:Object(B.jsx)(Q.a,{position:"start",children:Object(B.jsx)(X.a,{type:"submit","aria-label":"search producto",edge:"end",children:Object(B.jsx)(sc.a,{})})})})})})]}),Object(B.jsx)(p.a,{mt:2,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,style:{width:"100%"},children:[Object(B.jsx)($e.a,{item:!0,md:6,children:te?Object(B.jsx)(gO,{title:"Productos",add:!0,almacenOrigen:le}):Object(B.jsx)(gO,{title:"Productos",add:!0,almacenOrigen:null})}),Object(B.jsx)($e.a,{item:!0,md:6,children:Object(B.jsx)(gO,{title:"Productos a traspasar",add:!1,almacenOrigen:le})})]})})]})}),Object(B.jsx)(Ue.a,{style:{justifyContent:"center"},children:Object(B.jsxs)(p.a,{sx:{flexDirection:"row",alignSelf:"center",width:"15%",display:"flex",pt:2},children:[Object(B.jsx)(w.a,{color:"inherit",disabled:0===Re,onClick:ut,sx:{mr:1},children:"Atr\xe1s"}),Object(B.jsx)(p.a,{style:{flex:"1 1 auto"}}),Object(B.jsx)(w.a,{disabled:!V,onClick:function(){return Re<wO.length-1?function(){var e=Je;jt(Re)&&(e=new Set(e.values())).delete(Re),Ve((function(e){return e+1})),Ge(e)}():bt()},children:Re<wO.length-1?"Siguiente":"Terminar"})]})})]}),Object(B.jsxs)(Ee.a,{open:Qe,onClose:bt,children:[Object(B.jsx)(wt.a,{children:"\xbfEst\xe1 seguro de realizar este traspaso?"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:function(){return bt()},color:"primary",children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:function(){return pt()},children:"Traspasar"})]})]}),Object(B.jsx)(J,{alert:m,setAlert:O})]})]})})}var kO=Object(k.a)({root:{width:"100%",height:"48vh"},container:{maxHeight:"74vh"},colorContainer:{border:"1px solid rgba(0,0,0, .3)",height:30,width:30,borderRadius:"15%"}});function zO(e){var t=kO();return Object(B.jsx)("div",{className:t.root,children:Object(B.jsx)(Ka.a,{children:Object(B.jsx)(ba.a,{style:{height:"45vh"},children:Object(B.jsxs)(_a.a,{className:t.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Medida"}),Object(B.jsx)(Oa.a,{children:"Color"}),Object(B.jsx)(Oa.a,{children:"Cantidad existente"})]})}),Object(B.jsx)(xa.a,{children:e.producto.medidas_producto.map((function(t,a){return Object(B.jsx)(NO,{item:t,almacenSeleccionado:e.almacen},a)}))})]})})})})}var NO=function(e){var t=e.item,a=e.almacenSeleccionado,n=kO();try{var c=Object(B.jsx)("div",{});return a._id===t.almacen&&(c=Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:t.medida.talla}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(ha.a,{title:t.color.nombre,placement:"top",arrow:!0,children:Object(B.jsx)("div",{className:n.colorContainer,style:{backgroundColor:t.color.hex}})})}),Object(B.jsx)(Oa.a,{children:t.cantidad})]})),c}catch(r){console.log(r)}},PO={PaperProps:{style:{maxHeight:908,width:400}}},DO=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"100%"},formControl:{margin:e.spacing(1),minWidth:300,maxWidth:300}}})),EO=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function AO(e){var t=DO(),a=Object(l.useState)({}),n=Object(g.a)(a,2),c=n[0],r=n[1];return Object(B.jsxs)(Ee.a,{open:e.medidasAlmacen.open,TransitionComponent:EO,fullWidth:!0,maxWidth:"sm",children:[Object(B.jsx)(wt.a,{children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",width:"98%",children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){e.setMedidasAlmacen({open:!1,producto:{}}),r({})},size:"large",children:Object(B.jsx)(Pt.a,{style:{fontSize:30}})})})}),Object(B.jsx)(p.a,{mx:3,children:Object(B.jsxs)(H.a,{className:t.formControl,children:[Object(B.jsx)(Y.a,{id:"almacen-label",children:"Almac\xe9n"}),Object(B.jsx)(mt.a,{labelId:"almacen-label",id:"almacen",value:c?c.nombre_almacen:"",onChange:function(e){try{r(e.target.value),console.log(e)}catch(t){}},input:Object(B.jsx)(Ya.a,{}),MenuProps:PO,children:e.obtenerAlmacenes.map((function(e){return Object(B.jsx)(Ot.a,{value:e,children:e.nombre_almacen},e._id)}))})]})}),e.medidasAlmacen.open?Object(B.jsx)(p.a,{height:"100%",mx:3,mt:2,children:Object(B.jsx)(zO,{producto:e.medidasAlmacen.producto,almacen:c})}):Object(B.jsx)("div",{})]})}var TO=Object(k.a)({root:{width:"100%"},container:{maxHeight:"76vh"}}),WO=function(e){var t=Object(l.useContext)(tO),a=t.dataExcel,n=t.setDataExcel,c=Object(l.useState)([]),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)([]),d=Object(g.a)(s,2),j=d[0],u=(d[1],Object(l.useState)({codigo_barras:e.producto.datos_generales.codigo_barras,nombre_comercial:e.producto.datos_generales.nombre_comercial,style:{font:{sz:"12"},alignment:{wrapText:!0,horizontal:"center",vertical:"top"},border:{bottom:{style:"thin",color:{rgb:"000000"}}}}})),p=Object(g.a)(u,2),m=p[0],O=p[1],x=Object(l.useState)(0),h=Object(g.a)(x,2),f=h[0],v=h[1],C=Object(l.useState)(""),y=Object(g.a)(C,2),S=y[0],F=y[1];return Object(l.useEffect)((function(){var t=0,n=m,c=a;e.obtenerAlmacenes.forEach((function(a){var c=e.producto.existencia_almacenes.filter((function(e){return e._id.almacen._id===a._id}));c.length>0?(j.push(c[0].cantidad_existente),F(null!==c[0].unidad_inventario?c[0].unidad_inventario:"pz"),n=Object(b.a)(Object(b.a)({},n),{},Object(_.a)({},a._id,c[0].cantidad_existente+" "+S)),t+=c[0].cantidad_existente):(j.push(0),n=Object(b.a)(Object(b.a)({},n),{},Object(_.a)({},a._id,0)))})),n=Object(b.a)(Object(b.a)({},n),{},{total:t+" "+S}),v(t),O(n),c.push(n),e.index===e.productosLength-1&&o(c)}),[]),Object(l.useEffect)((function(){i&&n(i)}),[i]),Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",tabIndex:-1,onClick:function(){return e.toShowMedidasAlmacen(e.producto)},children:[Object(B.jsx)(Oa.a,{style:{minWidth:60},children:e.producto.datos_generales.codigo_barras}),Object(B.jsx)(Oa.a,{style:{minWidth:170},children:e.producto.datos_generales.nombre_comercial}),Object(B.jsxs)(Oa.a,{style:{textAlign:"center",minWidth:60},children:["$",parseFloat(e.producto.precios.precio_de_compra.precio_con_impuesto).toFixed(2)]}),Object(B.jsxs)(Oa.a,{style:{textAlign:"center",minWidth:80},children:["$",parseFloat(e.producto.precios.precio_de_compra.precio_con_impuesto*f).toFixed(2)]}),j.map((function(e,t){return Object(B.jsx)(Oa.a,{style:{backgroundColor:"rgba(255, 253, 150, 0.1)",color:"black",fontSize:17,textAlign:"center",minWidth:60},children:e+" "+S},t)})),Object(B.jsx)(Oa.a,{style:{backgroundColor:"rgba(255, 253, 150, 0.1)",color:"black",fontSize:18,fontWeight:"bold",textAlign:"center",minWidth:60},children:f+" "+S})]},e.producto._id)};function $O(e){var t=TO(),a=Object(l.useState)({open:!1,producto:{}}),n=Object(g.a)(a,2),c=n[0],r=n[1],i=function(e){try{"OTROS"!==e.datos_generales.tipo_producto&&r({open:!0,producto:e})}catch(t){console.log(t)}};return Object(B.jsxs)("div",{children:[Object(B.jsx)(Ka.a,{className:t.root,children:Object(B.jsx)(ba.a,{className:t.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:e.columns.map((function(e,t){return Object(B.jsx)(Oa.a,{align:e.align,style:{textAlign:t>1?"center":"left",minWidth:e.minWidth,width:e.minWidth},children:e.label},e.id)}))})}),Object(B.jsx)(xa.a,{children:e.productos.map((function(t,a){var n=a;return Object(B.jsx)(WO,{producto:t,index:n,productosLength:e.productos.length,dataExcel:e.dataExcel,setDataExcel:e.setDataExcel,obtenerAlmacenes:e.obtenerAlmacenes,toShowMedidasAlmacen:i},a)}))})]})})}),Object(B.jsx)(AO,{medidasAlmacen:c,setMedidasAlmacen:r,obtenerAlmacenes:e.obtenerAlmacenes})]})}var RO=a(473),VO=a.n(RO),MO=a(152),LO=a.n(MO),UO=a(137),BO=a.n(UO),qO=a(45),JO=a.n(qO);var GO=Object(h.f)((function(e){return Object(B.jsx)(l.Fragment,{children:Object(B.jsx)($e.a,{children:Object(B.jsx)($e.a,{item:!0,children:Object(B.jsx)(LO.a,{element:Object(B.jsx)(w.a,{variant:"contained",color:"primary",startIcon:Object(B.jsx)(VO.a,{}),children:"Exportar a Excel"}),filename:e.fileName,children:Object(B.jsx)(BO.a,{data:e.data,name:e.fileName,children:e.columnName.map((function(e){return Object(B.jsx)(JO.a,{label:e.label,value:e.id},e.id)}))})})})})})})),HO=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},boxControl:{margin:e.spacing(2.5),marginTop:0,minWidth:"20%",maxWidth:"20%"},icon:{fontSize:100},imagen:{width:100},inputBox:{margin:20},button:{margin:e.spacing(3)}}})),YO=Object(l.forwardRef)((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function KO(e){var t=HO(),a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1];return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){r(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/conceptosAlmacen.svg",alt:"icono almacen",className:t.imagen})}),"Inventario por almacen"]})}),Object(B.jsx)(QO,{open:c,productosAlmacenQuery:e.productosAlmacenQuery,handleClose:function(){r(!1)}})]})}var QO=function(e){var t=HO(),a=Object(l.useState)(!0),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(""),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useContext)(tO),u=j.dataExcel,b=j.setDataExcel,m=Object(l.useState)([]),O=Object(g.a)(m,2),x=O[0],h=O[1],_=Object(l.useState)([]),f=Object(g.a)(_,2),v=f[0],C=f[1],y=Object(_c.a)(s,700),F=Object(g.a)(y,1)[0],k=JSON.parse(localStorage.getItem("sesionCafi")),z=Object(l.useState)([]),N=Object(g.a)(z,2),P=N[0],D=N[1],E=Object(qe.a)(Ar,{variables:{empresa:k.empresa._id,sucursal:k.sucursal._id},fetchPolicy:"network-only"}),A=Object(qe.a)(Nr,{variables:{id:k.sucursal._id},fetchPolicy:"network-only"});return Object(l.useEffect)((function(){A.refetch()}),[A.update,A]),Object(l.useEffect)((function(){try{e.open&&(b([]),A.refetch(),e.productosAlmacenQuery.refetch({empresa:k.empresa._id,sucursal:k.sucursal._id,filtro:F}))}catch(t){console.log(t)}}),[e.open]),Object(l.useEffect)((function(){try{e.productosAlmacenQuery.data&&(h(e.productosAlmacenQuery.data.obtenerProductosAlmacenes),r(!1))}catch(t){}}),[e.productosAlmacenQuery.data]),Object(l.useEffect)((function(){if(A.data){var e=[{id:"codigo_barras",label:"C\xf3digo de barras",minWidth:60,widthPx:160},{id:"nombre_comercial",label:"Nombre comercial",minWidth:170,widthPx:160},{id:"costo_producto",label:"Costo producto",minWidth:60,widthPx:100},{id:"costo_total_productos",label:"Costo total productos",minWidth:60,widthPx:100}],t=A.data.obtenerAlmacenes;t.forEach((function(t){e.push({id:t._id,label:t.nombre_almacen,minWidth:60,widthPx:160})})),e.push({id:"total",label:"Total existencias",minWidth:60,widthPx:160}),C(t),D(e)}}),[A.data]),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:e.open,onClose:e.handleClose,TransitionComponent:YO,children:[Object(B.jsx)(Ie.a,{className:t.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:t.title,children:"Inventario por almac\xe9n"}),Object(B.jsx)(p.a,{mx:3,children:Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){r(!0),e.handleClose()},size:"large",children:Object(B.jsx)(Pt.a,{style:{fontSize:30}})})})}),Object(B.jsx)(X.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"})]})}),Object(B.jsxs)(p.a,{mt:2,children:[Object(B.jsx)(p.a,{ml:4,children:Object(B.jsx)(S.a,{className:t.subtitle,children:Object(B.jsx)("b",{children:"Buscar producto"})})}),Object(B.jsxs)(p.a,{ml:4,display:"flex",children:[Object(B.jsx)(p.a,{style:{width:"35%"},children:Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsx)(K.a,{id:"search-producto",type:"text",value:s,onChange:function(e){return d(e.target.value)},endAdornment:Object(B.jsx)(Q.a,{position:"start",children:Object(B.jsx)(X.a,{type:"submit","aria-label":"search producto",edge:"end",children:Object(B.jsx)(sc.a,{})})})})})}),x.length>0?Object(B.jsx)(p.a,{ml:4,mrstyle:{backgroundColor:"red",alignContent:"flex-end"},justifyContent:"flex-end",alignItems:"center",children:Object(B.jsx)(p.a,{children:Object(B.jsx)(GO,{fileName:"Inventarios almacen",data:u,columnName:P})})}):Object(B.jsx)("div",{})]})]}),c&&0===x.length?Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})}):e.productosAlmacenQuery.error||E.error?Object(B.jsx)(Ze,{error:e.productosAlmacenQuery.error}):Object(B.jsx)(p.a,{mx:5,mt:1,children:Object(B.jsx)($O,{productos:x,obtenerAlmacenes:v,columns:P})})]})};function XO(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(qe.a)(Er,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,filtro:""},fetchPolicy:"network-only"});return Object(B.jsx)(y.a,{children:Object(B.jsxs)($e.a,{container:!0,spacing:3,justifyContent:"center",alignItems:"center",children:[!1===e.accesos.almacenes.almacen.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Jm,{})})}),!1===e.accesos.almacenes.traspasos.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(aO,{children:Object(B.jsx)(IO,{refetch:t.refetch})})})}),!1===e.accesos.almacenes.inventario_almacen.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(aO,{children:Object(B.jsx)(KO,{productosAlmacenQuery:t})})})})]})})}var ZO=[{id:"fecha",label:"Fecha",minWidth:100},{id:"hora",label:"Hora",minWidth:100},{id:"movimiento",label:"Movimieto",minWidth:100},{id:"usuario",label:"Usuario",minWidth:100},{id:"hTurno",label:"Horario Turno",minWidth:100},{id:"concepto",label:"Concepto",minWidth:100}],ex=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"70%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function tx(e){var t=e.loading,a=e.historial,n=ex();return t?Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})}):Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Ka.a,{className:n.root,children:Object(B.jsx)(ba.a,{className:n.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:ZO.map((function(e){return Object(B.jsx)(Oa.a,{align:"center",style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(B.jsx)(xa.a,{children:a.map((function(e){return Object(B.jsx)(ax,{datos:e},e._id)}))})]})})})})})}function ax(e){var t=e.datos,a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=function(){return r(!c)},o=ex();return console.log(t),Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",onClick:i,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:ht()(t.fecha_movimiento.completa).format("YYYY-MM-DD")}),Object(B.jsx)(Oa.a,{align:"center",children:t.hora_moviento.completa}),Object(B.jsx)(Oa.a,{align:"center",children:t.tipo_movimiento}),Object(B.jsx)(Oa.a,{align:"center",children:t.nombre_usuario_creador}),Object(B.jsx)(Oa.a,{align:"center",children:t.horario_turno}),Object(B.jsx)(Oa.a,{align:"center",children:t.concepto})]}),Object(B.jsx)(Ee.a,{fullWidth:!0,maxWidth:"xs",open:c,onClose:i,children:Object(B.jsx)(Ae.a,{children:Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)($e.a,{item:!0,lg:12,xs:12,children:Object(B.jsx)(p.a,{textAlign:"center",p:2,children:Object(B.jsx)(S.a,{variant:"h6",children:"Informaci\xf3n de movimiento"})})}),Object(B.jsxs)($e.a,{item:!0,lg:12,xs:12,children:[Object(B.jsx)(p.a,{display:"flex",textAlign:"left",p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Fecha Movimiento: "})," ",ht()(t.fecha_movimiento.completa).format("YYYY-MM-DD")]})}),Object(B.jsx)(p.a,{display:"flex",textAlign:"left",p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Hora Movimiento: "})," ",t.hora_moviento.completa]})}),Object(B.jsx)(p.a,{display:"flex",textAlign:"left",p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Usuario: "})," ",t.nombre_usuario_creador]})}),Object(B.jsx)(p.a,{display:"flex",textAlign:"left",p:1,children:Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Horario en Turno: "})})}),Object(B.jsx)(p.a,{display:"flex",textAlign:"left",p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Tipo Movimiento: "})," ",t.tipo_movimiento]})}),Object(B.jsx)(p.a,{display:"flex",textAlign:"left",p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Concepto: "})," ",t.concepto]})}),Object(B.jsx)(p.a,{display:"flex",textAlign:"left",p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Caja: "})," ",t.numero_caja]})}),Object(B.jsx)(Ka.a,{className:o.root,children:Object(B.jsx)(ba.a,{className:o.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{align:"center",style:{minWidth:100},children:"Concepto"}),Object(B.jsx)(Oa.a,{align:"center",style:{minWidth:100},children:"Monto depositado"})]})}),Object(B.jsxs)(xa.a,{children:[Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)("b",{children:"Monto Total Efectivo:"})}),Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsxs)("b",{children:["$",t.montos_en_caja.monto_efectivo.monto]})})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:"Creditos"}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_creditos.monto]})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:"Tarjeta Debito"}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_debito.monto]})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:"Tarjeta Credito"}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_credito.monto]})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:"Monedero"}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_monedero.monto]})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:"Cheques"}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_cheques.monto]})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:"Transferencias"}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_transferencia.monto]})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:"Vales de despensa"}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_vales_despensa.monto]})]})]})]})})})]})]})})})]})}var nx=a(172),cx=a.n(nx),rx=Object(k.a)((function(e){return{title:{marginLeft:e.spacing(2),flex:1},appBar:{position:"relative"},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},icon:{fontSize:40,width:40},iconSave:{zIndex:10,position:"fixed",bottom:e.spacing(2),right:e.spacing(10)}}})),ix=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),ox=["TODOS","VENTA","DEPOSITO","RETIRO","TRANSFERENCIA"];function sx(e){var t=rx(),a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(l.useState)([]),c=Object(g.a)(n,2),r=c[0],i=c[1],o=Object(l.useState)([]),s=Object(g.a)(o,2),d=s[0],j=(s[1],Object(Da.useDebounce)(r,500)),u=Object(g.a)(j,1)[0],m=[],O=Object(qe.a)(Vd,{variables:{id_Caja:e.cajaSelected._id,empresa:a.empresa._id,sucursal:a.sucursal._id,input:{tipo_movimiento:r.tipo_movimiento?r.tipo_movimiento:"",fecha_incio:r.fecha_incio?r.fecha_incio:"",fecha_fin:r.fecha_fin?r.fecha_fin:"",usuario:u.usuario?u.usuario:""}}}),x=O.data,h=O.refetch,f=O.loading;Object(l.useEffect)((function(){h()}),[h]);var v=[];x&&function(e){d.splice(0,d.length);for(var t=0;t<e.length;t++)v={fecha:e[t].fecha_movimiento.completa,hora_movimiento:e[t].hora_moviento.completa,nombre:e[t].nombre_usuario_creador,horario_turno:e[t].horario_turno,tipo_movimiento:e[t].tipo_movimiento,concepto:e[t].concepto,caja:e[t].numero_caja,monto_efectivo:e[t].montos_en_caja.monto_efectivo.monto,monto_creditos:e[t].montos_en_caja.monto_creditos.monto,monto_tarjeta_debito:e[t].montos_en_caja.monto_tarjeta_debito.monto,monto_tarjeta_credito:e[t].montos_en_caja.monto_tarjeta_credito.monto,monto_monedero:e[t].montos_en_caja.monto_monedero.monto,monto_cheques:e[t].montos_en_caja.monto_cheques.monto,monto_transferencia:e[t].montos_en_caja.monto_transferencia.monto,monto_vales_despensa:e[t].montos_en_caja.monto_vales_despensa.monto},d.push(v)}(m=x.obtenerHistorialCaja);var C=function(e){i(Object(b.a)(Object(b.a)({},r),{},Object(_.a)({},e.target.name,e.target.value)))};return Object(B.jsxs)(Ee.a,{fullScreen:!0,open:e.open,onClose:function(){e.handleClose()},TransitionComponent:ix,children:[Object(B.jsx)(Ie.a,{className:t.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsxs)(S.a,{variant:"h5",className:t.title,children:["Caja ",e.cajaSelected.numero_caja]}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){e.handleClose()},size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)(LO.a,{element:Object(B.jsxs)(w.a,{variant:"contained",color:"primary","aria-label":"Guardar",className:t.iconSave,children:[Object(B.jsx)(cx.a,{className:t.margin}),"Exportar"]}),filename:"Reporte de Historial de Caja ".concat(e.cajaSelected.numero_caja),children:Object(B.jsxs)(BO.a,{data:d,name:"Reporte de Historial de Caja ".concat(e.cajaSelected.numero_caja),children:[Object(B.jsx)(JO.a,{label:"Usuario",value:"nombre"}),Object(B.jsx)(JO.a,{label:"Fecha Movimiento",value:"fecha"}),Object(B.jsx)(JO.a,{label:"Hora Movimiento",value:"hora_movimiento"}),Object(B.jsx)(JO.a,{label:"Horario en Turno",value:"horario_turno"}),Object(B.jsx)(JO.a,{label:"Concepto",value:"concepto"}),Object(B.jsx)(JO.a,{label:"Tipo Movimiento",value:"tipo_movimiento"}),Object(B.jsx)(JO.a,{label:"No. de Caja",value:"caja"}),Object(B.jsx)(JO.a,{label:"M. en Efectivo",value:"monto_efectivo"}),Object(B.jsx)(JO.a,{label:"M. en Creditos",value:"monto_creditos"}),Object(B.jsx)(JO.a,{label:"M. en Tarjeta Debito",value:"monto_tarjeta_debito"}),Object(B.jsx)(JO.a,{label:"M. en Tarjeta Credito",value:"monto_tarjeta_credito"}),Object(B.jsx)(JO.a,{label:"M. en monedero",value:"monto_monedero"}),Object(B.jsx)(JO.a,{label:"M. en Cheques",value:"monto_cheques"}),Object(B.jsx)(JO.a,{label:"M. en Transferencia",value:"monto_transferencia"}),Object(B.jsx)(JO.a,{label:"M. en Vale Despensa",value:"monto_vales_despensa"})]})}),Object(B.jsx)($e.a,{item:!0,lg:12,md:12,xs:12,children:Object(B.jsxs)("div",{className:t.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Movimiento"}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsxs)(mt.a,{id:"form-producto-tipo",name:"tipo_movimiento",onChange:C,value:r.tipo_movimiento?r.tipo_movimiento:"",children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),ox.map((function(e,t){return Object(B.jsx)(Ot.a,{value:e,children:e},t)}))]})})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Fecha inicio:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fecha_incio",variant:"outlined",type:"date",value:r.fecha_incio?r.fecha_incio:"",onChange:C})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Fecha fin:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fecha_fin",variant:"outlined",type:"date",value:r.fecha_fin?r.fecha_fin:"",onChange:C})]}),Object(B.jsx)("form",{onSubmit:function(e){e.preventDefault(),h()},style:{display:"flex",alignItems:"center",width:"100%"},children:Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Usuario:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"usuario",variant:"outlined",value:r.usuario?r.usuario:"",onChange:C})]})}),Object(B.jsx)(p.a,{width:"70%",display:"flex",justifyContent:"center",justifyItems:"center",alignItems:"center",children:Object(B.jsx)(p.a,{mt:2,children:Object(B.jsx)(w.a,{color:"primary",size:"large",variant:"contained",onClick:function(){i([])},children:"Limpiar"})})})]})}),Object(B.jsx)($e.a,{item:!0,lg:12,md:12,xs:12,children:Object(B.jsx)(tx,{loading:f,historial:m})})]})]})}var lx=a(15),dx=a(935),jx=a(261),ux=Object(lx.a)((function(e){return{badge:{color:function(e){return e.props.color},background:function(e){return e.props.color},boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(nc.a),bx=Object(k.a)((function(e){return{root:{minWidth:230,maxWidth:230,margin:5},media:{height:0,paddingTop:"56.25%"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{color:jx.a[500]},textActive:{position:"relative",bottom:8}}}));function px(e){var t={color:e.activa?"#44b700":"red"},a=bx();return Object(B.jsx)("div",{children:Object(B.jsxs)(Yb.a,{className:a.root,children:[Object(B.jsx)(dx.a,{color:"secondary",avatar:Object(B.jsx)(ux,{overlap:"circle",props:t,anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",badgeContent:"",children:Object(B.jsx)(Re.a,{alt:"Cajero X",src:"/static/images/avatar/1.jpg"})})}),Object(B.jsx)(p.a,{m:1,mb:2,children:Object(B.jsxs)(S.a,{variant:"h4",color:"textSecondary",component:"p",children:["Caja ",e.name]})})]})})}var mx=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),Ox=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function xx(){var e,t=mx(),a=d.a.useState(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=d.a.useState(!1),o=Object(g.a)(i,2),s=o[0],j=o[1],u=d.a.useState(!1),b=Object(g.a)(u,2),m=b[0],O=b[1],x=Object(l.useState)({message:"",status:"",open:!1}),h=Object(g.a)(x,2),_=h[0],f=h[1],v=d.a.useState({name:""}),C=Object(g.a)(v,2),y=C[0],F=C[1],I=JSON.parse(localStorage.getItem("sesionCafi")),k=[],z=Object(qe.a)($d,{variables:{empresa:I.empresa._id,sucursal:I.sucursal._id}}),N=z.data,P=z.refetch;Object(l.useEffect)((function(){r(!0),P(),r(!1)}),[P]),N&&(k=N.obtenerCajasSucursal);var D=function(){O(!0)},E=function(){j(!1)};return Object(B.jsxs)("div",{children:[Object(B.jsx)(J,{alert:_,setAlert:f}),Object(B.jsx)(He,{loading:c,setLoading:r}),Object(B.jsx)(w.a,{fullWidth:!0,onClick:function(){j(!0)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/cajas.svg",alt:"icono numero calzado",className:t.icon})}),"Historial de Cajas"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:s,onClose:E,TransitionComponent:Ox,children:[Object(B.jsx)(Ie.a,{className:t.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:t.title,children:"Historial de Cajas"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:E,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsx)($e.a,{container:!0,spacing:1,justifyContent:"center",children:null===(e=k)||void 0===e?void 0:e.map((function(e,t){return Object(B.jsx)(w.a,{onClick:function(){D(),F(e)},children:Object(B.jsx)(px,{name:e.numero_caja,activa:e.activa,cantidad_efectivo_actual:e.cantidad_efectivo_actual})},t)}))})]}),Object(B.jsx)(sx,{open:m,fetchCajas:P,handleClickOpen:D,cajaSelected:y,handleClose:function(){O(!1)},obtenerCajasSucursal:k})]})}var hx,_x,fx=a(496),gx=[{id:"fecha",label:"Fecha",minWidth:100},{id:"hora",label:"Hora",minWidth:100},{id:"usuario",label:"Usuario",minWidth:100},{id:"hTurno",label:"Horario Turno",minWidth:100},{id:"concepto",label:"Concepto",minWidth:100},{id:"caja",label:"Caja",minWidth:100}],vx=Object(k.a)((function(e){return{root:{width:"100%"},container:{maxHeight:500},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function Cx(e){var t=e.loading,a=e.turnos,n=vx();return t?Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})}):Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Ka.a,{className:n.root,children:Object(B.jsx)(ba.a,{className:n.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:gx.map((function(e){return Object(B.jsx)(Oa.a,{align:"center",style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(B.jsx)(xa.a,{children:a.map((function(e){return Object(B.jsx)(yx,{turno:e},e._id)}))})]})})})})})}function yx(e){var t=e.turno,a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=vx(),o=function(){return r(!c)};return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",onClick:o,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:t.fecha_movimiento}),Object(B.jsx)(Oa.a,{align:"center",children:"ABRIR TURNO"===t.concepto?Object(B.jsx)(B.Fragment,{children:t.hora_entrada.completa}):Object(B.jsx)(B.Fragment,{children:t.hora_salida.completa})}),Object(B.jsx)(Oa.a,{align:"center",children:t.usuario_en_turno.nombre}),Object(B.jsx)(Oa.a,{align:"center",children:t.horario_en_turno}),Object(B.jsx)(Oa.a,{align:"center",children:t.concepto}),Object(B.jsx)(Oa.a,{align:"center",children:t.numero_caja})]},t._id),Object(B.jsx)(Ee.a,{fullWidth:!0,maxWidth:"md",open:c,onClose:o,children:Object(B.jsx)(Ae.a,{children:Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)($e.a,{item:!0,lg:12,xs:12,children:Object(B.jsx)(p.a,{textAlign:"center",p:2,children:Object(B.jsx)(S.a,{variant:"h6",children:"Informaci\xf3n del turno"})})}),Object(B.jsxs)($e.a,{item:!0,lg:6,xs:12,children:[Object(B.jsx)(p.a,{p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Usuario"}),": ",t.usuario_en_turno.nombre]})}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Numero de caja"}),": ",t.numero_caja]})}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Moviento de turno"}),": ",t.concepto]})}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Horario de turno"}),": ",t.horario_en_turno]})}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsx)(S.a,{children:"ABRIR TURNO"===t.concepto?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("b",{children:"Hora de Entrada de turno: "}),t.hora_entrada.completa]}):Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("b",{children:"Hora de Salida de turno: "}),t.hora_salida.completa]})})}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Comentarios"}),": ",t.comentarios]})}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Fecha de movimiento"}),": ",t.fecha_movimiento]})})]}),Object(B.jsx)($e.a,{item:!0,lg:6,xs:12,children:Object(B.jsx)(Ka.a,{className:i.root,children:Object(B.jsx)(ba.a,{className:i.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{align:"center",style:{minWidth:100},children:"Concepto"}),Object(B.jsx)(Oa.a,{align:"center",style:{minWidth:100},children:"Monto depositado"})]})}),Object(B.jsxs)(xa.a,{children:[Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)("b",{children:"Monto Total Efectivo:"})}),Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsxs)("b",{children:["$",t.montos_en_caja.monto_efectivo.monto]})})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:"Creditos"}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_creditos.monto]})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:"Tarjeta Debito"}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_debito.monto]})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:"Tarjeta Credito"}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_credito.monto]})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:"Monedero"}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_monedero.monto]})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:"Cheques"}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_cheques.monto]})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:"Transferencias"}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_transferencia.monto]})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:"Vales de despensa"}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_vales_despensa.monto]})]})]})]})})})})]})})})]})}var Sx=Object(P.d)(hx||(hx=Object(N.a)(["\n\tmutation crearRegistroDeTurno( $input: AbrirCerrarTurnoInput, $activa: Boolean) {\n\t\tcrearRegistroDeTurno(input: $input, activa: $activa) {\n\t\t\thorario_en_turno\n\t\t\ttoken_turno_user\n\t\t\tconcepto\n\t\t\tnumero_caja\n\t\t\tid_caja\n\t\t\tcomentarios\n\t\t\thora_entrada {\n\t\t\t\thora\n\t\t\t\tminutos\n\t\t\t\tsegundos\n\t\t\t}\n\t\t\thora_salida{\n\t\t\t\thora\n\t\t\t\tminutos\n\t\t\t\tsegundos\n\t\t\t}\n\t\t\tfecha_entrada{\n\t\t\t\tyear\n\t\t\t\tmes\n\t\t\t\tdia\n\t\t\t\tno_semana_year\n\t\t\t\tno_dia_year\n\t\t\t}\n\t\t\tfecha_salida{\n\t\t\t\tyear\n\t\t\t\tmes\n\t\t\t\tdia\n\t\t\t\tno_semana_year\n\t\t\t\tno_dia_year\n\t\t\t}\n\t\t\tfecha_movimiento\n\t\t\tmontos_en_caja {\n\t\t\t\tmonto_efectivo{\n                    monto \n                }\n                monto_tarjeta_credito{\n                    monto \n                }\n                monto_tarjeta_debito{\n                    monto \n                }\n                monto_creditos{\n                    monto \n                }\n                monto_monedero{\n                    monto \n                }\n                monto_transferencia{\n                    monto \n                }\n                monto_cheques{\n                    monto \n                }\n                monto_vales_despensa{\n                    monto \n                }\n\t\t\t}\n\t\t\tusuario_en_turno {\n\t\t\t\tnumero_usuario\n\t\t\t\tnombre\n\t\t\t}\n\t\t\tempresa\n\t\t\tsucursal\n\t\t}\n\t}\n"]))),Fx=Object(P.d)(_x||(_x=Object(N.a)(["\n\tquery obtenerFiltroTurnos($input: HistorialTurnosInput, $empresa: ID!, $sucursal: ID!) {\n\t\tobtenerFiltroTurnos(input: $input, empresa: $empresa, sucursal: $sucursal) {\n\t\t\thorario_en_turno\n\t\t\tconcepto\n\t\t\tnumero_caja\n\t\t\tid_caja\n\t\t\tcomentarios\n\t\t\thora_entrada {\n\t\t\t\thora\n\t\t\t\tminutos\n\t\t\t\tsegundos\n\t\t\t\tcompleta\n\t\t\t}\n\t\t\thora_salida{\n\t\t\t\thora\n\t\t\t\tminutos\n\t\t\t\tsegundos\n\t\t\t\tcompleta\n\t\t\t}\n\t\t\tfecha_entrada{\n\t\t\t\tyear\n\t\t\t\tmes\n\t\t\t\tdia\n\t\t\t\tno_semana_year\n\t\t\t\tno_dia_year\n\t\t\t\tcompleta\n\t\t\t}\n\t\t\tfecha_salida{\n\t\t\t\tyear\n\t\t\t\tmes\n\t\t\t\tdia\n\t\t\t\tno_semana_year\n\t\t\t\tno_dia_year\n\t\t\t\tcompleta\n\t\t\t}\n\t\t\tfecha_movimiento\n\t\t\tmontos_en_caja {\n\t\t\t\tmonto_efectivo{\n                    monto \n                }\n                monto_tarjeta_credito{\n                    monto \n                }\n                monto_tarjeta_debito{\n                    monto \n                }\n                monto_creditos{\n                    monto \n                }\n                monto_monedero{\n                    monto \n                }\n                monto_transferencia{\n                    monto \n                }\n                monto_cheques{\n                    monto \n                }\n                monto_vales_despensa{\n                    monto \n                }\n\t\t\t}\n\t\t\tusuario_en_turno {\n\t\t\t\tnumero_usuario\n\t\t\t\tnombre\n\t\t\t}\n\t\t\tempresa\n\t\t\tsucursal\n\t\t}\n\t}\n"])));ht.a.locale("es");var wx=ls.a.ExcelFile,Ix=ls.a.ExcelSheet,kx=ls.a.ExcelColumn,zx=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),Nx=Object(fx.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& .obligatorio":{color:"red"}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},margin:{margin:e.spacing(1)},iconSave:{zIndex:10,position:"fixed",bottom:e.spacing(2),right:e.spacing(10)}}}));function Px(){var e=Object(l.useState)(!1),t=Object(g.a)(e,2),a=t[0],n=t[1],c=function(){n(!a)},r=Nx();return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(w.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:c,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/shift.svg",alt:"icono caja",style:{width:100}})}),"Turnos de Usuarios"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:a,onClose:c,TransitionComponent:zx,children:[Object(B.jsx)(Ie.a,{className:r.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:r.title,children:"Reportes Turnos de Usuarios"}),Object(B.jsx)(p.a,{m:1,display:"flex",children:Object(B.jsx)(p.a,{p:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:c,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})})]})}),Object(B.jsx)(Ex,{})]})]})}var Dx,Ex=function(){var e,t,a=Nx(),n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(l.useState)([]),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)([]),d=Object(g.a)(s,2),j=d[0],u=(d[1],Object(_c.a)(i,500)),m=Object(g.a)(u,1)[0],O=[],x=Object(qe.a)($d,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id}}),h=Object(qe.a)(Fx,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id,input:{horario_en_turno:i.horario_turno?i.horario_turno:"",usuario_en_turno:m.usuario_en_turno?m.usuario_en_turno:"",numero_caja:i.numero_caja?i.numero_caja:"",fechaInicio:i.fechaInicio?i.fechaInicio:"",fechaFin:i.fechaFin?i.fechaFin:""}}}),f=h.loading,v=h.data,C=h.error,y=h.refetch;Object(l.useEffect)((function(){y()}),[y]);var I=function(e){o(Object(b.a)(Object(b.a)({},i),{},Object(_.a)({},e.target.name,e.target.value.toString())))},k=[];if(v&&!1===x.loading&&function(e){j.splice(0,j.length);for(var t=0;t<e.length;t++)k={fecha:e[t].fecha_movimiento,nombre:e[t].usuario_en_turno.nombre,numero_usuario:e[t].usuario_en_turno.numero_usuario,fecha_entrada:e[t].fecha_entrada.completa,fecha_salida:e[t].fecha_salida.completa,hora_entrada:e[t].hora_entrada.completa,hora_salida:e[t].hora_salida.completa,horario_en_turno:e[t].horario_en_turno,concepto:e[t].concepto,caja:e[t].numero_caja},j.push(k)}(O=v.obtenerFiltroTurnos),C)return Object(B.jsx)(Ze,{error:C});return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)(wx,{element:Object(B.jsxs)(w.a,{variant:"contained",color:"primary","aria-label":"Guardar",className:a.iconSave,children:[Object(B.jsx)(cx.a,{className:a.margin}),"Exportar"]}),filename:"Reporte de Turnos Usuarios",children:Object(B.jsxs)(Ix,{data:j,name:"Reporte de Turnos Usuarios",children:[Object(B.jsx)(kx,{label:"No. Usuario",value:"numero_usuario"}),Object(B.jsx)(kx,{label:"Usuario",value:"nombre"}),Object(B.jsx)(kx,{label:"Fecha Movimiento",value:"fecha"}),Object(B.jsx)(kx,{label:"Fecha Entrada",value:"fecha_entrada"}),Object(B.jsx)(kx,{label:"Fecha Salida",value:"fecha_salida"}),Object(B.jsx)(kx,{label:"Hora Entrada",value:"hora_entrada"}),Object(B.jsx)(kx,{label:"Hora Salida",value:"hora_salida"}),Object(B.jsx)(kx,{label:"Horario en Turno",value:"horario_en_turno"}),Object(B.jsx)(kx,{label:"Concepto",value:"concepto"}),Object(B.jsx)(kx,{label:"No. de Caja",value:"caja"})]})}),Object(B.jsx)($e.a,{item:!0,lg:12,children:Object(B.jsxs)("div",{className:a.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Fecha inicio:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fechaInicio",variant:"outlined",type:"date",onChange:I,value:i.fechaInicio?i.fechaInicio:""})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Fecha fin:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fechaFin",variant:"outlined",type:"date",onChange:I,value:i.fechaFin?i.fechaFin:""})]}),Object(B.jsx)("form",{onSubmit:function(e){e.preventDefault(),y()},style:{display:"flex",alignItems:"center",width:"100%"},children:Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Usuario:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"usuario_en_turno",value:i.usuario_en_turno?i.usuario_en_turno:"",variant:"outlined",onChange:I})]})}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Caja:"}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsxs)(mt.a,{id:"form-producto-tipo",name:"numero_caja",onChange:I,value:i.numero_caja?i.numero_caja:"",children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),null===(e=x.data)||void 0===e||null===(t=e.obtenerCajasSucursal)||void 0===t?void 0:t.map((function(e){return Object(B.jsxs)(Ot.a,{value:e.numero_caja,children:["Caja ",e.numero_caja]},e.numero_caja)}))]})})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Horario de Turno:"}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsxs)(mt.a,{id:"form-producto-tipo",name:"horario_turno",value:i.horario_turno?i.horario_turno:"",onChange:I,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),Object(B.jsx)(Ot.a,{value:"VESPERTINO",children:"Vespertino"}),Object(B.jsx)(Ot.a,{value:"MATUTINO",children:"Matutino"})]})})]}),Object(B.jsx)(p.a,{width:"70%",display:"flex",justifyContent:"center",justifyItems:"center",alignItems:"center",children:Object(B.jsx)(p.a,{mt:2,children:Object(B.jsx)(w.a,{color:"primary",size:"large",variant:"contained",onClick:function(){o([])},children:"Limpiar"})})})]})})]}),Object(B.jsx)($e.a,{item:!0,lg:12,children:Object(B.jsx)(Cx,{loading:f,turnos:O})})]})},Ax=[{label:"Nombre producto",minWidth:160},{label:"Fecha de Compra",minWidth:160},{label:"Almacen",minWidth:100},{label:"Proveedor",minWidth:100},{label:"M. pago",minWidth:90},{label:"F. pago",minWidth:100},{label:"Cantidad",minWidth:90},{label:"Descuento",minWidth:100},{label:"Subtotal",minWidth:90},{label:"Impuestos",minWidth:90},{label:"Total",minWidth:100}],Tx=Object(k.a)((function(e){return{container:{maxHeight:"70vh"}}}));function Wx(e){var t=e.data,a=Tx();return Object(B.jsx)(p.a,{my:2,children:Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{className:a.container,children:Object(B.jsxs)(_a.a,{size:"small",stickyHeader:!0,"aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:Ax.map((function(e,t){return Object(B.jsx)(Oa.a,{style:{minWidth:e.minWidth},children:e.label},t)}))})}),Object(B.jsx)(xa.a,{children:t.map((function(e,t){var a=vt.filter((function(t){return t.Value===e.forma_pago}))[0];return Object(B.jsxs)(ma.a,{role:"checkbox",tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:e.producto.datos_generales.nombre_comercial}),Object(B.jsx)(Oa.a,{children:Sa(e.fecha_registro)}),Object(B.jsx)(Oa.a,{children:e.almacen.nombre_almacen}),Object(B.jsx)(Oa.a,{children:e.proveedor.nombre_cliente}),Object(B.jsx)(Oa.a,{children:e.compra_credito?"Cr\xe9dito":"Contado"}),Object(B.jsx)(Oa.a,{children:"".concat(a.Value,"-").concat(a.Name)}),Object(B.jsx)(Oa.a,{children:"".concat(e.cantidad_total," - ").concat(e.unidad)}),Object(B.jsx)(Oa.a,{children:"%".concat(e.descuento_porcentaje," - $").concat(e.descuento_precio?Fa(e.descuento_precio):0)}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.subtotal)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.impuestos)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.total)]})]},t)}))})]})})})})}var $x=Object(P.d)(Dx||(Dx=Object(N.a)(["\n  query obtenerProductoMovimientos(\n    $empresa: ID!\n    $sucursal: ID\n    $input: ObteneReportesCompras\n  ) {\n    obtenerProductoMovimientos(\n      empresa: $empresa\n      sucursal: $sucursal\n      input: $input\n    ) {\n      _id\n      id_compra\n      id_traspaso\n      id_producto\n      id_proveedor\n      id_almacen\n      almacen {\n        id_almacen\n        nombre_almacen\n      }\n      proveedor {\n        _id\n        clave_cliente\n        numero_cliente\n        nombre_cliente\n      }\n      producto {\n        almacen_inicial {\n          almacen\n          cantidad\n          fecha_de_expiracion\n          id_almacen\n        }\n        datos_generales {\n          codigo_barras\n          clave_alterna\n          tipo_producto\n          nombre_comercial\n          nombre_generico\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          ieps\n          ieps_activo\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          granel\n          litros\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n            codigo_unidad\n          }\n          precio_de_compra {\n            precio_con_impuesto\n            precio_sin_impuesto\n            iva\n            ieps\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            unidad\n            codigo_unidad\n          }\n        }\n        unidades_de_venta {\n          cantidad\n          codigo_barras\n          id_producto\n          precio\n          unidad\n          unidad_principal\n          _id\n          precio_unidad {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n        }\n      }\n      concepto\n      cantidad\n      cantidad_regalo\n      unidad_regalo\n      cantidad_total\n      iva_total\n      ieps_total\n      costo\n      descuento_porcentaje\n      descuento_precio\n      compra_credito\n      forma_pago\n      impuestos\n      mantener_precio\n      subtotal\n      total\n      medida {\n        id_medida\n        medida\n        tipo\n      }\n      color {\n        id_color\n        color\n        hex\n      }\n      unidad\n      id_unidad_venta\n      empresa\n      sucursal\n      usuario\n      year_registro\n      numero_semana_year\n      numero_mes_year\n      fecha_registro\n    }\n  }\n"]))),Rx=a(936),Vx=a(173),Mx=ls.a.ExcelFile,Lx=ls.a.ExcelFile.ExcelSheet,Ux=ls.a.ExcelFile.ExcelColumn;function Bx(e){var t=e.data.map((function(e){var t=e.producto,a=e.fecha_registro,n=e.almacen,c=e.proveedor,r=e.color,i=e.medida,o=e.cantidad,s=e.unidad,l=e.unidad_regalo,d=e.cantidad_regalo,j=e.cantidad_total,u=e.compra_credito,b=e.costo,p=e.descuento_porcentaje,m=e.descuento_precio,O=(e.iva_precio,e.ieps_precio),x=e.subtotal,h=e.impuestos,_=e.total,f=vt.filter((function(t){return t.Value===e.forma_pago}))[0];return{producto:t.datos_generales.nombre_comercial,fecha_registro:Sa(a),almacen:n.nombre_almacen,proveedor:c.nombre_cliente,color:r?r.color:"N/A",medida:i?"".concat(i.medida,"/").concat(i.tipo):"N/A",cantidad:o,unidad:s,unidad_regalo:l,cantidad_regalo:d,cantidad_total:j,compra_credito:!0===u?"Credito":"Contado",forma_pago:"".concat(f.Value," - ").concat(f.Name),costo:"$".concat(b?Fa(b):0),descuento_porcentaje:"%".concat(p),descuento_precio:"$".concat(m?Fa(m):0),iva_precio:"$".concat(O?Fa(O):0),subtotal:"$".concat(x?Fa(x):0),impuestos:"$".concat(h?Fa(h):0),total:"$".concat(_?Fa(_):0)}}));return Object(B.jsx)(Mx,{element:Object(B.jsx)(w.a,{color:"primary",startIcon:Object(B.jsx)(Vx.a,{}),children:"Exportar a Excel"}),filename:"Reporte de compras",children:Object(B.jsxs)(Lx,{data:t,name:"Reporte de compras",children:[Object(B.jsx)(Ux,{label:"Producto",value:"producto"}),Object(B.jsx)(Ux,{label:"Fecha de compra",value:"fecha_registro"}),Object(B.jsx)(Ux,{label:"Almacen",value:"almacen"}),Object(B.jsx)(Ux,{label:"Proveedor",value:"proveedor"}),Object(B.jsx)(Ux,{label:"Color",value:"color"}),Object(B.jsx)(Ux,{label:"Medida",value:"medida"}),Object(B.jsx)(Ux,{label:"Cantidad",value:"cantidad"}),Object(B.jsx)(Ux,{label:"Unidad",value:"unidad"}),Object(B.jsx)(Ux,{label:"Unidad de Regalo",value:"unidad_regalo"}),Object(B.jsx)(Ux,{label:"Cantidad de Regalo",value:"cantidad_regalo"}),Object(B.jsx)(Ux,{label:"Cantidad Total",value:"cantidad_total"}),Object(B.jsx)(Ux,{label:"Metodo de Pago",value:"compra_credito"}),Object(B.jsx)(Ux,{label:"Forma de pago",value:"forma_pago"}),Object(B.jsx)(Ux,{label:"Costo",value:"costo"}),Object(B.jsx)(Ux,{label:"Descuento en Porcentaje",value:"descuento_porcentaje"}),Object(B.jsx)(Ux,{label:"Descuento en Cantidad",value:"descuento_precio"}),Object(B.jsx)(Ux,{label:"IVA",value:"iva_precio"}),Object(B.jsx)(Ux,{label:"IEPS",value:"ieps_precio"}),Object(B.jsx)(Ux,{label:"Subtotal",value:"subtotal"}),Object(B.jsx)(Ux,{label:"Impuestos",value:"impuestos"}),Object(B.jsx)(Ux,{label:"Total",value:"total"})]})})}function qx(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(qe.a)($x,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,input:{fecha_inicio:"",fecha_fin:"",proveedor:"",metodo_pago:"",forma_pago:"",producto:""}},fetchPolicy:"network-only"}),a=t.loading,n=t.data,c=t.error,r=t.refetch;if(a)return Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:[Object(B.jsx)(I.a,{}),Object(B.jsx)(S.a,{variant:"h6",children:"Cargando..."})]});if(c)return Object(B.jsx)(Ze,{error:c});var i=n.obtenerProductoMovimientos;return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(Jx,{refetch:r,data:i}),Object(B.jsx)(Wx,{data:i})]})})}var Jx=function(e){var t=e.refetch,a=e.data,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(l.useState)({fecha_inicio:"",fecha_fin:"",proveedor:"",metodo_pago:"",forma_pago:"",producto:""}),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(Da.useDebounce)(i,800),d=Object(g.a)(s,1)[0],j=function(e){var t=e.target,a=t.name,n=t.value;o(Object(b.a)(Object(b.a)({},i),{},Object(_.a)({},a,n)))};Object(l.useEffect)((function(){u(d)}),[d]);var u=function(e){t({empresa:n.empresa._id,sucursal:n.sucursal._id,input:e})};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:2,children:[Object(B.jsx)(S.a,{children:"Fecha compra inicio:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fecha_inicio",variant:"outlined",type:"date",onChange:j,value:i.fecha_inicio})]}),Object(B.jsxs)($e.a,{item:!0,md:2,children:[Object(B.jsx)(S.a,{children:"Fecha compra fin:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fecha_fin",variant:"outlined",type:"date",onChange:j,value:i.fecha_fin})]}),Object(B.jsxs)($e.a,{item:!0,md:2,children:[Object(B.jsx)(S.a,{children:"Proveedor:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"proveedor",variant:"outlined",placeholder:"Nombre, Clave o numero",onChange:j,value:i.proveedor})]}),Object(B.jsxs)($e.a,{item:!0,md:2,children:[Object(B.jsx)(S.a,{children:"M\xe9todo de pago:"}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsxs)(mt.a,{name:"metodo_pago",onChange:j,value:i.metodo_pago,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Cualquier metodo"})}),Object(B.jsx)(Ot.a,{value:"CREDITO",children:"Cr\xe9dito"}),Object(B.jsx)(Ot.a,{value:"CONTADO",children:"Contado"})]})})]}),Object(B.jsxs)($e.a,{item:!0,md:2,children:[Object(B.jsx)(S.a,{children:"Forma de Pago:"}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsxs)(mt.a,{name:"forma_pago",onChange:j,value:i.forma_pago,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Cualquier forma"})}),vt.map((function(e,t){return Object(B.jsx)(Ot.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]})})]}),Object(B.jsxs)($e.a,{item:!0,md:2,children:[Object(B.jsx)(S.a,{children:"Producto:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"producto",variant:"outlined",placeholder:"Nombre, c\xf3digo, clave...",onChange:j,value:i.producto})]})]}),Object(B.jsxs)(p.a,{mt:1,display:"flex",children:[Object(B.jsx)(w.a,{color:"primary",startIcon:Object(B.jsx)(Rx.a,{}),onClick:function(){o({fecha_inicio:"",fecha_fin:"",proveedor:"",metodo_pago:"",forma_pago:"",producto:""})},children:"Limpiar filtros"}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(Bx,{data:a})]})]})},Gx=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),Hx=Object(fx.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}));function Yx(){var e=Hx(),t=Object(l.useState)(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!n)};return Object(B.jsxs)(p.a,{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:r,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Fe.l,{fontSize:100})}),"Reportes Compras"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Gx,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Reportes Compras"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsx)(qx,{})]})]})}var Kx=[{label:"Art\xedculo",minWidth:160},{label:"Fecha venta",minWidth:170},{label:"M. pago",minWidth:90},{label:"F. pago",minWidth:100},{label:"Cantidad",minWidth:90},{label:"Descuento",minWidth:100},{label:"Subtotal",minWidth:90},{label:"Impuestos",minWidth:90},{label:"Total",minWidth:100}],Qx=Object(k.a)((function(e){return{container:{maxHeight:"70vh"}}}));function Xx(e){var t=e.data,a=Qx();return Object(B.jsx)(p.a,{my:2,children:Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{className:a.container,children:Object(B.jsxs)(_a.a,{size:"small",stickyHeader:!0,"aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:Kx.map((function(e,t){return Object(B.jsx)(Oa.a,{style:{minWidth:e.minWidth},children:e.label},t)}))})}),Object(B.jsx)(xa.a,{children:t.map((function(e,t){var a="-";e.forma_pago&&(a=vt.filter((function(t){return t.Value===e.forma_pago}))[0]);return Object(B.jsxs)(ma.a,{role:"checkbox",tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:e.producto.datos_generales.nombre_comercial}),Object(B.jsx)(Oa.a,{children:Sa(e.fecha_registro)}),Object(B.jsx)(Oa.a,{children:e.venta_credito?"Cr\xe9dito":"Contado"}),Object(B.jsx)(Oa.a,{children:"".concat(a.Name)}),Object(B.jsx)(Oa.a,{children:"".concat(e.cantidad," - ").concat(e.unidad)}),Object(B.jsx)(Oa.a,{children:"%".concat(e.descuento_porcentaje?e.descuento_porcentaje:0," - $").concat(e.descuento_precio?Fa(e.descuento_precio):0)}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.subtotal)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.impuestos)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.total)]})]},t)}))})]})})})})}var Zx=ls.a.ExcelFile,eh=ls.a.ExcelFile.ExcelSheet,th=ls.a.ExcelFile.ExcelColumn;function ah(e){var t=e.data.map((function(e){var t=e.producto,a=e.fecha_registro,n=e.color,c=e.medida,r=e.cantidad,i=e.unidad,o=e.venta_credito,s=e.descuento_porcentaje,l=e.descuento_precio,d=e.iva_total,j=e.ieps_total,u=e.subtotal,b=e.impuestos,p=e.total,m="";e.forma_pago&&(m=vt.filter((function(t){return t.Value===e.forma_pago}))[0]);return{producto:t.datos_generales.nombre_comercial,fecha_registro:Sa(a),color:n?n.color:"N/A",medida:c?"".concat(c.medida,"/").concat(c.tipo):"N/A",cantidad:r,unidad:i,venta_credito:!0===o?"Credito":"Contado",forma_pago:"".concat(m.Value," - ").concat(m.Name),descuento_porcentaje:"%".concat(s||0),descuento_precio:"$".concat(l?Fa(l):0),iva_total:"$".concat(d?Fa(d):0),ieps_total:"$".concat(j?Fa(j):0),subtotal:"$".concat(u?Fa(u):0),impuestos:"$".concat(b?Fa(b):0),total:"$".concat(p?Fa(p):0)}}));return Object(B.jsx)(Zx,{element:Object(B.jsx)(w.a,{color:"primary",startIcon:Object(B.jsx)(Vx.a,{}),children:"Exportar a Excel"}),filename:"Reporte de compras",children:Object(B.jsxs)(eh,{data:t,name:"Reporte de compras",children:[Object(B.jsx)(th,{label:"Producto",value:"producto"}),Object(B.jsx)(th,{label:"Fecha de compra",value:"fecha_registro"}),Object(B.jsx)(th,{label:"Color",value:"color"}),Object(B.jsx)(th,{label:"Medida",value:"medida"}),Object(B.jsx)(th,{label:"Cantidad",value:"cantidad"}),Object(B.jsx)(th,{label:"Unidad",value:"unidad"}),Object(B.jsx)(th,{label:"Metodo de Pago",value:"venta_credito"}),Object(B.jsx)(th,{label:"Forma de pago",value:"forma_pago"}),Object(B.jsx)(th,{label:"Descuento en Porcentaje",value:"descuento_porcentaje"}),Object(B.jsx)(th,{label:"Descuento en Cantidad",value:"descuento_precio"}),Object(B.jsx)(th,{label:"IVA",value:"iva_precio"}),Object(B.jsx)(th,{label:"IEPS",value:"ieps_total"}),Object(B.jsx)(th,{label:"Subtotal",value:"subtotal"}),Object(B.jsx)(th,{label:"Impuestos",value:"impuestos"}),Object(B.jsx)(th,{label:"Total",value:"total"})]})})}function nh(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(qe.a)(Ip,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,filtros:{fecha_inicio:"",fecha_fin:"",metodo_pago:"",forma_pago:"",producto:""}},fetchPolicy:"network-only"}),a=t.loading,n=t.data,c=t.error,r=t.refetch;if(a)return Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:[Object(B.jsx)(I.a,{}),Object(B.jsx)(S.a,{variant:"h6",children:"Cargando..."})]});if(c)return console.log(c),Object(B.jsx)(Ze,{error:c});var i=n.obtenerVentasReportes;return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(ch,{refetch:r,data:i}),Object(B.jsx)(Xx,{data:i})]})})}var ch=function(e){var t=e.refetch,a=e.data,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(l.useState)({fecha_inicio:"",fecha_fin:"",metodo_pago:"",forma_pago:"",producto:""}),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(Da.useDebounce)(i,800),d=Object(g.a)(s,1)[0],j=function(e){var t=e.target,a=t.name,n=t.value;o(Object(b.a)(Object(b.a)({},i),{},Object(_.a)({},a,n)))};Object(l.useEffect)((function(){u(d)}),[d]);var u=function(e){t({empresa:n.empresa._id,sucursal:n.sucursal._id,filtros:e})};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:2,children:[Object(B.jsx)(S.a,{children:"Fecha venta inicio:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fecha_inicio",variant:"outlined",type:"date",onChange:j,value:i.fecha_inicio})]}),Object(B.jsxs)($e.a,{item:!0,md:2,children:[Object(B.jsx)(S.a,{children:"Fecha venta fin:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fecha_fin",variant:"outlined",type:"date",onChange:j,value:i.fecha_fin})]}),Object(B.jsxs)($e.a,{item:!0,md:2,children:[Object(B.jsx)(S.a,{children:"M\xe9todo de pago:"}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsxs)(mt.a,{name:"metodo_pago",onChange:j,value:i.metodo_pago,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Cualquier metodo"})}),Object(B.jsx)(Ot.a,{value:"CREDITO",children:"Cr\xe9dito"}),Object(B.jsx)(Ot.a,{value:"CONTADO",children:"Contado"})]})})]}),Object(B.jsxs)($e.a,{item:!0,md:2,children:[Object(B.jsx)(S.a,{children:"Forma de Pago:"}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsxs)(mt.a,{name:"forma_pago",onChange:j,value:i.forma_pago,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Cualquier forma"})}),vt.map((function(e,t){return Object(B.jsx)(Ot.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]})})]}),Object(B.jsxs)($e.a,{item:!0,md:4,children:[Object(B.jsx)(S.a,{children:"Producto:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"producto",variant:"outlined",placeholder:"Nombre, c\xf3digo, clave...",onChange:j,value:i.producto})]})]}),Object(B.jsxs)(p.a,{mt:1,display:"flex",children:[Object(B.jsx)(w.a,{color:"primary",startIcon:Object(B.jsx)(Rx.a,{}),onClick:function(){o({fecha_inicio:"",fecha_fin:"",metodo_pago:"",forma_pago:"",producto:""})},children:"Limpiar filtros"}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(ah,{data:a})]})]})},rh=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),ih=Object(fx.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}));function oh(){var e=ih(),t=Object(l.useState)(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=function(){c(!n)};return Object(B.jsxs)(p.a,{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:r,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cart-add.svg",alt:"icono ventas",style:{width:100}})}),"Reportes Ventas"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:rh,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Reportes Ventas"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsx)(nh,{})]})]})}var sh=ls.a.ExcelFile,lh=ls.a.ExcelFile.ExcelSheet,dh=ls.a.ExcelFile.ExcelColumn;function jh(e){var t=e.data.map((function(e){return{producto:e.producto.datos_generales.nombre_comercial,cantidad:e.cantidad,fecha:Sa(e.id_traspaso.fecha_registro),concepto:e.id_traspaso.concepto_traspaso.nombre_concepto,almacen_origen:null!==e.almacen_origen?e.almacen_origen.nombre_almacen:"",almacen_destino:null!==e.almacen_destino?e.almacen_destino.nombre_almacen:""}}));return Object(B.jsx)(sh,{element:Object(B.jsx)(w.a,{color:"primary",startIcon:Object(B.jsx)(Vx.a,{}),children:"Exportar a Excel"}),filename:"Reporte de traspasos",children:Object(B.jsxs)(lh,{data:t,name:"Reporte de traspasos",children:[Object(B.jsx)(dh,{label:"Producto",value:"producto"}),Object(B.jsx)(dh,{label:"Cantidad",value:"cantidad"}),Object(B.jsx)(dh,{label:"Fecha",value:"fecha"}),Object(B.jsx)(dh,{label:"Concepto",value:"concepto"}),Object(B.jsx)(dh,{label:"Almac\xe9n Origen",value:"almacen_origen"}),Object(B.jsx)(dh,{label:"Almac\xe9n Destino",value:"almacen_destino"})]})})}var uh=[{id:"producto",label:"Producto",minWidth:200},{id:"cantidad",label:"Cantidad",minWidth:50},{id:"fecha",label:"Fecha ",minWidth:50},{id:"concepto",label:"Concepto ",minWidth:100},{id:"almacen_origen",label:"Almac\xe9n Origen",minWidth:100},{id:"almacen_destino",label:"Almac\xe9n Destino",minWidth:100}],bh=Object(k.a)((function(e){return{root:{width:"100%"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function ph(e){var t=e.data,a=bh();return Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Ka.a,{className:a.root,children:Object(B.jsx)(ba.a,{className:a.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:uh.map((function(e){return Object(B.jsx)(Oa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(B.jsx)(xa.a,{children:t.map((function(e,t){return Object(B.jsxs)(ma.a,{role:"checkbox",tabIndex:-1,children:[Object(B.jsx)(Oa.a,{children:e.producto.datos_generales.nombre_comercial}),Object(B.jsx)(Oa.a,{children:e.cantidad}),Object(B.jsx)(Oa.a,{children:Sa(e.id_traspaso.fecha_registro)}),Object(B.jsx)(Oa.a,{children:e.id_traspaso.concepto_traspaso.nombre_concepto}),Object(B.jsx)(Oa.a,{children:null!==e.almacen_origen?e.almacen_origen.nombre_almacen:""}),Object(B.jsx)(Oa.a,{children:null!==e.almacen_destino?e.almacen_destino.nombre_almacen:""})]},t)}))})]})})})})}var mh=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),Oh=Object(fx.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& .obligatorio":{color:"red"}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},margin:{margin:e.spacing(1)},CircularProgress:{width:"100%",height:200,marginTop:100,display:"flex",justifyContent:"center"},iconSave:{zIndex:10,position:"fixed",bottom:e.spacing(2),right:e.spacing(10)}}}));function xh(){var e=Oh(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(null),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(null),u=Object(g.a)(j,2),m=u[0],O=u[1],x=Object(l.useState)(!1),h=Object(g.a)(x,2),f=h[0],v=h[1],C=Object(l.useState)({empresa:t.empresa._id,sucursal:t.sucursal._id,producto:"",fecha_inicio:"",fecha_final:"",usuario:""}),y=Object(g.a)(C,2),k=y[0],z=y[1],N=Object(l.useState)(""),P=Object(g.a)(N,2),D=P[0],A=P[1],T=Object(_c.a)(k,1e3),W=Object(g.a)(T,1)[0],$=[],R=[],V=[],M=Object(qe.a)(Nr,{variables:{id:t.sucursal._id},fetchPolicy:"network-only"}),L=Object(qe.a)(E,{variables:{sucursal:"".concat(t.sucursal._id)},fetchPolicy:"network-only"}),U=Object(qe.a)($r,{variables:{input:W},fetchPolicy:"network-only"}),q=function(){r(!c)};M.data&&($=M.data.obtenerAlmacenes);var J=function(e){var t,a=Object(b.a)(Object(b.a)({},k),{},(t={},Object(_.a)(t,e.target.name,e.target.value),Object(_.a)(t,"almacen_destino",m),Object(_.a)(t,"almacen_origen",s),t));z(a)};if(U.data)try{R=U.data.obtenerTraspasos}catch(G){}if(L.data)try{V=L.data.obtenerUsuarios}catch(G){}return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:q,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/almacen.svg",alt:"icono almacen",style:{width:100}})}),"Reportes Almacen"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:c,onClose:q,TransitionComponent:mh,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:e.title,children:"Reportes Almacen"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:q,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsxs)($e.a,{item:!0,lg:12,children:[Object(B.jsxs)("div",{className:e.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Fecha inicio:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fecha_inicio",variant:"outlined",value:k.fecha_inicio,type:"date",onChange:function(e){return J(e)}})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Fecha fin:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fecha_final",variant:"outlined",type:"date",onChange:function(e){return J(e)},value:k.fecha_final})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Encargado"}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(ja.a,{id:"encargado",size:"small",options:V,getOptionLabel:function(e){return e.nombre?"".concat(e.nombre):""},fullWidth:!0,renderInput:function(e){return Object(B.jsx)(F.a,Object(b.a)(Object(b.a)({},e),{},{variant:"outlined",InputProps:Object(b.a)(Object(b.a)({},e.InputProps),{},{endAdornment:Object(B.jsx)(l.Fragment,{children:e.InputProps.endAdornment})})}))},renderOption:function(e){return Object(B.jsx)(l.Fragment,{children:"".concat(e.nombre)})},onChange:function(e,t){return function(e){try{var t=null!==m?m._id:"",a=null!==s?s._id:"",n=""!==e?e._id:"",c=Object(b.a)(Object(b.a)({},k),{},{usuario:n,almacen_destino:t,almacen_origen:a});U.refetch({input:c}),A(e),v(!1)}catch(G){}}(t)},getOptionSelected:function(e,t){return e.nombre===t.nombre},value:D.nombre?D:null})})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Producto:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"producto",variant:"outlined",placeholder:"Nombre, c\xf3digo, clave...",onChange:function(e){return J(e)},value:k.producto})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Almacen origen:"}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsx)(mt.a,{id:"form-almacen-origen",name:"almacen_origen",onChange:function(e){return function(e){var t=null!==m?m._id:"";if(""!==e._id){v(!0);var a=Object(b.a)(Object(b.a)({},k),{},{almacen_origen:e._id,almacen_destino:t});U.refetch({input:a})}d(e),v(!1)}(e.target.value)},value:null!==s?s:"",children:$.map((function(e){return Object(B.jsx)(Ot.a,{value:e,children:e.nombre_almacen},e._id)}))})})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Almacen destino:"}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsx)(mt.a,{id:"form-almacen-destino",name:"almacen_destino",onChange:function(e){return function(e){var t=null!==s?s._id:"";if(""!==e._id){var a=Object(b.a)(Object(b.a)({},k),{},{almacen_origen:t,almacen_destino:e._id});v(!0),U.refetch({input:a})}O(e),v(!1)}(e.target.value)},value:null!==m?m:"",children:$.map((function(e){return Object(B.jsx)(Ot.a,{value:e,children:e.nombre_almacen},e._id)}))})})]})]}),Object(B.jsx)("div",{className:e.formInputFlex,children:Object(B.jsxs)(p.a,{mt:1,display:"flex",children:[Object(B.jsx)(w.a,{color:"primary",startIcon:Object(B.jsx)(Rx.a,{}),onClick:function(){return function(){try{var e={empresa:t.empresa._id,sucursal:t.sucursal._id,producto:"",fecha_inicio:"",fecha_final:"",usuario:""};z(e),v(!0),U.refetch({input:e}),A(""),d(null),O(null),v(!1)}catch(G){}}()},children:"Limpiar filtros"}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(jh,{data:R})]})})]}),U.loading||f?Object(B.jsx)("div",{className:e.CircularProgress,children:Object(B.jsx)(I.a,{})}):Object(B.jsx)($e.a,{item:!0,lg:12,children:Object(B.jsx)(ph,{data:R})})]})]})]})}var hh=[{label:"Fecha Corte",minWidth:100},{label:"Hora Corte",minWidth:100},{label:"Usuario",minWidth:100},{label:"Turno Horario",minWidth:100},{label:"Caja",minWidth:100},{label:"Sucursal",minWidth:100}],_h=Object(k.a)((function(e){return{root:{width:"100%"},container:{maxHeight:"70vh","& ::-webkit-scrollbar":{display:"none"}},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function fh(e){var t=e.loading,a=e.cortes,n=_h();return t?Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})}):Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Ka.a,{className:n.root,children:Object(B.jsx)(ba.a,{className:n.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:hh.map((function(e){return Object(B.jsx)(Oa.a,{align:"center",style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(B.jsx)(xa.a,{children:a.map((function(e){return Object(B.jsx)(gh,{corte:e},e._id)}))})]})})})})}function gh(e){var t=e.corte,a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=JSON.parse(localStorage.getItem("sesionCafi")),o=Object(Ds.a)(Bd,{variables:{sucursal:i.sucursal._id,empresa:i.empresa._id,input:{usuario:i._id,caja:t.id_caja,token_turno_user:t.token_turno_user,number_user:i.numero_usuario}},fetchPolicy:"network-only"}),s=Object(g.a)(o,2),d=s[0],j=s[1],u=j.data,b=(j.error,j.loading),m=[];u&&(m=u.obtenerCorteCaja.montos_en_sistema);var O=function(){r(!c),d()};return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",handleClickOpen:!0,onClick:O,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:t.fecha_salida.completa}),Object(B.jsx)(Oa.a,{align:"center",children:t.hora_salida.completa}),Object(B.jsx)(Oa.a,{align:"center",children:t.usuario_en_turno.nombre}),Object(B.jsx)(Oa.a,{align:"center",children:t.horario_en_turno}),Object(B.jsx)(Oa.a,{align:"center",children:t.numero_caja}),Object(B.jsx)(Oa.a,{align:"center",children:t.sucursal.nombre_sucursal})]},t._id),Object(B.jsxs)(Ee.a,{fullWidth:!0,maxWidth:"lg",open:c,onClose:O,children:[Object(B.jsx)(vh,{corte:t,montos_sistema:m,loading:b}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(p.a,{p:2,display:"flex",flexDirection:"row-reverse",children:Object(B.jsx)(w.a,{color:"primary",size:"large",variant:"contained",onClick:O,children:"Imprimir Ticket"})})})]})]})}function vh(e){var t=e.corte,a=e.montos_sistema,n=e.loading,c=_h();return n?Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(B.jsx)(I.a,{})}):Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)($e.a,{item:!0,lg:12,md:12,xs:12,children:[Object(B.jsx)(p.a,{p:1,textAlign:"center",children:Object(B.jsx)(S.a,{variant:"h5",children:Object(B.jsx)("b",{children:"Reporte de Corte de Caja"})})}),Object(B.jsx)(p.a,{p:1,textAlign:"center",children:Object(B.jsxs)(S.a,{variant:"h6",children:[Object(B.jsx)("b",{children:"Fecha y hora de Corte: "}),ht()(t.fecha_movimiento).format("Do MMMM YYYY, h:mm:ss")]})})]}),Object(B.jsx)($e.a,{item:!0,lg:12,md:12,xs:12,children:Object(B.jsxs)(p.a,{p:2,display:"flex",justifyContent:"center",children:[Object(B.jsx)(p.a,{p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Usuario: "})," ",t.usuario_en_turno.nombre]})}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"No. de usuario: "}),t.usuario_en_turno.numero_usuario]})}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Horario en turno: "}),t.horario_en_turno]})}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Numero de caja: "}),t.numero_caja]})}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Sucursal: "}),t.sucursal.nombre_sucursal]})})]})}),Object(B.jsx)($e.a,{children:Object(B.jsx)(Ka.a,{className:c.root,children:Object(B.jsx)(ba.a,{className:c.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{align:"center",children:"CONCEPTO"}),Object(B.jsx)(Oa.a,{align:"center",children:"CAJERO"}),Object(B.jsx)(Oa.a,{align:"center",children:"SISTEMA"}),Object(B.jsx)(Oa.a,{align:"center",children:"DIFERENCIA"})]})}),Object(B.jsxs)(xa.a,{children:[Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)("b",{children:"MONTO EFECTIVO"})}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_efectivo.monto]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",a.monto_efectivo]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_efectivo.monto-a.monto_efectivo]})]}),Object(B.jsxs)(xa.a,{children:[Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)("b",{children:"MONTO TARJETA DEBITO"})}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_debito.monto]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",a.monto_tarjeta_debito]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_debito.monto-a.monto_tarjeta_debito]})]}),Object(B.jsxs)(xa.a,{children:[Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)("b",{children:"MONTO TARJETA DE CREDITO"})}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_credito.monto]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",a.monto_tarjeta_credito]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_credito.monto-a.monto_tarjeta_credito]})]}),Object(B.jsxs)(xa.a,{children:[Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)("b",{children:"MONTO TRANSFERENCIAS"})}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_transferencia.monto]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",a.monto_transferencia]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_transferencia.monto-a.monto_transferencia]})]}),Object(B.jsxs)(xa.a,{children:[Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)("b",{children:"MONTO EN MONEDERO"})}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_monedero.monto]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",a.monto_monedero]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_monedero.monto-a.monto_monedero]})]}),Object(B.jsxs)(xa.a,{children:[Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)("b",{children:"MONTO EN CREDITOS"})}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_creditos.monto]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",a.monto_creditos]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_creditos.monto-a.monto_creditos]})]}),Object(B.jsxs)(xa.a,{children:[Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)("b",{children:"MONTO EN CHEQUES"})}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_cheques.monto]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",a.monto_cheques]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_cheques.monto-a.monto_cheques]})]}),Object(B.jsxs)(xa.a,{children:[Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)("b",{children:"MONTO EN VALE DE DESPENSA"})}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_vales_despensa.monto]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",a.monto_vales_despensa]}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.montos_en_caja.monto_vales_despensa.monto-a.monto_vales_despensa]})]})]})})})})]})}var Ch=Object(k.a)((function(e){return{icon:{fontSize:40,width:40},iconSave:{zIndex:10,position:"fixed",bottom:e.spacing(2),right:e.spacing(10)}}}));function yh(e){var t=e.historialCortes,a=Object(l.useState)([]),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Ch(),o=[];return Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(LO.a,{element:Object(B.jsxs)(w.a,{variant:"contained",color:"primary","aria-label":"Guardar",className:i.iconSave,onClick:function(){return function(){for(var e=0;e<t.length;e++)o={fecha:t[e].fecha_salida.completa,hora_movimiento:t[e].hora_salida.completa,horario_turno:t[e].horario_en_turno,sucursal:t[e].sucursal.nombre_sucursal,nombre:t[e].usuario_en_turno.nombre,numero_usuario:t[e].usuario_en_turno.numero_usuario,concepto:"Corte Caja",caja:t[e].numero_caja,monto_efectivo:t[e].montos_en_caja.monto_efectivo.monto,monto_creditos:t[e].montos_en_caja.monto_creditos.monto,monto_tarjeta_debito:t[e].montos_en_caja.monto_tarjeta_debito.monto,monto_tarjeta_credito:t[e].montos_en_caja.monto_tarjeta_credito.monto,monto_monedero:t[e].montos_en_caja.monto_monedero.monto,monto_cheques:t[e].montos_en_caja.monto_cheques.monto,monto_transferencia:t[e].montos_en_caja.monto_transferencia.monto,monto_vales_despensa:t[e].montos_en_caja.monto_vales_despensa.monto},r(o)}()},children:[Object(B.jsx)(cx.a,{className:i.margin}),"Exportar"]}),filename:"Reporte de Historial de Cortes",children:Object(B.jsxs)(BO.a,{data:c,name:"Reporte de Historial de Cortes",children:[Object(B.jsx)(JO.a,{label:"Usuario",value:"nombre"}),Object(B.jsx)(JO.a,{label:"No. Usuario",value:"numero_usuario"}),Object(B.jsx)(JO.a,{label:"Sucursal",value:"sucursal"}),Object(B.jsx)(JO.a,{label:"Fecha Corte",value:"fecha"}),Object(B.jsx)(JO.a,{label:"Hora Corte",value:"hora_movimiento"}),Object(B.jsx)(JO.a,{label:"Horario Turno",value:"horario_turno"}),Object(B.jsx)(JO.a,{label:"Concepto",value:"concepto"}),Object(B.jsx)(JO.a,{label:"No. de Caja",value:"caja"}),Object(B.jsx)(JO.a,{label:"M. en Efectivo",value:"monto_efectivo"}),Object(B.jsx)(JO.a,{label:"M. en Creditos",value:"monto_creditos"}),Object(B.jsx)(JO.a,{label:"M. en Tarjeta Debito",value:"monto_tarjeta_debito"}),Object(B.jsx)(JO.a,{label:"M. en Tarjeta Credito",value:"monto_tarjeta_credito"}),Object(B.jsx)(JO.a,{label:"M. en Monedero",value:"monto_monedero"}),Object(B.jsx)(JO.a,{label:"M. en Cheques",value:"monto_cheques"}),Object(B.jsx)(JO.a,{label:"M. en Transferencia",value:"monto_transferencia"}),Object(B.jsx)(JO.a,{label:"M. en Vale Despensa",value:"monto_vales_despensa"})]})})})}var Sh=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),Fh=Object(fx.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& .obligatorio":{color:"red"}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},margin:{margin:e.spacing(1)},iconSave:{zIndex:10,position:"fixed",bottom:e.spacing(2),right:e.spacing(10)}}}));function wh(){var e,t=JSON.parse(localStorage.getItem("sesionCafi")),a=Fh(),n=Object(l.useState)(!1),c=Object(g.a)(n,2),r=c[0],i=c[1],o=Object(l.useState)([]),s=Object(g.a)(o,2),d=s[0],j=s[1],u=Object(Da.useDebounce)(d,500),m=Object(g.a)(u,1)[0],O=[],x=[],h=Object(qe.a)($d,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id}}),f=Object(qe.a)(Ud,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id,input:{fecha_consulta:d.fecha_consulta?d.fecha_consulta:"",usuario:m.usuario?m.usuario:"",numero_caja:d.numero_caja?parseInt(d.numero_caja):null}}}),v=f.loading,C=f.data,y=(f.error,f.refetch);!1===h.loading&&!1===v&&(O=h.data.obtenerCajasSucursal,x=C.obtenerCortesDeCaja);var I=function(){i(!r)},k=function(e){j(Object(b.a)(Object(b.a)({},d),{},Object(_.a)({},e.target.name,e.target.value)))};return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(w.a,{fullWidth:!0,onClick:I,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cash-register.svg",alt:"icono caja",style:{width:100}})}),"Reportes Cortes de caja"]})}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:r,onClose:I,TransitionComponent:Sh,children:[Object(B.jsx)(Ie.a,{className:a.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(S.a,{variant:"h6",className:a.title,children:"Reportes Cortes de caja"}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:I,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)(yh,{historialCortes:x}),Object(B.jsx)($e.a,{item:!0,lg:12,md:12,xs:12,children:Object(B.jsxs)("div",{className:a.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Fecha de corte:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fecha_consulta",variant:"outlined",type:"date",onChange:k,value:d.fecha_consulta?d.fecha_consulta:""})]}),Object(B.jsx)("form",{onSubmit:function(e){e.preventDefault(),y()},style:{display:"flex",alignItems:"center",width:"100%"},children:Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Usuario:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"usuario",variant:"outlined",onChange:k,value:d.usuario?d.usuario:""})]})}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Caja:"}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsxs)(mt.a,{id:"form-producto-tipo",name:"numero_caja",onChange:k,value:d.numero_caja?d.numero_caja:"",children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),null===(e=O)||void 0===e?void 0:e.map((function(e){return Object(B.jsxs)(Ot.a,{value:e.numero_caja,children:["Caja ",e.numero_caja]},e.numero_caja)}))]})})]}),Object(B.jsx)(p.a,{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",mt:2,children:Object(B.jsx)(w.a,{color:"primary",size:"large",variant:"contained",onClick:function(){j([])},children:"Limpiar Filtro"})})]})}),Object(B.jsx)($e.a,{item:!0,lg:12,md:12,xs:12,children:Object(B.jsx)(fh,{cortes:x,loading:v})})]})]})]})}var Ih=a(488),kh=a(937),zh=[{id:"folio",label:"Folio",minWidth:170},{id:"nombre",label:"Usuario",minWidth:170},{id:"fecha",label:"Fecha",minWidth:170},{id:"folioF",label:"Folio Factura",minWidth:170},{id:"tipo",label:"Tipo Compra",minWidth:170}],Nh=Object(k.a)((function(e){return{root:{width:"100%",height:"70vh"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}}));function Ph(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Nh(),a=Object(l.useState)([]),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(Da.useDebounce)(c,500),o=Object(g.a)(i,1)[0],s=Object(qe.a)(Uu,{variables:{input:{fecha_inicio:c.fecha_inicio?c.fecha_inicio:"",fecha_fin:c.fecha_fin?c.fecha_fin:"",usuario:o.usuario?o.usuario:"",tipo_movimiento:c.tipo_movimiento?"CREDITO"===c.tipo_movimiento:null},empresa:e.empresa._id,sucursal:e.sucursal._id}}),d=s.loading,j=s.data,u=(s.error,s.refetch);Object(l.useEffect)((function(){u()}),[u]);var m=[];j&&(m=j.obtenerHistorialEgresos);var O=function(e){r(Object(b.a)(Object(b.a)({},c),{},Object(_.a)({},e.target.name,e.target.value)))};return Object(B.jsxs)($e.a,{children:[Object(B.jsx)($e.a,{item:!0,lg:12,md:12,xs:12,children:Object(B.jsxs)("div",{className:t.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Fecha Inicio:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fecha_inicio",variant:"outlined",type:"date",onChange:O,value:c.fecha_inicio?c.fecha_inicio:""})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Fecha Fin:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"fecha_fin",variant:"outlined",type:"date",onChange:O,value:c.fecha_fin?c.fecha_fin:""})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Usuario:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"usuario",variant:"outlined",onChange:O,value:c.usuario?c.usuario:""})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Tipo Egreso:"}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsxs)(mt.a,{id:"form-producto-tipo",name:"tipo_movimiento",onChange:O,children:[Object(B.jsx)(Ot.a,{value:"TODOS",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),Object(B.jsx)(Ot.a,{value:"CONTADO",children:"Egreso Contado"}),Object(B.jsx)(Ot.a,{value:"CREDITO",children:"Egreso Credito"})]})})]}),Object(B.jsx)(p.a,{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",mt:2,children:Object(B.jsx)(w.a,{color:"primary",size:"large",variant:"contained",onClick:function(){r([])},children:"Limpiar Filtro"})})]})}),Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(Ka.a,{className:t.root,children:Object(B.jsx)(ba.a,{className:t.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:zh.map((function(e){return Object(B.jsx)(Oa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(B.jsx)(xa.a,{children:m.map((function(e,t){return Object(B.jsx)(Eh,{row:e,loading:d},t)}))})]})})})})]})}var Dh=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Eh(e){var t=e.row,a=e.loading,n=Object(l.useState)(!1),c=Object(g.a)(n,2),r=c[0],i=c[1],o=function(){return i(!r)};return a?Object(B.jsx)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:Object(B.jsx)(I.a,{})}):Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(Ee.a,{open:r,TransitionComponent:Dh,fullWidth:!0,maxWidth:"md",children:[Object(B.jsx)(Ah,{row:t}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{variant:"outlined",color:"secondary",size:"large",onClick:o,children:"Cerrar"})})]}),Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,onClick:o,children:[Object(B.jsx)(Oa.a,{children:t.folio_egreso}),Object(B.jsx)(Oa.a,{children:t.nombre_usuario_creador}),Object(B.jsx)(Oa.a,{children:t.fecha_compra}),Object(B.jsx)(Oa.a,{children:t.folio_factura}),Object(B.jsx)(Oa.a,{children:!1===t.compra_credito?"Contado":"Credito"})]},t.code)]})}function Ah(e){var t=e.row;return Object(B.jsx)(l.Fragment,{children:Object(B.jsx)(Ae.a,{children:Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)($e.a,{item:!0,lg:12,xs:12,children:Object(B.jsx)(p.a,{textAlign:"center",p:2,children:Object(B.jsx)(S.a,{variant:"h6",children:"Informaci\xf3n de movimiento"})})}),Object(B.jsx)($e.a,{item:!0,lg:5,xs:12,children:Object(B.jsx)(p.a,{display:"flex",textAlign:"left",p:1,children:Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Fecha Compra: "})," ",ht()(t.fecha_compra).format("YYYY-MM-DD"),Object(B.jsx)("br",{}),Object(B.jsx)("b",{children:"Folio movimiento: "})," ",t.folio_egreso,Object(B.jsx)("br",{}),Object(B.jsx)("b",{children:"Usuario: "})," ",t.nombre_usuario_creador,Object(B.jsx)("br",{}),Object(B.jsx)("b",{children:"Categoria: "})," ",t.categoria,Object(B.jsx)("br",{}),Object(B.jsx)("b",{children:"Sub-Categoria: "})," ",t.subCategoria,Object(B.jsx)("br",{}),Object(B.jsx)("b",{children:"Folio Factura: "})," ",t.folio_factura,Object(B.jsx)("br",{}),Object(B.jsx)("b",{children:"Empresa: "})," ",t.empresa_distribuidora,Object(B.jsx)("br",{}),Object(B.jsx)("b",{children:"Provedor: "})," ",t.provedor,Object(B.jsx)("br",{}),Object(B.jsx)("b",{children:"Metodo de pago: "})," ",t.metodo_pago,Object(B.jsx)("br",{}),Object(B.jsx)("b",{children:"Compra credito: "})," ",!1===t.compra_credito?"NO":"Si",!1===t.compra_credito?null:Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("br",{}),Object(B.jsx)("b",{children:"Fecha Vencimiento: "})," ",t.fecha_vencimiento,Object(B.jsx)("br",{}),Object(B.jsx)("b",{children:"Saldo Pendiente: "})," ",t.saldo_credito_pendiente]})]})})}),Object(B.jsxs)($e.a,{item:!0,lg:7,xs:12,children:[Object(B.jsx)(p.a,{textAlign:"center",children:Object(B.jsx)(S.a,{children:"Productos Adquiridos"})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(Ka.a,{style:{width:"100%",height:"30vh"},children:Object(B.jsx)(ba.a,{style:{maxHeight:"100%"},children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{align:"center",style:{minWidth:100},children:"CANTIDAD"}),Object(B.jsx)(Oa.a,{align:"center",style:{minWidth:100},children:"PRODUCTO"}),Object(B.jsx)(Oa.a,{align:"center",style:{minWidth:100},children:"P. UNITARIO"}),Object(B.jsx)(Oa.a,{align:"center",style:{minWidth:100},children:"TOTAL"})]})}),Object(B.jsx)(xa.a,{children:null===t||void 0===t?void 0:t.productos.map((function(e,t){return Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:e.cantidad_productos}),Object(B.jsx)(Oa.a,{align:"center",children:e.producto}),Object(B.jsx)(Oa.a,{align:"center",children:e.precio_unitario}),Object(B.jsx)(Oa.a,{align:"center",children:e.total})]},t)}))})]})})})}),Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",p:1,children:Object(B.jsxs)(S.a,{variant:"h6",children:["Total: $",Fa(t.saldo_total)]})})]})]})})})}var Th=[{id:"name",label:"Name",minWidth:170},{id:"code",label:"ISO\xa0Code",minWidth:100},{id:"population",label:"Population",minWidth:170,align:"right",format:function(e){return e.toLocaleString("en-US")}},{id:"size",label:"Size\xa0(km\xb2)",minWidth:170,align:"right",format:function(e){return e.toLocaleString("en-US")}},{id:"density",label:"Density",minWidth:170,align:"right",format:function(e){return e.toFixed(2)}}];function Wh(e,t,a,n){return{name:e,code:t,population:a,size:n,density:a/n}}var $h=[Wh("India","IN",1324171354,3287263),Wh("China","CN",1403500365,9596961),Wh("Italy","IT",60483973,301340),Wh("United States","US",327167434,9833520),Wh("Canada","CA",37602103,9984670),Wh("Australia","AU",25475400,7692024),Wh("Germany","DE",83019200,357578),Wh("Ireland","IE",4857e3,70273),Wh("Mexico","MX",126577691,1972550),Wh("Japan","JP",126317e3,377973),Wh("France","FR",67022e3,640679),Wh("United Kingdom","GB",67545757,242495),Wh("Russia","RU",146793744,17098246),Wh("Nigeria","NG",200962417,923768),Wh("Brazil","BR",210147125,8515767)],Rh=Object(k.a)((function(e){return{root:{width:"100%"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function Vh(){var e=Rh(),t=Object(l.useState)(0),a=Object(g.a)(t,2),n=a[0],c=a[1],r=Object(l.useState)(14),i=Object(g.a)(r,2),o=i[0],s=i[1];return Object(B.jsxs)($e.a,{children:[Object(B.jsx)("div",{className:e.root,children:Object(B.jsx)(p.a,{m:2,display:"flex",justifyContent:"space-between",children:Object(B.jsx)(p.a,{mr:5,minWidth:"70%",children:Object(B.jsxs)(Ka.a,{className:e.rootBusqueda,children:[Object(B.jsx)(Zs.a,{fullWidth:!0,placeholder:"Buscar transferencias..."}),Object(B.jsx)(X.a,{children:Object(B.jsx)(sc.a,{})})]})})})}),Object(B.jsx)(p.a,{p:2,children:Object(B.jsxs)(Ka.a,{className:e.root,children:[Object(B.jsx)(ba.a,{className:e.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:Th.map((function(e){return Object(B.jsx)(Oa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(B.jsx)(xa.a,{children:$h.slice(n*o,n*o+o).map((function(e){return Object(B.jsx)(ma.a,{hover:!0,role:"checkbox",tabIndex:-1,children:Th.map((function(t){var a=e[t.id];return Object(B.jsx)(Oa.a,{align:t.align,children:t.format&&"number"===typeof a?t.format(a):a},t.id)}))},e.code)}))})]})}),Object(B.jsx)(Gu.a,{rowsPerPageOptions:[10,25,100],component:"div",count:$h.length,rowsPerPage:o,page:n,onChangePage:function(e,t){c(t)},onChangeRowsPerPage:function(e){s(+e.target.value),c(0)}})]})})]})}var Mh=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},root:{flexGrow:1,width:"100%",height:"100vh",backgroundColor:e.palette.background.paper},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}})),Lh=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Uh(){var e=Mh(),t=Object(l.useState)(""),a=Object(g.a)(t,2),n=a[0],c=a[1],r=Object(l.useState)(!1),i=Object(g.a)(r,2),o=i[0],s=i[1],d=function(){return s(!o)},j=Object(l.useState)(null),u=Object(g.a)(j,2),b=u[0],m=u[1];return Object(B.jsxs)("div",{children:[Object(B.jsx)(w.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){m(e.currentTarget)},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Fe.r,{style:{fontSize:100}})}),"Reportes Tesoreria"]})}),Object(B.jsxs)(Ih.a,{id:"customized-menu",anchorEl:b,keepMounted:!0,open:Boolean(b),onClose:function(){m(null)},children:[Object(B.jsxs)(Ot.a,{onClick:function(){d(),c("egresos")},children:[Object(B.jsx)(kh.a,{children:Object(B.jsx)(Fe.r,{style:{fontSize:35}})}),"Historial Egresos"]}),Object(B.jsxs)(Ot.a,{onClick:function(){d(),c("transferencias")},children:[Object(B.jsx)(kh.a,{children:Object(B.jsx)(Fe.r,{style:{fontSize:35}})}),"Historial Transferencias"]})]}),Object(B.jsxs)(Ee.a,{fullScreen:!0,open:o,onClose:d,TransitionComponent:Lh,children:[Object(B.jsx)(Ie.a,{className:e.appBar,children:Object(B.jsxs)(we.a,{children:[Object(B.jsxs)(S.a,{variant:"h6",className:e.title,children:["Histotorial de ",n]}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:d,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})})]})}),Object(B.jsx)(p.a,{children:"egresos"===n?Object(B.jsx)(Ph,{}):"transferencias"===n?Object(B.jsx)(Vh,{}):null})]})]})}function Bh(){var e=JSON.parse(localStorage.getItem("sesionCafi"));return Object(B.jsx)(y.a,{children:Object(B.jsxs)($e.a,{container:!0,spacing:3,justifyContent:"center",children:[!1===e.accesos.reportes.reporte_historial_cajas.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(xx,{})})}),!1===e.accesos.reportes.reporte_turnos.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Px,{})})}),!1===e.accesos.reportes.reporte_compras.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Yx,{})})}),!1===e.accesos.reportes.reporte_ventas.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(oh,{})})}),!1===e.accesos.reportes.rerporte_almacen.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(xh,{})})}),!1===e.accesos.reportes.reporte_corte_caja.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(wh,{})})}),!1===e.accesos.reportes.reporte_tesoreria.ver?null:Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Uh,{})})})]})})}var qh=["children","value","index"];function Jh(e){var t=e.children,a=e.value,n=e.index,c=Object(ve.a)(e,qh);return Object(B.jsx)("div",Object(b.a)(Object(b.a)({role:"tabpanel",hidden:a!==n,id:"scrollable-force-tabpanel-".concat(n),"aria-labelledby":"scrollable-force-tab-".concat(n)},c),{},{children:a===n&&Object(B.jsx)(p.a,{p:3,my:6,minHeight:"50vh",children:t})}))}function Gh(e){return{id:"scrollable-force-tab-".concat(e),"aria-controls":"scrollable-force-tabpanel-".concat(e)}}var Hh=Object(k.a)((function(e){return{root:{flexGrow:1,width:"100%",height:"100vh",backgroundColor:e.palette.background.paper},icon:{fontSize:100},iconSvg:{width:100},iconSvgVenta:{width:90}}}));var Yh=Object(h.f)((function(e){var t=Hh(),a=Object(Se.a)(),n=d.a.useState(0),c=Object(g.a)(n,2),r=c[0],i=c[1];return Object(B.jsxs)("div",{className:t.root,children:[Object(B.jsx)(we.a,{}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(Ie.a,{position:"static",color:"default",elevation:0,children:Object(B.jsxs)(ke.a,{value:r,onChange:function(e,t){i(t)},indicatorColor:"primary",textColor:"primary",centered:!0,scrollButtons:"on",children:[Object(B.jsx)(ze.a,Object(b.a)({label:"Mi empresa",icon:Object(B.jsx)(Fe.q,{className:t.icon})},Gh(0))),Object(B.jsx)(ze.a,Object(b.a)({label:"Catalogos",icon:Object(B.jsx)(Fe.i,{className:t.icon})},Gh(1))),Object(B.jsx)(ze.a,Object(b.a)({label:"Almacenes",icon:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/almacen.svg",alt:"icono almacen",className:t.iconSvg})},Gh(2))),Object(B.jsx)(ze.a,Object(b.a)({label:"Compras",icon:Object(B.jsx)(Fe.l,{className:t.icon})},Gh(3))),Object(B.jsx)(ze.a,Object(b.a)({label:"Reportes",icon:Object(B.jsx)(Fe.r,{className:t.icon})},Gh(4))),Object(B.jsx)(ze.a,Object(b.a)({label:"Tesoreria",icon:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/money.svg",alt:"icono money",className:t.iconSvg})},Gh(5))),Object(B.jsx)(ze.a,Object(b.a)({label:"Facturaci\xf3n",icon:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/factura.svg",alt:"icono factura",className:t.iconSvg})},Gh(6)))]})}),Object(B.jsxs)(ye.a,{axis:"rtl"===a.direction?"x-reverse":"x",index:r,onChangeIndex:function(e){i(e)},children:[Object(B.jsx)(Jh,{value:r,index:0,children:Object(B.jsx)(la,{})}),Object(B.jsx)(Jh,{value:r,index:1,children:Object(B.jsx)(gu,{})}),Object(B.jsx)(Jh,{value:r,index:2,children:Object(B.jsx)(XO,{})}),Object(B.jsx)(Jh,{value:r,index:3,children:Object(B.jsx)(Xs,{})}),Object(B.jsx)(Jh,{value:r,index:4,children:Object(B.jsx)(Bh,{})}),Object(B.jsx)(Jh,{value:r,index:5,children:Object(B.jsx)(dp,{})}),Object(B.jsx)(Jh,{value:r,index:6,children:Object(B.jsx)(Wm,{})})]})]})]})})),Kh=a(475),Qh=a.n(Kh),Xh=a(260),Zh=a(938),e_=Object(k.a)((function(e){return{appbar:{backgroundColor:e.palette.navbar,color:Xh.a[800]},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,marginLeft:e.spacing(2)}}}));var t_=Object(h.f)((function(e){var t,a=e_(),n=localStorage.getItem("sesionCafi"),c=JSON.parse(localStorage.getItem("turnoEnCurso")),r=JSON.parse(localStorage.getItem("sesionCafi"));return null!==n&&(t=JSON.parse(localStorage.getItem("sesionCafi"))),Object(B.jsx)("div",{children:Object(B.jsx)(Ie.a,{position:"fixed",className:a.appbar,elevation:0,children:Object(B.jsxs)(we.a,{children:[Object(B.jsx)(Re.a,{alt:"Remy Sharp",src:t.imagen}),Object(B.jsx)(p.a,{className:a.title,children:Object(B.jsxs)(S.a,{variant:"h6",color:"inherit",children:["Bienvenido ","".concat(t.nombre)]})}),Object(B.jsx)(w.a,{component:x.b,to:"/ventas/venta-general",size:"large",className:a.menuButton,startIcon:Object(B.jsx)(Zh.a,{}),children:"Panel de venta"}),!0===r.turno_en_caja_activo&&c?Object(B.jsx)(w.a,{color:"secondary",size:"large",className:a.menuButton,variant:"contained",disabled:!0,children:"TURNO ACTIVO"}):Object(B.jsx)(w.a,{color:"secondary",size:"large",className:a.menuButton,startIcon:Object(B.jsx)(Qh.a,{}),variant:"contained",onClick:function(){localStorage.removeItem("sesionCafi"),localStorage.removeItem("tokenCafi"),localStorage.removeItem("ListaEnEspera"),e.history.push("/")},children:"Cerrar sesi\xf3n"})]})})})}));var a_=a(939),n_=Object(k.a)((function(e){return{appBar:{zIndex:e.zIndex.drawer+1,backgroundColor:"white"},drawer:{width:"22%",flexShrink:0,backgroundColor:"white"},drawerColor:{height:"95vh",backgroundColor:"white"},drawerPaper:{width:"22%",backgroundColor:e.palette.navbar},root:{display:"flex",flexDirection:"column",height:"100%"},navigationTop:{height:"100%"},iconSizeSuperior:{fontSize:30,color:e.palette.info.main},iconSizeSecondSuperior:{width:20},iconSizeInferior:{fontSize:50,color:e.palette.info.main},iconSizeSecondInferior:{width:40},iconSizeSecondInferiorGrande:{width:100},iconSizeInferiorGrande:{fontSize:110,color:e.palette.info.main},avatar:{width:e.spacing(3),height:e.spacing(3),marginRight:e.spacing(1),marginLeft:e.spacing(1)},borderBoton:{minWidth:"100%",height:"50%",border:".6px solid #DBDBDB"},borderBotonChico:{minWidth:"100%",border:".6px solid #DBDBDB"}}})),c_=a(962),r_=a(949),i_=Object(k.a)((function(e){return{root:{marginTop:e.spacing(2)},rootPrecioProductos:{minHeight:"40vh"},containerImage:{maxWidth:100,maxHeight:100,display:"flex",justifyContent:"center",alignItems:"center",justifyItems:"ceter"},imagen:{maxWidth:"100%",maxHeight:"100%",display:"flex",justifyContent:"center",alignItems:"center",justifyItems:"ceter"},rootBusqueda:{height:35,display:"flex",padding:e.spacing(1)},rootBusquedaProductos:{height:35,display:"flex",padding:e.spacing(1)},rootFecha:{height:40,maxWidth:150,display:"flex"},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(.5),"px")},"& .obligatorio":{color:"red"},paddingTop:0,alignItems:"center",justifyItems:"center"},titulos:{fontWeight:500,"& .obligatorio":{color:"red"}},formInput:{},iconSize:{width:28},iconSizeDialogs:{width:50},iconSizeDialogsPequeno:{width:50},containerImagenesProducto:{height:"150px",display:"flex",justifyContent:"center",alignItems:"center"},imagenProducto:{maxHeight:"100%",maxWidth:"100%"},borderBoton:{minWidth:"100%",height:"50%",border:".6px solid #DBDBDB"},borderBotonChico:{minWidth:"100%",height:"100%",border:".6px solid #DBDBDB"},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}}}})),o_=Object(l.createContext)(),s_=function(e){var t=e.children,a=Object(l.useState)({subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)({_id:null,cantidad:null,codigo_barras:null,concepto:null,default:null,descuento:null,descuento_activo:null,id_producto:{},precio:null,unidad:null,unidad_principal:null}),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)([]),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(l.useState)({productos:[],cliente:{},subtotal:0,impuestos:0,total:0,usuario:{}}),O=Object(g.a)(m,2),x=O[0],h=O[1],_=Object(l.useState)({}),f=Object(g.a)(_,2),v=f[0],C=f[1],y=Object(l.useState)([]),S=Object(g.a)(y,2),F=S[0],w=S[1],I=Object(l.useState)([]),k=Object(g.a)(I,2),z=k[0],N=k[1],P=Object(l.useState)(),D=Object(g.a)(P,2),E=D[0],A=D[1],T=Object(l.useState)(""),W=Object(g.a)(T,2),$=W[0],R=W[1],V=Object(l.useState)(!1),M=Object(g.a)(V,2),L=M[0],U=M[1],q=Object(l.useState)(!1),J=Object(g.a)(q,2),G=J[0],H=J[1],Y=Object(l.useState)({message:"",status:"",open:!1}),K=Object(g.a)(Y,2),Q=K[0],X=K[1],Z=Object(l.useState)(!1),ee=Object(g.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(l.useState)(!1),ce=Object(g.a)(ne,2),re=ce[0],ie=ce[1],oe=Object(l.useState)(null),se=Object(g.a)(oe,2),le=se[0],de=se[1],je=Object(l.useState)(!1),ue=Object(g.a)(je,2),be=ue[0],pe=ue[1],me=Object(l.useState)(!1),Oe=Object(g.a)(me,2),xe=Oe[0],he=Oe[1],_e=Object(l.useState)(!1),fe=Object(g.a)(_e,2),ge=fe[0],ve=fe[1];return Object(B.jsx)(o_.Provider,{value:{alert:Q,setAlert:X,update:L,setUpdate:U,error:G,setError:H,datosProductoVentas:s,setDatosProductoVentas:d,productosVentas:b,setProductosVentas:p,datosVentas:x,setDatosVentas:h,abrirTurnosDialog:te,setAbrirTurnosDialog:ae,setUpdateClientVenta:ie,updateClientVenta:re,setProductoCambioPrecio:C,productoCambioPrecio:v,setPrecioSelectProductoVenta:w,precioSelectProductoVenta:F,setUpdateTablaVentas:he,updateTablaVentas:xe,setOpen:pe,open:be,clientesVentas:z,setClientesVentas:N,turnoActivo:E,setTurnoActivo:A,ubicacionTurno:$,setUbicacionTurno:R,DatosVentasActual:c,setDatosVentasActual:r,setOpenBackDrop:ve,openBackDrop:ge,venta_retomada:le,setVentaRetomada:de},children:t})},l_=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function d_(){var e=JSON.parse(localStorage.getItem("turnoEnCurso")),t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(z.a)(Rd),n=Object(g.a)(a,1)[0];ht.a.locale("es");var c=i_(),r=Object(l.useContext)(o_).setAlert,i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(!1),u=Object(g.a)(j,2),m=u[0],O=u[1],x=Object(l.useState)(!1),h=Object(g.a)(x,2),v=h[0],y=h[1],k=Object(l.useState)({tipo_movimiento:"DEPOSITO"}),N=Object(g.a)(k,2),P=N[0],D=N[1],E=Object(qe.a)(id,{variables:{empresa:t.empresa._id}}),A=E.loading,T=E.data,W=E.error,$={horario_en_turno:"ABRIR TURNO",id_caja:e?e.id_caja:"",id_usuario:t._id,token_turno_user:e?e.token_turno_user:""},R=Object(qe.a)(Ld,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id,input:$}}),V=function(){d(!s),R.refetch()},M=0;if(!T||!R.data)return Object(B.jsx)(j_,{});if(M=R.data.obtenerPreCorteCaja.monto_efectivo_precorte,A||W||R.loading||R.error)return Object(B.jsx)(j_,{});window.addEventListener("keydown",(function(e){e.altKey&&68===e.keyCode&&V()}));var L=function(e){D(Object(b.a)(Object(b.a)({},P),{},Object(_.a)({},e.target.name,e.target.value)))},U=function(){var a=Object(f.a)(C.a.mark((function a(){var c;return C.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(y(!0),a.prev=1,e||!1!==(null===t||void 0===t?void 0:t.turno_en_caja_activo)){a.next=8;break}return y(!1),r({message:"Por el momento no hay ningun turno activo.",status:"error",open:!0}),a.abrupt("return",null);case 8:if(P.tipo_movimiento&&P.monto_efectivo&&P.concepto){a.next=15;break}return O(!0),y(!1),r({message:"Por favor complete los datos.",status:"error",open:!0}),a.abrupt("return",null);case 15:if(!("RETIRO"===P.tipo_movimiento&&M<parseFloat(P.monto_efectivo))){a.next=19;break}return y(!1),r({message:"Lo sentimos no hay dinero suficiente en la caja para esta acci\xf3n.",status:"error",open:!0}),a.abrupt("return",null);case 19:return c={tipo_movimiento:P.tipo_movimiento,concepto:P.concepto,numero_caja:parseInt(e.numero_caja),id_Caja:e.id_caja,horario_turno:e.horario_en_turno,rol_movimiento:"CAJA",hora_moviento:{hora:ht()().format("hh"),minutos:ht()().format("mm"),segundos:ht()().format("ss"),completa:ht()().format("HH:mm:ss")},fecha_movimiento:{year:ht()().format("YYYY"),mes:ht()().format("DD"),dia:ht()().format("MM"),no_semana_year:ht()().week().toString(),no_dia_year:ht()().dayOfYear().toString(),completa:ht()().locale("es-mx").format()},id_User:t._id,numero_usuario_creador:t.numero_usuario,nombre_usuario_creador:t.nombre,montos_en_caja:{monto_efectivo:{monto:parseFloat(P.monto_efectivo),metodo_pago:"01"},monto_tarjeta_debito:{monto:0,metodo_pago:"28"},monto_tarjeta_credito:{monto:0,metodo_pago:"04"},monto_creditos:{monto:0,metodo_pago:"99"},monto_monedero:{monto:0,metodo_pago:"05"},monto_transferencia:{monto:0,metodo_pago:"03"},monto_cheques:{monto:0,metodo_pago:"02"},monto_vales_despensa:{monto:0,metodo_pago:"08"}},empresa:t.empresa._id,sucursal:t.sucursal._id},a.next=22,n({variables:{empresa:t.empresa._id,sucursal:t.sucursal._id,input:c}});case 22:r({message:"Registro de movimiento exitoso.",status:"success",open:!0}),V(),y(!1);case 25:a.next=32;break;case 27:a.prev=27,a.t0=a.catch(1),y(!1),r({message:"Error: ".concat(a.t0.message),status:"error",open:!0}),V();case 32:case"end":return a.stop()}}),a,null,[[1,27]])})));return function(){return a.apply(this,arguments)}}();return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(w.a,{onClick:function(){V()},style:{textTransform:"none",height:"100%",width:"100%"},disabled:!e,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cash-register2.svg",alt:"icono caja",style:{width:20}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Deposito/Retiro"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"Alt + D"})})})]})}),Object(B.jsxs)(Ee.a,{open:s,onClose:function(e,t){"backdropClick"!==t&&V()},TransitionComponent:l_,children:[Object(B.jsxs)(Ae.a,{children:[Object(B.jsxs)(p.a,{display:"flex",textAlign:"center",children:[Object(B.jsxs)(p.a,{display:"flex",justifyContent:"center",flexGrow:1,children:[Object(B.jsx)(p.a,{children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cash-register2.svg",alt:"icono caja",className:c.iconSizeDialogs})}),Object(B.jsx)(p.a,{m:2,children:Object(B.jsx)(Le.a,{orientation:"vertical"})}),Object(B.jsxs)(p.a,{mt:1,children:[Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"h6",children:"Deposito/Retiro Caja"})}),Object(B.jsxs)(p.a,{display:"flex",textAlign:"right",children:[Object(B.jsx)(p.a,{textAlign:"right",children:Object(B.jsx)(S.a,{variant:"caption",children:ht()().format("MM/DD/YYYY")})}),Object(B.jsx)(p.a,{textAlign:"right",ml:2,children:Object(B.jsx)(S.a,{variant:"caption",children:Object(B.jsxs)("b",{children:[ht()().format("h:mm")," hrs."]})})}),Object(B.jsx)(p.a,{textAlign:"right",ml:2,children:Object(B.jsxs)(S.a,{variant:"caption",children:[Object(B.jsx)("b",{children:"Caja: "}),null===e||void 0===e?void 0:e.numero_caja]})})]})]})]}),Object(B.jsx)(p.a,{ml:10,mb:7,display:"flex",alignItems:"center",children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:V,size:"large",disabled:v,children:Object(B.jsx)(We.a,{})})})]}),Object(B.jsx)(p.a,{m:2,children:!0===t.turno_en_caja_activo?Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{width:"100%",children:Object(B.jsx)(H.a,{component:"fieldset",children:Object(B.jsxs)(c_.a,{row:!0,"aria-label":"position",name:"position",value:P.tipo_movimiento,onChange:function(e,t){D(Object(b.a)(Object(b.a)({},P),{},{tipo_movimiento:t}))},children:[Object(B.jsx)(Ve.a,{value:"DEPOSITO",control:Object(B.jsx)(r_.a,{color:"primary"}),label:"Deposito"}),Object(B.jsx)(Ve.a,{value:"RETIRO",control:Object(B.jsx)(r_.a,{color:"primary"}),label:"Retiro"})]})})}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Monto:"}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",type:"number",name:"monto_efectivo",onChange:L,id:"form-producto-codigo-barras",variant:"outlined",error:m&&!P.monto_efectivo})})]}),Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:"Concepto de Movimiento:"}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",error:m&&!P.concepto,children:Object(B.jsxs)(mt.a,{id:"form-producto-tipo",onChange:L,name:"concepto",children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),null===T||void 0===T?void 0:T.obtenerContabilidad.map((function(e,t){return Object(B.jsx)(Ot.a,{value:e.nombre_servicio,children:e.nombre_servicio},t)}))]})})]})]}):Object(B.jsx)(p.a,{textAlign:"center",p:2,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Por el momento no hay un turno en sesi\xf3n"})})})})]}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{onClick:U,variant:"contained",color:"primary",size:"large",disabled:v,startIcon:v?Object(B.jsx)(I.a,{color:"inherit",size:20}):Object(B.jsx)(Dt.a,{}),children:"Guardar"})})]})]})}var j_=function(){return Object(B.jsx)(w.a,{disabled:!0,style:{textTransform:"none",height:"100%",width:"100%",pointerEvents:"none",opacity:.5},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cash-register2.svg",alt:"icono caja",style:{width:20}})}),Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Deposito/Retiro"})}),Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"Alt + D"})})]})})};ht.a.locale("es");var u_=Object(h.f)((function(e){var t=e.handleClickOpen,a=e.setLoading,n=e.loading,c=Object(z.a)(Sx),r=Object(g.a)(c,1)[0],i=Object(l.useContext)(o_),o=i.setAlert,s=i.ubicacionTurno,d=Object(l.useState)(!1),j=Object(g.a)(d,2),u=j[0],m=j[1],O=JSON.parse(localStorage.getItem("sesionCafi")),x=JSON.parse(localStorage.getItem("turnoEnCurso")),h=i_(),v=Object(l.useState)([]),y=Object(g.a)(v,2),k=y[0],N=y[1],P=Object(l.useState)([]),D=Object(g.a)(P,2),E=D[0],A=D[1],T=function(e){N(Object(b.a)(Object(b.a)({},k),{},Object(_.a)({},e.target.name,e.target.value)))},W=function(e){A(Object(b.a)(Object(b.a)({},E),{},Object(_.a)({},e.target.name,e.target.value)))},$={horario_en_turno:E.horario_en_turno,concepto:"CERRAR TURNO",token_turno_user:x?x.token_turno_user:"",numero_caja:x?null===x||void 0===x?void 0:x.numero_caja.toString():"",comentarios:E.comentarios,id_caja:x?x.id_caja:"",empresa:O.empresa._id,sucursal:O.sucursal._id,id_usuario:O._id,usuario_en_turno:{nombre:O.nombre,telefono:O.telefono,numero_usuario:O.numero_usuario.toString(),email:O.email},hora_entrada:{hora:"",minutos:"",segundos:"",completa:""},hora_salida:{hora:ht()().format("hh"),minutos:ht()().format("mm"),segundos:ht()().format("ss"),completa:ht()().format("HH:mm:ss")},fecha_entrada:{year:"",mes:"",dia:"",no_semana_year:"",no_dia_year:"",completa:""},fecha_salida:{year:ht()().format("YYYY"),mes:ht()().format("MM"),dia:ht()().format("DD"),no_semana_year:ht()().week().toString(),no_dia_year:ht()().dayOfYear().toString(),completa:ht()().format("YYYY-MM-DD")},fecha_movimiento:ht()().locale("es-mx").format(),montos_en_caja:{monto_efectivo:{monto:parseFloat(k.monto_efectivo?k.monto_efectivo:0),metodo_pago:"01"},monto_tarjeta_debito:{monto:parseFloat(k.monto_tarjeta_debito?k.monto_tarjeta_debito:0),metodo_pago:"28"},monto_tarjeta_credito:{monto:parseFloat(k.monto_tarjeta_credito?k.monto_tarjeta_credito:0),metodo_pago:"04"},monto_creditos:{monto:parseFloat(k.monto_creditos?k.monto_creditos:0),metodo_pago:"99"},monto_monedero:{monto:parseFloat(k.monto_puntos?k.monto_puntos:0),metodo_pago:"05"},monto_transferencia:{monto:parseFloat(k.monto_transferencia?k.monto_transferencia:0),metodo_pago:"03"},monto_cheques:{monto:parseFloat(k.monto_cheques?k.monto_cheques:0),metodo_pago:"02"},monto_vales_despensa:{monto:parseFloat(k.monto_vales_despensa?k.monto_vales_despensa:0),metodo_pago:"08"}}},R={accesos:O.accesos,email:O.email,empresa:O.empresa,estado:O.estado,exp:O.exp,iat:O.iat,imagen:O.imagen,nombre:O.nombre,numero_usuario:O.numero_usuario,sucursal:O.sucursal,telefono:O.telefono,turno_en_caja_activo:!1,_id:O._id},V=function(t){"SESION"===t?(localStorage.removeItem("sesionCafi"),localStorage.removeItem("tokenCafi"),localStorage.removeItem("turnoEnCurso"),localStorage.removeItem("ListaEnEspera"),localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal"),e.history.push("/")):(localStorage.setItem("sesionCafi",JSON.stringify(R)),localStorage.removeItem("DatosVentas"),localStorage.removeItem("ListaEnEspera"),localStorage.removeItem("turnoEnCurso"),localStorage.removeItem("VentaOriginal"))},M=function(){var e=Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a(!0),e.prev=1,E.horario_en_turno){e.next=9;break}return m(!0),a(!1),o({message:"Por favor elija que turno est\xe1 cerrando",status:"error",open:!0}),e.abrupt("return");case 9:return e.next=11,r({variables:{activa:!1,input:$}});case 11:o({message:"Turno cerrado con exito",status:"success",open:!0}),V(s),window.location.reload();case 14:e.next=21;break;case 16:e.prev=16,e.t0=e.catch(1),o({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),a(!1),t();case 21:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(p.a,{mb:2,children:Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Montos a Depositar"})})}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsxs)(S.a,{className:h.titulos,children:[" ","Monto Efectivo:"]}),Object(B.jsx)(F.a,{fullWidth:!0,name:"monto_efectivo",variant:"outlined",size:"small",inputProps:{min:0},type:"number",placeholder:"0.00",InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})},color:"primary",onChange:T})]}),Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsx)(S.a,{className:h.titulos,children:" Creditos:"}),Object(B.jsx)(F.a,{fullWidth:!0,name:"monto_creditos",variant:"outlined",size:"small",inputProps:{min:0},type:"number",placeholder:"0.00",InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})},color:"primary",onChange:T})]}),Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsxs)(S.a,{className:h.titulos,children:[" ","Tarjeta Debito:"]}),Object(B.jsx)(F.a,{fullWidth:!0,name:"monto_tarjeta_debito",variant:"outlined",size:"small",inputProps:{min:0},type:"number",placeholder:"0.00",InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})},color:"primary",onChange:T})]}),Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsxs)(S.a,{className:h.titulos,children:[" ","Tarjeta Credito:"]}),Object(B.jsx)(F.a,{fullWidth:!0,name:"monto_tarjeta_credito",variant:"outlined",size:"small",inputProps:{min:0},type:"number",placeholder:"0.00",InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})},color:"primary",onChange:T})]}),Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsx)(S.a,{className:h.titulos,children:"Monedero:"}),Object(B.jsx)(F.a,{fullWidth:!0,name:"monto_puntos",variant:"outlined",size:"small",inputProps:{min:0},type:"number",placeholder:"0.00",InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})},color:"primary",onChange:T})]}),Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsx)(S.a,{className:h.titulos,children:"Transferencias:"}),Object(B.jsx)(F.a,{fullWidth:!0,name:"monto_transferencia",variant:"outlined",size:"small",inputProps:{min:0},type:"number",placeholder:"0.00",InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})},color:"primary",onChange:T})]}),Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsx)(S.a,{className:h.titulos,children:"Cheques:"}),Object(B.jsx)(F.a,{fullWidth:!0,name:"monto_cheques",variant:"outlined",size:"small",inputProps:{min:0},type:"number",placeholder:"0.00",InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})},color:"primary",onChange:T})]}),Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsx)(S.a,{className:h.titulos,children:"Vales de despensa:"}),Object(B.jsx)(F.a,{fullWidth:!0,name:"monto_vales_despensa",variant:"outlined",size:"small",inputProps:{min:0},type:"number",placeholder:"0.00",InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})},color:"primary",onChange:T})]})]}),Object(B.jsxs)(p.a,{my:2,display:"flex",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Monto total efectivo: "})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsxs)(S.a,{children:["$",k.monto_efectivo," Mx."]})]}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,xs:12,children:[Object(B.jsxs)(S.a,{className:h.titulos,children:[Object(B.jsx)("span",{className:"obligatorio",children:"* "})," Turno:"]}),Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",error:u&&!E.horario_en_turno,children:Object(B.jsxs)(mt.a,{onChange:W,id:"form-producto-tipo",name:"horario_en_turno",children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),Object(B.jsx)(Ot.a,{value:"VESPERTINO",children:"Vespertino"}),Object(B.jsx)(Ot.a,{value:"MATUTINO",children:"Matutino"})]})})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,children:[Object(B.jsx)(S.a,{className:h.titulos,children:"Comentarios:"}),Object(B.jsx)(F.a,{fullWidth:!0,multiline:!0,onChange:W,rows:2,size:"small",name:"comentarios",id:"form-producto-codigo-barras",variant:"outlined"})]})]})]}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(p.a,{display:"flex",alignItems:"flex-end",children:Object(B.jsx)(w.a,{onClick:M,variant:"contained",color:"primary",size:"large",disabled:n,startIcon:n?Object(B.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Aceptar"})})})]})}));ht.a.locale("es");var b_=Object(k.a)((function(e){return{iconSvg:{width:50}}})),p_=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function m_(){var e=Object(l.useContext)(o_),t=e.abrirTurnosDialog,a=e.setAbrirTurnosDialog,n=JSON.parse(localStorage.getItem("turnoEnCurso")),c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=b_(),d=function(){a(!t)};return window.addEventListener("keydown",(function(e){e.altKey&&85===e.keyCode&&d()})),Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(w.a,{onClick:function(){return d()},style:{textTransform:"none",height:"100%",width:"100%"},disabled:!n,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",style:{height:"100%",width:"100%"},children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/shift.svg",alt:"icono caja",style:{width:20}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Cerrar turno"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"Alt + U"})})})]})}),Object(B.jsxs)(Ee.a,{maxWidth:"sm",fullWidth:!0,open:t,onClose:function(e,t){"backdropClick"!==t&&d()},TransitionComponent:p_,children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/shift.svg",alt:"icono almacen",className:s.iconSvg}),Object(B.jsx)(p.a,{m:2,children:Object(B.jsx)(Le.a,{orientation:"vertical"})}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"h6",children:"Cerrar turno"})}),Object(B.jsxs)(p.a,{display:"flex",textAlign:"right",children:[Object(B.jsx)(p.a,{textAlign:"right",children:Object(B.jsx)(S.a,{variant:"caption",children:ht()().format("MM/DD/YYYY")})}),Object(B.jsx)(p.a,{textAlign:"right",ml:2,children:Object(B.jsx)(S.a,{variant:"caption",children:Object(B.jsxs)("b",{children:[ht()().format("h:mm")," hrs."]})})}),Object(B.jsx)(p.a,{textAlign:"right",ml:2,children:Object(B.jsxs)(S.a,{variant:"caption",children:[Object(B.jsx)("b",{children:"Caja: "}),null===n||void 0===n?void 0:n.numero_caja]})})]})]})]}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:d,size:"large",disabled:i,children:Object(B.jsx)(We.a,{})})]})}),Object(B.jsx)(u_,{setLoading:o,loading:i,handleClickOpen:d})]})]})}var O_=Object(l.createContext)(),x_=function(e){var t=e.children,a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)({departamento:"",subDepartamento:"",tipo_acceso:""}),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useState)(!1),u=Object(g.a)(j,2),b=u[0],p=u[1],m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1],_=Object(l.useState)(!1),f=Object(g.a)(_,2),v=f[0],C=f[1],y=Object(l.useState)(!1),S=Object(g.a)(y,2),F=S[0],w=S[1],I=Object(l.useState)(!1),k=Object(g.a)(I,2),z=k[0],N=k[1],P=Object(l.useState)(!1),D=Object(g.a)(P,2),E=D[0],A=D[1],T=Object(l.useState)(!1),W=Object(g.a)(T,2),$=W[0],R=W[1];return Object(B.jsx)(O_.Provider,{value:{departamentos:s,setDepartamentos:d,reloadProductoRapido:x,setReloadProductoRapido:h,reloadAdministrador:b,setReloadAdministrador:p,abrirPanelAcceso:c,setAbrirPanelAcceso:r,reloadCancelarVenta:v,setReloadCancelarVenta:C,reloadVerPrecios:F,setReloadVerPrecios:w,reloadVerPreCorte:z,setReloadVerPreCorte:N,reloadEliminarVentaEspera:E,setReloadEliminarVentaEspera:A,reloadCrearCotizacion:$,setReloadCrearCotizacion:R},children:t})};ht.a.locale("es");var h_=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function __(){var e,t,a=JSON.parse(localStorage.getItem("turnoEnCurso")),n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(l.useContext)(O_),r=c.reloadVerPreCorte,i=c.setReloadVerPreCorte,o=c.setAbrirPanelAcceso,s=c.abrirPanelAcceso,d=c.setDepartamentos,j={horario_en_turno:"ABRIR TURNO",id_caja:a?a.id_caja:"",id_usuario:n._id,token_turno_user:a?a.token_turno_user:""},u=Object(qe.a)(Ld,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id,input:j}}),b=u.loading,m=u.error,O=u.data,x=u.refetch,h=i_(),_=Object(l.useState)(!1),f=Object(g.a)(_,2),v=f[0],C=f[1],y=function(){!0===n.accesos.ventas.pre_corte.ver?C(!v):(o(!s),d({departamento:"ventas",subDepartamento:"pre_corte",tipo_acceso:"ver"}))};if(Object(l.useEffect)((function(){!0===r&&(C(!v),i(!1))}),[r]),!O||m||b)return Object(B.jsx)(f_,{});return window.addEventListener("keydown",(function(e){e.altKey&&79===e.keyCode&&(y(),x())})),Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(w.a,{onClick:function(){y(),x()},style:{textTransform:"none",height:"100%",width:"100%"},disabled:!a,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cash-register.svg",alt:"icono caja",style:{width:20}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Pre corte caja"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"Alt + O"})})})]})}),Object(B.jsxs)(Ee.a,{maxWidth:"lg",open:v,onClose:function(){return C(!v)},TransitionComponent:h_,children:[Object(B.jsxs)(Ae.a,{children:[Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)($e.a,{item:!0,lg:10,children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(p.a,{children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cash-register.svg",alt:"icono caja",className:h.iconSizeDialogs})}),Object(B.jsxs)(p.a,{ml:2,children:[Object(B.jsx)(p.a,{textAlign:"left",children:Object(B.jsx)(S.a,{variant:"h6",children:"Pre-Corte de Caja"})}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{textAlign:"right",children:Object(B.jsx)(S.a,{variant:"caption",children:ht()().format("MM/DD/YYYY")})}),Object(B.jsx)(p.a,{textAlign:"right",ml:2,children:Object(B.jsx)(S.a,{variant:"caption",children:Object(B.jsxs)("b",{children:[ht()().format("h:mm")," hrs."]})})})]})]})]})}),Object(B.jsx)($e.a,{item:!0,lg:2,children:Object(B.jsx)(p.a,{ml:4,display:"flex",alignItems:"center",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){return C(!v)},size:"large",children:Object(B.jsx)(We.a,{})})})})]}),Object(B.jsx)($e.a,{children:Object(B.jsx)(p.a,{p:2,children:!0===n.turno_en_caja_activo&&a?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(p.a,{children:Object(B.jsxs)(S.a,{variant:"subtitle1",children:[Object(B.jsx)("b",{children:"Usuario: "})," ",n.nombre]})}),Object(B.jsx)(p.a,{children:Object(B.jsxs)(S.a,{variant:"subtitle1",children:[Object(B.jsx)("b",{children:"Caja: "})," ",a?a.numero_caja:""]})}),Object(B.jsxs)(p.a,{children:[Object(B.jsx)(S.a,{variant:"subtitle1",children:Object(B.jsx)("b",{children:"Fecha y hora al precorte: "})}),Object(B.jsx)(S.a,{variant:"subtitle1",children:ht()().format("MMMM D YYYY, h:mm:ss a")})]}),Object(B.jsxs)(p.a,{textAlign:"center",p:2,children:[Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Monto total en efectivo: "})}),Object(B.jsx)(S.a,{variant:"h3",style:{color:"green"},children:Object(B.jsxs)("b",{children:["$",null!==O&&void 0!==O&&null!==(e=O.obtenerPreCorteCaja)&&void 0!==e&&e.monto_efectivo_precorte?Fa(null===O||void 0===O||null===(t=O.obtenerPreCorteCaja)||void 0===t?void 0:t.monto_efectivo_precorte):0]})})]})]}):Object(B.jsx)(p.a,{textAlign:"center",p:2,children:Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:"Por el momento no hay un turno en sesi\xf3n"})})})})})]}),Object(B.jsx)(Ue.a,{children:!0===n.turno_en_caja_activo&&a?Object(B.jsx)(w.a,{onClick:function(){return C(!v)},color:"primary",variant:"contained",size:"large",autoFocus:!0,children:"Imprimir"}):null})]})]})}var f_=function(){return Object(B.jsx)(w.a,{style:{textTransform:"none",height:"100%",width:"100%"},disabled:!0,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cash-register.svg",alt:"icono caja",style:{width:20}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Pre corte caja"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"Alt + O"})})})]})})};function g_(){var e=Object(l.useContext)(o_),t=e.updateTablaVentas,a=e.setUpdateTablaVentas,n=e.setDatosVentasActual,c=Object(l.useContext)(Xi),r=c.updateClientVenta,i=c.setUpdateClientVenta,o=JSON.parse(localStorage.getItem("turnoEnCurso")),s=Object(l.useState)(!1),d=Object(g.a)(s,2),j=d[0],u=d[1],b=function(){u(!j)},m=function(){var e=JSON.parse(localStorage.getItem("DatosVentas")),t=localStorage.getItem("ListaEnEspera");if(null!==e)if(null===t)localStorage.setItem("ListaEnEspera",JSON.stringify([{datosVenta:e,fecha:ht()().format("MM/DD/YYYY")}])),O(),b();else{var a=JSON.parse(t);a.push({datosVenta:e,fecha:ht()().format("MM/DD/YYYY")}),localStorage.setItem("ListaEnEspera",JSON.stringify(a)),O(),b()}},O=function(){localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal"),a(!t),i(!r),n({subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0})};return window.addEventListener("keydown",(function(e){e.altKey&&69===e.keyCode&&m()})),Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(w.a,{onClick:function(){return m()},style:{textTransform:"none",height:"100%",width:"100%"},disabled:!o,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Fe.f,{style:{fontSize:25}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"En espera"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"Alt + E"})})})]})}),Object(B.jsx)(R.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:j,autoHideDuration:3e3,onClose:b,message:"Compra agregada en espera",action:Object(B.jsx)(X.a,{size:"small","aria-label":"close",color:"inherit",onClick:b,children:Object(B.jsx)(Pt.a,{fontSize:"small"})})})]})}ht.a.locale("es");var v_=Object(k.a)((function(e){return{titulos:{fontWeight:500,"& .obligatorio":{color:"red"}}}}));function C_(e){var t=e.setAbrirTallaColor,a=e.setCantidad,n=e.cantidad,c=e.obtenerConsultasProducto,r=e.refetch,i=Object(l.useContext)(fe),o=i.datos_generales,s=i.precios,d=i.setPrecios,j=i.setDatosGenerales,u=i.validacion,m=Object(l.useContext)(fe),O=m.unidadVentaXDefecto,x=m.setUnidadVentaXDefecto,h=m.setUnidadVentaSecundaria,f=m.unidadVentaSecundaria,g=m.update,v=function(e){"codigo_barras"===e.target.name&&x(Object(b.a)(Object(b.a)({},O),{},{codigo_barras:e.target.value})),j(Object(b.a)(Object(b.a)({},o),{},Object(_.a)({},e.target.name,e.target.value))),"CALZADO"!==e.target.value&&"ROPA"!==e.target.value||t(!0)},C=v_();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{mb:2,children:Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Informaci\xf3n General"})})}),Object(B.jsx)(Le.a,{}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:3,xs:12,children:Object(B.jsxs)(H.a,{variant:"outlined",size:"small",name:"codigo_barras",fullWidth:!0,children:[Object(B.jsx)(S.a,{className:C.titulos,children:"C\xf3digo de barras"}),Object(B.jsx)(K.a,{disabled:g&&o.codigo_barras,style:{padding:0},id:"form-producto-codigo-barras",name:"codigo_barras",value:o.codigo_barras?o.codigo_barras:"",onChange:v,endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(w.a,{disabled:g&&o.codigo_barras,onClick:function(){return function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();j(Object(b.a)(Object(b.a)({},o),{},{codigo_barras:t})),x(Object(b.a)(Object(b.a)({},O),{},{codigo_barras:t}))}()},color:"primary",variant:"outlined",size:"large",children:"Generar"})})})]})}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsxs)(S.a,{className:C.titulos,children:[Object(B.jsx)("span",{className:"obligatorio",children:"* "}),"Clave alterna"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:u.error&&!o.clave_alterna,name:"clave_alterna",id:"form-producto-clave-alterna",variant:"outlined",value:o.clave_alterna?o.clave_alterna:"",helperText:u.message,onChange:v,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsxs)(S.a,{className:C.titulos,children:[Object(B.jsx)("span",{className:"obligatorio",children:"* "}),"Nombre comercial"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:u.error&&!o.nombre_comercial,name:"nombre_comercial",id:"form-producto-nombre-comercial",variant:"outlined",value:o.nombre_comercial?o.nombre_comercial:"",helperText:u.message,onChange:v,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsx)($e.a,{item:!0,md:3,xs:12,children:Object(B.jsx)(vc,{refetch:r,codigos:c.codigos})}),Object(B.jsxs)($e.a,{item:!0,md:"OTROS"===o.tipo_producto?4:8,xs:12,children:[Object(B.jsxs)(S.a,{className:C.titulos,children:[Object(B.jsx)("span",{className:"obligatorio",children:"* "}),"Nombre gen\xe9rico"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:u.error&&!o.nombre_generico,name:"nombre_generico",id:"form-producto-nombre-generico",variant:"outlined",value:o.nombre_generico?o.nombre_generico:"",helperText:u.message,onChange:v,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(B.jsxs)($e.a,{item:!0,md:"OTROS"===o.tipo_producto?2:4,xs:12,children:[Object(B.jsxs)(S.a,{className:C.titulos,children:[Object(B.jsx)("span",{className:"obligatorio",children:"* "}),"Tipo de producto"]}),Object(B.jsxs)(H.a,{variant:"outlined",fullWidth:!0,size:"small",error:u.error&&!o.tipo_producto,children:[Object(B.jsxs)(mt.a,{id:"form-producto-tipo",name:"tipo_producto",value:o.tipo_producto?o.tipo_producto:"",onChange:v,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),Object(B.jsx)(Ot.a,{value:"ROPA",children:"ROPA"}),Object(B.jsx)(Ot.a,{value:"CALZADO",children:"CALZADO"}),Object(B.jsx)(Ot.a,{value:"OTROS",children:"OTROS"})]}),Object(B.jsx)(ua.a,{children:u.message})]})]}),"OTROS"===o.tipo_producto?Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsxs)(S.a,{className:C.titulos,children:[Object(B.jsx)("span",{className:"obligatorio",children:"* "}),"Cantidad en Almacen"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",error:u.error&&!n,name:"cantidad",type:"number",id:"form-producto-nombre-generico",variant:"outlined",value:n||"",helperText:u.message,onChange:function(e){return a(parseInt(e.target.value))}})]}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsx)(S.a,{className:C.titulos,children:"Granel"}),Object(B.jsx)(Ve.a,{control:Object(B.jsx)(Me.a,{onChange:function(e){var t,a;"granel"===e.target.name&&e.target.checked?(d(Object(b.a)(Object(b.a)({},s),{},(t={},Object(_.a)(t,e.target.name,e.target.checked),Object(_.a)(t,"inventario",Object(b.a)(Object(b.a)({},s.inventario),{},{unidad_de_inventario:"Kg",codigo_unidad:"KGM"})),Object(_.a)(t,"unidad_de_compra",Object(b.a)(Object(b.a)({},s.unidad_de_compra),{},{unidad:"Kg",codigo_unidad:"KGM"})),t))),x(Object(b.a)(Object(b.a)({},O),{},{unidad:"Kg",codigo_unidad:"KGM"})),h(Object(b.a)(Object(b.a)({},f),{},{unidad:"Costal",codigo_unidad:"KGM"}))):(d(Object(b.a)(Object(b.a)({},s),{},(a={},Object(_.a)(a,e.target.name,e.target.checked),Object(_.a)(a,"inventario",Object(b.a)(Object(b.a)({},s.inventario),{},{unidad_de_inventario:"Pz",codigo_unidad:"H87"})),Object(_.a)(a,"unidad_de_compra",Object(b.a)(Object(b.a)({},s.unidad_de_compra),{},{unidad:"Pz",codigo_unidad:"H87"})),a))),x(Object(b.a)(Object(b.a)({},O),{},{unidad:"Pz",codigo_unidad:"H87"})),h(Object(b.a)(Object(b.a)({},f),{},{unidad:"Caja",codigo_unidad:"XBX"})))},name:"granel"}),label:"Vender a granel"})]}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsx)(S.a,{className:C.titulos,children:"Medicamento"}),Object(B.jsx)(Ve.a,{control:Object(B.jsx)(Me.a,{onChange:function(e){j(Object(b.a)(Object(b.a)({},o),{},{receta_farmacia:e.target.checked}))},name:"receta_farmacia"}),label:"Necesita receta",name:"receta_farmacia"})]})]}):null]})]})}var y_=function(e,t){if(e.medida.talla&&t.medida.talla)return e.medida.talla.localeCompare(t.medida.talla)},S_=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},container:{maxHeight:"65vh"},tableRow:{"&.Mui-selected, &.Mui-selected:hover":{backgroundColor:Object(tn.fade)(e.palette.primary.main,.1)}},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",height:30,width:30,borderRadius:"15%"}}}));function F_(e){var t=e.from,a=e.setOnUpdate,n=e.onUpdate,c=S_(),r=Object(l.useContext)(fe).presentaciones,i=Object(da.a)(r).sort((function(e,t){return y_(e,t)}));return Object(B.jsx)("div",{className:c.root,children:Object(B.jsx)(Ka.a,{className:c.paper,children:Object(B.jsx)(ba.a,{className:c.container,children:Object(B.jsxs)(_a.a,{className:c.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",stickyHeader:!0,children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Existencia"}),Object(B.jsx)(Oa.a,{children:"C\xf3digo de barras"}),Object(B.jsx)(Oa.a,{width:200,children:"Nombre"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Medida"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Color"}),Object(B.jsx)(Oa.a,{children:"Precio"}),t&&"compra"===t?Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Existente"}):null,Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Cantidad"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Editar"})]})}),Object(B.jsx)(xa.a,{children:i.map((function(e,c){return Object(B.jsx)(w_,{producto:e,index:c,from:t,setOnUpdate:a,onUpdate:n},c)}))})]})})})})}var w_=function(e){var t=e.producto,a=e.index,n=e.from,c=e.setOnUpdate,r=e.onUpdate,i=Object(l.useContext)(fe),o=i.presentaciones,s=i.setPresentaciones,d=i.preciosP,j=i.precios,u=Object(l.useState)(!0),m=Object(g.a)(u,2),O=m[0],x=m[1],h=S_(),_=Object(l.useRef)(null),f=Object(da.a)(o).sort((function(e,t){return y_(e,t)})),v=Object(b.a)({},f[a]),C=Object(b.a)({},t);n&&"compra"===n&&(C.cantidad=0);var y=function(e){var t=e.target,n=t.value,c=t.name;if(console.log(c),"cantidad"===c){if(!n)return v.cantidad="",v.existencia=!1,f.splice(a,1,v),void s(f);v.cantidad=parseFloat(n),v.existencia=!0}else if("precio"===c){var r=j.iva,i=j.ieps;if(!n)return v.precio="",f.splice(a,1,v),void s(f);var o=parseFloat(n),l=r<10?"0".concat(r):r,d=i<10?"0".concat(i):i,u=parseFloat("0.".concat(l))+parseFloat("0.".concat(d)),b=parseFloat((o/(u+1)).toFixed(2)),p=parseFloat((b*parseFloat("0.".concat(l))).toFixed(2)),m=parseFloat((b*parseFloat("0.".concat(d))).toFixed(2)),O=j.unidad_de_compra.precio_unitario_sin_impuesto,x=parseFloat(((b-O)/O*100).toFixed(2));v.precio_unidad.precio_venta=b,v.precio_unidad.precio_neto=o,v.precio_unidad.utilidad=x,v.precio_unidad.iva_precio=p,v.precio_unidad.ieps_precio=m,v.precio=parseFloat(n)}else{if(!n)return v.codigo_barras="",f.splice(a,1,v),void s(f);v.codigo_barras=n}f.splice(a,1,v),s(f)},S=function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();v.codigo_barras=t,f.splice(a,1,v),s(f)},F=function(){O?(x(!O),c([].concat(Object(da.a)(r),[a]))):(C.cantidad||(v.cantidad=0),C.precio||(v.precio=d[0].precio_neto),f.splice(a,1,v),s(f),x(!0),r.splice(r.length-1,1),c(Object(da.a)(r)))};return Object(B.jsxs)(ma.a,{hover:!0,selected:!O,className:h.tableRow,children:[Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)(Me.a,{checked:C.existencia,color:"primary"})}),Object(B.jsx)(Oa.a,{width:220,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(Ya.a,{inputRef:_,onChange:function(e){return y(e)},value:C.codigo_barras,type:"number",name:"precio",disabled:!C.nuevo||O}),C.nuevo||C.nuevo?Object(B.jsx)(X.a,{color:"primary",size:"small",onClick:function(){return S()},children:Object(B.jsx)(ga.a,{})}):null]})}),Object(B.jsx)(Oa.a,{width:200,children:C.nombre_comercial}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:C.medida._id?Object(B.jsx)(Qa.a,{label:C.medida.talla,color:"primary"}):""}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:C.color._id?Object(B.jsx)(ha.a,{title:C.color.nombre,placement:"top",arrow:!0,TransitionComponent:Xa.a,children:Object(B.jsx)("div",{className:h.colorContainer,style:{backgroundColor:C.color.hex}})}):null}),Object(B.jsx)(Oa.a,{width:110,children:Object(B.jsx)(Ya.a,{inputRef:_,onChange:function(e){return y(e)},disabled:O,value:C.precio,type:"tel",name:"precio"})}),n&&"compra"===n?Object(B.jsx)(Oa.a,{padding:"checkbox",children:t.cantidad}):null,Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(Ya.a,{inputRef:_,onChange:function(e){return y(e)},disabled:O,value:C.cantidad,type:"tel",name:"cantidad"})}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(X.a,{size:"small",onClick:function(){return F()},children:O?Object(B.jsx)(en.a,{}):Object(B.jsx)(Pt.a,{})})})]})},I_=Object(k.a)((function(e){return{colorContainer:{border:"1px solid rgba(0,0,0, .3)",display:"flex",justifyContent:"center",alignItems:"center",height:50,width:50,margin:1,borderRadius:"15%",cursor:"pointer"}}})),k_=function(){return Math.floor(9e11*Math.random()+1e11).toString()};function z_(e){var t=e.obtenerConsultasProducto,a=e.refetch,n=(e.datos,e.from),c=Object(l.useContext)(fe),r=c.presentaciones,i=c.datos_generales,o=t.colores,s=t.tallas,d=t.calzados,j=Object(l.useState)([]),u=Object(g.a)(j,2),b=u[0],m=u[1],O=Object(l.useState)([]),x=Object(g.a)(O,2),h=x[0],_=x[1],f="ROPA"===i.tipo_producto?Object(da.a)(s):Object(da.a)(d),v=Object(l.useState)([]),C=Object(g.a)(v,2),y=C[0],F=C[1],w=Object(l.useCallback)((function(){var e=[],t=[];Object(da.a)(r).forEach((function(a){a.color._id&&e.push(a.color),a.medida._id&&t.push(a.medida)}));var a={},n={},c=e.filter((function(e){var t=!a[e._id];return a[e._id]=!0,t})),i=t.filter((function(e){var t=!n[e._id];return n[e._id]=!0,t}));_(Object(da.a)(c)),m(Object(da.a)(i))}),[r]);return Object(l.useEffect)((function(){w()}),[w]),Object(B.jsx)("div",{children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:9,children:Object(B.jsx)(F_,{from:n,setOnUpdate:F,onUpdate:y})}),Object(B.jsxs)($e.a,{item:!0,md:3,children:[Object(B.jsxs)(p.a,{width:"100%",my:2,style:y.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(B.jsx)(S.a,{children:"ROPA"===i.tipo_producto?"Talla":"N\xfamero"}),Object(B.jsx)(Gn,{setMedidasSeleccionadas:m,refetch:a}),Object(B.jsx)($e.a,{container:!0,children:f.map((function(e,t){return Object(B.jsx)(N_,{talla:e,coloresSeleccionados:h,medidasSeleccionadas:b,setMedidasSeleccionadas:m},t)}))})]}),Object(B.jsx)(Le.a,{}),Object(B.jsxs)(p.a,{width:"100%",mt:1,style:y.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(B.jsx)(S.a,{children:"Color"}),Object(B.jsx)(Ln,{refetch:a}),Object(B.jsx)($e.a,{container:!0,children:o.map((function(e,t){return Object(B.jsx)(P_,{color:e,coloresSeleccionados:h,setColoresSeleccionados:_,medidasSeleccionadas:b},t)}))})]})]})]})})}var N_=function(e){var t=e.talla,a=e.coloresSeleccionados,n=e.medidasSeleccionadas,c=e.setMedidasSeleccionadas,r=I_(),i=Object(Se.a)(),o=Object(l.useContext)(fe),s=o.setPresentaciones,d=o.presentaciones,j=o.datos_generales,u=o.preciosP,b=o.precios,p=o.presentaciones_eliminadas,m=o.setPresentacionesEliminadas,O=Object(l.useState)(!1),x=Object(g.a)(O,2),h=x[0],_=x[1];return Object(B.jsx)($e.a,{item:!0,children:Object(B.jsx)("div",{className:r.colorContainer,onClick:function(){return function(e){var r=Object(da.a)(n);h?r.forEach((function(a,n){a._id===t._id&&(r.splice(n,1),_(e),d.forEach((function(e){e.nuevo||e.medida._id===a._id&&m([].concat(Object(da.a)(p),[e]))})))})):(r.push(t),_(e));var i=[],o=Object(da.a)(d),l=b.iva,O=b.ieps;if(a.length||o.length){if(!a.length&&o.length>0)for(var x=function(e){var t=r[e],a=o.filter((function(e){return e.medida._id===t._id})),n=l<10?"0".concat(l):l,c=O<10?"0".concat(O):O,s=parseFloat((u[0].precio_venta*parseFloat("0.".concat(n))).toFixed(2)),d=parseFloat((u[0].precio_venta*parseFloat("0.".concat(c))).toFixed(2));a.length?i.push(a[0]):i.push({_id:"",existencia:!1,codigo_barras:k_(),nombre_comercial:j.nombre_comercial,medida:t,color:{nombre:"",hex:""},precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:s,ieps_precio:d,utilidad:u[0].utilidad,unidad_maxima:!1}})},f=0;f<r.length;f++)x(f);else if(a.length>0&&1===r.length&&e)for(var g=0;g<o.length;g++)for(var v=0;v<r.length;v++)i.push({_id:"",existencia:o[g].existencia,codigo_barras:o[g].codigo_barras,nombre_comercial:o[g].nombre_comercial,medida:r[v],color:o[g].color,precio:o[g].precio,cantidad:o[g].cantidad,nuevo:!0,precio_unidad:o[g].precio_unidad});else if(a.length>0&&r.length>0)for(var C=function(e){for(var t=r[e],n=function(e){var n=a[e],c=o.filter((function(e){return e.medida._id===t._id&&n._id===e.color._id})),r=l<10?"0".concat(l):l,s=O<10?"0".concat(O):O,d=parseFloat((u[0].precio_venta*parseFloat("0.".concat(r))).toFixed(2)),b=parseFloat((u[0].precio_venta*parseFloat("0.".concat(s))).toFixed(2));c.length?i.push(c[0]):i.push({_id:"",existencia:!1,codigo_barras:k_(),nombre_comercial:j.nombre_comercial,medida:t,color:n,precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:d,ieps_precio:b,utilidad:u[0].utilidad,unidad_maxima:!1}})},c=0;c<a.length;c++)n(c)},y=0;y<r.length;y++)C(y);else if(a.length>0&&!r.length&&o.filter((function(e){return e.medida._id})).length)for(var S=0;S<o.length;S++){var F=o[S];i.push({_id:F._id,existencia:F.existencia,codigo_barras:F.codigo_barras,nombre_comercial:F.nombre_comercial,medida:{},color:F.color,precio:F.precio,cantidad:F.cantidad,nuevo:!0,precio_unidad:F.precio_unidad})}}else for(var w=0;w<r.length;w++){var I=r[w],k=l<10?"0".concat(l):l,z=O<10?"0".concat(O):O,N=parseFloat((u[0].precio_venta*parseFloat("0.".concat(k))).toFixed(2)),P=parseFloat((u[0].precio_venta*parseFloat("0.".concat(z))).toFixed(2));i.push({_id:"",existencia:!1,codigo_barras:k_(),nombre_comercial:j.nombre_comercial,medida:I,color:{nombre:"",hex:""},precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:N,ieps_precio:P,utilidad:u[0].utilidad,unidad_maxima:!1}})}c(Object(da.a)(r)),s(i)}(!h)},style:h?{backgroundColor:i.palette.primary.main}:null,children:Object(B.jsx)(S.a,{variant:"button",style:{color:i.palette.getContrastText(h?i.palette.primary.main:"#FFFFFF"),fontSize:16},children:t.talla})})})},P_=function(e){var t=e.color,a=e.coloresSeleccionados,n=e.setColoresSeleccionados,c=e.medidasSeleccionadas,r=(e.datos,I_()),i=Object(Se.a)(),o=Object(l.useContext)(fe),s=o.presentaciones,d=o.setPresentaciones,j=o.datos_generales,u=o.preciosP,b=o.precios,p=o.presentaciones_eliminadas,m=o.setPresentacionesEliminadas,O=Object(l.useState)(!1),x=Object(g.a)(O,2),h=x[0],_=x[1];return Object(B.jsx)($e.a,{item:!0,children:Object(B.jsx)(ha.a,{title:t.nombre,placement:"top",arrow:!0,TransitionComponent:Xa.a,children:Object(B.jsx)("div",{className:r.colorContainer,style:{backgroundColor:t.hex,color:i.palette.getContrastText(t.hex)},onClick:function(){return function(e){h?a.forEach((function(n,c){n._id===t._id&&(a.splice(c,1),_(e),s.forEach((function(e){e.nuevo||e.color._id===n._id&&m([].concat(Object(da.a)(p),[e]))})))})):(a.push(t),_(e));var r=[],i=Object(da.a)(s),o=b.iva,l=b.ieps;if(c.length||i.length){if(!c.length&&i.length>0)for(var O=function(e){var t=a[e],n=i.filter((function(e){return e.color._id===t._id})),c=o<10?"0".concat(o):o,s=l<10?"0".concat(l):l,d=parseFloat((u[0].precio_venta*parseFloat("0.".concat(c))).toFixed(2)),b=parseFloat((u[0].precio_venta*parseFloat("0.".concat(s))).toFixed(2));n.length?r.push(n[0]):r.push({_id:"",existencia:!1,codigo_barras:k_(),nombre_comercial:j.nombre_comercial,medida:{},color:t,precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:d,ieps_precio:b,utilidad:u[0].utilidad,unidad_maxima:!1}})},x=0;x<a.length;x++)O(x);else if(c.length>0&&1===a.length&&e)for(var f=0;f<i.length;f++)for(var g=0;g<a.length;g++)r.push({_id:"",existencia:i[f].existencia,codigo_barras:i[f].codigo_barras,nombre_comercial:i[f].nombre_comercial,medida:i[f].medida,color:a[g],precio:i[f].precio,cantidad:i[f].cantidad,nuevo:!0,precio_unidad:i[f].precio_unidad});else if(c.length>0&&a.length>0)for(var v=function(e){for(var t=a[e],n=function(e){var a=c[e],n=i.filter((function(e){return e.medida._id===a._id&&t._id===e.color._id})),s=o<10?"0".concat(o):o,d=l<10?"0".concat(l):l,b=parseFloat((u[0].precio_venta*parseFloat("0.".concat(s))).toFixed(2)),p=parseFloat((u[0].precio_venta*parseFloat("0.".concat(d))).toFixed(2));n.length?r.push(n[0]):r.push({_id:"",existencia:!1,codigo_barras:k_(),nombre_comercial:j.nombre_comercial,medida:a,color:t,precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:b,ieps_precio:p,utilidad:u[0].utilidad,unidad_maxima:!1}})},s=0;s<c.length;s++)n(s)},C=0;C<a.length;C++)v(C);else if(c.length>0&&!a.length&&i.filter((function(e){return e.color._id})).length)for(var y=0;y<i.length;y++){var S=i[y];r.push({_id:S._id,existencia:S.existencia,codigo_barras:S.codigo_barras,nombre_comercial:S.nombre_comercial,medida:S.medida,color:{nombre:"",hex:""},precio:S.precio,cantidad:S.cantidad,nuevo:!0,precio_unidad:S.precio_unidad})}}else for(var F=0;F<a.length;F++){var w=a[F],I=o<10?"0".concat(o):o,k=l<10?"0".concat(l):l,z=parseFloat((u[0].precio_venta*parseFloat("0.".concat(I))).toFixed(2)),N=parseFloat((u[0].precio_venta*parseFloat("0.".concat(k))).toFixed(2));r.push({_id:"",existencia:!1,codigo_barras:k_(),nombre_comercial:j.nombre_comercial,medida:{},color:w,precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:z,ieps_precio:N,utilidad:u[0].utilidad,unidad_maxima:!1}})}n(Object(da.a)(a)),d(r)}(!h)},children:h?Object(B.jsx)(Dt.a,{}):null})})})},D_=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),E_=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(.5),"px")},"& .obligatorio":{color:"red"},paddingTop:0,alignItems:"center",justifyItems:"center"}}}));function A_(){var e=E_(),t=Object(Gi.a)(),a=Object(l.useContext)(o_).setAlert,n=Object(l.useContext)(O_),c=n.departamentos,r=n.abrirPanelAcceso,i=n.setAbrirPanelAcceso,o=n.setReloadProductoRapido,s=n.setReloadAdministrador,d=n.setReloadCancelarVenta,j=n.setReloadVerPrecios,u=n.setReloadVerPreCorte,m=n.setReloadEliminarVentaEspera,O=n.setReloadCrearCotizacion,x=Object(l.useState)([]),h=Object(g.a)(x,2),v=h[0],y=h[1],I=Object(l.useState)(!1),k=Object(g.a)(I,2),z=k[0],N=k[1],P=function(){var e=Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y([]),i(!1);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(e){y(Object(b.a)(Object(b.a)({},v),{},Object(_.a)({},e.target.name,e.target.value)))},E={numero_usuario:parseInt(v.numero_usuario),password:v.password,departamento:c.departamento,subDepartamento:c.subDepartamento,tipo_acceso:c.tipo_acceso},A=function(){var e=Object(f.a)(C.a.mark((function e(){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,N(!0),e.next=4,t.query({query:W,variables:{input:E},fetchPolicy:"network-only"});case 4:n=e.sent,console.log(n),!0===n.data.obtenerAccesoPermiso.permiso_concedido&&(T(n.data.obtenerAccesoPermiso.subDepartamento),a({message:"Permiso Autorizado",status:"success",open:!0}),y([]),i(!1),N(!1)),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),N(!1),e.t0.message&&a({message:e.t0.message,status:"error",open:!0});case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),T=function(e){switch(e){case"administrador":s(!0);break;case"producto_rapido":o(!0);break;case"cancelar_venta":d(!0);break;case"precios_productos":j(!0);break;case"pre_corte":u(!0);break;case"cotizaciones":O(!0);break;case"eliminar_ventas":m(!0);break;default:a({message:"Permiso no autorizado",status:"error",open:!0})}};return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)(Ee.a,{maxWidth:"xs",open:r,onClose:P,TransitionComponent:D_,children:[Object(B.jsx)(He,{loading:z}),Object(B.jsxs)(p.a,{p:3,children:[Object(B.jsxs)(p.a,{display:"flex",p:1,children:[Object(B.jsx)(p.a,{flexGrow:1,children:Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Por favor autoriza con tu usuario y contrase\xf1a"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){return P()},size:"medium",children:Object(B.jsx)(We.a,{})})})]}),Object(B.jsx)("div",{className:e.formInputFlex,children:Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Numero Usuario:"})}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(F.a,{fullWidth:!0,name:"numero_usuario",size:"small",variant:"outlined",onChange:D})})]})}),Object(B.jsx)("div",{className:e.formInputFlex,children:Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Contrasena:"})}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",type:"password",name:"password",variant:"outlined",onChange:D})})]})})]}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{color:"primary",size:"medium",variant:"contained",onClick:function(){return A()},children:"Guardar"})})]})})}var T_=["children","value","index"];function W_(e){var t=e.children,a=e.value,n=e.index,c=Object(ve.a)(e,T_);return Object(B.jsx)("div",Object(b.a)(Object(b.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(B.jsx)(p.a,{p:3,height:"70vh",children:t})}))}function $_(e){return{id:"reg-product-tab-".concat(e),"aria-controls":"tabpanel-reg-product-".concat(e)}}var R_=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},iconSizeDialogs:{width:80},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper},iconSvg:{width:50},dialogContent:{padding:0},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},iconSizeSecondSuperior:{width:20}}})),V_=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function M_(){var e=R_(),t=Object(l.useState)(0),a=Object(g.a)(t,2),n=a[0],c=a[1],r=Object(l.useState)(!1),i=Object(g.a)(r,2),o=i[0],s=i[1],d=Object(l.useContext)(fe),j=d.datos_generales,u=d.setDatosGenerales,m=d.precios,O=d.setPrecios,x=d.validacion,h=d.setValidacion,_=d.setPreciosP,v=d.preciosP,y=d.setUnidadesVenta,F=d.unidadVentaXDefecto,k=d.setUnidadVentaXDefecto,N=d.unidadVentaSecundaria,P=d.setUnidadVentaSecundaria,D=d.setCentroDeCostos,E=d.presentaciones,A=d.setPresentaciones,T=Object(l.useContext)(o_),W=T.setAlert,$=T.open,R=T.setOpen,V=Object(l.useContext)(O_),M=V.reloadProductoRapido,L=V.setReloadProductoRapido,U=V.setAbrirPanelAcceso,q=V.setDepartamentos,J=JSON.parse(localStorage.getItem("sesionCafi")),G=JSON.parse(localStorage.getItem("turnoEnCurso")),H=Object(z.a)(Tn),Y=Object(g.a)(H,1)[0],K=Object(qe.a)(kn,{variables:{empresa:J.empresa._id,sucursal:J.sucursal._id}}),Q=K.data,X=K.refetch,Z=K.loading,ee=K.error,te=function(){u(ce),O(re),k(ie),P(oe),_(se),y([]),D({}),h({error:!1,message:""}),A([]),c(0)},ae=Object(l.useState)(!1),ne=Object(g.a)(ae,2),le=ne[0],de=ne[1],je=Object(l.useState)(0),ue=Object(g.a)(je,2),be=ue[0],pe=ue[1],me=function(){R(!$),te(),de(!1)},Oe=function(){!0===J.accesos.ventas.producto_rapido.ver?me():(U(!0),q({departamento:"ventas",subDepartamento:"producto_rapido",tipo_acceso:"ver"}))};if(Object(l.useEffect)((function(){!0===M&&(me(),L(!1))}),[M]),Object(l.useEffect)((function(){return function(){X()}}),[]),window.addEventListener("keydown",(function(e){e.altKey&&82===e.keyCode&&Oe()})),Z|!Q||ee)return Object(B.jsx)(w.a,{disabled:!0,value:"articulo-rapido",style:{textTransform:"none",height:"100%",width:"100%",pointerEvents:"none",opacity:.5},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/tiempo-rapido.svg",alt:"icono caja2",className:e.iconSizeSecondSuperior})}),Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Producto Rapido"})}),Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"Alt + R"})})]})});var xe=Q.obtenerConsultasProducto,he=function(){var e=Object(f.a)(C.a.mark((function e(){var t,a,n,c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s(!0),!("OTROS"===j.tipo_producto&&be<1)){e.next=5;break}return e.abrupt("return",h(!0));case 5:if(j.clave_alterna&&j.tipo_producto&&j.nombre_generico&&j.nombre_comercial&&m.precio_de_compra.precio_con_impuesto&&m.precio_de_compra.precio_sin_impuesto&&m.unidad_de_compra.cantidad){e.next=7;break}return e.abrupt("return",h(!0));case 7:return t=[Object(b.a)({},F),Object(b.a)({},N)],m.precios_producto=v,"OTROS"===j.tipo_producto&&be<1&&(A(_e),pe(0)),e.next=12,$i(j,"datos_generales");case 12:return e.t0=e.sent,e.t1=m,e.next=16,$i(t,"unidades_de_venta");case 16:return e.t2=e.sent,e.t3=E,e.t4=be,e.t5=J.empresa._id,e.t6=J.sucursal._id,e.t7=J._id,a={datos_generales:e.t0,precios:e.t1,unidades_de_venta:e.t2,presentaciones:e.t3,cantidad:e.t4,empresa:e.t5,sucursal:e.t6,usuario:e.t7},e.prev=23,n=wa(a),e.next=27,Y({variables:{input:n}});case 27:c=e.sent,te(),X(),W({message:"\xa1Listo ".concat(c.data.crearProductoRapido.message,"!"),status:"success",open:!0}),s(!1),me(),e.next=44;break;case 35:e.prev=35,e.t8=e.catch(23),te(),X(),W({message:"Error: ".concat(e.t8.message),status:"error",open:!0}),s(!1),me(),console.log(e.t8),e.t8.networkError?console.log(e.t8.networkError.result):e.t8.graphQLErrors&&console.log(e.t8.graphQLErrors);case 44:case"end":return e.stop()}}),e,null,[[23,35]])})));return function(){return e.apply(this,arguments)}}(),ge=Object(B.jsx)(w.a,{variant:"contained",color:"primary",onClick:function(){return he()},size:"large",startIcon:Object(B.jsx)(Ha.a,{}),disabled:"OTROS"===j.tipo_producto?!(j.clave_alterna&&j.tipo_producto&&j.nombre_generico&&j.nombre_comercial&&be&&m.precio_de_compra.precio_con_impuesto&&m.precio_de_compra.precio_sin_impuesto&&m.unidad_de_compra.cantidad):!(j.clave_alterna&&j.tipo_producto&&j.nombre_generico&&j.nombre_comercial&&m.precio_de_compra.precio_con_impuesto&&m.precio_de_compra.precio_sin_impuesto&&m.unidad_de_compra.cantidad),children:"Guardar"}),ve=function(){return 1===n?ge:"OTROS"!==j.tipo_producto&&j.tipo_producto?Object(B.jsx)(w.a,{variant:"contained",color:"primary",onClick:function(){return c(n+1)},size:"large",endIcon:Object(B.jsx)(Ti.a,{}),disableElevation:!0,children:"Siguiente"}):ge};return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(A_,{}),Object(B.jsx)(w.a,{onClick:function(){Oe()},value:"articulo-rapido",style:{textTransform:"none",height:"100%",width:"100%"},disabled:!G,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/tiempo-rapido.svg",alt:"icono caja2",className:e.iconSizeSecondSuperior})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Producto Rapido"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"Alt + R"})})})]})}),Object(B.jsxs)(Ee.a,{maxWidth:"lg",open:$,onClose:function(e,t){"backdropClick"!==t&&me()},TransitionComponent:V_,children:[Object(B.jsx)(Ie.a,{position:"static",color:"default",elevation:0,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{display:"flex",flexGrow:1,justifyContent:"space-between",children:Object(B.jsxs)(ke.a,{value:n,onChange:function(e,t){c(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:[Object(B.jsx)(ze.a,Object(b.a)({label:"Datos generales",icon:Object(B.jsx)(nc.a,{color:"secondary",badgeContent:Object(B.jsx)(S.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!x.error||!x.vista1,children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/portapapeles.svg",alt:"icono registro",className:e.iconSvg})})},$_(0))),!1===le||"OTROS"===j.tipo_producto?null:Object(B.jsx)(ze.a,Object(b.a)({label:"Tallas y colores",icon:Object(B.jsx)(nc.a,{color:"secondary",badgeContent:Object(B.jsx)(S.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!x.error||!x.vista7,children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/tallas-colores.svg",alt:"icono colores",className:e.iconSvg})})},$_(6)))]})}),Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){me(),te()},size:"large",children:Object(B.jsx)(We.a,{})})})]})}),Object(B.jsxs)(Ae.a,{className:e.dialogContent,children:[Object(B.jsx)(Je.a,{className:e.backdrop,open:o,children:Object(B.jsx)(I.a,{color:"inherit"})}),Object(B.jsxs)("div",{className:e.root,children:[Object(B.jsxs)(W_,{value:n,index:0,children:[Object(B.jsx)(C_,{setAbrirTallaColor:de,setCantidad:pe,cantidad:be,obtenerConsultasProducto:xe,refetch:X}),Object(B.jsx)(La,{})]}),Object(B.jsx)(W_,{value:n,index:1,children:Object(B.jsx)(z_,{obtenerConsultasProducto:xe,refetch:X})})]})]}),Object(B.jsxs)(Ue.a,{style:{display:"flex",justifyContent:"space-between"},children:[Object(B.jsx)(p.a,{p:1,children:Object(B.jsx)(w.a,{variant:"outlined",color:"primary",onClick:function(){return c(n-1)},size:"large",startIcon:Object(B.jsx)(Wi.a,{}),disabled:0===n,children:"Anterior"})}),Object(B.jsx)(p.a,{p:1,children:Object(B.jsx)(ve,{})})]})]})]})}function L_(e){var t=e.handleClickOpen;return Object(B.jsx)(ge,{children:Object(B.jsx)(M_,{handleClickOpen:t})})}var U_,B_,q_=a(254),J_=a.n(q_),G_=Object(P.d)(U_||(U_=Object(N.a)(["\n  mutation crearCotizacion(\n    $input: CrearVentasInput!\n    $empresa: ID!\n    $sucursal: ID!\n    $usuario: ID!\n    $caja: ID!\n  ) {\n    crearCotizacion(\n      input: $input\n      empresa: $empresa\n      sucursal: $sucursal\n      usuario: $usuario\n      caja: $caja\n    ) {\n      message\n    }\n  }\n"]))),H_=Object(P.d)(B_||(B_=Object(N.a)(["\n  query obtenerCotizaciones($empresa: ID!, $sucursal: ID!) {\n    obtenerCotizaciones(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      folio\n      descuento\n      ieps\n      impuestos\n      iva\n      monedero\n      subTotal\n      total\n      venta_cliente\n      credito\n      descuento_general {\n        cantidad_descontado\n        porciento\n        precio_con_descuento\n      }\n      descuento_general_activo\n      dias_de_credito_venta\n      fecha_de_vencimiento_credito\n      fecha_vencimiento_cotizacion\n      cliente {\n        _id\n        numero_cliente\n        clave_cliente\n        nombre_cliente\n        rfc\n        telefono\n        celular\n        email\n        razon_social\n      }\n      productos {\n        _id\n         inventario_general {\n            cantidad_existente\n            unidad_inventario\n            codigo_unidad\n            cantidad_existente_maxima\n            unidad_maxima\n            id_almacen_general\n          }\n        iva_total_producto\n        ieps_total_producto\n        impuestos_total_producto\n        subtotal_total_producto\n        total_total_producto  \n        id_producto {\n          _id\n          datos_generales {\n            codigo_barras\n            clave_alterna\n            tipo_producto\n            nombre_comercial\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat {\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n         \n          precios {\n            ieps\n            ieps_activo\n            inventario {\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n              codigo_unidad\n            }\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            precio_de_compra {\n              precio_con_impuesto\n              precio_sin_impuesto\n              iva\n              ieps\n            }\n            precios_producto {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n            unidad_de_compra {\n              cantidad\n              precio_unitario_con_impuesto\n              precio_unitario_sin_impuesto\n              unidad\n              codigo_unidad\n            }\n           \n          }\n          imagenes {\n            url_imagen\n            location_imagen\n            key_imagen\n            extencion_imagen\n          }\n        \n         \n          \n         \n          \n        }\n        concepto\n        cantidad\n        medida {\n          _id\n          talla\n          tipo\n        }\n        color {\n          _id\n          nombre\n          hex\n        }\n        cantidad_venta\n        granel_producto {\n          granel\n          valor\n        }\n        precio\n        precio_a_vender\n        precio_actual_producto\n        default\n        unidad\n        codigo_unidad\n        \n        precio_unidad {\n          numero_precio\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          unidad_mayoreo\n          utilidad\n          precio_general\n          cantidad_unidad\n          unidad_maxima\n        }\n        precio_actual_object {\n          cantidad_unidad\n          numero_precio\n          unidad_maxima\n          unidad_mayoreo\n          precio_general\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          utilidad\n          porciento\n          dinero_descontado\n        }\n      \n      }\n      id_caja{\n        _id\n        numero_caja\n        activa\n      }\n      usuario{\n        _id\n        numero_usuario\n        nombre\n      }\n      year_registro\n      numero_semana_year\n      numero_mes_year\n      fecha_registro\n  \n    }\n  }\n"]))),Y_=a(174),K_=a.n(Y_),Q_=a(175),X_=a.n(Q_),Z_=a(176),ef=a.n(Z_),tf=a(476),af=a(326),nf=a.n(af),cf=a(477),rf=a.n(cf),of=Object(k.a)((function(e){return{root:{zIndex:9999,position:"absolute",width:"250mm",minHeight:"210mm",backgroundPosition:"center",backgroundSize:"cover"},nombre:{marginTop:e.spacing(54),marginLeft:e.spacing(61)},textoSecundario:{marginTop:e.spacing(2),marginLeft:e.spacing(55),width:600},firma:{marginTop:e.spacing(12),marginLeft:e.spacing(76)},intructor:{marginTop:e.spacing(1),marginLeft:e.spacing(85)},codigo:{marginTop:e.spacing(1),marginLeft:e.spacing(126)}}}));function sf(e){var t=Object(l.useState)(e.cotizacion),a=Object(g.a)(t,2),n=a[0],c=(a[1],Object(l.useState)(!1)),r=Object(g.a)(c,2),i=r[0],o=r[1],s=of(),d=Object(l.useState)(!1),j=Object(g.a)(d,2),u=(j[0],j[1],Object(l.useState)({open:!1,mensaje:"",status:""})),b=Object(g.a)(u,2);b[0],b[1];Object(l.useEffect)((function(){i&&m()}),[i]);var m=function(){var e=document.getElementById("divInformation");document.getElementById("divTitleProductos");console.log(e),o(!1);var t=new tf.a("p","mm","letter");nf()(e).then((function(e){var a=e.toDataURL("image/png"),c=t.getImageProperties(a),r=t.internal.pageSize.getWidth()-5,i=c.height*r/c.width;t.addImage(a,"JPEG",2,5,r,i),t.addPage(),t.save("cotizacion"+n.folio+".pdf")}))};return Object(B.jsxs)(p.a,{mt:1,children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",m:1,mb:0,children:Object(B.jsx)(w.a,{variant:"outlined",color:"primary",onClick:function(){return o(!0)},startIcon:Object(B.jsx)(rf.a,{}),children:"Descargar PDF"})}),Object(B.jsx)(y.a,{children:i?Object(B.jsx)("div",{children:Object(B.jsx)(lf,{cotizacion:n,classes:s})}):Object(B.jsx)("div",{})})]})}var lf=function(e){var t=e.cotizacion,a=e.classes;return Object(B.jsxs)("div",{id:"divInformation",className:a.root,children:[Object(B.jsx)(p.a,{style:{display:"flex",justifyContent:"space-between"},children:Object(B.jsxs)(p.a,{children:[Object(B.jsxs)(S.a,{align:"right",children:[Object(B.jsx)("b",{children:"Folio:"})," ".concat(t.folio)]}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Fecha:"})," ".concat(Sa(t.fecha_registro))]})]})}),t.cliente?Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Re.a,{children:Object(B.jsx)(K_.a,{size:12})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{size:18,children:"Cliente"})})]}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Numero de Cliente"}),Object(B.jsx)(Oa.a,{children:"Nombre"}),Object(B.jsx)(Oa.a,{children:"Clave"}),Object(B.jsx)(Oa.a,{children:"Telefono"})]})}),Object(B.jsx)(xa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:t.cliente.numero_cliente}),Object(B.jsx)(Oa.a,{children:t.cliente.nombre_cliente}),Object(B.jsx)(Oa.a,{children:t.cliente.clave_cliente}),Object(B.jsx)(Oa.a,{children:t.cliente.telefono})]})})]})})})})]}):null,Object(B.jsxs)(p.a,{my:2,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Re.a,{children:Object(B.jsx)(X_.a,{size:12})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{size:18,children:"Venta"})})]}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Venta Cr\xe9dito"}),Object(B.jsx)(Oa.a,{children:"Descuento"}),Object(B.jsx)(Oa.a,{children:"Monedero"}),Object(B.jsx)(Oa.a,{children:"IVA"}),Object(B.jsx)(Oa.a,{children:"IEPS"}),Object(B.jsx)(Oa.a,{children:"Subtotal"}),Object(B.jsx)(Oa.a,{children:"Impuestos"}),Object(B.jsx)(Oa.a,{children:"Total"})]})}),Object(B.jsx)(xa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:t.credito?"SI":"NO"}),Object(B.jsxs)(Oa.a,{children:["$",t.descuento?Fa(t.descuento):0]}),Object(B.jsxs)(Oa.a,{children:["$",t.monedero?Fa(t.monedero):0]}),Object(B.jsxs)(Oa.a,{children:["$",t.iva?Fa(t.iva):0]}),Object(B.jsxs)(Oa.a,{children:["$",t.ieps?Fa(t.ieps):0]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(t.subTotal)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(t.impuestos)]}),Object(B.jsx)(Oa.a,{children:Fa(t.total)})]})})]})})})})]}),Object(B.jsxs)(p.a,{my:2,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Re.a,{children:Object(B.jsx)(ef.a,{size:12})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{size:18,children:"Art\xedculos"})})]}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Producto"}),Object(B.jsx)(Oa.a,{children:"Cant."}),Object(B.jsx)(Oa.a,{children:"Precio"}),Object(B.jsx)(Oa.a,{children:"Desc."}),Object(B.jsx)(Oa.a,{children:"IVA"}),Object(B.jsx)(Oa.a,{children:"IEPS"}),Object(B.jsx)(Oa.a,{children:"SubTotal."}),Object(B.jsx)(Oa.a,{children:"Impues."}),Object(B.jsx)(Oa.a,{children:"Total"})]})}),Object(B.jsx)(xa.a,{children:t.productos.map((function(e,a){return Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:e.id_producto.datos_generales.nombre_comercial}),Object(B.jsx)(Oa.a,{children:e.cantidad_venta}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.precio_a_vender)]}),Object(B.jsx)(df,{producto:t}),Object(B.jsxs)(Oa.a,{children:["$",e.iva_total_producto?Fa(e.iva_total_producto):"0.00"]}),Object(B.jsxs)(Oa.a,{children:["$",e.ieps_total_producto?Fa(e.ieps_total_producto):"0.00"]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.subtotal_total_producto)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.impuestos_total_producto)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.total_total_producto)]})]},a)}))})]})})})})]})]})},df=function(e){var t=e.producto;if(!0===t.descuento_general_activo){var a=t.descuento_general,n=a.dinero_descontado,c=a.porciento;return Object(B.jsx)(Oa.a,{children:"$".concat(Fa(n)," - %").concat(c)})}return Object(B.jsx)(Oa.a,{children:"$0.00"})},jf=Object(k.a)((function(e){return{colorContainer:{height:28,width:28,borderRadius:"15%",fontSize:18,display:"flex",justifyContent:"center",alignItems:"center"}}})),uf=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function bf(e){var t=e.venta,a=e.open,n=e.handleClose;e.refetch;return t?(console.log(t),Object(B.jsxs)(Ee.a,{open:a,TransitionComponent:uf,keepMounted:!0,onClose:n,fullWidth:!0,maxWidth:"xl",children:[Object(B.jsxs)(wt.a,{children:[Object(B.jsxs)(p.a,{style:{display:"flex",justifyContent:"space-between"},children:[Object(B.jsxs)(p.a,{children:[Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Caja: "})," ".concat(t.id_caja.numero_caja)]}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Usuario en caja:"})," "," ".concat(t.usuario.nombre)]})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsxs)(S.a,{align:"right",children:[Object(B.jsx)("b",{children:"Folio:"})," ".concat(t.folio)]}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Fecha:"})," ".concat(Sa(t.fecha_registro))]})]})]}),Object(B.jsx)(p.a,{style:{display:"flex",justifyContent:"flex-end"},children:Object(B.jsx)(sf,{isIcon:!1,cotizacion:t})})]}),Object(B.jsxs)(Ae.a,{children:[t.cliente?Object(B.jsxs)(p.a,{my:1,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Re.a,{children:Object(B.jsx)(K_.a,{})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"h6",children:"Cliente"})})]}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Numero de Cliente"}),Object(B.jsx)(Oa.a,{children:"Nombre"}),Object(B.jsx)(Oa.a,{children:"Clave"}),Object(B.jsx)(Oa.a,{children:"Telefono"})]})}),Object(B.jsx)(xa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:t.cliente.numero_cliente}),Object(B.jsx)(Oa.a,{children:t.cliente.nombre_cliente}),Object(B.jsx)(Oa.a,{children:t.cliente.clave_cliente}),Object(B.jsx)(Oa.a,{children:t.cliente.telefono})]})})]})})})})]}):null,Object(B.jsxs)(p.a,{my:2,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Re.a,{children:Object(B.jsx)(X_.a,{})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"h6",children:"Venta"})})]}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Venta Cr\xe9dito"}),Object(B.jsx)(Oa.a,{children:"Descuento"}),Object(B.jsx)(Oa.a,{children:"Monedero"}),Object(B.jsx)(Oa.a,{children:"IVA"}),Object(B.jsx)(Oa.a,{children:"IEPS"}),Object(B.jsx)(Oa.a,{children:"Subtotal"}),Object(B.jsx)(Oa.a,{children:"Impuestos"}),Object(B.jsx)(Oa.a,{children:"Total"})]})}),Object(B.jsx)(xa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:t.credito?"SI":"NO"}),Object(B.jsxs)(Oa.a,{children:["$",t.descuento?Fa(t.descuento):0]}),Object(B.jsxs)(Oa.a,{children:["$",t.monedero?Fa(t.monedero):0]}),Object(B.jsxs)(Oa.a,{children:["$",t.iva?Fa(t.iva):0]}),Object(B.jsxs)(Oa.a,{children:["$",t.ieps?Fa(t.ieps):0]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(t.subTotal)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(t.impuestos)]}),Object(B.jsx)(Oa.a,{children:Fa(t.total)})]})})]})})})})]}),Object(B.jsxs)(p.a,{my:2,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Re.a,{children:Object(B.jsx)(ef.a,{})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"h6",children:"Art\xedculos"})})]}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"C\xf3digo de barras"}),Object(B.jsx)(Oa.a,{children:"Producto"}),Object(B.jsx)(Oa.a,{children:"Medida"}),Object(B.jsx)(Oa.a,{children:"Unidad"}),Object(B.jsx)(Oa.a,{children:"Cantidad"}),Object(B.jsx)(Oa.a,{children:"Precio"}),Object(B.jsx)(Oa.a,{children:"Descuento"}),Object(B.jsx)(Oa.a,{children:"IVA"}),Object(B.jsx)(Oa.a,{children:"IEPS"}),Object(B.jsx)(Oa.a,{children:"Subtotal"}),Object(B.jsx)(Oa.a,{children:"Impuestos"}),Object(B.jsx)(Oa.a,{children:"Total"})]})}),Object(B.jsx)(xa.a,{children:t.productos.map((function(e,a){return Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:e.id_producto.datos_generales.codigo_barras}),Object(B.jsx)(Oa.a,{children:e.id_producto.datos_generales.nombre_comercial}),Object(B.jsx)(pf,{producto:e}),Object(B.jsx)(Oa.a,{children:e.unidad}),Object(B.jsx)(Oa.a,{children:e.cantidad_venta}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.precio_a_vender)]}),Object(B.jsx)(mf,{producto:t}),Object(B.jsxs)(Oa.a,{children:["$",e.iva_total_producto?Fa(e.iva_total_producto):"0.00"]}),Object(B.jsxs)(Oa.a,{children:["$",e.ieps_total_producto?Fa(e.ieps_total_producto):"0.00"]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.subtotal_total_producto)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.impuestos_total_producto)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.total_total_producto)]})]},a)}))})]})})})})]})]})]})):null}var pf=function(e){var t=e.producto,a=jf(),n=Object(Se.a)();return t.color.nombre&&t.medida.talla?Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)(ha.a,{title:t.color.nombre,placement:"top",arrow:!0,children:Object(B.jsx)("div",{className:a.colorContainer,style:{backgroundColor:t.color.hex,color:n.palette.getContrastText(t.color.hex)},children:t.medida.talla})})}):Object(B.jsx)(Oa.a,{align:"center",children:"N/A"})},mf=function(e){var t=e.producto;if(!0===t.descuento_general_activo){var a=t.descuento_general,n=a.dinero_descontado,c=a.porciento;return Object(B.jsx)(Oa.a,{children:"$".concat(Fa(n)," - %").concat(c)})}return Object(B.jsx)(Oa.a,{children:"$0.00"})},Of=[{id:"folio",label:"Folio",minWidth:20,align:"center"},{id:"cliente",label:"Cliente",minWidth:100},{id:"fecha",label:"Fecha",minWidth:80,align:"center"},{id:"fechaVencimiento",label:"Fecha de vencimiento",minWidth:60,align:"center"},{id:"productos",label:"Productos",minWidth:50,align:"center"},{id:"total",label:"Total",minWidth:50,align:"center"}],xf=Object(k.a)({root:{width:"100%"},container:{maxHeight:"55vh"}});function hf(e){var t=e.setOpen,a=xf(),n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)(""),d=Object(g.a)(s,2),j=d[0],u=d[1],b=Object(qe.a)(H_,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id}}),p=b.data,m=b.refetch,O=b.loading;Object(l.useEffect)((function(){try{m()}catch(e){}}),[]);var x=[],h=function(){t(!1)};return p&&(x=p.obtenerCotizaciones),O?Object(B.jsx)(He,{loading:O}):Object(B.jsx)(Ka.a,{className:a.root,children:Object(B.jsxs)(ba.a,{className:a.container,children:[Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"medium","aria-label":"enhanced table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Of.map((function(e){return Object(B.jsx)(Oa.a,{align:e.align,style:{width:e.minWidth},children:e.label},e.id)})),Object(B.jsx)(Oa.a,{align:"center",style:{width:35},children:"Retomar"})]})}),Object(B.jsx)(xa.a,{children:x.map((function(e){return Object(B.jsx)(_f,{cotizacion:e,handleModalCotizacion:h,setView:o,setSelected:u})}))})]}),Object(B.jsx)(bf,{venta:j,open:i,handleClose:function(){o(!1)},refetch:m})]})})}var _f=function(e){var t=e.cotizacion,a=(e.index,e.handleModalCotizacion),n=e.setSelected,c=e.setView,r=Object(l.useState)({message:"",open:!1}),i=Object(g.a)(r,2),o=i[0],s=i[1],d=JSON.parse(localStorage.getItem("DatosVentas")),j=Object(l.useContext)(o_),u=j.updateTablaVentas,b=j.setUpdateTablaVentas,p=Object(l.useContext)(Xi),m=p.updateClientVenta,O=p.setUpdateClientVenta,x=function(){b(!u),O(!m)};try{return Object(B.jsx)(B.Fragment,{children:Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",tabIndex:-1,onClick:function(e){return function(e){try{2===e&&(console.log(t),n(t),c(!0))}catch(a){}}(e.detail)},children:[Object(B.jsx)(Oa.a,{align:"center",children:t.folio}),Object(B.jsx)(Oa.a,{children:t.cliente.nombre_cliente?t.cliente.nombre_cliente:"P\xfablico general"}),Object(B.jsx)(Oa.a,{align:"center",children:t.fecha_registro}),Object(B.jsx)(Oa.a,{align:"center",children:t.fecha_vencimiento_cotizacion}),Object(B.jsx)(Oa.a,{align:"center",children:t.productos.length}),Object(B.jsx)(Oa.a,{align:"center",children:t.total}),Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)(ff,{AgregarVentaDeNuevo:function(){try{console.log(t.productos);var e=JSON.stringify({cliente:null===t.cliente.nombre_cliente?{}:t.cliente,descuento:t.descuento,ieps:t.ieps,impuestos:t.impuestos,iva:t.iva,monedero:t.monedero,productos:t.productos,subTotal:t.subTotal,total:t.total,venta_cliente:!1,tipo_emision:t.tipo_emision?t.tipo_emision:"TICKET"});if(null===d){if(ht()(t.fecha_vencimiento_cotizacion).isBefore(ht()().format("YYYY MM DD")))return void s({message:"La cotizaci\xf3n seleccionada ya tiene la fecha vencida.",open:!0});localStorage.setItem("DatosVentas",e),a(),x()}else s({message:"No puedes agregar una venta cuando ya est\xe1 una en curso.",open:!0})}catch(n){console.log("agregarVentaDeNuevo",n)}},openMessage:o,handleClickOpen:function(){try{s(!o.open)}catch(e){}}})})]},t.code)})}catch(h){}},ff=function(e){var t=e.openMessage,a=e.handleClickOpen,n=e.AgregarVentaDeNuevo;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(X.a,{"aria-label":"regresar",color:"primary",size:"small",onClick:n,children:Object(B.jsx)(J_.a,{fontSize:"medium"})}),Object(B.jsx)(R.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:t.open,autoHideDuration:5e3,onClose:a,message:t.message,action:Object(B.jsx)(X.a,{size:"small","aria-label":"close",color:"inherit",onClick:a,children:Object(B.jsx)(We.a,{fontSize:"small"})})})]})},gf=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function vf(){var e=Object(l.useState)(!1),t=Object(g.a)(e,2),a=t[0],n=t[1],c=JSON.parse(localStorage.getItem("turnoEnCurso"));return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(w.a,{onClick:function(){n(!a)},style:{textTransform:"none",height:"100%",width:"100%"},disabled:!c,children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Fe.d,{style:{fontSize:25}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Cotizaciones"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"Alt + T"})})})]})}),Object(B.jsxs)(Ee.a,{fullWidth:!0,open:a,maxWidth:"md",onClose:function(){return n(!1)},TransitionComponent:gf,children:[Object(B.jsx)(Ie.a,{position:"static",color:"default",elevation:0,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsxs)(p.a,{display:"flex",flexGrow:1,children:[Object(B.jsx)(p.a,{p:2,display:"flex",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/lista-de-espera.svg",alt:"icono caja2",style:{width:38}})}),Object(B.jsx)(p.a,{p:1,display:"flex",alignItems:"center",children:Object(B.jsx)(S.a,{variant:"h6",children:"Cotizaciones pendientes"})})]}),Object(B.jsx)(p.a,{p:3,pb:0,pt:2,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){return n(!a)},size:"medium",children:Object(B.jsx)(We.a,{})})})]})}),Object(B.jsx)(hf,{setOpen:n})]})]})}var Cf=Object(h.f)((function(e){var t=Object(l.useContext)(o_),a=t.alert,n=t.setAlert,c=Object(l.useContext)(O_),r=c.reloadAdministrador,i=c.setReloadAdministrador,o=c.setAbrirPanelAcceso,s=c.abrirPanelAcceso,d=c.setDepartamentos,j=n_(),u=Object(l.useState)("venta-general"),b=Object(g.a)(u,2),m=b[0],O=b[1],x=JSON.parse(localStorage.getItem("sesionCafi"));return ht.a.locale("es"),Object(l.useEffect)((function(){!0===r&&(e.history.push("/admin"),i(!1))}),[r]),window.addEventListener("keydown",(function(t){112===t.keyCode&&(!0===x.accesos.ventas.administrador.ver?e.history.push("/admin"):(o(!s),d({departamento:"ventas",subDepartamento:"administrador",tipo_acceso:"ver"})))})),Object(B.jsxs)(p.a,{height:"100%",children:[Object(B.jsx)(A_,{setReloadAdministrador:i}),Object(B.jsx)(J,{alert:a,setAlert:n}),Object(B.jsxs)(a_.a,{value:m,onChange:function(e,t){O(t)},className:j.navigationTop,children:[Object(B.jsx)(L_,{}),Object(B.jsx)(Le.a,{orientation:"vertical"}),Object(B.jsx)(vf,{}),Object(B.jsx)(Le.a,{orientation:"vertical"}),Object(B.jsx)(d_,{}),Object(B.jsx)(Le.a,{orientation:"vertical"}),Object(B.jsx)(m_,{}),Object(B.jsx)(Le.a,{orientation:"vertical"}),Object(B.jsx)(__,{}),Object(B.jsx)(Le.a,{orientation:"vertical"}),Object(B.jsx)(g_,{})]})]})})),yf=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Sf(){var e=i_(),t=JSON.parse(localStorage.getItem("turnoEnCurso")),a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=function(){r(!c)};return window.addEventListener("keydown",(function(e){117===e.keyCode&&i()})),Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(w.a,{className:e.borderBotonChico,onClick:i,disabled:!t,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(p.a,{children:Object(B.jsx)(Fe.e,{style:{fontSize:35}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Abonos"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"F6"})})})]})}),Object(B.jsxs)(Ee.a,{maxWidth:"lg",open:c,onClose:i,TransitionComponent:yf,children:[Object(B.jsx)(Ae.a,{children:"Abonitos"}),Object(B.jsx)(Ue.a,{})]})]})}var Ff=[{id:"add",label:"",width:30,align:"center"},{id:"clave",label:"Clave",minWidth:40,align:"center"},{id:"codigo",label:"C. Barras",minWidth:40,align:"center"},{id:"descripcion",label:"Nombre/Descrip.",minWidth:330},{id:"medida-color",label:"Color y Talla",minWidth:200,align:"center"},{id:"existencia",label:"Exist.",minWidth:30,align:"center"},{id:"unidad",label:"Unidad",minWidth:30,align:"center"},{id:"precio",label:"Precio",minWidth:30,align:"center"}],wf=Object(k.a)({root:{width:"100%",marginTop:15,marginBottom:15},container:{height:"40vh"},colorContainer:{height:28,width:28,borderRadius:"15%",fontSize:18,display:"flex",justifyContent:"center",alignItems:"center"}});function If(e){var t=e.productosBusqueda,a=e.setProductoSeleccionado,n=e.productoSeleccionado,c=e.loading,r=e.agregarProductos,i=wf();if(c)return Object(B.jsx)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"50vh",children:Object(B.jsx)(I.a,{})});var o=function(e,t){if(2===e.detail||"button"===e)return a(t),void r(t);a(t)};return Object(B.jsx)(Ka.a,{className:i.root,children:Object(B.jsx)(ba.a,{className:i.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsx)(ma.a,{children:Ff.map((function(e){return Object(B.jsx)(Oa.a,{align:e.align,style:{width:e.minWidth},children:e.label},e.id)}))})}),Object(B.jsx)(xa.a,{children:null===t||void 0===t?void 0:t.map((function(e,t){return Object(B.jsx)(kf,{producto:e,handleTableSelect:o,productoSeleccionado:n},t)}))})]})})})}function kf(e){var t=e.producto,a=e.handleTableSelect,n=e.productoSeleccionado,c=wf(),r=Object(Se.a)();try{var i=function(){return t.color&&t.medida?Object(B.jsx)(Oa.a,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"56px"},children:Object(B.jsx)(ha.a,{title:t.color.nombre,placement:"top",arrow:!0,children:Object(B.jsx)("div",{className:c.colorContainer,style:{backgroundColor:t.color.hex,color:r.palette.getContrastText(t.color.hex)},children:t.medida.talla})})}):Object(B.jsx)(Oa.a,{align:"center",children:"N/A"})},o=function(){var e="";return e="OTROS"===t.id_producto.datos_generales.tipo_producto?"Costal"===t.unidad||"Caja"===t.unidad?t.inventario_general[0].cantidad_existente_maxima:t.inventario_general[0].cantidad_existente:t.cantidad,Object(B.jsx)(Oa.a,{align:"center",children:e})};return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)(ma.a,{hover:!0,role:"checkbox",tabIndex:-1,onClick:function(e){return a(e,t)},selected:n._id===t._id,children:[Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)(X.a,{size:"small",color:"primary",onClick:function(e){return a("button",t)},children:Object(B.jsx)(It.a,{})})}),Object(B.jsx)(Oa.a,{align:"center",children:t.id_producto.datos_generales.clave_alterna}),Object(B.jsx)(Oa.a,{align:"center",children:t.codigo_barras?t.codigo_barras:"N/A"}),Object(B.jsx)(Oa.a,{children:t.id_producto.datos_generales.nombre_comercial}),Object(B.jsx)(i,{}),Object(B.jsx)(o,{}),Object(B.jsx)(Oa.a,{align:"center",children:t.unidad}),Object(B.jsxs)(Oa.a,{align:"center",children:["$",t.precio?Fa(t.precio):0]})]},t._id)})}catch(s){console.log(s)}}var zf=a(177),Nf=a.n(zf);function Pf(e){e.producto;var t,a,n,c,r=e.productoSeleccionado,i=i_();return Object(B.jsxs)($e.a,{container:!0,alignItems:"center",children:[Object(B.jsx)($e.a,{item:!0,md:2,style:{display:"flex",justifyContent:"center"},children:(null===r||void 0===r||null===(t=r.id_producto)||void 0===t?void 0:t.imagenes.length)>0?Object(B.jsx)(p.a,{className:i.containerImage,children:Object(B.jsx)("img",{alt:"Imagen producto",src:null===r||void 0===r||null===(a=r.id_producto)||void 0===a?void 0:a.imagenes[0].url_imagen,className:i.imagen})}):Object(B.jsx)(p.a,{p:4,display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Nf.a,{style:{fontSize:40}})})}),Object(B.jsx)($e.a,{item:!0,md:10,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Nombre:"})}),Object(B.jsx)(S.a,{children:r.id_producto?r.id_producto.datos_generales.nombre_comercial:"-"})]}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Codigo Barras:"})}),Object(B.jsx)(S.a,{children:r.codigo_barras?r.codigo_barras:"N/A"})]}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsx)(S.a,{align:"center",children:Object(B.jsx)("b",{children:"Cantidad:"})}),Object(B.jsx)(S.a,{align:"center",children:r.cantidad?r.cantidad:"-"})]}),Object(B.jsxs)($e.a,{item:!0,md:1,xs:12,children:[Object(B.jsx)(S.a,{align:"center",children:Object(B.jsx)("b",{children:"Unidad:"})}),Object(B.jsx)(S.a,{align:"center",children:r.unidad?r.unidad:"-"})]}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsx)(S.a,{align:"center",children:Object(B.jsx)("b",{children:"Descuento:"})}),Object(B.jsx)(S.a,{align:"center",children:r.descuento?r.descuento.precio_neto:0})]}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsx)(S.a,{align:"center",children:Object(B.jsx)("b",{children:"% Descuento:"})}),Object(B.jsx)(S.a,{align:"center",children:r.descuento?r.descuento.precio_neto:0})]})]})}),Object(B.jsx)($e.a,{item:!0,md:12,lg:12,children:Object(B.jsx)(Df,{precios:null===r||void 0===r||null===(n=r.id_producto)||void 0===n||null===(c=n.precios)||void 0===c?void 0:c.precios_producto})})]})}function Df(e){var t=e.precios;return Object(B.jsx)(p.a,{children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{"aria-label":"simple table",size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Numero precio"}),[1,2,3,4,5,6].map((function(e,t){return Object(B.jsx)(Oa.a,{style:{minWidth:100},children:e},t)}))]})}),Object(B.jsx)(xa.a,{children:["Precios de venta"].map((function(e,a){return Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{style:{border:0},children:Object(B.jsx)("b",{children:e})}),null===t||void 0===t?void 0:t.map((function(e,t){return Object(B.jsxs)(Oa.a,{style:{border:0},children:["$",null!==e&&void 0!==e&&e.precio_neto?Fa(e.precio_neto):0]},t)}))]},a)}))})]})})})}var Ef=["cantidad_venta"],Af=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Tf(){var e=i_(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=JSON.parse(localStorage.getItem("turnoEnCurso")),n=Object(l.useContext)(o_),c=n.updateTablaVentas,r=n.setUpdateTablaVentas,i=n.setDatosVentasActual,o=Object(l.useState)(!1),s=Object(g.a)(o,2),d=s[0],j=s[1],u=Object(l.useState)(!1),m=Object(g.a)(u,2),O=m[0],x=m[1],h=Object(l.useState)({producto:""}),v=Object(g.a)(h,2),y=v[0],I=v[1],k=Object(l.useState)([]),z=Object(g.a)(k,2),N=z[0],P=z[1],D=Object(l.useState)({granel:!1,valor:0}),E=Object(g.a)(D,2),A=E[0],T=E[1],W=Object(Da.useDebounce)(y,500),$=Object(g.a)(W,1)[0],V=Object(qe.a)(yp,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id,input:{producto:$.producto?$.producto:""}}}),M=V.data,L=V.refetch,U=V.loading,q=[];M&&(q=M.obtenerProductosVentas);var J=function(){P([]),d||L(),j(!d)};window.addEventListener("keydown",(function(e){e.altKey&&80===e.keyCode&&J()})),Object(l.useEffect)((function(){T({granel:!1,valor:0})}),[]);var G=t.empresa.vender_sin_inventario,H=function(){var e=Object(f.a)(C.a.mark((function e(t){var a,n,o,s,l,d,j,u,p,m,O,h,_,f,g,v,y,S;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("medidas"!==t.concepto){e.next=6;break}if(G||0!==t.cantidad){e.next=4;break}return x(!0),e.abrupt("return");case 4:e.next=9;break;case 6:if(G||0!==t.inventario_general[0].cantidad_existente){e.next=9;break}return x(!0),e.abrupt("return");case 9:return a=JSON.parse(localStorage.getItem("DatosVentas")),n=null===a?[]:a.productos,o=null===a?[]:a,s=null===a?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:a,l=n,d={subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0},e.next=17,Ia(t);case 17:if((j=e.sent).found||!t._id){e.next=34;break}return u=Object(b.a)({},t),p=u.descuento_activo?u.descuento.precio_neto:u.precio_unidad.precio_neto,e.next=23,ka({newP:u,cantidad:0,granel:A,origen:"Ventas1",precio_boolean:!1});case 23:(m=e.sent).newP.precio_anterior=p,m.newP.iva_total_producto=parseFloat(m.ivaCalculo),m.newP.ieps_total_producto=parseFloat(m.iepsCalculo),m.newP.impuestos_total_producto=parseFloat(m.impuestoCalculo),m.newP.subtotal_total_producto=parseFloat(m.subtotalCalculo),m.newP.total_total_producto=parseFloat(m.totalCalculo),l.splice(0,0,m.newP),d={subTotal:parseFloat(s.subTotal)+parseFloat(m.subtotalCalculo),total:parseFloat(s.total)+parseFloat(m.totalCalculo),impuestos:parseFloat(s.impuestos)+parseFloat(m.impuestoCalculo),iva:parseFloat(s.iva)+parseFloat(m.ivaCalculo),ieps:parseFloat(s.ieps)+parseFloat(m.iepsCalculo),descuento:parseFloat(s.descuento)+parseFloat(m.descuentoCalculo),monedero:parseFloat(s.monedero)+parseFloat(m.monederoCalculo)},e.next=72;break;case 34:if(!j.found||!t._id){e.next=72;break}return O=j.producto_found.producto,h=O.cantidad_venta,(_=Object(ve.a)(O,Ef)).cantidad_venta=parseInt(h)+1,e.next=39,za(_);case 39:if(!(f=e.sent).found){e.next=60;break}return e.next=43,ka({newP:_,cantidad_venta:h,granel:_.granel_producto,origen:"",precio_boolean:!0,precio:_.precio_actual_object});case 43:return g=e.sent,e.next=46,ka({newP:_,cantidad_venta:_.cantidad_venta,granel:_.granel_producto,origen:"",precio_boolean:!0,precio:f.object_prising});case 46:v=e.sent,_.precio_a_vender=v.totalCalculo,_.precio_anterior=_.precio_actual_producto,_.precio_actual_producto=f.pricing,_.iva_total_producto=parseFloat(v.ivaCalculo),_.ieps_total_producto=parseFloat(v.iepsCalculo),_.impuestos_total_producto=parseFloat(v.impuestoCalculo),_.subtotal_total_producto=parseFloat(v.subtotalCalculo),_.total_total_producto=parseFloat(v.totalCalculo),_.precio_actual_object={cantidad_unidad:f.object_prising.cantidad_unidad?f.object_prising.cantidad_unidad:null,numero_precio:f.object_prising.numero_precio?f.object_prising.numero_precio:null,unidad_maxima:f.object_prising.unidad_maxima?f.object_prising.unidad_maxima:null,precio_general:f.object_prising.precio_general?f.object_prising.precio_general:null,precio_neto:f.object_prising.precio_neto?f.object_prising.precio_neto:null,precio_venta:f.object_prising.precio_venta?f.object_prising.precio_venta:null,iva_precio:f.object_prising.iva_precio?f.object_prising.iva_precio:null,ieps_precio:f.object_prising.ieps_precio?f.object_prising.ieps_precio:null,utilidad:f.object_prising.utilidad?f.object_prising.utilidad:null,porciento:f.object_prising.porciento?f.object_prising.porciento:null,dinero_descontado:f.object_prising.dinero_descontado?f.object_prising.dinero_descontado:null},l.splice(j.producto_found.index,1,_),d={subTotal:parseFloat(s.subTotal)-parseFloat(g.subtotalCalculo)+v.subtotalCalculo,total:parseFloat(s.total)-parseFloat(g.totalCalculo)+v.totalCalculo,impuestos:parseFloat(s.impuestos)-parseFloat(g.impuestoCalculo)+v.impuestoCalculo,iva:parseFloat(s.iva)-parseFloat(g.ivaCalculo)+v.ivaCalculo,ieps:parseFloat(s.ieps)-parseFloat(g.iepsCalculo)+v.iepsCalculo,descuento:parseFloat(s.descuento)-parseFloat(g.descuentoCalculo)+v.descuentoCalculo,monedero:parseFloat(s.monedero)-parseFloat(g.monederoCalculo)+v.monederoCalculo},e.next=72;break;case 60:return y=_.descuento_activo?_.descuento.precio_neto:_.precio_unidad.precio_neto,e.next=63,ka({newP:_,cantidad:0,granel:A,origen:"Ventas2"});case 63:(S=e.sent).newP.precio_actual_producto=y,S.newP.iva_total_producto=parseFloat(S.ivaCalculo)*parseFloat(_.cantidad_venta),S.newP.ieps_total_producto=parseFloat(S.iepsCalculo)*parseFloat(_.cantidad_venta),S.newP.impuestos_total_producto=parseFloat(S.impuestoCalculo)*parseFloat(_.cantidad_venta),S.newP.subtotal_total_producto=parseFloat(S.subtotalCalculo)*parseFloat(_.cantidad_venta),S.newP.total_total_producto=parseFloat(S.totalCalculo)*parseFloat(_.cantidad_venta),l.splice(j.producto_found.index,1,S.newP),d={subTotal:parseFloat(s.subTotal)+parseFloat(S.subtotalCalculo),total:parseFloat(s.total)+S.totalCalculo,impuestos:parseFloat(s.impuestos)+S.impuestoCalculo,iva:parseFloat(s.iva)+S.ivaCalculo,ieps:parseFloat(s.ieps)+S.iepsCalculo,descuento:parseFloat(s.descuento)+S.descuentoCalculo,monedero:parseFloat(s.monedero)+S.monederoCalculo};case 72:localStorage.setItem("DatosVentas",JSON.stringify(Object(b.a)(Object(b.a)({},d),{},{cliente:!0===o.venta_cliente?o.cliente:{},venta_cliente:!0===o.venta_cliente&&o.venta_cliente,productos:l,tipo_emision:o.tipo_emision?o.tipo_emision:"TICKET"}))),i(Object(b.a)({},d)),r(!c);case 75:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(w.a,{className:e.borderBotonChico,onClick:J,disabled:!a,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(p.a,{children:Object(B.jsx)(Fe.p,{style:{fontSize:45}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Productos"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"Alt + P"})})})]})}),Object(B.jsxs)(Ee.a,{maxWidth:"md",fullWidth:!0,open:d,onClose:J,TransitionComponent:Af,children:[Object(B.jsx)(R.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:O,onClose:function(){return x(!1)},message:"Producto sin existencias",autoHideDuration:3e3}),Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[Object(B.jsx)(S.a,{variant:"h6",children:"Buscar productos"}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:J,size:"large",children:Object(B.jsx)(We.a,{})})]})}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(p.a,{children:Object(B.jsx)(F.a,{variant:"outlined",placeholder:"Buscar producto",name:"producto",size:"small",fullWidth:!0,value:y.producto,onChange:function(e){I(Object(b.a)(Object(b.a)({},y),{},Object(_.a)({},e.target.name,e.target.value)))},InputProps:{endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(X.a,{children:Object(B.jsx)(sc.a,{})})})}})}),Object(B.jsx)(p.a,{my:2,children:Object(B.jsx)(Pf,{productoSeleccionado:N})}),Object(B.jsx)($e.a,{children:Object(B.jsx)(If,{productosBusqueda:q,productoSeleccionado:N,setProductoSeleccionado:P,loading:U,agregarProductos:H})})]})]})]})}var Wf=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),$f=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},root:{display:"flex",paddingLeft:e.spacing(2)}}}));function Rf(){var e=$f(),t=JSON.parse(localStorage.getItem("turnoEnCurso")),a=Object(l.useState)(""),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=function(){d(!s)};return window.addEventListener("keydown",(function(e){e.altKey&&67===e.keyCode&&j()})),Object(l.useEffect)((function(){t=JSON.parse(localStorage.getItem("turnoEnCurso"))}),[t]),Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(w.a,{style:{height:"100%",width:"100%",border:".6px solid #DBDBDB"},onClick:j,disabled:!t,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(p.a,{style:t?null:{pointerEvents:"none",opacity:.5},children:Object(B.jsx)(Fe.b,{style:{fontSize:45}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Clientes"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"aLT + C"})})})]})}),Object(B.jsxs)(Ee.a,{fullWidth:!0,maxWidth:"lg",open:s,onClose:j,TransitionComponent:Wf,children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{display:"flex",justifyContent:"space-between",children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Fe.b,{style:{fontSize:45}}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(S.a,{variant:"h6",children:"Clientes"})]}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:j,size:"large",children:Object(B.jsx)(We.a,{style:{fontSize:30}})})]})}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:6,xs:8,children:Object(B.jsxs)(Ka.a,{className:e.root,children:[Object(B.jsx)(Zs.a,{fullWidth:!0,placeholder:"Buscar cliente...",onChange:function(e){return r(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&r(e.target.defaultValue)},value:c}),Object(B.jsx)(X.a,{onClick:function(){return r(c)},children:Object(B.jsx)(sc.a,{})})]})}),Object(B.jsx)($e.a,{item:!0,md:6,xs:4,style:{display:"flex",justifyContent:"flex-end"},children:Object(B.jsx)(fo,{tipo:"CLIENTE",accion:"registrar",ventas:!0,handleClickOpen:j})})]}),Object(B.jsx)(p.a,{my:2,height:"70vh",children:Object(B.jsx)(nl,{tipo:"CLIENTE",filtro:c,ventas:!0,handleClickOpen:j})})]})]})]})}var Vf=a(478),Mf=a.n(Vf);function Lf(e){var t,a,n,c,r,i,o,s,j,u=e.setOpen,m=Object(l.useContext)(o_).setAlert,O=Object(z.a)(G_),x=Object(g.a)(O,1)[0],h=JSON.parse(localStorage.getItem("DatosVentas")),v=JSON.parse(localStorage.getItem("turnoEnCurso")),y=JSON.parse(localStorage.getItem("sesionCafi")),I=Object(l.useContext)(o_),k=I.updateTablaVentas,N=I.setUpdateTablaVentas,P=I.setDatosVentasActual,D=Object(l.useState)([]),E=Object(g.a)(D,2),A=E[0],T=E[1],W=Object(l.useState)(!1),$=Object(g.a)(W,2),R=$[0],V=$[1],M=Object(l.useState)({productos:null===h||void 0===h?void 0:h.productos,subTotal:null===h||void 0===h?void 0:h.subTotal,impuestos:null===h||void 0===h?void 0:h.impuestos,iva:null===h||void 0===h?void 0:h.iva,ieps:null===h||void 0===h?void 0:h.ieps,total:null===h||void 0===h?void 0:h.total}),L=Object(g.a)(M,2),U=L[0],q=L[1],J=Object(l.useState)(U?null===U||void 0===U||null===(t=U.descuento_general)||void 0===t?void 0:t.precio_con_descuento:null===h||void 0===h?void 0:h.total),G=Object(g.a)(J,2),H=G[0],Y=G[1],K=Object(l.useState)(null!==U&&void 0!==U&&null!==(a=U.descuento_general)&&void 0!==a&&a.porciento?null===U||void 0===U||null===(n=U.descuento_general)||void 0===n?void 0:n.porciento:0),X=Object(g.a)(K,2),Z=X[0],ee=X[1],te=[],ae=h,ne=i_(),ce=function(e){T(Object(b.a)(Object(b.a)({},A),{},Object(_.a)({},e.target.name,e.target.value)))},re=function(){var e=Object(f.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,A.fecha_vencimiento){e.next=6;break}return m({message:"Por favor completa los datos necesarios",status:"error",open:!0}),e.abrupt("return",null);case 6:return V(!0),e.next=9,x({variables:{input:{folio:Ca(8),descuento:U.descuento,ieps:U.ieps,impuestos:U.impuestos,iva:U.iva,monedero:h.monedero,subTotal:U.subTotal,total:U.total,venta_cliente:!!h.cliente,montos_en_caja:{},descuento_general_activo:Z>0,descuento_general:{porciento:parseFloat(Z),precio_con_descuento:U.total,cantidad_descontado:parseFloat(H)},dias_de_credito_venta:"",fecha_de_vencimiento_credito:"",fecha_vencimiento_cotizacion:A.fecha_vencimiento,cliente:h.cliente?h.cliente:{},productos:U.productos},empresa:y.empresa._id,sucursal:y.sucursal._id,usuario:y._id,caja:v.id_caja}});case 9:m({message:"La cotizaci\xf3n se realiz\xf3 correctamente.",status:"success",open:!0});case 10:u(!1),V(!1),localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal"),N(!k),P({subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(0),V(!1),m({message:"Algo sali\xf3 mal.",status:"error",open:!0}),e.t0.networkError.result?console.log(e.t0.networkError.result.errors):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors.message);case 23:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}();return d.a.useEffect((function(){try{!function(){for(var e=0,t=0,a=0,n=0,c=0,r=0,i=[],o=null===ae||void 0===ae?void 0:ae.productos,s=0;s<o.length;s++){var l=o[s],d={},j=parseFloat(Z),u=j>1?j>=10?parseFloat((l.precio_actual_object.precio_venta*parseFloat("0.".concat(j))).toFixed(2)):parseFloat((l.precio_actual_object.precio_venta*parseFloat("0.".concat(j))).toFixed(2)/10):parseFloat(l.precio_actual_object.precio_venta*j/100),p=parseFloat((l.precio_actual_object.precio_venta-u).toFixed(2)),m=parseFloat((p*parseFloat("0.".concat(l.id_producto.precios.iva<10?"0".concat(l.id_producto.precios.iva):l.id_producto.precios.iva))).toFixed(2)),O=parseFloat((p*parseFloat("0.".concat(l.id_producto.precios.ieps<10?"0".concat(l.id_producto.precios.ieps):l.id_producto.precios.ieps))).toFixed(2)),x=parseFloat((p+m+O).toFixed(2)),h=parseFloat(((p-l.id_producto.precios.precio_de_compra.precio_sin_impuesto)/l.id_producto.precios.precio_de_compra.precio_sin_impuesto*100).toFixed(2));d={cantidad_unidad:1,dinero_descontado:u,ieps_precio:O,iva_precio:m,numero_precio:l.precio_actual_object.numero_precio,porciento:l.precio_actual_object.porciento?parseFloat((parseFloat(l.precio_actual_object.porciento)+parseFloat(Z)).toFixed(2)):parseFloat(Z),precio_general:0,precio_neto:x,precio_venta:p,unidad_maxima:!1,utilidad:h},l.precio_actual_object.unidad_maxima&&(d.cantidad_unidad=l.precio_actual_object.cantidad_unidad,d.precio_general=x*parseFloat(l.precio_actual_object.cantidad_unidad),d.unidad_maxima=!0);var _=!0===l.granel_producto.granel?parseFloat(l.granel_producto.valor):1,f=parseFloat((d.ieps_precio*_*l.cantidad_venta).toFixed(2)),g=parseFloat(((d.ieps_precio+d.iva_precio)*_*l.cantidad_venta).toFixed(2)),v=parseFloat((d.iva_precio*_*l.cantidad_venta).toFixed(2)),C=parseFloat((d.precio_venta*_*l.cantidad_venta).toFixed(2)),y=parseFloat((d.precio_neto*_*l.cantidad_venta).toFixed(2)),S=parseFloat(d.dinero_descontado.toFixed(2))*_*l.cantidad_venta;i.push(Object(b.a)(Object(b.a)({},l),{},{precio_actual_object:d,ieps_total_producto:f,impuestos_total_producto:g,iva_total_producto:v,subtotal_total_producto:C,total_total_producto:y})),e+=y,t+=C,a+=g,n+=v,c+=f,r+=S}q(te={productos:i,impuestos:a,subTotal:t,iva:n,ieps:c,total:e,descuento:r})}()}catch(e){}}),[Z]),Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)(Ae.a,{children:[Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Usuario:"})}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",disabled:!0,variant:"outlined",onChange:ce,value:y?y.nombre:""})})]}),Object(B.jsxs)($e.a,{item:!0,md:null!==h&&void 0!==h&&null!==(c=h.cliente)&&void 0!==c&&c.nombre_cliente?2:3,xs:12,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Cliente:"})}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",disabled:!0,onChange:ce,variant:"outlined",value:null!==h&&void 0!==h&&null!==(r=h.cliente)&&void 0!==r&&r.nombre_cliente?null===h||void 0===h||null===(i=h.cliente)||void 0===i?void 0:i.nombre_cliente:"P\xfablico General"})})]}),null!==h&&void 0!==h&&null!==(o=h.cliente)&&void 0!==o&&o.nombre_cliente?Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"No. Cliente:"})}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",disabled:!0,onChange:ce,variant:"outlined",value:h?null===(s=h.cliente)||void 0===s?void 0:s.numero_cliente:""})})]}):null,Object(B.jsxs)($e.a,{item:!0,md:null!==h&&void 0!==h&&null!==(j=h.cliente)&&void 0!==j&&j.nombre_cliente?2:3,xs:12,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Fecha:"})}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",disabled:!0,onChange:ce,variant:"outlined",value:ht()().format("L")})})]}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Fecha Vencimiento:"})}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(F.a,{fullWidth:!0,type:"date",onChange:ce,size:"small",name:"fecha_vencimiento",variant:"outlined"})})]})]}),Object(B.jsx)(He,{loading:R}),Object(B.jsxs)($e.a,{container:!0,spacing:3,children:[Object(B.jsx)($e.a,{item:!0,md:6,xs:12,children:Object(B.jsx)(p.a,{mt:4,children:Object(B.jsxs)(Ka.a,{elevation:3,children:[Object(B.jsxs)(p.a,{textAlign:"center",children:[Object(B.jsx)(S.a,{style:{fontSize:17},children:Object(B.jsx)("b",{children:"Agregar descuento"})}),Object(B.jsxs)(St.a,{severity:"info",children:["El descuento se aplica apartir del ",Object(B.jsx)("b",{children:"SUBTOTAL"})]})]}),Object(B.jsxs)(p.a,{p:2,children:[Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:6,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Porcentaje:"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"descuento",id:"form-venta-porsentaje-descuento",variant:"outlined",value:Z,onChange:function(e){return function(e){var t=e.target.value;if(ee(t),""!==e){var a=null===ae||void 0===ae?void 0:ae.subTotal,n=t<10?parseFloat("0.0".concat(t.replace(".",""))):parseFloat("0.".concat(t.replace(".","")));Y((a*n).toFixed(2))}}(e)},type:"number",disabled:!1,InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"%"})}})]}),Object(B.jsxs)($e.a,{item:!0,md:6,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Dinero a descontar"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",type:"number",name:"precioConDescuento",onChange:function(e){try{var t=""!==e.target.value?parseFloat(e.target.value):"",a=null===ae||void 0===ae?void 0:ae.subTotal;Y(t);var n=""===t?0:parseFloat((t/a*100).toFixed(2)),c=""===t?0:parseFloat(n.toFixed(2));ee(c)}catch(r){console.log(r)}},value:H,className:ne.input,variant:"outlined"})]})]}),Object(B.jsx)(p.a,{mt:2,display:"flex",justifyContent:"flex-end",children:Object(B.jsx)(w.a,{variant:"text",color:"secondary",size:"medium",onClick:function(){try{te={subTotal:0,iva:0,ieps:0},ee(0),Y(""),q(te)}catch(e){console.log(e)}},startIcon:Object(B.jsx)(Mf.a,{}),children:"Quitar descuento"})})]})]})})}),Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsxs)(p.a,{mt:3,width:"100%",children:[Object(B.jsx)(p.a,{m:1,children:Object(B.jsxs)(S.a,{style:{fontSize:17},children:[Object(B.jsx)("b",{children:"No. Productos: "})," ",null===h||void 0===h?void 0:h.productos.length]})}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsxs)(S.a,{style:{fontSize:17},children:[Object(B.jsx)("b",{children:"Subtotal:"})," $",U.subTotal?Fa(U.subTotal):0]})}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsxs)(S.a,{style:{fontSize:17},children:[Object(B.jsx)("b",{children:"Impuestos:"})," $",U.impuestos?Fa(U.impuestos):0]})}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsxs)(S.a,{style:{fontSize:16},children:[Object(B.jsx)("b",{children:"IVA:"})," $",U.iva?Fa(U.iva):0]})}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsxs)(S.a,{style:{fontSize:16},children:[Object(B.jsx)("b",{children:"IEPS:"})," $",U.ieps?Fa(U.ieps):0]})}),Object(B.jsx)(p.a,{m:1,children:Object(B.jsxs)(S.a,{style:{fontSize:17},children:[Object(B.jsx)("b",{children:"Descuento:"})," ",Object(B.jsxs)("b",{style:{color:"green"},children:["$",H?Fa(H):0]})]})})]}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsxs)(S.a,{style:{fontSize:27},children:["Total: ",Object(B.jsxs)("b",{children:["$",U.total?Fa(U.total):0]})]})})]})]})]}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{color:"primary",variant:"contained",size:"large",onClick:re,children:"Guardar"})})]})}var Uf=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Bf(e){var t=e.type;ht.a.locale("es");var a=i_(),n=JSON.parse(localStorage.getItem("sesionCafi")),c=JSON.parse(localStorage.getItem("turnoEnCurso")),r=JSON.parse(localStorage.getItem("DatosVentas")),i=Object(l.useState)(t),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(l.useContext)(O_),u=j.reloadCrearCotizacion,b=j.setReloadCrearCotizacion,m=j.setAbrirPanelAcceso,O=j.abrirPanelAcceso,x=j.setDepartamentos,h=Object(l.useContext)(o_).setAlert,_=Object(l.useState)(!1),f=Object(g.a)(_,2),v=f[0],C=f[1],y=function(e){if(!r)return h({message:"Lo sentimos no hay productos que cotizar",status:"error",open:!0}),null;!0===(null===n||void 0===n?void 0:n.accesos.ventas.cotizaciones.ver)?C(!v):(console.log("pedir permiso"),m(!O),x({departamento:"ventas",subDepartamento:"cotizaciones",tipo_acceso:"ver"}))};return Object(l.useEffect)((function(){!0===u&&(b(!1),d("GENERAR"),C(!v))}),[u]),window.addEventListener("keydown",(function(e){e.altKey&&84===e.keyCode&&y(0)})),Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(w.a,{className:a.borderBotonChico,onClick:function(){return y()},disabled:!c,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(p.a,{children:Object(B.jsx)(Fe.d,{style:{fontSize:50}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Generar cotizacion"})})})]})}),Object(B.jsxs)(Ee.a,{fullWidth:!0,open:v,maxWidth:"GENERAR"===s?"md":"lg",onClose:function(){return C(!1)},TransitionComponent:Uf,children:[Object(B.jsx)(Ie.a,{position:"static",color:"default",elevation:0,children:Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsxs)(p.a,{display:"flex",flexGrow:1,children:[Object(B.jsx)(p.a,{p:2,display:"flex",alignItems:"center",children:Object(B.jsx)(Fe.d,{style:{fontSize:38}})}),Object(B.jsx)(p.a,{p:1,display:"flex",alignItems:"center",children:Object(B.jsx)(S.a,{style:{fontSize:18},children:"Nueva Cotizaci\xf3n"})})]}),Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){return C(!v)},size:"medium",children:Object(B.jsx)(We.a,{})})})]})}),Object(B.jsx)(Lf,{setOpen:C})]})]})}var qf=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Jf(){var e=JSON.parse(localStorage.getItem("turnoEnCurso")),t=JSON.parse(localStorage.getItem("DatosVentas")),a=i_(),n=Object(l.useState)(!1),c=Object(g.a)(n,2),r=c[0],i=c[1],o=Object(l.useContext)(o_),s=o.updateTablaVentas,d=o.setUpdateTablaVentas,j=o.setDatosVentasActual,u=o.setVentaRetomada,b=Object(l.useContext)(Xi),m=b.updateClientVenta,O=b.setUpdateClientVenta,x=function(){i(!r)};window.addEventListener("keydown",(function(e){118===e.keyCode&&t&&x()}));return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(w.a,{className:a.borderBotonChico,onClick:x,disabled:!e||!t,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(p.a,{children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/shopping-cart.svg",alt:"icono cancelarventa",style:{width:35}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Cancelar Venta"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"F7"})})})]})}),Object(B.jsxs)(Ee.a,{maxWidth:"lg",open:r,onClose:x,TransitionComponent:qf,children:[Object(B.jsxs)(Ae.a,{children:[Object(B.jsxs)($e.a,{container:!0,item:!0,lg:12,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",justifyContent:"center",flexGrow:1,children:[Object(B.jsx)(p.a,{children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/shopping-cart.svg",alt:"icono caja",className:a.iconSizeDialogs})}),Object(B.jsx)(p.a,{m:2,children:Object(B.jsx)(Le.a,{orientation:"vertical"})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"h5",children:"Cancelar Venta"})})]}),Object(B.jsx)(p.a,{ml:10,mb:7,display:"flex",alignItems:"center",children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){return i(!r)},size:"large",children:Object(B.jsx)(We.a,{})})})]}),Object(B.jsx)(p.a,{p:2,children:Object(B.jsx)(S.a,{variant:"h5",children:"\xbfEsta seguro que desea cancelar esta venta?"})})]}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{onClick:function(){return localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal"),d(!s),O(!m),j({subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}),u(t),void i(!r)},variant:"contained",color:"primary",size:"large",autoFocus:!0,children:"Aceptar"})})]})]})}var Gf=a(480),Hf=a.n(Gf),Yf=a(479),Kf=a.n(Yf);function Qf(e){var t=e.montos,a=e.setMontos,n=e.totales,c=e.setTotales,r=e.venta_credito,i=e.montoEnCaja,o=e.setMontoEnCaja,s=e.datosCliente,d=i_(),j=Object(l.useState)(n.total),u=Object(g.a)(j,2),m=u[0],O=u[1],x=JSON.parse(localStorage.getItem("DatosVentas")),h=x?parseFloat(x.total.toFixed(2)):0,_=function(e,r){var i=e.target.value;switch(r){case"EFECTIVO":a(Object(b.a)(Object(b.a)({},t),{},{efectivo:i})),O(i);break;case"TARJETA":a(Object(b.a)(Object(b.a)({},t),{},{tarjeta:i}));break;case"PUNTOS":var o=""!==i?parseInt(i):0;o<=s.monedero_electronico&&(a(Object(b.a)(Object(b.a)({},t),{},{puntos:i,efectivo:m-o})),c(Object(b.a)(Object(b.a)({},n),{},{total:h-o})));break;case"TRANSFERENCIA":a(Object(b.a)(Object(b.a)({},t),{},{transferencia:i}));break;case"CHEQUE":a(Object(b.a)(Object(b.a)({},t),{},{cheque:i}));break;default:return alert("Error de pago")}};Object(l.useEffect)((function(){if(!r){var e,a=parseFloat(t.efectivo)+parseFloat(t.tarjeta)+parseFloat(t.puntos)+parseFloat(t.transferencia)+parseFloat(t.cheque),i=parseFloat(a)-h;e=parseFloat(t.efectivo-i),o(e),c(Object(b.a)(Object(b.a)({},n),{},{monto_pagado:a,cambio:a-n.total}))}}),[t]);var f=function(e){var n=e.target,c=n.name,r=n.value,i=parseFloat(r);switch(c){case"EFECTIVO":0===i&&(a(Object(b.a)(Object(b.a)({},t),{},{efectivo:""})),O(""));break;case"TARJETA":0===i&&a(Object(b.a)(Object(b.a)({},t),{},{tarjeta:""}));break;case"PUNTOS":0===i&&a(Object(b.a)(Object(b.a)({},t),{},{puntos:""}));break;case"TRANSFERENCIA":0===i&&a(Object(b.a)(Object(b.a)({},t),{},{transferencia:""}));break;case"CHEQUE":0===i&&a(Object(b.a)(Object(b.a)({},t),{},{cheque:""}))}},v=function(e){var n=e.target,c=n.name,r=n.value,o=parseFloat(i);switch(c){case"EFECTIVO":""===r&&(a(Object(b.a)(Object(b.a)({},t),{},{efectivo:0})),O(0));break;case"TARJETA":(""===r||o<0)&&a(Object(b.a)(Object(b.a)({},t),{},{tarjeta:0}));break;case"PUNTOS":(""===r||o<0&&parseFloat(t.puntos)!==parseFloat(h))&&a(Object(b.a)(Object(b.a)({},t),{},{puntos:0}));break;case"TRANSFERENCIA":(""===r||o<0)&&a(Object(b.a)(Object(b.a)({},t),{},{transferencia:0}));break;case"CHEQUE":(""===r||o<0)&&a(Object(b.a)(Object(b.a)({},t),{},{cheque:0}))}};return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)("div",{className:d.formInputFlex,children:[Object(B.jsxs)(p.a,{width:"25%",textAlign:"center",children:[Object(B.jsx)(p.a,{children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/money.svg",alt:"icono ventas",className:d.iconSizeDialogsPequeno})}),Object(B.jsx)(S.a,{variant:"caption",children:"Efectivo"}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"EFECTIVO",id:"form-producto-efectivo",variant:"outlined",value:t.efectivo,onChange:function(e){return _(e,"EFECTIVO")},onBlur:v,onFocus:f,autoFocus:!0})})]}),Object(B.jsxs)(p.a,{width:"25%",textAlign:"center",children:[Object(B.jsx)(p.a,{children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/tarjeta-de-credito.svg",alt:"icono ventas",className:d.iconSizeDialogsPequeno})}),Object(B.jsx)(S.a,{variant:"caption",children:"Tarjeta"}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"TARJETA",variant:"outlined",value:t.tarjeta,onChange:function(e){return _(e,"TARJETA")},onBlur:v,onFocus:f})})]}),Object(B.jsxs)(p.a,{width:"25%",textAlign:"center",children:[Object(B.jsx)(p.a,{children:Object(B.jsx)(Fe.q,{style:{fontSize:50,cursor:"pointer"}})}),Object(B.jsx)(S.a,{variant:"caption",children:"Puntos"}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"PUNTOS",variant:"outlined",value:t.puntos,onChange:function(e){return _(e,"PUNTOS")},onBlur:v,onFocus:f})})]}),Object(B.jsxs)(p.a,{width:"25%",textAlign:"center",children:[Object(B.jsx)(p.a,{p:0,children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/transferencia-bancaria.svg",alt:"icono ventas",className:d.iconSizeDialogsPequeno})}),Object(B.jsx)(S.a,{variant:"caption",children:"Transferencia"}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"TRANSFERENCIA",variant:"outlined",value:t.transferencia,onChange:function(e){return _(e,"TRANSFERENCIA")},onBlur:v,onFocus:f})})]}),Object(B.jsxs)(p.a,{width:"25%",textAlign:"center",children:[Object(B.jsx)(p.a,{p:0,children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/cheque.png",alt:"icono ventas",className:d.iconSizeDialogsPequeno})}),Object(B.jsx)(S.a,{variant:"caption",children:"Cheque"}),Object(B.jsx)(p.a,{display:"flex",children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"CHEQUE",variant:"outlined",value:t.cheque,onChange:function(e){return _(e,"CHEQUE")},onBlur:v,onFocus:f})})]})]})})}function Xf(e){var t=e.montos,a=e.totales,n=e.datosCliente,c=e.monedero,r=e.monederoTotal;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsxs)($e.a,{item:!0,md:5,xs:12,children:[Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",mr:2,children:[Object(B.jsx)(p.a,{mt:.5,mr:.5,children:Object(B.jsx)(Fe.b,{style:{fontSize:19}})}),Object(B.jsx)(S.a,{variant:"subtitle1",children:Object(B.jsx)("b",{children:"Cliente:"})})]}),Object(B.jsx)(S.a,{variant:"subtitle1",children:n.nombre_cliente?n.nombre_cliente:"P\xfablico General"})]}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",mr:2,children:[Object(B.jsx)(p.a,{mt:.5,mr:.5,children:Object(B.jsx)(Fe.o,{style:{fontSize:19}})}),Object(B.jsx)(S.a,{variant:"subtitle1",children:Object(B.jsx)("b",{children:"Dinero electronico generado:"})})]}),Object(B.jsxs)(S.a,{variant:"subtitle1",children:["$",c?Fa(c):0]})]}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",mr:2,children:[Object(B.jsx)(p.a,{mt:.5,mr:.5,children:Object(B.jsx)(Fe.o,{style:{fontSize:19}})}),Object(B.jsx)(S.a,{variant:"subtitle1",children:Object(B.jsx)("b",{children:"Dinero electr\xf3nico disponible:"})})]}),Object(B.jsxs)(S.a,{variant:"subtitle1",children:["$",n.monedero_electronico?Fa(n.monedero_electronico-t.puntos):0]})]}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",mr:2,children:[Object(B.jsx)(p.a,{mt:.5,mr:.5,children:Object(B.jsx)(Fe.o,{style:{fontSize:19}})}),Object(B.jsx)(S.a,{variant:"subtitle1",children:Object(B.jsx)("b",{children:"Total puntos:"})})]}),Object(B.jsxs)(S.a,{variant:"subtitle1",children:["$",r?Fa(r-t.puntos):0]})]})]}),Object(B.jsxs)($e.a,{item:!0,md:5,xs:12,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[Object(B.jsx)(S.a,{style:{fontSize:"17px"},children:Object(B.jsx)("b",{children:"Monto pagado:"})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsxs)(S.a,{variant:"h6",children:["$ ",Fa(a.monto_pagado)]})]}),Object(B.jsxs)(p.a,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[Object(B.jsx)(S.a,{style:{fontSize:"17px"},children:Object(B.jsx)("b",{children:"Subtotal:"})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsxs)(S.a,{variant:"h6",children:["$ ",Fa(a.subtotal)]})]}),Object(B.jsxs)(p.a,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[Object(B.jsx)(S.a,{style:{fontSize:"17px"},children:Object(B.jsx)("b",{children:"Impuestos:"})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsxs)(S.a,{variant:"h6",children:["$ ",Fa(a.impuestos)]})]}),Object(B.jsxs)(p.a,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[Object(B.jsx)(S.a,{style:{fontSize:"17px"},children:Object(B.jsx)("b",{children:"Total:"})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsxs)(S.a,{variant:"h6",children:["$ ",Fa(a.total)]})]}),Object(B.jsxs)(p.a,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[Object(B.jsx)(S.a,{style:{fontSize:"17px"},children:Object(B.jsx)("b",{children:"Descuento:"})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsxs)(S.a,{variant:"h6",children:["$ ",a.descuento?Fa(a.descuento):0]})]}),Object(B.jsxs)(p.a,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[Object(B.jsx)(S.a,{align:"left",style:{fontSize:"17px"},children:Object(B.jsx)("b",{children:"Cambio:"})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsxs)(S.a,{variant:"h6",children:["$ ",a.cambio?Fa(a.cambio):0]})]})]})]})}function Zf(e){var t=e.montos,a=e.setMontos,n=e.setTotales,c=e.venta_credito,r=e.setMontoEnCaja,i=e.datosCliente,o=e.setDatosCliente,s=(e.editarCliente,e.setEditarCliente,e.fechaVencimientoDate),d=e.setfechaVencimientoDate,j=JSON.parse(localStorage.getItem("DatosVentas")),u=j?parseFloat(j.total.toFixed(2)):0;return Object(l.useEffect)((function(){d(ht()().add(i.dias_credito?parseInt(i.dias_credito):0,"days").format("YYYY-MM-DD"))}),[i,i.dias_credito]),Object(l.useEffect)((function(){c?(a({efectivo:0,tarjeta:0,puntos:0,transferencia:0,cheque:0}),n({subtotal:0,impuestos:0,total:0,descuento:0,cambio:0,monto_pagado:u}),r(0)):(a(Object(b.a)(Object(b.a)({},t),{},{efectivo:u})),r(u))}),[c]),Object(B.jsx)(l.Fragment,{children:Object(B.jsx)($e.a,{item:!0,xs:12,children:Object(B.jsxs)($e.a,{container:!0,spacing:1,children:[Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsx)(S.a,{variant:"caption",children:Object(B.jsx)("b",{children:"Dias de Cr\xe9dito:"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",value:null===i.dias_credito?0:i.dias_credito,onChange:function(e){return o(Object(b.a)(Object(b.a)({},i),{},{dias_credito:e.target.value}))},disabled:!0})]}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsx)(S.a,{variant:"caption",children:Object(B.jsx)("b",{children:"L\xedmite de Cr\xe9dito:"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",value:null===i.limite_credito?0:i.limite_credito,disabled:!0})]}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsx)(S.a,{variant:"caption",children:Object(B.jsx)("b",{children:"Cr\xe9dito Disponible:"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",value:null===i.credito_disponible?0:i.credito_disponible,disabled:!0})]}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsx)(S.a,{variant:"caption",children:Object(B.jsx)("b",{children:"Total a Cr\xe9dito:"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",disabled:!0,value:u})]}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsx)(S.a,{variant:"caption",children:Object(B.jsx)("b",{children:"Fecha de Vencimiento:"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",type:"date",value:s,onChange:function(e){var t=ht()(e.target.value).add(1,"days"),a=ht()(),n=t.diff(a,"days");d(e.target.value),o(Object(b.a)(Object(b.a)({},i),{},{dias_credito:n}))},disabled:!0})]})]})})})}var eg=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function tg(e){var t=e.venta_base,a=e.setVentaBase,n=e.totales,c=e.setTotales,r=e.montos,i=e.setMontos,o=Object(l.useState)(!1),s=Object(g.a)(o,2),d=s[0],j=s[1],u=Object(l.useState)(0),m=Object(g.a)(u,2),O=m[0],x=m[1],h=Object(l.useState)(0),_=Object(g.a)(h,2),f=_[0],v=_[1],C=Object(l.useState)({productos:t.productos,total:n.total,subTotal:n.subtotal,impuestos:n.impuestos,iva:t.iva,ieps:t.ieps,descuento:n.descuento}),y=Object(g.a)(C,2),I=y[0],k=y[1],z=JSON.parse(localStorage.getItem("DatosVentas")),N=z?parseFloat(z.subTotal.toFixed(2)):0,P=function(){return j(!1)},D=function(e){for(var t=Object(b.a)({},z).productos,a=0,n=0,c=0,r=0,i=0,o=0,s=[],l=0;l<t.length;l++){var d=t[l],j={},u=parseFloat(e),p=u>1?u>=10?parseFloat((d.precio_actual_object.precio_venta*parseFloat("0.".concat(u))).toFixed(2)):parseFloat((d.precio_actual_object.precio_venta*parseFloat("0.".concat(u))).toFixed(2)/10):parseFloat(d.precio_actual_object.precio_venta*u/100),m=parseFloat((d.precio_actual_object.precio_venta-p).toFixed(2)),O=parseFloat((m*parseFloat("0.".concat(d.id_producto.precios.iva<10?"0".concat(d.id_producto.precios.iva):d.id_producto.precios.iva))).toFixed(2)),x=parseFloat((m*parseFloat("0.".concat(d.id_producto.precios.ieps<10?"0".concat(d.id_producto.precios.ieps):d.id_producto.precios.ieps))).toFixed(2)),h=parseFloat((m+O+x).toFixed(2)),_=parseFloat(((m-d.id_producto.precios.precio_de_compra.precio_sin_impuesto)/d.id_producto.precios.precio_de_compra.precio_sin_impuesto*100).toFixed(2));j={cantidad_unidad:1,dinero_descontado:p,ieps_precio:x,iva_precio:O,numero_precio:d.precio_actual_object.numero_precio,porciento:d.precio_actual_object.porciento?parseFloat((parseFloat(d.precio_actual_object.porciento)+parseFloat(e)).toFixed(2)):parseFloat(e),precio_general:0,precio_neto:h,precio_venta:m,unidad_maxima:!1,utilidad:_},d.precio_actual_object.unidad_maxima&&(j.cantidad_unidad=d.precio_actual_object.cantidad_unidad,j.precio_general=h*parseFloat(d.precio_actual_object.cantidad_unidad),j.unidad_maxima=!0);var f=!0===d.granel_producto.granel?parseFloat(d.granel_producto.valor):1,g=parseFloat((j.ieps_precio*f*d.cantidad_venta).toFixed(2)),v=parseFloat(((j.ieps_precio+j.iva_precio)*f*d.cantidad_venta).toFixed(2)),C=parseFloat((j.iva_precio*f*d.cantidad_venta).toFixed(2)),y=parseFloat((j.precio_venta*f*d.cantidad_venta).toFixed(2)),S=parseFloat((j.precio_neto*f*d.cantidad_venta).toFixed(2)),F=parseFloat(j.dinero_descontado.toFixed(2))*f*d.cantidad_venta;s.push(Object(b.a)(Object(b.a)({},d),{},{precio_actual_object:j,ieps_total_producto:g,impuestos_total_producto:v,iva_total_producto:C,subtotal_total_producto:y,total_total_producto:S})),a+=S,n+=y,c+=v,r+=C,i+=g,o+=F}k({productos:s,total:a,subTotal:n,impuestos:c,iva:r,ieps:i,descuento:o})},E=function(e){var t=e.target.value;t&&"0"!==t&&0!==parseFloat(t)||(k({productos:z.productos,total:z.total,subTotal:z.subTotal,impuestos:z.impuestos,iva:z.iva,ieps:z.ieps,descuento:z.descuento}),x(0),v(0))},A=Object(l.useState)(0),T=Object(g.a)(A,2),W=T[0],$=T[1],R=Object(l.useState)(0),V=Object(g.a)(R,2),M=V[0],L=V[1],U=Object(_c.a)(W,700),q=Object(g.a)(U,1)[0],J=Object(_c.a)(M,700),G=Object(g.a)(J,1)[0];return Object(l.useEffect)((function(){!function(e){var t=e.toString();if(t&&"0"!==t){var a=100*(N-parseFloat(t))/N-100,n=Math.abs(a),c=parseFloat(n.toFixed(2));return v(c),void D(c)}k({productos:z.productos,total:z.total,subTotal:z.subTotal,impuestos:z.impuestos,iva:z.iva,ieps:z.ieps,descuento:z.descuento})}(O)}),[q]),Object(l.useEffect)((function(){!function(e){var t=e.toString();if(t&&"0"!==t){var a=N,n=t<10?parseFloat("0.0".concat(t.replace(".",""))):parseFloat("0.".concat(t.replace(".","")));return x((a*n).toFixed(2)),void D(t)}k({productos:z.productos,total:z.total,subTotal:z.subTotal,impuestos:z.impuestos,iva:z.iva,ieps:z.ieps,descuento:z.descuento})}(f)}),[G]),Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(w.a,{size:"large",variant:"contained",color:"primary",startIcon:Object(B.jsx)(pl.a,{style:{fontSize:"28px"}}),onClick:function(){return j(!0)},disabled:!t,children:"Descuento"}),Object(B.jsxs)(Ee.a,{fullWidth:!0,maxWidth:"sm",open:d,onClose:P,TransitionComponent:eg,children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{textAlign:"center",display:"flex",justifyContent:"space-between",children:[Object(B.jsx)(S.a,{variant:"h5",children:"Descuento"}),Object(B.jsx)(w.a,{color:"secondary",variant:"contained",size:"small",onClick:P,children:Object(B.jsx)(Pt.a,{})})]})}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsxs)(St.a,{severity:"info",children:["El descuento se aplica en el ",Object(B.jsx)("b",{children:"SUBTOTAL"})," de la venta."]}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,justifyContent:"center",children:[Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Dinero a descontar:"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"dinero-descuento",id:"form-venta-dinero-descuento",value:O,onChange:function(e){x(e.target.value),$(e.target.value)},variant:"outlined",InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})},onBlur:E})]}),Object(B.jsxs)($e.a,{item:!0,md:6,xs:12,children:[Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"Porcentaje:"})}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",id:"form-venta-porsentaje-descuento",variant:"outlined",value:f,onChange:function(e){v(e.target.value),L(e.target.value)},type:"number",InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"%"})},onBlur:E})]})]})}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsx)(S.a,{variant:"subtitle2",align:"center",children:"IVA"}),Object(B.jsx)(S.a,{variant:"subtitle2",align:"center",children:Object(B.jsxs)("b",{children:["$",Fa(I.iva)]})})]}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsx)(S.a,{variant:"subtitle2",align:"center",children:"IEPS"}),Object(B.jsx)(S.a,{variant:"subtitle2",align:"center",children:Object(B.jsxs)("b",{children:["$",Fa(I.ieps)]})})]}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsx)(S.a,{variant:"subtitle2",align:"center",children:"Subtotal"}),Object(B.jsx)(S.a,{variant:"subtitle2",align:"center",children:Object(B.jsxs)("b",{children:["$",Fa(I.subTotal)]})})]}),Object(B.jsxs)($e.a,{item:!0,md:2,xs:12,children:[Object(B.jsx)(S.a,{variant:"subtitle2",align:"center",children:"Impuestos"}),Object(B.jsx)(S.a,{variant:"subtitle2",align:"center",children:Object(B.jsxs)("b",{children:["$",Fa(I.impuestos)]})})]}),Object(B.jsxs)($e.a,{item:!0,md:3,xs:12,children:[Object(B.jsx)(S.a,{variant:"subtitle2",align:"center",children:"Total"}),Object(B.jsx)(S.a,{variant:"subtitle2",align:"center",children:Object(B.jsxs)("b",{children:["$",Fa(I.total)]})})]})]})})]}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{onClick:function(){return function(){var e=Object(b.a)({},z),t=I.productos,o=I.total,s=I.subTotal,l=I.impuestos,d=I.iva,j=I.ieps,u=I.descuento;a(Object(b.a)(Object(b.a)({},e),{},{productos:t,total:o,subTotal:s,impuestos:l,iva:d,ieps:j,descuento:u})),c(Object(b.a)(Object(b.a)({},n),{},{total:o,subtotal:s,impuestos:l,descuento:u})),i(Object(b.a)(Object(b.a)({},r),{},{efectivo:o})),P()}()},variant:"contained",size:"large",color:"primary",autoFocus:!0,startIcon:Object(B.jsx)(Dt.a,{}),children:"Guardar"})})]})]})}var ag=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))})),ng={efectivo:0,tarjeta:0,puntos:0,transferencia:0,cheque:0},cg={subtotal:0,impuestos:0,total:0,descuento:0,cambio:0,monto_pagado:0};function rg(){var e=i_(),t=Object(l.useState)(!1),a=Object(g.a)(t,2),n=a[0],c=a[1],r=JSON.parse(localStorage.getItem("turnoEnCurso")),i=JSON.parse(localStorage.getItem("DatosVentas")),o=Object(l.useState)(!1),s=Object(g.a)(o,2),d=s[0],j=s[1],u=Object(l.useContext)(o_),m=u.updateTablaVentas,O=u.setUpdateTablaVentas,x=u.setDatosVentasActual,h=u.setOpenBackDrop,_=u.setVentaRetomada,v=Object(l.useContext)(Xi),y=v.updateClientVenta,F=v.setUpdateClientVenta,I=Object(l.useState)(ng),k=Object(g.a)(I,2),N=k[0],P=k[1],D=Object(l.useState)(cg),E=Object(g.a)(D,2),A=E[0],T=E[1],W=Object(l.useState)(!1),$=Object(g.a)(W,2),V=$[0],M=$[1],L=Object(l.useState)(""),U=Object(g.a)(L,2),q=U[0],G=U[1],H=Object(l.useState)(!1),Y=Object(g.a)(H,2),K=Y[0],Q=Y[1],Z=Object(l.useState)(0),ee=Object(g.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(l.useState)(0),ce=Object(g.a)(ne,2),re=ce[0],ie=ce[1],oe=Object(l.useState)(0),se=Object(g.a)(oe,2),le=se[0],de=se[1],je=Object(l.useState)(!1),ue=Object(g.a)(je,2),be=ue[0],pe=ue[1],me=Object(l.useState)({}),Oe=Object(g.a)(me,2),xe=Oe[0],he=Oe[1],_e=Object(l.useState)(0),fe=Object(g.a)(_e,2),ge=fe[0],ve=fe[1],Ce=Object(l.useState)({message:"",status:"",open:!1}),ye=Object(g.a)(Ce,2),Se=ye[0],Fe=ye[1],we=Object(z.a)(Fp),Ie=Object(g.a)(we,1)[0],ke=function(){if(!d){var e=JSON.parse(localStorage.getItem("DatosVentas"));de(e);var t=e.cliente,a=e.subTotal,n=e.impuestos,c=e.total,r=e&&t?t:{};xe.credito_disponible?M(!0):M(!1),he(r),ie(null===e?0:parseFloat(c.toFixed(2))),T({subtotal:null===e?0:parseFloat(a.toFixed(2)),impuestos:null===e?0:parseFloat(n.toFixed(2)),total:null===e?0:parseFloat(c.toFixed(2)),descuento:0,cambio:0,monto_pagado:null===e?0:parseFloat(c.toFixed(2))}),P({efectivo:null===e?0:parseFloat(c.toFixed(2)),tarjeta:0,puntos:0,transferencia:0,cheque:0});var i=function(e){var t=0;return e&&e.productos.forEach((function(e){if(e.id_producto.precios.monedero){var a=e.id_producto.precios.monedero_electronico*e.precio_a_vender;t+=a}})),t}(e);ve(parseFloat(i)),ae(t.monedero_electronico?parseFloat(t.monedero_electronico)+parseFloat(i):parseFloat(i))}j(!d)},ze=function(){c(!1),Ne()},Ne=function(){he({}),ve(0),G(""),ae(0),de(0),pe(!1),M(!1),ie(0),T(cg),P(ng),_(null)};var Pe=function(){var e=Object(f.a)(C.a.mark((function e(){var t,a,n,r,i,o,s;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(V&&le.total>xe.credito_disponible)){e.next=3;break}return Q(!0),e.abrupt("return");case 3:return Q(!1),e.prev=4,h(!0),t=JSON.parse(localStorage.getItem("turnoEnCurso")),a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(b.a)({},le),r=va(1e11,999999999999),n.folio="".concat(r),i={monto_efectivo:{monto:parseFloat(re),metodo_pago:vt[0].Value},monto_tarjeta_debito:{monto:parseFloat(N.tarjeta),metodo_pago:vt[3].Value},monto_tarjeta_credito:{monto:0,metodo_pago:vt[3].Value},monto_creditos:{monto:0,metodo_pago:""},monto_monedero:{monto:parseFloat(N.puntos),metodo_pago:vt[4].Value},monto_transferencia:{monto:parseFloat(N.transferencia),metodo_pago:vt[2].Value},monto_cheques:{monto:parseFloat(N.cheque),metodo_pago:vt[1].Value},monto_vales_despensa:{monto:0,metodo_pago:vt[6].Value}},n.montos_en_caja=i,n.credito=V,n.descuento_general_activo=!1,n.descuento_general=null,n.dias_de_credito_venta=xe?xe.dias_credito:null,n.fecha_de_vencimiento_credito=q,n.fecha_vencimiento_cotizacion=null,n.cambio=A.cambio,n.editar_cliente=be,n.puntos_totales_venta=parseFloat(N.puntos)>0?te-ge:te,n.metodo_pago=V?"PPD":"PUE",o=0,Object.keys(i).forEach((function(e){i[e].monto>o&&(o=i[e].monto,s=i[e].metodo_pago)})),n.forma_pago=s,e.next=28,Ie({variables:{input:n,empresa:t.empresa,sucursal:t.sucursal,usuario:a._id,caja:t.id_caja}});case 28:h(!1),j(!1),c(!0),localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal"),O(!m),F(!y),x({subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}),e.next=39;break;case 33:e.prev=33,e.t0=e.catch(4),h(!1),Fe({message:"Hubo un error",status:"error",open:!0}),console.log(e.t0),e.t0.networkError.result?console.log(e.t0.networkError.result.errors):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors.message);case 39:case"end":return e.stop()}}),e,null,[[4,33]])})));return function(){return e.apply(this,arguments)}}();return window.onkeydown=function(e){var t=e.keyCode;27===t&&i?ke():13===t&&n&&!d&&ze()},Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(w.a,{className:e.borderBotonChico,onClick:ke,disabled:!r||!i,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(p.a,{children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cart.svg",alt:"icono ventas",style:{width:38}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Pagar"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"ESC"})})})]})}),Object(B.jsxs)(Ee.a,{fullWidth:!0,maxWidth:"md",open:d,onClose:ke,TransitionComponent:ag,children:[Object(B.jsx)(J,{alert:Se,setAlert:Fe}),Object(B.jsx)(R.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:K,autoHideDuration:5e3,onClose:function(){return Q(!1)},message:"La cantidad total de la venta supera el cr\xe9dito disponible del cliente",action:Object(B.jsx)(X.a,{size:"small","aria-label":"close",color:"inherit",onClick:function(){return Q(!1)},children:Object(B.jsx)(Pt.a,{fontSize:"small"})})}),Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(p.a,{children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cart.svg",alt:"icono ventas",className:e.iconSizeDialogsPequeno})}),Object(B.jsx)(p.a,{mx:2,flexGrow:1,children:Object(B.jsx)(S.a,{variant:"h4",children:"Cerrar Venta"})}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:ke,size:"large",children:Object(B.jsx)(We.a,{})})]})}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(Qf,{montos:N,setMontos:P,totales:A,setTotales:T,venta_credito:V,montoEnCaja:re,setMontoEnCaja:ie,datosCliente:xe}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,justifyContent:"space-between",children:[Object(B.jsx)(Xf,{montos:N,totales:A,datosCliente:xe,monedero:ge,monederoTotal:te}),V?Object(B.jsx)(Zf,{montos:N,setMontos:P,setTotales:T,venta_credito:V,setMontoEnCaja:ie,datosCliente:xe,setDatosCliente:he,editarCliente:be,setEditarCliente:pe,fechaVencimientoDate:q,setfechaVencimientoDate:G}):null]})})]}),Object(B.jsxs)(Ue.a,{style:{justifyContent:"space-between"},children:[Object(B.jsxs)(p.a,{display:"flex",justifyContent:"flex-start",children:[Object(B.jsx)(p.a,{pr:1,children:V?Object(B.jsx)(w.a,{size:"large",variant:"contained",color:"secondary",onClick:function(){M(!1),pe(!1)},startIcon:Object(B.jsx)(Kf.a,{style:{fontSize:"28px"}}),children:"Cancelar"}):Object(B.jsx)(w.a,{size:"large",variant:"contained",color:"primary",onClick:function(){M(!0)},startIcon:Object(B.jsx)(Hf.a,{style:{fontSize:"28px"}}),disabled:!V||!le,children:"Credito"})}),Object(B.jsx)(tg,{venta_base:le,setVentaBase:de,montos:N,setMontos:P,totales:A,setTotales:T})]}),Object(B.jsx)(w.a,{onClick:function(){Pe()},size:"large",variant:"contained",color:"primary",autoFocus:!0,disabled:!le,children:"Terminar"})]})]}),Object(B.jsxs)(Ee.a,{open:n,onClose:function(){return ze()},TransitionComponent:ag,fullWidth:!0,maxWidth:"xs",children:[Object(B.jsx)(wt.a,{style:{textAlign:"center"},children:Object(B.jsx)(St.a,{severity:"success",action:Object(B.jsx)(X.a,{onClick:function(){return ze()},size:"small",color:"inherit",autoFocus:!0,children:Object(B.jsx)(Pt.a,{style:{fontSize:"25px"}})}),children:"Venta finalizada"})}),Object(B.jsx)(Ae.a,{children:Object(B.jsxs)(p.a,{mb:2,children:[Object(B.jsx)(S.a,{variant:"h6",align:"center",children:"Su c\xe1mbio"}),Object(B.jsxs)(S.a,{variant:"h3",align:"center",children:["$",Fa(A.cambio)]})]})})]})]})}var ig=a(255),og=a.n(ig),sg=a(256),lg=a.n(sg),dg=a(257),jg=a.n(dg);function ug(e){var t,a=e.productoBase,n=e.agregarProductos,c=i_(),r=Object(l.useState)(0),i=Object(g.a)(r,2),o=i[0],s=i[1];return Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,sm:4,xs:12,children:a.id_producto.imagenes.length>0?Object(B.jsx)(p.a,{px:2,border:1,children:Object(B.jsx)(og.a,{requestToChangeActive:s,activeItemIndex:o,numberOfCards:1,leftChevron:Object(B.jsx)(X.a,{"aria-label":"delete",disabled:!0,color:"primary",children:Object(B.jsx)(lg.a,{})}),rightChevron:Object(B.jsx)(X.a,{"aria-label":"delete",disabled:!0,color:"primary",children:Object(B.jsx)(jg.a,{})}),infiniteLoop:!0,outsideChevron:!0,chevronWidth:40,children:a.id_producto.imagenes.map((function(e,t){return Object(B.jsx)(p.a,{className:c.containerImagenesProducto,display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{alt:"Imagen producto",src:e.url_imagen,className:c.imagenProducto})},t)}))})}):Object(B.jsx)(p.a,{height:"150px",display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Nf.a,{color:"disabled",style:{fontSize:100}})})}),Object(B.jsx)($e.a,{item:!0,sm:8,xs:12,children:Object(B.jsx)(p.a,{display:"flex",alignItems:"center",height:"100%",children:Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:null===(t=a.id_producto)||void 0===t?void 0:t.datos_generales.nombre_comercial})}),Object(B.jsxs)(S.a,{children:["Codigo de barras: ",Object(B.jsx)("b",{children:a.codigo_barras})]}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{textAlign:"center",mr:2,children:Object(B.jsxs)(S.a,{children:["Unidad: ",Object(B.jsx)("b",{children:a.unidad})]})}),Object(B.jsx)(p.a,{textAlign:"center",mx:1,children:Object(B.jsxs)(S.a,{children:["Existencias: ",Object(B.jsx)("b",{children:a.inventario_general?a.inventario_general[0].cantidad_existente:0})]})})]}),!0===a.descuento_activo?Object(B.jsx)(S.a,{color:"primary",children:Object(B.jsx)("b",{children:"Descuento activo "})}):null,Object(B.jsxs)(p.a,{my:1,display:"flex",children:[!0===a.descuento_activo?Object(B.jsx)(p.a,{mr:2,children:Object(B.jsx)(S.a,{variant:"h5",color:"textSecondary",style:{textDecoration:"line-through"},children:Object(B.jsxs)("b",{children:[" $",Fa(a.precio)," "]})})}):null,Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"h4",children:!0===a.descuento_activo?Object(B.jsxs)("b",{children:["$",Fa(a.descuento.precio_neto)]}):Object(B.jsxs)("b",{children:["$",Fa(a.precio)]})})}),Object(B.jsx)(p.a,{mx:2}),Object(B.jsx)(w.a,{size:"large",onClick:function(){return n(a)},color:"primary",startIcon:Object(B.jsx)(It.a,{}),children:"Agregar"})]})]})})})]})}var bg=Object(k.a)({colorContainer:{height:28,width:28,borderRadius:"15%",fontSize:18,display:"flex",justifyContent:"center",alignItems:"center"}});function pg(e){var t,a=e.productos,n=e.agregarProductos,c=bg(),r=Object(l.useState)(0),i=Object(g.a)(r,2),o=i[0],s=i[1],d=a[0];return Object(B.jsxs)(p.a,{children:[Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,sm:4,xs:12,children:d.id_producto.imagenes.length>0?Object(B.jsx)(p.a,{px:2,border:1,children:Object(B.jsx)(og.a,{requestToChangeActive:s,activeItemIndex:o,numberOfCards:1,leftChevron:Object(B.jsx)(X.a,{"aria-label":"delete",disabled:!0,color:"primary",children:Object(B.jsx)(lg.a,{})}),rightChevron:Object(B.jsx)(X.a,{"aria-label":"delete",disabled:!0,color:"primary",children:Object(B.jsx)(jg.a,{})}),infiniteLoop:!0,outsideChevron:!0,chevronWidth:40,children:d.id_producto.imagenes.map((function(e,t){return Object(B.jsx)(p.a,{className:c.containerImagenesProducto,display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{alt:"Imagen producto",src:e.url_imagen,className:c.imagenProducto})},t)}))})}):Object(B.jsx)(p.a,{height:"150px",display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)(Nf.a,{color:"disabled",style:{fontSize:100}})})}),Object(B.jsx)($e.a,{item:!0,sm:8,xs:12,children:Object(B.jsx)(p.a,{display:"flex",alignItems:"center",height:"100%",children:Object(B.jsxs)(p.a,{width:"100%",children:[Object(B.jsx)(S.a,{variant:"h6",children:Object(B.jsx)("b",{children:null===(t=d.id_producto)||void 0===t?void 0:t.datos_generales.nombre_comercial})}),Object(B.jsxs)(p.a,{display:"flex",children:[Object(B.jsx)(p.a,{textAlign:"center",mr:2,children:Object(B.jsxs)(S.a,{children:["Unidad: ",Object(B.jsx)("b",{children:d.unidad})]})}),Object(B.jsx)(p.a,{textAlign:"center",mx:1,children:Object(B.jsxs)(S.a,{children:["Existencias: ",Object(B.jsx)("b",{children:d.inventario_general?d.inventario_general[0].cantidad_existente:0})]})})]})]})})})]}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{size:"small","aria-label":"simple table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{padding:"checkbox"}),Object(B.jsx)(Oa.a,{children:"C\xf3digo"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Cantidad"}),Object(B.jsx)(Oa.a,{padding:"checkbox",children:"Color/Talla"}),Object(B.jsx)(Oa.a,{children:"Precio"}),Object(B.jsx)(Oa.a,{children:"Descuento"})]})}),Object(B.jsx)(xa.a,{children:a.map((function(e,t){return Object(B.jsx)(mg,{producto:e,agregarProductos:n},t)}))})]})})})]})}var mg=function(e){var t=e.producto,a=e.agregarProductos,n=bg(),c=Object(Se.a)(),r=function(){return t.color&&t.medida?Object(B.jsx)(Oa.a,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"56px"},children:Object(B.jsx)(ha.a,{title:t.color.nombre,placement:"top",arrow:!0,children:Object(B.jsx)("div",{className:n.colorContainer,style:{backgroundColor:t.color.hex,color:c.palette.getContrastText(t.color.hex)},children:t.medida.talla})})}):Object(B.jsx)(Oa.a,{align:"center",children:"N/A"})},i=function(){return!0===t.descuento_activo&&t.descuento?Object(B.jsx)(Oa.a,{children:Object(B.jsxs)(S.a,{color:"primary",children:["$",Fa(t.descuento.precio_neto)]})}):Object(B.jsx)(Oa.a,{align:"center",children:"$0.00"})};return Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(X.a,{size:"small",onClick:function(){return a(t)},color:"primary",children:Object(B.jsx)(It.a,{})})}),Object(B.jsx)(Oa.a,{children:t.codigo_barras}),Object(B.jsx)(Oa.a,{children:t.cantidad}),Object(B.jsx)(r,{}),Object(B.jsxs)(Oa.a,{children:["$",Fa(t.precio)]}),Object(B.jsx)(i,{})]})},Og=["cantidad_venta"];function xg(e){var t=e.dataQuery,a=e.handleClickOpen,n=null,c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(l.useState)(!1),i=Object(g.a)(r,2),o=i[0],s=i[1],d=t.data,j=t.loading,u=t.error,m=Object(l.useContext)(o_),O=m.updateTablaVentas,x=m.setUpdateTablaVentas,h=m.setDatosVentasActual;if(j)return Object(B.jsx)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"53vh",children:Object(B.jsx)(I.a,{})});if(u)return Object(B.jsx)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:Object(B.jsx)(Ze,{})});if(d&&0===d.obtenerUnProductoVentas.length)return Object(B.jsx)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:"NO HAY"});if(d&&(n=d.obtenerUnProductoVentas),null===n)return Object(B.jsx)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:"BUSCA UN PRODUCTO"});var _=c.empresa.vender_sin_inventario,v=function(){var e=Object(f.a)(C.a.mark((function e(t){var n,c,r,i,o,l,d,j,u,p,m,f,g,v,y,S,F,w;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("medidas"!==t.concepto){e.next=6;break}if(_||0!==t.cantidad){e.next=4;break}return s(!0),e.abrupt("return");case 4:e.next=9;break;case 6:if(_||0!==t.inventario_general[0].cantidad_existente){e.next=9;break}return s(!0),e.abrupt("return");case 9:return n=JSON.parse(localStorage.getItem("DatosVentas")),c=null===n?[]:n.productos,r=null===n?[]:n,i=null===n?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:n,o=c,l={subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0},e.next=17,Ia(t);case 17:if((d=e.sent).found||!t._id){e.next=34;break}return j=Object(b.a)({},t),u=j.descuento_activo?j.descuento.precio_neto:j.precio_unidad.precio_neto,e.next=23,ka({newP:j,cantidad:0,granel:{granel:!1,valor:0},origen:"Ventas1",precio_boolean:!1});case 23:(p=e.sent).newP.precio_anterior=u,p.newP.iva_total_producto=parseFloat(p.ivaCalculo),p.newP.ieps_total_producto=parseFloat(p.iepsCalculo),p.newP.impuestos_total_producto=parseFloat(p.impuestoCalculo),p.newP.subtotal_total_producto=parseFloat(p.subtotalCalculo),p.newP.total_total_producto=parseFloat(p.totalCalculo),o.splice(0,0,p.newP),l={subTotal:parseFloat(i.subTotal)+parseFloat(p.subtotalCalculo),total:parseFloat(i.total)+parseFloat(p.totalCalculo),impuestos:parseFloat(i.impuestos)+parseFloat(p.impuestoCalculo),iva:parseFloat(i.iva)+parseFloat(p.ivaCalculo),ieps:parseFloat(i.ieps)+parseFloat(p.iepsCalculo),descuento:parseFloat(i.descuento)+parseFloat(p.descuentoCalculo),monedero:parseFloat(i.monedero)+parseFloat(p.monederoCalculo)},e.next=72;break;case 34:if(!d.found||!t._id){e.next=72;break}return m=d.producto_found.producto,f=m.cantidad_venta,(g=Object(ve.a)(m,Og)).cantidad_venta=parseInt(f)+1,e.next=39,za(g);case 39:if(!(v=e.sent).found){e.next=60;break}return e.next=43,ka({newP:g,cantidad_venta:f,granel:g.granel_producto,origen:"",precio_boolean:!0,precio:g.precio_actual_object});case 43:return y=e.sent,e.next=46,ka({newP:g,cantidad_venta:g.cantidad_venta,granel:g.granel_producto,origen:"",precio_boolean:!0,precio:v.object_prising});case 46:S=e.sent,g.precio_a_vender=S.totalCalculo,g.precio_anterior=g.precio_actual_producto,g.precio_actual_producto=v.pricing,g.iva_total_producto=parseFloat(S.ivaCalculo),g.ieps_total_producto=parseFloat(S.iepsCalculo),g.impuestos_total_producto=parseFloat(S.impuestoCalculo),g.subtotal_total_producto=parseFloat(S.subtotalCalculo),g.total_total_producto=parseFloat(S.totalCalculo),g.precio_actual_object={cantidad_unidad:v.object_prising.cantidad_unidad?v.object_prising.cantidad_unidad:null,numero_precio:v.object_prising.numero_precio?v.object_prising.numero_precio:null,unidad_maxima:v.object_prising.unidad_maxima?v.object_prising.unidad_maxima:null,precio_general:v.object_prising.precio_general?v.object_prising.precio_general:null,precio_neto:v.object_prising.precio_neto?v.object_prising.precio_neto:null,precio_venta:v.object_prising.precio_venta?v.object_prising.precio_venta:null,iva_precio:v.object_prising.iva_precio?v.object_prising.iva_precio:null,ieps_precio:v.object_prising.ieps_precio?v.object_prising.ieps_precio:null,utilidad:v.object_prising.utilidad?v.object_prising.utilidad:null,porciento:v.object_prising.porciento?v.object_prising.porciento:null,dinero_descontado:v.object_prising.dinero_descontado?v.object_prising.dinero_descontado:null},o.splice(d.producto_found.index,1,g),l={subTotal:parseFloat(i.subTotal)-parseFloat(y.subtotalCalculo)+S.subtotalCalculo,total:parseFloat(i.total)-parseFloat(y.totalCalculo)+S.totalCalculo,impuestos:parseFloat(i.impuestos)-parseFloat(y.impuestoCalculo)+S.impuestoCalculo,iva:parseFloat(i.iva)-parseFloat(y.ivaCalculo)+S.ivaCalculo,ieps:parseFloat(i.ieps)-parseFloat(y.iepsCalculo)+S.iepsCalculo,descuento:parseFloat(i.descuento)-parseFloat(y.descuentoCalculo)+S.descuentoCalculo,monedero:parseFloat(i.monedero)-parseFloat(y.monederoCalculo)+S.monederoCalculo},e.next=72;break;case 60:return F=g.descuento_activo?g.descuento.precio_neto:g.precio_unidad.precio_neto,e.next=63,ka({newP:g,cantidad:0,granel:{granel:!1,valor:0},origen:"Ventas2"});case 63:(w=e.sent).newP.precio_actual_producto=F,w.newP.iva_total_producto=parseFloat(w.ivaCalculo)*parseFloat(g.cantidad_venta),w.newP.ieps_total_producto=parseFloat(w.iepsCalculo)*parseFloat(g.cantidad_venta),w.newP.impuestos_total_producto=parseFloat(w.impuestoCalculo)*parseFloat(g.cantidad_venta),w.newP.subtotal_total_producto=parseFloat(w.subtotalCalculo)*parseFloat(g.cantidad_venta),w.newP.total_total_producto=parseFloat(w.totalCalculo)*parseFloat(g.cantidad_venta),o.splice(d.producto_found.index,1,w.newP),l={subTotal:parseFloat(i.subTotal)+parseFloat(w.subtotalCalculo),total:parseFloat(i.total)+w.totalCalculo,impuestos:parseFloat(i.impuestos)+w.impuestoCalculo,iva:parseFloat(i.iva)+w.ivaCalculo,ieps:parseFloat(i.ieps)+w.iepsCalculo,descuento:parseFloat(i.descuento)+w.descuentoCalculo,monedero:parseFloat(i.monedero)+w.monederoCalculo};case 72:localStorage.setItem("DatosVentas",JSON.stringify(Object(b.a)(Object(b.a)({},l),{},{cliente:!0===r.venta_cliente?r.cliente:{},venta_cliente:!0===r.venta_cliente&&r.venta_cliente,productos:o,tipo_emision:r.tipo_emision?r.tipo_emision:"TICKET"}))),h(Object(b.a)({},l)),x(!O),a();case 76:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(R.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:o,onClose:function(){return s(!1)},message:"Producto sin existencias",autoHideDuration:3e3}),1===n.length?Object(B.jsx)(ug,{productoBase:n[0],agregarProductos:v}):Object(B.jsx)(pg,{productos:n,agregarProductos:v})]})}var hg=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function _g(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=JSON.parse(localStorage.getItem("turnoEnCurso")),a=Object(l.useState)(""),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)({data:void 0,loading:!1,error:void 0}),o=Object(g.a)(i,2),s=o[0],d=o[1],j=Object(Gi.a)(),u=function(){var t=Object(f.a)(C.a.mark((function t(){var a,n,r,i;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,d(Object(b.a)(Object(b.a)({},s),{},{loading:!0})),t.next=4,j.query({query:Cp,variables:{datosProductos:c.toUpperCase(),empresa:e.empresa._id,sucursal:e.sucursal._id},fetchPolicy:"network-only"});case 4:a=t.sent,n=a.loading,r=a.data,i=a.error,d({data:r,loading:n,error:i}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0),d({data:void 0,loading:!1,error:t.t0});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),m=Object(l.useState)(!1),O=Object(g.a)(m,2),x=O[0],h=O[1],_=i_(),v=function(){h(!x),d({data:void 0,loading:!1,error:void 0})},y=function(){var e=Object(f.a)(C.a.mark((function e(t){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"Enter"!==t.code&&"NumpadEnter"!==t.code||u();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return window.addEventListener("keydown",(function(e){120===e.keyCode&&v()})),Object(l.useEffect)((function(){t=JSON.parse(localStorage.getItem("turnoEnCurso"))}),[t]),Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(w.a,{className:_.borderBotonChico,onClick:v,disabled:!t,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(p.a,{children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/precios.svg",alt:"icono ventas",style:{width:36}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Consultar Precio"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"F9"})})})]})}),Object(B.jsxs)(Ee.a,{open:x,fullWidth:!0,onClose:v,TransitionComponent:hg,PaperProps:{style:{minWidth:"650px"}},children:[Object(B.jsxs)(wt.a,{children:[Object(B.jsxs)(p.a,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/productos.svg",alt:"icono productos",style:{width:50}}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(S.a,{variant:"h6",children:"Precio Producto"})]}),Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:v,children:Object(B.jsx)(We.a,{})})]}),Object(B.jsx)(p.a,{mt:3,children:Object(B.jsx)(F.a,{fullWidth:!0,variant:"outlined",size:"small",placeholder:"Buscar producto por CLAVE ALTERNA",onKeyUp:y,onChange:function(e){return r(e.target.value)},InputProps:{endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(X.a,{onClick:function(e){return u(e)},children:Object(B.jsx)(sc.a,{})})})},inputProps:{style:{textTransform:"uppercase"}}})})]}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(xg,{dataQuery:s,handleClickOpen:v})})]})]})}var fg=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function gg(){var e,t,a,n,c,r=i_(),i=Object(l.useState)(!1),o=Object(g.a)(i,2),s=o[0],d=o[1],j=JSON.parse(localStorage.getItem("sesionCafi")),u=JSON.parse(localStorage.getItem("turnoEnCurso")),m=Object(l.useState)({}),O=Object(g.a)(m,2),x=O[0],h=O[1],_=Object(l.useContext)(o_),v=_.productoCambioPrecio,y=_.precioSelectProductoVenta,F=_.setPrecioSelectProductoVenta,I=_.setUpdateTablaVentas,k=_.updateTablaVentas,z=Object(l.useContext)(O_),N=z.reloadVerPrecios,P=z.setReloadVerPrecios,D=z.setAbrirPanelAcceso,E=z.abrirPanelAcceso,A=z.setDepartamentos,T=Object(l.useState)(y.length>0?y[0]:{}),W=Object(g.a)(T,2),$=W[0],R=W[1],V=Object(l.useState)({message:"",status:"",open:!1}),M=Object(g.a)(V,2),L=M[0],U=M[1],q=function(){!0===j.accesos.ventas.precios_productos.ver?d(!s):(D(!E),A({departamento:"ventas",subDepartamento:"precios_productos",tipo_acceso:"ver"}))};Object(l.useEffect)((function(){h(v)}),[v]),Object(l.useEffect)((function(){!0===N&&(d(!s),P(!1))}),[N]);var G=function(){var e=Object(f.a)(C.a.mark((function e(){var t,a,n,c,r,i,o,s,l,d,j;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=JSON.parse(localStorage.getItem("DatosVentas")),a=null===t?[]:t.productos,n=null===t?[]:t,c=null===t?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:t,r=a,!($.precio_neto>0||y.length>0)){e.next=40;break}return i=Object(b.a)({},v),o=Object(b.a)({},v),e.next=10,Ia(v);case 10:if(!(s=e.sent).found){e.next=37;break}return e.next=14,ka({newP:i,cantidad:i.cantidad_venta,precio_boolean:!0,precio:i.precio_actual_object,granel:i.granel_producto,origen:""});case 14:return l=e.sent,e.next=17,ka({newP:o,cantidad:o.cantidad_venta,precio_boolean:!0,precio:y[0],granel:o.granel_producto,origen:"Tabla"});case 17:d=e.sent,o.precio_a_vender=y[0].precio_neto,o.precio_seleccionado=!0,o.precio_actual_producto=parseFloat(y[0].precio_neto.toFixed(2)),o.precio_actual_object=y[0],o.iva_total_producto=parseFloat(d.ivaCalculo),o.ieps_total_producto=parseFloat(d.iepsCalculo),o.impuestos_total_producto=parseFloat(d.impuestoCalculo),o.subtotal_total_producto=parseFloat(d.subtotalCalculo),o.total_total_producto=parseFloat(d.totalCalculo),o.precio_actual_object={cantidad_unidad:y[0].cantidad_unidad?y[0].cantidad_unidad:null,numero_precio:y[0].numero_precio?y[0].numero_precio:null,unidad_maxima:y[0].unidad_maxima?y[0].unidad_maxima:null,precio_general:y[0].precio_general?y[0].precio_general:null,precio_neto:y[0].precio_neto?y[0].precio_neto:null,precio_venta:y[0].precio_venta?y[0].precio_venta:null,iva_precio:y[0].iva_precio?y[0].iva_precio:null,ieps_precio:y[0].ieps_precio?y[0].ieps_precio:null,utilidad:y[0].utilidad?y[0].utilidad:null,porciento:y[0].porciento?y[0].porciento:null,dinero_descontado:y[0].dinero_descontado?y[0].dinero_descontado:null},r.splice(s.producto_found.index,1,o),j={subTotal:parseFloat(c.subTotal)-parseFloat(l.subtotalCalculo)+d.subtotalCalculo,total:parseFloat(c.total)-parseFloat(l.totalCalculo)+d.totalCalculo,impuestos:parseFloat(c.impuestos)-parseFloat(l.impuestoCalculo)+d.impuestoCalculo,iva:parseFloat(c.iva)-parseFloat(l.ivaCalculo)+d.ivaCalculo,ieps:parseFloat(c.ieps)-parseFloat(l.iepsCalculo)+d.iepsCalculo,descuento:parseFloat(c.descuento)-parseFloat(l.descuentoCalculo)+d.descuentoCalculo,monedero:parseFloat(c.monedero)-parseFloat(l.monederoCalculo)+d.monederoCalculo},localStorage.setItem("DatosVentas",JSON.stringify(Object(b.a)(Object(b.a)({},j),{},{cliente:!0===n.venta_cliente?n.cliente:{},venta_cliente:!0===n.venta_cliente&&n.venta_cliente,productos:r,tipo_emision:n.tipo_emision?n.tipo_emision:"TICKET"}))),I(!k),F([]),h({}),q(),e.next=38;break;case 37:console.log("Producto no encontrado");case 38:e.next=41;break;case 40:U({message:"Este precio no es valido.",status:"error",open:!0});case 41:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(e){var t=[];t=t.concat([],e),R(e),F(t)};return window.addEventListener("keydown",(function(e){114===e.keyCode&&q()})),Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(J,{alert:L,setAlert:U}),Object(B.jsx)(w.a,{className:r.borderBotonChico,onClick:q,disabled:!u||!y.length,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(p.a,{style:u&&y.length?null:{pointerEvents:"none",opacity:.5},children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/money.svg",alt:"icono money",style:{fontSize:25}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Precios"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"F3"})})})]})}),Object(B.jsxs)(Ee.a,{maxWidth:"lg",open:s,onClose:function(){return d(!s)},TransitionComponent:fg,children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{display:"flex",justifyContent:"space-between",children:[Object(B.jsx)(S.a,{variant:"h6",children:"Precios de Producto"}),Object(B.jsx)(p.a,{children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){return d(!s)},size:"large",children:Object(B.jsx)(We.a,{})})})]})}),Object(B.jsxs)(Ae.a,{children:[Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(S.a,{variant:"h6",align:"center",children:v?null===v||void 0===v||null===(e=v.id_producto)||void 0===e||null===(t=e.datos_generales)||void 0===t?void 0:t.nombre_comercial:""})}),Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{padding:"checkbox"}),Object(B.jsx)(Oa.a,{children:"No. Precio"}),Object(B.jsx)(Oa.a,{children:"Precio neto"}),Object(B.jsx)(Oa.a,{children:"Unidad mayoreo"}),Object(B.jsx)(Oa.a,{children:"Utilidad"})]})}),Object(B.jsx)(xa.a,{children:null===x||void 0===x||null===(a=x.id_producto)||void 0===a||null===(n=a.precios)||void 0===n||null===(c=n.precios_producto)||void 0===c?void 0:c.map((function(e,t){var a,n=(a=e,-1!==y.indexOf(a)),c="enhanced-table-checkbox-".concat(t);return Object(B.jsx)(vg,{precio:e,isItemSelected:n,labelId:c,handleClick:H},t)}))})]})})})]}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(w.a,{onClick:function(){return G()},variant:"contained",color:"primary",size:"large",children:"Guardar"})})]})]})}var vg=function(e){var t=e.precio,a=e.isItemSelected,n=e.labelId,c=e.handleClick;return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)(ma.a,{role:"checkbox","aria-checked":a,tabIndex:-1,selected:a,hover:!0,onClick:function(e){return function(e){if(!(t.precio_neto<=0))try{2===e.detail&&c(t)}catch(a){console.log(a)}}(e)},children:[Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(Me.a,{disabled:t.precio_neto<=0,onClick:function(e){c(t)},checked:a,inputProps:{"aria-labelledby":n}})}),Object(B.jsx)(Oa.a,{align:"center",children:t.numero_precio}),Object(B.jsx)(Oa.a,{align:"center",children:t.precio_neto>0?Fa(t.precio_neto):0}),Object(B.jsx)(Oa.a,{align:"center",children:t.unidad_mayoreo}),Object(B.jsxs)(Oa.a,{align:"center",children:[t.utilidad," %"]})]},t.numero_precio)})},Cg=[{id:"fecha",label:"Fecha",minWidth:20,align:"center"},{id:"cliente",label:"Cliente",minWidth:330,align:"center"},{id:"productos",label:"Productos",minWidth:20,align:"center"},{id:"total",label:"Total",minWidth:200,align:"center"}],yg=Object(k.a)({root:{width:"100%"},container:{height:"45vh","& ::-webkit-scrollbar":{display:"none"}}});function Sg(e){var t=e.handleModalEspera,a=yg(),n=JSON.parse(localStorage.getItem("ListaEnEspera"));return Object(B.jsx)(Ka.a,{className:a.root,children:Object(B.jsx)(ba.a,{className:a.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Cg.map((function(e,t){return Object(B.jsx)(Oa.a,{align:e.align,style:{width:e.minWidth},children:e.label},t)})),Object(B.jsx)(Oa.a,{align:"center",style:{width:35},children:"Regresar"}),Object(B.jsx)(Oa.a,{align:"center",style:{width:35},children:"Eliminar"})]})}),Object(B.jsx)(xa.a,{children:null===n||void 0===n?void 0:n.map((function(e,a){return Object(B.jsx)(Fg,{venta:e,index:a,handleModalEspera:t},a)}))})]})})})}var Fg=function(e){var t=e.venta,a=e.index,n=e.handleModalEspera,c=Object(l.useContext)(O_),r=c.reloadEliminarVentaEspera,i=c.setReloadEliminarVentaEspera,o=c.setAbrirPanelAcceso,s=c.abrirPanelAcceso,d=c.setDepartamentos,j=Object(l.useContext)(o_),u=j.updateTablaVentas,b=j.setUpdateTablaVentas,p=Object(l.useContext)(Xi),m=p.updateClientVenta,O=p.setUpdateClientVenta,x=Object(l.useState)(!1),h=Object(g.a)(x,2),_=h[0],f=h[1],v=JSON.parse(localStorage.getItem("sesionCafi")),C=JSON.parse(localStorage.getItem("ListaEnEspera")),y=JSON.parse(localStorage.getItem("DatosVentas"));function S(){if(!0!==v.accesos.ventas.eliminar_ventas.ver)return null;var e=Object(da.a)(C);e.splice(a,1),0===e.length?localStorage.removeItem("ListaEnEspera"):localStorage.setItem("ListaEnEspera",JSON.stringify(e)),b(!u)}var F=function(){b(!u),O(!m)};return Object(l.useEffect)((function(){!0===r&&(S(),i(!1))}),[r]),Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)(ma.a,{hover:!0,tabIndex:-1,children:[Object(B.jsx)(Oa.a,{align:"center",children:t.fecha?t.fecha:""}),Object(B.jsx)(Oa.a,{align:"center",children:t.datosVenta.cliente&&t.datosVenta.cliente.nombre_cliente?t.datosVenta.cliente.nombre_cliente:"Pub. General"}),Object(B.jsx)(Oa.a,{align:"center",children:t.datosVenta.productos.length}),Object(B.jsxs)(Oa.a,{align:"center",children:["$ ",Fa(t.datosVenta.total)]}),Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)(wg,{AgregarVentaDeNuevo:function(){if(null===y){var e=Object(da.a)(C);if(localStorage.setItem("DatosVentas",JSON.stringify(t.datosVenta)),e.splice(a,1),0===e.length)return localStorage.removeItem("ListaEnEspera"),F(),void n();localStorage.setItem("ListaEnEspera",JSON.stringify(e)),F(),n()}else f(!_)},open:_,handleClickOpen:function(){f(!_)}})}),Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)(Ig,{verificarPermisos:function(){!0===v.accesos.ventas.eliminar_ventas.ver?S():(o(!s),d({departamento:"ventas",subDepartamento:"eliminar_ventas",tipo_acceso:"ver"}))}})})]})})},wg=function(e){var t=e.open,a=e.handleClickOpen,n=e.AgregarVentaDeNuevo;return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(X.a,{"aria-label":"regresar",color:"primary",size:"small",onClick:function(){return n()},children:Object(B.jsx)(J_.a,{fontSize:"medium"})}),Object(B.jsx)(R.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:t,autoHideDuration:5e3,onClose:a,message:"No puedes agregar una venta cuando ya est\xe1 una en curso.",action:Object(B.jsx)(X.a,{size:"small","aria-label":"close",color:"inherit",onClick:a,children:Object(B.jsx)(We.a,{fontSize:"small"})})})]})},Ig=function(e){var t=e.verificarPermisos,a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=function(){return r(!1)};return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(X.a,{"aria-label":"delete",size:"small",onClick:function(){return r(!0)},children:Object(B.jsx)(Ju.a,{fontSize:"medium"})}),Object(B.jsxs)(Ee.a,{onClose:function(){return i()},open:c,children:[Object(B.jsx)(wt.a,{children:"Se eliminara esta venta en espera"}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{color:"inherit",size:"small",onClick:function(){return i()},children:"Cancelar"}),Object(B.jsx)(w.a,{color:"secondary",size:"small",onClick:function(){return t()},children:"Eliminar"})]})]})]})},kg=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function zg(){var e=JSON.parse(localStorage.getItem("ListaEnEspera")),t=JSON.parse(localStorage.getItem("turnoEnCurso")),a=Object(l.useContext)(o_).updateTablaVentas,n=i_(),c=Object(l.useState)(!1),r=Object(g.a)(c,2),i=r[0],o=r[1],s=function(){o(!i)};return window.addEventListener("keydown",(function(e){e.altKey&&76===e.keyCode&&s()})),Object(l.useEffect)((function(){e&&(e=JSON.parse(localStorage.getItem("ListaEnEspera")))}),[a]),Object(l.useEffect)((function(){t=JSON.parse(localStorage.getItem("turnoEnCurso"))}),[a,t]),Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(w.a,{className:n.borderBotonChico,onClick:s,disabled:!t,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(p.a,{children:Object(B.jsx)(nc.a,{badgeContent:e?e.length:0,color:"primary",style:{fontSize:45},children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/lista-de-espera.svg",alt:"icono caja2",style:{width:38}})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Ventas en Espera"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"Alt + L"})})})]})}),Object(B.jsx)(Ee.a,{maxWidth:"lg",open:i,onClose:s,TransitionComponent:kg,children:Object(B.jsxs)(Ae.a,{children:[Object(B.jsxs)($e.a,{container:!0,item:!0,lg:12,children:[Object(B.jsxs)(p.a,{display:"flex",flexGrow:1,children:[Object(B.jsx)(p.a,{children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/lista-de-espera.svg",alt:"icono caja",className:n.iconSizeDialogs})}),Object(B.jsx)(p.a,{m:2,children:Object(B.jsx)(Le.a,{orientation:"vertical"})}),Object(B.jsx)(p.a,{mt:3,children:Object(B.jsx)(S.a,{variant:"h6",children:"Ventas en espera"})})]}),Object(B.jsx)(p.a,{children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:s,size:"large",children:Object(B.jsx)(We.a,{})})})]}),Object(B.jsx)($e.a,{children:Object(B.jsx)(Sg,{handleModalEspera:s})})]})})]})}var Ng=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Pg(e){var t=e.venta,a=e.handleCloseInfoVenta,n=e.refetch,c=e.dinero_disponible,r=e.selected,i=e.view,o=Object(l.useContext)(O_),s=o.reloadCancelarVenta,d=o.setReloadCancelarVenta,j=o.setAbrirPanelAcceso,u=o.abrirPanelAcceso,m=o.setDepartamentos,O=Object(l.useState)(!1),x=Object(g.a)(O,2),h=x[0],v=x[1],k=Object(l.useState)(!1),N=Object(g.a)(k,2),P=N[0],D=N[1],E=Object(l.useState)({message:"",status:"",open:!1}),A=Object(g.a)(E,2),T=A[0],W=A[1],$=Object(l.useState)({observaciones:"",devolucion_efectivo:!1,devolucion_credito:!1}),R=Object(g.a)($,2),V=R[0],M=R[1],L=JSON.parse(localStorage.getItem("turnoEnCurso")),U=JSON.parse(localStorage.getItem("sesionCafi")),q=Object(z.a)(kp),G=Object(g.a)(q,1)[0],H=function(){if(!0===U.accesos.ventas.cancelar_venta.editar)v(!0);else{if(!s)return;v(!0)}},Y=function(){v(!1)},K=function(e){var t=e.target,a=t.name,n=t.checked;M(Object(b.a)(Object(b.a)({},V),{},Object(_.a)({},a,n)))},Z=function(){var e=Object(f.a)(C.a.mark((function e(){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),e.prev=1,V.turno={horario_en_turno:L.horario_en_turno,numero_caja:parseInt(L.numero_caja),id_caja:L.id_caja,usuario_en_turno:{nombre:L.usuario_en_turno.nombre,numero_usuario:L.usuario_en_turno.numero_usuario,_id:U._id},empresa:L.empresa,sucursal:L.sucursal},e.next=5,G({variables:{input:V,empresa:t.empresa,sucursal:t.sucursal,folio:t.folio}});case 5:a=e.sent,W({message:"\xa1Listo! ".concat(a.data.cancelarVentasSucursal.message),status:"success",open:!0}),D(!1),M({devolucion_efectivo:!1,observaciones:"",devolucion_credito:!1}),n(),Y(),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0),D(!1),e.t0.message?W({message:e.t0.message,status:"error",open:!0}):W({message:"Hubo un error",status:"error",open:!0}),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 19:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}(),ee=function(){!0===U.accesos.ventas.cancelar_venta.editar?H():(j(!u),m({departamento:"ventas",subDepartamento:"cancelar_venta",tipo_acceso:"editar"}))},te="";return"table"===i&&(te=r),Object(l.useEffect)((function(){!0===s&&te._id===t._id&&(H(),d(!1))}),[s]),Object(B.jsxs)("div",{children:[a?Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){return ee()},startIcon:Object(B.jsx)(ur.a,{}),disabled:"CANCELADA"===t.status,children:"Cancelar venta"}):Object(B.jsx)(X.a,{size:"small",color:"secondary",onClick:function(){return ee()},disabled:"CANCELADA"===t.status,children:Object(B.jsx)(ur.a,{})}),Object(B.jsx)(J,{alert:T,setAlert:W}),Object(B.jsxs)(Ee.a,{open:h,TransitionComponent:Ng,keepMounted:!0,onClose:Y,fullWidth:!0,maxWidth:"xs",children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[Object(B.jsx)(S.a,{variant:"h6",children:"Cancelar venta"}),Object(B.jsx)(w.a,{size:"small",variant:"contained",color:"secondary",onClick:function(){return Y()},children:Object(B.jsx)(Pt.a,{})})]})}),Object(B.jsx)(Ae.a,{children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(Ve.a,{control:Object(B.jsx)(Me.a,{checked:V.devolucion_credito,onChange:K,name:"devolucion_credito",disabled:!t.credito}),label:"Realizar devolucion de cr\xe9dito"}),Object(B.jsx)(Ve.a,{control:Object(B.jsx)(Me.a,{checked:V.devolucion_efectivo,onChange:K,name:"devolucion_efectivo",disabled:t.montos_en_caja.monto_efectivo.monto>c}),label:"Realizar devolucion de dinero"}),Object(B.jsx)(p.a,{my:2,children:Object(B.jsxs)(y.a,{maxWidth:"xs",children:[Object(B.jsx)(p.a,{mb:1,children:Object(B.jsx)(S.a,{children:"Devoluci\xf3n en:"})}),Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,xs:12,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[Object(B.jsx)(S.a,{style:{width:"120px"},children:"Efectivo"}),Object(B.jsx)(p.a,{mr:1}),Object(B.jsx)(F.a,{variant:"standard",size:"small",disabled:!0,value:t.montos_en_caja.monto_efectivo.monto,style:{width:"150px"},InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})}})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[Object(B.jsx)(S.a,{style:{width:"120px"},children:"T. Cr\xe9dito"}),Object(B.jsx)(p.a,{mr:1}),Object(B.jsx)(F.a,{variant:"standard",size:"small",disabled:!0,value:t.montos_en_caja.monto_tarjeta_credito.monto,style:{width:"150px"},InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})}})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[Object(B.jsx)(S.a,{style:{width:"120px"},children:"M. Electr\xf3nico"}),Object(B.jsx)(p.a,{mr:1}),Object(B.jsx)(F.a,{variant:"standard",size:"small",disabled:!0,value:t.montos_en_caja.monto_monedero.monto,style:{width:"150px"},InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})}})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[Object(B.jsx)(S.a,{style:{width:"120px"},children:"Transferencia"}),Object(B.jsx)(p.a,{mr:1}),Object(B.jsx)(F.a,{variant:"standard",size:"small",disabled:!0,value:t.montos_en_caja.monto_transferencia.monto,style:{width:"150px"},InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})}})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[Object(B.jsx)(S.a,{style:{width:"120px"},children:"Cheques"}),Object(B.jsx)(p.a,{mr:1}),Object(B.jsx)(F.a,{variant:"standard",size:"small",disabled:!0,value:t.montos_en_caja.monto_cheques.monto,style:{width:"150px"},InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})}})]})]})]})}),Object(B.jsx)(F.a,{label:"Observaciones",variant:"outlined",fullWidth:!0,multiline:!0,rows:3,value:V.observaciones,onChange:function(e){return M(Object(b.a)(Object(b.a)({},V),{},{observaciones:e.target.value}))}})]})}),Object(B.jsxs)(Ue.a,{children:[Object(B.jsx)(w.a,{onClick:Y,color:"inherit",disabled:P,children:"Salir"}),Object(B.jsx)(w.a,{onClick:Z,color:"secondary",disabled:P,startIcon:P?Object(B.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Cancelar Venta"})]})]})]})}var Dg=Object(k.a)((function(e){return{colorContainer:{height:28,width:28,borderRadius:"15%",fontSize:18,display:"flex",justifyContent:"center",alignItems:"center"}}})),Eg=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Ag(e){var t=e.venta,a=e.open,n=e.handleClose,c=e.refetch;return t?Object(B.jsxs)(Ee.a,{open:a,TransitionComponent:Eg,keepMounted:!0,onClose:n,fullWidth:!0,maxWidth:"xl",children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{style:{display:"flex",justifyContent:"space-between"},children:[Object(B.jsxs)(p.a,{children:[Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Caja: "})," ".concat(t.id_caja.numero_caja)]}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Usuario en caja:"})," "," ".concat(t.usuario.nombre)]})]}),Object(B.jsxs)(p.a,{children:[Object(B.jsxs)(S.a,{align:"right",children:[Object(B.jsx)("b",{children:"Folio:"})," ".concat(t.folio)]}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsxs)(S.a,{children:[Object(B.jsx)("b",{children:"Fecha:"})," ".concat(Sa(t.fecha_registro))]})]})]})}),Object(B.jsxs)(Ae.a,{children:[null!==t.cliente?Object(B.jsxs)(p.a,{my:2,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Re.a,{children:Object(B.jsx)(K_.a,{})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"h6",children:"Cliente"})})]}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Numero de Cliente"}),Object(B.jsx)(Oa.a,{children:"Nombre"}),Object(B.jsx)(Oa.a,{children:"Clave"}),Object(B.jsx)(Oa.a,{children:"Telefono"})]})}),Object(B.jsx)(xa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:t.cliente.numero_cliente}),Object(B.jsx)(Oa.a,{children:t.cliente.nombre_cliente}),Object(B.jsx)(Oa.a,{children:t.cliente.clave_cliente}),Object(B.jsx)(Oa.a,{children:t.cliente.telefono})]})})]})})})})]}):null,Object(B.jsxs)(p.a,{my:2,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Re.a,{children:Object(B.jsx)(X_.a,{})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"h6",children:"Venta"})})]}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Venta Cr\xe9dito"}),Object(B.jsx)(Oa.a,{children:"Descuento"}),Object(B.jsx)(Oa.a,{children:"Monedero"}),Object(B.jsx)(Oa.a,{children:"IVA"}),Object(B.jsx)(Oa.a,{children:"IEPS"}),Object(B.jsx)(Oa.a,{children:"Subtotal"}),Object(B.jsx)(Oa.a,{children:"Impuestos"}),Object(B.jsx)(Oa.a,{children:"Total"})]})}),Object(B.jsx)(xa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:t.credito?"SI":"NO"}),Object(B.jsxs)(Oa.a,{children:["$",t.descuento?Fa(t.descuento):0]}),Object(B.jsxs)(Oa.a,{children:["$",t.monedero?Fa(t.monedero):0]}),Object(B.jsxs)(Oa.a,{children:["$",t.iva?Fa(t.iva):0]}),Object(B.jsxs)(Oa.a,{children:["$",t.ieps?Fa(t.ieps):0]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(t.subTotal)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(t.impuestos)]}),Object(B.jsx)(Oa.a,{children:Fa(t.total)})]})})]})})})})]}),Object(B.jsxs)(p.a,{my:2,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Re.a,{children:Object(B.jsx)(ef.a,{})}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"h6",children:"Art\xedculos"})})]}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(Ka.a,{variant:"outlined",children:Object(B.jsx)(ba.a,{children:Object(B.jsxs)(_a.a,{size:"small",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"C\xf3digo de barras"}),Object(B.jsx)(Oa.a,{children:"Producto"}),Object(B.jsx)(Oa.a,{children:"Medida"}),Object(B.jsx)(Oa.a,{children:"Unidad"}),Object(B.jsx)(Oa.a,{children:"Cantidad"}),Object(B.jsx)(Oa.a,{children:"Precio"}),Object(B.jsx)(Oa.a,{children:"Descuento"}),Object(B.jsx)(Oa.a,{children:"IVA"}),Object(B.jsx)(Oa.a,{children:"IEPS"}),Object(B.jsx)(Oa.a,{children:"Subtotal"}),Object(B.jsx)(Oa.a,{children:"Impuestos"}),Object(B.jsx)(Oa.a,{children:"Total"})]})}),Object(B.jsx)(xa.a,{children:t.productos.map((function(e,t){return Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:e.id_unidad_venta.codigo_barras}),Object(B.jsx)(Oa.a,{children:e.id_producto.datos_generales.nombre_comercial}),Object(B.jsx)(Tg,{producto:e}),Object(B.jsx)(Oa.a,{children:e.unidad}),Object(B.jsx)(Oa.a,{children:e.cantidad_venta}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.precio_a_vender)]}),Object(B.jsx)(Wg,{producto:e}),Object(B.jsxs)(Oa.a,{children:["$",e.iva_total?Fa(e.iva_total):"0.00"]}),Object(B.jsxs)(Oa.a,{children:["$",e.ieps_total?Fa(e.ieps_total):"0.00"]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.subtotal)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.impuestos)]}),Object(B.jsxs)(Oa.a,{children:["$",Fa(e.total)]})]},t)}))})]})})})})]})]}),Object(B.jsxs)(Ue.a,{style:{display:"flex",justifyContent:"space-between"},children:[Object(B.jsx)(Pg,{venta:t,handleCloseInfoVenta:n,refetch:c,selected:t}),Object(B.jsx)(w.a,{onClick:n,color:"primary",variant:"contained",startIcon:Object(B.jsx)(Dt.a,{}),children:"Aceptar"})]})]}):null}var Tg=function(e){var t=e.producto,a=Dg(),n=Object(Se.a)();return t.color.color&&t.medida.medida?Object(B.jsx)(Oa.a,{align:"center",children:Object(B.jsx)(ha.a,{title:t.color.color,placement:"top",arrow:!0,children:Object(B.jsx)("div",{className:a.colorContainer,style:{backgroundColor:t.color.hex,color:n.palette.getContrastText(t.color.hex)},children:t.medida.medida})})}):Object(B.jsx)(Oa.a,{align:"center",children:"N/A"})},Wg=function(e){var t=e.producto;if(!0===t.id_unidad_venta.descuento_activo){var a=t.id_unidad_venta.descuento,n=a.dinero_descontado,c=a.porciento;return Object(B.jsx)(Oa.a,{children:"$".concat(Fa(n)," - %").concat(c)})}return Object(B.jsx)(Oa.a,{children:"$0.00"})},$g=Object(k.a)((function(e){return{container:{height:"60vh"}}}));function Rg(e){var t=e.handleClose,a=Object(l.useState)(""),n=Object(g.a)(a,2),c=n[0],r=n[1],i=Object(l.useState)("TODAS"),o=Object(g.a)(i,2),s=o[0],d=o[1],j=JSON.parse(localStorage.getItem("sesionCafi")),u=JSON.parse(localStorage.getItem("turnoEnCurso")),b=Object(Da.useDebounce)(c,500),m=Object(g.a)(b,1)[0],O=j.accesos.ventas.cancelar_venta.editar,x=u.fecha_movimiento,h={horario_en_turno:"ABRIR TURNO",id_caja:u?u.id_caja:"",id_usuario:j._id,token_turno_user:u?u.token_turno_user:""},_=Object(qe.a)(wp,{variables:{empresa:j.empresa._id,sucursal:j.sucursal._id,filtro:m,params:s,realizadas:!1,filtros:{busqueda:m,filtro:s,vista:"VENTAS",turno:{id_caja:u.id_caja,fecha_entrada:x},admin:O}},fetchPolicy:"network-only"}),f=Object(qe.a)(Ld,{variables:{empresa:j.empresa._id,sucursal:j.sucursal._id,input:h}});return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{mb:2,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,sm:6,xs:12,children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",placeholder:"Buscar por: Folio, cliente, clave o nombre",variant:"outlined",onChange:function(e){return r(e.target.value)},value:c})}),Object(B.jsx)($e.a,{item:!0,sm:3,xs:12,children:Object(B.jsx)(H.a,{variant:"outlined",size:"small",fullWidth:!0,children:Object(B.jsxs)(mt.a,{value:s,onChange:function(e){return d(e.target.value)},children:[Object(B.jsx)(Ot.a,{value:"TODAS",children:Object(B.jsx)("em",{children:"Todas"})}),Object(B.jsx)(Ot.a,{value:"HOY",children:"Ventas de hoy"}),Object(B.jsx)(Ot.a,{value:"REALIZADAS",children:"Ventas realizadas"}),Object(B.jsx)(Ot.a,{value:"CANCELADAS",children:"Ventas canceladas"})]})})}),Object(B.jsx)($e.a,{item:!0,sm:3,xs:12,children:Object(B.jsx)(F.a,{fullWidth:!0,size:"small",variant:"outlined",type:"date",onChange:function(e){return r(e.target.value)}})})]})}),Object(B.jsx)(p.a,{my:1,children:Object(B.jsx)(St.a,{severity:"info",children:"Para ver la informaci\xf3n completa una venta haz un doble click!"})}),Object(B.jsxs)(p.a,{my:1,display:"flex",children:[O?Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(p.a,{border:1,borderColor:"#58ff8f",bgcolor:"#EDFFF3",height:"24px",width:"24px"}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"- Ventas de hoy"})}),Object(B.jsx)(p.a,{mx:2})]}):null,Object(B.jsx)(p.a,{border:1,borderColor:"#FF8A8A",bgcolor:"#FFF4F4",height:"24px",width:"24px"}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(S.a,{children:Object(B.jsx)("b",{children:"- Ventas canceladas"})})]}),Object(B.jsx)(Vg,{resultado_ventas:_,res_precorte:f,handleClose:t,admin:O})]})}var Vg=function(e){var t=e.resultado_ventas,a=e.res_precorte,n=(e.handleClose,e.admin),c=Object(l.useContext)(o_),r=(c.updateTablaVentas,c.setUpdateTablaVentas,c.setVentaRetomada,Object(l.useContext)(Xi)),i=(r.updateClientVenta,r.setUpdateClientVenta,$g()),o=Object(l.useState)(""),s=Object(g.a)(o,2),d=s[0],j=s[1],u=Object(l.useState)(!1),b=Object(g.a)(u,2),m=b[0],O=b[1],x=t.loading,h=t.data,_=t.error,f=t.refetch,v=Object(l.useState)(!1),C=Object(g.a)(v,2),y=C[0],S=C[1];if(x)return Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",children:Object(B.jsx)(I.a,{})});if(_)return Object(B.jsx)(Ze,{});var F=h.obtenerVentasSucursal,w=a.data,k=w.obtenerPreCorteCaja?w.obtenerPreCorteCaja.monto_efectivo_precorte:0,z=function(e,t){j(t);2===e&&S(!0)},N=function(){O(!m)};return Object(B.jsxs)(Ka.a,{variant:"outlined",children:[Object(B.jsx)(R.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:m,autoHideDuration:5e3,onClose:N,message:"No puedes agregar una venta cuando ya est\xe1 una en curso.",action:Object(B.jsx)(X.a,{size:"small","aria-label":"close",color:"inherit",onClick:N,children:Object(B.jsx)(Pt.a,{fontSize:"small"})})}),Object(B.jsxs)(ba.a,{className:i.container,children:[Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{children:"Folio"}),Object(B.jsx)(Oa.a,{children:"Fecha"}),Object(B.jsx)(Oa.a,{children:"Cliente"}),Object(B.jsx)(Oa.a,{children:"Usuario"}),Object(B.jsx)(Oa.a,{children:"Caja"}),Object(B.jsx)(Oa.a,{children:"Descuento"}),Object(B.jsx)(Oa.a,{children:"Subtotal"}),Object(B.jsx)(Oa.a,{children:"Impuestos"}),Object(B.jsx)(Oa.a,{children:"Total"}),Object(B.jsx)(Oa.a,{children:"Cancelar Venta"})]})}),Object(B.jsx)(xa.a,{children:F.map((function(e,t){return Object(B.jsx)(Lg,{data:e,selected:d,obtenerVenta:z,refetch:f,admin:n,pre_corte:k},t)}))})]}),Object(B.jsx)(Ag,{venta:d,open:y,handleClose:function(){S(!1)},refetch:f})]})]})},Mg=Object(k.a)((function(e){return{today_color:{backgroundColor:"#EDFFF3","&:hover":{backgroundColor:"#D8FFE5"}},normal_color:{backgroundColor:"#FFF","&:hover":{backgroundColor:"#F5F5F5"}},root:{"&$root":{backgroundColor:"#FFF4F4",color:"#FF8A8A"},"&$root:hover":{backgroundColor:"#FFE0E0"}},selected:{"&$selected, &$selected:hover":{backgroundColor:"#E8F4FD"}}}})),Lg=function(e){var t=e.data,a=e.selected,n=e.obtenerVenta,c=e.refetch,r=e.admin,i=e.pre_corte,o=Mg(),s=ht()(t.fecha_registro).format("YYYY-MM-DD")===ht()().format("YYYY-MM-DD");return Object(B.jsxs)(ma.a,{role:"checkbox",tabIndex:-1,selected:t.folio===a.folio,onClick:function(e){return n(e.detail,t)},classes:{selected:o.selected,root:"CANCELADA"===t.status?o.root:null},className:s&&r?o.today_color:o.normal_color,children:[Object(B.jsx)(Oa.a,{className:"delete-color",children:t.folio}),Object(B.jsx)(Oa.a,{className:"delete-color",children:ht()(t.fecha_registro).format("DD/MM/YYYY")}),Object(B.jsx)(Oa.a,{className:"delete-color",children:Object(B.jsx)("div",{className:"noWrap2",children:null!==t.cliente?t.cliente.nombre_cliente:"Publico General"})}),Object(B.jsx)(Oa.a,{className:"delete-color",children:Object(B.jsx)("div",{className:"noWrap2",children:t.usuario.nombre})}),Object(B.jsx)(Oa.a,{className:"delete-color",children:t.id_caja.numero_caja}),Object(B.jsxs)(Oa.a,{className:"delete-color",children:["$",t.descuento?Fa(t.descuento):0]}),Object(B.jsxs)(Oa.a,{className:"delete-color",children:["$",Fa(t.subTotal)]}),Object(B.jsxs)(Oa.a,{className:"delete-color",children:["$",Fa(t.impuestos)]}),Object(B.jsxs)(Oa.a,{className:"delete-color",children:["$",Fa(t.total)]}),Object(B.jsx)(Oa.a,{className:"delete-color",align:"center",children:Object(B.jsx)(Pg,{venta:t,refetch:c,dinero_disponible:i,selected:a,view:"table"})})]})},Ug=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Bg(){var e=i_(),t=JSON.parse(localStorage.getItem("turnoEnCurso")),a=Object(l.useState)(!1),n=Object(g.a)(a,2),c=n[0],r=n[1],i=function(){r(!c)};return window.addEventListener("keydown",(function(e){e.altKey&&86===e.keyCode&&i()})),Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(w.a,{className:e.borderBotonChico,onClick:i,disabled:!t,children:Object(B.jsxs)(p.a,{children:[Object(B.jsx)(p.a,{children:Object(B.jsx)(Fe.p,{style:{fontSize:45}})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"body2",children:Object(B.jsx)("b",{children:"Buscar Folio"})})}),Object(B.jsx)(p.a,{children:Object(B.jsx)(S.a,{variant:"caption",style:{color:"#808080"},children:Object(B.jsx)("b",{children:"Alt + V"})})})]})}),Object(B.jsxs)(Ee.a,{fullWidth:!0,maxWidth:"lg",open:c,onClose:i,TransitionComponent:Ug,children:[Object(B.jsx)(wt.a,{children:Object(B.jsxs)(p.a,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/lista-de-espera.svg",alt:"icono caja",className:e.iconSizeDialogs}),Object(B.jsx)(p.a,{mx:2}),Object(B.jsx)(S.a,{variant:"h6",children:"Ventas Realizadas"})]}),Object(B.jsx)(w.a,{size:"small",color:"secondary",variant:"contained",onClick:function(){return i()},children:Object(B.jsx)(Pt.a,{})})]})}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(Rg,{handleClose:i})})]})]})}function qg(){var e=n_();return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)($e.a,{container:!0,className:e.drawerColor,children:[Object(B.jsx)($e.a,{item:!0,lg:6,md:6,xs:6,children:Object(B.jsx)(rg,{})}),Object(B.jsx)($e.a,{item:!0,lg:6,md:6,xs:6,children:Object(B.jsx)(Jf,{})}),Object(B.jsx)($e.a,{item:!0,lg:6,md:6,xs:6,children:Object(B.jsx)(Tf,{})}),Object(B.jsx)($e.a,{item:!0,lg:6,md:6,xs:6,children:Object(B.jsx)(Bf,{type:"GENERAR"})}),Object(B.jsx)($e.a,{item:!0,lg:6,md:6,xs:6,children:Object(B.jsx)(gg,{})}),Object(B.jsx)($e.a,{item:!0,lg:6,md:6,xs:6,children:Object(B.jsx)(zg,{})}),Object(B.jsx)($e.a,{item:!0,lg:6,md:6,xs:6,children:Object(B.jsx)(Rf,{})}),Object(B.jsx)($e.a,{item:!0,lg:6,md:6,xs:6,children:Object(B.jsx)(Bg,{})}),Object(B.jsx)($e.a,{item:!0,lg:6,md:6,xs:6,children:Object(B.jsx)(_g,{})}),Object(B.jsx)($e.a,{item:!0,lg:6,md:6,xs:6,children:Object(B.jsx)(Sf,{})})]})})}var Jg=a(334),Gg=a(484),Hg=["cantidad_venta"],Yg=Object(l.forwardRef)((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function Kg(e){var t=e.producto,a=e.setDatosVentasActual,n=Object(l.useState)(!1),c=Object(g.a)(n,2),r=c[0],i=c[1],o=Object(l.useContext)(o_),s=o.updateTablaVentas,d=o.setUpdateTablaVentas,j=function(){return i(!r)},u=function(){var e=Object(f.a)(C.a.mark((function e(){var n,c,r,i,o,l,j,u,p,m;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.parse(localStorage.getItem("DatosVentas")),c=null===n?[]:n.productos,r=null===n?[]:n,i=c,o=null===n?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:n,e.next=7,Ia(t);case 7:if(!(l=e.sent).found){e.next=18;break}return j=t.cantidad_venta,u=Object(ve.a)(t,Hg),e.next=12,ka({newP:u,cantidad:j,precio_boolean:!0,precio:u.precio_actual_object,granel:u.granel_producto,origen:""});case 12:p=e.sent,i.splice(l.producto_found.index,1),m={subTotal:parseFloat(o.subTotal)-parseFloat(p.subtotalCalculo),total:parseFloat(o.total)-parseFloat(p.totalCalculo),impuestos:parseFloat(o.impuestos)-parseFloat(p.impuestoCalculo),iva:parseFloat(o.iva)-parseFloat(p.ivaCalculo),ieps:parseFloat(o.ieps)-parseFloat(p.iepsCalculo),descuento:parseFloat(o.descuento)-parseFloat(p.descuentoCalculo),monedero:parseFloat(o.monedero)-parseFloat(p.monederoCalculo)},0!==i.length||n.cliente.nombre_cliente?localStorage.setItem("DatosVentas",JSON.stringify(Object(b.a)(Object(b.a)({},m),{},{cliente:!0===r.venta_cliente?r.cliente:{},venta_cliente:!0===r.venta_cliente&&r.venta_cliente,productos:i,tipo_emision:r.tipo_emision?r.tipo_emision:"TICKET"}))):(localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal")),a(m),d(!s);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(X.a,{size:"small",onClick:function(){return j()},children:Object(B.jsx)(ur.a,{size:"small",color:"error"})}),Object(B.jsxs)(Ee.a,{open:r,TransitionComponent:Yg,keepMounted:!0,onClose:function(){return j()},"aria-labelledby":"alert-dialog-delete-producto",children:[Object(B.jsx)(wt.a,{id:"alert-dialog-delete-producto",children:"\xbfEst\xe1s seguro de eliminar este producto?"}),Object(B.jsxs)(Ue.a,{style:{display:"flex",justifyContent:"center"},children:[Object(B.jsx)(w.a,{onClick:function(){return j()},color:"inherit",children:"Cancelar"}),Object(B.jsx)(w.a,{onClick:function(){return u()},color:"secondary",children:"Eliminar"})]})]})]})}var Qg=["cantidad_venta"],Xg=Object(k.a)((function(e){return{root:{width:"100%"},container:Object(_.a)({height:"100%",maxHeight:"59vh","& ::-webkit-scrollbar":{display:"none"}},e.breakpoints.up("xl"),{maxHeight:"64vh"})}}));function Zg(e){var t=e.setDatosVentasActual,a=Xg(),n=Object(l.useState)([]),c=Object(g.a)(n,2),r=c[0],i=c[1],o=Object(l.useContext)(o_),s=o.setProductoCambioPrecio,d=o.setPrecioSelectProductoVenta,j=o.updateTablaVentas,u=o.setUpdateTablaVentas,b=Object(l.useState)([]),p=Object(g.a)(b,2),m=p[0],O=p[1];Object(l.useEffect)((function(){var e=JSON.parse(localStorage.getItem("DatosVentas"));O(null===e?[]:e.productos)}),[j]);var x=function(e){if("Caja"!==e.unidad&&"Costal"!==e.unidad){var t=[];if(-1!==r.indexOf(e))return t=[],d([]),s({}),void i(t);t=t.concat([],e);var a=e.id_producto.precios.precios_producto.filter((function(t){return t.precio_neto===e.precio_actual_producto}));a.length>0&&d(a),s(e),i(t)}},h=function(e,t){try{2===e.detail&&x(t)}catch(a){console.log(a)}};return Object(B.jsx)("div",{className:a.root,children:Object(B.jsx)(Ka.a,{children:Object(B.jsx)(ba.a,{className:a.container,children:Object(B.jsxs)(_a.a,{stickyHeader:!0,size:"small","aria-labelledby":"tableTitle","aria-label":"a dense table",children:[Object(B.jsx)(pa.a,{children:Object(B.jsxs)(ma.a,{children:[Object(B.jsx)(Oa.a,{padding:"checkbox"}),Object(B.jsx)(Oa.a,{style:{textAlign:"center",width:120},children:"Valor Granel"}),Object(B.jsx)(Oa.a,{style:{textAlign:"center"},padding:"checkbox",children:"Cantidad"}),Object(B.jsx)(Oa.a,{children:"Descripcion"}),Object(B.jsx)(Oa.a,{style:{textAlign:"center"},padding:"checkbox",children:"Existencia"}),Object(B.jsx)(Oa.a,{style:{textAlign:"center"},padding:"checkbox",children:Object(B.jsx)("b",{children:"Descuento"})}),Object(B.jsx)(Oa.a,{style:{textAlign:"center"},padding:"checkbox",children:"Receta"}),Object(B.jsx)(Oa.a,{style:{textAlign:"center"},padding:"checkbox",children:"Unidad"}),Object(B.jsx)(Oa.a,{style:{width:140,textAlign:"center"},children:"Precio Unitario"}),Object(B.jsx)(Oa.a,{style:{width:140,textAlign:"center"},children:"Precio a vender"}),Object(B.jsx)(Oa.a,{padding:"checkbox"})]})}),Object(B.jsx)(xa.a,{children:m.map((function(e,a){var n,c=(n=e,-1!==r.indexOf(n)),o="enhanced-table-checkbox-".concat(a);return Object(B.jsx)(ev,{producto:e,setUpdateTablaVentas:u,updateTablaVentas:j,setDatosVentasActual:t,isItemSelected:c,labelId:o,handleClick:x,selected:r,TwoClickInRowTableBuy:h,setSelected:i},a)}))})]})})})})}var ev=function(e){var t=e.producto,a=e.setUpdateTablaVentas,n=e.updateTablaVentas,c=e.setDatosVentasActual,r=e.TwoClickInRowTableBuy,i=e.handleClick,o=e.isItemSelected,s=e.labelId,d=e.setSelected,j=e.selected,u=Object(l.useState)(t.cantidad_venta),p=Object(g.a)(u,2),m=p[0],O=p[1],x=Object(l.useState)(t.cantidad_venta),h=Object(g.a)(x,2),_=h[0],v=h[1],y=Object(l.useRef)(null),S=Object(_c.a)(m,500),F=Object(g.a)(S,1)[0];Object(l.useEffect)((function(){v(t.cantidad_venta)}),[t.cantidad_venta]),Object(l.useEffect)((function(){w(F)}),[F]);var w=function(){var e=Object(f.a)(C.a.mark((function e(r){var i,o,s,l,d,j,u,p,m,O,x,h,_,f;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==r&&0!==r){e.next=4;break}v(t.cantidad_venta),e.next=40;break;case 4:return i=JSON.parse(localStorage.getItem("DatosVentas")),o=null===i?[]:i.productos,s=null===i?[]:i,l=o,d=null===i?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:i,j={},e.next=12,Ia(t);case 12:if(!(u=e.sent).found){e.next=36;break}return p=u.producto_found.producto,m=p.cantidad_venta,(O=Object(ve.a)(p,Qg)).cantidad_venta=parseInt(r),e.next=18,za(O);case 18:return x=e.sent,h=x.found?x.object_prising:O.precio_actual_object,e.next=22,ka({newP:O,cantidad:m,precio_boolean:!0,precio:O.precio_actual_object,granel:O.granel_producto,origen:"Tabla"});case 22:return _=e.sent,e.next=25,ka({newP:O,cantidad:parseInt(r),precio_boolean:!0,precio:h,granel:O.granel_producto,origen:"Tabla"});case 25:f=e.sent,O.iva_total_producto=parseFloat(f.ivaCalculo),O.ieps_total_producto=parseFloat(f.iepsCalculo),O.impuestos_total_producto=parseFloat(f.impuestoCalculo),O.subtotal_total_producto=parseFloat(f.subtotalCalculo),O.total_total_producto=parseFloat(f.totalCalculo),x.found?(O.precio_a_vender=f.totalCalculo,O.precio_anterior=O.precio_actual_porducto,O.precio_actual_producto=x.pricing,O.precio_actual_object=x.object_prising,O.precio_actual_object={cantidad_unidad:x.object_prising.cantidad_unidad?x.object_prising.cantidad_unidad:null,numero_precio:x.object_prising.numero_precio?x.object_prising.numero_precio:null,unidad_maxima:x.object_prising.unidad_maxima?x.object_prising.unidad_maxima:null,precio_general:x.object_prising.precio_general?x.object_prising.precio_general:null,precio_neto:x.object_prising.precio_neto?x.object_prising.precio_neto:null,precio_venta:x.object_prising.precio_venta?x.object_prising.precio_venta:null,iva_precio:x.object_prising.iva_precio?x.object_prising.iva_precio:null,ieps_precio:x.object_prising.ieps_precio?x.object_prising.ieps_precio:null,utilidad:x.object_prising.utilidad?x.object_prising.utilidad:null,porciento:x.object_prising.porciento?x.object_prising.porciento:null,dinero_descontado:x.object_prising.dinero_descontado?x.object_prising.dinero_descontado:null}):(O.cantidad_venta=parseInt(r),O.precio_anterior=O.precio_actual_producto,O.precio_a_vender=f.totalCalculo),l.splice(u.producto_found.index,1,O),j={subTotal:parseFloat(d.subTotal)-parseFloat(_.subtotalCalculo)+f.subtotalCalculo,total:parseFloat(d.total)-parseFloat(_.totalCalculo)+f.totalCalculo,impuestos:parseFloat(d.impuestos)-parseFloat(_.impuestoCalculo)+f.impuestoCalculo,iva:parseFloat(d.iva)-parseFloat(_.ivaCalculo)+f.ivaCalculo,ieps:parseFloat(d.ieps)-parseFloat(_.iepsCalculo)+f.iepsCalculo,descuento:parseFloat(d.descuento)-parseFloat(_.descuentoCalculo)+f.descuentoCalculo,monedero:parseFloat(d.monedero)-parseFloat(_.monederoCalculo)+f.monederoCalculo},e.next=37;break;case 36:console.log("El producto no existe");case 37:localStorage.setItem("DatosVentas",JSON.stringify(Object(b.a)(Object(b.a)({},j),{},{cliente:!0===s.venta_cliente?s.cliente:{},venta_cliente:!0===s.venta_cliente&&s.venta_cliente,productos:l,tipo_emision:s.tipo_emision?s.tipo_emision:"TICKET"}))),c(j),a(!n);case 40:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)(ma.a,{role:"checkbox",style:{height:"15px"},"aria-checked":o,tabIndex:-1,selected:o,hover:!0,onClick:function(e){return r(e,t)},children:[Object(B.jsx)(Oa.a,{padding:"checkbox",children:Object(B.jsx)(Me.a,{onClick:function(e){j.length>0&&d([]),i(t)},checked:o,inputProps:{"aria-labelledby":s}})}),Object(B.jsx)(Oa.a,{style:{textAlign:"center"},padding:"checkbox",children:t.granel_producto.granel?"".concat(t.granel_producto.valor," ").concat(t.unidad):"N/A"}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(Ya.a,{inputRef:y,onClick:function(e){return e.stopPropagation()},onChange:function(e){return function(e){if("medidas"===t.concepto){if(e>t.cantidad)return}else if(e>t.inventario_general[0].cantidad_existente)return;try{v(e),O(e)}catch(a){return!1}}(e.target.value)},value:_,type:"number",name:"cantidad_venta",inputProps:{min:1,max:"medidas"===t.concepto?t.cantidad:t.inventario_general.map((function(e){return"".concat(e.cantidad_existente)}))}})}),Object(B.jsx)(Oa.a,{children:t.id_producto.datos_generales.nombre_comercial}),Object(B.jsx)(Oa.a,{style:{textAlign:"center"},children:"OTROS"===t.id_producto.datos_generales.tipo_producto?"Costal"===t.unidad||"Caja"===t.unidad?t.inventario_general[0].cantidad_existente_maxima:t.inventario_general[0].cantidad_existente:t.cantidad}),Object(B.jsxs)(Oa.a,{style:{textAlign:"center"},children:["%"," ",null!==t.precio_actual_object.porciento?t.precio_actual_object.porciento:0]}),Object(B.jsx)(Oa.a,{style:{textAlign:"center"},children:!0===t.id_producto.datos_generales.receta_farmacia?"Si":"No"}),Object(B.jsx)(Oa.a,{style:{textAlign:"center"},children:t.unidad}),Object(B.jsxs)(Oa.a,{style:{textAlign:"center"},children:["$"," ",t.precio_actual_object.precio_neto?Fa(t.precio_actual_object.precio_neto):0]}),Object(B.jsxs)(Oa.a,{style:{textAlign:"center"},children:["$"," ",t.precio_a_vender?Fa(t.precio_a_vender):0]}),Object(B.jsx)(Oa.a,{children:Object(B.jsx)(Kg,{producto:t,setDatosVentasActual:c})})]},t._id)})};function tv(){var e=i_(),t=Object(l.useContext)(o_),a=t.updateTablaVentas,n=t.setUpdateTablaVentas,c=JSON.parse(localStorage.getItem("DatosVentas")),r=Object(l.useState)("TICKET"),i=Object(g.a)(r,2),o=i[0],s=i[1];return Object(B.jsxs)(p.a,{width:"100%",display:"flex",children:[Object(B.jsx)(p.a,{mr:1,children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/publicalo.svg",alt:"iconoBander",className:e.iconSize})}),Object(B.jsx)(p.a,{width:"100%",children:Object(B.jsx)(H.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(B.jsxs)(mt.a,{id:"tipo_documento",value:o,name:"tipo_documento",onChange:function(e){var t=e.target.value;c&&null!==c&&(s(t),localStorage.setItem("DatosVentas",JSON.stringify(Object(b.a)(Object(b.a)({},c),{},{tipo_emision:t}))),n(!a))},disabled:!c||null===c,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),Object(B.jsx)(Ot.a,{value:"TICKET",children:"TICKET"}),Object(B.jsx)(Ot.a,{value:"FACTURA",children:"FACTURA"}),Object(B.jsx)(Ot.a,{value:"NOTA REMISION",children:"NOTA REMISION"})]})})})]})}function av(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=JSON.parse(localStorage.getItem("DatosVentas")),a=Object(l.useContext)(Xi),n=a.setUpdateClientVenta,c=a.updateClientVenta,r=a.setClientes,i=Object(l.useContext)(o_),o=i.setClientesVentas,s=(i.clear,Object(l.useState)({})),d=Object(g.a)(s,2),j=d[0],u=d[1],p=Object(qe.a)(Sp,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id},fetchPolicy:"network-only"}),m=p.loading,O=p.data,x=(p.error,p.refetch),h=[];O&&(h=O.obtenerClientesVentas),Object(l.useEffect)((function(){try{r(O.obtenerClientesVentas)}catch(e){}}),[O]),Object(l.useEffect)((function(){t&&t.cliente&&t.cliente.nombre_cliente?(u(t.cliente),o(t.cliente)):(u(null),o([])),x()}),[x,c]);return m?null:Object(B.jsx)("div",{children:Object(B.jsx)(ja.a,{id:"combo-box-producto-codigo",size:"small",fullWidth:!0,options:h,getOptionLabel:function(e){return e.nombre_cliente?e.nombre_cliente:"N/A"},renderInput:function(e){return Object(B.jsx)(F.a,Object(b.a)(Object(b.a)({},e),{},{variant:"outlined"}))},onChange:function(e,t){return function(e){try{var t,a=JSON.parse(localStorage.getItem("DatosVentas")),r=null===a?{}:a;if(u(e),!e&&0===a.productos.length)return localStorage.removeItem("DatosVentas"),void n(!c);var i={subTotal:void 0===r.subTotal?0:r.subTotal,total:void 0===r.total?0:r.total,impuestos:void 0===r.impuestos?0:r.impuestos,iva:void 0===r.iva?0:r.iva,ieps:void 0===r.ieps?0:r.ieps,descuento:void 0===r.descuento?0:r.descuento,monedero:void 0===r.monedero?0:r.monedero,venta_cliente:null!==e,productos:(null===(t=r.productos)||void 0===t?void 0:t.length)>0?r.productos:[],tipo_emision:r.tipo_emision?r.tipo_emision:"TICKET"};i=Object(b.a)(Object(b.a)({},i),{},{cliente:e||{}}),localStorage.setItem("DatosVentas",JSON.stringify(i)),n(!c)}catch(o){console.log(o)}}(t)},getOptionSelected:function(e,t){return e.nombre_cliente===t.nombre_cliente},value:j||null})})}function nv(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=i_();return Object(B.jsxs)(p.a,{width:"100%",display:"flex",justifyItems:"center",alignSelf:"center",justifySelf:"center",alignItems:"center",children:[Object(B.jsx)(p.a,{mt:1,mr:1,children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/usuarios.svg",alt:"iconoBander",className:t.iconSize})}),Object(B.jsx)(p.a,{width:"100%",alignItems:"center",children:Object(B.jsx)(av,{sesion:e})})]})}var cv=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function rv(e){var t=e.agregarProductos,a=e.open,n=e.setOpen,c=e.productos,r=function(){n(!a)};return Object(B.jsx)(l.Fragment,{children:Object(B.jsxs)(Ee.a,{open:a,onClose:r,TransitionComponent:cv,children:[Object(B.jsx)(wt.a,{children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",alignItems:"center",children:Object(B.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,children:Object(B.jsx)(We.a,{})})})}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)(iv,{productos:c,agregarProductos:t})})]})})}var iv=function(e){var t,a=e.productos,n=e.agregarProductos;return a?a&&0===a.length?Object(B.jsx)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:"NO HAY UNIDADES"}):Object(B.jsx)(p.a,{children:Object(B.jsxs)(p.a,{mb:5,children:[Object(B.jsx)(p.a,{width:"100%",my:3,children:Object(B.jsx)(S.a,{variant:"h6",align:"center",children:Object(B.jsx)("b",{children:null===(t=a[0])||void 0===t?void 0:t.id_producto.datos_generales.nombre_comercial})})}),Object(B.jsx)($e.a,{container:!0,spacing:4,justifyContent:"center",children:a.map((function(e,t){return Object(B.jsx)(sv,{producto:e,agregarProductos:n},t)}))})]})}):Object(B.jsx)(p.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"53vh",children:Object(B.jsx)(I.a,{})})},ov=Object(k.a)({medida:{height:64,width:74,fontSize:28},badge:{"& .MuiBadge-badge":{height:30,width:30,borderRadius:"100%",fontSize:18}}}),sv=function(e){var t=e.producto,a=e.agregarProductos,n=ov(),c=Object(Se.a)();return Object(B.jsx)($e.a,{item:!0,className:n.badge,children:Object(B.jsx)(ha.a,{title:t.color.nombre,placement:"top",arrow:!0,children:Object(B.jsx)(nc.a,{badgeContent:t.cantidad,color:"primary",showZero:!0,children:Object(B.jsx)(w.a,{disableElevation:!0,variant:"contained",className:n.medida,style:{backgroundColor:t.color.hex,color:c.palette.getContrastText(t.color.hex)},onClick:function(){return a(t)},children:t.medida.talla})})})})},lv=["cantidad_venta"];function dv(e){var t=e.loading,a=e.setLoading,n=JSON.parse(localStorage.getItem("sesionCafi")),c=i_(),r=Object(l.useContext)(o_),i=r.updateTablaVentas,o=r.setUpdateTablaVentas,s=r.setDatosVentasActual,d=Object(l.useState)(!1),j=Object(g.a)(d,2),u=j[0],m=j[1],O=Object(l.useState)({message:"",status:"",open:!1}),x=Object(g.a)(O,2),h=x[0],_=x[1],v=Object(l.useState)(""),y=Object(g.a)(v,2),S=y[0],w=y[1],k=Object(Gi.a)(),z=Object(l.useState)(!1),N=Object(g.a)(z,2),P=N[0],D=N[1],E=Object(l.useState)([]),A=Object(g.a)(E,2),T=A[0],W=A[1],$=function(){var e=Object(f.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.query({query:Cp,variables:{datosProductos:t.toUpperCase(),empresa:n.empresa._id,sucursal:n.sucursal._id},fetchPolicy:"network-only"});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=Object(l.useState)(!1),M=Object(g.a)(V,2),L=M[0],U=M[1];Object(l.useEffect)((function(){var e=JSON.parse(localStorage.getItem("DatosVentas"));null!==e&&s({subTotal:parseFloat(e.subTotal),total:parseFloat(e.total),impuestos:parseFloat(e.impuestos),iva:parseFloat(e.iva),ieps:parseFloat(e.ieps),descuento:parseFloat(e.descuento),monedero:parseFloat(e.monedero)})}),[i]);var q=function(){var e=Object(f.a)(C.a.mark((function e(n){var c,r,i,o,s,l,d,j;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:if(S){e.next=4;break}return e.abrupt("return");case 4:if(e.prev=4,"Enter"!==n.code&&"NumpadEnter"!==n.code&&"click"!==n.type){e.next=31;break}if(a(!0),r=(c=S).split("*"),i={data:void 0,loading:!1,error:void 0},o={granel:!1,valor:0},!(r.length>1)){e.next=21;break}return s=isNaN(r[0])?r[1]:r[0],l=isNaN(r[0])?r[0]:r[1],o={granel:!0,valor:parseFloat(s)},e.next=17,$(l);case 17:i=e.sent,U(!L),e.next=25;break;case 21:return e.next=23,$(c);case 23:i=e.sent,U(!L);case 25:if(!i.error){e.next=29;break}return i.error.networkError?_({message:"Error de servidor",status:"error",open:!0}):i.error.graphQLErrors&&_({message:"".concat(null===(d=i.error.graphQLErrors[0])||void 0===d?void 0:d.message),status:"error",open:!0}),a(!1),e.abrupt("return");case 29:i.data&&null!==(j=i.data.obtenerUnProductoVentas)&&(1===j.length?null!==j[0].cantidad?H(j[0],o):_({message:"Este producto no existe",status:"error",open:!0}):j.length>0?(D(!0),W(j)):_({message:"Este producto no existe",status:"error",open:!0})),a(!1);case 31:e.next=37;break;case 33:e.prev=33,e.t0=e.catch(4),console.log(e.t0),a(!1);case 37:case"end":return e.stop()}}),e,null,[[4,33]])})));return function(t){return e.apply(this,arguments)}}(),G=n.empresa.vender_sin_inventario,H=function(){var e=Object(f.a)(C.a.mark((function e(t,a){var n,c,r,l,d,j,u,p,O,x,h,_,f,g,v,y,S,F,w;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("medidas"!==t.concepto){e.next=6;break}if(G||0!==t.cantidad){e.next=4;break}return m(!0),e.abrupt("return");case 4:e.next=9;break;case 6:if(G||0!==t.inventario_general[0].cantidad_existente){e.next=9;break}return m(!0),e.abrupt("return");case 9:return n=a||{granel:!1,valor:0},c=JSON.parse(localStorage.getItem("DatosVentas")),r=null===c?[]:c.productos,l=null===c?[]:c,d=null===c?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:c,j=r,u={subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0},e.next=18,Ia(t);case 18:if((p=e.sent).found||!t._id){e.next=35;break}return O=Object(b.a)({},t),x=O.descuento_activo?O.descuento.precio_neto:O.precio_unidad.precio_neto,e.next=24,ka({newP:O,cantidad:0,granel:n,origen:"Ventas1",precio_boolean:!1});case 24:(h=e.sent).newP.precio_anterior=x,h.newP.iva_total_producto=parseFloat(h.ivaCalculo),h.newP.ieps_total_producto=parseFloat(h.iepsCalculo),h.newP.impuestos_total_producto=parseFloat(h.impuestoCalculo),h.newP.subtotal_total_producto=parseFloat(h.subtotalCalculo),h.newP.total_total_producto=parseFloat(h.totalCalculo),j.splice(0,0,h.newP),u={subTotal:parseFloat(d.subTotal)+parseFloat(h.subtotalCalculo),total:parseFloat(d.total)+parseFloat(h.totalCalculo),impuestos:parseFloat(d.impuestos)+parseFloat(h.impuestoCalculo),iva:parseFloat(d.iva)+parseFloat(h.ivaCalculo),ieps:parseFloat(d.ieps)+parseFloat(h.iepsCalculo),descuento:parseFloat(d.descuento)+parseFloat(h.descuentoCalculo),monedero:parseFloat(d.monedero)+parseFloat(h.monederoCalculo)},e.next=73;break;case 35:if(!p.found||!t._id){e.next=73;break}return _=p.producto_found.producto,f=_.cantidad_venta,(g=Object(ve.a)(_,lv)).cantidad_venta=parseInt(f)+1,e.next=40,za(g);case 40:if(!(v=e.sent).found){e.next=61;break}return e.next=44,ka({newP:g,cantidad_venta:f,granel:g.granel_producto,origen:"",precio_boolean:!0,precio:g.precio_actual_object});case 44:return y=e.sent,e.next=47,ka({newP:g,cantidad_venta:g.cantidad_venta,granel:g.granel_producto,origen:"",precio_boolean:!0,precio:v.object_prising});case 47:S=e.sent,g.precio_a_vender=S.totalCalculo,g.precio_anterior=g.precio_actual_producto,g.precio_actual_producto=v.pricing,g.iva_total_producto=parseFloat(S.ivaCalculo),g.ieps_total_producto=parseFloat(S.iepsCalculo),g.impuestos_total_producto=parseFloat(S.impuestoCalculo),g.subtotal_total_producto=parseFloat(S.subtotalCalculo),g.total_total_producto=parseFloat(S.totalCalculo),g.precio_actual_object={cantidad_unidad:v.object_prising.cantidad_unidad?v.object_prising.cantidad_unidad:null,numero_precio:v.object_prising.numero_precio?v.object_prising.numero_precio:null,unidad_maxima:v.object_prising.unidad_maxima?v.object_prising.unidad_maxima:null,precio_general:v.object_prising.precio_general?v.object_prising.precio_general:null,precio_neto:v.object_prising.precio_neto?v.object_prising.precio_neto:null,precio_venta:v.object_prising.precio_venta?v.object_prising.precio_venta:null,iva_precio:v.object_prising.iva_precio?v.object_prising.iva_precio:null,ieps_precio:v.object_prising.ieps_precio?v.object_prising.ieps_precio:null,utilidad:v.object_prising.utilidad?v.object_prising.utilidad:null,porciento:v.object_prising.porciento?v.object_prising.porciento:null,dinero_descontado:v.object_prising.dinero_descontado?v.object_prising.dinero_descontado:null},j.splice(p.producto_found.index,1,g),u={subTotal:parseFloat(d.subTotal)-parseFloat(y.subtotalCalculo)+S.subtotalCalculo,total:parseFloat(d.total)-parseFloat(y.totalCalculo)+S.totalCalculo,impuestos:parseFloat(d.impuestos)-parseFloat(y.impuestoCalculo)+S.impuestoCalculo,iva:parseFloat(d.iva)-parseFloat(y.ivaCalculo)+S.ivaCalculo,ieps:parseFloat(d.ieps)-parseFloat(y.iepsCalculo)+S.iepsCalculo,descuento:parseFloat(d.descuento)-parseFloat(y.descuentoCalculo)+S.descuentoCalculo,monedero:parseFloat(d.monedero)-parseFloat(y.monederoCalculo)+S.monederoCalculo},e.next=73;break;case 61:return F=g.descuento_activo?g.descuento.precio_neto:g.precio_unidad.precio_neto,e.next=64,ka({newP:g,cantidad:0,granel:n,origen:"Ventas2"});case 64:(w=e.sent).newP.precio_actual_producto=F,w.newP.iva_total_producto=parseFloat(w.ivaCalculo)*parseFloat(g.cantidad_venta),w.newP.ieps_total_producto=parseFloat(w.iepsCalculo)*parseFloat(g.cantidad_venta),w.newP.impuestos_total_producto=parseFloat(w.impuestoCalculo)*parseFloat(g.cantidad_venta),w.newP.subtotal_total_producto=parseFloat(w.subtotalCalculo)*parseFloat(g.cantidad_venta),w.newP.total_total_producto=parseFloat(w.totalCalculo)*parseFloat(g.cantidad_venta),j.splice(p.producto_found.index,1,w.newP),u={subTotal:parseFloat(d.subTotal)+parseFloat(w.subtotalCalculo),total:parseFloat(d.total)+w.totalCalculo,impuestos:parseFloat(d.impuestos)+w.impuestoCalculo,iva:parseFloat(d.iva)+w.ivaCalculo,ieps:parseFloat(d.ieps)+w.iepsCalculo,descuento:parseFloat(d.descuento)+w.descuentoCalculo,monedero:parseFloat(d.monedero)+w.monederoCalculo};case 73:localStorage.setItem("DatosVentas",JSON.stringify(Object(b.a)(Object(b.a)({},u),{},{cliente:!0===l.venta_cliente?l.cliente:{},venta_cliente:!0===l.venta_cliente&&l.venta_cliente,productos:j,tipo_emision:l.tipo_emision?l.tipo_emision:"TICKET"}))),s(Object(b.a)({},u)),o(!i),W([]),D(!1);case 78:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return Object(B.jsxs)(l.Fragment,{children:[Object(B.jsx)(J,{alert:h,setAlert:_}),Object(B.jsx)(R.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:u,onClose:function(){return m(!1)},message:"Producto sin existencias",autoHideDuration:3e3}),Object(B.jsx)(rv,{agregarProductos:H,open:P,setOpen:D,productos:T}),Object(B.jsxs)(p.a,{width:"100%",display:"flex",justifyItems:"center",alignSelf:"center",justifySelf:"center",alignItems:"center",children:[Object(B.jsx)(p.a,{mt:1,mx:1,children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/busqueda-de-codigos-de-barras.svg",alt:"iconoBander",className:c.iconSize})}),Object(B.jsx)(F.a,{fullWidth:!0,placeholder:"Buscar producto...",variant:"outlined",size:"small",onKeyUp:function(e){return q(e)},onChange:function(e){return w(e.target.value)},disabled:t,InputProps:{endAdornment:Object(B.jsx)(Q.a,{position:"start",children:t?Object(B.jsx)(X.a,{disabled:t,children:Object(B.jsx)(I.a,{size:20,color:"primary"})}):Object(B.jsx)(X.a,{onClick:function(e){return q(e)},disabled:t,children:Object(B.jsx)(sc.a,{})})})},inputProps:{style:{textTransform:"uppercase"}}})]})]})}function jv(e){var t=e.loading,a=e.setLoading;return Object(B.jsx)(l.Fragment,{children:Object(B.jsx)(Ka.a,{children:Object(B.jsxs)($e.a,{container:!0,spacing:3,style:{padding:8},children:[Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsx)(dv,{loading:t,setLoading:a})}),Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsx)(nv,{})}),Object(B.jsx)($e.a,{item:!0,md:4,xs:12,children:Object(B.jsx)(tv,{})})]})})})}function uv(){var e=Object(l.useContext)(o_),t=e.clientesVentas,a=e.openBackDrop,n=e.DatosVentasActual,c=e.setDatosVentasActual,r=Object(l.useState)(!1),i=Object(g.a)(r,2),o=i[0],s=i[1];return Object(B.jsxs)(p.a,{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",children:[Object(B.jsx)(jv,{loading:o,setLoading:s}),Object(B.jsx)(p.a,{height:"100%",style:o?{pointerEvents:"none",opacity:.6}:null,children:Object(B.jsx)(Zg,{setDatosVentasActual:c})}),Object(B.jsx)(p.a,{display:"flex",justifyContent:"flex-end",flexDirection:"column",children:Object(B.jsxs)(Ka.a,{variant:"outlined",children:[Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsx)($e.a,{item:!0,md:6,sm:6,xs:12,children:Object(B.jsx)(p.a,{mx:2,children:Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsx)($e.a,{item:!0,xs:12,children:Object(B.jsx)(p.a,{display:"flex",alignItems:"center",children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Fe.b,{style:{fontSize:19}}),Object(B.jsx)(p.a,{mr:1}),Object(B.jsxs)(S.a,{variant:"subtitle1",children:["Cliente:"," ",Object(B.jsx)("b",{style:{fontSize:16},children:t?t.nombre_cliente:""})]})]})})}),Object(B.jsx)($e.a,{item:!0,lg:5,xs:12,children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Gg.a,{style:{fontSize:19}}),Object(B.jsx)(p.a,{mr:1}),Object(B.jsxs)(S.a,{variant:"subtitle1",children:["No. Cliente:"," ",Object(B.jsx)("b",{style:{fontSize:16},children:t?t.numero_cliente:""})]})]})}),Object(B.jsx)($e.a,{item:!0,lg:7,xs:12,children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Jg.a,{style:{fontSize:19}}),Object(B.jsx)(p.a,{mr:1}),Object(B.jsxs)(S.a,{variant:"subtitle1",children:["Clave Cliente:"," ",Object(B.jsx)("b",{style:{fontSize:16},children:t?t.clave_cliente:""})]})]})}),Object(B.jsx)($e.a,{item:!0,lg:5,xs:12,children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Fe.c,{style:{fontSize:19}}),Object(B.jsx)(p.a,{mr:1}),Object(B.jsxs)(S.a,{variant:"subtitle1",children:["Dias Credito:"," ",Object(B.jsx)("b",{style:{fontSize:16},children:t&&t.dias_credito?t.dias_credito:0})]})]})}),Object(B.jsx)($e.a,{item:!0,lg:7,xs:12,children:Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(B.jsx)(Jg.b,{style:{fontSize:19}}),Object(B.jsx)(p.a,{mr:1}),Object(B.jsxs)(S.a,{variant:"subtitle1",children:["Limite Credito:"," ",Object(B.jsxs)("b",{style:{fontSize:16},children:["$",t&&t.limite_credito?Fa(t.limite_credito):0]})]})]})})]})})}),Object(B.jsx)($e.a,{item:!0,md:6,sm:6,xs:12,children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,lg:6,xs:12,children:[Object(B.jsxs)(p.a,{display:"flex",alignItems:"center",flexDirection:"row-reverse",children:[Object(B.jsx)(p.a,{children:Object(B.jsxs)(S.a,{variant:"subtitle1",children:["Monedero :"," ",Object(B.jsxs)("b",{style:{fontSize:17},children:["$"," ",n&&n.monedero?Fa(n.monedero):0]})]})}),Object(B.jsx)(p.a,{mt:.5,mr:1,children:Object(B.jsx)(Fe.o,{style:{fontSize:19}})})]}),Object(B.jsxs)(p.a,{flexDirection:"row-reverse",alignItems:"center",display:"flex",children:[Object(B.jsx)(p.a,{children:Object(B.jsxs)(S.a,{variant:"subtitle1",children:["Descuento:"," ",Object(B.jsxs)("b",{style:{fontSize:17},children:["$"," ",n&&n.descuento?Fa(n.descuento):0]})]})}),Object(B.jsx)(p.a,{mt:.5,mr:1,children:Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/price-tag.png",alt:"icono admin",style:{width:20}})})})]})]}),Object(B.jsxs)($e.a,{item:!0,lg:6,xs:12,children:[Object(B.jsx)(p.a,{flexDirection:"row-reverse",display:"flex",mr:1,children:Object(B.jsxs)(S.a,{variant:"subtitle1",children:["Subtotal:"," ",Object(B.jsxs)("b",{style:{fontSize:17},children:["$"," ",null!==n&&void 0!==n&&n.subTotal?Fa(n.subTotal):0]})]})}),Object(B.jsx)(p.a,{display:"flex",flexDirection:"row-reverse",mr:1,children:Object(B.jsxs)(S.a,{variant:"subtitle1",children:["Impuestos:"," ",Object(B.jsxs)("b",{style:{fontSize:17},children:["$"," ",null!==n&&void 0!==n&&n.impuestos?Fa(n.impuestos):0]})]})})]})]})})]}),Object(B.jsx)(p.a,{display:"flex",flexDirection:"row-reverse",p:1,children:Object(B.jsxs)(S.a,{variant:"h4",children:["Total:"," ",Object(B.jsxs)("b",{style:{color:"green"},children:["$",null!==n&&void 0!==n&&n.total?Fa(n.total):0]})]})})]})}),Object(B.jsx)($.a,{children:Object(B.jsx)(Je.a,{style:{zIndex:"99999"},open:a,children:Object(B.jsx)(I.a,{color:"inherit"})})})]})}function bv(e){e.handleClickOpen;var t=e.loading,a=(e.type,e.setLoading),n=JSON.parse(localStorage.getItem("sesionCafi")),c=JSON.parse(localStorage.getItem("turnoEnCurso")),r=Object(z.a)(Sx),i=Object(g.a)(r,1)[0],o=Object(l.useContext)(o_).setAlert,s=Object(l.useState)(!1),d=Object(g.a)(s,2),j=d[0],u=d[1],m=Object(l.useState)([]),O=Object(g.a)(m,2),x=O[0],h=O[1],v=Object(l.useState)(""),y=Object(g.a)(v,2),k=y[0],N=y[1],P=i_(),D=[],E=Object(qe.a)($d,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id}}),A=function(e){h(Object(b.a)(Object(b.a)({},x),{},Object(_.a)({},e.target.name,e.target.value)))};E.data&&(D=E.data.obtenerCajasSucursal);var T={accesos:n.accesos,email:n.email,empresa:n.empresa,estado:n.estado,exp:n.exp,iat:n.iat,imagen:n.imagen,nombre:n.nombre,numero_usuario:n.numero_usuario,sucursal:n.sucursal,telefono:n.telefono,turno_en_caja_activo:!0,_id:n._id},W=function(){var e=Object(f.a)(C.a.mark((function e(){var t,c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a(!0),e.prev=1,x.turno_en_curso&&x.caja_elegida&&x.monto_abrir){e.next=9;break}return u(!0),a(!1),o({message:"Por favor complete los datos obligatorios",status:"error",open:!0}),e.abrupt("return");case 9:return t={horario_en_turno:x.turno_en_curso,concepto:"ABRIR TURNO",numero_caja:k.toString(),comentarios:x.comentarios,id_caja:x.caja_elegida,empresa:n.empresa._id,sucursal:n.sucursal._id,id_usuario:n._id,usuario_en_turno:{nombre:n.nombre,telefono:n.telefono,numero_usuario:n.numero_usuario.toString(),email:n.email},hora_entrada:{hora:ht()().format("hh"),minutos:ht()().format("mm"),segundos:ht()().format("ss"),completa:ht()().format("HH:mm:ss")},hora_salida:{hora:"",minutos:"",segundos:"",completa:""},fecha_entrada:{year:ht()().format("YYYY"),mes:ht()().format("MM"),dia:ht()().format("DD"),no_semana_year:ht()().week().toString(),no_dia_year:ht()().dayOfYear().toString(),completa:ht()().format("YYYY-MM-DD")},fecha_salida:{year:"",mes:"",dia:"",no_semana_year:"",no_dia_year:"",completa:""},fecha_movimiento:ht()().locale("es-mx").format(),montos_en_caja:{monto_efectivo:{monto:parseFloat(x.monto_abrir),metodo_pago:"01"},monto_tarjeta_debito:{monto:0,metodo_pago:"28"},monto_tarjeta_credito:{monto:0,metodo_pago:"04"},monto_creditos:{monto:0,metodo_pago:"99"},monto_monedero:{monto:0,metodo_pago:"05"},monto_transferencia:{monto:0,metodo_pago:"03"},monto_cheques:{monto:0,metodo_pago:"02"},monto_vales_despensa:{monto:0,metodo_pago:"08"}}},e.next=12,i({variables:{activa:!0,input:t}});case 12:null===(c=e.sent).data.crearRegistroDeTurno?(a(!1),o({message:"Lo sentimos esta caja ya esta en uso",status:"error",open:!0})):(localStorage.setItem("turnoEnCurso",JSON.stringify(c.data.crearRegistroDeTurno)),localStorage.setItem("sesionCafi",JSON.stringify(T)),o({message:"Turno abierto con exito",status:"success",open:!0}),window.location.reload());case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(1),a(!1),o({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 20:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{children:[Object(B.jsx)(Ae.a,{children:Object(B.jsxs)($e.a,{container:!0,spacing:2,children:[Object(B.jsxs)($e.a,{item:!0,xs:12,md:6,children:[Object(B.jsx)(S.a,{className:P.titulos,children:" Empleado:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"nombre_usuario",onChange:A,disabled:!0,value:n?n.nombre:"",id:"form-producto-codigo-barras",variant:"outlined"})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:6,children:[Object(B.jsxs)(S.a,{className:P.titulos,children:[Object(B.jsx)("span",{className:"obligatorio",children:"* "}),"Turno:"]}),Object(B.jsx)(H.a,{variant:"outlined",disabled:!!c,fullWidth:!0,size:"small",error:j&&!x.turno_en_curso,children:Object(B.jsxs)(mt.a,{id:"form-producto-tipo",name:"turno_en_curso",onChange:A,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),Object(B.jsx)(Ot.a,{value:"VESPERTINO",children:"Vespertino"}),Object(B.jsx)(Ot.a,{value:"MATUTINO",children:"Matutino"})]})})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:6,children:[Object(B.jsxs)(S.a,{className:P.titulos,children:[Object(B.jsx)("span",{className:"obligatorio",children:"* "}),"Caja:"]}),Object(B.jsx)(H.a,{variant:"outlined",disabled:!!c,fullWidth:!0,size:"small",error:j&&!x.caja_elegida,children:Object(B.jsxs)(mt.a,{id:"form-producto-tipo",name:"caja_elegida",onChange:A,children:[Object(B.jsx)(Ot.a,{value:"",children:Object(B.jsx)("em",{children:"Selecciona uno"})}),D.map((function(e){return!0===e.activa?null:Object(B.jsxs)(Ot.a,{value:e._id,onClick:function(){return N(e.numero_caja)},children:["Caja ",e.numero_caja]},e.numero_caja)}))]})})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,md:6,children:[Object(B.jsxs)(S.a,{className:P.titulos,children:[" ",Object(B.jsx)("span",{className:"obligatorio",children:"* "}),"Monto para abrir:"]}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"monto_abrir",inputProps:{min:0},type:"number",onChange:A,id:"form-producto-codigo-barras",variant:"outlined",error:j&&!x.monto_abrir,placeholder:"0.00",InputProps:{startAdornment:Object(B.jsx)(Q.a,{position:"start",children:"$"})}})]}),Object(B.jsxs)($e.a,{item:!0,xs:12,children:[Object(B.jsx)(S.a,{className:P.titulos,children:" Comentarios:"}),Object(B.jsx)(F.a,{fullWidth:!0,size:"small",name:"comentarios",multiline:!0,rows:5,onChange:A,id:"form-producto-codigo-barras",variant:"outlined"})]})]})}),Object(B.jsx)(Ue.a,{children:Object(B.jsx)(p.a,{display:"flex",alignItems:"flex-end",children:Object(B.jsx)(w.a,{onClick:W,variant:"contained",color:"primary",size:"large",startIcon:t||E.loading?Object(B.jsx)(I.a,{color:"inherit",size:20}):null,disabled:t||E.loading,children:"Guardar"})})})]})}ht.a.locale("es");var pv=d.a.forwardRef((function(e,t){return Object(B.jsx)(De.a,Object(b.a)({direction:"up",ref:t},e))}));function mv(){var e=JSON.parse(localStorage.getItem("turnoEnCurso")),t=JSON.parse(localStorage.getItem("sesionCafi"));return Object(B.jsx)(p.a,{height:"100%",children:t.turno_en_caja_activo&&e?Object(B.jsx)(uv,{}):Object(B.jsx)(Ov,{})})}function Ov(){var e=Object(l.useState)(!1),t=Object(g.a)(e,2),a=t[0],n=t[1];return Object(B.jsxs)(Ee.a,{open:!0,maxWidth:"sm",fullWidth:!0,keepMounted:!0,TransitionComponent:pv,disableEscapeKeyDown:!1,children:[Object(B.jsx)(wt.a,{children:"Si deseas realizar ventas inicia tu turno primeramente."}),Object(B.jsx)(bv,{type:"FRENTE",setLoading:n,loading:a})]})}var xv=a(940),hv=a(941);var _v=function(e){var t=e.props;return Object(B.jsxs)(p.a,{children:[Object(B.jsx)(p.a,{height:"5vh",children:Object(B.jsx)(fv,{props:t})}),Object(B.jsxs)($e.a,{container:!0,children:[Object(B.jsxs)($e.a,{item:!0,lg:9,md:8,children:[Object(B.jsx)(p.a,{height:"10vh",children:Object(B.jsx)(Cf,{})}),Object(B.jsx)(p.a,{height:"85vh",children:Object(B.jsx)(mv,{})})]}),Object(B.jsx)($e.a,{item:!0,lg:3,md:4,children:Object(B.jsx)(qg,{})})]})]})},fv=function(e){var t=e.props,a=n_(),n=JSON.parse(localStorage.getItem("turnoEnCurso")),c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(l.useContext)(o_),i=r.abrirTurnosDialog,o=r.setAbrirTurnosDialog,s=r.setUbicacionTurno,d=Object(l.useContext)(O_),j=d.setAbrirPanelAcceso,u=d.abrirPanelAcceso,b=d.setDepartamentos;ht.a.locale("es");function m(){console.log(c),!0===c.accesos.ventas.administrador.ver?t.history.push("/admin"):(j(!u),b({departamento:"ventas",subDepartamento:"administrador",tipo_acceso:"ver"}))}return window.onkeydown=function(e){112===e.keyCode&&m()},Object(B.jsxs)($e.a,{container:!0,alignItems:"center",children:[Object(B.jsxs)($e.a,{item:!0,md:4,style:{display:"flex"},children:[Object(B.jsx)(Re.a,{alt:"Remy Sharp",srsc:"/static/images/avatar/1.jpg",className:a.avatar}),Object(B.jsx)(S.a,{color:"textSecondary",children:null===c||void 0===c?void 0:c.nombre}),Object(B.jsx)(p.a,{mx:1}),null!==n&&void 0!==n&&n.numero_caja?Object(B.jsxs)(S.a,{color:"textSecondary",children:[Object(B.jsx)("b",{children:"Caja: "}),null===n||void 0===n?void 0:n.numero_caja]}):""]}),Object(B.jsxs)($e.a,{item:!0,md:4,style:{display:"flex",justifyContent:"center"},children:[Object(B.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/calendario.svg",alt:"icono admin",className:a.avatar}),Object(B.jsx)(S.a,{color:"textSecondary",children:ht()().format("MM/DD/YYYY")}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(S.a,{color:"textSecondary",children:Object(B.jsxs)("b",{children:[ht()().format("h:mm")," hrs."]})})]}),Object(B.jsxs)($e.a,{item:!0,md:4,style:n?{display:"flex",justifyContent:"flex-end"}:{display:"flex",justifyContent:"flex-end",zIndex:99999},children:[Object(B.jsx)(w.a,{onClick:function(){return m()},startIcon:Object(B.jsx)(xv.a,{}),style:n?null:{color:"white",borderColor:"white"},children:"F1 Administrador"}),Object(B.jsx)(p.a,{mx:1}),Object(B.jsx)(w.a,{color:"secondary",onClick:function(){!0===c.turno_en_caja_activo&&n?(o(!i),s("SESION")):(localStorage.removeItem("sesionCafi"),localStorage.removeItem("tokenCafi"),localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal"),localStorage.removeItem("turnoEnCurso"),localStorage.removeItem("ListaEnEspera"),t.history.push("/"))},startIcon:Object(B.jsx)(hv.a,{}),style:n?null:{color:"white",borderColor:"white"},children:"Salir"}),Object(B.jsx)(p.a,{mr:2})]})]})},gv=a.p+"static/media/logochafa.744b44f9.PNG",vv=a.p+"static/media/admin.cecfcd64.svg",Cv=a.p+"static/media/cart-add.eacbdb19.svg",yv=a(485),Sv=a.n(yv),Fv=Object(k.a)((function(e){return{icon:{width:150,fontSize:150}}}));var wv=[{path:"/",component:function(e){var t=ne(),a=localStorage.getItem("sesionCafi"),n=Object(l.useState)([]),c=Object(g.a)(n,2),r=c[0],i=c[1],o=Object(l.useState)(!1),s=Object(g.a)(o,2),d=s[0],j=s[1],u=Object(l.useState)({message:"",status:"",open:!1}),m=Object(g.a)(u,2),O=m[0],x=m[1],h=Object(l.useState)(!1),v=Object(g.a)(h,2),k=v[0],N=v[1];a&&e.history.push("/ventas/venta-general");var P=Object(z.a)(T),D=Object(g.a)(P,1)[0],E=function(){var t=Object(f.a)(C.a.mark((function t(a){var n,c,i;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),r.numero_usuario&&r.password){t.next=4;break}return x({message:"Los campos estan vac\xedos",status:"error",open:!0}),t.abrupt("return");case 4:return j(!0),t.prev=5,t.next=8,D({variables:{input:r}});case 8:n=t.sent,c=n.data.logearUsuario.token,i=Object(G.a)(c),j(!1),localStorage.setItem("sesionCafi",JSON.stringify(i)),localStorage.setItem("tokenCafi",JSON.stringify(c)),e.history.push("/ventas/venta-general"),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(5),x({message:t.t0.message,status:"error",open:!0}),j(!1);case 21:case"end":return t.stop()}}),t,null,[[5,17]])})));return function(e){return t.apply(this,arguments)}}(),A=function(e){"numero_usuario"===e.target.name?i(Object(b.a)(Object(b.a)({},r),{},Object(_.a)({},e.target.name,parseInt(e.target.value)))):i(Object(b.a)(Object(b.a)({},r),{},Object(_.a)({},e.target.name,e.target.value)))};return Object(B.jsxs)(y.a,{maxWidth:"sm",children:[Object(B.jsx)(J,{alert:O,setAlert:x}),Object(B.jsx)(p.a,{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",children:Object(B.jsxs)(p.a,{boxShadow:"3",p:3,width:"80%",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",justifyItems:"center",children:Object(B.jsx)(p.a,{className:t.containerImagen,textAlign:"center",children:Object(B.jsx)("img",{className:t.imagen,src:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAkFBMVEX///8AAAD7+/t1dXXU1NSCgYFbW1vOzs7e3t7q6urt7e34+Pj09PTi4uLn5+f5+fnExMSpqak7Ozu+vr6xsbHS0tKenp6Pj4+YmJhXV1e3t7eJiYmvr6+oqKhdXV27u7spKSkuLi5zc3NISEhpaGgeHh4XFhZAPz81NTV8fHxPT08iIiIrKysREBBlZGQZGRh0tFriAAAUSElEQVR4nO1d63qquhaNCOUi0CgIyKV4ayu22vd/uzMDiSIGCAq69ncce//o0ghzkGTeMkMQeuGFF1544YUXXnjhhRdeeOGFF1544f8EkjXHruevjx+LxdvHcex7IZbtZ0vVDywcrGejOmzGHtafLeLtMJxoU8utjIWP358tbGdMnOwgxI5hFanPlrkDbE+s76r4iM1niy4Cw6ufdu3Yx5NnE2hBuK+XfrU/jhWC9XGzrG92xM8mUQ874kn8efRjVbsef4amJtHii/OLr+DfHK3zt2ty40RuE9aYe8drpbS2HiJzF+DvKrssFTfpVrytcvyQB5S2O/DuUrxZoHW+hhz9XF5k8e9wnF/238671R/T/M/Lfvw3xqr1cSGV0r33ylAvh2v2fJ0jXejPnSvdfUXTu+jIpAch74FTVoOLvhyvtOw07J45HY1jSZLjfcPzEmrZ71N6vHA3hGWl0Cc/ArWkvj7nPV9cDO8lnTAbYiSlpfkYDXD9Nsglfysc6B7B+RbfDw+UvdI0uV9/1qE80Z3B7sLF+c6rvifgJfBzRqpx9q/8oe8lrc/WaLjBUsH8rOSG7cAC5278edBkTE93XD/mhubZOD7iiZZ0jPuI2+XwT/d8QAJAYfc6PNLxx497rGN2p83Dpn0O/WR+42FvdFJs42Hvcw3plOOaDnmbUw8GQ96lBtsHUFQe8hjbbz/YXDxptHSoO7Tg5KcO5MHFD9TYNThZqkGiYvx8ggglTIgBFh+1gUeIINhAPfS+vmEye/Q4R4YPlvna9H1hZo28vi/cGcwkZ/1elj25Z2QTqlgMMZocetG3Pi96M9jSXI+OsUEvuervkveAibPs75IsPjP6u+RdUKk8vTnHTEP/O7UEzPL3ZJqZJWxPyWhyBfOrKhJrXm1zBUsgV8FWY/uxijthAzS6wpV7kF234eDvzXcavRaJNtzeTusMNiLaJ6F6LerVkoNy3aYOP36DsmTZsB7GqU4vJWB9OIUKh2qbDgwBm/qpTy/0dRe5HHT980Og6YojY7UbujEEjrVDh7qRdydsWUQhYCh0noTVrEpXhvXjUKbf3xtl0Oy2SFA/5clXVQU8hqsoLyTKPjjfjepXgWlK5XgfQRqPfYu05QsowPA8AzC3YqwmpcD06X2Li/QiQiE1vwcqP+UxLHu73LKqGgNJkw53xVHUmxHK3mOebFdZuTaG3AZ1HKilvsNivNM7CPmjNTpk097qMmLhFfXVGA1qgGc3kctBu1AsKPzkSEZw6Vi1Mww5Leps1eLeTuTKWAO7hmDl9u0MJU6LUU3hEHWZhRQhD1SRitnUhCcYwaXj1s4QHTlN6nqJtr016jk0Pr8KFhy5cvxcNBNgyHtWdU+ZdqKIx8UBTV0IpmbqCFacDgGGPKVcG0PQB3tbQoNG9mKBfY2tILjw2QUYWpwmteqSqtObyqaslqd3iQZ/c9vWrsKQ599eDvUyqE28ZTWTeheCKwRUkvGKI165nQBDg9Pks/bGbtHglqKl4peC1pSNLJWnCMvlBTcyrO9D6pXsuxOkE0twTZklAiSeIiznyW8cpQ2+J82LdC9EoSuugqmePROEpybKz/dGTdOQwteuH6MYit8J6hnmh3h8561kUW+0Fk3xaaFrOjun9DaCHh8TSiuttpdQcjkEGMacJk32js6QrrE+XeERbE3nwqFGvpLTIMCQk3DcNd2cesRdh2nxK9G0+ejcnOeBl9Y7BBhy4vzmRF/xg47alKZ5BAcpy4rn+V9efHdWdO0MOY9o2Xx7GuR126VJfyToKVwkjcfXEpbscTtDTh6jxevQSs9XGEUZ+UKwNfVgC3XGi2DPaZBWhhx737rlotDfnRaFJ8WlBSevSSUpUjI8g/0nzvB6A2N7/VWhFn87EGQeu2A1J1shpoNpdyVj6UptDK+3+AkMPjpsuuwgotNQsDWbeQ0kTqOhMV86ia92Iu5FgjeqnLqka94u79wCKgzzf5yqlKOSKucx/PtY5Pi7+qZhZeYCRWa+yxJGcX3BAkS2gMAUJi82OPm3HdYtDuLb4ApHSlQxolOvCz5Atgh+Mnq81Dy7ljDDTZfSNWquxH9AFY1gYQLdoHR2XHyOwGwEdejDb1+Y5LyTwKjjI2GD8jwLOGvBJ9e/2+rarycWvVELJa5qCt9XsDyIbU44j2mTJ6xxC8ORqPoolJR4YW8x7gTzV6zOrPQR76URaT3DhWkQ2NqUlwMR6pnijuJeTWGVBBMYVI6yaQk4co7rGZZ+avC+F3jUypUMjaCjTEyVMltRfh5zjpjLeoYX04E3idvnS6E5/lrbUdBEiZg1Yv1VDrEnHClpmN4eW8icFq2dQ5WBKEN6D7HQiRq/y8fHW8RIBBly6wHanI9OIp+yLkJtma24nCseR8g3UYZcj6FlQNFhJ7p8Me3AkEWDlwpP48hYxOAiDHmObctiPX3QokULxdRqzP6cwFJrlY95DOeiDCXeC5ia9Z7Ee871KPIIYn4svX+1Ma/yxBdleN5dVUJL5raokBJdvViLXLIAU3zVRAMvub8RZsjLSLZk34tEhmhGsegAoRIT5mRXpzh3IpqiDLm/bh6mRYZPdMNZoeuFXCCasbgqQeQm9x1RhtwIs1n6QhDRGHgvzJBbrFeLsShD6TrabxtTBUPRzRLiDLkTpha/ogzRitOq2V7MBmLIjQXqYYsy5Nn8ZuvVrQ+F5yG3uKcBU1GG1ddqETRv9ug2D4V1KS+GaMLxnj5sZlhk20R16ZqJ0wZeQqYR98zD5lFa6CbRVy4J+zS87HYjZDGG7zy3rXn1rPBpRLfvivqlbB1scbWTBKDxVtmCO+xho16gFRmifiktUWltx2wFf/2SV+27EWPIi/ObPTJqmEXTj6LxIXOv+WlKbh2YGEPu/G6MjKifJ7qWT5u3pSpZrqJmOHNTGSqvZ68Yrng/bRSHRgCCBEXzNGws1ZlZXk4x4nVPlSF3kDar9rAbQ/r026Yt6446p5+XU9yIMOTZ+5bQorjXUowfYvnSNuPCbEXd97yk2YhnyysMeU+mrdC5yNKLby4pxldLIpbZivrL8iTl4ZIhv5y6JQMzE5G4hELhtRSosKRffWq8ZpdPI0OTl8Fol/2rRZQq6GNsbsRW3OuXtGqL2ys45XsNlVeqMmr3r7oteKKTMmssaGTGoKFijpuM4OCwyrHkxb05WsudqMDipQrUa2pUpsygN4Vkggzb0B7HdausOIvWGG0x56RpZPDnVEd8Coy9YsZ32adX5HkbB8cvFaBpqYBXHtURK6F3QxTju8urndqXuVkhb+Nz48YIHbCMxFxpKkyXehpqrBuuz8xy88Lyzdw+F2MPCysOGuR02pFQ/OQZb/S6BUVCrFsddJFuu3lP2INReJnd3ixDJ+Lz36Ytgm7lvhTUWNftMX4W+OLQeKXjcyl+xNeUDbu4BgY/ZF3l33XdoUcNOvepcSPU5zGk463rGyMpC+4w/ccY0kHaWWcUP+NWsvxjDIt0d/dd+XRfBy82KhjupqEyOnjp9O+I16MvDLFSMHoL3UWGP0bw8WGdgr3JcBqGP15IlLOPw9BzwDxjZ41DJ5jhFH4dOGGYfcfuevSHg1EEX0Qjxx1leP+J4VcefL3eu+62jiF93t1fVknXJHhZyuKa5myEt7Yx0iYZeDh/ZDrgNcxfOURj3R5ppg8f7z3SWlZGUUhWSBckMUfMbICyBbKQM5JsDAH6jwTSzxQkjVy03aJ4YgKZJL+mBtHtLv+6hiF1728wbMUPl3UMdyhc/SjgXCcI5wzBKmEDRMlClCAXninEBMtNQFqb2n60IJP6jTAcB+/IhzGCSCmTPsHoG/Rg8vn9h+HPGB1XCJvGnyNZB8JQhlG4Rt4hP16Iw5CWqN3y/g/qeXJil6IP5yCgAi6hhwzGUM3vNwXKCcljRUjbBUhPFPD+tBVhmMbbGKWuCgyDAIXIwtIbRmH8YxPnUs2QnyBH11aSnq01NCsYxvHSpD4IhyH1TW556QANDDgJhJzhYecbwI0wtIDh54nhbA6iT4GhSaQLiPXcgbgWYbgfbSJTmhKGqTLboHSGPAet4GLeBDnBD5p76Aj/v1vhT4KUguFo9DVLpFwxcBgWeua2Vw3RRNJ1JVXOcAGSm3P4O4RJBQqbUMAaWo4iCToPA514dQBVTlqTryYFw5kfoqOcj1J4eDAPrRTtRuOEuCSJZ0oJmYeJaWieC0NBLhj6PjxBj8uQ1k/dFiNQJXW9f634QvV9c6OYsekrSE5imHd4PdOtxI3RWDFiM/Jm4Az7MEoTK8l0n2gaZ+oEWwSCBiSfvIAHIZkqCqexHAWGTdZ4DLT9QOqEzBG4k5kkJnKn8VxJDP48/K5X+QKgYfxVQopS338Qnx5U3NdyNYM75Rni39Xo7/eQf0wKTn6/lr+z2eH7SK71udzNZn+j5ehn+fX7BQP99xP+/PmBT0eLBWl/WC6Xh9Fy+UPowFfw29+f2Ww3elvw7SEV5daXw9MkxFUi6B+y+Juaz0VBl2KrnfjvMKSSdNhKUgFN6VZnorYdPwfb6vogXQW5401RNY/uX0F6bxee1ibuucSQ+Lq7C1ki8qkvuK4H9bpufDkNBR0H9S/eeATkwFeyYzTeRkqinhe7jX7mELWogx8nUwvDjzycosAGXxBLEQ62n+MkDyQ2fD3YFWz96Enn9JnKWAutCXr/0BLoK5XYZnVuBgpoVVqxc3c+kK7o3fFOtDsQf+uIuJz2h70FNxXNSRGuoyLLGUdmERref7YeWyd8Rv5bmYKzkYTpWoHe3ALRN7KjwZEdMvUih+TL+njyYT8TujuCSAISqYxQHt7ax0yJkQQCWUS1mzqGh97PaaV0i8+yj2t1QKYjG6Jj+Gue5Fpg7qiqip10vvaQ5CtbSe3r9EemlR90uhNFNNFjLUSqjPQ5AgVjxhqSMcYWMPWjtYUmx3nQ11v+aSXf0Kf0XCCUVRWm3BTHZKhC8JgiB4MChYgZAkqYMR/RXgUPuafbHR8+Fc2to2nSPB+dMFDjEJv0iFPTMqdoimQXaclWtXo6ymDCqiQethblT2ysp4X+VsEqOhLd8IOzsY4SlEaEb2Zpck9nL7ICrkdZRQMmGLhnMvThdDpV1s57sZxvREmuWbGeKwUFqXbS08BixT/3ebnC8CZIdRyk4jSNNFm2sAbTUrOj/Jhnc2srSp7khCGq4r4MNSscecy5rpmpakgLUwdhYvssC/shfguQnitP2w9DFcsTRKK6ifh7CVrAigof4duA+LZG0mfqewL608DSHOyFB1ogg7Grh7L5bk4MnMbwaZAFPZ00a7L6+QecNJMQr4XcR5eAg7/2DQ3GTqgiYw3uqYpwiFUM/1TTdSaT6dgPTlVqw58j7YMvkxYp0CSDf7jbheekzluWocnClsMiRjRdy85Dc6uvQ9JOi9uD96Ivm5NT0okot1h2nBTPXbJ+EZwDOXlu5ZMw6+vwp1MR19Bz0QMLQOIk3c1w6gbIVTExf1qamtZbObc5t1P4YtqfPKed8gMfiuRDX0ngI8boPYV/xSpVl+8pPubjUvMDP+/kUMJoGvaYgTjtsx/WC7fCd4wkJ4CpCIS2KvSno5A1OktdELfKc2QPeTGK7ImMHQW5PZ7CdqLY+6FgZUCfGe40JHKHXnZUTQTmHxkKccXfPNV113EiI7zGQRbrXmriPh3mU2Xz5wCn1zFYnjZBRQZzoSFMRir5G0J7FSPdH8uYKKAJDKTENd1o4vd6zBwLpQZNokbgvMi5zgR7CG7NJFffugsWUCL/Bj2Av7/hGWeanm7Uab/nNJ0rooZLMWpElZH8Re5mkwCRfKrOEZmSYOq3WgjxvupqimXM7W3Q87mv550im8GiKWMM4aAeQti7WytgKvIIAuYhDsFBDn1fdueGgcN5puB1gEy/50MZjXNR/XDHPVq+4kEnYhl9qMSHiwJlggx1G2I9iTQ6Q0JZcU1QuXJPrukJ0vn9M9tubw3tBBMHY4gLgwQTK09sfojXMDXeie4xYhL0h0DVBsvR/4lwpU12Q57aacB8NDLk4tzkGy625ZGWT0zV1y3FRjp8g320HmC6lCowF8Od6U4Uzha6L52D4+2oGNSrHwUkZszjCTIx8XjpTftKSF3AKO2hG0ypkgtvLaQuPmKM0/EHGI2xShiq+cRzdeR4LjLVgQ5HLW8lHOAWkq8AEfhvHHhSAr3phEgej7G5IAxzC5gzzGzUfArdHZBL27V/+56O0wN5u1YEGgUl2CGRMIk4TNkJPDIPz6MURm0wXA6wvKt31yNHKckXsCeEQ4qIoowsI1sjM/B3cqFpAsOmmiYNej5W9gJaeUfrMr7llIlrmGy7ioaSFE2Az8RQow/FO2ZzkgKWcmuRxJPCWhh/A7rIqPoCl+j+m2nn/WAQ3mOYjBay5dSVkamr8kQNweLL1OKn8yg0g6ED8snlBvRFeo8PYE4vtjmvif+G5qBWNAPUpykbthltbN9XU1nX1VQdp4pyGH6xwa7swhvf6OqbTmVfrUI0iJk5+sR0TCtQPPXNzxRws9daigGptla2wSDnrFehVU5EOKydrupNd6vbhhXmismJl8RJSByLyFHTce4J4MUe+q7noKIJ1tVuyk0wF2VpYP/qNSkK19VUEm+6H0cwSN4cDVRo8sh9SzrnlRe7KNSap6UpT7Prt6Ac6t6uiyNPxdNs5yaeg1zHi3o/RL4R0pT7wpqfYzRVNftSFtOSsRe9cTc37xssKy5WDLUE2UmUPOGQabnxvN+v3w3ge8l7wc6p+/wWgwM+m7ZVIt8dzuFvAeadwyKKTCCU9cMH6pcaYLGTmyv4iQQj9X+jGFRLRN8ZUWAbP23Q3QHN5R5SVsW3kg7rWA4MzQnGvHfxEOwzDz+pJLB/GJrquJ7vR1Hk+17oqNp/Y4/xCy+88MILL7zwwgsvvPDCCy+88MILPeJ/6rkiEY2oJj0AAAAASUVORK5CYII=",alt:"imagen no disponible"})})}),Object(B.jsx)(p.a,{display:"flex",textAlign:"center",justifyContent:"center",children:Object(B.jsx)(S.a,{variant:"h4",component:"p",className:t.margin,children:Object(B.jsx)("b",{children:"Inicia sesi\xf3n"})})}),Object(B.jsxs)("form",{autoComplete:"off",onSubmit:E,children:[Object(B.jsx)(F.a,{label:"Numero de usuario",variant:"outlined",name:"numero_usuario",fullWidth:!0,className:t.margin,onChange:A}),Object(B.jsxs)(H.a,{variant:"outlined",name:"password",className:t.margin,fullWidth:!0,children:[Object(B.jsx)(Y.a,{htmlFor:"usuario-password",children:"Contrase\xf1a"}),Object(B.jsx)(K.a,{name:"password",id:"usuario-password",type:k?"text":"password",onChange:A,endAdornment:Object(B.jsx)(Q.a,{position:"end",children:Object(B.jsx)(X.a,{onClick:function(){N(!k)},onMouseDown:function(e){e.preventDefault()},edge:"end",children:k?Object(B.jsx)(ee.a,{}):Object(B.jsx)(ae.a,{})})}),labelWidth:70})]}),Object(B.jsx)(w.a,{fullWidth:!0,size:"large",variant:"contained",disableElevation:!0,className:t.margin,color:"primary",type:"submit",endIcon:d?Object(B.jsx)(I.a,{size:25,color:"inherit"}):null,children:"Entrar"})]})]})})]})},exact:!0},{path:"/home",component:function(e){var t=Fv();return JSON.parse(localStorage.getItem("sesionCafi"))||e.history.push("/"),Object(B.jsx)(y.a,{maxWidth:"md",children:Object(B.jsxs)(p.a,{height:"90vh",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",children:Object(B.jsx)("img",{alt:"logo ab",src:gv})}),Object(B.jsxs)(p.a,{display:"flex",justifyContent:"center",my:6,children:[Object(B.jsx)(w.a,{component:x.b,to:"/admin/inicio",children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",textAlign:"center",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",children:Object(B.jsx)("img",{src:vv,alt:"icono numero calzado",className:t.icon})}),"Admin"]})}),Object(B.jsx)(w.a,{component:x.b,to:"/ventas/venta-general",children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",textAlign:"center",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",children:Object(B.jsx)("img",{src:Cv,alt:"icono numero calzado",className:t.icon})}),"Ventas"]})}),Object(B.jsx)(w.a,{color:"secondary",onClick:function(){localStorage.removeItem("sesionCafi"),localStorage.removeItem("tokenCafi"),e.history.push("/")},children:Object(B.jsxs)(p.a,{display:"flex",flexDirection:"column",textAlign:"center",children:[Object(B.jsx)(p.a,{display:"flex",justifyContent:"center",children:Object(B.jsx)(Sv.a,{className:t.icon})}),"Cerrar sesion"]})})]})]})})},exact:!0},{path:"/admin",component:function(e){return localStorage.getItem("sesionCafi")||e.history.push("/"),Object(B.jsx)("div",{children:Object(B.jsxs)(ge,{children:[Object(B.jsx)(t_,{}),Object(B.jsx)(Yh,{})]})})},exact:!1,routes:[{path:"/admin/inicio",component:Yh,exact:!0}]},{path:"/ventas/venta-general",component:function(e){return localStorage.getItem("sesionCafi")||e.history.push("/"),Object(B.jsx)(p.a,{height:"100%",children:Object(B.jsx)(s_,{children:Object(B.jsx)(_v,{props:e})})})},exact:!1}],Iv=wv,kv=a(262),zv=a(487),Nv=Object(zv.a)({palette:{navbar:Xh.a[50],primary:{main:kv.a[500]},secondary:{main:"#f50057"}}}),Pv=a(196),Dv=a(947),Ev=a(942),Av=a.n(Ev)()({uri:"https://cafi-punto-venta.herokuapp.com/"}),Tv=new Pv.a({connectToDevTools:!0,cache:new Dv.a({addTypename:!1}),link:Av}),Wv=a(944);function $v(e){return Object(B.jsx)(h.a,{path:e.path,exact:e.exact,render:function(t){return Object(B.jsx)(e.component,Object(b.a)({routes:e.routes},t))}})}var Rv=function(){return Object(B.jsxs)(p.a,{height:"100vh",className:"App",children:[Object(B.jsx)(m.a,{}),Object(B.jsx)(Wv.a,{client:Tv,children:Object(B.jsx)(x_,{children:Object(B.jsx)(Zi,{children:Object(B.jsx)(O.a,{theme:Nv,children:Object(B.jsx)(x.a,{children:Object(B.jsx)(h.c,{children:Iv.map((function(e,t){return Object(B.jsx)($v,Object(b.a)({},e),t)}))})})})})})})]})},Vv=function(e){e&&e instanceof Function&&a.e(5).then(a.bind(null,1121)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;a(e),n(e),c(e),r(e),i(e)}))};a(808);u.a.render(Object(B.jsx)(Rv,{}),document.getElementById("root")),Vv()}},[[809,1,2]]]);
//# sourceMappingURL=main.8bd0a02a.chunk.js.map