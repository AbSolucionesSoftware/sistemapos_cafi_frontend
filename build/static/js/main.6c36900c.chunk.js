(this.webpackJsonpsistemapos_cafi_frontend=this.webpackJsonpsistemapos_cafi_frontend||[]).push([[0],{667:function(e,t){},669:function(e,t){},680:function(e,t){},682:function(e,t){},709:function(e,t){},711:function(e,t){},712:function(e,t){},717:function(e,t){},719:function(e,t){},738:function(e,t){},750:function(e,t){},753:function(e,t){},783:function(e,t,a){},784:function(e,t,a){"use strict";a.r(t);var n,c,r,i,o,s=a(2),l=a.n(s),d=a(52),j=a.n(d),u=a(3),b=a(920),p=a(917),m=a(918),O=a(138),x=a(60),h=a(12),f=a(9),g=a.n(f),_=a(15),v=a(4),C=a(836),y=a(95),S=a(837),w=a(841),I=a(842),k=a(832),N=a(835),F=a(17),z=a(169),P=Object(z.d)(n||(n=Object(F.a)(["\n\tmutation crearUsuario($input: CrearUsuarioInput) {\n\t\tcrearUsuario(input: $input) {\n\t\t\t_id\n\t\t\tnumero_usuario\n\t\t\tnombre\n\t\t\ttelefono\n\t\t\tcelular\n\t\t\temail\n\t\t\tturno_en_caja_activo\n\t\t\tdireccion {\n\t\t\t\tcalle\n\t\t\t\tno_ext\n\t\t\t\tno_int\n\t\t\t\tcodigo_postal\n\t\t\t\tcolonia\n\t\t\t\tmunicipio\n\t\t\t\tlocalidad\n\t\t\t\testado\n\t\t\t\tpais\n\t\t\t}\n\t\t\timagen\n\t\t\testado_usuario\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t\taccesos {\n\t\t\t\tmi_empresa {\n\t\t\t\t\tdatos_empresa {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tinformacion_fiscal {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcompras {\n\t\t\t\t\tabrir_compra {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcompras_realizadas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcompras_espera {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttesoreria {\n\t\t\t\t\tcuentas_empresa {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tegresos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tabonos_proveedores {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tabonos_clientes {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treportes {\n\t\t\t\t\treporte_historial_cajas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_turnos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_compras {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_ventas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\trerporte_almacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_corte_caja {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_tesoreria {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tventas {\n\t\t\t\t\tcancelar_venta {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tprecios_productos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tpre_corte {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcotizaciones {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tadministrador {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\teliminar_ventas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tproducto_rapido {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\talmacenes {\n\t\t\t\t\talmacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\ttraspasos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tinventario_almacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcatalogos {\n\t\t\t\t\tclientes {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tusuarios {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tmarcas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcontabilidad {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tprovedores {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcajas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tdepartamentos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcentro_costos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tconceptos_almacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcategorias {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcolores {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcolores {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\ttallas_numeros {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"]))),D=Object(z.d)(c||(c=Object(F.a)(["\n\tquery obtenerUsuarios($sucursal: String!, $filtro: String) {\n\t\tobtenerUsuarios(sucursal: $sucursal, filtro: $filtro) {\n\t\t\t_id\n\t\t\tnumero_usuario\n\t\t\tnombre\n\t\t\ttelefono\n\t\t\tcelular\n\t\t\tturno_en_caja_activo\n\t\t\temail\n\t\t\tdireccion {\n\t\t\t\tcalle\n\t\t\t\tno_ext\n\t\t\t\tno_int\n\t\t\t\tcodigo_postal\n\t\t\t\tcolonia\n\t\t\t\tmunicipio\n\t\t\t\tlocalidad\n\t\t\t\testado\n\t\t\t\tpais\n\t\t\t}\n\t\t\timagen\n\t\t\testado_usuario\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t\taccesos {\n\t\t\t\tmi_empresa {\n\t\t\t\t\tdatos_empresa {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tinformacion_fiscal {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcompras {\n\t\t\t\t\tabrir_compra {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcompras_realizadas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcompras_espera {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttesoreria {\n\t\t\t\t\tcuentas_empresa {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tegresos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tabonos_proveedores {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tabonos_clientes {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treportes {\n\t\t\t\t\treporte_historial_cajas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_turnos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_compras {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_ventas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\trerporte_almacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_corte_caja {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\treporte_tesoreria {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tventas {\n\t\t\t\t\tcancelar_venta {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tprecios_productos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tpre_corte {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcotizaciones {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tadministrador {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\teliminar_ventas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tproducto_rapido {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\talmacenes {\n\t\t\t\t\talmacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\ttraspasos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tinventario_almacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcatalogos {\n\t\t\t\t\tclientes {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tusuarios {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tmarcas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcontabilidad {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tprovedores {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcajas {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tdepartamentos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcentro_costos {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tconceptos_almacen {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcategorias {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\tcolores {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t\ttallas_numeros {\n\t\t\t\t\t\tver\n\t\t\t\t\t\tagregar\n\t\t\t\t\t\teditar\n\t\t\t\t\t\teliminar\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"]))),E=Object(z.d)(r||(r=Object(F.a)(["\n\tmutation actualizarUsuario($input: ActualizarUsuarioInput, $id: ID!) {\n\t\tactualizarUsuario(id: $id, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),A=Object(z.d)(i||(i=Object(F.a)(["\n\tmutation logearUsuario($input: LogearUsuarioInput) {\n\t\tlogearUsuario(input: $input) {\n\t\t\ttoken\n\t\t}\n\t}\n"]))),T=(Object(z.d)(o||(o=Object(F.a)(["\n\tmutation asignarAccesosUsuario($input: CrearArregloDeAccesosInput, $id: ID!) {\n\t\tasignarAccesosUsuario(id: $id, input: $input) {\n\t\t\tmessage\n\t\t}\n}\n"]))),a(785)),W=a(927),R=a(441),$=a.n(R),M=a(442),L=a.n(M),V=a(0),U=Object(k.a)((function(e){return{snack:{zIndex:"".concat(99999,"!important")}}}));function B(e){var t=e.alert,a=e.setAlert,n=U();return Object(V.jsx)(T.a,{children:Object(V.jsx)(W.a,{className:n.snack,anchorOrigin:{vertical:"top",horizontal:"center"},open:t.open,onClose:function(){a({open:!1,status:t.status,message:""})},autoHideDuration:3e3,message:Object(V.jsxs)(b.a,{display:"flex",children:["success"===t.status?Object(V.jsx)($.a,{style:{color:"#22bb33"}}):Object(V.jsx)(L.a,{style:{color:"red"}}),Object(V.jsx)(b.a,{mr:1}),Object(V.jsx)(y.a,{children:t.message})]})})})}var J=a(443),G=a(791),q=a(792),H=a(800),Y=a(840),X=a(485),K=a(131),Q=a.n(K),Z=a(159),ee=a.n(Z),te=Object(k.a)((function(e){return{margin:{marginTop:e.spacing(2),marginBottom:e.spacing(2)},containerImagen:{maxWidth:170,maxHeight:170},imagen:{width:"100%",height:"100%"}}}));var ae={receta_farmacia:!1,clave_producto_sat:{Name:"",Value:""}},ne={monedero:!1,monedero_electronico:0,iva_activo:!0,ieps_activo:!1,ieps:0,iva:16,granel:!1,inventario:{inventario_minimo:0,inventario_maximo:0,unidad_de_inventario:"Pz",codigo_unidad:"H87"},precio_de_compra:{precio_con_impuesto:0,precio_sin_impuesto:0,iva:0,ieps:0},unidad_de_compra:{unidad:"Pz",codigo_unidad:"H87",cantidad:1,precio_unitario_sin_impuesto:0,precio_unitario_con_impuesto:0}},ce={codigo_barras:"",unidad:"Pz",codigo_unidad:"H87",cantidad:1,precio:0,precio_unidad:{numero_precio:0,precio_neto:0,precio_venta:0,unidad_mayoreo:0,iva_precio:0,ieps_precio:0,utilidad:0,precio_general:0,cantidad_unidad:0,unidad_maxima:!1},unidad_principal:!0,default:!0},re=[{numero_precio:1,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:2,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:3,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:4,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:5,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:6,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0}],ie=[],oe={id_almacen:"",almacen:"",cantidad:0,fecha_de_expiracion:""},se={},le={precio_piezas:[],precio_cajas:[],precio_costales:[]},de=[],je=[],ue=[],be={index:"",image:""},pe={error:!1,message:""},me=[],Oe=[],xe=Object(s.createContext)(),he=function(e){var t=e.children,a=Object(s.useState)(ae),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(ne),o=Object(v.a)(i,2),d=o[0],j=o[1],u=Object(s.useState)(ce),b=Object(v.a)(u,2),p=b[0],m=b[1],O=Object(s.useState)(re),x=Object(v.a)(O,2),h=x[0],f=x[1],g=Object(s.useState)(ie),_=Object(v.a)(g,2),C=_[0],y=_[1],S=Object(s.useState)(oe),w=Object(v.a)(S,2),I=w[0],k=w[1],N=Object(s.useState)(se),F=Object(v.a)(N,2),z=F[0],P=F[1],D=Object(s.useState)(le),E=Object(v.a)(D,2),A=E[0],T=E[1],W=Object(s.useState)(de),R=Object(v.a)(W,2),$=R[0],M=R[1],L=Object(s.useState)(je),U=Object(v.a)(L,2),B=U[0],J=U[1],G=Object(s.useState)(ue),q=Object(v.a)(G,2),H=q[0],Y=q[1],X=Object(s.useState)(be),K=Object(v.a)(X,2),Q=K[0],Z=K[1],ee=Object(s.useState)(pe),te=Object(v.a)(ee,2),he=te[0],fe=te[1],ge=Object(s.useState)(me),_e=Object(v.a)(ge,2),ve=_e[0],Ce=_e[1],ye=Object(s.useState)(null),Se=Object(v.a)(ye,2),we=Se[0],Ie=Se[1],ke=Object(s.useState)(!1),Ne=Object(v.a)(ke,2),Fe=Ne[0],ze=Ne[1],Pe=Object(s.useState)(Oe),De=Object(v.a)(Pe,2),Ee=De[0],Ae=De[1],Te=Object(s.useState)([]),We=Object(v.a)(Te,2),Re=We[0],$e=We[1],Me=l.a.useState(!1),Le=Object(v.a)(Me,2),Ve=Le[0],Ue=Le[1],Be=Object(s.useState)({message:"",status:"",open:!1}),Je=Object(v.a)(Be,2),Ge=Je[0],qe=Je[1],He=Object(s.useState)([]),Ye=Object(v.a)(He,2),Xe=Ye[0],Ke=Ye[1],Qe=Object(s.useState)([]),Ze=Object(v.a)(Qe,2),et=Ze[0],tt=Ze[1],at=Object(s.useState)([]),nt=Object(v.a)(at,2),ct=nt[0],rt=nt[1],it=Object(s.useState)([]),ot=Object(v.a)(it,2),st=ot[0],lt=ot[1],dt=Object(s.useState)(!1),jt=Object(v.a)(dt,2),ut=jt[0],bt=jt[1];return Object(V.jsx)(xe.Provider,{value:{datos_generales:c,setDatosGenerales:r,precios:d,setPrecios:j,almacen_inicial:I,setAlmacenInicial:k,imagenes:B,setImagenes:J,imagenes_eliminadas:H,setImagenesEliminadas:Y,onPreview:Q,setOnPreview:Z,validacion:he,setValidacion:fe,preciosP:h,setPreciosP:f,preciosPlazos:A,setPreciosPlazos:T,unidadesVenta:C,setUnidadesVenta:y,centro_de_costos:z,setCentroDeCostos:P,unidadVentaXDefecto:p,setUnidadVentaXDefecto:m,subcategorias:$,setSubcategorias:M,subcostos:ve,setSubcostos:Ce,selectedDate:we,setSelectedDate:Ie,update:Fe,setUpdate:ze,presentaciones:Ee,setPresentaciones:Ae,presentaciones_eliminadas:Re,setPresentacionesEliminadas:$e,actualizarLista:Ve,setActualizarLista:Ue,alert:Ge,setAlert:qe,datosPreciosProducto:Xe,setDatosPreciosProducto:Ke,preciosDescuentos:et,setPreciosDescuentos:tt,preciosProductos:ct,setPreciosProductos:rt,datosEnDescuentos:st,setDatosEnDescuentos:lt,almacen_existente:ut,setAlmacenExistente:bt},children:t})},fe=a(44),ge=a(445),_e=a.n(ge),ve=a(62),Ce=a(26),ye=a(856),Se=a(855),we=a(922),Ie=a(874),ke=Object(s.createContext)(),Ne=function(e){var t=e.children,a=Object(s.useState)({nombre_empresa:"",nombre_dueno:"",telefono_dueno:"",celular:"",correo_empresa:"",nombre_fiscal:"",rfc:"",regimen_fiscal:"",curp:"",info_adicio:"",direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},direccionFiscal:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},datosBancarios:{cuenta:"",sucursal:"",clave_banco:""},imagen:null}),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)({error:!1,message:""}),u=Object(v.a)(j,2),b=u[0],p=u[1],m=Object(s.useState)(!1),O=Object(v.a)(m,2),x=O[0],h=O[1];return Object(V.jsx)(ke.Provider,{value:{empresa:c,setEmpresa:r,toUpdate:l,setToUpdate:d,error:b,setError:p,update:x,setUpdate:h},children:t})},Fe=a(857),ze=a(844),Pe=a(846),De=a(799),Ee=a(858),Ae=a(795),Te=a(859),We=a(850),Re=a(18),$e=a.n(Re),Me=a(486),Le=Object(k.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff",backgroundColor:"rgba(0, 0, 0, 0.3)"}}}));function Ve(e){var t=e.loading,a=(e.setLoading,Le());return Object(V.jsx)("div",{children:Object(V.jsx)(Me.a,{className:a.backdrop,open:t,children:Object(V.jsx)(I.a,{color:"inherit"})})})}var Ue=a(446),Be=a.n(Ue);function Je(e){e.error;var t=e.altura;return t||(t=400),Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:t,children:[Object(V.jsx)(Be.a,{style:{fontSize:100,color:"rgba(17,85,204, 0.7)"}}),Object(V.jsx)(y.a,{align:"center",style:{fontSize:18,color:"rgba(17,85,204)"},children:"Hubo un problema"})]})}var Ge,qe,He=a(447),Ye=Object(z.d)(Ge||(Ge=Object(F.a)(["\n  query obtenerEmpresa($id: ID!) {\n    obtenerEmpresa(id: $id) {\n      _id\n      nombre_empresa\n      nombre_dueno\n      telefono_dueno\n      celular\n      correo_empresa\n      limite_timbres\n      timbres_usados\n      sello_sat\n      nombre_cer\n      nombre_key\n      imagen\n      nombre_fiscal\n      rfc\n      regimen_fiscal\n      curp\n      info_adicio\n      direccion {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      direccionFiscal {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      cuenta_empresa{\n        dinero_actual\n      }\n      datosBancarios {\n        cuenta\n        sucursal\n        clave_banco\n      }\n    }\n  }\n"]))),Xe=Object(z.d)(qe||(qe=Object(F.a)(["\n  mutation actualizarEmpresa($id: ID!, $input: EditarEmpresa) {\n    actualizarEmpresa(id: $id, input: $input) {\n      _id\n      nombre_empresa\n      nombre_dueno\n      telefono_dueno\n      celular\n      correo_empresa\n      limite_timbres\n      timbres_usados\n      sello_sat\n      nombre_cer\n      nombre_key\n      imagen\n      nombre_fiscal\n      rfc\n      regimen_fiscal\n      curp\n      info_adicio\n      direccion {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      direccionFiscal {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      datosBancarios {\n        cuenta\n        sucursal\n        clave_banco\n      }\n    }\n  }\n"]))),Ke=function(e){return e?new Date(e).toLocaleDateString("es-MX",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):null},Qe=function(e){return e?new Date(e).toLocaleDateString("es-MX",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):null},Ze=function(e){if(e){return(e%1===0?e:parseFloat(e).toFixed(2)).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}return null},et=function e(t){if(Array.isArray(t))return t.map(e);if(null!==t&&"object"===typeof t){var a={};for(var n in t)"__typename"!==n&&(a[n]=e(t[n]));return a}return t},tt=function(){var e=Object(_.a)(g.a.mark((function e(t){var a,n,c,r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,a=JSON.parse(localStorage.getItem("DatosVentas")),n=null===a?[]:a.productos,c=!1,r={producto:{},index:0},i=0;case 6:if(!(i<n.length)){e.next=21;break}if("undefined"===typeof n[i].codigo_barras){e.next=14;break}if(n[i].codigo_barras!==t.codigo_barras){e.next=12;break}return r={producto:n[i],index:i},c=!0,e.abrupt("return",{producto_found:r,found:c});case 12:e.next=18;break;case 14:if(n[i].id_producto.datos_generales.clave_alterna!==t.id_producto.datos_generales.clave_alterna){e.next=18;break}return r={producto:n[i],index:i},c=!0,e.abrupt("return",{producto_found:r,found:c});case 18:i++,e.next=6;break;case 21:return e.abrupt("return",{producto_found:r,found:c});case 24:return e.prev=24,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(t){return e.apply(this,arguments)}}(),at=function(){var e=Object(_.a)(g.a.mark((function e(t,a,n){var c,r,i,o,s,l,d,j,u,b,p,m,O=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=O.length>3&&void 0!==O[3]?O[3]:0,r=0,i=0,o=0,s=0,l=0,d=0,j=0,u=a>0?a:1,console.log(t.id_producto.precios.precios_producto[0].precio_venta),b=parseFloat(t.id_producto.precios.precios_producto[0].precio_venta)*parseFloat("0.".concat(t.id_producto.precios.iva<9?"0".concat(t.id_producto.precios.iva):t.id_producto.precios.iva)),p=parseFloat(t.id_producto.precios.precios_producto[0].precio_venta)*parseFloat("0.".concat(t.id_producto.precios.ieps<9?"0".concat(t.id_producto.precios.ieps):t.id_producto.precios.ieps)),m=c,i=!0===n.granel?m*u*parseFloat(n.valor):m*u,r=!0===n.granel?(m-(b+p))*u*parseFloat(n.valor):(m-(b+p))*u,o=!0===n.granel?(b+p)*u*parseFloat(n.valor):(b+p)*u,console.log(u),s=!0===n.granel?b*u*parseFloat(n.valor):b*u,l=!0===n.granel?p*u*parseFloat(n.valor):p*u,d=!0===n.granel?!0===t.descuento_activo?parseFloat(t.descuento.dinero_descontado)*u*parseFloat(n.valor):0:!0===t.descuento_activo?parseFloat(t.descuento.dinero_descontado)*u:0,j=t.id_producto.precios.monedero?t.id_producto.precios.monedero_electronico*u:0,e.abrupt("return",{totalCalculo:i,subtotalCalculo:r,impuestoCalculo:o,ivaCalculo:s,iepsCalculo:l,descuentoCalculo:d,monederoCalculo:j});case 16:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),nt=function(){var e=Object(_.a)(g.a.mark((function e(t){var a,n,c,r,i,o,s,l,d,j,u,b,p,m,O,x,h,f,_;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.newP,n=t.cantidad,c=t.granel,r=t.origen,i=t.precio_boolean,o=void 0!==i&&i,s=t.precio,e.prev=1,0,0,0,0,0,0,0,O=n>0?n:1,x=c.granel?c.valor:1,h=o?s:a.descuento_activo?a.descuento:a.precio_unidad,f=!0===h.unidad_maxima?h.cantidad_unidads:1,u=h.iva_precio*f,b=h.ieps_precio*f,j=u+b,l=h.precio_venta*f,d=h.precio_neto*f,m=a.id_producto.precios.monedero?a.id_producto.precios.monedero_electronico*f:0,p=d-a.precio_unidad.precio_neto,_={ivaCalculo:parseFloat((u*x*O).toFixed(2)),iepsCalculo:parseFloat((b*x*O).toFixed(2)),impuestoCalculo:parseFloat((j*x*O).toFixed(2)),subtotalCalculo:parseFloat((l*x*O).toFixed(2)),totalCalculo:parseFloat((d*x*O).toFixed(2)),monederoCalculo:parseFloat((m*x*O).toFixed(2)),descuentoCalculo:parseFloat((p*x*O).toFixed(2)),newP:a},"Ventas1"===r?(a.cantidad_venta=1,a.granel_producto=c,a.precio_a_vender=_.totalCalculo,a.precio_actual_producto=parseFloat(h.precio_neto.toFixed(2)),a.precio_actual_object=h):"Ventas2"===r&&(a.granel_producto=c,a.precio_a_vender=_.totalCalculo,a.precio_anterior=a.precio_actual_producto),e.abrupt("return",_);case 19:return e.prev=19,e.t0=e.catch(1),e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(t){return e.apply(this,arguments)}}(),ct=function(){var e=Object(_.a)(g.a.mark((function e(t){var a,n,c,r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t){e.next=3;break}return e.abrupt("return",!1);case 3:if(a=t.cantidad_venta,n=t.id_producto.precios.precios_producto.filter((function(e){return e.unidad_mayoreo>0&&e.precio_neto>0})),c={found:!1,pricing:0,number_pricing:0,object_prising:{}},r=n.length,!t.precio_seleccionado){e.next=9;break}return e.abrupt("return",c);case 9:if(!(a<t.id_producto.precios.precios_producto[1].unidad_mayoreo)){e.next=11;break}return e.abrupt("return",c={found:!0,pricing:t.descuento_activo?t.descuento.precio_neto:t.id_producto.precios.precios_producto[0].precio_neto,number_pricing:t.id_producto.precios.precios_producto[0].numero_precio,object_prising:t.descuento_activo?t.descuento:t.id_producto.precios.precios_producto[0]});case 11:i=0;case 12:if(!(i<n.length)){e.next=19;break}if(!(i+1===r&&a>=n[i].unidad_mayoreo)){e.next=15;break}return e.abrupt("return",c={found:!0,pricing:n[i].precio_neto,number_pricing:n[i].numero_precio,object_prising:n[i]});case 15:i+1<r&&a>=n[i].unidad_mayoreo&&a<n[i+1].unidad_mayoreo&&(c={found:!0,pricing:n[i].precio_neto,number_pricing:n[i].numero_precio,object_prising:n[i]});case 16:i++,e.next=12;break;case 19:return e.abrupt("return",c);case 22:return e.prev=22,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 26:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(t){return e.apply(this,arguments)}}();var rt,it,ot,st,lt,dt,jt,ut,bt,pt,mt,Ot=a(13),xt=a.n(Ot),ht=[{Value:"G01",Name:"Adquisici\xf3n de mercanc\xedas"},{Value:"G02",Name:"Devoluciones, descuentos o bonificaciones"},{Value:"G03",Name:"Gastos en general"},{Value:"I01",Name:"Construcciones"},{Value:"I02",Name:"Mobiliario y equipo de oficina por inversiones"},{Value:"I03",Name:"Equipo de transporte"},{Value:"I04",Name:"Equipo de c\xf3mputo y accesorios"},{Value:"I05",Name:"Dados, troqueles, moldes, matrices y herramental"},{Value:"I06",Name:"Comunicaciones telef\xf3nicas"},{Value:"I07",Name:"Comunicaciones satelitales"},{Value:"I08",Name:"Otra maquinaria y equipo"},{Value:"D01",Name:"Honorarios m\xe9dicos, dentales y gastos hospitalarios"},{Value:"D02",Name:"Gastos m\xe9dicos por incapacidad o discapacidad"},{Value:"D03",Name:"Gastos funerales."},{Value:"D04",Name:"Donativos"},{Value:"D05",Name:"Intereses reales efectivamente pagados por cr\xe9ditos hipotecarios (casa habitaci\xf3n)."},{Value:"D06",Name:"Aportaciones voluntarias al SAR."},{Value:"D07",Name:"Primas por seguros de gastos m\xe9dicos."},{Value:"D08",Name:"Gastos de transportaci\xf3n escolar obligatoria."},{Value:"D09",Name:"Dep\xf3sitos en cuentas para el ahorro, primas que tengan como base planes de pensiones."},{Value:"D10",Name:"Pagos por servicios educativos (colegiaturas)"},{Value:"P01",Name:"Por definir"}],ft=[{NameId:1,Name:"Factura",Value:"I"},{NameId:2,Name:"Nota de Cr\xe9dito",Value:"E"},{NameId:14,Name:"Complemento de pago",Value:"P"}],gt=[{Value:"MXN",Name:"Peso Mexicano"},{Value:"EUR",Name:"Euro"},{Value:"USD",Name:"Dolar Americano"}],_t=[{Name:"Efectivo",Value:"01"},{Name:"Cheque nominativo",Value:"02"},{Name:"Transferencia electr\xf3nica de fondos",Value:"03"},{Name:"Tarjeta de cr\xe9dito",Value:"04"},{Name:"Monedero electr\xf3nico",Value:"05"},{Name:"Dinero electr\xf3nico",Value:"06"},{Name:"Vales de despensa",Value:"08"},{Name:"Tarjeta de d\xe9bito",Value:"28"},{Name:"Aplicaci\xf3n de anticipos",Value:"30"},{Name:"Por definir",Value:"99"}],vt=[{Value:"PPD",Name:"Pago en parcialidades \xf3 diferido"},{Value:"PUE",Name:"Pago en una sola exhibici\xf3n"}],Ct=[{Natural:!1,Moral:!0,Name:"General de Ley Personas Morales",Value:"601"},{Natural:!1,Moral:!0,Name:"Personas Morales con Fines no Lucrativos",Value:"603"},{Natural:!0,Moral:!1,Name:"Sueldos y Salarios e Ingresos Asimilados a Salarios",Value:"605"},{Natural:!0,Moral:!1,Name:"Arrendamiento",Value:"606"},{Natural:!1,Moral:!0,Name:"R\xe9gimen de Enajenaci\xf3n o Adquisici\xf3n de Bienes",Value:"607"},{Natural:!0,Moral:!1,Name:"Dem\xe1s ingresos",Value:"608"},{Natural:!0,Moral:!0,Name:"Residentes en el Extranjero sin Establecimiento Permanente en M\xe9xico",Value:"610"},{Natural:!0,Moral:!1,Name:"Ingresos por Dividendos (socios y accionistas)",Value:"611"},{Natural:!0,Moral:!1,Name:"Personas F\xedsicas con Actividades Empresariales y Profesionales",Value:"612"},{Natural:!0,Moral:!1,Name:"Ingresos por intereses",Value:"614"},{Natural:!0,Moral:!1,Name:"R\xe9gimen de los ingresos por obtenci\xf3n de premios",Value:"615"},{Natural:!0,Moral:!1,Name:"Sin obligaciones fiscales",Value:"616"},{Natural:!1,Moral:!0,Name:"Sociedades Cooperativas de Producci\xf3n que optan por diferir sus ingresos",Value:"620"},{Natural:!0,Moral:!1,Name:"Incorporaci\xf3n Fiscal",Value:"621"},{Natural:!0,Moral:!0,Name:"Actividades Agr\xedcolas, Ganaderas, Silv\xedcolas y Pesqueras",Value:"622"},{Natural:!1,Moral:!0,Name:"Opcional para Grupos de Sociedades",Value:"623"},{Natural:!1,Moral:!0,Name:"Coordinados",Value:"624"},{Natural:!0,Moral:!1,Name:"R\xe9gimen de las Actividades Empresariales con ingresos a trav\xe9s de Plataformas Tecnol\xf3gicas",Value:"625"},{Natural:!1,Moral:!0,Name:"Hidrocarburos",Value:"628"},{Natural:!0,Moral:!1,Name:"De los Reg\xedmenes Fiscales Preferentes y de las Empresas Multinacionales",Value:"629"},{Natural:!0,Moral:!1,Name:"Enajenaci\xf3n de acciones en bolsa de valores",Value:"630"}],yt=a(923),St=a(860),wt=a(845),It=a(843),kt=a(847),Nt=a(848),Ft=a(849),zt=a(851),Pt=a(852),Dt=Object(z.d)(rt||(rt=Object(F.a)(["\n  mutation crearFactura($input: CrearFacturaInput) {\n    crearFactura(input: $input) {\n      message\n      success\n      pdf\n      xml\n    }\n  }\n"]))),Et=Object(z.d)(it||(it=Object(F.a)(["\n  mutation crearSerieCFDI($input: CrearSerieCfdiInput!) {\n    crearSerieCFDI(input: $input) {\n      message\n      success\n    }\n  }\n"]))),At=Object(z.d)(ot||(ot=Object(F.a)(["\n  mutation modificarDefaultSerie($id: ID!, $empresa: ID!, $sucursal: ID!) {\n    modificarDefaultSerie(id: $id, empresa: $empresa, sucursal: $sucursal) {\n      message\n    }\n  }\n"]))),Tt=Object(z.d)(st||(st=Object(F.a)(["\n  mutation eliminarSerie($id: ID!) {\n    eliminarSerie(id: $id) {\n      message\n    }\n  }\n"]))),Wt=Object(z.d)(lt||(lt=Object(F.a)(["\n  query obtenerSeriesCdfi($empresa: ID!, $sucursal: ID!) {\n    obtenerSeriesCdfi(empresa: $empresa, sucursal: $sucursal) {\n      message\n      success\n      seriesCfdi {\n        _id\n        serie\n        folio\n        default\n      }\n    }\n  }\n"]))),Rt=Object(z.d)(dt||(dt=Object(F.a)(["\n  mutation crearCSDS($input: CrearCSDSInput!) {\n    crearCSDS(input: $input) {\n      message\n      success\n    }\n  }\n"]))),$t=Object(z.d)(jt||(jt=Object(F.a)(["\n  mutation eliminarCSD($rfc: String, $empresa: ID!) {\n    eliminarCSD(rfc: $rfc, empresa: $empresa) {\n      message\n    }\n  }\n"])));Object(z.d)(ut||(ut=Object(F.a)(["\n  query obtenerCatalogosSAT($input: CrearFacturaInput!) {\n    obtenerCatalogosSAT(input: $input) {\n      message\n      currencies {\n        Decimals\n        PrecisionRate\n        Name\n        Value\n      }\n      paymentForms {\n        Name\n        Value\n      }\n      paymentMethods {\n        Name\n        Value\n      }\n      fiscalRegimens {\n        Natural\n        Moral\n        Name\n        Value\n      }\n      cfdiTypes {\n        NameId\n        Name\n        Value\n      }\n    }\n  }\n"]))),Object(z.d)(bt||(bt=Object(F.a)(["\n  query obtenerProductosOServicios($input: CrearFacturaInput!) {\n    obtenerProductosOServicios(input: $input) {\n      message\n      productosOServicios {\n        DangerousMaterial\n        Complement\n        Name\n        Value\n      }\n    }\n  }\n"]))),Object(z.d)(pt||(pt=Object(F.a)(["\n  query obtenerCodigoPostal($input: CrearFacturaInput!) {\n    obtenerCodigoPostal(input: $input) {\n      message\n      codigoPostal {\n        StateCode\n        MunicipalityCode\n        LocationCode\n        Name\n        Value\n      }\n    }\n  }\n"]))),Object(z.d)(mt||(mt=Object(F.a)(["\n  query obtenerCfdiUses($input: CrearFacturaInput!) {\n    obtenerCfdiUses(input: $input) {\n      message\n      cfdiUses {\n        message\n        Natural\n        Moral\n        Name\n        Value\n      }\n    }\n  }\n"])));function Mt(e){var t=e.datosEmpresa,a=e.firma_disabled,n=e.refetch,c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(s.useState)(!1),i=Object(v.a)(r,2),o=i[0],l=i[1],d=Object(s.useState)({certificate:"",private_key:"",private_key_password:"",rfc:c&&t.rfc?t.rfc:"",empresa:c&&c.empresa._id?c.empresa._id:"",sucursal:c&&c.sucursal._id?c.sucursal._id:""}),j=Object(v.a)(d,2),p=j[0],m=j[1],O=Object(s.useState)(!1),x=Object(v.a)(O,2),f=x[0],C=x[1],k=Object(s.useState)(!1),F=Object(v.a)(k,2),z=F[0],P=F[1],D=Object(s.useState)({message:"",status:"",open:!1}),E=Object(v.a)(D,2),A=E[0],T=E[1],W=function(){l(!1),m({certificate:"",private_key:"",private_key_password:"",rfc:c&&t.rfc?t.rfc:"",empresa:c&&c.empresa._id?c.empresa._id:"",sucursal:c&&c.sucursal._id?c.sucursal._id:""})},R=Object(N.a)(Rt),$=Object(v.a)(R,1)[0],M=function(e){var t=e.target,a=t.name,n=t.files;m(Object(u.a)(Object(u.a)({},p),{},Object(h.a)({},a,n[0])))},L=function(e){return new Promise((function(t){var a="",n=new FileReader;n.readAsDataURL(e),n.onload=function(){a=n.result,t(a)}}))},U=function(){var e=Object(_.a)(g.a.mark((function e(){var t,a,c,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p.certificate&&p.private_key&&p.private_key_password&&p.rfc){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t=Object(u.a)({},p),a=t.certificate,c=t.private_key,e.next=8,L(a).then((function(e){var n=e.split(",");t.certificate=n[1],t.nombre_cer=a.name})).catch((function(e){console.log(e)}));case 8:return e.next=10,L(c).then((function(e){var a=e.split(",");t.private_key=a[1],t.nombre_key=c.name})).catch((function(e){console.log(e)}));case 10:return P(!0),e.next=13,$({variables:{input:{certificate:t.certificate,private_key:t.private_key,private_key_password:t.private_key_password,rfc:t.rfc,empresa:t.empresa,sucursal:t.sucursal,nombre_cer:t.nombre_cer,nombre_key:t.nombre_key}}});case 13:r=e.sent,T({message:"\xa1Listo! ".concat(r.data.crearCSDS.message),status:"success",open:!0}),P(!1),W(),n(),e.next=26;break;case 20:e.prev=20,e.t0=e.catch(2),P(!1),T({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 26:case"end":return e.stop()}}),e,null,[[2,20]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{children:[Object(V.jsx)(B,{alert:A,setAlert:T}),Object(V.jsx)(b.a,{display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(w.a,{onClick:function(){return l(!0)},color:"inherit",startIcon:Object(V.jsx)(It.a,{}),disabled:a,children:"Agregar CSD"})}),Object(V.jsxs)(ze.a,{maxWidth:"xs",fullWidth:!0,open:o,onClose:function(){return W()},children:[Object(V.jsx)(wt.a,{children:"Registrar firma digital"}),Object(V.jsxs)(Pe.a,{children:[Object(V.jsx)(b.a,{mb:2,children:t.rfc?Object(V.jsx)(y.a,{children:"RFC: ".concat(t.rfc)}):Object(V.jsx)(y.a,{color:"error",children:"*No tienes registrado un RFC"})}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:["Archivo *.cer ",Object(V.jsx)("b",{children:"Certificado de la firma Digital"})]}),Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(S.a,{fullWidth:!0,value:p.certificate?p.certificate.name:"",size:"small",variant:"outlined",InputProps:{endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)("label",{htmlFor:"archivo-cer-sello-digital",children:Object(V.jsx)(w.a,{startIcon:Object(V.jsx)(kt.a,{}),color:"primary",component:"span",disableElevation:!0,children:"Upload"})})}),readOnly:!0}}),Object(V.jsx)("input",{accept:".cer",style:{display:"none"},id:"archivo-cer-sello-digital",multiple:!0,type:"file",name:"certificate",onChange:M})]})]}),Object(V.jsxs)(b.a,{width:"100%",mt:2,children:[Object(V.jsxs)(y.a,{children:["Archivo *.key ",Object(V.jsx)("b",{children:"Llave Privada de la Firma Digital"})]}),Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(S.a,{fullWidth:!0,value:p.private_key?p.private_key.name:"",size:"small",variant:"outlined",InputProps:{endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)("label",{htmlFor:"archivo-key-llave_privada",children:Object(V.jsx)(w.a,{startIcon:Object(V.jsx)(kt.a,{}),color:"primary",component:"span",disableElevation:!0,children:"Upload"})})}),readOnly:!0}}),Object(V.jsx)("input",{accept:".key",style:{display:"none"},id:"archivo-key-llave_privada",multiple:!0,type:"file",name:"private_key",onChange:M})]})]}),Object(V.jsxs)(b.a,{width:"100%",my:2,children:[Object(V.jsxs)(y.a,{children:["Contrase\xf1a de la llave ",Object(V.jsx)("b",{children:"Privada de la Firma Digital"})]}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsx)(S.a,{fullWidth:!0,type:f?"text":"password",size:"small",variant:"outlined",name:"private_key_password",onChange:function(e){m(Object(u.a)(Object(u.a)({},p),{},{private_key_password:e.target.value}))},InputProps:{endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(X.a,{onClick:function(){return C(!f)},onMouseDown:function(e){return e.preventDefault()},edge:"end",children:f?Object(V.jsx)(Nt.a,{}):Object(V.jsx)(Ft.a,{})})})}})})]})]}),Object(V.jsxs)(We.a,{style:{justifyContent:"center"},children:[Object(V.jsx)(w.a,{startIcon:Object(V.jsx)(zt.a,{}),size:"large",onClick:function(){return W()},children:"Cancelar"}),Object(V.jsx)(w.a,{startIcon:z?Object(V.jsx)(I.a,{size:20}):Object(V.jsx)(Pt.a,{}),color:"primary",size:"large",onClick:function(){return U()},disabled:z||!p.rfc,children:"Guardar"})]})]})]})}var Lt=a(854),Vt=a(853);function Ut(e){var t=e.datosEmpresa,a=e.refetch,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(s.useState)(!1),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)({rfc:t&&t.rfc?t.rfc:"",empresa:n&&n.empresa._id?n.empresa._id:""}),d=Object(v.a)(l,2),j=d[0],u=d[1],p=Object(s.useState)(!1),m=Object(v.a)(p,2),O=m[0],x=m[1],h=Object(s.useState)({message:"",status:"",open:!1}),f=Object(v.a)(h,2),C=f[0],y=f[1],S=function(){o(!1),u({rfc:n&&t.rfc?t.rfc:"",empresa:n&&n.empresa._id?n.empresa._id:""})},k=Object(N.a)($t),F=Object(v.a)(k,1)[0],z=function(){var e=Object(_.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j.rfc){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,x(!0),e.next=6,F({variables:{rfc:j.rfc,empresa:j.empresa}});case 6:t=e.sent,y({message:"\xa1Listo! ".concat(t.data.eliminarCSD.message),status:"success",open:!0}),x(!1),S(),a(),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(2),x(!1),y({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 19:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{children:[Object(V.jsx)(B,{alert:C,setAlert:y}),Object(V.jsx)(b.a,{display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(w.a,{onClick:function(){return o(!0)},color:"inherit",startIcon:Object(V.jsx)(Vt.a,{}),children:"Remover CSD"})}),Object(V.jsxs)(ze.a,{maxWidth:"xs",fullWidth:!0,open:i,onClose:function(){return S()},children:[Object(V.jsx)(wt.a,{children:"Eliminar Firma Digital"}),Object(V.jsx)(Pe.a,{children:Object(V.jsx)(Lt.a,{children:"Se eliminara el CSD registrado con el RFC ".concat(t.rfc)})}),Object(V.jsxs)(We.a,{style:{justifyContent:"center"},children:[Object(V.jsx)(w.a,{startIcon:Object(V.jsx)(zt.a,{}),size:"large",onClick:function(){return S()},children:"Cancelar"}),Object(V.jsx)(w.a,{startIcon:O?Object(V.jsx)(I.a,{size:20}):Object(V.jsx)(Vt.a,{}),color:"secondary",size:"large",onClick:function(){return z()},disabled:O||!j.rfc,children:"Eliminar"})]})]})]})}var Bt=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},subtitle:{marginLeft:"10px",width:"100%"},require:{"& span":{color:"red"}}}})),Jt=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Gt(){var e=Bt(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=l.a.useState(!1),i=Object(v.a)(r,2),o=i[0],d=i[1],j=l.a.useState(!1),p=Object(v.a)(j,2),m=p[0],O=p[1],x=l.a.useState(Object(s.useState)({error:!1,message:""})),f=Object(v.a)(x,2),I=f[0],k=f[1],F=Object(s.useState)({message:"",status:"",open:!1}),z=Object(v.a)(F,2),P=z[0],D=z[1],E=JSON.parse(localStorage.getItem("sesionCafi")),A=Object(s.useState)(!1===E.accesos.mi_empresa.informacion_fiscal.editar),T=Object(v.a)(A,1)[0],W=Object(s.useContext)(ke),R=W.empresa,$=W.setEmpresa,M=Object(N.a)(Xe),L=Object(v.a)(M,1)[0],U=Object(s.useState)(!1),J=Object(v.a)(U,2),q=J[0],H=J[1],Y=Object(s.useState)({nombre_fiscal:"",rfc:"",curp:"",info_adicio:"",regimen_fiscal:"",direccionFiscal:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},datosBancarios:{cuenta:"",sucursal:"",clave_banco:""}}),X=Object(v.a)(Y,2),K=X[0],Q=X[1],Z=Object(He.a)(Ye,{variables:{id:E.empresa._id}}),ee=Z.loading,te=Z.data,ae=Z.refetch,ne=Z.error;Object(s.useEffect)((function(){try{O(ne)}catch(e){}}),[ne]),Object(s.useEffect)((function(){try{if(void 0!==te){$(te.obtenerEmpresa);var e=E;e.empresa=te.obtenerEmpresa,localStorage.setItem("sesionCafi",JSON.stringify(e)),te.obtenerEmpresa.rfc?H(!1):H(!0)}}catch(t){}}),[te,$]),Object(s.useEffect)((function(){try{O(ne)}catch(e){}}),[ne]),Object(s.useEffect)((function(){try{c(ee)}catch(e){}}),[ee]),Object(s.useEffect)((function(){try{Q({nombre_fiscal:R.nombre_fiscal,rfc:R.rfc,curp:R.curp,info_adicio:R.info_adicio,regimen_fiscal:R.regimen_fiscal,sello_sat:R.sello_sat,nombre_cer:R.nombre_cer,nombre_key:R.nombre_key,limite_timbres:R.limite_timbres,timbres_usados:R.timbres_usados,direccionFiscal:{calle:R.direccionFiscal.calle,no_ext:R.direccionFiscal.no_ext,no_int:R.direccionFiscal.no_int,codigo_postal:R.direccionFiscal.codigo_postal,colonia:R.direccionFiscal.colonia,municipio:R.direccionFiscal.municipio,localidad:R.direccionFiscal.localidad,estado:R.direccionFiscal.estado,pais:R.direccionFiscal.pais},datosBancarios:{cuenta:R.datosBancarios.cuenta,sucursal:R.datosBancarios.sucursal,clave_banco:R.datosBancarios.clave_banco}})}catch(e){}}),[R]);var ce=function(){var e=Object(_.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c(!0),e.next=4,L({variables:{id:E.empresa._id,input:K}});case 4:c(!1),D({message:"Se han actualizado correctamente los datos.",status:"success",open:!0}),k(!1),ae(),e.next=16;break;case 10:e.prev=10,e.t0=e.catch(0),c(!1),D({message:"Hubo un error",status:"error",open:!0}),console.log(e.t0),e.t0.response?console.log(e.t0.response):e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 16:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),re=function(){d(!1)},ie=function(e){Q(Object(u.a)(Object(u.a)({},K),{},Object(h.a)({},e.target.name,e.target.value)))},oe=function(e){Q(Object(u.a)(Object(u.a)({},K),{},{direccionFiscal:Object(u.a)(Object(u.a)({},K.direccionFiscal),{},Object(h.a)({},e.target.name,e.target.value))}))},se=function(e){Q(Object(u.a)(Object(u.a)({},K),{},{datosBancarios:Object(u.a)(Object(u.a)({},K.datosBancarios),{},Object(h.a)({},e.target.name,e.target.value))}))};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){d(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Ce.e,{className:e.icon})}),"Informaci\xf3n fiscal"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:o,onClose:re,TransitionComponent:Jt,children:[Object(V.jsx)(B,{alert:P,setAlert:D}),Object(V.jsx)(Ve,{loading:n,setLoading:c}),Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Informaci\xf3n fiscal"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:re,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(Pe.a,{children:m?Object(V.jsx)(Je,{error:m}):Object(V.jsxs)(C.a,{children:[Object(V.jsxs)(Fe.a,{container:!0,spacing:3,style:{marginTop:8},children:[Object(V.jsxs)(Fe.a,{item:!0,md:6,xs:12,className:e.require,children:[Object(V.jsxs)(b.a,{my:1,children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{children:"* "}),"Nombre fiscal"]}),Object(V.jsx)(S.a,{fullWidth:!0,disabled:T,type:"text",size:"small",error:I.error&&!K.nombre_fiscal,name:"nombre_fiscal",variant:"outlined",value:K.nombre_fiscal?K.nombre_fiscal:"",helperText:I.error&&"El campo nombre es obligatorio"!==I.message?I.message:"",onChange:ie})]}),Object(V.jsxs)(b.a,{my:1,children:[Object(V.jsx)(y.a,{children:"RFC"}),Object(V.jsx)(S.a,{fullWidth:!0,disabled:T,size:"small",name:"rfc",variant:"outlined",value:K.rfc?K.rfc:"",onChange:ie})]}),Object(V.jsxs)(b.a,{my:1,children:[Object(V.jsx)(y.a,{children:"R\xe9gimen fiscal"}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"regimen_fiscal",children:Object(V.jsxs)(De.a,{value:K.regimen_fiscal?K.regimen_fiscal:"",name:"regimen_fiscal",onChange:ie,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),Ct.map((function(e,t){return Object(V.jsx)(Ee.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]})})]}),Object(V.jsxs)(b.a,{my:1,children:[Object(V.jsx)(y.a,{children:"CURP"}),Object(V.jsx)(S.a,{disabled:T,fullWidth:!0,size:"small",name:"curp",variant:"outlined",value:K.curp?K.curp:"",onChange:ie})]}),Object(V.jsxs)(b.a,{my:1,children:[Object(V.jsx)(y.a,{children:"Info. Adicional"}),Object(V.jsx)(S.a,{disabled:T,fullWidth:!0,size:"small",name:"info_adicio",variant:"outlined",value:K.info_adicio?K.info_adicio:"",onChange:ie,multiline:!0})]})]}),Object(V.jsxs)(Fe.a,{item:!0,md:6,xs:12,children:[Object(V.jsx)(y.a,{className:e.subtitle,children:Object(V.jsx)("b",{children:"Firma digital"})}),Object(V.jsx)(Te.a,{}),Object(V.jsx)(b.a,{m:1,children:!0===K.sello_sat?Object(V.jsx)(yt.a,{severity:"success",action:Object(V.jsx)(Ut,{firma_disabled:q,datosEmpresa:K,refetch:ae}),children:Object(V.jsx)(St.a,{children:"Firma Digital Activa"})}):Object(V.jsxs)(yt.a,{severity:"info",action:Object(V.jsx)(Mt,{firma_disabled:q,datosEmpresa:K,refetch:ae}),children:[Object(V.jsx)(St.a,{children:"Sin Firma Digital"}),"Sin esta firma no prodr\xe1s realizar facturas",q?Object(V.jsx)("li",{children:"Necesitas tener un RFC registrado"}):null]})}),Object(V.jsxs)(b.a,{my:1,children:[Object(V.jsx)(y.a,{children:"Archivo *.cer"}),Object(V.jsx)(S.a,{disabled:!0,fullWidth:!0,size:"small",variant:"outlined"})]}),Object(V.jsxs)(b.a,{my:1,children:[Object(V.jsx)(y.a,{children:"Archivo *.key"}),Object(V.jsx)(S.a,{disabled:!0,fullWidth:!0,size:"small",variant:"outlined"})]}),Object(V.jsxs)(b.a,{my:1,children:[Object(V.jsx)(y.a,{children:"Fecha de registro"}),Object(V.jsx)(S.a,{disabled:!0,fullWidth:!0,size:"small",variant:"outlined"})]})]})]}),Object(V.jsxs)(b.a,{mt:2,children:[Object(V.jsx)(y.a,{className:e.subtitle,children:Object(V.jsx)("b",{children:"Domicilio"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)(Fe.a,{container:!0,spacing:3,children:[Object(V.jsxs)(Fe.a,{item:!0,xs:12,sm:4,children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Calle"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"calle",variant:"outlined",disabled:T,value:K.direccionFiscal.calle?K.direccionFiscal.calle:"",onChange:oe})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Num. Ext"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_ext",variant:"outlined",disabled:T,value:K.direccionFiscal.no_ext?K.direccionFiscal.no_ext:"",onChange:oe})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Num. Int"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_int",variant:"outlined",disabled:T,value:K.direccionFiscal.no_int?K.direccionFiscal.no_int:"",onChange:oe})]})]}),Object(V.jsxs)(Fe.a,{item:!0,xs:12,sm:4,children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"C.P."}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_postal",variant:"outlined",disabled:T,value:K.direccionFiscal.codigo_postal?K.direccionFiscal.codigo_postal:"",onChange:oe})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Colonia"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"colonia",variant:"outlined",disabled:T,value:K.direccionFiscal.colonia?K.direccionFiscal.colonia:"",onChange:oe})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Municipio"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"municipio",variant:"outlined",disabled:T,value:K.direccionFiscal.municipio?K.direccionFiscal.municipio:"",onChange:oe})]})]}),Object(V.jsxs)(Fe.a,{item:!0,xs:12,sm:4,children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Localidad"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"localidad",variant:"outlined",disabled:T,value:K.direccionFiscal.localidad?K.direccionFiscal.localidad:"",onChange:oe})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Estado"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"estado",variant:"outlined",disabled:T,value:K.direccionFiscal.estado?K.direccionFiscal.estado:"",onChange:oe})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Pais"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"pais",variant:"outlined",disabled:T,value:K.direccionFiscal.pais?K.direccionFiscal.pais:"",onChange:oe})]})]})]}),Object(V.jsxs)(b.a,{mt:2,children:[Object(V.jsx)(y.a,{className:e.subtitle,children:Object(V.jsx)("b",{children:"Datos bancarios"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)(Fe.a,{container:!0,spacing:3,children:[Object(V.jsx)(Fe.a,{item:!0,xs:12,md:4,children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Cuenta"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"cuenta",variant:"outlined",disabled:T,value:K.datosBancarios.cuenta?K.datosBancarios.cuenta:"",onChange:se})]})}),Object(V.jsx)(Fe.a,{item:!0,xs:12,md:4,children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Sucursal"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"sucursal",variant:"outlined",disabled:T,value:K.datosBancarios.sucursal?K.datosBancarios.sucursal:"",onChange:se})]})}),Object(V.jsx)(Fe.a,{item:!0,xs:12,md:4,children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Clave de banco"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"clave_banco",variant:"outlined",disabled:T,value:K.datosBancarios.clave_banco?K.datosBancarios.clave_banco:"",onChange:se})]})})]})]})}),!1===E.accesos.mi_empresa.informacion_fiscal.editar?null:Object(V.jsxs)(We.a,{style:{justifyContent:"center"},children:[Object(V.jsx)(w.a,{onClick:re,color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){return ce()},color:"primary",variant:"contained",autoFocus:!0,children:"Guardar"})]})]})]})}var qt=a(929),Ht=a(174),Yt=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},subtitle:{marginLeft:"10px",width:"100%"},require:{"& span":{color:"red"}},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",border:"dashed 2px black",borderRadius:"100%"},avatar:{width:"90%",height:"90%","& > .icon":{fontSize:100}}}})),Xt=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Kt(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Yt(),a=l.a.useState(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(!1===e.accesos.mi_empresa.datos_empresa.editar),o=Object(v.a)(i,1)[0],d=Object(s.useState)(""),j=Object(v.a)(d,2),p=j[0],m=j[1],O=l.a.useState(!1),x=Object(v.a)(O,2),f=x[0],I=x[1],k=l.a.useState(!1),F=Object(v.a)(k,2),z=F[0],P=F[1],D=l.a.useState(Object(s.useState)({error:!1,message:""})),E=Object(v.a)(D,2),A=E[0],T=E[1],W=Object(s.useState)({message:"",status:"",open:!1}),R=Object(v.a)(W,2),$=R[0],M=R[1],L=Object(s.useContext)(ke),U=L.empresa,J=L.update,G=L.setEmpresa,q=L.setUpdate,H=Object(N.a)(Xe),Y=Object(v.a)(H,1)[0],X=Object(He.a)(Ye,{variables:{id:e.empresa._id}}),K=X.loading,Q=X.data,Z=X.refetch,ee=X.error,te=Object(s.useState)({nombre_empresa:"",nombre_dueno:"",telefono_dueno:"",celular:"",correo_empresa:"",nombre_fiscal:"",rfc:"",regimen_fiscal:"",curp:"",info_adicio:"",direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},direccionFiscal:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},datosBancarios:{cuenta:"",sucursal:"",clave_banco:""},imagen:null}),ae=Object(v.a)(te,2),ne=ae[0],ce=ae[1];Object(s.useEffect)((function(){try{Z()}catch(e){}}),[J,Z]),Object(s.useEffect)((function(){try{r(K)}catch(e){}}),[K]),Object(s.useEffect)((function(){try{void 0!==Q&&G(Q.obtenerEmpresa)}catch(e){}}),[Q,G]),Object(s.useEffect)((function(){try{P(ee)}catch(e){}}),[ee]),Object(s.useEffect)((function(){try{ce({nombre_empresa:U.nombre_empresa,nombre_dueno:U.nombre_dueno,telefono_dueno:U.telefono_dueno,celular:U.celular,correo_empresa:U.correo_empresa,direccion:U.direccion,imagen:U.imagen})}catch(e){}}),[U]);var re=function(){var t=Object(_.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r(!0),t.next=4,Y({variables:{id:e.empresa._id,input:ne}});case 4:q(!0),r(!1),M({message:"Se han actualizado correctamente los datos.",status:"success",open:!0}),T(!1),t.next=16;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0),t.t0.networkError?console.log(t.t0.networkError.result):t.t0.graphQLErrors&&console.log(t.t0.graphQLErrors),M({message:"Hubo un error",status:"error",open:!0}),r(!1);case 16:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),ie=function(){I(!1)},oe=function(e){ce(Object(u.a)(Object(u.a)({},ne),{},Object(h.a)({},e.target.name,e.target.value)))},se=function(e){ce(Object(u.a)(Object(u.a)({},ne),{},{direccion:Object(u.a)(Object(u.a)({},ne.direccion),{},Object(h.a)({},e.target.name,e.target.value))}))},le=Object(s.useCallback)((function(e){var t=new FileReader;t.readAsDataURL(e[0]),t.onload=function(){var e=t.result;m(e)},ce(Object(u.a)(Object(u.a)({},ne),{},{imagen:e[0]}))}),[ne,ce]),de=Object(Ht.a)({accept:"image/jpeg, image/png",noKeyboard:!0,onDrop:le}),je=de.getRootProps,ue=de.getInputProps;return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){I(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Ce.k,{className:t.icon})}),"Datos de empresa"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:f,onClose:ie,TransitionComponent:Xt,children:[Object(V.jsx)(B,{alert:$,setAlert:M}),Object(V.jsx)(Ve,{loading:c,setLoading:r}),Object(V.jsx)(Se.a,{className:t.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:t.title,children:"Datos"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:ie,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(Pe.a,{children:z?Object(V.jsx)(Je,{error:z}):Object(V.jsxs)(C.a,{style:{marginTop:8},children:[Object(V.jsxs)(Fe.a,{container:!0,spacing:3,className:t.require,children:[Object(V.jsx)(Fe.a,{item:!0,md:2,children:Object(V.jsxs)(b.a,Object(u.a)(Object(u.a)({className:t.avatarContainer},je()),{},{children:[Object(V.jsx)("input",Object(u.a)({},ue())),p?Object(V.jsx)(qt.a,{className:t.avatar,src:"".concat(p)}):Object(V.jsx)(qt.a,{className:t.avatar,src:"".concat(U.imagen)})]}))}),Object(V.jsxs)(Fe.a,{item:!0,md:4,children:[Object(V.jsxs)(b.a,{children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{children:"* "}),"Nombre de empresa"]}),Object(V.jsx)(S.a,{fullWidth:!0,disabled:o,type:"text",size:"small",error:A.error&&!ne.nombre_empresa,name:"nombre_empresa",variant:"outlined",value:ne.nombre_empresa?ne.nombre_empresa:"",helperText:A.error&&"El campo nombre es obligatorio"!==A.message?A.message:"",onChange:oe})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{children:"* "}),"Nombre due\xf1o"]}),Object(V.jsx)(S.a,{fullWidth:!0,disabled:o,type:"text",size:"small",error:A.error&&!ne.nombre_dueno,name:"nombre_dueno",variant:"outlined",value:ne.nombre_dueno?ne.nombre_dueno:"",helperText:A.error&&"El campo nombre es obligatorio"!==A.message?A.message:"",onChange:oe})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Tel\xe9fono"}),Object(V.jsx)(S.a,{fullWidth:!0,disabled:o,size:"small",name:"telefono_dueno",variant:"outlined",value:ne.telefono_dueno?ne.telefono_dueno:"",onChange:oe})]})]}),Object(V.jsxs)(Fe.a,{item:!0,md:4,children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Celular"}),Object(V.jsx)(S.a,{fullWidth:!0,disabled:o,size:"small",name:"celular",variant:"outlined",value:ne.celular?ne.celular:"",onChange:oe})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"E-mail"}),Object(V.jsx)(S.a,{fullWidth:!0,disabled:o,size:"small",name:"correo_empresa",variant:"outlined",value:ne.correo_empresa?ne.correo_empresa:"",onChange:oe})]})]})]}),Object(V.jsxs)(b.a,{mt:5,children:[Object(V.jsx)(y.a,{className:t.subtitle,children:Object(V.jsx)("b",{children:"Domicilio empresa"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)(Fe.a,{container:!0,spacing:3,className:t.require,children:[Object(V.jsxs)(Fe.a,{item:!0,md:4,children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Calle"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"calle",variant:"outlined",disabled:o,value:ne.direccion.calle?ne.direccion.calle:"",onChange:se})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Num. Ext"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_ext",variant:"outlined",disabled:o,value:ne.direccion.no_ext?ne.direccion.no_ext:"",onChange:se})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Num. Int"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_int",variant:"outlined",disabled:o,value:ne.direccion.no_int?ne.direccion.no_int:"",onChange:se})]})]}),Object(V.jsxs)(Fe.a,{item:!0,md:4,children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"C.P. "}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_postal",variant:"outlined",disabled:o,value:ne.direccion.codigo_postal?ne.direccion.codigo_postal:"",onChange:se})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Colonia"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"colonia",variant:"outlined",disabled:o,value:ne.direccion.colonia?ne.direccion.colonia:"",onChange:se})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Municipio"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"municipio",variant:"outlined",disabled:o,value:ne.direccion.municipio?ne.direccion.municipio:"",onChange:se})]})]}),Object(V.jsxs)(Fe.a,{item:!0,md:4,children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Localidad"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"localidad",variant:"outlined",disabled:o,value:ne.direccion.localidad?ne.direccion.localidad:"",onChange:se})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Estado"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"estado",variant:"outlined",disabled:o,value:ne.direccion.estado?ne.direccion.estado:"",onChange:se})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Pais"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"pais",variant:"outlined",disabled:o,value:ne.direccion.pais?ne.direccion.pais:"",onChange:se})]})]})]})]})}),!1===e.accesos.mi_empresa.datos_empresa.editar?null:Object(V.jsxs)(We.a,{style:{justifyContent:"center"},children:[Object(V.jsx)(w.a,{onClick:ie,color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){return re()},color:"primary",variant:"contained",autoFocus:!0,children:"Guardar"})]})]})]})}function Qt(){var e=JSON.parse(localStorage.getItem("sesionCafi"));return Object(V.jsx)("div",{children:Object(V.jsx)(C.a,{children:Object(V.jsxs)(Fe.a,{container:!0,spacing:5,justify:"center",children:[!1===e.accesos.mi_empresa.datos_empresa.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Kt,{idEmpresa:e.empresa._id})})}),!1===e.accesos.mi_empresa.informacion_fiscal.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Gt,{})})})]})})})}function Zt(){return Object(V.jsx)("div",{children:Object(V.jsx)(Ne,{children:Object(V.jsx)(Qt,{})})})}var ea=a(22),ta=a(926),aa=a(868),na=a(924),ca=a(794),ra=a(861),ia=a(863),oa=a(864),sa=a(865),la=a(866),da=a(862),ja=a(867),ua=[{unidad:"Pz",codigo_unidad:"H87"},{unidad:"Caja",codigo_unidad:"XBX"}],ba=[{unidad:"Kg",codigo_unidad:"KGM"},{unidad:"Lt",codigo_unidad:"LTR"},{unidad:"Costal",codigo_unidad:"KGM"}],pa=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"5px 5px"}}}}));function ma(){var e=pa(),t=Object(s.useContext)(xe),a=t.datos_generales,n=t.precios,c=t.unidadesVenta,r=t.setUnidadesVenta,i=t.unidadVentaXDefecto,o=t.setUnidadVentaXDefecto,l=t.update,d=Object(s.useState)({unidad:n.unidad_de_compra.unidad,codigo_unidad:n.unidad_de_compra.codigo_unidad,unidad_principal:!1,cantidad:1}),j=Object(v.a)(d,2),p=j[0],m=j[1],O=function(e,t){if("cantidad"===e.target.name){var a=parseFloat(e.target.value);m(Object(u.a)(Object(u.a)({},p),{},{cantidad:a,precio:a*i.precio}))}else if("unidad"===e.target.name){var n,c=t.props.unidad,r=c.codigo_unidad,o=c.unidad;m(Object(u.a)(Object(u.a)({},p),{},(n={},Object(h.a)(n,e.target.name,o),Object(h.a)(n,"codigo_unidad",r),Object(h.a)(n,"precio",p.cantidad*i.precio),n)))}else m(Object(u.a)(Object(u.a)({},p),{},Object(h.a)({},e.target.name,e.target.value)))};return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(b.a,{className:e.formInputFlex,justifyContent:"center",children:[Object(V.jsxs)(b.a,{width:100,children:[Object(V.jsx)(y.a,{children:"Unidad"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"unidad",children:n.granel?Object(V.jsx)(De.a,{name:"unidad",value:p.unidad,onChange:O,children:ba.map((function(e,t){return Object(V.jsx)(Ee.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))}):Object(V.jsx)(De.a,{name:"unidad",value:p.unidad,onChange:O,children:ua.map((function(e,t){return Object(V.jsx)(Ee.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))})})})]}),Object(V.jsxs)(b.a,{width:180,children:[Object(V.jsxs)(y.a,{children:["Cantidad"," ",Object(V.jsx)("b",{children:"Caja"===p.unidad?"(pz por caja)":"Costal"===p.unidad?"(kg por costal)":""})]}),Object(V.jsx)(S.a,{disabled:"H87"===p.codigo_unidad,type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"cantidad",variant:"outlined",onChange:O,value:p.cantidad?p.cantidad:"",fullWidth:!0})]}),Object(V.jsxs)(b.a,{width:130,children:[Object(V.jsxs)(y.a,{children:["Precio por ",Object(V.jsx)("b",{children:p.unidad})]}),Object(V.jsx)(S.a,{type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"precio",variant:"outlined",onChange:function(e){return function(e){if(console.log("obtenreprecio"),p.descuento_activo&&!0===p.descuento_activo){console.log("entra");var t=Math.round(e-e*parseFloat("0.".concat(p.descuento.porciento<10?"0".concat(p.descuento.porciento):p.descuento.porciento)));m(Object(u.a)(Object(u.a)({},p),{},{precio:parseFloat(e),descuento:Object(u.a)(Object(u.a)({},p.descuento),{},{precio_neto:t})}))}else m(Object(u.a)(Object(u.a)({},p),{},{precio:parseFloat(e)}))}(e.target.value)},value:p.precio?p.precio:"",fullWidth:!0})]}),!0===p.descuento_activo?Object(V.jsxs)(b.a,{width:130,children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"$ "}),"Descuento"]}),Object(V.jsx)(S.a,{inputProps:{readOnly:!0},size:"small",variant:"outlined",value:p.descuento.precio_neto,fullWidth:!0})]}):null,Object(V.jsx)(b.a,{width:240,children:Object(V.jsxs)(G.a,{variant:"outlined",size:"small",name:"codigo_barras",fullWidth:!0,children:[Object(V.jsx)(y.a,{children:"C\xf3digo de barras"}),Object(V.jsx)(H.a,{fullWidth:!0,disabled:l,id:"input-codigo-barras",name:"codigo_barras",value:p.codigo_barras?p.codigo_barras:"",onChange:O,endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(w.a,{onClick:function(){return function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();m(Object(u.a)(Object(u.a)({},p),{},{codigo_barras:t}))}()},edge:"end",color:"primary",disabled:l,children:"Generar"})})})]})}),Object(V.jsx)(b.a,{display:"flex",alignItems:"flex-end",children:Object(V.jsx)(w.a,{color:"primary",onClick:function(){return function(){if(p.unidad&&p.precio&&p.cantidad){p.descuento_activo=null;var e=p.precio,t=p.cantidad,a=n.iva,i=n.ieps,o=parseFloat("0.".concat(a<10?"0".concat(a):a))+parseFloat("0.".concat(i<10?"0".concat(i):i)),s=parseFloat((e/t).toFixed(2)),l=parseFloat((s/(o+1)).toFixed(2)),d=n.unidad_de_compra.precio_unitario_sin_impuesto,j=parseFloat(l*parseFloat("0.".concat(a<10?"0".concat(a):a)).toFixed(2)),b=parseFloat(l*parseFloat("0.".concat(i<10?"0".concat(i):i)).toFixed(2)),O=parseFloat(((l-d)/d*100).toFixed(2)),x=Object(u.a)(Object(u.a)({},p),{},{precio_unidad:{numero_precio:1,precio_venta:l,precio_neto:s,unidad_mayoreo:0,iva_precio:j,ieps_precio:b,utilidad:O,unidad_maxima:!1}});"XBX"!==p.codigo_unidad&&"KGM"!==p.codigo_unidad||(x.precio_unidad.precio_general=e,x.precio_unidad.cantidad_unidad=t,x.precio_unidad.unidad_maxima=!0),r([].concat(Object(ea.a)(c),[x])),m({unidad:"Pz",codigo_unidad:"H87",unidad_principal:!1})}}()},startIcon:Object(V.jsx)(It.a,{fontSize:"large"}),variant:"outlined",size:"large",children:"Guardar"})})]}),Object(V.jsx)(b.a,{children:Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"C\xf3digo de barras"}),Object(V.jsx)(sa.a,{children:"Unidad"}),Object(V.jsx)(sa.a,{children:"Precio"}),Object(V.jsx)(sa.a,{children:"Cantidad"}),Object(V.jsx)(sa.a,{children:"Aplicar Descuento"}),Object(V.jsx)(sa.a,{children:"Unidad Principal"}),Object(V.jsx)(sa.a,{children:"Acciones"})]})}),Object(V.jsxs)(la.a,{children:[Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:a.codigo_barras}),Object(V.jsx)(sa.a,{children:i.unidad}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[null!==i.descuento_activo?Object(V.jsx)(ja.a,{color:!0===i.descuento_activo?"primary":"action"}):null,Object(V.jsx)(b.a,{mr:1}),Object(V.jsx)(y.a,{children:Object(V.jsxs)("b",{children:["$",Ze(!0===i.descuento_activo?i.descuento.precio_neto:i.precio)]})})]})}),Object(V.jsx)(sa.a,{children:i.cantidad}),Object(V.jsx)(sa.a,{children:void 0!==i.descuento_activo&&null!==i.descuento_activo?Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(na.a,{checked:!0===i.descuento_activo&&i.descuento_activo,onChange:function(e){return t=e.target.checked,void o(Object(u.a)(Object(u.a)({},i),{},{descuento_activo:t}));var t},inputProps:{"aria-label":"check descuento"},color:"primary",disabled:null===i.descuento_activo}),Object(V.jsxs)(y.a,{color:"primary",children:["%",parseFloat(null!==i.descuento_activo?i.descuento.porciento:0)]})]}):null}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(na.a,{checked:i.unidad_principal,onChange:function(e){return function(e){if(o(Object(u.a)(Object(u.a)({},i),{},{unidad_principal:e})),e){for(var t=[],a=0;a<c.length;a++){var n=c[a],s={_id:n._id,codigo_barras:n.codigo_barras,unidad:n.unidad,codigo_unidad:n.codigo_unidad,precio:parseFloat(n.precio),cantidad:parseFloat(n.cantidad),unidad_principal:!1,default:n.default,descuento:n.descuento,descuento_activo:n.descuento_activo,precio_unidad:n.precio_unidad};t.push(s)}r([].concat(t))}}(e.target.checked)},inputProps:{"aria-label":"primary checkbox"},disabled:0===c.length})}),Object(V.jsx)(sa.a,{})]}),c.map((function(e,t){return!0!==e.default?Object(V.jsx)(Oa,{unidades:e,index:t},t):null}))]})]})})})]})}var Oa=function(e){var t=e.unidades,a=e.index,n=Object(s.useContext)(xe),c=n.unidadesVenta,r=n.setUnidadesVenta,i=n.unidadVentaXDefecto,o=n.setUnidadVentaXDefecto;return Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:t.codigo_barras}),Object(V.jsx)(sa.a,{children:t.unidad}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[null!==t.descuento_activo?Object(V.jsx)(ja.a,{color:t.descuento_activo?"primary":"action"}):null,Object(V.jsx)(b.a,{mr:1}),Object(V.jsx)(y.a,{children:Object(V.jsxs)("b",{children:["$",Ze(!0===t.descuento_activo?t.descuento.precio_neto:t.precio)]})})]})}),Object(V.jsx)(sa.a,{children:t.cantidad}),Object(V.jsx)(sa.a,{children:null!==t.descuento_activo?Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(na.a,{checked:!!t.descuento_activo&&t.descuento_activo,onChange:function(e){return function(e){for(var t=[],n=0;n<c.length;n++){var i=c[n],o={_id:i._id,codigo_barras:i.codigo_barras,unidad:i.unidad,codigo_unidad:i.codigo_unidad,precio:parseFloat(i.precio),cantidad:parseFloat(i.cantidad),unidad_principal:i.unidad_principal,default:i.default,descuento:i.descuento,descuento_activo:n===a?e:i.descuento_activo,precio_unidad:i.precio_unidad};t.push(o)}r([].concat(t))}(e.target.checked)},inputProps:{"aria-label":"check descuento"},color:"primary",disabled:null===t.descuento_activo}),Object(V.jsxs)(y.a,{color:"primary",children:["%",parseFloat(t.descuento&&null!==t.descuento?t.descuento.porciento:0)]})]}):null}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(na.a,{checked:t.unidad_principal,onChange:function(e){return function(){for(var e=[],t=0;t<c.length;t++){var n=c[t],s={_id:n._id,codigo_barras:n.codigo_barras,unidad:n.unidad,codigo_unidad:n.codigo_unidad,precio:parseFloat(n.precio),cantidad:parseFloat(n.cantidad),unidad_principal:t===a,default:n.default,descuento:n.descuento,descuento_activo:n.descuento_activo,precio_unidad:n.precio_unidad};e.push(s)}r([].concat(e)),o(Object(u.a)(Object(u.a)({},i),{},{unidad_principal:!1}))}(e.target.checked)},inputProps:{"aria-label":"primary checkbox"}})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(xa,{unidades:t,index:a})})]})},xa=function(e){var t=e.unidades,a=e.index,n=Object(s.useState)(!1),c=Object(v.a)(n,2),r=c[0],i=c[1],o=Object(s.useContext)(xe),l=o.unidadesVenta,d=o.setUnidadesVenta,j=o.unidadVentaXDefecto,b=o.setUnidadVentaXDefecto,p=function(){i(!r)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(X.a,{color:"primary",onClick:function(){return p()},children:Object(V.jsx)(Vt.a,{color:"primary"})}),Object(V.jsxs)(ze.a,{open:r,onClose:p,children:[Object(V.jsx)(wt.a,{children:"se eliminar\xe1 esta unidad de venta"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:function(){return p()},color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){return l.splice(a,1),(0===l.length||t.unidad_principal)&&b(Object(u.a)(Object(u.a)({},j),{},{unidad_principal:!0})),d(Object(ea.a)(l)),void p()},color:"secondary",autoFocus:!0,children:"Eliminar"})]})]})]})},ha=a(71),fa=Object(k.a)((function(e){return{precioTitle:{width:e.spacing(20)},marginInput:{marginTop:19},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}}}}));function ga(){var e=Object(s.useContext)(xe).preciosP,t=Object(ea.a)(e);return Object(V.jsx)(s.Fragment,{children:e.map((function(e,a){return Object(V.jsx)(_a,{data:e,index:a,newPreciosP:t},a)}))})}var _a=function(e){var t=e.data,a=e.index,n=e.newPreciosP,c=fa(),r=Object(s.useContext)(xe),i=r.preciosP,o=r.precios,l=r.unidadVentaXDefecto,d=r.setUnidadVentaXDefecto,j=r.setPreciosP,p=Object(u.a)({},i[a]),m=function(){var e=o.iva,t=o.ieps,c=l.unidad,r=l.cantidad,i=l.descuento,s=l.descuento_activo,b=o.unidad_de_compra.precio_unitario_sin_impuesto,m=p.utilidad?p.utilidad:0,O=parseFloat((b*(m/100)+b).toFixed(2)),x=O*parseFloat("0.".concat(e<10?"0".concat(e):e)),h=O*parseFloat("0.".concat(t<10?"0".concat(t):t)),f=parseFloat((O+(x+h)).toFixed(2));p.precio_venta=O,p.precio_neto=f,p.iva_precio=e,p.ieps_precio=t;var g=Object(u.a)(Object(u.a)({},l),{},{precio_unidad:{numero_precio:p.numero_precio,precio_neto:f,precio_venta:O,unidad_mayoreo:p.unidad_mayoreo,iva_precio:x,ieps_precio:h,utilidad:p.utilidad,unidad_maxima:!1}});if(1===p.numero_precio&&(g="Caja"===c||"Costal"===c?Object(u.a)(Object(u.a)({},g),{},{precio:parseFloat((r*f).toFixed(2))}):Object(u.a)(Object(u.a)({},g),{},{precio:f}),!0===s)){var _=O*i.porciento/100,v=_+(_*parseFloat("0.".concat(e<10?"0".concat(e):e))+_*parseFloat("0.".concat(t<10?"0".concat(t):t)));g=Object(u.a)(Object(u.a)({},g),{},{precio:parseFloat(f.toFixed(2)),descuento:Object(u.a)(Object(u.a)({},l.descuento),{},{precio_neto:v})})}d(g),n.splice(a,1,p),j(n)};Object(s.useEffect)((function(){(1===p.numero_precio||p.numero_precio>1&&p.precio_neto)&&m()}),[o.unidad_de_compra.precio_unitario_con_impuesto]);var O=function(e,t){switch(e){case"utilidad":t||(p.utilidad=0,p.precio_neto=o.unidad_de_compra.precio_unitario_con_impuesto,n.splice(a,1,p),j(n));break;case"precio_neto":t||(p.precio_neto=p.numero_precio>1?0:o.unidad_de_compra.precio_unitario_con_impuesto,p.utilidad=0,n.splice(a,1,p),j(n));break;case"unidad_mayoreo":t||(p.unidad_mayoreo=0,n.splice(a,1,p),j(n))}};return Object(V.jsxs)(b.a,{className:c.input,children:[Object(V.jsxs)(b.a,{display:"flex",my:1,mr:1,children:[Object(V.jsx)(b.a,{alignItems:"flex-end",display:t.numero_precio>1?"none":"flex",children:Object(V.jsx)(y.a,{className:c.precioTitle,children:Object(V.jsx)("b",{children:"Utilidad"})})}),Object(V.jsxs)(b.a,{minWidth:100,children:[Object(V.jsxs)(y.a,{children:["Precio ",t.numero_precio]}),Object(V.jsx)(b.a,{mb:2}),Object(V.jsx)(S.a,{disabled:!parseFloat(o.unidad_de_compra.precio_unitario_sin_impuesto),fullWidth:!0,type:"number",InputProps:{inputProps:{min:0},endAdornment:Object(V.jsx)(Y.a,{position:"start",children:"%"})},size:"small",value:p.utilidad,name:"utilidad",variant:"outlined",onChange:function(e){return function(e){if(!e)return p.utilidad="",n.splice(a,1,p),void j(n);var t=o.unidad_de_compra.precio_unitario_sin_impuesto,c=l.unidad,r=l.cantidad,i=l.descuento,s=l.descuento_activo,b=o.iva,m=o.ieps,O=t*(e/100)+t,x=O*parseFloat("0.".concat(b<10?"0".concat(b):b)),h=O*parseFloat("0.".concat(m<10?"0".concat(m):m)),f=O+(x+h);p.utilidad=parseFloat(e),p.precio_venta=parseFloat(O.toFixed(2)),p.precio_neto=parseFloat(f.toFixed(2));var g=Object(u.a)(Object(u.a)({},l),{},{precio_unidad:{numero_precio:p.numero_precio,precio_neto:f,precio_venta:O,unidad_mayoreo:p.unidad_mayoreo,iva_precio:x,ieps_precio:h,utilidad:p.utilidad,unidad_maxima:!1}});if(1===p.numero_precio&&(g="Caja"===c||"Costal"===c?Object(u.a)(Object(u.a)({},g),{},{precio:parseFloat((r*f).toFixed(2))}):Object(u.a)(Object(u.a)({},g),{},{precio:f}),!0===s)){var _=O*i.porciento/100,v=_+(_*parseFloat("0.".concat(b<10?"0".concat(b):b))+_*parseFloat("0.".concat(m<10?"0".concat(m):m)));g=Object(u.a)(Object(u.a)({},g),{},{precio:parseFloat(f.toFixed(2)),descuento:Object(u.a)(Object(u.a)({},l.descuento),{},{precio_neto:v})})}d(g),n.splice(a,1,p),j(n)}(e.target.value)},onBlur:function(){return O("utilidad",p.utilidad)},error:""===p.utilidad})]})]}),Object(V.jsxs)(b.a,{display:"flex",my:2,mr:1,children:[Object(V.jsx)(b.a,{alignItems:"flex-end",display:t.numero_precio>1?"none":"flex",children:Object(V.jsxs)(b.a,{alignItems:"flex-end",flexDirection:"column",display:t.numero_precio>1?"none":"flex",children:[Object(V.jsx)(y.a,{className:c.precioTitle,children:Object(V.jsx)("b",{children:"Precio de venta"})}),Object(V.jsx)(y.a,{className:c.precioTitle,variant:"caption",color:"textSecondary",children:"(precio sin impuestos)"})]})}),Object(V.jsx)(b.a,{pl:1,children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:parseFloat(p.precio_venta).toFixed(2)})})})]}),Object(V.jsxs)(b.a,{display:"flex",my:1,mr:1,children:[Object(V.jsxs)(b.a,{alignItems:"flex-end",flexDirection:"column",display:t.numero_precio>1?"none":"flex",children:[Object(V.jsx)(y.a,{className:c.precioTitle,children:Object(V.jsx)("b",{children:"Precio venta neto"})}),Object(V.jsx)(y.a,{className:c.precioTitle,variant:"caption",color:"textSecondary",children:"(precio con impuestos)"})]}),Object(V.jsx)(b.a,{className:t.numero_precio>1?c.marginInput:"",children:Object(V.jsx)(S.a,{disabled:!parseFloat(o.unidad_de_compra.precio_unitario_sin_impuesto),fullWidth:!0,type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"precio_neto",variant:"outlined",value:p.precio_neto,onChange:function(e){return function(e){if(!e)return p.precio_neto="",n.splice(a,1,p),void j(n);var t=parseFloat(e),c=l.unidad,r=l.cantidad,i=l.descuento,s=l.descuento_activo,b=o.iva,m=o.ieps,O=o.unidad_de_compra.precio_unitario_sin_impuesto,x=parseFloat("0.".concat(b<10?"0".concat(b):b))+parseFloat("0.".concat(m<10?"0".concat(m):m)),h=parseFloat((t/(x+1)).toFixed(2)),f=h*parseFloat("0.".concat(b<10?"0".concat(b):b)),g=h*parseFloat("0.".concat(m<10?"0".concat(m):m)),_=(t-(f+g)-O)/O*100;p.precio_neto=t,p.precio_venta=h,p.utilidad=parseFloat(_.toFixed(2));var v=Object(u.a)(Object(u.a)({},l),{},{precio_unidad:{numero_precio:p.numero_precio,precio_neto:t,precio_venta:h,unidad_mayoreo:p.unidad_mayoreo,iva_precio:f,ieps_precio:g,utilidad:p.utilidad,unidad_maxima:!1}});if(1===p.numero_precio&&(v="Caja"===c||"Costal"===c?Object(u.a)(Object(u.a)({},v),{},{precio:parseFloat((r*t).toFixed(2))}):Object(u.a)(Object(u.a)({},v),{},{precio:t}),!0===s)){var C=h*i.porciento/100,y=C+(C*parseFloat("0.".concat(b<10?"0".concat(b):b))+C*parseFloat("0.".concat(m<10?"0".concat(m):m)));v=Object(u.a)(Object(u.a)({},v),{},{precio:parseFloat(t.toFixed(2)),descuento:Object(u.a)(Object(u.a)({},l.descuento),{},{precio_neto:y})})}d(v),n.splice(a,1,p),j(n)}(e.target.value)},onBlur:function(){return O("precio_neto",p.precio_neto)},error:""===p.precio_neto})})]}),Object(V.jsxs)(b.a,{display:"flex",my:2,mr:1,children:[Object(V.jsx)(b.a,{alignItems:"flex-end",display:t.numero_precio>1?"none":"flex",children:Object(V.jsx)(y.a,{className:c.precioTitle,children:Object(V.jsx)("b",{children:"Unidad por mayoreo"})})}),t.numero_precio>1?Object(V.jsx)(b.a,{children:Object(V.jsx)(S.a,{disabled:!parseFloat(o.unidad_de_compra.precio_unitario_sin_impuesto),fullWidth:!0,type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"unidad_mayoreo",variant:"outlined",value:p.unidad_mayoreo,onChange:function(e){return function(e){if(!e)return p.unidad_mayoreo="",n.splice(a,1,p),void j(n);p.unidad_mayoreo=parseInt(e),n.splice(a,1,p),j(n)}(e.target.value)},onBlur:function(){return O("unidad_mayoreo",p.unidad_mayoreo)},error:""===p.unidad_mayoreo})}):null]})]})},va=function(e,t,a,n){var c=0,r=0,i=0,o=0,s=0,l=0;return"iva_activo"===t?a?(c=(r=parseFloat(n.precio_de_compra.precio_sin_impuesto))+(i=.16*parseFloat(r))+(o=parseFloat(r)*parseFloat(n.ieps<10?".0"+n.ieps:"."+n.ieps)),s=r/n.unidad_de_compra.cantidad,l=c/n.unidad_de_compra.cantidad):(c=(r=parseFloat(n.precio_de_compra.precio_sin_impuesto))+(i=0)+(o=parseFloat(r)*parseFloat(n.ieps<10?".0"+n.ieps:"."+n.ieps)),s=r/n.unidad_de_compra.cantidad,l=c/n.unidad_de_compra.cantidad,n.ieps_activo||(c=0,l=r/n.unidad_de_compra.cantidad)):(l=(c=(r=parseFloat(n.precio_de_compra.precio_sin_impuesto))+(i=parseFloat(r)*parseFloat(a<10?".0"+a:"."+a))+(o=parseFloat(r)*parseFloat(n.ieps<10?".0"+n.ieps:"."+n.ieps)))/n.unidad_de_compra.cantidad,s=r/n.unidad_de_compra.cantidad),Object(u.a)(Object(u.a)({},n),{},{iva_activo:"iva_activo"===t?a:n.iva_activo,iva:"iva"===t?parseFloat(a):a?16:0,precio_de_compra:Object(u.a)(Object(u.a)({},n.precio_de_compra),{},{precio_sin_impuesto:parseFloat(r.toFixed(2)),iva:parseFloat(i.toFixed(2)),ieps:parseFloat(o.toFixed(2)),precio_con_impuesto:parseFloat(c.toFixed(2))}),unidad_de_compra:Object(u.a)(Object(u.a)({},n.unidad_de_compra),{},{precio_unitario_sin_impuesto:parseFloat(s.toFixed(2)),precio_unitario_con_impuesto:parseFloat(l.toFixed(2))})})},Ca=function(e,t,a,n){var c=0,r=0,i=0,o=0,s=0,l=0;return"ieps_activo"===t?a?(c=(r=parseFloat(n.precio_de_compra.precio_sin_impuesto))+(i=parseFloat(r)*parseFloat(n.iva<10?".0"+n.iva:"."+n.iva))+(o=parseFloat(r)*n.ieps),s=r/n.unidad_de_compra.cantidad,l=c/n.unidad_de_compra.cantidad):(o=0,c=(r=parseFloat(n.precio_de_compra.precio_sin_impuesto))+(i=parseFloat(r)*parseFloat(n.iva<10?".0"+n.iva:"."+n.iva))+o,s=r/n.unidad_de_compra.cantidad,l=c/n.unidad_de_compra.cantidad,n.iva_activo||(c=0,l=r/n.unidad_de_compra.cantidad)):(l=(c=(r=parseFloat(n.precio_de_compra.precio_sin_impuesto))+(i=parseFloat(r)*parseFloat(n.iva<10?".0"+n.iva:"."+n.iva))+(o=parseFloat(r)*parseFloat(a<10?".0"+a:"."+a)))/n.unidad_de_compra.cantidad,s=r/n.unidad_de_compra.cantidad),Object(u.a)(Object(u.a)({},n),{},{ieps_activo:"ieps_activo"===t?a:n.ieps_activo,ieps:"ieps"===t?parseFloat(a):a?n.ieps:0,precio_de_compra:Object(u.a)(Object(u.a)({},n.precio_de_compra),{},{precio_sin_impuesto:parseFloat(r.toFixed(2)),iva:parseFloat(i.toFixed(2)),ieps:parseFloat(o.toFixed(2)),precio_con_impuesto:parseFloat(c.toFixed(2))}),unidad_de_compra:Object(u.a)(Object(u.a)({},n.unidad_de_compra),{},{precio_unitario_sin_impuesto:parseFloat(s.toFixed(2)),precio_unitario_con_impuesto:parseFloat(l.toFixed(2))})})},ya=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& .obligatorio":{color:"red"}},formInput:{margin:"".concat(e.spacing(0),"px ").concat(e.spacing(1),"px")},precioTitle:{width:e.spacing(20),display:"flex",alignItems:"center"},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}}}}));function Sa(){var e=ya(),t=Object(s.useContext)(xe),a=t.precios,n=t.setPrecios,c=t.validacion,r=t.preciosP,i=t.update,o=t.unidadVentaXDefecto,l=t.setUnidadVentaXDefecto,d=function(){var e=Object(_.a)(g.a.mark((function e(t){var c,r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("iva"!==t.target.name||t.target.value){e.next=3;break}return n(Object(u.a)(Object(u.a)({},a),{},{iva:""})),e.abrupt("return");case 3:return c=t.target.name,r="iva_activo"===c?t.target.checked:t.target.value,e.next=7,va(0,c,r,a);case 7:i=e.sent,x(i.precio_de_compra.precio_con_impuesto),I(i.precio_de_compra.precio_sin_impuesto),n(i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(_.a)(g.a.mark((function e(t){var c,r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("ieps"!==t.target.name||t.target.value){e.next=3;break}return n(Object(u.a)(Object(u.a)({},a),{},{ieps:""})),e.abrupt("return");case 3:return c=t.target.name,r="ieps_activo"===c?t.target.checked:t.target.value,e.next=7,Ca(0,c,r,a);case 7:i=e.sent,x(i.precio_de_compra.precio_con_impuesto),I(i.precio_de_compra.precio_sin_impuesto),n(i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=Object(s.useState)(a.precio_de_compra.precio_con_impuesto),m=Object(v.a)(p,2),O=m[0],x=m[1],f=Object(s.useState)(a.precio_de_compra.precio_sin_impuesto),C=Object(v.a)(f,2),w=C[0],I=C[1],k=Object(ha.useDebounce)(O,800),N=Object(v.a)(k,1)[0],F=Object(ha.useDebounce)(w,800),z=Object(v.a)(F,1)[0],P=function(e,t){if("unidad"===e.target.name){var c=t.props.unidad,i=c.codigo_unidad,s=c.unidad;if("Caja"===s||"Costal"===s){var d=o.cantidad*o.precio;l(Object(u.a)(Object(u.a)({},o),{},{precio:parseFloat(d.toFixed(2)),codigo_unidad:i,unidad:s})),n(Object(u.a)(Object(u.a)({},a),{},{unidad_de_compra:Object(u.a)(Object(u.a)({},a.unidad_de_compra),{},{unidad:s,codigo_unidad:i}),inventario:Object(u.a)(Object(u.a)({},a.inventario),{},{unidad_de_inventario:s,codigo_unidad:i})}))}else{var j;l(Object(u.a)(Object(u.a)({},o),{},{unidad:e.target.value,cantidad:1,precio:r[0].precio_neto?r[0].precio_neto:a.unidad_de_compra.precio_unitario_con_impuesto})),n(Object(u.a)(Object(u.a)({},a),{},{unidad_de_compra:Object(u.a)(Object(u.a)({},a.unidad_de_compra),{},(j={},Object(h.a)(j,e.target.name,e.target.value),Object(h.a)(j,"cantidad",1),j)),inventario:Object(u.a)(Object(u.a)({},a.inventario),{},{unidad_de_inventario:e.target.value})}))}}else{var b,p;if(a.iva_activo||a.ieps_activo)n(Object(u.a)(Object(u.a)({},a),{},{unidad_de_compra:Object(u.a)(Object(u.a)({},a.unidad_de_compra),{},(b={},Object(h.a)(b,e.target.name,parseFloat(e.target.value)),Object(h.a)(b,"precio_unitario_sin_impuesto",parseFloat((a.precio_de_compra.precio_sin_impuesto/e.target.value).toFixed(2))),Object(h.a)(b,"precio_unitario_con_impuesto",parseFloat((a.precio_de_compra.precio_con_impuesto/e.target.value).toFixed(2))),b))}));else n(Object(u.a)(Object(u.a)({},a),{},{unidad_de_compra:Object(u.a)(Object(u.a)({},a.unidad_de_compra),{},(p={},Object(h.a)(p,e.target.name,parseFloat(e.target.value)),Object(h.a)(p,"precio_unitario_sin_impuesto",parseFloat((a.precio_de_compra.precio_sin_impuesto/e.target.value).toFixed(2))),Object(h.a)(p,"precio_unitario_con_impuesto",parseFloat((a.precio_de_compra.precio_sin_impuesto/e.target.value).toFixed(2))),p))}));l(Object(u.a)(Object(u.a)({},o),{},{cantidad:"Caja"!==a.unidad_de_compra.unidad||"Costal"!==a.unidad_de_compra.unidad?1:parseFloat(e.target.value)}))}},D=function(e,t){t||n(Object(u.a)(Object(u.a)({},a),{},Object(h.a)({},e,0)))};return Object(s.useEffect)((function(){!function(e){var t,c=0,r=0,i=0,o=0,s=0,l=0;c=parseFloat(e),t=parseFloat(a.iva<10?".0"+a.iva:"."+a.iva)+parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps),i=(r=parseFloat(e)/parseFloat(t+1))*parseFloat(a.iva<10?".0"+a.iva:"."+a.iva),o=r*parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps),l=c/a.unidad_de_compra.cantidad,s=r/a.unidad_de_compra.cantidad,isNaN(s)&&(s=0),isNaN(l)&&(l=0),isNaN(i)&&(i=0),isNaN(o)&&(o=0),I(parseFloat(r.toFixed(2))),n(Object(u.a)(Object(u.a)({},a),{},{precio_de_compra:Object(u.a)(Object(u.a)({},a.precio_de_compra),{},{precio_sin_impuesto:parseFloat(r.toFixed(2)),iva:parseFloat(i.toFixed(2)),ieps:parseFloat(o.toFixed(2)),precio_con_impuesto:parseFloat(c.toFixed(2))}),unidad_de_compra:Object(u.a)(Object(u.a)({},a.unidad_de_compra),{},{precio_unitario_sin_impuesto:parseFloat(s.toFixed(2)),precio_unitario_con_impuesto:parseFloat(l.toFixed(2))})}))}(N)}),[N]),Object(s.useEffect)((function(){!function(e){var t=0,c=0,r=0,i=0,o=0,s=0;t=(c=parseFloat(e))+(r=parseFloat(e)*parseFloat(a.iva<10?".0"+a.iva:"."+a.iva))+(i=parseFloat(e)*parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps)),o=c/a.unidad_de_compra.cantidad,s=t/a.unidad_de_compra.cantidad,a.iva_activo||a.ieps_activo||(t=c,s=c/a.unidad_de_compra.cantidad),isNaN(o)&&(o=0),isNaN(s)&&(s=0),isNaN(r)&&(r=0),isNaN(i)&&(i=0),x(parseFloat(t.toFixed(2))),n(Object(u.a)(Object(u.a)({},a),{},{precio_de_compra:Object(u.a)(Object(u.a)({},a.precio_de_compra),{},{precio_sin_impuesto:parseFloat(c.toFixed(2)),iva:parseFloat(r.toFixed(2)),ieps:parseFloat(i.toFixed(2)),precio_con_impuesto:parseFloat(t.toFixed(2))}),unidad_de_compra:Object(u.a)(Object(u.a)({},a.unidad_de_compra),{},{precio_unitario_sin_impuesto:parseFloat(o.toFixed(2)),precio_unitario_con_impuesto:parseFloat(s.toFixed(2))})}))}(z)}),[z]),Object(V.jsx)(b.a,{children:Object(V.jsxs)("div",{className:e.input,children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Impuestos"})})}),Object(V.jsx)(Te.a,{}),Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",justifyContent:"center",my:1,children:[Object(V.jsx)(aa.a,{control:Object(V.jsx)(na.a,{checked:a.iva_activo,onChange:d,name:"iva_activo"}),label:"IVA"}),Object(V.jsx)(b.a,{children:Object(V.jsx)(S.a,{disabled:!a.iva_activo,label:"porcentaje IVA",type:"number",InputProps:{inputProps:{min:0},endAdornment:Object(V.jsx)(Y.a,{position:"start",children:"%"})},size:"small",name:"iva",id:"form-producto-iva",variant:"outlined",value:a.iva,onChange:d,onBlur:function(){return D("iva",a.iva)},error:""===a.iva})}),Object(V.jsx)(b.a,{mx:5}),Object(V.jsx)(aa.a,{control:Object(V.jsx)(na.a,{checked:a.ieps_activo,onChange:j,name:"ieps_activo"}),label:"IEPS"}),Object(V.jsx)(b.a,{children:Object(V.jsx)(S.a,{disabled:!a.ieps_activo,label:"porcentaje IEPS",type:"number",InputProps:{inputProps:{min:0},endAdornment:Object(V.jsx)(Y.a,{position:"start",children:"%"})},size:"small",name:"ieps",id:"form-producto-ieps",variant:"outlined",value:a.ieps,onChange:j,onBlur:function(){return D("ieps",a.ieps)},error:""===a.ieps})}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",ml:1,children:Object(V.jsx)(yt.a,{severity:"info",children:"Selecciona los impuestos aplicables"})})]}),Object(V.jsx)(b.a,{mt:3,children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Precios y unidad de compra"})})}),Object(V.jsx)(Te.a,{}),Object(V.jsxs)(b.a,{className:e.formInputFlex,justifyContent:"center",children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Unidad de compra"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsxs)(G.a,{variant:"outlined",fullWidth:!0,size:"small",error:c.error&&!a.unidad_de_compra.unidad,children:[a.granel?Object(V.jsx)(De.a,{disabled:i,id:"form-producto-categoria",name:"unidad",value:a.unidad_de_compra.unidad,onChange:P,children:ba.map((function(e,t){return Object(V.jsx)(Ee.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))}):Object(V.jsx)(De.a,{disabled:i,id:"form-producto-categoria",name:"unidad",value:a.unidad_de_compra.unidad,onChange:P,children:ua.map((function(e,t){return Object(V.jsx)(Ee.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))}),Object(V.jsx)(ca.a,{children:c.message})]})})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{align:"center",children:"Unidad de conversion"}),Object(V.jsx)(y.a,{align:"center",variant:"h6",children:Object(V.jsx)("b",{children:"Caja"===a.unidad_de_compra.unidad?"Pz":"Costal"===a.unidad_de_compra.unidad?"Kg":a.unidad_de_compra.unidad})})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:"obligatorio",children:"* "}),"Factor por Unidad"]}),Object(V.jsx)(S.a,{disabled:"Caja"!==a.unidad_de_compra.unidad&&"Costal"!==a.unidad_de_compra.unidad,type:"number",InputProps:{inputProps:{min:1}},size:"small",error:c.error&&!a.unidad_de_compra.cantidad,name:"cantidad",id:"form-producto-cantidad",variant:"outlined",value:a.unidad_de_compra.cantidad,helperText:c.message,onChange:P})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:"obligatorio",children:"* "}),"Precio sin impuestos"]}),Object(V.jsx)(S.a,{type:"number",InputProps:{inputProps:{min:0}},size:"small",error:c.error&&!w,name:"precio_sin_impuesto",id:"form-producto-precio_sin_impuesto",variant:"outlined",value:w,helperText:c.message,onChange:function(e){return I(e.target.value)}})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:"obligatorio",children:"* "}),"Precio con impuestos"]}),Object(V.jsx)(S.a,{disabled:!a.iva_activo&&!a.ieps_activo,type:"number",InputProps:{inputProps:{min:0}},size:"small",error:c.error&&!O,name:"precio_con_impuesto",id:"form-producto-precio_con_impuesto",variant:"outlined",value:O,helperText:c.message,onChange:function(e){return x(e.target.value)}})]})]}),Object(V.jsxs)(b.a,{className:e.formInputFlex,justifyContent:"center",children:[Object(V.jsxs)(b.a,{width:"120px",children:[Object(V.jsx)(y.a,{align:"center",children:"IVA"}),Object(V.jsx)(y.a,{align:"center",variant:"h6",children:Object(V.jsxs)("b",{children:["$ ",parseFloat(a.precio_de_compra.iva).toFixed(2)]})})]}),Object(V.jsxs)(b.a,{width:"120px",children:[Object(V.jsx)(y.a,{align:"center",children:"IEPS"}),Object(V.jsx)(y.a,{align:"center",variant:"h6",children:Object(V.jsxs)("b",{children:["$ ",parseFloat(a.precio_de_compra.ieps).toFixed(2)]})})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{align:"center",children:"Precio unitario sin impuestos"}),Object(V.jsx)(y.a,{align:"center",variant:"h6",children:Object(V.jsxs)("b",{children:["$"," ",parseFloat(a.unidad_de_compra.precio_unitario_sin_impuesto).toFixed(2)]})})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{align:"center",children:"Precio unitario con impuestos"}),Object(V.jsx)(y.a,{align:"center",variant:"h6",children:Object(V.jsxs)("b",{children:["$"," ",parseFloat(a.unidad_de_compra.precio_unitario_con_impuesto).toFixed(2)]})})]})]}),Object(V.jsx)(b.a,{mt:1,children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Precios de venta"})})}),Object(V.jsx)(Te.a,{}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(ga,{})}),Object(V.jsx)(b.a,{mt:2,children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Unidades de venta"})})}),Object(V.jsx)(Te.a,{}),Object(V.jsx)(b.a,{children:Object(V.jsx)(ma,{})})]})})}var wa=a(875),Ia=a(876),ka=Object(s.createContext)(),Na=function(e){var t=e.children,a=Object(s.useState)({producto:{},costo:0,cantidad:1,cantidad_regalo:0,unidad_regalo:"",cantidad_total:0,descuento_porcentaje:0,descuento_precio:0,iva_total:0,ieps_total:0,subtotal:0,impuestos:0,total:0,mantener_precio:!0,subtotal_descuento:0,total_descuento:0}),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)({productos:[],proveedor:{},en_espera:!1,fecha_registro:xt()().locale("es-mx").format("YYYY-MM-DD"),almacen:{},compra_credito:!1,fecha_vencimiento_credito:xt()().locale("es-mx").format("YYYY-MM-DD"),credito_pagado:!1,saldo_credito_pendiente:0,forma_pago:"",descuento_aplicado:!1,descuento:{porcentaje:0,cantidad_descontada:0,precio_con_descuento:0},subtotal:0,impuestos:0,total:0}),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)([{numero_precio:1,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:2,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:3,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:4,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:5,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:6,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0}]),u=Object(v.a)(j,2),b=u[0],p=u[1],m=Object(s.useState)({precios:ne}),O=Object(v.a)(m,2),x=O[0],h=O[1],f=Object(s.useState)([]),g=Object(v.a)(f,2),_=g[0],C=g[1],y=Object(s.useState)({}),S=Object(v.a)(y,2),w=S[0],I=S[1],k=Object(s.useState)(!1),N=Object(v.a)(k,2),F=N[0],z=N[1],P=Object(s.useState)(0),D=Object(v.a)(P,2),E=D[0],A=D[1],T=Object(s.useState)(1),W=Object(v.a)(T,2),R=W[0],$=W[1],M=Object(s.useState)(!1),L=Object(v.a)(M,2),U=L[0],B=L[1],J=Object(s.useState)(!1),G=Object(v.a)(J,2),q=G[0],H=G[1],Y=Object(s.useState)({subtotal:0,total:0,descuento_aplicado:!1,porcentaje:0,cantidad_descontada:0,precio_con_descuento:0}),X=Object(v.a)(Y,2),K=X[0],Q=X[1];return Object(V.jsx)(ka.Provider,{value:{datosProducto:c,setDatosProducto:r,productosCompra:_,setProductosCompra:C,datosCompra:l,setDatosCompra:d,productoOriginal:x,setProductoOriginal:h,preciosVenta:b,setPreciosVenta:p,isEditing:w,setIsEditing:I,editFinish:F,setEditFinish:z,costo:E,setCosto:A,cantidad:R,setCantidad:$,issue:U,setIssue:B,loadingProductos:q,setLoadingProductos:H,descuentoCompra:K,setDescuentoCompra:Q},children:t})},Fa=a(77),za=a.n(Fa),Pa=a(789),Da=a(208),Ea=a(930),Aa=a(870),Ta=a(871),Wa=a(869),Ra=a(872),$a=a(873),Ma=a(143),La=function(e,t){if(e.medida.talla&&t.medida.talla)return e.medida.talla.localeCompare(t.medida.talla)},Va=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},container:{maxHeight:"65vh"},tableRow:{"&.Mui-selected, &.Mui-selected:hover":{backgroundColor:Object(Ma.alpha)(e.palette.primary.main,.1)}},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",height:30,width:30,borderRadius:"15%"},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}}}}));function Ua(e){var t=e.from,a=e.setOnUpdate,n=e.onUpdate,c=e.withoutPrice,r=e.onlyPrice,i=Va(),o=Object(s.useContext)(xe),l=o.presentaciones,d=(o.setPresentaciones,Object(ea.a)(l).sort((function(e,t){return La(e,t)})));return Object(V.jsx)("div",{className:i.root,children:Object(V.jsx)(Da.a,{className:i.paper,children:Object(V.jsx)(ra.a,{className:i.container,children:Object(V.jsxs)(da.a,{className:i.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",stickyHeader:!0,children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Existencia"}),Object(V.jsx)(sa.a,{children:"C\xf3digo de barras"}),Object(V.jsx)(sa.a,{width:200,children:"Nombre"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Medida"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Color"}),c?null:Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(sa.a,{children:"Precio"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Aplicar descuento"})]}),r?null:Object(V.jsxs)(s.Fragment,{children:[t&&"compra"===t?Object(V.jsx)(sa.a,{padding:"checkbox",children:"Existente"}):null,Object(V.jsx)(sa.a,{padding:"checkbox",children:"Cantidad"})]}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Editar"})]})}),Object(V.jsx)(la.a,{children:d.map((function(e,i){return Object(V.jsx)(Qa,{producto:e,index:i,from:t,setOnUpdate:a,onUpdate:n,withoutPrice:c,onlyPrice:r},i)}))})]})})})})}var Ba,Ja,Ga,qa,Ha,Ya,Xa,Ka,Qa=function(e){var t=e.producto,a=e.index,n=e.from,c=e.setOnUpdate,r=e.onUpdate,i=e.withoutPrice,o=e.onlyPrice,l=Object(s.useContext)(xe),d=l.presentaciones,j=l.setPresentaciones,p=l.preciosP,m=l.precios,O=(l.unidadVentaXDefecto,l.setUnidadVentaXDefecto,Object(s.useState)(!0)),x=Object(v.a)(O,2),h=x[0],f=x[1],g=Va(),_=Object(s.useRef)(null),C=Object(ea.a)(d).sort((function(e,t){return La(e,t)})),S=Object(u.a)({},C[a]),w=Object(u.a)({},C[a].descuento),I=Object(u.a)({},t),k=function(e){var t=e.target,n=t.name,c=t.value;if("cantidad"===n){if(!c)return S.cantidad="",S.existencia=!1,C.splice(a,1,S),void j(C);S.existencia="0"!==c,S.cantidad=parseFloat(c)}else if("cantidad_nueva"===n){if(!c)return S.cantidad_nueva="",S.existencia=I.existencia,C.splice(a,1,S),void j(C);S.cantidad_nueva=parseFloat(c),S.existencia=!0}else if("precio"===n){if(!c)return S.precio="",C.splice(a,1,S),void j(C);var r=parseFloat(c),i=m.iva,o=m.ieps,s=parseFloat("0.".concat(i<10?"0".concat(i):i))+parseFloat("0.".concat(o<10?"0".concat(o):o)),l=parseFloat((r/(s+1)).toFixed(2)),d=parseFloat((l*parseFloat("0.".concat(i<10?"0".concat(i):i))).toFixed(2)),u=parseFloat((l*parseFloat("0.".concat(o<10?"0".concat(o):o))).toFixed(2)),b=m.unidad_de_compra.precio_unitario_sin_impuesto,p=parseFloat(((l-b)/b*100).toFixed(2)),O=S.descuento_activo,x=S.descuento;if(O&&!0===O){var h=l*x.porciento/100,f=h+(h*parseFloat("0.".concat(i<10?"0".concat(i):i))+h*parseFloat("0.".concat(o<10?"0".concat(o):o)));w.precio_neto=parseFloat(f.toFixed(2)),S.precio=parseFloat(c),S.descuento=w}else S.precio=parseFloat(c);S.precio_unidad.precio_venta=l,S.precio_unidad.precio_neto=r,S.precio_unidad.utilidad=p,S.precio_unidad.iva_precio=d,S.precio_unidad.ieps_precio=u}else{if(!c)return S.codigo_barras="",C.splice(a,1,S),void j(C);S.codigo_barras=c}C.splice(a,1,S),j(C)},N=function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();S.codigo_barras=t,C.splice(a,1,S),j(C)},F=function(){h?(f(!h),c([].concat(Object(ea.a)(r),[a]))):(I.cantidad||(S.cantidad=0),I.cantidad_nueva||(S.cantidad_nueva=0),I.precio||(S.precio=p[0].precio_neto),C.splice(a,1,S),j(C),f(!0),r.splice(r.length-1,1),c(Object(ea.a)(r)))};return Object(V.jsxs)(oa.a,{hover:!0,selected:!h,className:g.tableRow,children:[Object(V.jsx)(sa.a,{align:"center",padding:"checkbox",children:Object(V.jsx)(na.a,{checked:I.existencia,color:"primary"})}),Object(V.jsx)(sa.a,{width:220,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(Pa.a,{inputRef:_,onChange:function(e){return k(e)},value:I.codigo_barras,type:"number",name:"codigo_barras",disabled:d.length>0&&!I.nuevo||h}),0===d.length&&I.nuevo||d.length>0&&I.nuevo?Object(V.jsx)(X.a,{color:"primary",size:"small",onClick:function(){return N()},children:Object(V.jsx)(Wa.a,{})}):null]})}),Object(V.jsx)(sa.a,{width:200,children:I.nombre_comercial}),Object(V.jsx)(sa.a,{padding:"checkbox",children:I.medida._id?Object(V.jsx)(Ea.a,{label:I.medida.talla,color:"primary"}):""}),Object(V.jsx)(sa.a,{padding:"checkbox",children:I.color._id?Object(V.jsx)(Aa.a,{title:I.color.nombre,placement:"top",arrow:!0,TransitionComponent:Ta.a,children:Object(V.jsx)("div",{className:g.colorContainer,style:{backgroundColor:I.color.hex}})}):null}),i?null:Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(sa.a,{width:110,className:g.input,children:Object(V.jsx)(Pa.a,{inputRef:_,onChange:function(e){return k(e)},disabled:h,value:I.precio,type:"number",name:"precio"})}),Object(V.jsx)(sa.a,{width:200,children:Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:void 0!==I.descuento_activo&&null!==I.descuento_activo?Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(na.a,{checked:!0===I.descuento_activo&&I.descuento_activo,onChange:function(e){return function(e){S.descuento_activo=e;var t=0,n=m.iva,c=m.ieps,r=S.descuento,i=S.precio,o=parseFloat("0.".concat(n<10?"0".concat(n):n))+parseFloat("0.".concat(c<10?"0".concat(c):c)),s=parseFloat((i/(o+1)).toFixed(2));if(e){var l=s*r.porciento/100;t=l+(l*parseFloat("0.".concat(n<10?"0".concat(n):n))+l*parseFloat("0.".concat(c<10?"0".concat(c):c)))}else t=i;w.precio_neto=parseFloat(t.toFixed(2)),S.descuento=w,C.splice(a,1,S),j(C)}(e.target.checked)},icon:Object(V.jsx)(Ra.a,{}),checkedIcon:Object(V.jsx)(ja.a,{}),inputProps:{"aria-label":"check descuento"},color:"primary",disabled:null===I.descuento_activo}),Object(V.jsxs)(y.a,{color:!0===I.descuento_activo?"primary":"textSecondary",children:["%",parseFloat(null!==I.descuento?I.descuento.porciento:0)," ","$",parseFloat(null!==I.descuento?I.descuento.precio_neto:0)]})]}):null})})]}),o?null:Object(V.jsx)(s.Fragment,{children:n&&"compra"===n?Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(sa.a,{padding:"checkbox",children:t.cantidad}),Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(Pa.a,{inputRef:_,onChange:function(e){return k(e)},disabled:h,value:I.cantidad_nueva,type:"tel",name:"cantidad_nueva"})})]}):Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(Pa.a,{inputRef:_,onChange:function(e){return k(e)},disabled:h,value:I.cantidad,type:"tel",name:"cantidad"})})}),Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(X.a,{size:"small",onClick:function(){return F()},children:h?Object(V.jsx)($a.a,{}):Object(V.jsx)(zt.a,{})})})]})},Za=["children","value","index"],en=["precios_producto"],tn=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function an(e){var t=e.children,a=e.value,n=e.index,c=Object(fe.a)(e,Za);return Object(V.jsx)("div",Object(u.a)(Object(u.a)({style:{height:"80vh"},role:"tabpanel",hidden:a!==n,id:"scrollable-force-tabpanel-".concat(n),"aria-labelledby":"scrollable-force-tab-".concat(n)},c),{},{children:a===n&&Object(V.jsx)(b.a,{p:3,children:t})}))}function nn(e){return{id:"scrollable-force-tab-".concat(e),"aria-controls":"scrollable-force-tabpanel-".concat(e)}}function cn(e){var t=e.agregarCompra,a=e.handleClose,n=e.cargando,c=Object(s.useState)(!1),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)([]),d=Object(v.a)(l,2),j=d[0],b=d[1],p=Object(s.useContext)(ka),m=p.datosProducto,O=p.productoOriginal,x=Object(s.useContext)(xe),h=x.precios,f=x.setPrecios,g=x.setUnidadesVenta,_=x.setPreciosP,C=x.setUnidadVentaXDefecto,y=function(){return o(!i)},S=function(){var e=O.precios,t=(e.precios_producto,Object(fe.a)(e,en)),a=O.unidades_de_venta.filter((function(e){return e.default}));f(t),g(O.unidades_de_venta),_(O.precios.precios_producto),C(a[0]),y()},k=Object(s.useState)(0),N=Object(v.a)(k,2),F=N[0],z=N[1];return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(w.a,{color:"primary",size:"medium",onClick:function(){return function(){y();var e=m.costo/h.unidad_de_compra.cantidad,t=h.precio_de_compra.precio_sin_impuesto/h.unidad_de_compra.cantidad;isNaN(t)&&(t=0),isNaN(e)&&(e=0),f(Object(u.a)(Object(u.a)({},h),{},{precio_de_compra:Object(u.a)(Object(u.a)({},h.precio_de_compra),{},{precio_con_impuesto:m.costo}),unidad_de_compra:Object(u.a)(Object(u.a)({},h.unidad_de_compra),{},{precio_unitario_con_impuesto:parseFloat(e.toFixed(6)),precio_unitario_sin_impuesto:parseFloat(t.toFixed(6))})}))}()},children:"Actualizar precios"}),Object(V.jsxs)(ze.a,{open:i,TransitionComponent:tn,keepMounted:!0,onClose:function(){return S()},"aria-labelledby":"alert-precios-compra-title","aria-describedby":"alert-precios-compra-description",fullWidth:!0,maxWidth:"lg",children:[m.producto.datos_generales&&"OTROS"!==m.producto.datos_generales.tipo_producto?Object(V.jsx)(wt.a,{style:{padding:0},children:Object(V.jsx)(Se.a,{position:"static",color:"default",children:Object(V.jsxs)(we.a,{value:F,onChange:function(e,t){z(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:[Object(V.jsx)(Ie.a,Object(u.a)({label:"Precios",icon:Object(V.jsx)(wa.a,{})},nn(0))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Precios Medidas",icon:Object(V.jsx)(Ia.a,{})},nn(1)))]})})}):null,Object(V.jsx)(Pe.a,{children:m.producto.datos_generales&&"OTROS"!==m.producto.datos_generales.tipo_producto?Object(V.jsxs)("div",{children:[Object(V.jsx)(an,{value:F,index:0,children:Object(V.jsx)(Sa,{})}),Object(V.jsx)(an,{value:F,index:1,children:Object(V.jsx)(Ua,{from:"compras",datos:m.producto,setOnUpdate:b,onUpdate:j,onlyPrice:!0})})]}):Object(V.jsx)(Sa,{})}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{color:"inherit",size:"large",startIcon:Object(V.jsx)(zt.a,{}),onClick:function(){return S()},children:"Cancelar"}),Object(V.jsx)(w.a,{size:"large",onClick:function(){t("actualizar_precios"),a(),y()},startIcon:n?Object(V.jsx)(I.a,{color:"inherit",size:20}):Object(V.jsx)(za.a,{}),color:"primary",variant:"contained",disabled:!h.precio_de_compra.precio_con_impuesto,children:"Aceptar y agregar compra"})]})]})]})}var rn,on,sn,ln,dn,jn,un,bn,pn=Object(z.d)(Ba||(Ba=Object(F.a)(["\n  query obtenerConsultasProducto($empresa: ID!, $sucursal: ID!) {\n    obtenerConsultasProducto(empresa: $empresa, sucursal: $sucursal) {\n      categorias {\n        _id\n        categoria\n        subcategorias {\n          _id\n          subcategoria\n        }\n      }\n      departamentos {\n        _id\n        nombre_departamentos\n      }\n      marcas {\n        _id\n        nombre_marca\n      }\n      colores {\n        _id\n        nombre\n        hex\n      }\n      tallas {\n        _id\n        talla\n        tipo\n      }\n      calzados {\n        _id\n        talla\n        tipo\n      }\n      almacenes {\n        _id\n        nombre_almacen\n      }\n      centro_costos {\n        _id\n        cuenta\n        subcuentas {\n          _id\n          subcuenta\n        }\n      }\n      codigos {\n        _id\n        Name\n        Value\n      }\n    }\n  }\n"]))),mn=Object(z.d)(Ja||(Ja=Object(F.a)(["\n  mutation crearProducto($input: CrearProductoInput) {\n    crearProducto(input: $input) {\n      message\n    }\n  }\n"]))),On=Object(z.d)(Ga||(Ga=Object(F.a)(["\n  query obtenerProductos(\n    $empresa: ID!\n    $sucursal: ID!\n    $filtro: String\n    $almacen: ID\n    $existencias: Boolean\n  ) {\n    obtenerProductos(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtro: $filtro\n      almacen: $almacen\n      existencias: $existencias\n    ) {\n      _id\n      centro_de_costos {\n        id_cuenta\n        cuenta\n        id_subcuenta\n        subcuenta\n      }\n      unidades_de_venta {\n        _id\n        precio\n        cantidad\n        unidad\n        codigo_unidad\n        unidad_principal\n        codigo_barras\n        id_producto\n        descuento_activo\n        descuento {\n          cantidad_unidad\n          numero_precio\n          unidad_maxima\n          precio_general\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          utilidad\n          porciento\n          dinero_descontado\n        }\n        default\n        precio_unidad {\n          numero_precio\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          unidad_mayoreo\n          utilidad\n          precio_general\n          cantidad_unidad\n          unidad_maxima\n        }\n      }\n      datos_generales {\n        codigo_barras\n        clave_alterna\n        tipo_producto\n        nombre_comercial\n        nombre_generico\n        descripcion\n        id_categoria\n        categoria\n        subcategoria\n        id_subcategoria\n        id_departamento\n        departamento\n        id_marca\n        marca\n        clave_producto_sat {\n          Name\n          Value\n        }\n        receta_farmacia\n      }\n      empresa\n      imagenes {\n        location_imagen\n        extencion_imagen\n        url_imagen\n        key_imagen\n      }\n      precio_plazos {\n        precio_cajas {\n          plazo\n          unidad\n          precio\n          codigo_unidad\n        }\n        precio_piezas {\n          plazo\n          unidad\n          precio\n          codigo_unidad\n        }\n        precio_costales {\n          plazo\n          unidad\n          codigo_unidad\n          precio\n        }\n      }\n      precios {\n        ieps\n        ieps_activo\n        iva\n        iva_activo\n        monedero\n        monedero_electronico\n        precio_de_compra {\n          ieps\n          iva\n          precio_con_impuesto\n          precio_sin_impuesto\n        }\n        precios_producto {\n          numero_precio\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          unidad_mayoreo\n          utilidad\n          precio_general\n          cantidad_unidad\n          unidad_maxima\n        }\n        unidad_de_compra {\n          cantidad\n          precio_unitario_con_impuesto\n          precio_unitario_sin_impuesto\n          unidad\n          codigo_unidad\n        }\n        inventario {\n          inventario_minimo\n          inventario_maximo\n          unidad_de_inventario\n          codigo_unidad\n        }\n        granel\n      }\n      medidas_producto {\n        _id\n        cantidad\n        almacen\n        descuento_activo\n        descuento {\n          cantidad_unidad\n          numero_precio\n          unidad_maxima\n          precio_general\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          utilidad\n          porciento\n          dinero_descontado\n        }\n        codigo_barras\n        color {\n          _id\n          nombre\n          hex\n        }\n        existencia\n        medida {\n          _id\n          talla\n          tipo\n        }\n        nombre_comercial\n        precio\n        precio_unidad {\n          numero_precio\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          unidad_mayoreo\n          utilidad\n          precio_general\n          cantidad_unidad\n          unidad_maxima\n        }\n      }\n      inventario_general {\n        _id\n        cantidad_existente\n        unidad_inventario\n        codigo_unidad\n        cantidad_existente_maxima\n        unidad_maxima\n        id_almacen_general\n        eliminado\n      }\n      medidas_registradas\n      sucursal\n      usuario\n    }\n  }\n"]))),xn=Object(z.d)(qa||(qa=Object(F.a)(["\n  mutation actualizarProducto($id: ID!, $input: ActualizarProductoInput) {\n    actualizarProducto(id: $id, input: $input) {\n      message\n    }\n  }\n"]))),hn=Object(z.d)(Ha||(Ha=Object(F.a)(["\n  mutation eliminarProducto($id: ID!) {\n    eliminarProducto(id: $id) {\n      message\n    }\n  }\n"]))),fn=Object(z.d)(Ya||(Ya=Object(F.a)(["\n  query obtenerProductosInactivos($empresa: ID!, $sucursal: ID!) {\n    obtenerProductosInactivos(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      producto {\n        _id\n        datos_generales {\n          codigo_barras\n          clave_alterna\n          tipo_producto\n          nombre_comercial\n          nombre_generico\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          ieps\n          ieps_activo\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          precio_de_compra {\n            ieps\n            iva\n            precio_con_impuesto\n            precio_sin_impuesto\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            precio_venta\n            unidad_mayoreo\n            utilidad\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n          }\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n          }\n          granel\n        }\n      }\n      cantidad_existente\n      unidad_de_inventario\n      id_almacen\n      eliminado\n      empresa\n      sucursal\n    }\n  }\n"]))),gn=Object(z.d)(Xa||(Xa=Object(F.a)(["\n  mutation activarProducto($id: ID!) {\n    activarProducto(id: $id) {\n      message\n    }\n  }\n"]))),_n=Object(z.d)(Ka||(Ka=Object(F.a)(["\n  mutation crearProductoRapido($input: CrearProductoRapidoInput) {\n    crearProductoRapido(input: $input) {\n      message\n    }\n  }\n"]))),vn=a(793),Cn=Object(s.createContext)(),yn=function(e){var t=e.children,a=Object(s.useState)({nombre_almacen:"",id_usuario_encargado:"",direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""}}),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(!1),u=Object(v.a)(j,2),b=u[0],p=u[1],m=Object(s.useState)(!1),O=Object(v.a)(m,2),x=O[0],h=O[1];return Object(V.jsx)(Cn.Provider,{value:{datosAlmacen:c,setDatosAlmacen:r,update:l,setUpdate:d,error:b,setError:p,openRegistro:x,setOpenRegistro:h},children:t})},Sn=Object(z.d)(rn||(rn=Object(F.a)(["\n  mutation CrearAlmacen($input: CrearAlmacen, $id: ID!, $empresa: ID!) {\n    crearAlmacen(input: $input, id: $id, empresa: $empresa) {\n      _id\n    }\n  }\n"]))),wn=Object(z.d)(on||(on=Object(F.a)(["\n  query obtenerAlmacenes($id: ID!) {\n    obtenerAlmacenes(id: $id) {\n      _id\n      nombre_almacen\n      id_usuario_encargado {\n        _id\n        nombre\n      }\n      id_sucursal {\n        _id\n        nombre_sucursal\n        descripcion\n        direccion {\n          calle\n          no_ext\n          no_int\n          codigo_postal\n          colonia\n          municipio\n          localidad\n          estado\n          pais\n        }\n      }\n      direccion {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n    }\n  }\n"]))),In=Object(z.d)(sn||(sn=Object(F.a)(["\n  mutation ActualizarAlmacen($input: EditarAlmacen, $id: ID!) {\n    actualizarAlmacen(input: $input, id: $id) {\n      message\n    }\n  }\n"]))),kn=Object(z.d)(ln||(ln=Object(F.a)(["\n  query obtenerProductosAlmacenes(\n    $empresa: ID!\n    $sucursal: ID!\n    $filtro: FilterProductoInput\n  ) {\n    obtenerProductosAlmacenes(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtro: $filtro\n    ) {\n      _id\n      datos_generales {\n        codigo_barras\n        clave_alterna\n        tipo_producto\n        nombre_comercial\n        nombre_generico\n        descripcion\n        id_categoria\n        categoria\n        subcategoria\n        id_subcategoria\n        id_departamento\n        departamento\n        id_marca\n        marca\n        clave_producto_sat {\n          Name\n          Value\n        }\n        receta_farmacia\n      }\n      existencia_almacenes {\n        _id {\n          producto\n          almacen {\n            _id\n            nombre_almacen\n          }\n        }\n        cantidad_existente\n      }\n      empresa\n      sucursal\n    }\n  }\n"]))),Nn=Object(z.d)(dn||(dn=Object(F.a)(["\n  query obtenerCategorias($empresa: ID!, $sucursal: ID!) {\n    obtenerCategorias(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      categoria\n      subcategorias {\n        _id\n        subcategoria\n      }\n    }\n  }\n"]))),Fn=Object(z.d)(jn||(jn=Object(F.a)(["\n  mutation CrearTraspaso(\n    $input: CrearTraspasoInput\n    $usuario: ID!\n    $empresa: ID!\n  ) {\n    crearTraspaso(input: $input, usuario: $usuario, empresa: $empresa) {\n      message\n      resp\n    }\n  }\n"]))),zn=Object(z.d)(un||(un=Object(F.a)(["\n  query obtenerProductosPorEmpresa($empresa: ID!, $filtro: String) {\n    obtenerProductosPorEmpresa(empresa: $empresa, filtro : $filtro) {\n      _id\n      datos_generales {\n        codigo_barras\n        clave_alterna\n        tipo_producto\n        nombre_comercial\n        nombre_generico\n        descripcion\n        id_categoria\n        categoria\n        subcategoria\n        id_subcategoria\n        id_departamento\n        departamento\n        id_marca\n        marca\n        clave_producto_sat {\n          Name\n          Value\n        }\n        receta_farmacia\n      }\n      precio_plazos {\n        precio_cajas {\n          plazo\n          unidad\n          precio\n        }\n        precio_piezas {\n          plazo\n          unidad\n          precio\n        }\n        precio_costales {\n          plazo\n          unidad\n          precio\n        }\n      }\n      precios {\n        ieps\n        ieps_activo\n        iva\n        iva_activo\n        monedero\n        monedero_electronico\n        precio_de_compra {\n          ieps\n          iva\n          precio_con_impuesto\n          precio_sin_impuesto\n        }\n        precios_producto {\n          numero_precio\n          precio_neto\n          precio_venta\n          unidad_mayoreo\n          utilidad\n          ieps_precio\n          iva_precio\n        }\n        unidad_de_compra {\n          cantidad\n          precio_unitario_con_impuesto\n          precio_unitario_sin_impuesto\n          unidad\n        }\n        inventario {\n          inventario_minimo\n          inventario_maximo\n          unidad_de_inventario\n        }\n        granel\n      }\n      sucursal\n      usuario\n      empresa\n    }\n  }\n"]))),Pn=Object(z.d)(bn||(bn=Object(F.a)(["\n  query obtenerTraspasos( $input: ConsultaTraspasosInput) {\n    obtenerTraspasos(input: $input) {\n      _id  \n      cantidad\n      \n      id_traspaso{\n        concepto_traspaso{\n          nombre_concepto\n        }\n        fecha_registro\n      }\n      producto{\n        datos_generales{\n          nombre_comercial\n        }\n      }\n      almacen_origen{\n        _id\n        nombre_almacen\n      }\n      almacen_destino{\n        _id\n        nombre_almacen\n      }\n    }\n  }\n"]))),Dn=a(92),En=a.n(Dn),An=["id_usuario_encargado"],Tn=["id_usuario_encargado"],Wn=["id_sucursal","_id"],Rn=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& span":{color:"red"}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}}));function $n(e){var t,a=e.accion,n=e.datos,c=e.refetch,r=JSON.parse(localStorage.getItem("sesionCafi")),i=Object(N.a)(Sn),o=Object(v.a)(i,1)[0],l=Object(N.a)(In),d=Object(v.a)(l,1)[0],j=Object(He.a)(D,{variables:{sucursal:"".concat(r.sucursal._id)}}).data,p=[],m=Rn(),O=Object(s.useState)({message:"",status:"",open:!1}),x=Object(v.a)(O,2),f=x[0],I=x[1],k=Object(s.useState)(!1),F=Object(v.a)(k,2),z=F[0],P=F[1],E=Object(s.useContext)(Cn),A=E.datosAlmacen,T=E.setDatosAlmacen,W=E.error,R=E.setError,$=E.update,M=E.setUpdate,L=Object(s.useContext)(xe),U=L.almacen_inicial,J=L.setAlmacenInicial,q=Object(s.useState)(!1),H=Object(v.a)(q,2),Y=H[0],K=H[1],Q=Object(s.useCallback)((function(){T({nombre_almacen:"",id_usuario_encargado:"",direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""}})}),[T]),Z=function(){if(P(!0),n){var e={};if(n.id_usuario_encargado){var t=n.id_usuario_encargado;(e=Object(fe.a)(n,An)).id_usuario_encargado=t._id}else e=n;T(e)}},ee=function(){P(!1),Q()},te=function(e){T(Object(u.a)(Object(u.a)({},A),{},Object(h.a)({},e.target.name,e.target.value)))},ae=function(e){T(Object(u.a)(Object(u.a)({},A),{},{direccion:Object(u.a)(Object(u.a)({},A.direccion),{},Object(h.a)({},e.target.name,e.target.value))}))},ne=function(){var e=Object(_.a)(g.a.mark((function e(){var t,n,i,s,l;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,A.nombre_almacen){e.next=6;break}return R(!0),e.abrupt("return");case 6:if("registrar"!==a){e.next=23;break}if(t={},""!==A.id_usuario_encargado){e.next=15;break}return A.id_usuario_encargado,i=Object(fe.a)(A,Tn),e.next=12,o({variables:{input:i,id:r.sucursal._id,empresa:r.empresa._id}});case 12:n=e.sent,e.next=19;break;case 15:return t=A,e.next=18,o({variables:{input:t,id:r.sucursal._id,empresa:r.empresa._id}});case 18:n=e.sent;case 19:s=n.data.crearAlmacen._id,c&&(J(Object(u.a)(Object(u.a)({},U),{},{id_almacen:s,almacen:A.nombre_almacen})),c()),e.next=26;break;case 23:return A.id_sucursal,A._id,l=Object(fe.a)(A,Wn),e.next=26,d({variables:{input:l,id:A._id}});case 26:M(!$),I({message:"\xa1Listo!",status:"success",open:!0}),R(!1),K(!1),ee();case 31:e.next=37;break;case 33:e.prev=33,e.t0=e.catch(0),I({message:"Hubo un error",status:"error",open:!0}),K(!1);case 37:case"end":return e.stop()}}),e,null,[[0,33]])})));return function(){return e.apply(this,arguments)}}();return j&&(p=j.obtenerUsuarios),Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(B,{alert:f,setAlert:I}),"registrar"===a?c?Object(V.jsx)(X.a,{color:"primary",onClick:Z,children:Object(V.jsx)(En.a,{})}):Object(V.jsx)(w.a,{color:"primary",variant:"contained",size:"large",onClick:Z,children:"Nuevo almacen"}):Object(V.jsx)(X.a,{onClick:Z,children:Object(V.jsx)($a.a,{})}),Object(V.jsxs)(ze.a,{open:z,onClose:ee,fullWidth:!0,maxWidth:"md",children:[Object(V.jsx)(Ve,{loading:Y,setLoading:K}),Object(V.jsx)(wt.a,{id:"form-dialog-title",children:"Registro almacen"}),Object(V.jsxs)(C.a,{maxWidth:"md",children:[Object(V.jsxs)("div",{className:m.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{children:"* "}),"Nombre Almacen"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:W,name:"nombre_almacen",id:"form-producto-codigo-barras",variant:"outlined",value:A.nombre_almacen,onChange:te})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Encargado de almacen"}),Object(V.jsx)(G.a,{fullWidth:!0,size:"small",variant:"outlined",children:Object(V.jsx)(De.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",name:"id_usuario_encargado",value:A.id_usuario_encargado?A.id_usuario_encargado:"",onChange:te,children:null===(t=p)||void 0===t?void 0:t.map((function(e,t){return Object(V.jsx)(Ee.a,{value:e._id,children:e.nombre},t)}))})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Sucursal"}),Object(V.jsx)(y.a,{style:{marginTop:"7px",fontWeight:"bold"},children:r.sucursal.nombre_sucursal})]})]}),Object(V.jsxs)(b.a,{mt:2,children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Domicilio"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)("div",{className:m.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Calle"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"calle",variant:"outlined",value:A.direccion.calle,onChange:ae})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"No. exterior"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_ext",variant:"outlined",value:A.direccion.no_ext,onChange:ae})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"No. interior"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_int",variant:"outlined",value:A.direccion.no_int,onChange:ae})]})]}),Object(V.jsxs)("div",{className:m.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Codigo Postal"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",type:"number",name:"codigo_postal",variant:"outlined",value:A.direccion.codigo_postal,onChange:ae})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Colonia"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"colonia",variant:"outlined",value:A.direccion.colonia,onChange:ae})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Municipio"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"municipio",variant:"outlined",value:A.direccion.municipio,onChange:ae})]})]}),Object(V.jsxs)("div",{className:m.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Localidad"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"localidad",variant:"outlined",value:A.direccion.localidad,onChange:ae})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Estado"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"estado",variant:"outlined",value:A.direccion.estado,onChange:ae})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Pais"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"pais",variant:"outlined",value:A.direccion.pais,onChange:ae})]})]}),Object(V.jsx)(b.a,{m:1,display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(w.a,{color:"primary",variant:"contained",size:"large",onClick:ne,children:"Guardar"})})]})]})]})}var Mn,Ln,Vn,Un,Bn,Jn,Gn,qn,Hn=a(260),Yn=Object(z.d)(Mn||(Mn=Object(F.a)(["\n\tmutation crearColor($input: CrearColorInput) {\n\t\tcrearColor(input: $input) {\n\t\t\t_id\n\t\t\tnombre\n\t\t\thex\n\t\t\tempresa {\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t\tsucursales_activas\n\t\t\t\tlimite_sucursales\n\t\t\t\t_id\n\t\t\t}\n\t\t}\n\t}\n"]))),Xn=Object(z.d)(Ln||(Ln=Object(F.a)(["\n\tquery obtenerColores($sucursal: String!) {\n\t\tobtenerColores(sucursal: $sucursal) {\n\t\t\t_id\n\t\t\tnombre\n\t\t\thex\n\t\t\tempresa {\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t\tsucursales_activas\n\t\t\t\tlimite_sucursales\n\t\t\t\t_id\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t}\n\t}\n"]))),Kn=Object(z.d)(Vn||(Vn=Object(F.a)(["\n\tmutation actualizarColor($input: ActualizarColorInput, $id: ID!) {\n\t\tactualizarColor(id: $id, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Qn=Object(z.d)(Un||(Un=Object(F.a)(["\n\tmutation eliminarColor($id: ID!) {\n\t\teliminarColor(id: $id) {\n\t\t\tmessage\n\t\t}\n\t}\n"])));function Zn(e){var t=e.refetch,a=Object(s.useState)({}),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)({nombre:"",hex:""}),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)({message:"",status:"",open:!1}),p=Object(v.a)(j,2),m=p[0],O=p[1],x=JSON.parse(localStorage.getItem("sesionCafi")),h=Object(s.useState)(!1),f=Object(v.a)(h,2),C=f[0],I=f[1],k=function(){return I(!C)},F=Object(N.a)(Yn),z=Object(v.a)(F,1)[0],P=function(){var e=Object(_.a)(g.a.mark((function e(a){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),l.nombre&&l.hex){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,n=l,e.next=7,z({variables:{input:{nombre:n.nombre,hex:n.hex,empresa:x.empresa._id,sucursal:x.sucursal._id}}});case 7:t(),d({nombre:"",hex:""}),O({message:"\xa1Listo!",status:"success",open:!0}),k(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),O({message:"Hubo un error",status:"error",open:!0});case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"flex-end",children:Object(V.jsxs)(w.a,{color:"primary",onClick:function(){return k()},children:[Object(V.jsx)(It.a,{}),"nuevo color"]})}),Object(V.jsxs)(ze.a,{open:C,scroll:"paper",disableEscapeKeyDown:!0,onClose:function(e,t){"backdropClick"!==t&&k()},children:[Object(V.jsx)(Pe.a,{children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(B,{alert:m,setAlert:O}),Object(V.jsx)(Hn.a,{color:c,onChangeComplete:function(e){r(e),d(Object(u.a)(Object(u.a)({},l),{},{hex:e.hex.toUpperCase()}))}}),Object(V.jsxs)(b.a,{mt:2,children:[Object(V.jsx)(y.a,{children:"Color seleccionado:"}),l.hex?Object(V.jsx)(b.a,{bgcolor:l.hex,height:30,width:220}):Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",width:220,children:Object(V.jsx)(y.a,{color:"secondary",children:"NINGUNO"})})]}),Object(V.jsx)(b.a,{my:2,children:Object(V.jsx)("form",{id:"form-registro-color",onSubmit:function(e){return P(e)},children:Object(V.jsx)(S.a,{label:"Nombre del color",variant:"outlined",size:"small",value:l.nombre,onChange:function(e){return d(Object(u.a)(Object(u.a)({},l),{},{nombre:e.target.value.toUpperCase()}))},fullWidth:!0,focused:!0})})})]})}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{variant:"outlined",color:"primary",onClick:function(){return k()},size:"large",children:"Cancelar"}),Object(V.jsx)(w.a,{variant:"contained",color:"primary",type:"submit",form:"form-registro-color",size:"large",startIcon:Object(V.jsx)(Pt.a,{}),children:"Guardar"})]})]})]})}var ec=Object(z.d)(Bn||(Bn=Object(F.a)(["\n\tmutation crearTalla($input: CrearTallaInput) {\n\t\tcrearTalla(input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),tc=Object(z.d)(Jn||(Jn=Object(F.a)(["\n\tquery obtenerTallas($sucursal: String!, $tipo: String! ) {\n\t\tobtenerTallas(sucursal: $sucursal, tipo: $tipo) {\n\t\t\t_id\n\t\t\ttalla\n\t\t\ttipo\n\t\t\tempresa {\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t\tsucursales_activas\n\t\t\t\tlimite_sucursales\n\t\t\t\t_id\n\t\t\t}\n\t\t}\n\t}\n"]))),ac=Object(z.d)(Gn||(Gn=Object(F.a)(["\n\tmutation actualizarTalla($input: ActualizarTallaInput, $id: ID!) {\n\t\tactualizarTalla(id: $id, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),nc=Object(z.d)(qn||(qn=Object(F.a)(["\n\tmutation eliminarTalla($input: ActualizarTallaInput,$id: ID!) {\n\t\teliminarTalla(id: $id, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"])));function cc(e){var t=e.setMedidasSeleccionadas,a=e.refetch,n=Object(s.useState)(""),c=Object(v.a)(n,2),r=c[0],i=c[1],o=Object(s.useState)(!1),l=Object(v.a)(o,2),d=l[0],j=l[1],u=Object(s.useState)({message:"",status:"",open:!1}),p=Object(v.a)(u,2),m=p[0],O=p[1],x=JSON.parse(localStorage.getItem("sesionCafi")),h=Object(s.useContext)(xe).datos_generales,f=Object(N.a)(ec),C=Object(v.a)(f,1)[0],y=function(){return j(!d)},I=function(){var e=Object(_.a)(g.a.mark((function e(n){var c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),r){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,c=r,e.next=7,C({variables:{input:{talla:c,tipo:h.tipo_producto,empresa:x.empresa._id,sucursal:x.sucursal._id}}});case 7:a(),t([c]),i(""),O({message:"\xa1Listo!",status:"success",open:!0}),y(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),O({message:"Hubo un error",status:"error",open:!0});case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"flex-end",children:Object(V.jsxs)(w.a,{color:"primary",onClick:function(){return y()},children:[Object(V.jsx)(It.a,{})," Nueva talla"]})}),Object(V.jsxs)(ze.a,{open:d,scroll:"paper",disableEscapeKeyDown:!0,onClose:function(e,t){"backdropClick"!==t&&y()},children:[Object(V.jsx)(Pe.a,{children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(B,{alert:m,setAlert:O}),Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",my:2,children:Object(V.jsx)("form",{id:"form-registro-color",onSubmit:function(e){return I(e)},children:Object(V.jsx)(S.a,{id:"outlined-error-helper-text",label:"ROPA"===h.tipo_producto?"Talla":"N\xfamero",variant:"outlined",size:"small",focused:!0,fullWidth:!0,value:r,onChange:function(e){return i(e.target.value.toUpperCase())}})})})]})}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{variant:"outlined",color:"primary",onClick:function(){return y()},size:"large",children:"Cancelar"}),Object(V.jsx)(w.a,{variant:"contained",color:"primary",type:"submit",form:"form-registro-color",size:"large",startIcon:Object(V.jsx)(Pt.a,{}),children:"Guardar"})]})]})]})}var rc=Object(k.a)((function(e){return{colorContainer:{border:"1px solid rgba(0,0,0, .3)",display:"flex",justifyContent:"center",alignItems:"center",height:50,width:50,margin:1,borderRadius:"15%",cursor:"pointer"}}})),ic=function(){return Math.floor(9e11*Math.random()+1e11).toString()};function oc(e){var t=e.obtenerConsultasProducto,a=e.refetch,n=e.datos,c=Object(s.useContext)(xe),r=c.almacen_inicial,i=c.setAlmacenInicial,o=c.presentaciones,l=c.datos_generales,d=t.almacenes,j=t.colores,p=t.tallas,m=t.calzados,O=Object(s.useState)([]),x=Object(v.a)(O,2),f=x[0],g=x[1],_=Object(s.useState)([]),C=Object(v.a)(_,2),S=C[0],w=C[1],I="ROPA"===l.tipo_producto?Object(ea.a)(p):Object(ea.a)(m),k=Object(s.useState)([]),N=Object(v.a)(k,2),F=N[0],z=N[1],P=Object(s.useCallback)((function(){var e=[],t=[];Object(ea.a)(o).forEach((function(a){a.color._id&&e.push(a.color),a.medida._id&&t.push(a.medida)}));var a={},n={},c=e.filter((function(e){var t=!a[e._id];return a[e._id]=!0,t})),r=t.filter((function(e){var t=!n[e._id];return n[e._id]=!0,t}));w(Object(ea.a)(c)),g(Object(ea.a)(r))}),[o]);return Object(s.useEffect)((function(){P()}),[P]),Object(V.jsx)("div",{children:Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsx)(Fe.a,{item:!0,md:9,children:Object(V.jsx)(Ua,{datos:n,setOnUpdate:z,onUpdate:F})}),Object(V.jsxs)(Fe.a,{item:!0,md:3,children:[n.medidas_registradas?null:Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(b.a,{width:"100%",mb:2,children:[Object(V.jsx)(y.a,{children:"Almacen"}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsxs)(G.a,{disabled:0===o.length,variant:"outlined",fullWidth:!0,size:"small",name:"almacen",error:o.length>0&&!r.almacen,children:[Object(V.jsxs)(De.a,{name:"almacen",value:r.almacen,onChange:function(e,t){var a;i(Object(u.a)(Object(u.a)({},r),{},(a={},Object(h.a)(a,e.target.name,e.target.value),Object(h.a)(a,t.props.name,t.props.id),a)))},children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Seleccione uno"})}),d?d.map((function(e){return Object(V.jsx)(Ee.a,{name:"id_almacen",value:e.nombre_almacen,id:e._id,children:e.nombre_almacen},e._id)})):Object(V.jsx)(Ee.a,{value:""})]}),o.length>0&&!r.almacen?Object(V.jsx)(vn.a,{children:"* Campo obligatorio"}):null]}),Object(V.jsx)(yn,{children:Object(V.jsx)($n,{accion:"registrar",refetch:a})})]})]}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)(b.a,{width:"100%",my:2,style:F.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(V.jsx)(y.a,{children:"ROPA"===l.tipo_producto?"Talla":"N\xfamero"}),Object(V.jsx)(cc,{setMedidasSeleccionadas:g,refetch:a}),Object(V.jsx)(Fe.a,{container:!0,children:I.map((function(e,t){return Object(V.jsx)(sc,{talla:e,coloresSeleccionados:S,medidasSeleccionadas:f,setMedidasSeleccionadas:g,datos:n},t)}))})]}),Object(V.jsx)(Te.a,{}),Object(V.jsxs)(b.a,{width:"100%",mt:1,style:F.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(V.jsx)(y.a,{children:"Color"}),Object(V.jsx)(Zn,{refetch:a}),Object(V.jsx)(Fe.a,{container:!0,children:j.map((function(e,t){return Object(V.jsx)(lc,{color:e,coloresSeleccionados:S,setColoresSeleccionados:w,medidasSeleccionadas:f,datos:n},t)}))})]})]})]})})}var sc=function(e){var t=e.talla,a=e.coloresSeleccionados,n=e.medidasSeleccionadas,c=e.setMedidasSeleccionadas,r=e.datos,i=rc(),o=Object(ve.a)(),l=Object(s.useContext)(xe),d=l.setPresentaciones,j=l.presentaciones,u=l.datos_generales,b=l.preciosP,p=Object(s.useState)(!1),m=Object(v.a)(p,2),O=m[0],x=m[1],h=Object(s.useCallback)((function(){n.forEach((function(e){e._id===t._id&&x(!0)}))}),[t._id,n]);Object(s.useEffect)((function(){if(r.medidas_registradas)return h()}),[h]);return Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsx)("div",{className:i.colorContainer,onClick:function(){return function(e){var r=Object(ea.a)(n);O?r.forEach((function(a,n){a._id===t._id&&(r.splice(n,1),x(e))})):(r.push(t),x(e));var i=[],o=Object(ea.a)(j);if(a.length||o.length){if(!a.length&&o.length>0)for(var s=function(e){var t=r[e],a=o.filter((function(e){return e.medida._id===t._id}));a.length?i.push(a[0]):i.push({existencia:!1,codigo_barras:ic(),nombre_comercial:u.nombre_comercial,medida:t,color:{nombre:"",hex:""},precio:b[0].precio_neto,cantidad:0,nuevo:!0})},l=0;l<r.length;l++)s(l);else if(a.length>0&&1===r.length&&e)for(var p=0;p<o.length;p++)for(var m=0;m<r.length;m++)i.push({existencia:o[p].existencia,codigo_barras:o[p].codigo_barras,nombre_comercial:o[p].nombre_comercial,medida:r[m],color:o[p].color,precio:o[p].precio,cantidad:o[p].cantidad,nuevo:!0});else if(a.length>0&&r.length>0)for(var h=function(e){for(var t=r[e],n=function(e){var n=a[e],c=o.filter((function(e){return e.medida._id===t._id&&n._id===e.color._id}));c.length?i.push(c[0]):i.push({existencia:!1,codigo_barras:ic(),nombre_comercial:u.nombre_comercial,medida:t,color:n,precio:b[0].precio_neto,cantidad:0,nuevo:!0})},c=0;c<a.length;c++)n(c)},f=0;f<r.length;f++)h(f);else if(a.length>0&&!r.length&&o.filter((function(e){return e.medida._id})).length)for(var g=0;g<o.length;g++){var _=o[g];i.push({existencia:_.existencia,codigo_barras:_.codigo_barras,nombre_comercial:_.nombre_comercial,medida:{},color:_.color,precio:_.precio,cantidad:_.cantidad,nuevo:!0})}}else for(var v=0;v<r.length;v++){var C=r[v];i.push({existencia:!1,codigo_barras:ic(),nombre_comercial:u.nombre_comercial,medida:C,color:{nombre:"",hex:""},precio:b[0].precio_neto,cantidad:0,nuevo:!0})}c(Object(ea.a)(r)),d(i)}(!O)},style:O?{backgroundColor:o.palette.primary.main}:null,children:Object(V.jsx)(y.a,{variant:"button",style:{color:o.palette.getContrastText(O?o.palette.primary.main:"#FFFFFF"),fontSize:16},children:t.talla})})})},lc=function(e){var t=e.color,a=e.coloresSeleccionados,n=e.setColoresSeleccionados,c=e.medidasSeleccionadas,r=e.datos,i=rc(),o=Object(ve.a)(),l=Object(s.useContext)(xe),d=l.presentaciones,j=l.setPresentaciones,u=l.datos_generales,b=l.preciosP,p=Object(s.useState)(!1),m=Object(v.a)(p,2),O=m[0],x=m[1],h=Object(s.useCallback)((function(){a.forEach((function(e){e._id===t._id&&x(!0)}))}),[t._id,a]);Object(s.useEffect)((function(){if(r.medidas_registradas)return h()}),[h]);return Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsx)(Aa.a,{title:t.nombre,placement:"top",arrow:!0,TransitionComponent:Ta.a,children:Object(V.jsx)("div",{className:i.colorContainer,style:{backgroundColor:t.hex,color:o.palette.getContrastText(t.hex)},onClick:function(){return function(e){O?a.forEach((function(n,c){n._id===t._id&&(a.splice(c,1),x(e))})):(a.push(t),x(e));var r=[],i=Object(ea.a)(d);if(c.length||i.length){if(!c.length&&i.length>0)for(var o=function(e){var t=a[e],n=i.filter((function(e){return e.color._id===t._id}));n.length?r.push(n[0]):r.push({existencia:!1,codigo_barras:ic(),nombre_comercial:u.nombre_comercial,medida:{},color:t,precio:b[0].precio_neto,cantidad:0,nuevo:!0})},s=0;s<a.length;s++)o(s);else if(c.length>0&&1===a.length&&e)for(var l=0;l<i.length;l++)for(var p=0;p<a.length;p++)r.push({existencia:i[l].existencia,codigo_barras:i[l].codigo_barras,nombre_comercial:i[l].nombre_comercial,medida:i[l].medida,color:a[p],precio:i[l].precio,cantidad:i[l].cantidad,nuevo:!0});else if(c.length>0&&a.length>0)for(var m=function(e){for(var t=a[e],n=function(e){var a=c[e],n=i.filter((function(e){return e.medida._id===a._id&&t._id===e.color._id}));n.length?r.push(n[0]):r.push({existencia:!1,codigo_barras:ic(),nombre_comercial:u.nombre_comercial,medida:a,color:t,precio:b[0].precio_neto,cantidad:0,nuevo:!0})},o=0;o<c.length;o++)n(o)},h=0;h<a.length;h++)m(h);else if(c.length>0&&!a.length&&i.filter((function(e){return e.color._id})).length)for(var f=0;f<i.length;f++){var g=i[f];r.push({existencia:g.existencia,codigo_barras:g.codigo_barras,nombre_comercial:g.nombre_comercial,medida:g.medida,color:{nombre:"",hex:""},precio:g.precio,cantidad:g.cantidad,nuevo:!0})}}else for(var _=0;_<a.length;_++){var v=a[_];r.push({existencia:!1,codigo_barras:ic(),nombre_comercial:u.nombre_comercial,medida:{},color:v,precio:b[0].precio_neto,cantidad:0,nuevo:!0})}n(Object(ea.a)(a)),j(r)}(!O)},children:O?Object(V.jsx)(Pt.a,{}):null})})})},dc=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function jc(e){var t=e.verificate,a=e.setVerificate,n=Object(s.useState)(!1),c=Object(v.a)(n,2),r=c[0],i=c[1],o=JSON.parse(localStorage.getItem("sesionCafi")),l=Object(s.useContext)(ka),d=l.datosProducto,j=l.datosCompra,u=l.setLoadingProductos,b=Object(He.a)(pn,{variables:{empresa:o.empresa._id,sucursal:o.sucursal._id}}),p=b.loading,m=b.data,O=b.error,x=b.refetch;if(Object(s.useEffect)((function(){u(!!p)}),[p]),p)return Object(V.jsx)(w.a,{color:"primary",size:"medium",disabled:!0,startIcon:Object(V.jsx)(I.a,{size:16,color:"inherit"}),children:"Medidas"});if(O)return Object(V.jsx)(Je,{error:O});var h=m.obtenerConsultasProducto,f=function(){i(!r),a(!1)};return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(Aa.a,{title:"Selecciona medidas y colores",disableHoverListener:!0,open:t,placement:"top",children:Object(V.jsx)(w.a,{color:t?"secondary":"inherit",variant:"outlined",size:"medium",onClick:function(){return f()},startIcon:Object(V.jsx)(Ia.a,{}),disabled:!d.producto.datos_generales,children:"Medidas"})}),Object(V.jsxs)(ze.a,{open:r,TransitionComponent:dc,keepMounted:!0,onClose:f,"aria-labelledby":"alert-tallas-compra","aria-describedby":"alert-tallas-compra-description",fullWidth:!0,maxWidth:"lg",children:[Object(V.jsx)(Pe.a,{children:Object(V.jsx)(oc,{datos:d.producto,obtenerConsultasProducto:h,refetch:x,from:"compra",almacen:j.almacen,withoutPrice:!0})}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{size:"large",onClick:function(){return f()},startIcon:Object(V.jsx)(Pt.a,{}),color:"primary",variant:"contained",children:"Aceptar"})})]})]})}var uc=a(883),bc=a(879),pc=a(839),mc=a(796),Oc=a(878),xc=a(877),hc=a(121),fc=a.n(hc),gc="QUJTT0xVQ0lPTkVTOkxlb24yMDE4Iw==",_c="https://apisandbox.facturama.mx/";fc.a.ajaxSetup({beforeSend:function(e){e.withCredentials=!0,e.setRequestHeader("Authorization","Basic "+gc)}});var vc,Cc,yc,Sc=function(){var e={url:_c};function t(t,a,n){return fc.a.get(e.url+t+"/"+a,void 0,n,"json")}function a(t,a){return fc.a.get(e.url+t,void 0,a,"json")}function n(t,a,n,c){fc.a.ajax({url:e.url+t,type:"POST",dataType:"json",data:JSON.stringify(a),contentType:"application/json",success:n,error:c})}function c(t,a,n,c){fc.a.ajax({url:e.url+t,type:"PUT",data:JSON.stringify(a),contentType:"application/json",success:n,error:c})}function r(t,a,n,c){fc.a.ajax({url:e.url+t+"/"+a,type:"DELETE",async:!1,success:n,error:c})}var i={Clients:{Get:function(e,a){return t("client",e,a)},List:function(e){return a("client",e)},Create:function(e,t,a){n("client",e,t,a)},Remove:function(e,t,a){r("client/",e,t,a)},Update:function(e,t,a,n){c("client/"+e,t,a,n)}},Products:{Get:function(e,a){return t("product",e,a)},List:function(e){return a("product",e)},Create:function(e,t,a){n("product",e,t,a)},Remove:function(e,t,a){r("product/",e,t,a)},Update:function(e,t,a,n){c("product/"+e,t,a,n)}},BranchOffice:{Get:function(e,a){return t("branchOffice",e,a)},List:function(e){return a("branchOffice",e)},Create:function(e,t,a){n("branchOffice",e,t,a)},Remove:function(e,t,a){r("branchOffice",e,t,a)},Update:function(e,t,a,n){c("branchOffice/"+e,t,a,n)}},Series:{List:function(e,a){return t("serie",e,a)},Create:function(e,t,a,c){n("serie/"+e,t,a,c)},Remove:function(e,t,a,n){r("serie/"+e,t,a,n)},Update:function(e,t,a,n,r){c("serie/"+e+"/"+t,a,n,r)}},Cfdi:{Get:function(e,a){return t("cfdi",e,a)},List:function(t,a){return function(t,a,n){return fc.a.get(e.url+t+a,void 0,n,"json")}("cfdi",t,a)},Create:function(e,t,a){n("2/cfdis",e,t,a)},Send:function(t,a){!function(t,a,n){fc.a.ajax({url:e.url+t+a,type:"POST",async:!1,success:n})}("cfdi",t,a)},Cancel:function(e,t,a){r("cfdi",e,t,a)},Download:function(e,a,n,c){t("cfdi/"+e+"/"+a,n,c)},Acuse:function(e,a,n,c){t("acuse/"+e+"/"+a,n,c)}},TaxEntity:{Get:function(e){return a("taxEntity",e)},Update:function(e,t,a){c("taxEntity",e,t,a)},UploadCsd:function(e,t,a){c("taxEntity/UploadCsd",e,t,a)},UploadImage:function(e,t,a){c("taxEntity/UploadLogo",e,t,a)}},Catalogs:{States:function(e,t){return a("catalogs/municipalities?countryCode"+e,t)},Municipalities:function(e,t){return a("catalogs/municipalities?stateCode"+e,t)},Localities:function(e,t){return a("catalogs/localities?stateCode"+e,t)},Neighborhoods:function(e,t){return a("catalogs/neighborhoods?postalCode"+e,t)},ProductsOrServices:function(e,t){return a("catalogs/ProductsOrServices?keyword="+e,t)},PostalCodes:function(e,t){return a("catalogs/PostalCodes?keyword="+e,t)},Units:function(e){return a("catalogs/Units",e)},Currencies:function(e){return a("catalogs/Currencies",e)},Countries:function(e){return a("catalogs/Countries",e)},PaymentForms:function(e){return a("catalogs/PaymentForms",e)},PaymentMethods:function(e){return a("catalogs/PaymentMethods",e)},FederalTaxes:function(e){return a("catalogs/FederalTaxes",e)},FiscalRegimens:function(e){return a("catalogs/FiscalRegimens",e)},CfdiTypes:function(e){return a("catalogs/CfdiTypes",e)},RelationTypes:function(e){return a("catalogs/RelationTypes",e)},CfdiUses:function(e,t){return a("catalogs/CfdiUses?keyword="+e,t)}},getToken:function(){return"Basic "+gc},getBaseUri:function(){return e.url}};return i}(),wc=Object(z.d)(vc||(vc=Object(F.a)(["\n  mutation crearCodigoProducto($input: CodigoCatalogoProductoInput) {\n    crearCodigoProducto(input: $input) {\n      message\n    }\n  }\n"]))),Ic=(Object(z.d)(Cc||(Cc=Object(F.a)(["\n  query obtenerCodigosProducto($empresa: ID!, $sucursal: ID) {\n    obtenerCodigosProducto(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      Name\n      Value\n      empresa {\n        _id\n        nombre_empresa\n      }\n      sucursal {\n        _id\n        nombre_sucursal\n      }\n    }\n  }\n"]))),Object(z.d)(yc||(yc=Object(F.a)(["\n  mutation eliminarCodigoProducto($id: ID!) {\n    eliminarCodigoProducto(id: $id) {\n      message\n    }\n  }\n"])))),kc=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),Nc=Object(k.a)((function(e){return{root:{width:"100%",backgroundColor:e.palette.background.paper}}}));function Fc(e){var t=e.codigos,a=e.refetch,n=Nc(),c=JSON.parse(localStorage.getItem("sesionCafi")),r=l.a.useState(!1),i=Object(v.a)(r,2),o=i[0],d=i[1],j=Object(s.useContext)(xe),p=j.datos_generales,m=j.setDatosGenerales,O=Object(s.useState)(""),x=Object(v.a)(O,2),h=x[0],f=x[1],C=Object(s.useState)([]),k=Object(v.a)(C,2),F=k[0],z=k[1],P=Object(s.useState)(!1),D=Object(v.a)(P,2),E=D[0],A=D[1],T=Object(s.useState)(!1),W=Object(v.a)(T,2),R=W[0],$=W[1],M=Object(s.useState)(!1),L=Object(v.a)(M,2),U=L[0],J=L[1],G=Object(s.useState)({}),q=Object(v.a)(G,2),H=q[0],K=q[1],Q=Object(s.useState)(""),Z=Object(v.a)(Q,2),ee=Z[0],te=Z[1],ae=Object(s.useState)({message:"",status:"",open:!1}),ne=Object(v.a)(ae,2),ce=ne[0],re=ne[1],ie=Object(N.a)(wc),oe=Object(v.a)(ie,1)[0],se=Object(N.a)(Ic),le=Object(v.a)(se,1)[0],de=function(){K({}),z([]),f(""),d(!1)},je=function(){var e=Object(_.a)(g.a.mark((function e(){var t,n,r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=H.Name,n=H.Value,m(Object(u.a)(Object(u.a)({},p),{},{clave_producto_sat:{Name:t,Value:n}})),e.prev=2,$(!0),e.next=6,oe({variables:{input:{Name:t,Value:n,empresa:c.empresa._id,sucursal:c.sucursal._id}}});case 6:(r=e.sent)&&(i=r.data.crearCodigoProducto.message,re({message:i,status:"success",open:!0}),$(!1),a(),de()),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),$(!1),re({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}(),ue=function(){var e=Object(_.a)(g.a.mark((function e(t){var n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,J(!0),e.next=4,le({variables:{id:t._id}});case 4:(n=e.sent)&&(c=n.data.eliminarCodigoProducto.message,re({message:c,status:"success",open:!0}),m(Object(u.a)(Object(u.a)({},p),{},{clave_producto_sat:{Name:"",Value:""}})),J(!1),a()),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),J(!1),re({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),be=function(){de()},pe=function(){var e=Object(_.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),h){e.next=4;break}return z([]),e.abrupt("return");case 4:return A(!0),e.prev=5,e.next=8,Sc.Catalogs.ProductsOrServices(h,(function(e){z(e),A(!1)}),(function(e){e&&e.responseJSON&&te(e.responseJSON),A(!1)}));case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(5),e.t0&&e.t0.responseJSON&&te(e.t0.responseJSON.Message),A(!1);case 14:case"end":return e.stop()}}),e,null,[[5,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{children:[Object(V.jsx)(B,{alert:ce,setAlert:re}),Object(V.jsx)(y.a,{children:"Clave de producto SAT"}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(ta.a,{id:"catalogos-bd-productos",size:"small",options:t,disabled:U,getOptionLabel:function(e){return e.Name?"".concat(e.Value," - ").concat(e.Name):""},fullWidth:!0,renderInput:function(e){return Object(V.jsx)(S.a,Object(u.a)(Object(u.a)({},e),{},{variant:"outlined",InputProps:Object(u.a)(Object(u.a)({},e.InputProps),{},{endAdornment:Object(V.jsxs)(s.Fragment,{children:[U?Object(V.jsx)(I.a,{size:20}):null,e.InputProps.endAdornment]})})}))},renderOption:function(e){return Object(V.jsxs)(s.Fragment,{children:["".concat(e.Value," - ").concat(e.Name),Object(V.jsx)("div",{style:{flexGrow:1}}),Object(V.jsx)(X.a,{size:"small",onClick:function(){return ue(e)},children:Object(V.jsx)(zt.a,{})})]})},onChange:function(e,t){return function(e){if(!e)return m(Object(u.a)(Object(u.a)({},p),{},{clave_producto_sat:{Name:"",Value:""}})),null;m(Object(u.a)(Object(u.a)({},p),{},{clave_producto_sat:{Name:e.Name,Value:e.Value}}))}(t)},getOptionSelected:function(e,t){return e.Value===t.Value},value:p.clave_producto_sat}),Object(V.jsx)(w.a,{color:"primary",onClick:function(){return d(!0)},children:Object(V.jsx)(xc.a,{})})]}),Object(V.jsxs)(ze.a,{open:o,TransitionComponent:kc,keepMounted:!0,onClose:be,"aria-labelledby":"alert-dialog-clave-producto",fullWidth:!0,maxWidth:"sm",children:[Object(V.jsx)(wt.a,{id:"alert-dialog-clave-producto",children:"Catalogo de productos y servicios SAT"}),Object(V.jsxs)(Pe.a,{style:{height:"50vh"},children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("form",{onSubmit:pe,children:Object(V.jsx)(S.a,{variant:"outlined",label:"producto, servicio o giro de la empresa",fullWidth:!0,size:"small",onChange:function(e){f(e.target.value),te("")},value:h,InputProps:{endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(X.a,{size:"small",onClick:pe,children:Object(V.jsx)(xc.a,{})})})},error:!!ee,helperText:ee||""})})}),Object(V.jsx)(b.a,{my:3,className:n.root,children:E?Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"25vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsx)(pc.a,{dense:!0,component:"nav","aria-label":"main mailbox folders",children:F.map((function(e,t){return Object(V.jsx)(Gc,{producto:e,busqueda:h,selectedIndex:H,setSelectedIndex:K},t)}))})})]}),Object(V.jsxs)(We.a,{style:{justifyContent:"center"},children:[Object(V.jsx)(w.a,{onClick:function(){return be()},children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){return je()},color:"primary",disabled:R,startIcon:R?Object(V.jsx)(I.a,{size:18}):Object(V.jsx)(Pt.a,{}),children:"Seleccionar"})]})]})]})}var zc,Pc,Dc,Ec,Ac,Tc,Wc,Rc,$c,Mc,Lc,Vc,Uc,Bc,Jc,Gc=function(e){var t=e.producto,a=e.busqueda,n=e.selectedIndex,c=e.setSelectedIndex,r=a.includes("potacio");return"0"!==t.Value||r?Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(mc.a,{button:!0,selected:n.Value===t.Value,onClick:function(){c(t)},children:Object(V.jsx)(Oc.a,{primary:"".concat(t.Value," - ").concat(t.Name)})}),Object(V.jsx)(Te.a,{})]}):null},qc=Object(z.d)(zc||(zc=Object(F.a)(["\n\tmutation crearCategoria($input: CrearCategoriasInput) {\n\t\tcrearCategoria(input: $input) {\n\t\t\t_id\n\t\t\tcategoria\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t}\n\t}\n"]))),Hc=Object(z.d)(Pc||(Pc=Object(F.a)(["\n\tmutation crearSubcategoria($idCategoria: ID!, $input: CrearSubcategoriasInput) {\n\t\tcrearSubcategoria(idCategoria: $idCategoria, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Yc=Object(z.d)(Dc||(Dc=Object(F.a)(["\n\tmutation actualizarCategoria($idCategoria: ID!, $input: ActualizarCategoriasInput) {\n\t\tactualizarCategoria(idCategoria: $idCategoria, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Xc=Object(z.d)(Ec||(Ec=Object(F.a)(["\n\tmutation actualizarSubcategoria($idCategoria: ID!, $idSubcategoria: ID!, $input: ActualizarSubcategoriasInput) {\n\t\tactualizarSubcategoria(idCategoria: $idCategoria, idSubcategoria: $idSubcategoria, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Kc=Object(z.d)(Ac||(Ac=Object(F.a)(["\n\tquery obtenerCategorias($empresa: ID!, $sucursal: ID!) {\n\t\tobtenerCategorias(empresa: $empresa, sucursal: $sucursal) {\n\t\t\t_id\n\t\t\tcategoria\n\t\t\tsubcategorias {\n\t\t\t\t_id\n\t\t\t\tsubcategoria\n\t\t\t}\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t}\n\t}\n"]))),Qc=Object(z.d)(Tc||(Tc=Object(F.a)(["\n\tmutation eliminarCategoria($idCategoria: ID!) {\n\t\teliminarCategoria(idCategoria: $idCategoria) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Zc=Object(z.d)(Wc||(Wc=Object(F.a)(["\n\tmutation eliminarSubcategoria($idCategoria: ID!, $idSubcategoria: ID!) {\n\t\teliminarSubcategoria(idCategoria: $idCategoria, idSubcategoria: $idSubcategoria) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),er=Object(z.d)(Rc||(Rc=Object(F.a)(["\n\tquery ObtenerDepartamentos($empresa: ID!, $sucursal: ID!){\n        obtenerDepartamentos(empresa: $empresa, sucursal: $sucursal){\n            _id\n            nombre_departamentos\n            empresa{\n                _id\n                nombre_empresa\n            }\n            sucursal{\n                _id\n                nombre_sucursal\n            }\n        }\n    }\n"]))),tr=Object(z.d)($c||($c=Object(F.a)(["\n\tmutation CrearDepartamentos($input: DepartamentosInput, $empresa: ID!, $sucursal: ID!){\n        crearDepartamentos(input: $input, empresa: $empresa, sucursal: $sucursal){\n            message\n        }\n    }\n"]))),ar=Object(z.d)(Mc||(Mc=Object(F.a)(["\n\tmutation ActualzarDepartamentos($input: DepartamentosInput, $id: ID!){\n        actualzarDepartamentos(input: $input, id: $id){\n            message\n        }\n    }\n"]))),nr=Object(z.d)(Lc||(Lc=Object(F.a)(["\n    mutation EliminarDepartamento($id: ID!){\n        eliminarDepartamento(id: $id){\n            message\n        }\n    }\n\t\n"]))),cr=Object(z.d)(Vc||(Vc=Object(F.a)(["\n    query ObtenerMarcas($empresa: ID!, $sucursal: ID!){\n        obtenerMarcas(empresa: $empresa, sucursal: $sucursal){\n            _id\n            nombre_marca\n        }\n    }\n"]))),rr=Object(z.d)(Uc||(Uc=Object(F.a)(["\n    mutation CrearMarca($input: MarcasInput!, $empresa: ID!, $sucursal: ID!){\n        crearMarcas(input: $input, empresa: $empresa, sucursal: $sucursal ){\n            message\n        }\n    }\n"]))),ir=Object(z.d)(Bc||(Bc=Object(F.a)(["\n    mutation actualzarMarcas($input: MarcasInput, $id: ID! ) {\n\t\tactualzarMarcas(id: $id, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),or=Object(z.d)(Jc||(Jc=Object(F.a)(["\n\tmutation eliminarMarca($id: ID!, $empresa: ID!, $sucursal: ID!) {\n\t\teliminarMarca(id: $id, empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),sr=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},obligatorio:{color:"red"}}}));function lr(e){var t=e.obtenerConsultasProducto,a=e.refetch,n=sr(),c=Object(s.useContext)(xe),r=c.datos_generales,i=c.setDatosGenerales,o=c.validacion,l=c.precios,d=c.setPrecios,j=c.centro_de_costos,p=c.setSubcostos,m=Object(s.useContext)(xe),O=m.subcategorias,x=m.setSubcategorias,f=m.unidadVentaXDefecto,g=m.setUnidadVentaXDefecto,_=m.update,v=t.categorias,w=t.departamentos,I=t.marcas,k=t.centro_costos,N=t.codigos,F=function(e){if("monedero_electronico"===e.target.name)return e.target.value?void d(Object(u.a)(Object(u.a)({},l),{},Object(h.a)({},e.target.name,parseFloat(e.target.value)))):void d(Object(u.a)(Object(u.a)({},l),{},Object(h.a)({},e.target.name,"")));"codigo_barras"===e.target.name&&g(Object(u.a)(Object(u.a)({},f),{},{codigo_barras:e.target.value})),i(Object(u.a)(Object(u.a)({},r),{},Object(h.a)({},e.target.name,e.target.value)))},z=function(e){var t,a;"monedero"===e.target.name&&e.target.checked?d(Object(u.a)(Object(u.a)({},l),{},{monedero_electronico:1,monedero:e.target.checked})):"granel"===e.target.name&&e.target.checked?(d(Object(u.a)(Object(u.a)({},l),{},(t={},Object(h.a)(t,e.target.name,e.target.checked),Object(h.a)(t,"inventario",Object(u.a)(Object(u.a)({},l.inventario),{},{unidad_de_inventario:"Kg",codigo_unidad:"KGM"})),Object(h.a)(t,"unidad_de_compra",Object(u.a)(Object(u.a)({},l.unidad_de_compra),{},{unidad:"Kg",codigo_unidad:"KGM"})),t))),g(Object(u.a)(Object(u.a)({},f),{},{unidad:"Kg",codigo_unidad:"KGM"}))):(d(Object(u.a)(Object(u.a)({},l),{},(a={},Object(h.a)(a,e.target.name,e.target.checked),Object(h.a)(a,"inventario",Object(u.a)(Object(u.a)({},l.inventario),{},{unidad_de_inventario:"Pz",codigo_unidad:"H87"})),Object(h.a)(a,"unidad_de_compra",Object(u.a)(Object(u.a)({},l.unidad_de_compra),{},{unidad:"Pz",codigo_unidad:"H87"})),a))),g(Object(u.a)(Object(u.a)({},f),{},{unidad:"Pz",codigo_unidad:"H87"})))},P=function(e,t){var a;if(i(Object(u.a)(Object(u.a)({},r),{},(a={},Object(h.a)(a,e.target.name,e.target.value),Object(h.a)(a,t.props.name,t.props.id),a))),t.props.categoria){var n=t.props.categoria.subcategorias;x(n)}};return Object(s.useEffect)((function(){if(_){var e=v.filter((function(e){return e._id===r.id_categoria})),t=k.filter((function(e){return e._id===j.id_cuenta}));e.length>0&&x(e[0].subcategorias),t.length>0&&p(t[0].subcuentas)}}),[_]),Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(C.a,{maxWidth:"lg",children:[Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsx)(Fe.a,{item:!0,md:3,xs:12,children:Object(V.jsxs)(G.a,{variant:"outlined",size:"small",name:"codigo_barras",fullWidth:!0,children:[Object(V.jsx)(y.a,{children:"C\xf3digo de barras"}),Object(V.jsx)(H.a,{disabled:_&&r.codigo_barras,style:{padding:0},id:"form-producto-codigo-barras",name:"codigo_barras",value:r.codigo_barras?r.codigo_barras:"",onChange:F,endAdornment:Object(V.jsx)(Y.a,{position:"start",children:Object(V.jsx)(X.a,{disabled:_&&r.codigo_barras,onClick:function(){return function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();i(Object(u.a)(Object(u.a)({},r),{},{codigo_barras:t})),g(Object(u.a)(Object(u.a)({},f),{},{codigo_barras:t}))}()},color:"primary",size:"small",children:Object(V.jsx)(bc.a,{})})})})]})}),Object(V.jsxs)(Fe.a,{item:!0,md:2,xs:12,children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:n.obligatorio,children:"* "}),"Clave alterna"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:o.error&&!r.clave_alterna,name:"clave_alterna",id:"form-producto-clave-alterna",variant:"outlined",value:r.clave_alterna?r.clave_alterna:"",helperText:o.message,onChange:F})]}),Object(V.jsxs)(Fe.a,{item:!0,md:2,xs:12,children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:n.obligatorio,children:"* "}),"Tipo de producto"]}),Object(V.jsxs)(G.a,{variant:"outlined",fullWidth:!0,size:"small",error:o.error&&!r.tipo_producto,children:[Object(V.jsxs)(De.a,{id:"form-producto-tipo",name:"tipo_producto",value:r.tipo_producto?r.tipo_producto:"",onChange:F,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),Object(V.jsx)(Ee.a,{value:"ROPA",children:"Ropa"}),Object(V.jsx)(Ee.a,{value:"CALZADO",children:"Calzado"}),Object(V.jsx)(Ee.a,{value:"OTROS",children:"Otros"})]}),Object(V.jsx)(ca.a,{children:o.message})]})]}),Object(V.jsx)(Fe.a,{item:!0,md:5,xs:12,children:Object(V.jsx)(Fc,{codigos:N,refetch:a})}),Object(V.jsxs)(Fe.a,{item:!0,md:4,xs:12,children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:n.obligatorio,children:"* "}),"Nombre comercial"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:o.error&&!r.nombre_comercial,name:"nombre_comercial",id:"form-producto-nombre-comercial",variant:"outlined",value:r.nombre_comercial?r.nombre_comercial:"",helperText:o.message,onChange:F})]}),Object(V.jsxs)(Fe.a,{item:!0,md:4,xs:12,children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:n.obligatorio,children:"* "}),"Nombre gen\xe9rico"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:o.error&&!r.nombre_generico,name:"nombre_generico",id:"form-producto-nombre-generico",variant:"outlined",value:r.nombre_generico?r.nombre_generico:"",helperText:o.message,onChange:F})]}),Object(V.jsxs)(Fe.a,{item:!0,md:4,xs:12,children:[Object(V.jsx)(y.a,{children:"Descripci\xf3n"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"descripcion",id:"form-producto-descripcion",variant:"outlined",value:r.descripcion?r.descripcion:"",onChange:F})]}),Object(V.jsxs)(Fe.a,{item:!0,md:6,xs:12,children:[Object(V.jsx)(y.a,{children:"Categoria"}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"form-producto-categoria",value:r.categoria?r.categoria:"",onChange:function(e,t){return P(e,t)},name:"categoria",children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Seleccione uno"})}),v?v.map((function(e){return Object(V.jsx)(Ee.a,{name:"id_categoria",value:e.categoria,id:e._id,categoria:e,children:e.categoria},e._id)})):Object(V.jsx)(Ee.a,{value:""})]})}),Object(V.jsx)(dr,{tipo:"categoria",name:"categoria",refetch:a})]})]}),Object(V.jsxs)(Fe.a,{item:!0,md:6,xs:12,children:[Object(V.jsx)(y.a,{children:"Subcategoria"}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"form-producto-subcategoria",name:"subcategoria",value:r.subcategoria?r.subcategoria:"",onChange:function(e,t){return P(e,t)},children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Seleccione uno"})}),O?O.map((function(e){return Object(V.jsx)(Ee.a,{name:"id_subcategoria",value:e.subcategoria,id:e._id,children:e.subcategoria},e._id)})):Object(V.jsx)(Ee.a,{value:""})]})}),Object(V.jsx)(dr,{tipo:"subcategoria",name:"subcategoria",refetch:a,subcategorias:O,setSubcategorias:x})]})]}),Object(V.jsxs)(Fe.a,{item:!0,md:6,xs:12,children:[Object(V.jsx)(y.a,{children:"Departamento"}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"form-producto-departamento",name:"departamento",value:r.departamento?r.departamento:"",onChange:function(e,t){return P(e,t)},children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Seleccione uno"})}),w?w.map((function(e){return Object(V.jsx)(Ee.a,{name:"id_departamento",value:e.nombre_departamentos,id:e._id,children:e.nombre_departamentos},e._id)})):Object(V.jsx)(Ee.a,{value:""})]})}),Object(V.jsx)(dr,{tipo:"departamento",name:"nombre_departamentos",refetch:a})]})]}),Object(V.jsxs)(Fe.a,{item:!0,md:6,xs:12,children:[Object(V.jsx)(y.a,{children:"Marca"}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"form-producto-marca",name:"marca",value:r.marca?r.marca:"",onChange:function(e,t){return P(e,t)},children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Seleccione uno"})}),I?I.map((function(e){return Object(V.jsx)(Ee.a,{name:"id_marca",value:e.nombre_marca,id:e._id,children:e.nombre_marca},e._id)})):Object(V.jsx)(Ee.a,{value:""})]})}),Object(V.jsx)(dr,{tipo:"marca",name:"nombre_marca",refetch:a})]})]})]}),Object(V.jsx)(b.a,{display:"flex",mt:4,children:Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,md:3,xs:12,children:_?null:Object(V.jsxs)(b.a,{children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Granel"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsx)("div",{className:n.formInput,children:Object(V.jsx)(aa.a,{control:Object(V.jsx)(na.a,{checked:!!l.granel&&l.granel,onChange:z,name:"granel"}),label:"Vender a granel"})})]})}),Object(V.jsxs)(Fe.a,{item:!0,md:3,xs:12,children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Farmacia"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsx)("div",{className:n.formInput,children:Object(V.jsx)(aa.a,{control:Object(V.jsx)(na.a,{checked:!!r.receta_farmacia&&r.receta_farmacia,onChange:function(e){i(Object(u.a)(Object(u.a)({},r),{},{receta_farmacia:e.target.checked}))},name:"receta_farmacia"}),label:"Necesita receta",name:"receta_farmacia"})})]}),Object(V.jsxs)(Fe.a,{item:!0,md:6,xs:12,children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Monedero el\xe9ctronico"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsx)(b.a,{children:Object(V.jsxs)(b.a,{className:n.formInput,children:[Object(V.jsx)(aa.a,{control:Object(V.jsx)(na.a,{checked:l.monedero,onChange:z,name:"monedero"}),label:"Monedero electr\xf3nico"}),Object(V.jsx)(S.a,{type:"number",InputProps:{inputProps:{min:0}},size:"small",label:"Valor por punto",name:"monedero_electronico",id:"form-producto-monedero_electronico",variant:"outlined",value:l.monedero_electronico,onChange:F,disabled:!l.monedero,onBlur:function(){l.monedero_electronico||d(Object(u.a)(Object(u.a)({},l),{},{monedero_electronico:1}))},error:""===l.monedero_electronico})]})})]})]})})]})})}var dr=function(e){var t=e.tipo,a=e.name,n=e.refetch,c=e.subcategorias,r=e.setSubcategorias,i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(!1),b=Object(v.a)(j,2),p=b[0],m=b[1],O=Object(s.useState)(!1),x=Object(v.a)(O,2),f=x[0],C=x[1],y=Object(s.useState)(""),k=Object(v.a)(y,2),F=k[0],z=k[1],P=JSON.parse(localStorage.getItem("sesionCafi")),D=Object(s.useContext)(xe),E=D.datos_generales,A=D.setDatosGenerales,T=Object(s.useState)({message:"",status:"",open:!1}),W=Object(v.a)(T,2),R=W[0],$=W[1],M=Object(N.a)(qc),L=Object(v.a)(M,1)[0],U=Object(N.a)(Hc),J=Object(v.a)(U,1)[0],G=Object(N.a)(tr),q=Object(v.a)(G,1)[0],H=Object(N.a)(rr),Y=Object(v.a)(H,1)[0],X=function(){d(!l)},K=function(){var e=Object(_.a)(g.a.mark((function e(i){var o,s,l,d,j,b,p,O,x,f;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.preventDefault(),F){e.next=4;break}return m(!0),e.abrupt("return");case 4:o={input:Object(h.a)({},a,F),empresa:P.empresa._id,sucursal:P.sucursal._id},"categoria"===t&&(o={input:(s={},Object(h.a)(s,a,F),Object(h.a)(s,"empresa",P.empresa._id),Object(h.a)(s,"sucursal",P.sucursal._id),s)}),"subcategoria"===t&&(o={input:Object(h.a)({},a,F),idCategoria:E.id_categoria}),C(!0),e.prev=8,e.t0=t,e.next="categoria"===e.t0?12:"subcategoria"===e.t0?19:"departamento"===e.t0?27:"marca"===e.t0?34:41;break;case 12:return e.next=14,L({variables:o});case 14:return l=e.sent,n(),d=l.data.crearCategoria._id,A(Object(u.a)(Object(u.a)({},E),{},{categoria:F,id_categoria:d})),e.abrupt("break",42);case 19:return e.next=21,J({variables:o});case 21:return j=e.sent,n(),b=j.data.crearSubcategoria.message,r([].concat(Object(ea.a)(c),[{_id:b,subcategoria:F}])),A(Object(u.a)(Object(u.a)({},E),{},{subcategoria:F,id_subcategoria:b})),e.abrupt("break",42);case 27:return e.next=29,q({variables:o});case 29:return p=e.sent,n(),O=p.data.crearDepartamentos.message,A(Object(u.a)(Object(u.a)({},E),{},{departamento:F,id_departamento:O})),e.abrupt("break",42);case 34:return e.next=36,Y({variables:o});case 36:return x=e.sent,n(),f=x.data.crearMarcas.message,A(Object(u.a)(Object(u.a)({},E),{},{marca:F,id_marca:f})),e.abrupt("break",42);case 41:return e.abrupt("break",42);case 42:$({message:"\xa1Listo!",status:"success",open:!0}),C(!1),X(),e.next=51;break;case 47:e.prev=47,e.t1=e.catch(8),$({message:"Hubo un error",status:"error",open:!0}),C(!1);case 51:case"end":return e.stop()}}),e,null,[[8,47]])})));return function(t){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(w.a,{color:"primary",onClick:function(){return X()},disabled:"subcategoria"===t&&!E.id_categoria,children:Object(V.jsx)(It.a,{})}),Object(V.jsxs)(ze.a,{open:l,onClose:X,"aria-labelledby":"modal-title-".concat(t),children:[Object(V.jsx)(B,{alert:R,setAlert:$}),Object(V.jsxs)(wt.a,{id:"modal-title-".concat(t),children:["Registrar ",t]}),Object(V.jsx)(Pe.a,{children:Object(V.jsx)("form",{id:"registro-".concat(a),onSubmit:function(e){return K(e)},children:Object(V.jsx)(S.a,{error:p,name:a,autoFocus:!0,label:t,fullWidth:!0,variant:"outlined",onChange:function(e){z(e.target.value)},helperText:p?"Campo obligatorio":""})})}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:function(){return X()},color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{form:"registro-".concat(a),type:"submit",variant:"contained",color:"primary",endIcon:f?Object(V.jsx)(I.a,{color:"inherit",size:18}):null,children:"Guardar"})]})]})]})},jr=a(880),ur=a(881),br=a(454),pr=a.n(br),mr=Object(k.a)((function(e){return{formInputFlex:{display:"flex",width:"100%","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(0),"px ").concat(e.spacing(1),"px")},input:{display:"none"},imagen:{maxHeight:"100%",maxWidth:"100%"}}}));function Or(){var e=mr(),t=Object(s.useContext)(xe),a=t.imagenes,n=t.setImagenes,c=t.setOnPreview,r=t.onPreview,i=a.map((function(e,t){return Object(V.jsx)(yr,{index:t,imagen:e},t)}));return Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsxs)(Fe.a,{item:!0,md:6,children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)("input",{accept:"image/*",className:e.input,id:"contained-button-file",type:"file",onChange:function(e){var t=e.target.files;e.target.files.length<1||(n([].concat(Object(ea.a)(a),[t[0]])),c({image:URL.createObjectURL(t[0])}))}}),Object(V.jsx)("label",{htmlFor:"contained-button-file",children:Object(V.jsx)(w.a,{variant:"text",color:"primary",component:"span",startIcon:Object(V.jsx)(jr.a,{}),children:"Cargar imagen"})})]}),i]}),Object(V.jsx)(Fe.a,{item:!0,md:6,children:Object(V.jsxs)(b.a,{display:"flex",minHeight:300,children:[Object(V.jsx)(b.a,{mx:1,children:Object(V.jsx)(Te.a,{orientation:"vertical"})}),Object(V.jsx)(b.a,{width:"100%",height:"50vh",display:"flex",justifyContent:"center",alignItems:"center",children:r.image?Object(V.jsx)("img",{alt:"img-onPreview",src:r.image,className:e.imagen}):Object(V.jsx)(pr.a,{style:{fontSize:150}})})]})})]})})}var xr,hr,fr,gr,_r,vr,Cr,yr=function(e){var t=e.imagen,a=e.index,n=mr(),c=t.key_imagen?t.url_imagen:URL.createObjectURL(t),r=Object(s.useContext)(xe),i=r.imagenes,o=r.setImagenes,l=r.setOnPreview,d=r.onPreview,j=r.imagenes_eliminadas,u=r.setImagenesEliminadas,p=Object(s.useState)(!1),m=Object(v.a)(p,2),O=m[0],x=m[1],h=function(){return x(!O)};return Object(V.jsxs)(b.a,{my:2,mr:5,children:[Object(V.jsxs)(b.a,{className:n.formInputFlex,children:[Object(V.jsx)(b.a,{height:70,width:70,children:Object(V.jsx)("img",{alt:"producto-img-prev",src:c,width:"100%"})}),Object(V.jsxs)(b.a,{width:"90%",children:[Object(V.jsx)(y.a,{noWrap:!0,children:t.key_imagen?t.key_imagen:t.name}),t.key_imagen?null:Object(V.jsxs)(y.a,{variant:"caption",children:[t.size," bits"]}),Object(V.jsxs)(b.a,{display:"flex",justifyContent:"flex-end",children:[Object(V.jsx)(w.a,{size:"small",startIcon:Object(V.jsx)(Nt.a,{}),onClick:function(){return l({index:a,image:c})},children:"previsualizar"}),Object(V.jsx)(b.a,{mx:1}),Object(V.jsx)(Sr,{handleModal:h,open:O,eliminarImagen:function(){t.key_imagen&&u([].concat(Object(ea.a)(j),[t])),d.index===a&&l({index:"",image:""});var e=Object(ea.a)(i);e.splice(a,1),o(Object(ea.a)(e)),h()}})]})]})]}),Object(V.jsx)(Te.a,{})]})},Sr=function(e){var t=e.handleModal,a=e.open,n=e.eliminarImagen;return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{size:"small",color:"secondary",startIcon:Object(V.jsx)(ur.a,{}),onClick:function(){return t()},children:"eliminar"}),Object(V.jsxs)(ze.a,{open:a,onClose:t,children:[Object(V.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:function(){return t()},color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:function(){return n()},children:"Eliminar"})]})]})]})},wr=a(477),Ir=a(475),kr=a(80),Nr=a(919),Fr=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}}));function zr(e){var t=e.obtenerConsultasProducto,a=e.refetch,n=Fr(),c=Object(s.useContext)(xe),r=c.datos_generales,i=c.precios,o=c.setPrecios,l=c.almacen_inicial,d=c.setAlmacenInicial,j=c.selectedDate,p=c.setSelectedDate,m=c.update,O=t.almacenes,x=function(e,t){if(e.target.value)if("unidad_de_inventario"!==e.target.name)o(Object(u.a)(Object(u.a)({},i),{},{inventario:Object(u.a)(Object(u.a)({},i.inventario),{},Object(h.a)({},e.target.name,parseFloat(e.target.value)))}));else{var a,n=t.props.unidad,c=n.codigo_unidad,r=n.unidad;o(Object(u.a)(Object(u.a)({},i),{},{inventario:Object(u.a)(Object(u.a)({},i.inventario),{},(a={},Object(h.a)(a,e.target.name,r),Object(h.a)(a,"codigo_unidad",c),a))}))}else o(Object(u.a)(Object(u.a)({},i),{},{inventario:Object(u.a)(Object(u.a)({},i.inventario),{},Object(h.a)({},e.target.name,""))}))},f=function(e,t,a){"inventario"===e?a||o(Object(u.a)(Object(u.a)({},i),{},{inventario:Object(u.a)(Object(u.a)({},i.inventario),{},Object(h.a)({},t,0))})):a||d(Object(u.a)(Object(u.a)({},l),{},Object(h.a)({},t,0)))};return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(b.a,{mt:3,children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Inventario"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)(b.a,{className:n.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"150px",children:[Object(V.jsx)(y.a,{children:"Inventario m\xednimo"}),Object(V.jsx)(S.a,{type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"inventario_minimo",id:"form-producto-inventario_minimo",variant:"outlined",value:i.inventario.inventario_minimo,onChange:x,onBlur:function(){return f("inventario","inventario_minimo",i.inventario.inventario_minimo)},error:""===i.inventario.inventario_minimo})]}),Object(V.jsxs)(b.a,{width:"150px",children:[Object(V.jsx)(y.a,{children:"Inventario m\xe1ximo"}),Object(V.jsx)(S.a,{type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"inventario_maximo",id:"form-producto-inventario_maximo",variant:"outlined",value:i.inventario.inventario_maximo,onChange:x,onBlur:function(){return f("inventario","inventario_maximo",i.inventario.inventario_maximo)},error:""===i.inventario.inventario_maximo})]}),Object(V.jsxs)(b.a,{width:"150px",children:[Object(V.jsx)(y.a,{children:"Unidad de inventario"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"unidad_de_inventario",children:i.granel?Object(V.jsx)(De.a,{name:"unidad_de_inventario",value:i.inventario.unidad_de_inventario,onChange:x,children:ba.map((function(e,t){return Object(V.jsx)(Ee.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))}):Object(V.jsx)(De.a,{name:"unidad_de_inventario",value:i.inventario.unidad_de_inventario,onChange:x,children:ua.map((function(e,t){return Object(V.jsx)(Ee.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))})})})]})]}),m?null:"OTROS"===r.tipo_producto?Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(b.a,{mt:3,children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Almacen incial"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)("div",{className:n.formInputFlex,style:{alignItems:"center"},children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:["Cantidad inicial en ",Object(V.jsx)("b",{children:i.unidad_de_compra.unidad})]}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsx)(S.a,{fullWidth:!0,type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"cantidad",variant:"outlined",value:l.cantidad,onChange:function(e){e.target.value?"almacen"!==e.target.name?d(Object(u.a)(Object(u.a)({},l),{},Object(h.a)({},e.target.name,parseFloat(e.target.value)))):d(Object(u.a)(Object(u.a)({},l),{},Object(h.a)({},e.target.name,e.target.value))):d(Object(u.a)(Object(u.a)({},l),{},Object(h.a)({},e.target.name,"")))},onBlur:function(){return f("almacen","cantidad",l.cantidad)},error:""===l.cantidad})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Almacen"}),Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"almacen",error:l.cantidad>0&&!l.almacen,children:Object(V.jsxs)(De.a,{name:"almacen",value:l.almacen,onChange:function(e,t){var a;d(Object(u.a)(Object(u.a)({},l),{},(a={},Object(h.a)(a,e.target.name,e.target.value),Object(h.a)(a,t.props.name,t.props.id),a)))},children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Seleccione uno"})}),O?O.map((function(e){return Object(V.jsx)(Ee.a,{name:"id_almacen",value:e.nombre_almacen,id:e._id,children:e.nombre_almacen},e._id)})):Object(V.jsx)(Ee.a,{value:""})]})}),Object(V.jsx)(yn,{children:Object(V.jsx)($n,{accion:"registrar",refetch:a})})]})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha de expiraci\xf3n"}),Object(V.jsx)(kr.a,{utils:Ir.a,locale:wr.a,children:Object(V.jsx)(Fe.a,{container:!0,justify:"space-around",children:Object(V.jsx)(Nr.a,{margin:"dense",id:"date-picker-dialog",placeholder:"ex: DD/MM/AAAA",format:"dd/MM/yyyy",value:j,onChange:function(e){p(e),d(Object(u.a)(Object(u.a)({},l),{},{fecha_de_expiracion:e}))},KeyboardButtonProps:{"aria-label":"change date"}})})})]})]})]}):null]})}function Pr(e,t,a,n){return e.clave_alterna&&e.tipo_producto&&e.nombre_generico&&e.nombre_comercial?t.precio_de_compra.precio_con_impuesto&&t.precio_de_compra.precio_sin_impuesto&&t.unidad_de_compra.cantidad?e.clave_alterna&&e.tipo_producto&&e.nombre_generico&&e.nombre_comercial?a.cantidad>0&&!a.almacen&&"OTROS"===e.tipo_producto?(console.log("si hay cantidad almacen pero no hay almacen seleccionado"),{error:!0,message:"Campo obligatorio",vista3:!0}):{error:!1,message:""}:{error:!0,message:"Campo obligatorio",vista1:!0}:{error:!0,message:"Campo obligatorio",vista2:!0}:t.precio_de_compra.precio_con_impuesto&&t.precio_de_compra.precio_sin_impuesto&&t.unidad_de_compra.cantidad?{error:!0,message:"Campo obligatorio",vista1:!0}:{error:!0,message:"Campo obligatorio",vista1:!0,vista2:!0}}var Dr=Object(z.d)(xr||(xr=Object(F.a)(["\n\tmutation crearCuenta($input: CrearCuentasInput) {\n\t\tcrearCuenta(input: $input) {\n\t\t\t_id\n\t\t\tcuenta\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t}\n\t}\n"]))),Er=Object(z.d)(hr||(hr=Object(F.a)(["\n\tmutation crearSubcuenta($idCuenta: ID!, $input: CrearSubcuentasInput) {\n\t\tcrearSubcuenta(idCuenta: $idCuenta, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Ar=Object(z.d)(fr||(fr=Object(F.a)(["\n\tmutation actualizarCuenta($idCuenta: ID!, $input: ActualizarCuentasInput) {\n\t\tactualizarCuenta(idCuenta: $idCuenta, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Tr=Object(z.d)(gr||(gr=Object(F.a)(["\n\tmutation actualizarSubcuenta($idCuenta: ID!, $idSubcuenta: ID!, $input: ActualizarSubcuentasInput) {\n\t\tactualizarSubcuenta(idCuenta: $idCuenta, idSubcuenta: $idSubcuenta, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Wr=Object(z.d)(_r||(_r=Object(F.a)(["\n\tquery obtenerCuentas($empresa: ID!, $sucursal: ID!) {\n\t\tobtenerCuentas(empresa: $empresa, sucursal: $sucursal) {\n\t\t\t_id\n\t\t\tcuenta\n\t\t\tsubcuentas {\n\t\t\t\t_id\n\t\t\t\tsubcuenta\n\t\t\t}\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t}\n\t}\n"]))),Rr=Object(z.d)(vr||(vr=Object(F.a)(["\n\tmutation eliminarCuenta($id: ID!) {\n\t\teliminarCuenta(id: $id) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),$r=Object(z.d)(Cr||(Cr=Object(F.a)(["\n\tmutation eliminarSubcuenta($idCuenta: ID!, $idSubcuenta: ID!) {\n\t\teliminarSubcuenta(idCuenta: $idCuenta, idSubcuenta: $idSubcuenta) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Mr=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}}));function Lr(e){var t=e.obtenerConsultasProducto,a=e.refetch,n=Mr(),c=Object(s.useContext)(xe),r=c.centro_de_costos,i=c.setCentroDeCostos,o=c.subcostos,l=c.setSubcostos,d=t.centro_costos,j=function(e,t){var a;if(i(Object(u.a)(Object(u.a)({},r),{},(a={},Object(h.a)(a,e.target.name,e.target.value),Object(h.a)(a,t.props.name,t.props.id),a))),t.props.costos){var n=t.props.costos.subcuentas;l(n)}};return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(b.a,{mt:3,children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Centro de costos"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)("div",{className:n.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Cuenta"}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"cuenta",children:Object(V.jsxs)(De.a,{name:"cuenta",value:r.cuenta?r.cuenta:"",onChange:j,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Seleccione uno"})}),d?d.map((function(e){return Object(V.jsx)(Ee.a,{name:"id_cuenta",value:e.cuenta,id:e._id,costos:e,children:e.cuenta},e._id)})):Object(V.jsx)(Ee.a,{value:""})]})}),Object(V.jsx)(Vr,{tipo:"cuenta",name:"cuenta",refetch:a})]})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Subcuenta"}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"subcuenta",children:Object(V.jsxs)(De.a,{name:"subcuenta",value:r.subcuenta?r.subcuenta:"",onChange:j,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Seleccione uno"})}),o?o.map((function(e){return Object(V.jsx)(Ee.a,{name:"id_subcuenta",value:e.subcuenta,id:e._id,children:e.subcuenta},e._id)})):Object(V.jsx)(Ee.a,{value:""})]})}),Object(V.jsx)(Vr,{tipo:"subcuenta",name:"subcuenta",refetch:a})]})]})]})]})}var Vr=function(e){var t=e.tipo,a=e.name,n=e.refetch,c=Object(s.useState)(!1),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)(!1),d=Object(v.a)(l,2),j=d[0],b=d[1],p=Object(s.useState)(!1),m=Object(v.a)(p,2),O=m[0],x=m[1],f=Object(s.useState)(""),C=Object(v.a)(f,2),y=C[0],k=C[1],F=JSON.parse(localStorage.getItem("sesionCafi")),z=Object(s.useContext)(xe),P=z.centro_de_costos,D=z.setCentroDeCostos,E=z.subcostos,A=z.setSubcostos,T=Object(s.useState)({message:"",status:"",open:!1}),W=Object(v.a)(T,2),R=W[0],$=W[1],M=Object(N.a)(Dr),L=Object(v.a)(M,1)[0],U=Object(N.a)(Er),J=Object(v.a)(U,1)[0],G=function(){o(!i)},q=function(){var e=Object(_.a)(g.a.mark((function e(c){var r,i,o,s,l,d;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),y){e.next=4;break}return b(!0),e.abrupt("return");case 4:i={input:(r={},Object(h.a)(r,a,y),Object(h.a)(r,"empresa",F.empresa._id),Object(h.a)(r,"sucursal",F.sucursal._id),r)},"subcuenta"===t&&(i={input:Object(h.a)({},a,y),idCuenta:P.id_cuenta}),x(!0),e.prev=7,e.t0=t,e.next="cuenta"===e.t0?11:"subcuenta"===e.t0?18:26;break;case 11:return e.next=13,L({variables:i});case 13:return o=e.sent,n(),s=o.data.crearCuenta._id,D(Object(u.a)(Object(u.a)({},P),{},{cuenta:y,id_cuenta:s})),e.abrupt("break",27);case 18:return e.next=20,J({variables:i});case 20:return l=e.sent,n(),d=l.data.crearSubcuenta._id,A([].concat(Object(ea.a)(E),[{_id:d,subcuenta:y}])),D(Object(u.a)(Object(u.a)({},P),{},{subcuenta:y,id_subcuenta:d})),e.abrupt("break",27);case 26:return e.abrupt("break",27);case 27:$({message:"\xa1Listo!",status:"success",open:!0}),x(!1),G(),e.next=36;break;case 32:e.prev=32,e.t1=e.catch(7),$({message:"Hubo un error",status:"error",open:!0}),x(!1);case 36:case"end":return e.stop()}}),e,null,[[7,32]])})));return function(t){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(w.a,{color:"primary",onClick:function(){return G()},disabled:"subcuenta"===t&&!P.id_cuenta,children:Object(V.jsx)(En.a,{})}),Object(V.jsxs)(ze.a,{open:i,onClose:G,"aria-labelledby":"modal-title-".concat(t),children:[Object(V.jsx)(B,{alert:R,setAlert:$}),Object(V.jsxs)(wt.a,{id:"modal-title-".concat(t),children:["Registrar ",t]}),Object(V.jsx)(Pe.a,{children:Object(V.jsx)("form",{id:"registro-".concat(a),onSubmit:function(e){return q(e)},children:Object(V.jsx)(S.a,{error:j,name:a,autoFocus:!0,label:t,fullWidth:!0,variant:"outlined",onChange:function(e){k(e.target.value)},helperText:j?"Campo obligatorio":""})})}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:function(){return G()},color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{form:"registro-".concat(a),type:"submit",variant:"contained",color:"primary",endIcon:O?Object(V.jsx)(I.a,{color:"inherit",size:18}):null,children:"Guardar"})]})]})]})};function Ur(e){var t=e.precios;return Object(V.jsx)(ra.a,{component:Da.a,children:Object(V.jsxs)(da.a,{"aria-label":"simple table",size:"small",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Plazo"}),Object(V.jsx)(sa.a,{children:"Precio"}),Object(V.jsx)(sa.a,{})]})}),Object(V.jsx)(la.a,{children:t.map((function(e,t){return Object(V.jsx)(Br,{precio:e,index:t},t)}))})]})})}var Br=function(e){var t=e.precio,a=e.index;return Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:t.plazo}),Object(V.jsx)(sa.a,{children:t.precio}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(Jr,{index:a,unidad:t.unidad})})]})},Jr=function(e){var t=e.index,a=e.unidad,n=Object(s.useState)(!1),c=Object(v.a)(n,2),r=c[0],i=c[1],o=Object(s.useContext)(xe),l=o.preciosPlazos,d=o.setPreciosPlazos,j=function(){i(!r)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(X.a,{color:"primary",onClick:function(){return j()},children:Object(V.jsx)(Vt.a,{color:"primary"})}),Object(V.jsxs)(ze.a,{open:r,onClose:j,children:[Object(V.jsx)(wt.a,{children:"Se eliminar\xe1 este precio"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:function(){return j()},color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){return function(){switch(a){case"Pz":l.precio_piezas.splice(t,1),d(Object(u.a)(Object(u.a)({},l),{},{precio_piezas:Object(ea.a)(l.precio_piezas)}));break;case"Caja":l.precio_cajas.splice(t,1),d(Object(u.a)(Object(u.a)({},l),{},{precio_cajas:Object(ea.a)(l.precio_cajas)}));break;case"Costal":l.precio_costales.splice(t,1),d(Object(u.a)(Object(u.a)({},l),{},{precio_costales:Object(ea.a)(l.precio_costales)}))}j()}()},color:"secondary",autoFocus:!0,children:"Eliminar"})]})]})]})},Gr=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& > .precios-box":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(3),"px")}}}}));function qr(){var e=Gr(),t=Object(s.useContext)(xe),a=t.precios,n=t.preciosPlazos,c=t.setPreciosPlazos,r=t.unidadesVenta,i=t.unidadVentaXDefecto,o=Object(s.useState)({plazo:"1",unidad:a.granel?"Costal":"Pz",codigo_unidad:a.granel?"KGM":"H87",precio:0}),l=Object(v.a)(o,2),d=l[0],j=l[1],p=function(e,t){if("precio"!==e.target.name)if("unidad"!==e.target.name)j(Object(u.a)(Object(u.a)({},d),{},Object(h.a)({},e.target.name,e.target.value)));else{var a=t.props.unidad,n=a.codigo_unidad,c=a.unidad;j(Object(u.a)(Object(u.a)({},d),{},{unidad:c,codigo_unidad:n}))}else j(Object(u.a)(Object(u.a)({},d),{},Object(h.a)({},e.target.name,parseFloat(e.target.value))))};return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(b.a,{className:e.formInputFlex,children:[Object(V.jsxs)(y.a,{className:"precios-box",children:["Precio venta de ",Object(V.jsx)("b",{children:i.unidad})," con impuestos(NETO): ",Object(V.jsxs)("b",{children:["$",i.precio]})]}),r.map((function(e,t){return e.default?null:Object(V.jsxs)(y.a,{className:"precios-box",children:["Precio venta de ",Object(V.jsx)("b",{children:e.unidad})," con impuestos(NETO):"," ",Object(V.jsxs)("b",{children:["$",e.precio]})]},t)}))]}),Object(V.jsx)(Te.a,{}),Object(V.jsxs)(b.a,{className:e.formInputFlex,justifyContent:"center",children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Plazo"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"plazo",children:Object(V.jsxs)(De.a,{name:"plazo",value:d.plazo,onChange:p,children:[Object(V.jsx)(Ee.a,{value:"1",children:"1 Mes"}),Object(V.jsx)(Ee.a,{value:"2",children:"2 Meses"}),Object(V.jsx)(Ee.a,{value:"6",children:"6 Meses"}),Object(V.jsx)(Ee.a,{value:"8",children:"8 Meses"}),Object(V.jsx)(Ee.a,{value:"12",children:"12 Meses"}),Object(V.jsx)(Ee.a,{value:"18",children:"18 Meses"})]})})})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Unidad"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"unidad",children:a.granel?Object(V.jsx)(De.a,{name:"unidad",value:d.unidad,onChange:p,children:ba.map((function(e,t){return"Costal"===e.unidad?Object(V.jsx)(Ee.a,{unidad:e,value:e.unidad,children:e.unidad},t):null}))}):Object(V.jsx)(De.a,{name:"unidad",value:d.unidad,onChange:p,children:ua.map((function(e,t){return Object(V.jsx)(Ee.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))})})})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Precio"}),Object(V.jsx)(S.a,{type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"precio",value:d.precio,variant:"outlined",onChange:p})]}),Object(V.jsx)(b.a,{display:"flex",alignItems:"flex-end",children:Object(V.jsx)(w.a,{variant:"contained",size:"large",color:"primary",onClick:function(){return function(){if(d.plazo&&d.precio&&d.unidad){switch(d.unidad){case"Pz":c(Object(u.a)(Object(u.a)({},n),{},{precio_piezas:[].concat(Object(ea.a)(n.precio_piezas),[d])}));break;case"Caja":c(Object(u.a)(Object(u.a)({},n),{},{precio_cajas:[].concat(Object(ea.a)(n.precio_cajas),[d])}));break;case"Costal":c(Object(u.a)(Object(u.a)({},n),{},{precio_costales:[].concat(Object(ea.a)(n.precio_costales),[d])}))}j(Object(u.a)(Object(u.a)({},d),{},{precio:0}))}}()},children:"Agregar"})})]}),Object(V.jsx)(b.a,{children:Object(V.jsx)(Fe.a,{container:!0,spacing:2,justify:"center",children:a.granel?Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(Fe.a,{item:!0,lg:3,children:[Object(V.jsx)(y.a,{variant:"h6",align:"center",children:"Costal"}),Object(V.jsx)(Ur,{precios:n.precio_costales})]})}):Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(Fe.a,{item:!0,lg:3,children:[Object(V.jsx)(y.a,{variant:"h6",align:"center",children:"Piezas"}),Object(V.jsx)(Ur,{precios:n.precio_piezas})]}),Object(V.jsxs)(Fe.a,{item:!0,lg:3,children:[Object(V.jsx)(y.a,{variant:"h6",align:"center",children:"Cajas"}),Object(V.jsx)(Ur,{precios:n.precio_cajas})]})]})})})]})}var Hr=a(882),Yr=a(884),Xr=function(){var e=Object(_.a)(g.a.mark((function e(t,a){var n,c,r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("datos_generales"!==a){e.next=16;break}return n={clave_alterna:t.clave_alterna,tipo_producto:t.tipo_producto,nombre_comercial:t.nombre_comercial,nombre_generico:t.nombre_generico,receta_farmacia:t.receta_farmacia},null!==t.codigo_barras&&""!==t.codigo_barras&&(n=Object(u.a)(Object(u.a)({},n),{},{codigo_barras:t.codigo_barras})),null!==t.descripcion&&""!==t.descripcion&&(n=Object(u.a)(Object(u.a)({},n),{},{descripcion:t.descripcion})),null!==t.id_categoria&&""!==t.id_categoria&&(n=Object(u.a)(Object(u.a)({},n),{},{id_categoria:t.id_categoria})),null!==t.categoria&&""!==t.categoria&&(n=Object(u.a)(Object(u.a)({},n),{},{categoria:t.categoria})),null!==t.subcategoria&&""!==t.subcategoria&&(n=Object(u.a)(Object(u.a)({},n),{},{subcategoria:t.subcategoria})),null!==t.id_subcategoria&&""!==t.id_subcategoria&&(n=Object(u.a)(Object(u.a)({},n),{},{id_subcategoria:t.id_subcategoria})),null!==t.id_departamento&&""!==t.id_departamento&&(n=Object(u.a)(Object(u.a)({},n),{},{id_departamento:t.id_departamento})),null!==t.departamento&&""!==t.departamento&&(n=Object(u.a)(Object(u.a)({},n),{},{departamento:t.departamento})),null!==t.id_marca&&""!==t.id_marca&&(n=Object(u.a)(Object(u.a)({},n),{},{id_marca:t.id_marca})),null!==t.marca&&""!==t.marca&&(n=Object(u.a)(Object(u.a)({},n),{},{marca:t.marca})),null!==t.clave_producto_sat.Name&&""!==t.clave_producto_sat.Name&&(n=Object(u.a)(Object(u.a)({},n),{},{clave_producto_sat:t.clave_producto_sat})),e.abrupt("return",n);case 16:if("unidades_de_venta"!==a){e.next=20;break}for(c=[],r=0;r<t.length;r++)i={_id:t[r]._id,cantidad:t[r].cantidad,id_producto:t[r].id_producto,precio:t[r].precio,unidad_principal:t[r].unidad_principal,unidad:t[r].unidad,codigo_unidad:t[r].codigo_unidad,precio_unidad:t[r].precio_unidad},null!==t[r].codigo_barras&&""!==t[r].codigo_barras&&(i=Object(u.a)(Object(u.a)({},i),{},{codigo_barras:t[r].codigo_barras})),null!==t[r].default&&""!==t[r].default&&(i=Object(u.a)(Object(u.a)({},i),{},{default:t[r].default})),null!==t[r].descuento_activo&&""!==t[r].descuento_activo&&(i=Object(u.a)(Object(u.a)({},i),{},{descuento_activo:t[r].descuento_activo,descuento:t[r].descuento})),c.push(i);return e.abrupt("return",c);case 20:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Kr=["children","value","index"],Qr=["precios_producto"],Zr=[{numero_precio:1,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:2,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:3,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:4,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:5,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:6,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0}];function ei(e){var t=e.children,a=e.value,n=e.index,c=Object(fe.a)(e,Kr);return Object(V.jsx)("div",Object(u.a)(Object(u.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(V.jsx)(b.a,{p:3,height:"70vh",children:t})}))}function ti(e){return{id:"reg-product-tab-".concat(e),"aria-controls":"tabpanel-reg-product-".concat(e)}}var ai=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper},iconSvg:{width:50},dialogContent:{padding:0},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}}));function ni(e){var t=e.accion,a=e.datos,n=e.productosRefetch,c=e.fromCompra,r=ai(),i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(0),p=Object(v.a)(j,2),m=p[0],O=p[1],x=Object(s.useContext)(xe),h=x.datos_generales,f=x.setDatosGenerales,C=x.precios,S=x.setPrecios,k=x.validacion,F=x.setValidacion,z=x.preciosP,P=x.setPreciosP,D=x.imagenes,E=x.setImagenes,A=x.unidadesVenta,T=x.setUnidadesVenta,W=x.almacen_inicial,R=x.setAlmacenInicial,$=x.unidadVentaXDefecto,M=x.setUnidadVentaXDefecto,L=x.centro_de_costos,U=x.setCentroDeCostos,B=x.setUpdate,J=x.preciosPlazos,G=x.setPreciosPlazos,q=x.setSubcategorias,H=x.setOnPreview,Y=x.setSubcostos,K=x.imagenes_eliminadas,Q=x.setImagenesEliminadas,Z=x.presentaciones,ee=x.setPresentaciones,te=x.presentaciones_eliminadas,re=x.setPresentacionesEliminadas,ie=x.setAlmacenExistente,de=(x.almacen_existente,JSON.parse(localStorage.getItem("sesionCafi"))),je=Object(s.useContext)(xe).setAlert,ue=Object(s.useState)(!1),be=Object(v.a)(ue,2),pe=be[0],me=be[1],Oe=h.tipo_producto,he=Object(N.a)(mn),ge=Object(v.a)(he,1)[0],_e=Object(N.a)(xn),ve=Object(v.a)(_e,1)[0],Ce=function(e){d(!l),B(t),e&&t?Ne(e):ke()},ye=function(){var e=Object(_.a)(g.a.mark((function e(){var c,r,i,o,s,l;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(c=Pr(h,C,W,0)).error){e.next=4;break}return F(c),e.abrupt("return");case 4:if(F(c),!(Z.length>0)){e.next=11;break}if(Z.filter((function(e){return e.color._id&&e.medida._id})).length===Z.length){e.next=11;break}return F({error:!0,message:"Faltan medidas o colores a tus presentaciones",vista7:!0}),je({message:"Faltan medidas o colores en tus presentaciones",status:"error",open:!0}),e.abrupt("return");case 11:return 0===(r=Object(ea.a)(A)).length?r.push($):0===r.filter((function(e){return!0===e.default})).length&&r.splice(0,0,$),C.precios_producto=z,i=D,t&&(i=Object(ea.a)(D).filter((function(e){return!e.key_imagen}))),e.next=18,Xr(h,"datos_generales");case 18:return e.t0=e.sent,e.t1=C,e.t2=i,e.t3=K,e.t4=W,e.t5=L,e.next=26,Xr(r,"unidades_de_venta");case 26:if(e.t6=e.sent,e.t7=Z,e.t8=te,e.t9=J,e.t10=de.empresa._id,e.t11=de.sucursal._id,e.t12=de._id,o={datos_generales:e.t0,precios:e.t1,imagenes:e.t2,imagenes_eliminadas:e.t3,almacen_inicial:e.t4,centro_de_costos:e.t5,unidades_de_venta:e.t6,presentaciones:e.t7,presentaciones_eliminadas:e.t8,precio_plazos:e.t9,empresa:e.t10,sucursal:e.t11,usuario:e.t12},me(!0),e.prev=35,!t){e.next=43;break}return e.next=39,ve({variables:{input:o,id:a._id}});case 39:s=e.sent,je({message:"\xa1Listo! ".concat(s.data.actualizarProducto.message),status:"success",open:!0}),e.next=47;break;case 43:return e.next=45,ge({variables:{input:o}});case 45:l=e.sent,je({message:"\xa1Listo! ".concat(l.data.crearProducto.message),status:"success",open:!0});case 47:me(!1),Ce(),n(),e.next=58;break;case 52:e.prev=52,e.t13=e.catch(35),me(!1),je({message:"Error: ".concat(e.t13.message),status:"error",open:!0}),console.log(e.t13),e.t13.networkError?console.log(e.t13.networkError.result):e.t13.graphQLErrors&&console.log(e.t13.graphQLErrors);case 58:case"end":return e.stop()}}),e,null,[[35,52]])})));return function(){return e.apply(this,arguments)}}(),ke=function(){f(ae),S(ne),M(ce),P(Zr),T([]),R(oe),U({}),G(le),q([]),E([]),H({index:"",image:""}),F({error:!1,message:""}),Y([]),Q([]),ee([]),re([]),O(0)},Ne=function(e){var t=e.precios,a=(t.precios_producto,Object(fe.a)(t,Qr)),n=e.unidades_de_venta.filter((function(e){return!e.default})),c=e.unidades_de_venta.filter((function(e){return e.default}));f(e.datos_generales),S(a),U(e.centro_de_costos?e.centro_de_costos:se),E(e.imagenes),G(e.precio_plazos),T(n),P(e.precios.precios_producto),M(c[0]),ee(e.medidas_producto?e.medidas_producto:[]),e.inventario_general.length>0?ie(!0):ie(!1)};window.onkeydown=function(e){114===e.keyCode&&document.getElementById("modal-registro-product").click()};var Fe=Object(V.jsx)(w.a,{variant:"contained",color:"primary",onClick:function(){return ye()},size:"large",startIcon:Object(V.jsx)(za.a,{}),children:"Guardar"}),De=function(){return t||5!==m?t&&"OTROS"===Oe&&5===m||t&&"OTROS"!==Oe&&6===m?Fe:Object(V.jsx)(w.a,{variant:"contained",color:"primary",onClick:function(){return O(m+1)},size:"large",endIcon:Object(V.jsx)(Hr.a,{}),disableElevation:!0,children:"Siguiente"}):Fe};return Object(V.jsxs)(s.Fragment,{children:[t?Object(V.jsx)(X.a,{color:"default",onClick:function(){return Ce(a)},children:Object(V.jsx)($a.a,{})}):c?Object(V.jsx)(X.a,{color:"primary",onClick:function(){return Ce()},children:Object(V.jsx)(It.a,{})}):Object(V.jsx)(w.a,{id:"modal-registro-product",color:"primary",variant:"contained",size:"large",onClick:function(){return Ce()},startIcon:Object(V.jsx)(It.a,{}),children:"Nuevo"}),Object(V.jsxs)(ze.a,{open:l,fullWidth:!0,maxWidth:"lg",scroll:"paper",disableEscapeKeyDown:!0,onClose:function(e,t){"backdropClick"!==t&&Ce()},children:[Object(V.jsx)(Se.a,{position:"static",color:"default",elevation:0,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"space-between",children:Object(V.jsxs)(we.a,{value:m,onChange:function(e,t){O(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:[Object(V.jsx)(Ie.a,Object(u.a)({label:"Datos generales",icon:Object(V.jsx)(uc.a,{color:"secondary",badgeContent:Object(V.jsx)(y.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!k.error||!k.vista1,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/portapapeles.svg",alt:"icono registro",className:r.iconSvg})})},ti(0))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Precios de venta",icon:Object(V.jsx)(uc.a,{color:"secondary",badgeContent:Object(V.jsx)(y.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!k.error||!k.vista2,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/etiqueta-de-precio.svg",alt:"icono venta",className:r.iconSvg})})},ti(1))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Inventario y almacen",icon:Object(V.jsx)(uc.a,{color:"secondary",badgeContent:Object(V.jsx)(y.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!k.error||!k.vista3,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/tarea-completada.svg",alt:"icono almacen",className:r.iconSvg})})},ti(2))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Centro de costos",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/costos.svg",alt:"icono almacen",className:r.iconSvg})},ti(3))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Precios a plazos",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/calendar.svg",alt:"icono almacen",className:r.iconSvg})},ti(4))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Imagenes",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/imagenes.svg",alt:"icono imagenes",className:r.iconSvg})},ti(5))),t&&"OTROS"!==h.tipo_producto?Object(V.jsx)(Ie.a,Object(u.a)({label:"Tallas y colores",icon:Object(V.jsx)(uc.a,{color:"secondary",badgeContent:Object(V.jsx)(y.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!k.error||!k.vista7,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/tallas-colores.svg",alt:"icono colores",className:r.iconSvg})})},ti(6))):null]})})}),Object(V.jsxs)(Pe.a,{className:r.dialogContent,children:[Object(V.jsx)(Me.a,{className:r.backdrop,open:pe,children:Object(V.jsx)(I.a,{color:"inherit"})}),Object(V.jsx)(ci,{value:m})]}),Object(V.jsxs)(We.a,{style:{display:"flex",justifyContent:"center"},children:[Object(V.jsx)(w.a,{variant:"outlined",color:"primary",onClick:function(){return O(m-1)},size:"large",startIcon:Object(V.jsx)(Yr.a,{}),disabled:0===m,children:"Anterior"}),Object(V.jsx)(w.a,{variant:"outlined",color:"inherit",onClick:function(){return Ce()},size:"large",startIcon:Object(V.jsx)(zt.a,{}),disableElevation:!0,children:"Cancelar"}),Object(V.jsx)(De,{})]})]})]})}var ci=function(e){var t=e.value,a=ai(),n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(He.a)(pn,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id}}),r=c.loading,i=c.data,o=c.error,l=c.refetch;if(Object(s.useEffect)((function(){return function(){l()}}),[l]),r)return Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:[Object(V.jsx)(I.a,{}),Object(V.jsx)(y.a,{variant:"h6",children:"Cargando..."})]});if(o)return Object(V.jsx)(Je,{error:o});var d=i.obtenerConsultasProducto;return Object(V.jsxs)("div",{className:a.root,children:[Object(V.jsx)(ei,{value:t,index:0,children:Object(V.jsx)(lr,{obtenerConsultasProducto:d,refetch:l})}),Object(V.jsx)(ei,{value:t,index:1,children:Object(V.jsx)(Sa,{})}),Object(V.jsx)(ei,{value:t,index:2,children:Object(V.jsx)(zr,{obtenerConsultasProducto:d,refetch:l})}),Object(V.jsx)(ei,{value:t,index:3,children:Object(V.jsx)(Lr,{obtenerConsultasProducto:d,refetch:l})}),Object(V.jsx)(ei,{value:t,index:4,children:Object(V.jsx)(qr,{})}),Object(V.jsx)(ei,{value:t,index:5,children:Object(V.jsx)(Or,{})}),Object(V.jsx)(ei,{value:t,index:6,children:Object(V.jsx)(oc,{obtenerConsultasProducto:d,refetch:l})})]})},ri=a(886);function ii(){var e=Object(s.useContext)(ka).preciosVenta;return Object(V.jsx)("div",{children:Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{"aria-label":"simple table",size:"small",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{style:{minWidth:150},children:"Precios de venta"}),[1,2,3,4,5,6].map((function(e,t){return Object(V.jsx)(sa.a,{style:{minWidth:100},children:e},t)}))]})}),Object(V.jsx)(la.a,{children:["Utilidad","Precio de venta"].map((function(t,a){return Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{style:{border:0},children:Object(V.jsx)("b",{children:t})}),e.map((function(e,a){return Object(V.jsx)(oi,{data:e,index:a,tipo:t},a)}))]},a)}))})]})})})}var oi=function(e){var t=e.data,a=e.tipo,n=e.index,c=Object(s.useContext)(ka),r=c.preciosVenta,i=c.datosProducto,o=c.productoOriginal.precios,l=Object(s.useState)(t.precio_neto),d=Object(v.a)(l,2),j=d[0],b=d[1],p=Object(u.a)({},r[n]),m=i.costo/o.unidad_de_compra.cantidad,O=o.precio_de_compra.precio_sin_impuesto/o.unidad_de_compra.cantidad;isNaN(O)&&(O=0),isNaN(m)&&(m=0);var x=Object(s.useCallback)((function(){if(p.numero_precio===t.numero_precio){p.precio_neto=m,b(m);var e=(t.utilidad?t.utilidad:0)/100,a=parseFloat((O*e+O).toFixed(2));if(p.precio_venta=parseFloat(a.toFixed(2)),o.iva_activo||o.ieps_activo){var c=m+m*e;p.precio_neto=parseFloat(c.toFixed(2)),b(parseFloat(c.toFixed(2)))}else p.precio_neto=parseFloat(a.toFixed(2)),b(parseFloat(a.toFixed(2)));r.splice(n,1,p)}}),[i.costo,i.cantidad]);switch(Object(s.useEffect)((function(){(1===t.numero_precio||t.numero_precio>1&&j)&&x()}),[x]),a){case"Utilidad":return Object(V.jsxs)(sa.a,{style:{border:0},children:[t.utilidad,"%"]});case"Precio de venta":return Object(V.jsxs)(sa.a,{style:{border:0},children:["$",parseFloat(j).toFixed(2)]});default:return null}},si=a(887);function li(){var e=Object(s.useContext)(ka),t=e.datosProducto,a=e.setDatosProducto,n=e.productoOriginal.precios.precio_de_compra,c=n.precio_sin_impuesto,r=n.precio_con_impuesto,i=n.iva+n.ieps;return Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(b.a,{display:"flex",width:160,children:[Object(V.jsx)(S.a,{variant:"outlined",size:"small",fullWidth:!0,inputMode:"numeric",onChange:function(e){return function(e){if(e&&0!==parseFloat(e)){var n=parseFloat(e),o=Math.round(n/t.subtotal*100),s=t.subtotal-n,l=s+i;a(Object(u.a)(Object(u.a)({},t),{},{descuento_porcentaje:parseFloat(o),descuento_precio:parseFloat(n.toFixed(2)),subtotal_descuento:parseFloat(s.toFixed(2)),total_descuento:parseFloat(l.toFixed(2))}))}else a(Object(u.a)(Object(u.a)({},t),{},{descuento_porcentaje:"",descuento_precio:"",subtotal_descuento:c,total_descuento:r}))}(e.target.value)},disabled:!t.producto.datos_generales,value:t.descuento_precio,InputProps:{startAdornment:Object(V.jsx)(Y.a,{position:"start",children:"$"})}}),Object(V.jsx)(b.a,{mr:1}),Object(V.jsx)(S.a,{variant:"outlined",size:"small",fullWidth:!0,inputMode:"numeric",onChange:function(e){return function(e){if(e&&0!==parseFloat(e)){var n=parseFloat(e),o=Math.round(t.subtotal*n/100),s=t.subtotal-o,l=s+i;a(Object(u.a)(Object(u.a)({},t),{},{descuento_porcentaje:parseFloat(n),descuento_precio:parseFloat(o.toFixed(2)),subtotal_descuento:parseFloat(s.toFixed(2)),total_descuento:parseFloat(l.toFixed(2))}))}else a(Object(u.a)(Object(u.a)({},t),{},{descuento_porcentaje:"",descuento_precio:"",subtotal_descuento:c,total_descuento:r}))}(e.target.value)},disabled:!t.producto.datos_generales,value:t.descuento_porcentaje,InputProps:{startAdornment:Object(V.jsx)(Y.a,{position:"start",children:"%"})}})]})})}var di=Object(s.createContext)(),ji=function(e){var t=e.children,a=Object(s.useState)({direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},estado_cliente:!0}),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(!1),u=Object(v.a)(j,2),b=u[0],p=u[1],m=Object(s.useState)(!1),O=Object(v.a)(m,2),x=O[0],h=O[1],f=Object(s.useState)(!1),g=Object(v.a)(f,2),_=g[0],C=g[1];return Object(V.jsx)(di.Provider,{value:{cliente:c,setCliente:r,toUpdate:l,setToUpdate:d,error:b,setError:p,update:x,setUpdate:h,setUpdateClientVenta:C,updateClientVenta:_},children:t})},ui=Object(k.a)((function(e){return{avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:150,height:150,border:"dashed 2px #000000"},avatar:{width:135,height:135,"& > .icon":{fontSize:100}},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}},title:{fontWeight:"500","& span":{color:"red"}}}}));function bi(e){var t=e.tipo,a=e.accion,n=ui(),c=Object(s.useContext)(di),r=c.cliente,i=c.setCliente,o=c.error,l=Object(s.useState)(""),d=Object(v.a)(l,2),j=d[0],p=d[1],m=Object(s.useCallback)((function(e){var t=new FileReader;t.readAsDataURL(e[0]),t.onload=function(){var e=t.result;p(e)},i(Object(u.a)(Object(u.a)({},r),{},{imagen:e[0]}))}),[r,i]),O=Object(Ht.a)({accept:"image/jpeg, image/png",noKeyboard:!0,onDrop:m}),x=O.getRootProps,f=O.getInputProps,g=function(e){var t=e.target,a=t.name,n=t.value;i(Object(u.a)(Object(u.a)({},r),{},Object(h.a)({},a,n)))},_=function(e){var t=e.target,a=t.name,n=t.value;i(Object(u.a)(Object(u.a)({},r),{},{direccion:Object(u.a)(Object(u.a)({},r.direccion),{},Object(h.a)({},a,n))}))};return Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(Fe.a,{container:!0,className:n.input,children:[Object(V.jsx)(Fe.a,{item:!0,md:3,xs:12,style:{display:"flex",justifyContent:"center",marginTop:"8px"},children:Object(V.jsxs)(b.a,Object(u.a)(Object(u.a)({className:n.avatarContainer},x()),{},{children:[Object(V.jsx)("input",Object(u.a)({},f())),j?Object(V.jsx)(qt.a,{variant:"square",className:n.avatar,src:"".concat(j)}):Object(V.jsx)(qt.a,{variant:"square",className:n.avatar,src:"".concat(r.imagen)})]}))}),Object(V.jsx)(Fe.a,{item:!0,md:9,xs:12,children:Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:["registrar"===a?null:Object(V.jsxs)(Fe.a,{item:!0,md:3,xs:12,children:[Object(V.jsx)(y.a,{className:n.title,children:"N. Cliente"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"numero_cliente",variant:"outlined",value:r.numero_cliente?r.numero_cliente:"",onChange:g,disabled:!0,type:"number"})]}),Object(V.jsxs)(Fe.a,{item:!0,md:"registrar"===a?12:9,xs:12,children:[Object(V.jsxs)(y.a,{className:n.title,children:[Object(V.jsx)("span",{children:"* "}),"Nombre Cliente"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.nombre_cliente,name:"nombre_cliente",variant:"outlined",value:r.nombre_cliente?r.nombre_cliente:"",helperText:o?"Campo Requerido":"",onChange:g})]}),"CLIENTE"===t?null:Object(V.jsxs)(Fe.a,{item:!0,md:4,xs:12,children:[Object(V.jsxs)(y.a,{className:n.title,children:[Object(V.jsx)("span",{children:"* "}),"Representante"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.representante,name:"representante",variant:"outlined",value:r.representante?r.representante:"",helperText:o?"Campo Requerido":"",onChange:g})]}),Object(V.jsxs)(Fe.a,{item:!0,md:"CLIENTE"===t?6:4,xs:12,children:[Object(V.jsxs)(y.a,{className:n.title,children:[Object(V.jsx)("span",{children:"* "}),"Clave(Tarjeta de puntos)"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.clave_cliente,name:"clave_cliente",variant:"outlined",value:r.clave_cliente?r.clave_cliente:"",helperText:o?"Campo Requerido":"",onChange:g,InputProps:{endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(X.a,{color:"primary",size:"small",onClick:function(){return function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();i(Object(u.a)(Object(u.a)({},r),{},{clave_cliente:t}))}()},children:Object(V.jsx)(Wa.a,{})})}),disabled:!0},type:"number"})]}),Object(V.jsxs)(Fe.a,{item:!0,md:"CLIENTE"===t?6:4,xs:12,children:[Object(V.jsx)(y.a,{className:n.title,children:"Fecha nacimiento"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_nacimiento",variant:"outlined",type:"date",onChange:g,value:r.fecha_nacimiento?r.fecha_nacimiento:""})]})]})}),Object(V.jsx)(Fe.a,{item:!0,md:12,children:Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsxs)(Fe.a,{item:!0,md:3,xs:12,children:[Object(V.jsx)(y.a,{className:n.title,children:"CURP"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"curp",variant:"outlined",value:r.curp?r.curp:"",onChange:g})]}),Object(V.jsxs)(Fe.a,{item:!0,md:3,xs:12,children:[Object(V.jsxs)(y.a,{className:n.title,children:[Object(V.jsx)("span",{children:"* "}),"Email"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.email,name:"email",variant:"outlined",value:r.email?r.email:"",helperText:o?"Campo Requerido":"",onChange:g})]}),Object(V.jsxs)(Fe.a,{item:!0,md:3,xs:12,children:[Object(V.jsxs)(y.a,{className:n.title,children:[Object(V.jsx)("span",{children:"* "}),"Num. Telefono"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.telefono,name:"telefono",variant:"outlined",value:r.telefono?r.telefono:"",helperText:o?"Campo Requerido":"",onChange:g,type:"number"})]}),Object(V.jsxs)(Fe.a,{item:!0,md:3,xs:12,children:[Object(V.jsx)(y.a,{className:n.title,children:"Num. Celular"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"celular",variant:"outlined",value:r.celular?r.celular:"",onChange:g,type:"number"})]})]})}),Object(V.jsxs)(Fe.a,{item:!0,md:12,children:[Object(V.jsxs)(b.a,{my:2,children:[Object(V.jsx)(y.a,{className:n.title,children:Object(V.jsx)("b",{children:"Domicilio"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsxs)(Fe.a,{item:!0,md:3,xs:12,children:[Object(V.jsxs)(y.a,{className:n.title,children:[Object(V.jsx)("span",{children:"* "}),"Calle"]}),Object(V.jsx)(S.a,{size:"small",fullWidth:!0,error:o&&!r.direccion.calle,name:"calle",variant:"outlined",value:r.direccion.calle?r.direccion.calle:"",helperText:o?"Campo Requerido":"",onChange:_})]}),Object(V.jsxs)(Fe.a,{item:!0,md:2,xs:12,children:[Object(V.jsxs)(y.a,{className:n.title,children:[Object(V.jsx)("span",{children:"* "}),"Num. Ext"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.no_ext,name:"no_ext",variant:"outlined",value:r.direccion.no_ext?r.direccion.no_ext:"",helperText:o?"Campo Requerido":"",onChange:_})]}),Object(V.jsxs)(Fe.a,{item:!0,md:2,xs:12,children:[Object(V.jsx)(y.a,{className:n.title,children:"Num. Int"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_int",variant:"outlined",value:r.direccion.no_int?r.direccion.no_int:"",onChange:_})]}),Object(V.jsxs)(Fe.a,{item:!0,md:2,xs:12,children:[Object(V.jsxs)(y.a,{className:n.title,children:[Object(V.jsx)("span",{children:"* "}),"C\xf3digo postal"]}),Object(V.jsx)(S.a,{size:"small",fullWidth:!0,error:o&&!r.direccion.codigo_postal,name:"codigo_postal",variant:"outlined",value:r.direccion.codigo_postal?r.direccion.codigo_postal:"",helperText:o?"Campo Requerido":"",onChange:_})]}),Object(V.jsxs)(Fe.a,{item:!0,md:3,xs:12,children:[Object(V.jsxs)(y.a,{className:n.title,children:[Object(V.jsx)("span",{children:"* "}),"Colonia"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.colonia,name:"colonia",variant:"outlined",value:r.direccion.colonia?r.direccion.colonia:"",helperText:o?"Campo Requerido":"",onChange:_})]}),Object(V.jsxs)(Fe.a,{item:!0,md:3,xs:12,children:[Object(V.jsxs)(y.a,{className:n.title,children:[Object(V.jsx)("span",{children:"* "}),"Municipio"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.municipio,name:"municipio",variant:"outlined",value:r.direccion.municipio?r.direccion.municipio:"",helperText:o?"Campo Requerido":"",onChange:_})]}),Object(V.jsxs)(Fe.a,{item:!0,md:3,xs:12,children:[Object(V.jsx)(y.a,{className:n.title,children:"Localidad"}),Object(V.jsx)(S.a,{size:"small",name:"localidad",variant:"outlined",value:r.direccion.localidad?r.direccion.localidad:"",onChange:_})]}),Object(V.jsxs)(Fe.a,{item:!0,md:3,xs:12,children:[Object(V.jsxs)(y.a,{className:n.title,children:[Object(V.jsx)("span",{children:"* "}),"Estado"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.estado,name:"estado",variant:"outlined",value:r.direccion.estado?r.direccion.estado:"",helperText:o?"Campo Requerido":"",onChange:_})]}),Object(V.jsxs)(Fe.a,{item:!0,md:3,xs:12,children:[Object(V.jsxs)(y.a,{className:n.title,children:[Object(V.jsx)("span",{children:"* "}),"Pais"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.pais,name:"pais",variant:"outlined",value:r.direccion.pais?r.direccion.pais:"",helperText:o?"Campo Requerido":"",onChange:_})]})]})]})]})})}var pi,mi,Oi,xi,hi=Object(k.a)((function(e){return{title:{fontWeight:"500"}}}));function fi(e){var t=e.tipo,a=hi(),n=Object(s.useContext)(di),c=n.cliente,r=n.setCliente,i=function(e){var t=e.target.name;r("numero_descuento"!==t&&"limite_credito"!==t?Object(u.a)(Object(u.a)({},c),{},Object(h.a)({},e.target.name,e.target.value)):Object(u.a)(Object(u.a)({},c),{},Object(h.a)({},e.target.name,parseInt(e.target.value))))};return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{my:3,children:Object(V.jsxs)(yt.a,{severity:"info",children:["Si deseas hacer facturas a este cliente el ",Object(V.jsx)("b",{children:"RFC"})," y la"," ",Object(V.jsx)("b",{children:"Razon social"})," son obligatorios."]})}),Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsxs)(Fe.a,{item:!0,md:6,xs:12,children:[Object(V.jsx)(y.a,{className:a.title,children:"RFC"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"rfc",variant:"outlined",value:c.rfc?c.rfc:"",onChange:i})]}),Object(V.jsxs)(Fe.a,{item:!0,md:6,xs:12,children:[Object(V.jsx)(y.a,{className:a.title,children:"Razon social"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"razon_social",variant:"outlined",value:c.razon_social?c.razon_social:"",onChange:i})]}),Object(V.jsxs)(Fe.a,{item:!0,md:4,xs:12,children:[Object(V.jsx)(y.a,{className:a.title,children:"Descuento"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"numero_descuento",variant:"outlined",value:c.numero_descuento?c.numero_descuento:"",onChange:i})]}),Object(V.jsxs)(Fe.a,{item:!0,md:4,xs:12,children:[Object(V.jsx)(y.a,{className:a.title,children:"Limite de cr\xe9dito"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"limite_credito",variant:"outlined",value:c.limite_credito?c.limite_credito:"",onChange:i})]}),Object(V.jsxs)(Fe.a,{item:!0,md:4,xs:12,children:[Object(V.jsx)(y.a,{className:a.title,children:"D\xedas de cr\xe9dito"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"dias_credito",variant:"outlined",value:c.dias_credito?c.dias_credito:"",onChange:i})]})]}),"CLIENTE"!==t?Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(b.a,{my:3,children:[Object(V.jsx)(y.a,{className:a.title,children:"Datos bancarios"}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsxs)(Fe.a,{item:!0,md:6,xs:12,children:[Object(V.jsx)(y.a,{className:a.title,children:"Banco"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"banco",variant:"outlined",value:c.banco?c.banco:"",onChange:i})]}),Object(V.jsxs)(Fe.a,{item:!0,md:6,xs:12,children:[Object(V.jsx)(y.a,{className:a.title,children:"No. de Cuenta Bancaria"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"numero_cuenta",variant:"outlined",value:c.numero_cuenta?c.numero_cuenta:"",onChange:i})]})]})]}):null]})}var gi,_i,vi,Ci,yi,Si,wi=Object(z.d)(pi||(pi=Object(F.a)(["\n\tmutation crearCliente($input: CrearClienteInput) {\n\t\tcrearCliente(input: $input) {\n\t\t\t_id\n\t\t\tnumero_cliente\n\t\t\tclave_cliente\n\t\t\trepresentante\n\t\t\tnombre_cliente\n\t\t\trfc\n\t\t\tcurp\n\t\t\ttelefono\n\t\t\tcelular\n\t\t\temail\n\t\t\tnumero_descuento\n\t\t\tlimite_credito\n\t\t\tdias_credito\n\t\t\trazon_social\n\t\t\tdireccion {\n\t\t\t\tcalle\n\t\t\t\tno_ext\n\t\t\t\tno_int\n\t\t\t\tcodigo_postal\n\t\t\t\tcolonia\n\t\t\t\tmunicipio\n\t\t\t\tlocalidad\n\t\t\t\testado\n\t\t\t\tpais\n\t\t\t}\n\t\t\timagen\n\t\t\testado_cliente\n\t\t\ttipo_cliente\n\t\t}\n\t}\n"]))),Ii=Object(z.d)(mi||(mi=Object(F.a)(["\n\tquery obtenerClientes($tipo: String!, $filtro: String) {\n\t\tobtenerClientes(tipo: $tipo, filtro: $filtro) {\n\t\t\t_id\n\t\t\tnumero_cliente\n\t\t\tclave_cliente\n\t\t\trepresentante\n\t\t\tnombre_cliente\n\t\t\trfc\n\t\t\tcurp\n\t\t\ttelefono\n\t\t\tcelular\n\t\t\temail\n\t\t\tnumero_descuento\n\t\t\tlimite_credito\n\t\t\tdias_credito\n\t\t\trazon_social\n\t\t\tdireccion {\n\t\t\t\tcalle\n\t\t\t\tno_ext\n\t\t\t\tno_int\n\t\t\t\tcodigo_postal\n\t\t\t\tcolonia\n\t\t\t\tmunicipio\n\t\t\t\tlocalidad\n\t\t\t\testado\n\t\t\t\tpais\n\t\t\t}\n\t\t\timagen\n\t\t\testado_cliente\n\t\t\ttipo_cliente\n\t\t\tbanco\n\t\t\tnumero_cuenta\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t\tsucursales_activas\n\t\t\t\tlimite_sucursales\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t\tmonedero_electronico\n\t\t\tfecha_nacimiento\n    \t\tfecha_registro\n\t\t\teliminado\n\t\t}\n\t}\n"]))),ki=Object(z.d)(Oi||(Oi=Object(F.a)(["\n\tmutation actualizarCliente($input: ActualizarClienteInput, $id: ID!) {\n\t\tactualizarCliente(id: $id, input: $input) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Ni=Object(z.d)(xi||(xi=Object(F.a)(["\n\tmutation eliminarCliente($id: ID!) {\n\t\teliminarCliente(id: $id) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),Fi=["numero_cliente","_id","clave_cliente","sucursal","empresa"];function zi(e){var t=e.tipo,a=e.accion,n=e.datos,c=e.refetch,r=e.ventas,i=e.handleClickOpen,o=Object(s.useContext)(di),l=o.cliente,d=o.setCliente,j=o.setError,p=o.update,m=o.setUpdate,O=o.updateClientVenta,x=o.setUpdateClientVenta,h=Object(s.useState)(!1),f=Object(v.a)(h,2),S=f[0],I=f[1],k=Object(s.useState)(!1),F=Object(v.a)(k,2),z=F[0],P=F[1],D=Object(s.useState)({message:"",status:"",open:!1}),E=Object(v.a)(D,2),A=E[0],T=E[1],W=JSON.parse(localStorage.getItem("sesionCafi")),R=Object(s.useCallback)((function(){d({direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},estado_cliente:!0})}),[d]),$=function(){I(!0),n&&d(n)},M=function(){I(!1),R()},L=Object(N.a)(wi),U=Object(v.a)(L,1)[0],J=Object(N.a)(ki),G=Object(v.a)(J,1)[0],q=function(){var e=Object(_.a)(g.a.mark((function e(){var n,o,s,d,b,h,f;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=Object(u.a)({},l)).clave_cliente&&n.nombre_cliente&&n.telefono&&n.email&&n.direccion.calle&&n.direccion.municipio&&n.direccion.estado&&n.direccion.pais){e.next=7;break}if("CLIENTE"===t||n.representante){e.next=5;break}return j(!0),e.abrupt("return");case 5:return j(!0),e.abrupt("return");case 7:if(P(!0),e.prev=8,"registrar"!==a){e.next=21;break}return n.tipo_cliente=t,n.empresa=W.empresa._id,n.sucursal=W.sucursal._id,"CLIENTE"===t&&(n.representante=""),o=n,e.next=17,U({variables:{input:o}});case 17:s=e.sent,!0===r&&(b=JSON.parse(localStorage.getItem("DatosVentas")),h=null===b?{}:b,localStorage.setItem("DatosVentas",JSON.stringify({subTotal:void 0===h.subTotal?0:h.subTotal,total:void 0===h.total?0:h.total,impuestos:void 0===h.impuestos?0:h.impuestos,iva:void 0===h.iva?0:h.iva,ieps:void 0===h.ieps?0:h.ieps,descuento:void 0===h.descuento?0:h.descuento,monedero:void 0===h.monedero?0:h.monedero,tipo_cambio:h.tipo_cambio?h.tipo_cambio:{},cliente:s.data.crearCliente,venta_cliente:!0,productos:(null===(d=h.productos)||void 0===d?void 0:d.length)>0?h.productos:[]})),x(!O),M(),i()),e.next=24;break;case 21:return n.numero_cliente,n._id,n.clave_cliente,n.sucursal,n.empresa,f=Object(fe.a)(n,Fi),e.next=24,G({variables:{input:f,id:n._id}});case 24:c&&c(),m(!p),T({message:"\xa1Listo!",status:"success",open:!0}),j(!1),P(!1),M(),e.next=38;break;case 32:e.prev=32,e.t0=e.catch(8),T({message:e.t0.message,status:"error",open:!0}),P(!1),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 38:case"end":return e.stop()}}),e,null,[[8,32]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(B,{alert:A,setAlert:T}),"registrar"===a?c?Object(V.jsx)(X.a,{color:"primary",onClick:$,children:Object(V.jsx)(It.a,{})}):Object(V.jsx)(w.a,{color:"primary",variant:"contained",size:"large",onClick:$,startIcon:Object(V.jsx)(It.a,{}),children:"Agregar"}):Object(V.jsx)(X.a,{onClick:$,children:Object(V.jsx)($a.a,{})}),Object(V.jsxs)(ze.a,{open:S,onClose:M,fullWidth:!0,maxWidth:"md",children:[Object(V.jsxs)(wt.a,{style:{padding:0},children:[Object(V.jsx)(Ve,{loading:z,setLoading:P}),Object(V.jsx)(Se.a,{position:"static",color:"default",elevation:0,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",children:"registrar"===a?"Registrar":"Actualizar"}),Object(V.jsx)(b.a,{flexGrow:1}),Object(V.jsx)(w.a,{variant:"contained",color:"secondary",size:"large",onClick:function(){return M()},children:Object(V.jsx)(zt.a,{})})]})})]}),Object(V.jsx)(Pe.a,{children:Object(V.jsxs)(C.a,{children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Informaci\xf3n b\xe1sica"})}),Object(V.jsx)(Te.a,{}),Object(V.jsx)(bi,{tipo:t,accion:a}),Object(V.jsx)(b.a,{my:2}),Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Informaci\xf3n de credito"})}),Object(V.jsx)(Te.a,{}),Object(V.jsx)(fi,{tipo:t,accion:a})]})}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{variant:"contained",color:"primary",onClick:q,size:"large",startIcon:Object(V.jsx)(Pt.a,{}),children:"Guardar"})})]})]})}var Pi=Object(z.d)(gi||(gi=Object(F.a)(["\n  mutation crearCompra(\n    $input: CrearCompraInput\n    $empresa: ID!\n    $sucursal: ID!\n    $usuario: ID!\n  ) {\n    crearCompra(\n      input: $input\n      empresa: $empresa\n      sucursal: $sucursal\n      usuario: $usuario\n    ) {\n      message\n    }\n  }\n"]))),Di=Object(z.d)(_i||(_i=Object(F.a)(["\n  mutation crearCompraEnEspera(\n    $input: CrearCompraInput\n    $empresa: ID!\n    $sucursal: ID!\n    $usuario: ID!\n  ) {\n    crearCompraEnEspera(\n      input: $input\n      empresa: $empresa\n      sucursal: $sucursal\n      usuario: $usuario\n    ) {\n      message\n    }\n  }\n"]))),Ei=Object(z.d)(vi||(vi=Object(F.a)(["\n  query obtenerComprasRealizadas(\n    $empresa: ID!\n    $sucursal: ID!\n    $filtro: String\n    $fecha: String\n  ) {\n    obtenerComprasRealizadas(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtro: $filtro\n      fecha: $fecha\n    ) {\n      _id\n      usuario {\n        _id\n        numero_usuario\n        nombre\n        estado_usuario\n      }\n      empresa {\n        _id\n        nombre_empresa\n      }\n      sucursal {\n        _id\n        nombre_sucursal\n      }\n      proveedor {\n        id_proveedor {\n          _id\n          numero_cliente\n          clave_cliente\n          nombre_cliente\n          telefono\n          email\n        }\n        numero_cliente\n        clave_cliente\n        nombre_cliente\n      }\n      productos {\n        _id\n        id_compra\n        id_traspaso\n        id_producto\n        producto {\n          almacen_inicial {\n            almacen\n            cantidad\n            fecha_de_expiracion\n            id_almacen\n          }\n          datos_generales {\n            codigo_barras\n            clave_alterna\n            tipo_producto\n            nombre_comercial\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat {\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n          precios {\n            ieps\n            ieps_activo\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            granel\n            inventario {\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n            }\n            precio_de_compra {\n              precio_con_impuesto\n              precio_sin_impuesto\n              iva\n              ieps\n            }\n            precios_producto {\n              numero_precio\n              precio_neto\n              precio_venta\n              unidad_mayoreo\n              utilidad\n            }\n            unidad_de_compra {\n              cantidad\n              precio_unitario_con_impuesto\n              precio_unitario_sin_impuesto\n              unidad\n            }\n          }\n          unidades_de_venta {\n            _id\n            cantidad\n            codigo_barras\n            id_producto\n            precio\n            unidad\n            unidad_principal\n          }\n        }\n        concepto\n        cantidad\n        cantidad_regalo\n        cantidad_total\n        costo\n        descuento_porcentaje\n        descuento_precio\n        impuestos\n        mantener_precio\n        subtotal\n        total\n        medida {\n          id_medida\n          medida\n          tipo\n        }\n        color {\n          id_color\n          color\n          hex\n        }\n        unidad\n        id_unidad_venta\n        empresa\n        sucursal\n        usuario\n        year_registro\n        numero_semana_year\n        numero_mes_year\n        fecha_registro\n      }\n      almacen {\n        id_almacen {\n          _id\n          nombre_almacen\n          id_usuario_encargado {\n            _id\n            numero_usuario\n            nombre\n          }\n        }\n        nombre_almacen\n      }\n      compra_credito\n      credito_pagado\n      saldo_credito_pendiente\n      fecha_vencimiento_credito\n      subtotal\n      impuestos\n      total\n      year_registro\n      numero_semana_year\n      numero_mes_year\n      fecha_registro\n    }\n  }\n"]))),Ai=Object(z.d)(Ci||(Ci=Object(F.a)(["\n  query obtenerComprasEnEspera($empresa: ID!, $sucursal: ID!, $filtro: String) {\n    obtenerComprasEnEspera(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtro: $filtro\n    ) {\n      _id\n      en_espera\n      proveedor {\n        id_proveedor\n        clave_cliente\n        numero_cliente\n        nombre_cliente\n      }\n      almacen {\n        id_almacen\n        nombre_almacen\n      }\n      productos {\n        producto {\n          almacen_inicial {\n            almacen\n            cantidad\n            fecha_de_expiracion\n            id_almacen\n          }\n          datos_generales {\n            codigo_barras\n            clave_alterna\n            tipo_producto\n            nombre_comercial\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat {\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n          precios {\n            ieps\n            ieps_activo\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            precio_de_compra {\n              ieps\n              iva\n              precio_con_impuesto\n              precio_sin_impuesto\n            }\n            precios_producto {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n            unidad_de_compra {\n              cantidad\n              precio_unitario_con_impuesto\n              precio_unitario_sin_impuesto\n              unidad\n            }\n            inventario {\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n            }\n            granel\n          }\n          imagenes {\n            url_imagen\n            location_imagen\n            key_imagen\n            extencion_imagen\n          }\n          centro_de_costos {\n            cuenta\n            id_cuenta\n            id_subcuenta\n            subcuenta\n          }\n          precio_plazos {\n            precio_cajas {\n              plazo\n              unidad\n              precio\n            }\n            precio_costales {\n              plazo\n              unidad\n              precio\n            }\n            precio_piezas {\n              plazo\n              unidad\n              precio\n            }\n          }\n          empresa\n          sucursal\n          usuario\n          unidades_de_venta {\n            _id\n            precio\n            cantidad\n            unidad\n            unidad_principal\n            codigo_barras\n            id_producto\n            descuento {\n              cantidad_unidad\n              numero_precio\n              unidad_maxima\n              precio_general\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              porciento\n              dinero_descontado\n            }\n            descuento_activo\n            default\n            precio_unidad {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n          presentaciones {\n            _id\n            almacen\n            cantidad\n            cantidad_nueva\n            codigo_barras\n            color {\n              hex\n              nombre\n              _id\n            }\n            descuento {\n              cantidad_unidad\n              numero_precio\n              unidad_maxima\n              precio_general\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              porciento\n              dinero_descontado\n            }\n            descuento_activo\n            existencia\n            medida {\n              talla\n              tipo\n              _id\n            }\n            nombre_comercial\n            precio\n            precio_unidad {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n        }\n        id_producto\n        cantidad\n        cantidad_regalo\n        unidad_regalo\n        cantidad_total\n        iva_total\n        ieps_total\n        costo\n        descuento_porcentaje\n        descuento_precio\n        impuestos\n        mantener_precio\n        subtotal\n        total\n        subtotal_descuento\n        total_descuento\n      }\n      impuestos\n      subtotal\n      total\n      fecha_registro\n    }\n  }\n"]))),Ti=Object(z.d)(yi||(yi=Object(F.a)(["\n  query obtenerConsultaGeneralCompras($empresa: ID!, $sucursal: ID!) {\n    obtenerConsultaGeneralCompras(empresa: $empresa, sucursal: $sucursal) {\n      productos {\n        _id\n        datos_generales {\n          codigo_barras\n          clave_alterna\n          tipo_producto\n          nombre_comercial\n          nombre_generico\n          descripcion\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          ieps\n          ieps_activo\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n          }\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          precio_de_compra {\n            precio_con_impuesto\n            precio_sin_impuesto\n            iva\n            ieps\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            precio_venta\n            unidad_mayoreo\n            utilidad\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n          }\n          granel\n        }\n        imagenes {\n          url_imagen\n          location_imagen\n          key_imagen\n          extencion_imagen\n        }\n        centro_de_costos {\n          cuenta\n          id_cuenta\n          id_subcuenta\n          subcuenta\n        }\n        precio_plazos {\n          precio_cajas {\n            plazo\n            unidad\n            precio\n          }\n          precio_costales {\n            plazo\n            unidad\n            precio\n          }\n          precio_piezas {\n            plazo\n            unidad\n            precio\n          }\n        }\n        unidades_de_venta {\n          _id\n          precio\n          cantidad\n          concepto\n          unidad\n          unidad_principal\n          codigo_barras\n          id_producto\n          empresa\n          sucursal\n          descuento {\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n          descuento_activo\n          default\n        }\n        inventario_general {\n          _id\n          cantidad_existente\n          unidad_inventario\n          cantidad_existente_maxima\n          unidad_maxima\n        }\n        medidas_producto {\n          _id\n          cantidad\n          codigo_barras\n          color {\n            hex\n            nombre\n            _id\n          }\n          existencia\n          medida {\n            talla\n            tipo\n            _id\n          }\n          nombre_comercial\n          precio\n        }\n        medidas_registradas\n        empresa\n        sucursal\n        usuario\n      }\n      proveedores {\n        _id\n        numero_cliente\n        clave_cliente\n        representante\n        nombre_cliente\n        rfc\n        curp\n        telefono\n        celular\n        email\n        numero_descuento\n        limite_credito\n        dias_credito\n        razon_social\n        direccion {\n          calle\n          no_ext\n          no_int\n          codigo_postal\n          colonia\n          municipio\n          localidad\n          estado\n          pais\n        }\n        imagen\n        estado_cliente\n        tipo_cliente\n        banco\n        numero_cuenta\n        empresa {\n          _id\n        }\n        sucursal {\n          _id\n        }\n      }\n      almacenes {\n        _id\n        nombre_almacen\n        id_usuario_encargado {\n          _id\n          numero_usuario\n          nombre\n          email\n          imagen\n          estado_usuario\n        }\n        id_sucursal {\n          _id\n          nombre_sucursal\n          usuario_sucursal\n        }\n        direccion {\n          calle\n          no_ext\n          no_int\n          codigo_postal\n          colonia\n          municipio\n          localidad\n          estado\n          pais\n        }\n      }\n    }\n  }\n"]))),Wi=Object(z.d)(Si||(Si=Object(F.a)(["\n  mutation eliminarCompraEnEspera($id: ID!) {\n    eliminarCompraEnEspera(id: $id) {\n      message\n    }\n  }\n"]))),Ri=a(885),$i={producto:{},costo:0,cantidad:0,cantidad_regalo:0,unidad_regalo:"",cantidad_total:0,descuento_porcentaje:0,descuento_precio:0,iva_total:0,ieps_total:0,subtotal:0,impuestos:0,total:0,mantener_precio:!0,subtotal_descuento:0,total_descuento:0},Mi={productos:[],proveedor:{},en_espera:!1,fecha_registro:xt()().locale("es-mx").format(),almacen:{},compra_credito:!1,fecha_vencimiento_credito:xt()().locale("es-mx").format(),credito_pagado:!1,saldo_credito_pendiente:0,forma_pago:"",descuento_aplicado:!1,descuento:{porcentaje:0,cantidad_descontada:0,precio_con_descuento:0},subtotal:0,impuestos:0,total:0},Li=[{numero_precio:1,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:2,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:3,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:4,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:5,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:6,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0}],Vi={precios:ne},Ui=[];function Bi(e){e.refetchProductos;var t=e.getProductos,a=(e.status,JSON.parse(localStorage.getItem("sesionCafi"))),n=Object(s.useContext)(ka),c=n.datosCompra,r=n.setDatosCompra,i=n.setDatosProducto,o=n.productosCompra,l=Object(s.useContext)(xe),d=l.setDatosGenerales,j=l.setPrecios,p=l.setValidacion,m=l.setPreciosP,O=l.setImagenes,x=l.setUnidadesVenta,f=l.almacen_inicial,g=l.setAlmacenInicial,_=l.setUnidadVentaXDefecto,v=l.setCentroDeCostos,C=l.setPreciosPlazos,y=l.setSubcategorias,w=l.setOnPreview,k=l.setSubcostos,N=l.setImagenesEliminadas,F=l.setPresentaciones,z=l.setPresentacionesEliminadas,P=Object(He.a)(Ti,{variables:{sucursal:a.sucursal._id,empresa:a.empresa._id}}),D=P.loading,E=P.data,A=P.error,T=P.refetch,W=function(e,n){n?"proveedor"===e?r(Object(u.a)(Object(u.a)({},c),{},{proveedor:{id_proveedor:n._id,nombre_cliente:n.nombre_cliente,numero_cliente:n.numero_cliente,clave_cliente:n.clave_cliente}})):(i($i),R(),r(Object(u.a)(Object(u.a)({},c),{},{almacen:{id_almacen:n._id,nombre_almacen:n.nombre_almacen}})),g(Object(u.a)(Object(u.a)({},f),{},{id_almacen:n._id,almacen:n.nombre_almacen})),t({variables:{almacen:n._id,empresa:a.empresa._id,sucursal:a.sucursal._id}})):r(Object(u.a)(Object(u.a)({},c),{},Object(h.a)({},e,{})))},R=function(){d(ae),j(ne),_(ce),m(re),x([]),g(oe),v({}),C(le),y([]),O([]),w({index:"",image:""}),p({error:!1,message:""}),k([]),N([]),F([]),z([])},$=Object(V.jsx)(Fe.a,{item:!0,xs:12,md:4,children:Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(S.a,{size:"small",fullWidth:!0,value:"Error",error:!0,disabled:!0,variant:"outlined"}),Object(V.jsx)(X.a,{disabled:!0,children:Object(V.jsx)(Ri.a,{fontSize:"default"})})]})}),M=Object(V.jsx)(Fe.a,{item:!0,xs:12,md:4,children:Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(S.a,{size:"small",fullWidth:!0,disabled:!0,value:"Cargando...",variant:"outlined"}),Object(V.jsx)(X.a,{disabled:!0,children:Object(V.jsx)(I.a,{size:24})})]})});if(D)return Object(V.jsxs)(Fe.a,{container:!0,spacing:2,alignItems:"center",children:[M,M,M]});if(A)return Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(Fe.a,{container:!0,spacing:2,alignItems:"center",children:[$,$,$]})});var L=E.obtenerConsultaGeneralCompras,U=L.almacenes,B=L.proveedores;return Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(Fe.a,{container:!0,spacing:2,alignItems:"center",children:[Object(V.jsx)(Fe.a,{item:!0,xs:12,md:4,children:Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(ta.a,{disabled:o.length>0,id:"combo-box-proveedor",size:"small",fullWidth:!0,options:B,getOptionLabel:function(e){return e.nombre_cliente},renderInput:function(e){return Object(V.jsx)(S.a,Object(u.a)(Object(u.a)({},e),{},{label:"Proveedor",variant:"outlined"}))},onChange:function(e,t){return W("proveedor",t)},getOptionSelected:function(e){return e.nombre_cliente},value:c.proveedor.nombre_cliente?c.proveedor:null}),Object(V.jsx)(ji,{children:Object(V.jsx)(zi,{accion:"registrar",tipo:"PROVEEDOR",refetch:T})})]})}),Object(V.jsx)(Fe.a,{item:!0,xs:12,md:4,children:Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(ta.a,{disabled:o.length>0,id:"combo-box-almacen",size:"small",fullWidth:!0,options:U,getOptionLabel:function(e){return e.nombre_almacen},renderInput:function(e){return Object(V.jsx)(S.a,Object(u.a)(Object(u.a)({},e),{},{label:"Almacen",variant:"outlined"}))},onChange:function(e,t){return W("almacen",t)},getOptionSelected:function(e){return e.nombre_almacen},value:c.almacen.nombre_almacen?c.almacen:null}),Object(V.jsx)(yn,{children:Object(V.jsx)($n,{accion:"registrar",refetch:T})})]})}),Object(V.jsx)(Fe.a,{item:!0,xs:12,md:4,children:Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",type:"date",onChange:function(e){console.log(e.target.value),r(Object(u.a)(Object(u.a)({},c),{},{fecha_registro:e.target.value}))},value:c.fecha_registro})})})]})})}function Ji(){var e=Object(s.useContext)(ka).datosProducto,t=Object(s.useContext)(xe).presentaciones;if(t.length>0){var a=0,n=0;return t.forEach((function(e){var t=e.cantidad,n=e.cantidad_nueva;a+=t+(n||0)})),isNaN(a)&&(n=0),n=a,Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{style:{fontSize:16},children:"Subtotal:"}),Object(V.jsx)(y.a,{style:{fontSize:18},children:Object(V.jsxs)("b",{children:["$",Ze(e.subtotal_descuento*n)]})})]}),Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{style:{fontSize:16},children:"Impuestos:"}),Object(V.jsx)(y.a,{style:{fontSize:18},children:Object(V.jsxs)("b",{children:["$",Ze(e.impuestos*n)]})})]}),Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{style:{fontSize:16},children:"Descuento:"}),Object(V.jsx)(y.a,{style:{fontSize:18},children:Object(V.jsxs)("b",{children:[e.descuento_porcentaje,"%"]})})]}),Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{style:{fontSize:16},children:"Total:"}),Object(V.jsx)(y.a,{style:{fontSize:18},children:Object(V.jsxs)("b",{children:["$",Ze(e.total_descuento*n)]})})]})]})}return Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{style:{fontSize:16},children:"Subtotal:"}),Object(V.jsx)(y.a,{style:{fontSize:18},children:Object(V.jsxs)("b",{children:["$",Ze(e.subtotal_descuento*e.cantidad)]})})]}),Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{style:{fontSize:16},children:"Impuestos:"}),Object(V.jsx)(y.a,{style:{fontSize:18},children:Object(V.jsxs)("b",{children:["$",Ze(e.impuestos*e.cantidad)]})})]}),Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{style:{fontSize:16},children:"Descuento:"}),Object(V.jsx)(y.a,{style:{fontSize:18},children:Object(V.jsxs)("b",{children:[e.descuento_porcentaje,"%"]})})]}),Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{style:{fontSize:16},children:"Total:"}),Object(V.jsx)(y.a,{style:{fontSize:18},children:Object(V.jsxs)("b",{children:["$",Ze(e.total_descuento*e.cantidad)]})})]})]})}var Gi=["precios_producto"];function qi(e){var t=e.status,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(s.useContext)(ka),c=n.datosProducto,r=n.setDatosProducto,i=n.productosCompra,o=n.setProductosCompra,l=n.datosCompra,d=n.productoOriginal,j=n.setProductoOriginal,p=n.setPreciosVenta,m=n.setDatosCompra,O=n.isEditing,x=n.setIsEditing,f=n.editFinish,C=n.setEditFinish,k=n.costo,N=n.setCosto,F=n.cantidad,z=n.setCantidad,P=n.loadingProductos,D=n.setLoadingProductos,E=Object(s.useContext)(xe),A=E.datos_generales,T=E.setDatosGenerales,W=E.precios,R=E.setPrecios,$=E.setValidacion,M=E.preciosP,L=E.setPreciosP,U=E.imagenes,B=E.setImagenes,J=E.unidadesVenta,q=E.setUnidadesVenta,H=E.almacen_inicial,K=E.setAlmacenInicial,Q=E.unidadVentaXDefecto,Z=E.setUnidadVentaXDefecto,ee=E.centro_de_costos,te=E.setCentroDeCostos,re=E.preciosPlazos,ie=E.setPreciosPlazos,de=E.setSubcategorias,je=E.setOnPreview,ue=E.setSubcostos,be=E.imagenes_eliminadas,pe=E.setImagenesEliminadas,me=E.presentaciones,Oe=E.setPresentaciones,he=E.presentaciones_eliminadas,ge=E.setPresentacionesEliminadas,_e=E.setAlmacenExistente,ve=Object(s.useState)(!1),Ce=Object(v.a)(ve,2),ye=Ce[0],Se=Ce[1],we=0;"enEspera"===t&&l&&(we=1);var Ie=Object(s.useState)(!1),ke=Object(v.a)(Ie,2),Ne=ke[0],ze=ke[1],Pe=Object(ri.a)(On,{variables:{empresa:a.empresa._id,sucursal:a.sucursal._id},fetchPolicy:"network-only"}),Ae=Object(v.a)(Pe,2),Te=Ae[0],We=Ae[1],Re=We.loading,$e=We.data,Me=We.error,Le=We.refetch,Ve=Object(ha.useDebounce)(k,500),Ue=Object(v.a)(Ve,1)[0],Be=Object(ha.useDebounce)(F,500),Ge=Object(v.a)(Be,1)[0];if(Object(s.useEffect)((function(){D(!!Re)}),[Re]),Object(s.useEffect)((function(){$e&&Ke(Ue)}),[Ue]),Object(s.useEffect)((function(){$e&&Ye(Ge)}),[Ge]),Object(s.useEffect)((function(){1===we&&Te({variables:{almacen:l.almacen._id,empresa:a.empresa._id,sucursal:a.sucursal._id}})}),[we]),Re)return Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"20vh",children:[Object(V.jsx)(I.a,{}),Object(V.jsx)(y.a,{variant:"h5",children:"Cargando"})]});if(Me)return Object(V.jsx)(Je,{error:Me,altura:200});var qe=[];$e&&(qe=$e.obtenerProductos);var He=function(e){if(!e)return r($i),N(0),z(0),void et();var t=e.precios.precio_de_compra,a=t.ieps,n=t.iva,i=t.precio_con_impuesto,o=t.precio_sin_impuesto,s=n+a;r(Object(u.a)(Object(u.a)({},c),{},{producto:e,id_producto:e._id,costo:i,cantidad:1,unidad_regalo:e.precios.unidad_de_compra.unidad,descuento_porcentaje:0,descuento_precio:0,subtotal:o,impuestos:parseFloat(s.toFixed(6)),total:i,subtotal_descuento:o,total_descuento:i})),Ze(e),N(i),z(1),j(e),p(e.precios.precios_producto)},Ye=function(e){r(e?Object(u.a)(Object(u.a)({},c),{},{cantidad:parseFloat(e)}):Object(u.a)(Object(u.a)({},c),{},{cantidad:""}))},Xe=function(e){var t=e.target,a=t.value,n=t.name;r(Object(u.a)(Object(u.a)({},c),{},Object(h.a)({},n,a)))},Ke=function(e){if(e){var t=c.producto.precios,a=t.iva,n=t.ieps,i=t.precio_de_compra,o=i.iva,s=i.ieps,l=parseFloat(e),d=0,j=0,b=0,p=l-(o+s),m=parseFloat(p)*parseFloat(a<10?".0"+a:"."+a),O=parseFloat(p)*parseFloat(n<10?".0"+n:"."+n)+m;if(c.descuento_porcentaje>0)return j=(d=p-(b=Math.round(p*c.descuento_porcentaje/100)))+O,void r(Object(u.a)(Object(u.a)({},c),{},{costo:parseFloat(l),descuento_precio:parseFloat(b),subtotal_descuento:parseFloat(d),total_descuento:parseFloat(j)}));r(Object(u.a)(Object(u.a)({},c),{},{costo:parseFloat(l),subtotal_descuento:parseFloat(p),total_descuento:parseFloat(p+O)}))}else r(Object(u.a)(Object(u.a)({},c),{},{costo:""}))},Qe=function(){var e=Object(_.a)(g.a.mark((function e(t){var n,s,d,b,p,h,_,v,y,S,w,I,k,F,P,D,E,T,R,$,L,V,B,G,q,Y,X,K,Z,te,ae,ce,ie,oe,se,le;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(u.a)({},c),s=Object(u.a)({},A),d=Object(ea.a)(me),b=Object(u.a)({},W),p=Object(ea.a)(M),h=Object(u.a)({},H),_=Object(u.a)({},ee),v=Object(ea.a)(he),y=Object(u.a)({},re),ze(!0),n.producto.datos_generales&&l.proveedor.nombre_cliente&&l.almacen.nombre_almacen){e.next=13;break}return ze(!1),e.abrupt("return");case 13:if("OTROS"===s.tipo_producto){e.next=25;break}if(!(d.length>0)){e.next=22;break}if(d.filter((function(e){return e.color._id&&e.medida._id&&e.existencia})).length===d.length){e.next=20;break}return Se(!0),ze(!1),e.abrupt("return");case 20:e.next=25;break;case 22:return Se(!0),ze(!1),e.abrupt("return");case 25:return 0===(S=Object(ea.a)(J)).length?S.push(Q):0===S.filter((function(e){return!0===e.default})).length&&S.splice(0,0,Q),n.mantener_precio=!t,b.precios_producto=p,e.next=31,Xr(s,"datos_generales");case 31:return e.t0=e.sent,e.t1=b,e.t2=U,e.t3=be,e.t4=h,e.t5=_,e.next=39,Xr(S,"unidades_de_venta");case 39:e.t6=e.sent,e.t7=d,e.t8=v,e.t9=y,e.t10=a.empresa._id,e.t11=a.sucursal._id,e.t12=a._id,w={datos_generales:e.t0,precios:e.t1,imagenes:e.t2,imagenes_eliminadas:e.t3,almacen_inicial:e.t4,centro_de_costos:e.t5,unidades_de_venta:e.t6,presentaciones:e.t7,presentaciones_eliminadas:e.t8,precio_plazos:e.t9,empresa:e.t10,sucursal:e.t11,usuario:e.t12},n.producto=w,"OTROS"!==n.producto.datos_generales.tipo_producto?n.producto.presentaciones.length>0?(n.cantidad=0,n.producto.presentaciones.forEach((function(e){var t=e.cantidad,a=e.cantidad_nueva,c=a||0;n.cantidad+=t+c})),isNaN(n.cantidad)&&(n.cantidad=0),n.cantidad_total=n.cantidad):(n.cantidad=0,n.cantidad_total=n.cantidad):(I=n.cantidad_regalo,k=n.cantidad,F=n.unidad_regalo,P=n.producto.precios.unidad_de_compra.cantidad,E=k*P+(D="Pz"===F||"Kg"===F||"Lt"===F?I:I*P),P>1?(n.cantidad_regalo=D/P,n.cantidad_total=E/P):(n.cantidad_regalo=D,n.cantidad_total=E)),n.subtotal=n.subtotal_descuento,n.total=n.total_descuento,O.producto?(T=Object(ea.a)(i),R=n.producto.precios.precio_de_compra,$=R.iva,L=R.ieps,n.iva_total=$*n.cantidad_total,n.ieps_total=L*n.cantidad_total,n.subtotal=n.subtotal*n.cantidad_total,n.impuestos=n.impuestos*n.cantidad_total,n.total=n.total*n.cantidad_total,V=l.subtotal+n.subtotal*n.cantidad_total-O.producto.subtotal,B=l.impuestos+n.impuestos*n.cantidad_total-O.producto.impuestos,G=l.total+n.total*n.cantidad_total-O.producto.total,T.splice(O.index,1,n),o(T),m(Object(u.a)(Object(u.a)({},l),{},{subtotal:V,impuestos:B,total:G})),x({}),C(!f),j({precios:ne}),r($i),N(0),z(0),ze(!1)):(q=i.map((function(e,t){return e.id_producto===n.id_producto?{prod_exist:e,index:t}:""})).filter(Boolean),q.length>0?(Y=Object(ea.a)(i),X=q[0],K=X.index,Z=X.prod_exist,te=n.producto.precios.precio_de_compra,ae=te.iva,ce=te.ieps,n.iva_total=ae*n.cantidad_total,n.ieps_total=ce*n.cantidad_total,n.subtotal=n.subtotal*n.cantidad_total,n.impuestos=n.impuestos*n.cantidad_total,n.total=n.total*n.cantidad_total,Y.splice(K,1,n),o(Y),m(Object(u.a)(Object(u.a)({},l),{},{subtotal:l.subtotal-Z.subtotal+n.subtotal,impuestos:l.impuestos-Z.impuestos+n.impuestos,total:l.total-Z.total+n.total}))):(ie=Object(ea.a)(i),oe=n.producto.precios.precio_de_compra,se=oe.iva,le=oe.ieps,n.iva_total=se*n.cantidad_total,n.ieps_total=le*n.cantidad_total,n.subtotal=n.subtotal*n.cantidad_total,n.impuestos=n.impuestos*n.cantidad_total,n.total=n.total*n.cantidad_total,ie.splice(0,0,n),o(ie),m(Object(u.a)(Object(u.a)({},l),{},{subtotal:l.subtotal+n.subtotal,impuestos:l.impuestos+n.impuestos,total:l.total+n.total}))),j({precios:ne}),r($i),N(0),z(0),ze(!1));case 52:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ze=function(e){var t=e.precios,a=(t.precios_producto,Object(fe.a)(t,Gi)),n=e.unidades_de_venta.filter((function(e){return!e.default})),c=e.unidades_de_venta.filter((function(e){return!0===e.default}));T(e.datos_generales),R(a),te(e.centro_de_costos?e.centro_de_costos:se),B(e.imagenes),ie(e.precio_plazos),q(n),L(e.precios.precios_producto),Z(c[0]),Oe(e.medidas_producto?e.medidas_producto:[]),l.almacen.id_almacen&&0===e.medidas_producto.length&&K(Object(u.a)(Object(u.a)({},H),{},{id_almacen:l.almacen.id_almacen,almacen:l.almacen.nombre_almacen})),e.inventario_general.length>0?_e(!0):_e(!1)},et=function(){T(ae),R(ne),Z(ce),L(Zr),q([]),K(oe),te({}),ie(le),de([]),B([]),je({index:"",image:""}),$({error:!1,message:""}),ue([]),pe([]),Oe([]),ge([])};return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(Bi,{status:t,refetchProductos:Le,getProductos:Te}),Object(V.jsx)(b.a,{my:1}),Object(V.jsxs)(Fe.a,{container:!0,spacing:1,alignItems:"center",children:[Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{children:"C\xf3digo de barras"}),Object(V.jsx)(b.a,{width:200,children:Object(V.jsx)(ta.a,{id:"combo-box-producto-codigo",size:"small",fullWidth:!0,options:qe,getOptionLabel:function(e){return e.datos_generales.codigo_barras?e.datos_generales.codigo_barras:"N/A"},renderInput:function(e){return Object(V.jsx)(S.a,Object(u.a)(Object(u.a)({},e),{},{variant:"outlined"}))},onChange:function(e,t){return He(t)},getOptionSelected:function(e,t){return e._id===t._id},value:c.producto.datos_generales?c.producto:null,disabled:!l.almacen.id_almacen||!l.proveedor.id_proveedor})})]}),Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{children:"Producto"}),Object(V.jsxs)(b.a,{display:"flex",width:250,alignItems:"center",children:[Object(V.jsx)(ta.a,{id:"combo-box-producto-nombre",size:"small",fullWidth:!0,options:qe,getOptionLabel:function(e){return e.datos_generales.nombre_comercial},renderInput:function(e){return Object(V.jsx)(S.a,Object(u.a)(Object(u.a)({},e),{},{variant:"outlined"}))},onChange:function(e,t){return He(t)},getOptionSelected:function(e,t){return e._id===t._id},value:c.producto.datos_generales?c.producto:null,disabled:!l.almacen.id_almacen||!l.proveedor.id_proveedor}),l.almacen.id_almacen&&l.proveedor.id_proveedor?Object(V.jsx)(ni,{accion:!1,productosRefetch:Le,fromCompra:!0}):Object(V.jsx)(X.a,{disabled:!0,children:Object(V.jsx)(En.a,{})})]})]}),Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{children:"Clave"}),Object(V.jsx)(b.a,{width:140,children:Object(V.jsx)(ta.a,{id:"combo-box-producto-clave",size:"small",fullWidth:!0,options:qe,getOptionLabel:function(e){return e.datos_generales.clave_alterna},renderInput:function(e){return Object(V.jsx)(S.a,Object(u.a)(Object(u.a)({},e),{},{variant:"outlined"}))},onChange:function(e,t){return He(t)},getOptionSelected:function(e,t){return e._id===t._id},value:c.producto.datos_generales?c.producto:null,disabled:!l.almacen.id_almacen||!l.proveedor.id_proveedor})})]}),Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{children:"Costo"}),Object(V.jsx)(b.a,{width:100,children:Object(V.jsx)(S.a,{inputMode:"decimal",name:"costo",variant:"outlined",size:"small",fullWidth:!0,disabled:!c.producto.datos_generales,value:k,onChange:function(e){return N(e.target.value)},InputProps:{startAdornment:Object(V.jsx)(Y.a,{position:"start",children:"$"})}})})]}),c.producto.datos_generales&&"OTROS"===c.producto.datos_generales.tipo_producto?Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{children:"Unidad"}),Object(V.jsx)(b.a,{width:100,children:Object(V.jsx)(S.a,{variant:"outlined",size:"small",fullWidth:!0,"aria-readonly":"true",value:c.producto.precios.unidad_de_compra.unidad})})]}),Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{children:"Cantidad"}),Object(V.jsx)(b.a,{width:100,children:Object(V.jsx)(S.a,{name:"cantidad",variant:"outlined",size:"small",fullWidth:!0,inputMode:"numeric",disabled:!c.producto.datos_generales,value:F,onChange:function(e){return z(e.target.value)}})})]}),Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{children:"Cant. regalo"}),Object(V.jsx)(b.a,{width:100,children:Object(V.jsx)(S.a,{name:"cantidad_regalo",variant:"outlined",size:"small",fullWidth:!0,inputMode:"numeric",disabled:!c.producto.datos_generales,value:c.cantidad_regalo,onChange:function(e){return t=e.target.value,void r(t?Object(u.a)(Object(u.a)({},c),{},{cantidad_regalo:parseFloat(t)}):Object(u.a)(Object(u.a)({},c),{},{cantidad_regalo:""}));var t}})})]}),Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{children:"Unidad. regalo"}),Object(V.jsx)(b.a,{width:100,children:Object(V.jsx)(G.a,{variant:"outlined",size:"small",name:"unidad_regalo",fullWidth:!0,children:c.producto.precios.granel?Object(V.jsxs)(De.a,{id:"select-unidad-regalo",disabled:!c.producto.datos_generales,name:"unidad_regalo",value:c.unidad_regalo,onChange:Xe,children:[Object(V.jsx)(Ee.a,{value:"Kg",children:"Kg"}),Object(V.jsx)(Ee.a,{value:"Costal",children:"Costal"}),Object(V.jsx)(Ee.a,{value:"Lt",children:"Lt"})]}):Object(V.jsxs)(De.a,{id:"select-unidad-regalo",disabled:!c.producto.datos_generales,name:"unidad_regalo",value:c.unidad_regalo,onChange:Xe,children:[Object(V.jsx)(Ee.a,{value:"Caja",children:"Caja"}),Object(V.jsx)(Ee.a,{value:"Pz",children:"Pz"})]})})})]})]}):null,Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsx)(y.a,{children:"Descuento"}),Object(V.jsx)(li,{})]})]}),Object(V.jsx)(b.a,{mt:1,children:Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,xs:12,md:7,padding:"checkbox",children:Object(V.jsx)(ii,{})}),Object(V.jsxs)(Fe.a,{item:!0,xs:12,md:5,style:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(Ji,{})}),Object(V.jsxs)(b.a,{display:"flex",children:[c.producto.datos_generales&&"OTROS"!==c.producto.datos_generales.tipo_producto?Object(V.jsx)(jc,{verificate:ye,setVerificate:Se}):null,Object(V.jsx)(b.a,{mx:1}),c.costo!==d.precios.precio_de_compra.precio_con_impuesto?Object(V.jsx)(Yi,{agregarCompra:Qe,cargando:Ne}):Object(V.jsx)(w.a,{style:P?{pointerEvents:"none",opacity:.4}:null,variant:"contained",color:"primary",startIcon:Ne?Object(V.jsx)(I.a,{color:"inherit",size:20}):Object(V.jsx)(En.a,{}),disableElevation:!0,disabled:!c.producto.datos_generales||("OTROS"===c.producto.datos_generales.tipo_producto?!(l.proveedor.nombre_cliente&&l.almacen.nombre_almacen&&c.costo&&c.cantidad):!(l.proveedor.nombre_cliente&&l.almacen.nombre_almacen&&c.costo)),onClick:function(){return Qe()},children:O.producto?"Actualizar ":"Agregar a compra"})]})]})]})})]})}var Hi=Object(s.forwardRef)((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),Yi=function(e){var t=e.agregarCompra,a=e.cargando,n=Object(s.useState)(!1),c=Object(v.a)(n,2),r=c[0],i=c[1],o=Object(s.useContext)(ka),l=o.datosProducto,d=o.datosCompra,j=o.isEditing,u=o.loadingProductos,b=function(){i(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{style:u?{pointerEvents:"none",opacity:.4}:null,variant:"contained",color:"primary",startIcon:Object(V.jsx)(En.a,{}),disableElevation:!0,disabled:!l.producto.datos_generales||("OTROS"===l.producto.datos_generales.tipo_producto?!(d.proveedor.nombre_cliente&&d.almacen.nombre_almacen&&l.costo&&l.cantidad):!(d.proveedor.nombre_cliente&&d.almacen.nombre_almacen&&l.costo)),onClick:function(){i(!0)},children:j.producto?"Actualizar ":"Agregar a compra"}),Object(V.jsxs)(ze.a,{open:r,TransitionComponent:Hi,keepMounted:!0,onClose:function(){return b()},"aria-labelledby":"modal-agregar-compra",children:[Object(V.jsx)(wt.a,{id:"modal-agregar-compra",style:{padding:0},children:Object(V.jsxs)(yt.a,{severity:"info",icon:Object(V.jsx)(si.a,{style:{fontSize:30}}),style:{padding:16},children:[Object(V.jsx)(St.a,{style:{fontSize:20},children:"El costo es diferente al precio de compra actual"}),Object(V.jsx)(y.a,{style:{fontSize:18},children:"\xbfDesea actualizar los precios o mantenerlos?"})]})}),Object(V.jsxs)(We.a,{style:{display:"flex",justifyContent:"center"},children:[Object(V.jsx)(w.a,{onClick:function(){return b()},color:"default",children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){t(),b()},color:"primary",children:"Mantener"}),Object(V.jsx)(cn,{cargando:a,handleClose:b,agregarCompra:t})]})]})]})},Xi=a(455),Ki=a.n(Xi),Qi=a(888),Zi=["precios_producto"],eo=function(e,t,a){var n=t.setDatosGenerales,c=t.setPrecios,r=t.setValidacion,i=t.setPreciosP,o=t.setImagenes,s=t.setUnidadesVenta,l=t.almacen_inicial,d=t.setAlmacenInicial,j=t.setUnidadVentaXDefecto,b=t.setCentroDeCostos,p=t.setPreciosPlazos,m=t.setSubcategorias,O=t.setOnPreview,x=t.setSubcostos,h=t.setImagenesEliminadas,f=t.setPresentaciones,g=t.setPresentacionesEliminadas,_=t.datosCompra;if("SET"===e){var v=a.precios,C=(v.precios_producto,Object(fe.a)(v,Zi)),y=a.unidades_de_venta.filter((function(e){return e.default}));n(a.datos_generales),c(C),b(a.centro_de_costos?a.centro_de_costos:se),o(a.imagenes),p(a.precio_plazos),s(a.unidades_de_venta),i(a.precios.precios_producto),j(y[0]),f(a.presentaciones?a.presentaciones:[]),_.almacen.id_almacen&&0===a.presentaciones.length&&d(Object(u.a)(Object(u.a)({},l),{},{id_almacen:_.almacen.id_almacen,almacen:_.almacen.nombre_almacen}))}else n(ae),c(ne),j(ce),i(Zr),s([]),d(oe),b({}),p(le),m([]),o([]),O({index:"",image:""}),r({error:!1,message:""}),x([]),h([]),f([]),g([])},to=Object(k.a)({root:{width:"100%"},container:{height:"40vh"}});function ao(){var e=to(),t=Object(s.useContext)(ka),a=t.productosCompra,n=t.loadingProductos,c=t.datosCompra,r=Object(ea.a)(a);return Object(V.jsxs)(Da.a,{className:e.root,variant:"outlined",children:[Object(V.jsx)(ra.a,{className:e.container,style:n?{pointerEvents:"none",opacity:.4}:null,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"C\xf3digo de barras"}),Object(V.jsx)(sa.a,{children:"Producto"}),Object(V.jsx)(sa.a,{children:"Precio de compra"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Cantidad"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Cantidad regalo"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Cantidad total"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Presentaciones"}),Object(V.jsx)(sa.a,{children:"IVA"}),Object(V.jsx)(sa.a,{children:"IEPS"}),Object(V.jsx)(sa.a,{children:"Total IVA"}),Object(V.jsx)(sa.a,{children:"Total IEPS"}),Object(V.jsx)(sa.a,{children:"Editar"}),Object(V.jsx)(sa.a,{children:"Remover"})]})}),Object(V.jsx)(la.a,{children:r.map((function(e,t){return Object(V.jsx)(no,{producto:e,index:t},t)}))})]})}),Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsxs)(y.a,{style:{fontSize:18},children:["Subtotal: ",Object(V.jsxs)("b",{children:["$",c.subtotal?Ze(c.subtotal):0]})]})}),Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsxs)(y.a,{style:{fontSize:18},children:["Impuestos: ",Object(V.jsxs)("b",{children:["$",c.impuestos?Ze(c.impuestos):0]})]})}),Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsx)(y.a,{style:{fontSize:18},children:Object(V.jsxs)("b",{children:["Total: $",c.total?Ze(c.total):0]})})})]})]})}var no=function(e){var t=e.producto,a=e.index,n=Object(s.useContext)(ka),c=n.datosCompra,r=n.setDatosProducto,i=n.setProductoOriginal,o=n.setPreciosVenta,l=n.isEditing,d=n.setIsEditing,j=n.editFinish,u=n.setCosto,b=n.setCantidad,p=n.setIssue,m=Object(s.useState)(!1),O=Object(v.a)(m,2),x=O[0],h=O[1],f=Object(s.useContext)(xe),g={setDatosGenerales:f.setDatosGenerales,setPrecios:f.setPrecios,setValidacion:f.setValidacion,setPreciosP:f.setPreciosP,setImagenes:f.setImagenes,setUnidadesVenta:f.setUnidadesVenta,almacen_inicial:f.almacen_inicial,setAlmacenInicial:f.setAlmacenInicial,setUnidadVentaXDefecto:f.setUnidadVentaXDefecto,setCentroDeCostos:f.setCentroDeCostos,setPreciosPlazos:f.setPreciosPlazos,setSubcategorias:f.setSubcategorias,setOnPreview:f.setOnPreview,setSubcostos:f.setSubcostos,setImagenesEliminadas:f.setImagenesEliminadas,setPresentaciones:f.setPresentaciones,setPresentacionesEliminadas:f.setPresentacionesEliminadas,datosCompra:c};Object(s.useEffect)((function(){h(!1)}),[j]),Object(s.useEffect)((function(){t.cantidad&&p(!1)}),[t.cantidad]);var _=t.producto.precios.unidad_de_compra.unidad,C=t.cantidad,y=t.cantidad_regalo,S=t.cantidad_total;return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:x||!C,style:l.producto&&!x?{pointerEvents:"none",opacity:.4}:null,children:[Object(V.jsx)(sa.a,{children:t.producto.datos_generales&&t.producto.datos_generales.codigo_barras?t.producto.datos_generales.codigo_barras:"-"}),Object(V.jsx)(sa.a,{children:t.producto.datos_generales.nombre_comercial}),Object(V.jsx)(sa.a,{width:180,children:C?Object(V.jsxs)("b",{children:["$ ",Ze(t.total)]}):Object(V.jsx)(Qi.a,{color:"error"})}),Object(V.jsxs)(sa.a,{children:[C,Object(V.jsxs)("b",{children:["(",_,")"]})]}),Object(V.jsxs)(sa.a,{children:[y,Object(V.jsxs)("b",{children:["(",_,")"]})]}),Object(V.jsxs)(sa.a,{children:[S,Object(V.jsxs)("b",{children:["(",_,")"]})]}),Object(V.jsx)(sa.a,{children:t.producto.presentaciones.length>0?t.producto.presentaciones.length:"N/A"}),Object(V.jsxs)(sa.a,{children:[t.producto.precios.iva,"%"]}),Object(V.jsxs)(sa.a,{children:[t.producto.precios.ieps,"%"]}),Object(V.jsxs)(sa.a,{children:["$",t.iva_total]}),Object(V.jsxs)(sa.a,{children:["$",t.ieps_total]}),Object(V.jsx)(sa.a,{children:x?Object(V.jsx)(X.a,{color:"inherit",size:"small",onClick:function(){return h(!1),d({}),r($i),eo("RESET",g),u(0),void b(1)},children:Object(V.jsx)(zt.a,{})}):Object(V.jsx)(X.a,{color:"primary",size:"small",onClick:function(){return h(!0),d({producto:t,index:a,finish:!1}),r(t),eo("SET",g,t.producto),i(t.producto),o(t.producto.precios.precios_producto),u(t.costo),void b(t.cantidad)},children:Object(V.jsx)($a.a,{})})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(ro,{index:a,isSelected:x})})]})},co=Object(s.forwardRef)((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),ro=function(e){var t=e.index,a=e.isSelected,n=Object(s.useContext)(ka),c=n.productosCompra,r=n.setProductosCompra,i=n.datosCompra,o=n.setDatosCompra,l=Object(s.useState)(!1),d=Object(v.a)(l,2),j=d[0],b=d[1],p=function(){b(!1)};return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(X.a,{color:"secondary",size:"small",onClick:function(){b(!0)},disabled:a,children:Object(V.jsx)(Ki.a,{})}),Object(V.jsxs)(ze.a,{open:j,TransitionComponent:co,keepMounted:!0,onClose:p,"aria-labelledby":"modal-eliminar-compra",children:[Object(V.jsx)(wt.a,{id:"modal-eliminar-compra",children:"Seguro que quiere eliminar esto de la lista?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:p,color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){var e=Object(ea.a)(c),a=e.splice(t,1);o(Object(u.a)(Object(u.a)({},i),{},{subtotal:i.subtotal-a[0].subtotal,impuestos:i.impuestos-a[0].impuestos,total:i.total-a[0].total})),r(Object(ea.a)(e)),p()},color:"secondary",children:"Aceptar"})]})]})]})},io=a(890),oo=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function so(e){var t=e.realizarCompraBD,a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useContext)(ka),p=j.productosCompra,m=j.datosCompra,O=j.setDatosCompra,x=j.issue,h=j.descuentoCompra,f=j.setDescuentoCompra,g=function(){return r(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{autoFocus:!0,color:"primary",variant:"contained",size:"large",onClick:function(){return r(!0)},disabled:!p.length||x,startIcon:Object(V.jsx)(Pt.a,{}),children:"Realizar compra"}),Object(V.jsxs)(ze.a,{open:c,TransitionComponent:oo,keepMounted:!0,onClose:g,"aria-labelledby":"dialog-confirmacion-compra","aria-describedby":"dialog-confirmacion-compra-description",fullWidth:!0,maxWidth:"xs",children:[Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(b.a,{children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Total de productos:"})," "+p.length]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Subtotal:"})," $"+Ze(h.subtotal?h.subtotal:m.subtotal)]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Impuestos:"})," $"+Ze(m.impuestos)]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Total:"})," $"+Ze(h.total?h.total:m.total)]})]}),Object(V.jsxs)(b.a,{my:2,children:[Object(V.jsxs)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"forma_pago",children:[Object(V.jsx)(q.a,{id:"forma_pago",children:"Forma de pago"}),Object(V.jsx)(De.a,{labelId:"forma_pago",value:m.forma_pago,name:"forma_pago",onChange:function(e){return t=e.target.value,void O(Object(u.a)(Object(u.a)({},m),{},{forma_pago:t}));var t},label:"Forma de pago",children:_t.map((function(e,t){return Object(V.jsx)(Ee.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))})]}),Object(V.jsx)(aa.a,{control:Object(V.jsx)(na.a,{checked:h.descuento_aplicado,onChange:function(e){return t=e.target.checked,void f(t?Object(u.a)(Object(u.a)({},h),{},{descuento_aplicado:t}):Object(u.a)(Object(u.a)({},h),{},{subtotal:m.subtotal,total:m.total,descuento_aplicado:t,porcentaje:0,cantidad_descontada:0,precio_con_descuento:0}));var t},name:"descuento_aplicado"}),label:"Aplicar descuento"}),Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsx)(Fe.a,{item:!0,md:6,children:Object(V.jsx)(S.a,{variant:"outlined",size:"small",fullWidth:!0,onChange:function(e){return function(e){if(e&&0!==parseFloat(e)){var t=parseFloat(e),a=Math.round(t/m.subtotal*100),n=m.subtotal-t;f(Object(u.a)(Object(u.a)({},h),{},{subtotal:parseFloat(n.toFixed(2)),total:parseFloat((n+m.impuestos).toFixed(2)),porcentaje:a,cantidad_descontada:t,precio_con_descuento:parseFloat(n.toFixed(2))}))}else f(Object(u.a)(Object(u.a)({},h),{},{subtotal:m.subtotal,total:m.total,porcentaje:0,cantidad_descontada:0,precio_con_descuento:0}))}(e.target.value)},disabled:!h.descuento_aplicado,value:h.cantidad_descontada,InputProps:{startAdornment:Object(V.jsx)(Y.a,{position:"start",children:"$"})}})}),Object(V.jsx)(Fe.a,{item:!0,md:6,children:Object(V.jsx)(S.a,{variant:"outlined",type:"number",size:"small",fullWidth:!0,onChange:function(e){return function(e){if(e&&0!==parseFloat(e)){var t=parseFloat(e),a=Math.round(m.subtotal*t/100),n=m.subtotal-a;f(Object(u.a)(Object(u.a)({},h),{},{subtotal:parseFloat(n.toFixed(2)),total:parseFloat((n+m.impuestos).toFixed(2)),porcentaje:t,cantidad_descontada:a,precio_con_descuento:parseFloat(n.toFixed(2))}))}else f(Object(u.a)(Object(u.a)({},h),{},{subtotal:m.subtotal,total:m.total,porcentaje:0,cantidad_descontada:0,precio_con_descuento:0}))}(e.target.value)},disabled:!h.descuento_aplicado,value:h.porcentaje,InputProps:{startAdornment:Object(V.jsx)(Y.a,{position:"start",children:"%"})}})})]})]})]}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:g,color:"inherit",disabled:l,children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){return t(!1,void 0,g,d)},color:"primary",startIcon:l?Object(V.jsx)(I.a,{color:"inherit",size:20}):Object(V.jsx)(Pt.a,{}),disabled:l||!m.forma_pago,children:"Realizar Compra"})]})]})]})}var lo=a(889),jo=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function uo(e){var t=e.realizarCompraBD,a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useContext)(ka),p=j.productosCompra,m=j.datosCompra,O=j.setDatosCompra,x=j.issue,h=j.descuentoCompra,f=j.setDescuentoCompra,g=function(){return r(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{autoFocus:!0,color:"primary",size:"large",onClick:function(){return r(!0)},disabled:!p.length||x,startIcon:Object(V.jsx)(lo.a,{}),children:"Compra a Credito"}),Object(V.jsxs)(ze.a,{open:c,TransitionComponent:jo,keepMounted:!0,onClose:g,"aria-labelledby":"dialog-compra-credito","aria-describedby":"dialog-compra-credito-description",fullWidth:!0,maxWidth:"xs",children:[Object(V.jsx)(wt.a,{id:"dialog-compra-credito",children:"Comprar a credito"}),Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(b.a,{children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Total de productos:"})," "+p.length]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Subtotal:"})," $"+Ze(h.subtotal?h.subtotal:m.subtotal)]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Impuestos:"})," $"+Ze(m.impuestos)]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Total:"})," $"+Ze(h.total?h.total:m.total)]})]}),Object(V.jsxs)(b.a,{my:2,children:[Object(V.jsxs)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"forma_pago",children:[Object(V.jsx)(q.a,{id:"forma_pago",children:"Forma de pago"}),Object(V.jsx)(De.a,{labelId:"forma_pago",value:m.forma_pago,name:"forma_pago",onChange:function(e){return t=e.target.value,void O(Object(u.a)(Object(u.a)({},m),{},{forma_pago:t}));var t},label:"Forma de pago",children:_t.map((function(e,t){return Object(V.jsx)(Ee.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))})]}),Object(V.jsx)(aa.a,{control:Object(V.jsx)(na.a,{checked:h.descuento_aplicado,onChange:function(e){return t=e.target.checked,void f(t?Object(u.a)(Object(u.a)({},h),{},{descuento_aplicado:t}):Object(u.a)(Object(u.a)({},h),{},{subtotal:m.subtotal,total:m.total,descuento_aplicado:t,porcentaje:0,cantidad_descontada:0,precio_con_descuento:0}));var t},name:"descuento_aplicado"}),label:"Aplicar descuento"}),Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsx)(Fe.a,{item:!0,md:6,children:Object(V.jsx)(S.a,{variant:"outlined",size:"small",fullWidth:!0,onChange:function(e){return function(e){if(e&&0!==parseFloat(e)){var t=parseFloat(e),a=Math.round(t/m.subtotal*100),n=m.subtotal-t;f(Object(u.a)(Object(u.a)({},h),{},{subtotal:parseFloat(n.toFixed(2)),total:parseFloat((n+m.impuestos).toFixed(2)),porcentaje:a,cantidad_descontada:t,precio_con_descuento:parseFloat(n.toFixed(2))}))}else f(Object(u.a)(Object(u.a)({},h),{},{subtotal:m.subtotal,total:m.total,porcentaje:0,cantidad_descontada:0,precio_con_descuento:0}))}(e.target.value)},disabled:!h.descuento_aplicado,value:h.cantidad_descontada,InputProps:{startAdornment:Object(V.jsx)(Y.a,{position:"start",children:"$"})}})}),Object(V.jsx)(Fe.a,{item:!0,md:6,children:Object(V.jsx)(S.a,{variant:"outlined",type:"number",size:"small",fullWidth:!0,onChange:function(e){return function(e){if(e&&0!==parseFloat(e)){var t=parseFloat(e),a=Math.round(m.subtotal*t/100),n=m.subtotal-a;f(Object(u.a)(Object(u.a)({},h),{},{subtotal:parseFloat(n.toFixed(2)),total:parseFloat((n+m.impuestos).toFixed(2)),porcentaje:t,cantidad_descontada:a,precio_con_descuento:parseFloat(n.toFixed(2))}))}else f(Object(u.a)(Object(u.a)({},h),{},{subtotal:m.subtotal,total:m.total,porcentaje:0,cantidad_descontada:0,precio_con_descuento:0}))}(e.target.value)},disabled:!h.descuento_aplicado,value:h.porcentaje,InputProps:{startAdornment:Object(V.jsx)(Y.a,{position:"start",children:"%"})}})})]})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Fecha de vencimiento del cr\xe9dito"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",type:"date",onChange:function(e){O(Object(u.a)(Object(u.a)({},m),{},{fecha_vencimiento_credito:e.target.value}))},value:m.fecha_vencimiento_credito})]})]}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:g,color:"inherit",disabled:l,children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){return t(!1,"credito",g,d)},color:"primary",startIcon:l?Object(V.jsx)(I.a,{color:"inherit",size:20}):Object(V.jsx)(Pt.a,{}),disabled:l,children:"Realizar Compra"})]})]})]})}var bo=["descuento_aplicado","subtotal","total"],po=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100}}})),mo=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Oo(e){var t=e.compra,a=e.status,n=e.handleOpenDetalles,c=e.refetchEspera,r=po(),i=l.a.useState(!1),o=Object(v.a)(i,2),s=o[0],d=o[1],j=function(){d(!0)};return Object(V.jsxs)("div",{children:["enEspera"===a?Object(V.jsx)(w.a,{fullWidth:!0,onClick:j,color:"primary",variant:"contained",size:"large",startIcon:Object(V.jsx)(Pt.a,{}),children:"continuar compra"}):Object(V.jsx)(w.a,{fullWidth:!0,onClick:j,children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Ce.n,{className:r.icon})}),"Abrir una compra"]})}),Object(V.jsx)(Na,{children:Object(V.jsx)(xo,{open:s,handleClose:function(){d(!1),"enEspera"===a&&(n(),c())},status:a,compra:t})})]})}var xo=function(e){var t=e.open,a=e.handleClose,n=e.compra,c=e.status,r=po(),i=Object(s.useContext)(ka),o=i.productosCompra,l=i.datosCompra,d=i.setDatosProducto,j=i.setProductosCompra,p=i.setDatosCompra,m=i.setProductoOriginal,O=i.setPreciosVenta,x=(i.issue,i.descuentoCompra),h=i.setDescuentoCompra,f=Object(s.useState)(!1),C=Object(v.a)(f,2),S=C[0],I=C[1],k=JSON.parse(localStorage.getItem("sesionCafi")),F=Object(s.useState)({message:"",status:"",open:!1}),z=Object(v.a)(F,2),P=z[0],D=z[1],E=Object(s.useState)(!1),A=Object(v.a)(E,2),T=A[0],W=A[1],R=Object(N.a)(Pi),$=Object(v.a)(R,1)[0],M=Object(N.a)(Di),L=Object(v.a)(M,1)[0],U=function(){d($i),j(Ui),p(Mi),m(Vi),O(Li),h({subtotal:0,total:0,descuento_aplicado:!1,porcentaje:0,cantidad_descontada:0,precio_con_descuento:0})};Object(s.useEffect)((function(){"enEspera"===c&&n&&!0===t&&(p(n),j(n.productos))}),[t]);var J=function(){var e=Object(_.a)(g.a.mark((function e(t,a,n,r){var i,s,d,j,b;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Object(u.a)({},l),s=o,"enEspera"===c&&(s=o.map((function(e){return delete e.conflicto,e})),delete i.empresa,delete i.sucursal,delete i.usuario),W(!0),a&&r(!0),e.prev=5,i.productos=s,!t){e.next=15;break}return i.en_espera=!0,e.next=11,L({variables:{input:i,empresa:k.empresa._id,sucursal:k.sucursal._id,usuario:k._id}});case 11:d=e.sent,D({message:"\xa1Listo! ".concat(d.data.crearCompraEnEspera.message),status:"success",open:!0}),e.next=21;break;case 15:return a&&(i.compra_credito=!0,i.saldo_credito_pendiente=i.total),x.descuento_aplicado&&(x.descuento_aplicado,x.subtotal,x.total,j=Object(fe.a)(x,bo),i.descuento_aplicado=x.descuento_aplicado,i.subtotal=x.subtotal,i.total=x.total,i.descuento=j),e.next=19,$({variables:{input:i,empresa:k.empresa._id,sucursal:k.sucursal._id,usuario:k._id}});case 19:b=e.sent,D({message:"\xa1Listo! ".concat(b.data.crearCompra.message),status:"success",open:!0});case 21:W(!1),U(),n&&(n(),r(!1)),e.next=33;break;case 26:e.prev=26,e.t0=e.catch(5),W(!1),D({message:"Error de servidor",status:"error",open:!0}),n&&(n(),r(!1)),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 33:case"end":return e.stop()}}),e,null,[[5,26]])})));return function(t,a,n,c){return e.apply(this,arguments)}}(),G=function(){o.length>0?I(!S):(U(),a())};return Object(V.jsxs)(ze.a,{fullScreen:!0,open:t,onClose:a,TransitionComponent:mo,children:[Object(V.jsx)(wt.a,{style:{padding:0},children:Object(V.jsx)(Se.a,{className:r.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:r.title,children:"Nueva compra"}),Object(V.jsxs)(b.a,{m:1,children:[Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:G,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})}),Object(V.jsx)(ho,{handleClose:a,handleToggleDelete:G,openDelete:S})]})]})})}),Object(V.jsxs)(Pe.a,{children:[Object(V.jsx)(B,{alert:P,setAlert:D}),Object(V.jsx)(Ve,{loading:T,setLoading:W}),Object(V.jsx)(qi,{status:c}),Object(V.jsx)(b.a,{my:2}),Object(V.jsx)(ao,{})]}),Object(V.jsxs)(We.a,{style:{justifyContent:"center"},children:[Object(V.jsx)(w.a,{color:"inherit",size:"large",onClick:function(){return G()},startIcon:Object(V.jsx)($e.a,{}),children:"Cancelar"}),"enEspera"===c?null:Object(V.jsx)(w.a,{autoFocus:!0,color:"primary",variant:"text",size:"large",onClick:function(){return J(!0)},disabled:!o.length,startIcon:Object(V.jsx)(io.a,{}),children:"Compra en espera"}),Object(V.jsx)(uo,{realizarCompraBD:J}),Object(V.jsx)(so,{realizarCompraBD:J})]})]})},ho=function(e){var t=e.handleClose,a=e.handleToggleDelete,n=e.openDelete,c=Object(s.useContext)(ka),r=c.setProductosCompra,i=c.setDatosCompra,o=c.setPreciosVenta,l=c.setProductoOriginal,d=c.setDatosProducto;return Object(V.jsx)("div",{children:Object(V.jsxs)(ze.a,{open:n,TransitionComponent:mo,keepMounted:!0,onClose:a,"aria-labelledby":"modal-eliminar-compra",children:[Object(V.jsx)(wt.a,{id:"modal-eliminar-compra",children:"\xbfQuieres cancelar esta compra?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:a,color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){d($i),i(Mi),o(Li),l(Vi),r(Ui),a(),t()},color:"secondary",children:"Aceptar"})]})]})})},fo=a(144),go=a.n(fo),_o=a(891),vo=a(51),Co=a.n(vo),yo=Co.a.ExcelFile,So=Co.a.ExcelFile.ExcelSheet,wo=Co.a.ExcelFile.ExcelColumn;function Io(e){var t=e.compra,a=t.almacen,n=t.proveedor,c=t.fecha_registro,r=t.subtotal,i=t.impuestos,o=t.total,l=t.productos,d=[{almacen:a.nombre_almacen,proveedor:n.nombre_cliente,fecha_registro:Ke(c),subtotal:Ze(r),impuestos:Ze(i),total:Ze(o)}],j=l.map((function(e){var t=e.producto,a=e.medida,n=e.color,c=e.unidad,r=e.cantidad,i=e.Cantidad_regalo,o=e.cantidad_total,s=e.descuento_precio,l=e.descuento_porcentaje,d=e.subtotal,j=e.impuestos,u=e.total;return{producto:t.datos_generales.nombre_comercial,medida:a?a.medida:"N/A",color:n?n.color:"N/A",unidad:c,cantidad:r,Cantidad_regalo:i,cantidad_total:o,descuento_precio:s,descuento_porcentaje:l,subtotal:Ze(d),impuestos:Ze(j),total:Ze(u)}}));return Object(V.jsx)(s.Fragment,{children:Object(V.jsx)(Fe.a,{children:Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsxs)(yo,{element:Object(V.jsx)(b.a,{display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(w.a,{variant:"contained",color:"primary",startIcon:Object(V.jsx)(_o.a,{}),children:"Exportar a Excel"})}),filename:"Detalle de compra",children:[Object(V.jsxs)(So,{data:d,name:"Detalle compra",children:[Object(V.jsx)(wo,{label:"Almacen",value:"almacen"}),Object(V.jsx)(wo,{label:"Proveedor",value:"proveedor"}),Object(V.jsx)(wo,{label:"Fecha de compra",value:"fecha_registro"}),Object(V.jsx)(wo,{label:"Subtotal",value:"subtotal"}),Object(V.jsx)(wo,{label:"Impuestos",value:"impuestos"}),Object(V.jsx)(wo,{label:"Total",value:"total"})]}),Object(V.jsxs)(So,{data:j,name:"Productos de la compra",children:[Object(V.jsx)(wo,{label:"Producto",value:"producto"}),Object(V.jsx)(wo,{label:"Medida",value:"medida"}),Object(V.jsx)(wo,{label:"Color",value:"color"}),Object(V.jsx)(wo,{label:"Unidad",value:"unidad"}),Object(V.jsx)(wo,{label:"Cantidad",value:"cantidad"}),Object(V.jsx)(wo,{label:"Cantidad de regalo",value:"cantidad_regalo"}),Object(V.jsx)(wo,{label:"Cantidad total",value:"cantidad_total"}),Object(V.jsx)(wo,{label:"Precio de descuento",value:"descuento_precio"}),Object(V.jsx)(wo,{label:"Porcentaje de descuento",value:"descuento_porcentaje"}),Object(V.jsx)(wo,{label:"Subtotal",value:"subtotal"}),Object(V.jsx)(wo,{label:"Impuestos",value:"impuestos"}),Object(V.jsx)(wo,{label:"Total",value:"total"})]})]})})})})}var ko=Object(k.a)({root:{width:"100%"},container:{height:"50vh"}});function No(e){var t=e.compra,a=ko(),n=Object(ve.a)(),c=t.productos,r=Object(s.useState)(""),i=Object(v.a)(r,2),o=i[0],l=i[1],d=Object(s.useState)([]),j=Object(v.a)(d,2),u=j[0],p=j[1];return Object(s.useEffect)((function(){p(c.filter((function(e){return e.producto.datos_generales.nombre_comercial.toLowerCase().includes(o.toLowerCase())})))}),[o,c]),Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(b.a,{mb:1,display:"flex",children:[Object(V.jsxs)(y.a,{style:{marginRight:16},children:[Object(V.jsx)("b",{children:"Proveedor: "}),t.proveedor.nombre_cliente]}),Object(V.jsxs)(y.a,{style:{marginRight:16},children:[Object(V.jsx)("b",{children:"Almacen: "}),t.almacen.nombre_almacen]}),Object(V.jsx)(y.a,{style:{marginRight:16},children:Object(V.jsxs)("b",{children:["Subtotal: $",t.subtotal]})}),Object(V.jsx)(y.a,{style:{marginRight:16},children:Object(V.jsxs)("b",{children:["Impuestos: $",t.impuestos]})}),Object(V.jsx)(y.a,{style:{marginRight:16},children:Object(V.jsxs)("b",{children:["Total: $",t.total]})}),!0===t.compra_credito?Object(V.jsx)(Ea.a,{label:!0===t.credito_pagado?"Credito pagado":"Saldo pendiente: $".concat(Ze(t.saldo_credito_pendiente)),color:!0===t.credito_pagado?"primary":"secondary",variant:"outlined"}):null]}),Object(V.jsx)(b.a,{mb:2,display:"flex",children:Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,sm:6,xs:12,children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",onChange:function(e){return t=e.target.value,l(t);var t},InputProps:{startAdornment:Object(V.jsx)(Y.a,{position:"start",children:Object(V.jsx)(go.a,{color:"action"})})}})}),Object(V.jsx)(Fe.a,{item:!0,sm:6,xs:12,children:Object(V.jsx)(Io,{compra:t})})]})}),Object(V.jsx)(Da.a,{className:a.root,children:Object(V.jsx)(ra.a,{className:a.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Producto"}),Object(V.jsx)(sa.a,{children:"Medida"}),Object(V.jsx)(sa.a,{children:"Color"}),Object(V.jsx)(sa.a,{children:"Unidad"}),Object(V.jsx)(sa.a,{children:"Cantidad"}),Object(V.jsx)(sa.a,{children:"C. regalo"}),Object(V.jsx)(sa.a,{children:"C. total"}),Object(V.jsx)(sa.a,{children:"Descuento"}),Object(V.jsx)(sa.a,{children:"Subtotal"}),Object(V.jsx)(sa.a,{children:"Impuestos"}),Object(V.jsx)(sa.a,{children:"Total"})]})}),Object(V.jsx)(la.a,{children:u.map((function(e,t){return Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:e.producto.datos_generales.nombre_comercial}),Object(V.jsx)(sa.a,{padding:"checkbox",children:e.medida&&e.medida.medida?e.medida.medida:"N/A"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:e.color&&e.color.hex?Object(V.jsx)(Ea.a,{label:e.color.color,size:"small",style:{backgroundColor:e.color.hex,color:n.palette.getContrastText(e.color.hex)}}):"N/A"}),Object(V.jsx)(sa.a,{children:e.unidad}),Object(V.jsx)(sa.a,{children:e.cantidad}),Object(V.jsx)(sa.a,{children:e.cantidad_regalo}),Object(V.jsx)(sa.a,{children:e.cantidad_total}),Object(V.jsx)(sa.a,{children:"$".concat(e.descuento_precio," - %").concat(e.descuento_porcentaje)}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(e.subtotal)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(e.impuestos)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(e.total)]})})]},t)}))})]})})})]})}var Fo=a(892),zo=Object(k.a)({root:{width:"100%"},container:{height:"72vh"}});function Po(e){var t=e.obtenerComprasRealizadas,a=zo();return Object(V.jsx)(Da.a,{className:a.root,variant:"outlined",children:Object(V.jsx)(ra.a,{className:a.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Almacen"}),Object(V.jsx)(sa.a,{children:"Proveedor"}),Object(V.jsx)(sa.a,{children:"Fecha de compra"}),Object(V.jsx)(sa.a,{children:"Compra a credito"}),Object(V.jsx)(sa.a,{children:"Subtotal"}),Object(V.jsx)(sa.a,{children:"Impuestos"}),Object(V.jsx)(sa.a,{children:"Total"}),Object(V.jsx)(sa.a,{children:"Productos"})]})}),Object(V.jsx)(la.a,{children:t.map((function(e,t){return Object(V.jsx)(Do,{compra:e},t)}))})]})})})}var Do=function(e){var t=e.compra,a=t.almacen,n=t.proveedor,c=t.fecha_registro,r=t.compra_credito,i=t.credito_pagado,o=t.subtotal,s=t.impuestos,l=t.total;return Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:a.nombre_almacen}),Object(V.jsx)(sa.a,{children:n.nombre_cliente}),Object(V.jsx)(sa.a,{children:Ke(c)}),Object(V.jsx)(sa.a,{children:!0===r?Object(V.jsx)(Ea.a,{label:!0===i?"Credito: Pagado":"Credito: Pendiente",color:!0===i?"primary":"secondary",variant:"outlined"}):null}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(o)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(s)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(l)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(Ao,{compra:t})})]})},Eo=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),Ao=function(e){var t=e.compra,a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=function(){r(!c)};return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(X.a,{onClick:function(){return i()},children:Object(V.jsx)(Fo.a,{})}),Object(V.jsxs)(ze.a,{open:c,onClose:i,fullWidth:!0,maxWidth:"lg",TransitionComponent:Eo,children:[Object(V.jsx)(wt.a,{children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(y.a,{variant:"h6",style:{flexGrow:1},children:"Datos de compra"}),Object(V.jsx)(w.a,{variant:"text",color:"primary",onClick:i,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})]})}),Object(V.jsx)(Pe.a,{children:Object(V.jsx)(No,{compra:t})}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{variant:"text",color:"primary",size:"large",startIcon:Object(V.jsx)(Pt.a,{}),onClick:function(){return i()},children:"Acpetar"})})]})]})},To=a(893),Wo=Co.a.ExcelFile,Ro=Co.a.ExcelFile.ExcelSheet,$o=Co.a.ExcelFile.ExcelColumn;function Mo(e){var t=e.obtenerComprasRealizadas,a=e.filtro,n=e.filtroFecha,c=t.map((function(e){var t=e.almacen,a=e.proveedor,n=e.fecha_registro,c=e.subtotal,r=e.impuestos,i=e.total;return{almacen:t.nombre_almacen,proveedor:a.nombre_cliente,fecha_registro:Ke(n),subtotal:Ze(c),impuestos:Ze(r),total:Ze(i)}})),r="";return a&&n.fecha?r="Lista de compras realizadas desde hace ".concat(n.since," y filtradas por ").concat(a):a&&!n.fecha?r="Lista de compras realizadas filtradas por ".concat(a):!a&&n.fecha?r="Lista de compras realizadas desde hace ".concat(n.since):a||n.fecha||(r="Lista de compras realizadas"),Object(V.jsx)(s.Fragment,{children:Object(V.jsx)(Fe.a,{children:Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsx)(Wo,{element:Object(V.jsx)(b.a,{display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(w.a,{variant:"contained",color:"primary",startIcon:Object(V.jsx)(_o.a,{}),children:"Exportar a Excel"})}),filename:r,children:Object(V.jsxs)(Ro,{data:c,name:r,children:[Object(V.jsx)($o,{label:"Almacen",value:"almacen"}),Object(V.jsx)($o,{label:"Proveedor",value:"proveedor"}),Object(V.jsx)($o,{label:"Fecha de compra",value:"fecha_registro"}),Object(V.jsx)($o,{label:"Subtotal",value:"subtotal"}),Object(V.jsx)($o,{label:"Impuestos",value:"impuestos"}),Object(V.jsx)($o,{label:"Total",value:"total"})]})})})})})}var Lo=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}})),Vo=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Uo(){var e=Lo(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Ce.h,{className:e.icon})}),"Compras realizadas"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Vo,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Compras realizadas"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(C.a,{maxWidth:"xl",children:Object(V.jsx)(Bo,{})})]})]})}var Bo=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(s.useState)(""),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useState)({fecha:"",since:"todos"}),i=Object(v.a)(r,2),o=i[0],l=i[1],d=Object(s.useRef)(null),j=Object(s.useRef)(null),u=Object(He.a)(Ei,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,fecha:o.fecha},fetchPolicy:"network-only"}),p=u.loading,m=u.data,O=u.error,x=u.refetch;if(p)return Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:[Object(V.jsx)(I.a,{}),Object(V.jsx)(y.a,{variant:"h5",children:"Cargando"})]});if(O)return Object(V.jsx)(Je,{error:O,altura:300});var h=[];m&&(h=m.obtenerComprasRealizadas);return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{my:3,children:Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsx)(Fe.a,{item:!0,md:4,xs:12,children:Object(V.jsx)("form",{onSubmit:function(e){return function(e,t){e.preventDefault(),x({filtro:t,fecha:o.fecha}),c(t)}(e,e.target[0].value)},children:Object(V.jsx)(S.a,{inputRef:d,fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",InputProps:{endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(X.a,{type:"submit",color:"primary",size:"medium",children:Object(V.jsx)(To.a,{})})})}})})}),Object(V.jsx)(Fe.a,{item:!0,md:4,xs:12,children:Object(V.jsxs)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:[Object(V.jsx)(q.a,{id:"label-select-fecha-filter",children:"Filtrar desde..."}),Object(V.jsxs)(De.a,{inputRef:j,labelId:"label-select-fecha-filter",value:o.since,onChange:function(e){return function(e){switch(e){case"7 dias":l({since:e,fecha:xt()().subtract(7,"d").format()}),x({filtro:n,fecha:xt()().subtract(7,"d").format()});break;case"2 semanas":l({since:e,fecha:xt()().subtract(2,"w").format()}),x({filtro:n,fecha:xt()().subtract(2,"w").format()});break;case"1 mes":l({since:e,fecha:xt()().subtract(1,"M").format()}),x({filtro:n,fecha:xt()().subtract(1,"M").format()});break;case"3 meses":l({since:e,fecha:xt()().subtract(3,"M").format()}),x({filtro:n,fecha:xt()().subtract(3,"M").format()});break;case"6 meses":l({since:e,fecha:xt()().subtract(6,"M").format()}),x({filtro:n,fecha:xt()().subtract(6,"M").format()});break;case"8 meses":l({since:e,fecha:xt()().subtract(8,"M").format()}),x({filtro:n,fecha:xt()().subtract(8,"M").format()});break;case"1 a\xf1o":l({since:e,fecha:xt()().subtract(1,"y").format()}),x({filtro:n,fecha:xt()().subtract(1,"y").format()});break;default:l({since:"todos",fecha:""}),x({filtro:n,fecha:""})}}(e.target.value)},label:"Filtrar desde...",children:[Object(V.jsx)(Ee.a,{value:"todos",children:Object(V.jsx)("em",{children:"Todos los registros"})}),Object(V.jsx)(Ee.a,{value:"7 dias",children:"hace 7 d\xedas"}),Object(V.jsx)(Ee.a,{value:"2 semanas",children:"hace 2 semanas"}),Object(V.jsx)(Ee.a,{value:"1 mes",children:"hace 1 mes"}),Object(V.jsx)(Ee.a,{value:"3 meses",children:"hace 3 meses"}),Object(V.jsx)(Ee.a,{value:"6 meses",children:"hace 6 meses"}),Object(V.jsx)(Ee.a,{value:"8 meses",children:"hace 8 meses"}),Object(V.jsx)(Ee.a,{value:"1 a\xf1o",children:"hace 1 a\xf1o"})]})]})}),Object(V.jsx)(Fe.a,{item:!0,md:4,xs:12,children:Object(V.jsx)(Mo,{obtenerComprasRealizadas:h,filtro:n,filtroFecha:o})})]})}),n||o.fecha?Object(V.jsxs)(b.a,{display:"flex",mb:1,children:[Object(V.jsx)(y.a,{variant:"h6",children:"Resultados de:"}),Object(V.jsx)(b.a,{mr:1}),n?Object(V.jsx)(Ea.a,{variant:"outlined",size:"medium",label:n,onDelete:function(){x({filtro:"",fecha:o.fecha}),c(""),d.current.value=""}}):null,Object(V.jsx)(b.a,{mx:1}),o.fecha?Object(V.jsx)(Ea.a,{variant:"outlined",size:"medium",label:"Desde hace ".concat(o.since),onDelete:function(){x({filtro:n,fecha:""}),l({since:"todos",fecha:""}),j.current.value="todos"}}):null]}):null,Object(V.jsx)(Po,{obtenerComprasRealizadas:h})]})},Jo=a(894),Go=a(895),qo=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Ho(e){var t=e.compra,a=e.nuevoArray,n=e.setNuevoArray,c=e.setVerificado,r=Object(s.useState)(!1),i=Object(v.a)(r,2),o=i[0],l=i[1],d=Object(s.useState)(!1),j=Object(v.a)(d,2),u=j[0],b=j[1],p=function(){l(!0)},m=function(){u&&c(!0),l(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{variant:"contained",color:"primary",onClick:function(){return p()},startIcon:Object(V.jsx)(Jo.a,{}),children:"Continuar compra"}),Object(V.jsx)(ze.a,{open:o,TransitionComponent:qo,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&m()},"aria-labelledby":"dialog-verificarcompra-title","aria-describedby":"dialog-verificarcompra-description",fullWidth:!0,maxWidth:"sm",children:Object(V.jsx)(Yo,{handleClose:m,compra:t,handleClickOpen:p,open:o,nuevoArray:a,setNuevoArray:n,setSuccess:b})})]})}var Yo=function(e){var t=e.handleClose,a=e.compra,n=e.handleClickOpen,c=e.open,r=(e.nuevoArray,e.setNuevoArray),i=e.setSuccess,o=Object(s.useState)(!1),l=Object(v.a)(o,2),d=l[0],j=l[1],p=JSON.parse(localStorage.getItem("sesionCafi")),m=0,O=Object(ri.a)(On,{variables:{empresa:p.empresa._id,sucursal:p.sucursal._id,almacen:a.almacen.id_almacen},fetchPolicy:"network-only"}),x=Object(v.a)(O,2),h=x[0],f=x[1],g=f.loading,_=f.data,C=f.error;if(_&&(m=1),Object(s.useEffect)((function(){c&&0===m&&(h(),m=1)}),[n]),Object(s.useEffect)((function(){_&&function(){j(!0);for(var e=a.productos,t=Object(ea.a)(e),n=!1,c=function(a){var c=e[a],r=Object(u.a)({},c),i=Object(u.a)({},c.producto),o=y.filter((function(e){return e._id===r.id_producto})),s=i.precios,l=i.unidades_de_venta,d=i.presentaciones,j=o[0].precios,b=o[0].unidades_de_venta,p=o[0].medidas_producto;s.unidad_de_compra.cantidad===j.unidad_de_compra.cantidad&&s.unidad_de_compra.precio_unitario_con_impuesto===j.unidad_de_compra.precio_unitario_con_impuesto&&s.unidad_de_compra.unidad===j.unidad_de_compra.unidad||(i.precios=j,r.producto=i,r.conflicto=!0,t[a]=r,n=!0);var m=l.filter((function(e){return!0===e.default})),O=b.filter((function(e){return!0===e.default}));if(m[0].cantidad===O[0].cantidad&&m[0].precio===O[0].precio&&m[0].unidad===O[0].unidad||(i.unidades_de_venta=b,r.producto=i,r.conflicto=!0,t[a]=r,n=!0),d.length>0)if(p.length>0)if(d.length===p.length)for(var x=0;x<d.length;x++)for(var h=d[x],f=0;f<p.length;f++){var g=p[f];h.medida._id===g.medida._id&&h.color._id===g.color._id&&h.almacen===g.almacen&&(h.cantidad===g.cantidad&&h.precio===g.precio||(i.presentaciones=p,r.producto=i,r.conflicto=!0,t[a]=r,n=!0))}else i.presentaciones=p,r.producto=i,r.conflicto=!0,t[a]=r,n=!0;else r.conflicto=!0,t[a]=r,n=!0},o=0;o<e.length;o++)c(o);var s=[],l=0,d=0,b=0;if(n){for(var p=function(e){var a=Object(u.a)({},t[e]);if("OTROS"!==a.producto.datos_generales.tipo_producto)a.producto.presentaciones.length>0?(a.cantidad=0,a.producto.presentaciones.forEach((function(e){var t=e.cantidad,n=e.cantidad_nueva,c=n||0;a.cantidad+=t+c})),isNaN(a.cantidad)&&(a.cantidad=0),a.cantidad_total=a.cantidad):(a.cantidad=0,a.cantidad_total=a.cantidad);else{var n=a.cantidad_regalo,c=a.cantidad,r=a.unidad_regalo,i=a.producto.precios.unidad_de_compra.cantidad,o="Pz"===r||"Kg"===r||"Lt"===r?n:n*i,j=c*i+o;i>1?(a.cantidad_regalo=o/i,a.cantidad_total=j/i):(a.cantidad_regalo=o,a.cantidad_total=j)}var p=a.producto.precios.precio_de_compra,m=p.iva,O=p.ieps,x=p.precio_con_impuesto,h=p.precio_sin_impuesto;a.total_con_descuento=x,a.costo=x,a.iva_total=m*a.cantidad_total,a.ieps_total=O*a.cantidad_total,a.impuestos=(m+O)*a.cantidad_total,a.subtotal=h*a.cantidad_total,a.total=x*a.cantidad_total,a.descuento_porcentaje>0&&(a.descuento_precio=Math.round(x*a.descuento_porcentaje/100),a.total_con_descuento=x-a.descuento_precio),l+=a.subtotal,d+=a.impuestos,b+=a.total_con_descuento*a.cantidad_total,s.push(a)},m=0;m<t.length;m++)p(m);r({_id:a._id,almacen:a.almacen,proveedor:a.proveedor,productos:s,en_espera:a.en_espera,fecha_registro:a.fecha_registro,impuestos:d,subtotal:l,total:b})}else r(a);setTimeout((function(){j(!1),i(!0)}),1500)}()}),[_]),g)return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(Pe.a,{style:{height:150,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[Object(V.jsx)(Lt.a,{id:"dialog-verificarcompra-description",children:"Si ya no hay existencias en tu producto se marcaran en la tabla y se quitaran al retomar la compra para no causar conflictos, podras editar tu compra mas adelante"}),Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(I.a,{size:18,color:"primary",style:{marginRight:8}}),"Obteniendo productos de la Base de datos..."]})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:t,color:"inherit",children:"Cancelar"})})]});if(C)return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(Pe.a,{children:Object(V.jsx)(Je,{error:C,altura:130})}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:t,color:"inherit",children:"Cerrar"})})]});var y=[];return _&&(y=_.obtenerProductos),Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(Pe.a,{style:{height:150,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[Object(V.jsx)(Lt.a,{id:"dialog-verificarcompra-description",children:"Si ya no hay existencias en tu producto se marcaran en la tabla y se quitaran al retomar la compra para no causar conflictos, podras editar tu compra mas adelante"}),d?Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(I.a,{size:18,color:"primary",style:{marginRight:8}}),"Verificando existencias en tus productos..."]}):null,d?null:Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(Go.a,{color:"primary",style:{marginRight:8}}),"Listo, producto verificados"]})]}),Object(V.jsx)(We.a,{children:d?Object(V.jsx)(w.a,{onClick:t,color:"inherit",children:"Cancelar"}):Object(V.jsx)(w.a,{onClick:t,color:"primary",startIcon:Object(V.jsx)(Pt.a,{}),children:"Aceptar"})})]})},Xo=a(896),Ko=Object(k.a)({root:{width:"100%"},container:{height:"50vh"}});function Qo(e){var t=e.compra,a=e.setAlert,n=e.refetch,c=e.handleOpenDetalles,r=Ko(),i=Object(ve.a)(),o=Object(s.useState)(Object(u.a)({},t)),l=Object(v.a)(o,2),d=l[0],j=l[1],p=d.productos,m=JSON.parse(localStorage.getItem("sesionCafi")),O=Object(s.useState)(""),x=Object(v.a)(O,2),h=x[0],f=x[1],g=Object(s.useState)([]),_=Object(v.a)(g,2),C=_[0],w=_[1],I=Object(s.useState)(),k=Object(v.a)(I,2),N=k[0],F=k[1],z=Object(s.useState)(!1),P=Object(v.a)(z,2),D=P[0],E=P[1];return Object(s.useEffect)((function(){w(p.filter((function(e){return e.producto.datos_generales.nombre_comercial.toLowerCase().includes(h.toLowerCase())})))}),[h,p]),Object(s.useEffect)((function(){D&&N&&j(N)}),[D]),Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(b.a,{mb:1,display:"flex",children:[Object(V.jsxs)(y.a,{style:{marginRight:16},children:[Object(V.jsx)("b",{children:"Proveedor: "}),d.proveedor.nombre_cliente]}),Object(V.jsxs)(y.a,{style:{marginRight:16},children:[Object(V.jsx)("b",{children:"Almacen: "}),d.almacen.nombre_almacen]}),Object(V.jsx)(y.a,{style:{marginRight:16},children:Object(V.jsxs)("b",{children:["Subtotal: $",parseFloat(d.subtotal).toFixed(2)]})}),Object(V.jsx)(y.a,{style:{marginRight:16},children:Object(V.jsxs)("b",{children:["Impuestos: $",parseFloat(d.impuestos).toFixed(2)]})}),Object(V.jsx)(y.a,{style:{marginRight:16},children:Object(V.jsxs)("b",{children:["Total: $",Ze(parseFloat(d.total).toFixed(2))]})})]}),Object(V.jsx)(b.a,{mb:2,display:"flex",children:Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,sm:6,xs:12,children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",onChange:function(e){return t=e.target.value,f(t);var t},InputProps:{startAdornment:Object(V.jsx)(Y.a,{position:"start",children:Object(V.jsx)(go.a,{color:"action"})})}})}),Object(V.jsx)(Fe.a,{item:!0,sm:6,xs:12,children:Object(V.jsxs)(b.a,{display:"flex",justifyContent:"flex-end",children:[!1===m.accesos.compras.compras_espera.eliminar?null:Object(V.jsx)(es,{compra:d,setAlert:a,refetch:n,handleOpenDetalles:c}),Object(V.jsx)(b.a,{mx:1}),!1===m.accesos.compras.compras_espera.editar?null:D?Object(V.jsx)(Oo,{compra:d,status:"enEspera",handleOpenDetalles:c,refetchEspera:n}):Object(V.jsx)(Ho,{compra:d,nuevoArray:N,setNuevoArray:F,setVerificado:E})]})})]})}),Object(V.jsx)(Da.a,{className:r.root,variant:"outlined",children:Object(V.jsx)(ra.a,{className:r.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[D?Object(V.jsx)(sa.a,{}):null,Object(V.jsx)(sa.a,{children:"Producto"}),Object(V.jsx)(sa.a,{children:"Medida"}),Object(V.jsx)(sa.a,{children:"Color"}),Object(V.jsx)(sa.a,{children:"Unidad"}),Object(V.jsx)(sa.a,{children:"Cantidad"}),Object(V.jsx)(sa.a,{children:"C. regalo"}),Object(V.jsx)(sa.a,{children:"C. total"}),Object(V.jsx)(sa.a,{children:"Descuento"}),Object(V.jsx)(sa.a,{children:"Subtotal"}),Object(V.jsx)(sa.a,{children:"Impuestos"}),Object(V.jsx)(sa.a,{children:"Total"})]})}),Object(V.jsx)(la.a,{children:C.map((function(e,t){return Object(V.jsxs)(oa.a,{tabIndex:-1,selected:e.conflicto,children:[D?Object(V.jsx)(sa.a,{style:{paddingTop:0,paddingBottom:0},children:e.conflicto?Object(V.jsx)(Qi.a,{color:"primary"}):Object(V.jsx)(Go.a,{style:{color:i.palette.success.main}})}):null,Object(V.jsx)(sa.a,{children:e.producto.datos_generales.nombre_comercial}),Object(V.jsx)(sa.a,{padding:"checkbox",children:e.medida&&e.medida.medida?e.medida.medida:"N/A"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:e.color&&e.color.hex?Object(V.jsx)(Ea.a,{label:e.color.color,size:"small",style:{backgroundColor:e.color.hex,color:i.palette.getContrastText(e.color.hex)}}):"N/A"}),Object(V.jsx)(sa.a,{children:e.unidad}),Object(V.jsx)(sa.a,{children:e.cantidad}),Object(V.jsx)(sa.a,{children:e.cantidad_regalo}),Object(V.jsx)(sa.a,{children:e.cantidad_total}),Object(V.jsx)(sa.a,{children:"$".concat(e.descuento_precio," - %").concat(e.descuento_porcentaje)}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(e.subtotal)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(e.impuestos)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(e.total)]})})]},t)}))})]})})})]})}var Zo=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),es=function(e){var t=e.compra,a=e.setAlert,n=e.refetch,c=e.handleOpenDetalles,r=Object(s.useState)(!1),i=Object(v.a)(r,2),o=i[0],l=i[1],d=Object(s.useState)(!1),j=Object(v.a)(d,2),u=j[0],b=j[1],p=Object(N.a)(Wi),m=Object(v.a)(p,1)[0],O=function(){l(!o)},x=function(){var e=Object(_.a)(g.a.mark((function e(){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.prev=1,e.next=4,m({variables:{id:t._id}});case 4:r=e.sent,a({message:"\xa1Listo! ".concat(r.data.eliminarCompraEnEspera.message),status:"success",open:!0}),n(),b(!1),O(),c(),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0),b(!1),a({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(w.a,{color:"secondary",startIcon:Object(V.jsx)(Xo.a,{}),onClick:function(){return O()},children:"Eliminar compra"}),Object(V.jsxs)(ze.a,{open:o,onClose:O,TransitionComponent:Zo,children:[Object(V.jsx)(wt.a,{children:"\xbfDesea eliminar esta compra?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{variant:"text",color:"inherit",size:"large",startIcon:Object(V.jsx)($e.a,{}),onClick:function(){return O()},children:"Cancelar"}),Object(V.jsx)(w.a,{variant:"text",color:"secondary",size:"large",disabled:u,startIcon:u?Object(V.jsx)(I.a,{size:18,color:"inherit"}):Object(V.jsx)(Pt.a,{}),onClick:function(){return x()},children:"Eliminar"})]})]})]})},ts=Object(k.a)({root:{width:"100%"},container:{height:"75vh"}});function as(e){var t=e.obtenerComprasEnEspera,a=e.refetch,n=ts(),c=Object(s.useState)({message:"",status:"",open:!1}),r=Object(v.a)(c,2),i=r[0],o=r[1],l=JSON.parse(localStorage.getItem("sesionCafi"));return Object(V.jsxs)(Da.a,{className:n.root,variant:"outlined",children:[Object(V.jsx)(B,{alert:i,setAlert:o}),Object(V.jsx)(ra.a,{className:n.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Almacen"}),Object(V.jsx)(sa.a,{children:"Proveedor"}),Object(V.jsx)(sa.a,{children:"Fecha de compra"}),Object(V.jsx)(sa.a,{children:"Subtotal"}),Object(V.jsx)(sa.a,{children:"Impuestos"}),Object(V.jsx)(sa.a,{children:"Total"}),Object(V.jsx)(sa.a,{children:"Detalles"}),!1===l.accesos.compras.compras_espera.elimina?null:Object(V.jsx)(sa.a,{children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:t.map((function(e,t){return Object(V.jsx)(ns,{compra:e,refetch:a,setAlert:o},t)}))})]})})]})}var ns=function(e){var t=e.compra,a=e.refetch,n=e.setAlert,c=t.almacen,r=t.proveedor,i=t.fecha_registro,o=t.subtotal,s=t.impuestos,l=t.total,d=JSON.parse(localStorage.getItem("sesionCafi"));return Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:c.nombre_almacen}),Object(V.jsx)(sa.a,{children:r.nombre_cliente}),Object(V.jsx)(sa.a,{children:Ke(i)}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(o)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(s)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(l)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(rs,{compra:t,refetch:a,setAlert:n})}),!1===d.accesos.compras.compras_espera.eliminar?null:Object(V.jsx)(sa.a,{children:Object(V.jsx)(is,{compra:t,refetch:a,setAlert:n})})]})},cs=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),rs=function(e){var t=e.compra,a=e.setAlert,n=e.refetch,c=Object(s.useState)(!1),r=Object(v.a)(c,2),i=r[0],o=r[1],l=function(){o(!i)};return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(X.a,{onClick:function(){return l()},children:Object(V.jsx)(Fo.a,{})}),Object(V.jsxs)(ze.a,{open:i,onClose:l,fullWidth:!0,maxWidth:"lg",TransitionComponent:cs,children:[Object(V.jsx)(wt.a,{children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(y.a,{variant:"h6",style:{flexGrow:1},children:"Datos de compra en espera"}),Object(V.jsx)(w.a,{variant:"text",color:"primary",onClick:l,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})]})}),Object(V.jsx)(Pe.a,{children:Object(V.jsx)(Qo,{compra:t,refetch:n,setAlert:a,handleOpenDetalles:l})})]})]})},is=function(e){var t=e.compra,a=e.setAlert,n=e.refetch,c=Object(s.useState)(!1),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)(!1),d=Object(v.a)(l,2),j=d[0],u=d[1],b=Object(N.a)(Wi),p=Object(v.a)(b,1)[0],m=function(){o(!i)},O=function(){var e=Object(_.a)(g.a.mark((function e(){var c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,p({variables:{id:t._id}});case 4:c=e.sent,a({message:"\xa1Listo! ".concat(c.data.eliminarCompraEnEspera.message),status:"success",open:!0}),n(),u(!1),m(),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0),u(!1),a({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 16:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(X.a,{onClick:function(){return m()},children:Object(V.jsx)(Xo.a,{color:"error"})}),Object(V.jsxs)(ze.a,{open:i,onClose:m,TransitionComponent:cs,children:[Object(V.jsx)(wt.a,{children:"\xbfDesea eliminar esta compra?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{variant:"text",color:"inherit",size:"large",startIcon:Object(V.jsx)($e.a,{}),onClick:function(){return m()},children:"Cancelar"}),Object(V.jsx)(w.a,{variant:"text",color:"secondary",size:"large",disabled:j,startIcon:j?Object(V.jsx)(I.a,{size:18,color:"inherit"}):Object(V.jsx)(Pt.a,{}),onClick:function(){return O()},children:"Eliminar"})]})]})]})},os=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100}}})),ss=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function ls(){var e=os(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Ce.l,{className:e.icon})}),"Compras en espera"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:ss,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Compras en espera"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(C.a,{maxWidth:"xl",children:Object(V.jsx)(ds,{})})]})]})}var ds=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(s.useState)(""),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useRef)(null),i=Object(He.a)(Ai,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,filtro:n},fetchPolicy:"network-only"}),o=i.loading,l=i.data,d=i.error,j=i.refetch;if(o)return Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:[Object(V.jsx)(I.a,{}),Object(V.jsx)(y.a,{variant:"h5",children:"Cargando"})]});if(d)return Object(V.jsx)(Je,{error:d,altura:300});var u=[];l&&(u=l.obtenerComprasEnEspera);return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{my:3,maxWidth:500,children:Object(V.jsx)("form",{onSubmit:function(e){return function(e,t){e.preventDefault(),j({filtro:t}),c(t)}(e,e.target[0].value)},children:Object(V.jsx)(S.a,{inputRef:r,fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",InputProps:{endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(X.a,{type:"submit",color:"primary",size:"medium",children:Object(V.jsx)(To.a,{})})})}})})}),Object(V.jsx)(as,{obtenerComprasEnEspera:u,refetch:j})]})};function js(){var e=JSON.parse(localStorage.getItem("sesionCafi"));return Object(V.jsx)(C.a,{maxWidth:"md",children:Object(V.jsxs)(Fe.a,{container:!0,spacing:3,justify:"center",children:[!1===e.accesos.compras.abrir_compra.ver?null:Object(V.jsx)(Fe.a,{item:!0,md:4,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Oo,{})})}),!1===e.accesos.compras.compras_realizadas.ver?null:Object(V.jsx)(Fe.a,{item:!0,md:4,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Uo,{})})}),!1===e.accesos.compras.compras_espera.ver?null:Object(V.jsx)(Fe.a,{item:!0,md:4,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(ls,{})})})]})})}var us=a(488),bs=a(897),ps=a(938),ms=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),Os=Object(k.a)({root:{width:"100%"},container:{maxHeight:"75vh"}});function xs(e){var t=e.user,a=e.tipo,n=e.filtro,c=e.ventas,r=e.handleClickOpen,i=Os(),o=Object(s.useContext)(di),l=o.setUpdateClientVenta,d=o.updateClientVenta,j=Object(ps.a)(n,1e3),u=Object(v.a)(j,1)[0],p=Object(s.useState)(!1),m=Object(v.a)(p,2),O=m[0],x=(m[1],Object(He.a)(Ii,{variables:{tipo:a,filtro:u},fetchPolicy:"network-only"})),h=x.loading,f=x.data,g=x.error,_=x.refetch,C=Object(s.useState)(!1),y=Object(v.a)(C,2),S=y[0],k=y[1],N=Object(s.useState)({}),F=Object(v.a)(N,2),z=F[0],P=F[1],D=Object(s.useState)({message:"",status:"",open:!1}),E=Object(v.a)(D,2),A=E[0],T=E[1],W=function(e,t){c&&!O&&(k(!0),P(e))};if(h)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",width:"120vh",children:Object(V.jsx)(I.a,{})});if(g)return Object(V.jsx)(Je,{error:g});var R=f.obtenerClientes;return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(B,{alert:A,setAlert:T}),Object(V.jsxs)(Da.a,{className:i.root,children:[Object(V.jsx)(ra.a,{className:i.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{width:"110",children:"No. Cliente"}),Object(V.jsx)(sa.a,{width:"100",children:"Clave"}),Object(V.jsx)(sa.a,{width:"200",children:"Nombre"}),Object(V.jsx)(sa.a,{width:"150",children:"Correo"}),Object(V.jsx)(sa.a,{width:"200",children:"Fecha Registro"}),"EMPLEADO"===t?null:Object(V.jsx)(sa.a,{width:"100",children:"Estado"}),Object(V.jsx)(sa.a,{width:"50",children:"Editar"}),"EMPLEADO"===t?null:Object(V.jsx)(sa.a,{width:"50",children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:R.map((function(e,a){return Object(V.jsx)(hs,{user:t,datos:e,handleClickOpenModal:W,setAlert:T,refetch:_},a)}))})]})}),Object(V.jsxs)(ze.a,{open:S,onClose:function(){return k(!1)},"aria-labelledby":"select-dialog-cliente-venta","aria-describedby":"select-cliente-venta-description",children:[Object(V.jsx)(wt.a,{id:"select-dialog-cliente-venta",children:" Estas seguro que desea seleccionar este cliente ?"}),Object(V.jsx)(Pe.a,{children:Object(V.jsx)(Lt.a,{id:"select-cliente-venta-description",children:"Al seleccionar el cliente se colocara en la venta."})}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:function(){return k(!1)},color:"primary",autoFocus:!0,children:"cancelar"}),Object(V.jsx)(w.a,{onClick:function(){return function(){try{var e,t=JSON.parse(localStorage.getItem("DatosVentas")),a=null===t?{}:t;localStorage.setItem("DatosVentas",JSON.stringify({subTotal:void 0===a.subTotal?0:a.subTotal,total:void 0===a.total?0:a.total,impuestos:void 0===a.impuestos?0:a.impuestos,iva:void 0===a.iva?0:a.iva,ieps:void 0===a.ieps?0:a.ieps,descuento:void 0===a.descuento?0:a.descuento,monedero:void 0===a.monedero?0:a.monedero,tipo_cambio:a.tipo_cambio?a.tipo_cambio:{},cliente:z,venta_cliente:!0,productos:(null===(e=a.productos)||void 0===e?void 0:e.length)>0?a.productos:[]})),l(!d),k(!S),r()}catch(g){console.log(g)}}()},color:"primary",children:"Aceptar"})]})]})]})]})}var hs=function(e){var t=e.datos,a=e.user,n=e.handleClickOpenModal,c=e.setAlert,r=e.refetch,i=JSON.parse(localStorage.getItem("sesionCafi")),o=Object(s.useContext)(di),l=o.update,d=o.setUpdate,j=Object(s.useState)(!1),u=Object(v.a)(j,2),b=u[0],p=u[1],m=Object(N.a)(ki),O=Object(v.a)(m,1)[0],x=function(){var e=Object(_.a)(g.a.mark((function e(a){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,O({variables:{input:{estado_cliente:a.target.checked},id:t._id}});case 4:d(!l),p(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),p(!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,onClick:function(e){return n(t,e)},children:[Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.numero_cliente})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.clave_cliente})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.nombre_cliente})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.email})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:Qe(t.fecha_registro)})}),"EMPLEADO"===a?null:Object(V.jsx)(sa.a,{children:b?Object(V.jsx)(I.a,{size:30}):Object(V.jsx)(bs.a,{checked:t.estado_cliente,onChange:x,color:"primary"})}),Object(V.jsx)(sa.a,{width:50,children:!1===i.accesos.catalogos.clientes.editar?null:Object(V.jsx)(zi,{tipo:"CLIENTE",accion:"actualizar",datos:t,refetch:r})}),Object(V.jsx)(sa.a,{width:50,children:!1===i.accesos.catalogos.clientes.editar?null:Object(V.jsx)(fs,{datos:t,setAlert:c,refetch:r})})]})})},fs=function(e){var t=e.datos,a=e.setAlert,n=e.refetch,c=Object(s.useState)(!1),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(N.a)(Ni),d=Object(v.a)(l,1)[0],j=Object(s.useState)(!1),u=Object(v.a)(j,2),b=u[0],p=u[1],m=function(){o(!1)},O=function(){var e=Object(_.a)(g.a.mark((function e(){var c,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,d({variables:{id:t._id}});case 4:(c=e.sent)&&(r=c.data.eliminarCliente.message,a({message:r,status:"success",open:!0}),n()),p(!1),m(),e.next=18;break;case 10:if(e.prev=10,e.t0=e.catch(1),console.log(e.t0),p(!1),!e.t0.message){e.next=17;break}return a({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 17:a({message:"Hubo un error",status:"error",open:!0});case 18:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{children:[Object(V.jsx)(X.a,{color:"secondary",onClick:function(){o(!0)},children:Object(V.jsx)(ur.a,{})}),Object(V.jsxs)(ze.a,{open:i,TransitionComponent:ms,keepMounted:!0,onClose:function(){return m()},"aria-labelledby":"alert-eliminar-cliente",children:[Object(V.jsx)(wt.a,{id:"alert-eliminar-cliente",children:"\xbfEst\xe1 seguro de eliminar esto?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:function(){return m()},color:"inherit",disabled:b,children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){return O()},color:"secondary",disabled:b,startIcon:b?Object(V.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Eliminar"})]})]})]})},gs=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},root:{display:"flex",paddingLeft:e.spacing(2)}}})),_s=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function vs(){var e=gs(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(""),o=Object(v.a)(i,2),l=o[0],d=o[1],j=function(){r(!1)};return Object(V.jsx)("div",{children:Object(V.jsxs)(ji,{children:[Object(V.jsx)(w.a,{onClick:function(){r(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Ce.i,{className:e.icon})}),"Cliente"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:c,onClose:j,TransitionComponent:_s,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Cliente"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:j,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(b.a,{m:3,children:Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsx)(Fe.a,{item:!0,md:6,xs:8,children:Object(V.jsxs)(Da.a,{className:e.root,children:[Object(V.jsx)(us.a,{fullWidth:!0,placeholder:"Buscar cliente...",onChange:function(e){return d(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&d(e.target.defaultValue)},value:l}),Object(V.jsx)(X.a,{onClick:function(){return d(l)},children:Object(V.jsx)(xc.a,{})})]})}),Object(V.jsx)(Fe.a,{item:!0,md:6,xs:4,style:{display:"flex",justifyContent:"flex-end"},children:!1===t.accesos.catalogos.clientes.agregar?null:Object(V.jsx)(zi,{tipo:"CLIENTE",accion:"registrar"})})]})}),Object(V.jsx)(b.a,{mx:4,children:Object(V.jsx)(xs,{tipo:"CLIENTE",filtro:l})})]})]})})}var Cs,ys,Ss,ws,Is=a(456),ks=a.n(Is),Ns=a(931),Fs=Object(z.d)(Cs||(Cs=Object(F.a)(["\n\tmutation CrearDescuentoUnidad($input: ObjetoDescuentoUnidadesInput!){\n        crearDescuentoUnidad(input: $input){\n            message\n        }\n  }\n"]))),zs=(Object(z.d)(ys||(ys=Object(F.a)(["\n\tmutation ActualizarDescuentoUnidad($input: ObjetoDescuentoUnidadesInput!){\n        actualizarDescuentoUnidad(input: $input){\n            message\n        }\n    }\n"]))),Object(z.d)(Ss||(Ss=Object(F.a)(["\n\tmutation DesactivarDescuentoUnidad($input: ActivarDescuentoUnidades , $id: ID!){\n        desactivarDescuentoUnidad(input: $input, id: $id){\n            message\n        }\n    }\n"])))),Ps=Object(z.d)(ws||(ws=Object(F.a)(["\n\tmutation ELiminarDescuentoUnidad( $id: ID!){\n        eliminarDescuentoUnidad( id: $id){\n            message\n        }\n    }\n"]))),Ds=[{id:"cantidad",label:"Cantidad"},{id:"tipo",label:"Tipo"},{id:"precio",label:"Precio U."},{id:"precioDes",label:"Precio Desc."},{id:"descuento",label:"% Desc."},{id:"eliminar",label:"Eliminar"},{id:"activo",label:"Activo"}];function Es(e){var t=e.onSelectAllClick,a=e.numSelected,n=e.rowCount,c=e.datosPrecios,r=!1;return null===c||void 0===c||c.forEach((function(e){if(e.medida)return r=!0})),Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(na.a,{indeterminate:a>0&&a<n,checked:n>0&&a===n,onChange:t,inputProps:{"aria-label":"select all desserts"}})}),Ds.map((function(e){return Object(V.jsx)(sa.a,{align:e.numeric?"right":"left",padding:e.disablePadding?"none":"default",children:e.label},e.id)})),!0===r?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(sa.a,{children:"Talla"}),Object(V.jsx)(sa.a,{children:"Color"})]}):null]})})}var As=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{height:300},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",display:"flex",justifyContent:"center",alignItems:"center",height:30,width:30,margin:1,borderRadius:"15%",cursor:"pointer"}}}));function Ts(e){var t=e.value,a=e.datos,n=e.setCleanList,c=e.cleanList,r=e.verificarDatos,i=e.setPrecioPrueba,o=e.productosRefetch,l=e.setLoading,d=e.loading,j=As(),u=Object(s.useContext)(xe),b=u.datosPreciosProducto,p=u.setPreciosProductos,m=u.setDatosPreciosProducto,O=Object(s.useState)({message:"",status:"",open:!1}),x=Object(v.a)(O,2),h=x[0],f=x[1],g=parseFloat((100-t).toFixed(6)),_=Object(s.useState)([]),C=Object(v.a)(_,2),y=C[0],S=C[1],w=Object(s.useState)(0),I=Object(v.a)(w,2),k=I[0],N=(I[1],Object(s.useState)(5)),F=Object(v.a)(N,2),z=F[0];F[1];a&&(a.medidas_producto.length>0?m(a.medidas_producto):m(a.unidades_de_venta));var P=function(e,t){var a=y.indexOf(t),n=[];-1===a?n=n.concat(y,t):0===a?n=n.concat(y.slice(1)):a===y.length-1?n=n.concat(y.slice(0,-1)):a>0&&(n=n.concat(y.slice(0,a),y.slice(a+1))),i(0===n.length?0:n),p(n),r(n),S(n)};Object(s.useEffect)((function(){S([]),n(!1)}),[c]);var D=z-Math.min(z,b.length-k*z);return Object(V.jsxs)("div",{className:j.root,children:[Object(V.jsx)(B,{alert:h,setAlert:f}),Object(V.jsxs)(Da.a,{className:j.paper,children:[Object(V.jsx)(Ve,{loading:d,setLoading:l}),Object(V.jsx)(ra.a,{className:j.table,children:Object(V.jsxs)(da.a,{className:j.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"a dense table",children:[Object(V.jsx)(Es,{classes:j,numSelected:y.length,onSelectAllClick:function(e){if(e.target.checked){var t=b.map((function(e){return e}));return S(t),r(t),void p(t)}p([]),S([])},rowCount:b.length,datosPrecios:b}),Object(V.jsxs)(la.a,{children:[b.map((function(e,n){var c,r=(c=e,-1!==y.indexOf(c)),i="enhanced-table-checkbox-".concat(n);return Object(V.jsx)(Ws,{setLoading:l,productosRefetch:o,handleClick:P,selected:y,row:e,setAlert:f,porcentaje:g,value:t,datos:a,isItemSelected:r,labelId:i},e._id)})),D>0&&Object(V.jsx)(oa.a,{style:{height:53*D},children:Object(V.jsx)(sa.a,{colSpan:6})})]})]})})]})]})}function Ws(e){var t,a,n,c,r=e.row,i=e.value,o=e.isItemSelected,l=e.setLoading,d=e.datos,j=e.labelId,u=e.setAlert,b=e.porcentaje,p=e.productosRefetch,m=e.handleClick,O=e.selected,x=As(),h=Object(ve.a)(),f=Object(s.useState)(!1),C=Object(v.a)(f,2),y=C[0],S=C[1],w=Object(s.useContext)(xe).setDatosPreciosProducto,I=Object(N.a)(zs),k=Object(v.a)(I,1)[0],F=Object(N.a)(Ps),z=Object(v.a)(F,1)[0],P=function(){var e=Object(_.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.prev=1,e.next=4,k({variables:{input:{descuento_activo:!r.descuento_activo},id:r._id}});case 4:l(!1),p(),u({message:"Estado de descuento actualizado",status:"success",open:!0}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),u({message:"Ocurrio un problema en el servidor",status:"error",open:!0});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),D=function(){S(!y),E()},E=function(){d.medidas_producto.length>0?(w(d.medidas_producto),l(!1)):(w(d.unidades_de_venta),l(!1))},A=function(){var e=Object(_.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.prev=1,p(),e.next=5,z({variables:{id:r._id}});case 5:t=e.sent,D(),E(),u({message:t.data.eliminarDescuentoUnidad.message,status:"success",open:!0}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),u({message:e.t0.message,status:"error",open:!0});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox","aria-checked":o,tabIndex:-1,selected:o,children:[Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(na.a,{onClick:function(e){m(e,r)},checked:o,inputProps:{"aria-labelledby":j}})}),Object(V.jsx)(sa.a,{align:"center",children:r.cantidad}),Object(V.jsx)(sa.a,{align:"center",children:null===r||void 0===r?void 0:r.unidad}),Object(V.jsx)(sa.a,{align:"center",children:r.precio}),Object(V.jsx)(sa.a,{align:"center",children:!0===o&&O.length>1?Object(V.jsxs)("b",{style:{color:"green"},children:[" $",parseFloat((r.precio*b/100).toFixed(2))," "]}):null===r.descuento?0:Object(V.jsxs)("b",{style:{color:"green"},children:[" $",r.descuento.precio_neto," "]})}),Object(V.jsx)(sa.a,{align:"center",children:!0===o&&O.length>1?Object(V.jsxs)("b",{style:{color:"red"},children:[" ",i,"% "]}):r.descuento&&null!==r.descuento?Object(V.jsxs)("b",{style:{color:"red"},children:[" ",r.descuento.porciento,"% "]}):0}),Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)(Rs,{row:r,handleModal:D,openModal:y,handleDelete:A})}),Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)(bs.a,{onChange:P,color:"primary",disabled:!r.descuento||0===r.descuento.porciento,defaultChecked:!!r.descuento_activo&&r.descuento_activo,name:"descuento_activo",inputProps:{"aria-label":"secondary checkbox"}},r._id)},r._id),r.medida?Object(V.jsx)(sa.a,{align:"center",children:null===r||void 0===r||null===(t=r.medida)||void 0===t?void 0:t.talla}):null,r.color?Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)(Aa.a,{title:null===r||void 0===r||null===(a=r.color)||void 0===a?void 0:a.nombre,placement:"top",arrow:!0,TransitionComponent:Ta.a,children:Object(V.jsx)("div",{className:x.colorContainer,style:{backgroundColor:null===r||void 0===r||null===(n=r.color)||void 0===n?void 0:n.hex,color:h.palette.getContrastText(null===r||void 0===r||null===(c=r.color)||void 0===c?void 0:c.hex)}})})}):null]},r._id)}var Rs=function(e){var t=e.row,a=e.handleModal,n=e.openModal,c=e.handleDelete;return Object(V.jsxs)("div",{children:[Object(V.jsx)(X.a,{color:"secondary",onClick:a,disabled:!t.descuento||0===t.descuento.porciento,children:Object(V.jsx)(ur.a,{})}),Object(V.jsxs)(ze.a,{open:n,onClose:a,children:[Object(V.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:a,color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:c,children:"Eliminar"})]})]})]})},$s=Object(k.a)((function(e){return{avatarGroup:{"& > .MuiAvatarGroup-avatar":{width:e.spacing(8),height:e.spacing(8)}},root:{width:400},rootSlice:{width:350},margin:{height:e.spacing(3)},rootTable:{height:300}}}));function Ms(e){var t=e.datos,a=e.productosRefetch,n=Object(N.a)(Fs),c=Object(v.a)(n,1)[0],r=Object(s.useContext)(xe),i=r.setDatosPreciosProducto,o=r.preciosDescuentos,l=r.setPreciosDescuentos,d=r.preciosProductos,j=r.setPreciosProductos,u=t.precios.iva,p=t.precios.ieps,m=t.precios.unidad_de_compra.precio_unitario_sin_impuesto,O=Object(s.useState)({message:"",status:"",open:!1}),x=Object(v.a)(O,2),h=x[0],f=x[1],C=Object(s.useState)(!1),I=Object(v.a)(C,2),k=I[0],F=I[1],z=Object(s.useState)(!1),P=Object(v.a)(z,2),D=P[0],E=P[1],A=Object(s.useState)(!1),T=Object(v.a)(A,1)[0],W=Object(s.useState)(!1),R=Object(v.a)(W,2),$=R[0],M=R[1],L=Object(s.useState)(0),U=Object(v.a)(L,2),J=U[0],G=U[1],q=Object(s.useState)(0),H=Object(v.a)(q,2),Y=H[0],K=H[1],Q=$s(),Z=function(){t.medidas_producto.length>0?(i(t.medidas_producto),M(!1)):(i(t.unidades_de_venta),M(!1)),G(0),K(0),o.splice(0,o.length)},ee=function(){F(!k),Z()},te=Object(s.useCallback)((function(e){for(var t=0;t<e.length;t++)e[t].descuento&&0!==e[t].descuento.porciento&&(K(e[t].descuento.porciento),1===e.length&&G(e[t].descuento.precio_neto))}),[t]),ae=[];var ne=function(){var e=Object(_.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M(!0),e.prev=1,e.next=4,c({variables:{input:{descuentos:o}}});case 4:Z(),a(),K(0),j([]),l([]),E(!D),f({message:"\xa1Listo descuentos realizados!",status:"success",open:!0}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),f({message:"\xa1Oh no, ocurrio un problema con el servidor!",status:"error",open:!0});case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{children:[Object(V.jsx)(B,{alert:h,setAlert:f}),Object(V.jsx)(X.a,{color:function(){if(t.medidas_producto.length>0)for(var e=0;e<t.medidas_producto.length;e++){var a;return!0===(null===(a=t.medidas_producto[e])||void 0===a?void 0:a.descuento_activo)?"primary":"default"}else for(var n=0;n<t.unidades_de_venta.length;n++){var c;return!0===(null===(c=t.unidades_de_venta[n])||void 0===c?void 0:c.descuento_activo)?"primary":"default"}}(),onClick:ee,disabled:t.inventario_general&&t.inventario_general.length>0&&!0===t.inventario_general[0].eliminado,children:Object(V.jsx)(ks.a,{})}),Object(V.jsxs)(ze.a,{open:k,onClose:Z,fullWidth:!0,maxWidth:"lg",children:[Object(V.jsx)(Ve,{loading:$,setLoading:M}),Object(V.jsx)(wt.a,{children:Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(b.a,{flexGrow:1,display:"flex",alignItems:"center",children:"Descuento de Producto"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:ee,size:"large",children:Object(V.jsx)($e.a,{})})})]})}),Object(V.jsxs)(Pe.a,{children:[Object(V.jsx)(b.a,{textAlign:"center",children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Nombre comercial: "}),t.datos_generales.nombre_comercial?t.datos_generales.nombre_comercial:"-"]})}),Object(V.jsx)(b.a,{textAlign:"center",children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Nombre gen\xe9rico: "}),t.datos_generales.nombre_generico?t.datos_generales.nombre_generico:"-"]})}),Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,lg:8,md:6,xs:12,children:Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(Ts,{verificarDatos:te,productosRefetch:a,datos:t,value:Y,cleanList:D,setCleanList:E,setPrecioPrueba:G,setLoading:M,loading:$})})}),Object(V.jsxs)(Fe.a,{item:!0,lg:4,md:6,xs:12,children:[Object(V.jsx)(b.a,{mt:5,dislay:"flex",justifyContent:"center",children:Object(V.jsxs)("div",{className:Q.root,children:[Object(V.jsx)(b.a,{textAlign:"center",children:Object(V.jsx)(y.a,{id:"discrete-slider-always",gutterBottom:!0,children:Object(V.jsx)("b",{children:"Porcentaje de descuento"})})}),Object(V.jsx)(b.a,{my:5}),Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",justifyItems:"center",className:Q.rootSlice,children:Object(V.jsx)(Ns.a,{disabled:0===d.length,getAriaValueText:function(e){return"".concat(e)},value:Y.toFixed(2),"aria-labelledby":"discrete-slider-small-steps",valueLabelDisplay:"auto",onChange:function(e,t){K(t),o.splice(0,o.length);for(var a=0;a<d.length;a++){var n,c,r=parseFloat((100-t).toFixed(2)),i=d[a].precio_unidad.cantidad_unidad;n=parseFloat((d[a].precio_unidad.precio_venta*r/100).toFixed(2)),c=parseFloat((d[a].precio_unidad.precio_venta-n).toFixed(2));var s=parseFloat(n*parseFloat("0.".concat(u<10?"0".concat(u):u)).toFixed(2)),j=parseFloat(n*parseFloat("0.".concat(p<10?"0".concat(p):p)).toFixed(2)),b=parseFloat(((n-m)/m*100).toFixed(2)),O=parseFloat((n+s+j).toFixed(2)),x=parseFloat((O*i).toFixed(2));ae={_id:d[a]._id,descuento_activo:!0,descuento:{cantidad_unidad:i,numero_precio:d[a].precio_unidad.numero_precio,unidad_maxima:d[a].precio_unidad.unidad_maxima,precio_general:x,precio_neto:O,precio_venta:n,iva_precio:s,ieps_precio:j,utilidad:b,porciento:t,dinero_descontado:c}},G(O),1!==d.length?o.push(ae):l([ae])}}})})]})}),Object(V.jsx)(b.a,{mt:5,display:"flex",justifyContent:"center",children:1===d.length?Object(V.jsxs)("div",{children:[Object(V.jsx)(y.a,{children:"Precio con Descuento"}),Object(V.jsx)(S.a,{type:"number",InputProps:{inputProps:{min:0}},size:"small",variant:"outlined",value:J,onChange:function(e){return function(e){var t=parseFloat(e.target.value);if(1===d.length){G(t);var a,n,c=parseFloat("0.".concat(u<10?"0".concat(u):u))+parseFloat("0.".concat(p<10?"0".concat(p):p)),r=parseFloat((t/(c+1)).toFixed(2)),i=d[0].precio_unidad.cantidad_unidad,o=parseFloat((r/d[0].precio_unidad.precio_venta*100).toFixed(2)),s=parseFloat((100-o).toFixed(2));n=parseFloat((d[0].precio_unidad.precio_venta*o/100).toFixed(2)),a=parseFloat((d[0].precio_unidad.precio_venta-n).toFixed(2));var j=parseFloat(n*parseFloat("0.".concat(u<10?"0".concat(u):u)).toFixed(2)),b=parseFloat(n*parseFloat("0.".concat(p<10?"0".concat(p):p)).toFixed(2)),O=parseFloat(((n-m)/m*100).toFixed(2)),x=parseFloat((n+j+b).toFixed(2)),h=parseFloat((x*i).toFixed(2));ae={_id:d[0]._id,descuento_activo:!0,descuento:{cantidad_unidad:i,numero_precio:d[0].precio_unidad.numero_precio,unidad_maxima:d[0].precio_unidad.unidad_maxima,precio_general:h,precio_neto:x,precio_venta:n,iva_precio:j,ieps_precio:b,utilidad:O,porciento:s,dinero_descontado:a}},K(s),l([ae])}}(e)}})]}):null}),Object(V.jsx)(b.a,{mt:2,display:"flex",justifyContent:"center",children:Object(V.jsx)(w.a,{disabled:0===d.length||!0===T,variant:"contained",color:"primary",size:"large",onClick:ne,children:"Guardar"})})]})]})]})]})]})}var Ls=a(899),Vs=a(898),Us=a(900),Bs=Object(k.a)((function(e){return{drawWidth:Object(h.a)({width:"50vw"},e.breakpoints.down("sm"),{width:"100vw"})}}));function Js(e){var t=e.producto,a=t.datos_generales,n=t.imagenes,c=Bs(),r=Object(s.useState)(!1),i=Object(v.a)(r,2),o=i[0],l=i[1],d=function(){return l(!o)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(X.a,{color:"default",variant:"contained",onClick:function(){return d()},children:Object(V.jsx)(Vs.a,{})}),Object(V.jsxs)(Ls.a,{anchor:"right",open:o,onClose:function(){return d()},children:[Object(V.jsxs)("div",{className:c.drawWidth,children:[Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,md:n.length>1?6:12,style:{display:"flex",justifyContent:"center"},children:Object(V.jsx)(b.a,{m:1,width:"300px",height:"300px",display:"flex",justifyContent:"center",alignItems:"center",children:n.length>0?Object(V.jsx)("img",{width:"100%",alt:"img producto",src:n[0].url_imagen}):Object(V.jsx)(Us.a,{style:{fontSize:90}})})}),n.length>1?Object(V.jsx)(Fe.a,{item:!0,md:6,children:Object(V.jsx)(Fe.a,{container:!0,children:n.map((function(e,t){return t>0?Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsx)(b.a,{m:1,height:120,width:120,display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{width:"100%",alt:"img producto",src:e.url_imagen})},t)},t):null}))})}):null]}),Object(V.jsx)(b.a,{m:5,children:Object(V.jsxs)(Fe.a,{container:!0,spacing:3,justify:"center",children:[Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"C\xf3digo de barras: "}),a.codigo_barras?a.codigo_barras:"-"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Clave alterna: "}),a.clave_alterna?a.clave_alterna:"-"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Clave producto del SAT: "}),a.clave_producto_sat&&a.clave_producto_sat.Value?a.clave_producto_sat.Value:"-"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Nombre comercial: "}),a.nombre_comercial?a.nombre_comercial:"-"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Nombre gen\xe9rico: "}),a.nombre_generico?a.nombre_generico:"-"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Descripci\xf3n: "}),a.descripcion?a.descripcion:"-"]})]}),Object(V.jsxs)(Fe.a,{item:!0,children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Tipo de producto: "}),a.tipo_producto?a.tipo_producto:"-"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Categoria: "}),a.categoria?a.categoria:"-"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Subcategoria: "}),a.subcategoria?a.subcategoria:"-"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Departamento: "}),a.departamento?a.departamento:"-"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Marca: "}),a.marca?a.marca:"-"]})]})]})})]}),Object(V.jsx)(b.a,{position:"absolute",bottom:16,width:"100%",display:"flex",justifyContent:"center",children:Object(V.jsx)(w.a,{variant:"contained",color:"primary",size:"large",onClick:function(){return d()},startIcon:Object(V.jsx)(zt.a,{}),children:"Cerrar"})})]})]})}var Gs=Object(s.forwardRef)((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function qs(e){var t=e.datos,a=e.productosRefetch,n=Object(s.useState)(!1),c=Object(v.a)(n,2),r=c[0],i=c[1],o=Object(s.useState)(!1),l=Object(v.a)(o,2),d=l[0],j=l[1],u=Object(s.useContext)(xe),b=u.actualizarLista,p=u.setActualizarLista,m=u.setAlert,O=Object(N.a)(hn),x=Object(v.a)(O,1)[0],h=function(){return i(!r)},f=function(){var e=Object(_.a)(g.a.mark((function e(){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.prev=1,e.next=4,x({variables:{id:t._id}});case 4:n=e.sent,p(!b),a(),m({message:"\xa1Listo! ".concat(n.data.eliminarProducto.message),status:"success",open:!0}),j(!1),h(),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),m({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),j(!1),h();case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(X.a,{onClick:function(){return h()},disabled:!(!t.inventario_general||0!==t.inventario_general.length)||!0===t.inventario_general[0].eliminado,children:Object(V.jsx)(ur.a,{color:t.inventario_general&&0===t.inventario_general.length||!0===t.inventario_general[0].eliminado?"disabled":"error"})}),Object(V.jsxs)(ze.a,{open:r,TransitionComponent:Gs,keepMounted:!0,onClose:function(){return h()},"aria-labelledby":"alert-dialog-delete-producto",children:[Object(V.jsx)(wt.a,{id:"alert-dialog-delete-producto",children:"\xbfEst\xe1s seguro de eliminar este producto?"}),Object(V.jsxs)(We.a,{style:{display:"flex",justifyContent:"center"},children:[Object(V.jsx)(w.a,{onClick:function(){return h()},color:"inherit",children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){return f()},color:"secondary",startIcon:d?Object(V.jsx)(I.a,{color:"inherit",size:20}):null,children:"Eliminar"})]})]})]})}var Hs=Object(k.a)({root:{width:"100%"},container:{maxHeight:"70vh","& ::-webkit-scrollbar":{display:"none"}},avatar:{width:130,height:130}});function Ys(e){var t=e.obtenerProductos,a=e.productosRefetch,n=Hs();return Object(V.jsx)("div",{className:n.root,children:Object(V.jsx)(ra.a,{className:n.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,"aria-label":"sticky table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Codigo barras"}),Object(V.jsx)(sa.a,{children:"Clave alterna"}),Object(V.jsx)(sa.a,{children:"Nombre comercial"}),Object(V.jsx)(sa.a,{children:"Existencia"}),Object(V.jsx)(sa.a,{children:"Tipo"}),Object(V.jsx)(sa.a,{children:"Informaci\xf3n"}),Object(V.jsx)(sa.a,{children:"Editar"}),Object(V.jsx)(sa.a,{children:"Descuento"}),Object(V.jsx)(sa.a,{children:"Eliminar"})]})}),Object(V.jsx)(la.a,{className:"hide-scroll",children:t.map((function(e,t){return Object(V.jsx)(Xs,{producto:e,productosRefetch:a},t)}))})]})})})}var Xs=function(e){var t=e.producto,a=e.productosRefetch;return Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(oa.a,{hover:!0,children:[Object(V.jsx)(sa.a,{children:t.datos_generales.codigo_barras}),Object(V.jsx)(sa.a,{children:t.datos_generales.clave_alterna}),Object(V.jsx)(sa.a,{children:t.datos_generales.nombre_comercial}),Object(V.jsx)(sa.a,{align:"center",padding:"checkbox",children:t.inventario_general.map((function(e){return"".concat(e.cantidad_existente," ").concat(e.unidad_inventario)}))}),Object(V.jsx)(sa.a,{children:t.datos_generales.tipo_producto}),Object(V.jsx)(sa.a,{align:"center",padding:"checkbox",children:Object(V.jsx)(Js,{producto:t})}),Object(V.jsx)(sa.a,{align:"center",padding:"checkbox",children:Object(V.jsx)(ni,{accion:!0,datos:t,productosRefetch:a})}),Object(V.jsx)(sa.a,{align:"center",padding:"checkbox",children:Object(V.jsx)(Ms,{datos:t,productosRefetch:a})}),Object(V.jsx)(sa.a,{align:"center",padding:"checkbox",children:Object(V.jsx)(qs,{datos:t,productosRefetch:a})})]})})},Ks=a(903),Qs=a(901),Zs=a(902),el=Object(s.forwardRef)((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function tl(e){var t=e.productosActivosRefetch,a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=function(){return r(!c)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{disableElevation:!0,color:"primary",onClick:i,size:"large",startIcon:Object(V.jsx)(Qs.a,{}),children:"Productos inactivos"}),Object(V.jsxs)(ze.a,{open:c,TransitionComponent:el,keepMounted:!0,onClose:i,"aria-labelledby":"dialog-productos-eliminados",maxWidth:"md",fullWidth:!0,children:[Object(V.jsx)(wt.a,{id:"dialog-productos-eliminados",children:"Productos inactivos"}),Object(V.jsx)(Pe.a,{children:Object(V.jsx)(al,{productosActivosRefetch:t})}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{variant:"contained",onClick:i,color:"primary",size:"large",children:"Cerrar"})})]})]})}var al=function(e){var t=e.productosActivosRefetch,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(s.useContext)(xe).actualizarLista,c=Object(He.a)(fn,{variables:{sucursal:a.sucursal._id,empresa:a.empresa._id}}),r=c.loading,i=c.data,o=c.error,l=c.refetch;if(Object(s.useEffect)((function(){l()}),[l,n]),r)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})});if(o)return Object(V.jsx)(Je,{error:o});if(!r&&!o&&!i)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(y.a,{variant:"h6",children:"No hay productos inactivos"})});var d=i.obtenerProductosInactivos;return Object(V.jsx)(b.a,{height:"60vh",children:Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{"aria-label":"simple table",size:"small",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{align:"left",children:"C\xf3digo de barras"}),Object(V.jsx)(sa.a,{align:"left",children:"Clave alterna"}),Object(V.jsx)(sa.a,{children:"Nombre comercial"}),Object(V.jsx)(sa.a,{align:"right",children:"Reactivar"})]})}),Object(V.jsx)(la.a,{children:d.map((function(e,a){return Object(V.jsx)(nl,{datos:e,refetch:l,productosActivosRefetch:t},a)}))})]})})})},nl=function(e){var t=e.datos,a=e.refetch,n=e.productosActivosRefetch,c=Object(s.useState)(!1),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)(!1),d=Object(v.a)(l,2),j=d[0],u=d[1],b=t.producto.datos_generales,p=Object(s.useContext)(xe).setAlert,m=Object(N.a)(gn),O=Object(v.a)(m,1)[0],x=function(){return o(!i)},h=function(){var e=Object(_.a)(g.a.mark((function e(){var c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,O({variables:{id:t._id}});case 4:c=e.sent,a(),n(),p({message:"\xa1Listo! ".concat(c.data.activarProducto.message),status:"success",open:!0}),u(!1),x(),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),p({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),u(!1);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{align:"left",children:b.codigo_barras}),Object(V.jsx)(sa.a,{align:"left",children:b.clave_alterna}),Object(V.jsx)(sa.a,{children:b.nombre_comercial}),Object(V.jsx)(sa.a,{align:"right",children:j?Object(V.jsx)(X.a,{color:"primary",disabled:!0,onClick:x,children:Object(V.jsx)(I.a,{size:26})}):Object(V.jsx)(X.a,{color:"primary",onClick:x,children:Object(V.jsx)(Zs.a,{})})})]}),Object(V.jsxs)(ze.a,{open:i,onClose:x,"aria-labelledby":"reactivar-producto-dialog",children:[Object(V.jsx)(wt.a,{id:"reactivar-producto-dialog",children:"Se reactivar\xe1 este producto"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:x,color:"inherit",children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){return h()},color:"primary",autoFocus:!0,children:"Aceptar"})]})]})]})},cl=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},iconSvg:{width:100},root:{flexGrow:1,backgroundColor:e.palette.background.paper}}})),rl=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function il(){var e=cl(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useContext)(xe),i=r.alert,o=r.setAlert,d=function(){c(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/productos.svg",alt:"icono ropa",className:e.iconSvg})}),"Productos"]})}),Object(V.jsx)(B,{alert:i,setAlert:o}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:d,TransitionComponent:rl,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Productos"}),Object(V.jsx)(w.a,{autoFocus:!0,color:"inherit",size:"large",onClick:function(){return d()},startIcon:Object(V.jsx)(zt.a,{}),children:"Cerrar"})]})}),Object(V.jsx)(ol,{})]})]})}var ol=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(s.useState)(""),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useState)(""),i=Object(v.a)(r,2),o=i[0],l=i[1],d=Object(s.useState)(!0),j=Object(v.a)(d,2),u=j[0],p=j[1],m=Object(s.useState)(0),O=Object(v.a)(m,2),x=O[0],h=O[1],f=cl(),g=Object(He.a)(On,{variables:{sucursal:e.sucursal._id,empresa:e.empresa._id,filtro:n,existencias:u},fetchPolicy:"network-only"}),_=g.loading,C=g.data,y=g.error,S=g.refetch;if(_)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})});if(y)return Object(V.jsx)(Je,{error:y});var w=C.obtenerProductos;return Object(V.jsxs)("div",{children:[Object(V.jsxs)(b.a,{mx:4,my:3,display:"flex",children:[Object(V.jsx)(b.a,{style:{width:"500px"},children:Object(V.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),""===o)return c(""),void S({filtro:""});c(o)},style:{display:"flex",alignItems:"center"},children:[Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsx)(H.a,{id:"search-producto",type:"text",value:o,onChange:function(e){return l(e.target.value)},endAdornment:Object(V.jsx)(Y.a,{position:"start",children:Object(V.jsx)(X.a,{type:"submit","aria-label":"search producto",edge:"end",children:Object(V.jsx)(xc.a,{})})})})}),""!==n?Object(V.jsx)(X.a,{color:"primary",onClick:function(){return l(""),c(""),void S({filtro:""})},children:Object(V.jsx)(Ks.a,{})}):null]})}),Object(V.jsx)(b.a,{flexGrow:1}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(tl,{productosActivosRefetch:S}),Object(V.jsx)(b.a,{mx:1}),Object(V.jsx)(ni,{accion:!1,productosRefetch:S})]})]}),Object(V.jsxs)(b.a,{mx:4,children:[Object(V.jsx)("div",{className:f.root,children:Object(V.jsxs)(we.a,{indicatorColor:"primary",value:x,onChange:function(e,t){h(t),p(0===t)},"aria-label":"simple tabs example",children:[Object(V.jsx)(Ie.a,{label:"Productos de Sucursal"}),Object(V.jsx)(Ie.a,{label:"Todos los productos"})]})}),Object(V.jsx)(Ys,{obtenerProductos:w,productosRefetch:S})]})]})};function sl(){return Object(V.jsx)(he,{children:Object(V.jsx)(il,{})})}var ll=a(932),dl=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)}}}));function jl(e){var t=e.tipo,a=e.datos,n=e.toUpdate,c=e.setToUpdate,r=e.setValue,i=e.refetch,o=JSON.parse(localStorage.getItem("sesionCafi")),l=dl(),d=Object(s.useState)(0),j=Object(v.a)(d,2),u=j[0],p=j[1],m=Object(s.useState)(7),O=Object(v.a)(m,2),x=O[0],h=O[1],f=Object(s.useState)(""),g=Object(v.a)(f,2),_=g[0],C=g[1],y=Object(s.useState)([]),w=Object(v.a)(y,2),I=w[0],k=w[1],N=Object(s.useState)({status:"",message:"",open:!1}),F=Object(v.a)(N,2),z=F[0],P=F[1];return Object(s.useEffect)((function(){k(a.filter((function(e){return e.talla.toLowerCase().includes(_.toLowerCase())})))}),[_,a]),Object(V.jsxs)("div",{className:l.root,children:[Object(V.jsx)(B,{alert:z,setAlert:P}),Object(V.jsxs)(Da.a,{className:l.paper,children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(S.a,{fullWidth:!0,placeholder:"Buscar...",variant:"outlined",onChange:function(e){return C(e.target.value)}})}),Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{className:l.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"ROPA"===t?"Talla":"N\xfamero"}),!1===o.accesos.catalogos.tallas_numeros.editar?null:Object(V.jsx)(sa.a,{padding:"default",children:"Editar"}),!1===o.accesos.catalogos.tallas_numeros.eliminar?null:Object(V.jsx)(sa.a,{padding:"default",children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:I.slice(u*x,u*x+x).map((function(e,a){return Object(V.jsx)(ul,{row:e,setAlert:P,tipo:t,toUpdate:n,setToUpdate:c,setValue:r,refetch:i},a)}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[],component:"div",count:a.length,rowsPerPage:x,page:u,onChangePage:function(e,t){p(t)},onChangeRowsPerPage:function(e){h(parseInt(e.target.value,10)),p(0)}})]})]})}var ul=function(e){var t=e.row,a=e.setAlert,n=e.tipo,c=e.toUpdate,r=e.setToUpdate,i=e.setValue,o=e.refetch,l=JSON.parse(localStorage.getItem("sesionCafi")),d=Object(s.useState)(!1),j=Object(v.a)(d,2),u=j[0],b=j[1],p=function(){return b(!u)},m=Object(N.a)(nc),O=Object(v.a)(m,1)[0],x=function(){var e=Object(_.a)(g.a.mark((function e(){var c,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O({variables:{id:t._id,input:{tipo:n,talla:""}}});case 3:c=e.sent,r={message:c.data.eliminarTalla.message,status:"success",open:!0},a(r),o(),p(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),p(),a({message:e.t0.message,status:"error",open:!0});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),h=function(e){if(!e)return r(""),void i("");r(e._id),i(e.talla)};return Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:c===t._id,children:[Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:t.talla})})}),!1===l.accesos.catalogos.tallas_numeros.editar?null:Object(V.jsx)(sa.a,{padding:"checkbox",children:c===t._id?Object(V.jsx)(X.a,{onClick:function(){return h()},children:Object(V.jsx)(zt.a,{})}):Object(V.jsx)(X.a,{onClick:function(){return h(t)},children:Object(V.jsx)($a.a,{})})}),!1===l.accesos.catalogos.tallas_numeros.eliminar?null:Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(bl,{handleModal:p,openModal:u,handleDelete:x})})]})})},bl=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete;return Object(V.jsxs)("div",{children:[Object(V.jsx)(X.a,{color:"secondary",onClick:t,children:Object(V.jsx)(ur.a,{})}),Object(V.jsxs)(ze.a,{open:a,onClose:t,children:[Object(V.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"Eliminar"})]})]})]})};function pl(e){var t=e.tipo,a=Object(s.useState)(""),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(""),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)({message:"",status:"",open:!1}),u=Object(v.a)(j,2),p=u[0],m=u[1],O=JSON.parse(localStorage.getItem("sesionCafi")),x=Object(He.a)(tc,{variables:{sucursal:O.sucursal._id,tipo:t}}),h=x.loading,f=x.data,C=x.error,y=x.refetch,k=Object(N.a)(ec),F=Object(v.a)(k,1)[0],z=Object(N.a)(ac),P=Object(v.a)(z,1)[0];if(h)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})});if(C)return Object(V.jsx)(Je,{error:C});var D=f.obtenerTallas,E=function(){var e=Object(_.a)(g.a.mark((function e(){var a,n,i,o;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,n=c,!l){e.next=15;break}if(!1!==O.accesos.catalogos.tallas_numeros.editar){e.next=9;break}return e.abrupt("return",m({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 9:return i=et(n),e.next=12,P({variables:{input:{talla:i,tipo:t},id:l}});case 12:a=e.sent;case 13:e.next=22;break;case 15:if(!1!==O.accesos.catalogos.tallas_numeros.agregar){e.next=19;break}return e.abrupt("return",m({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 19:return e.next=21,F({variables:{input:{talla:n,tipo:t,empresa:O.empresa._id,sucursal:O.sucursal._id}}});case 21:a=e.sent;case 22:y(),r(""),d(""),o=l?{message:a.data.actualizarTalla.message,status:"success",open:!0}:{message:a.data.crearTalla.message,status:"success",open:!0},m(o),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(2),m({message:"Hubo un error",status:"error",open:!0});case 32:case"end":return e.stop()}}),e,null,[[2,29]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(b.a,{children:[Object(V.jsx)(B,{alert:p,setAlert:m}),Object(V.jsxs)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",my:2,children:[Object(V.jsx)(S.a,{id:"outlined-error-helper-text",label:"ROPA"===t?"Talla":"N\xfamero",variant:"outlined",size:"small",value:c,onChange:function(e){return r(e.target.value.toUpperCase())}}),Object(V.jsx)(b.a,{ml:1}),Object(V.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:E,children:[Object(V.jsx)(It.a,{}),"Guardar"]})]}),Object(V.jsx)(jl,{datos:D,tipo:t,toUpdate:l,setToUpdate:d,setValue:r,refetch:y})]})}var ml=["children","value","index"];function Ol(e){var t=e.children,a=e.value,n=e.index,c=Object(fe.a)(e,ml);return Object(V.jsx)("div",Object(u.a)(Object(u.a)({role:"tabpanel",hidden:a!==n,id:"scrollable-force-tabpanel-".concat(n),"aria-labelledby":"scrollable-force-tab-".concat(n)},c),{},{children:a===n&&Object(V.jsx)(b.a,{p:2,my:1,minHeight:"50vh",children:t})}))}function xl(e){return{id:"scrollable-force-tab-".concat(e),"aria-controls":"scrollable-force-tabpanel-".concat(e)}}var hl,fl,gl,_l,vl=Object(k.a)((function(e){return{root:{flexGrow:1,width:"100%",height:"100vh",backgroundColor:e.palette.background.paper},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},iconSvg:{width:100},icon:{fontSize:100},iconSvgSecondary:{width:50}}})),Cl=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function yl(){var e=vl(),t=Object(s.useState)(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useState)(0),i=Object(v.a)(r,2),o=i[0],l=i[1],d=function(){return c(!n)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:d,children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/tallas.svg",alt:"icono ropa",className:e.iconSvg})}),"Tallas y numeros"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:d,TransitionComponent:Cl,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Ropa"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:d,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)("div",{className:e.root,children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(Se.a,{position:"static",color:"default",elevation:0,children:Object(V.jsxs)(we.a,{value:o,onChange:function(e,t){return l(t)},indicatorColor:"primary",textColor:"primary",centered:!0,children:[Object(V.jsx)(Ie.a,Object(u.a)({label:"Tallas",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/shirt.svg",alt:"icono tallas",className:e.iconSvgSecondary})},xl(0))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Numeros",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/shoes.svg",alt:"icono numeros",className:e.iconSvgSecondary})},xl(1)))]})}),Object(V.jsxs)("div",{children:[Object(V.jsx)(Ol,{value:o,index:0,children:Object(V.jsx)(C.a,{maxWidth:"xs",children:Object(V.jsx)(pl,{tipo:"ROPA"})})}),Object(V.jsx)(Ol,{value:o,index:1,children:Object(V.jsx)(C.a,{maxWidth:"xs",children:Object(V.jsx)(pl,{tipo:"CALZADO"})})})]})]})})]})]})}var Sl=Object(z.d)(hl||(hl=Object(F.a)(["\n    query obtenerContabilidad($empresa: ID!, $sucursal: ID!){\n        obtenerContabilidad(empresa: $empresa, sucursal: $sucursal){\n                _id\n            nombre_servicio\n            empresa{\n                _id\n                nombre_empresa\n            }\n                sucursal{\n                _id\n                nombre_sucursal\n            }\n        }\n    }\n"]))),wl=Object(z.d)(fl||(fl=Object(F.a)(["\n    mutation CrearContabilidad($input: ContabilidadInput, $empresa: ID!, $sucursal: ID!, $usuario: ID!){\n        crearContabilidad(input:$input,empresa:$empresa,sucursal:$sucursal, usuario:$usuario){\n            message\n        }\n    }\n"]))),Il=Object(z.d)(gl||(gl=Object(F.a)(["\n    mutation ActualizarContabilidad($input: ContabilidadInput, $id: ID!){\n        actualzarContabilidad(input: $input, id: $id){\n            message\n        }\n    }\n"]))),kl=Object(z.d)(_l||(_l=Object(F.a)(["\n    mutation EliminarContabilidad($id: ID!){\n        eliminarContabilidad(id: $id){\n            message\n        }\n    }\n"]))),Nl=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)}}}));function Fl(e){var t,a,n=e.setData,c=e.setIdService,r=e.idService,i=e.setAccion,o=e.updateData,l=e.setAlert,d=Nl(),j=Object(s.useState)(0),u=Object(v.a)(j,2),p=u[0],m=u[1],O=Object(s.useState)(10),x=Object(v.a)(O,2),h=x[0],f=x[1],C=JSON.parse(localStorage.getItem("sesionCafi")),y=Object(s.useState)(!1),S=Object(v.a)(y,2),w=S[0],k=S[1],F=function(){return k(!w)},z=[],P=Object(He.a)(Sl,{variables:{empresa:C.empresa._id,sucursal:C.sucursal._id}}),D=P.loading,E=P.data,A=P.error,T=P.refetch,W=Object(N.a)(kl),R=Object(v.a)(W,1)[0];Object(s.useEffect)((function(){T()}),[o,T]),E&&(z=E.obtenerContabilidad);var $=function(){var e=Object(_.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R({variables:{id:r}});case 3:T(),l({message:"\xa1Listo!",status:"success",open:!0}),F(),c(""),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),l({message:e.t0.message,status:"error",open:!0});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return A?Object(V.jsx)(Je,{error:A}):D?Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsxs)("div",{className:d.root,children:[Object(V.jsxs)(Da.a,{className:d.paper,children:[Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{className:d.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Servicios"}),!1===C.accesos.catalogos.contabilidad.editar?null:Object(V.jsx)(sa.a,{padding:"default",children:"Editar"}),!1===C.accesos.catalogos.contabilidad.eliminar?null:Object(V.jsx)(sa.a,{padding:"default",children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:null===(t=z)||void 0===t||null===(a=t.slice(p*h,p*h+h))||void 0===a?void 0:a.map((function(e,t){return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:e.nombre_servicio}),!1===C.accesos.catalogos.contabilidad.editar?null:Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(X.a,{onClick:function(){i(!1),c(e._id),n({nombre_servicio:e.nombre_servicio})},children:Object(V.jsx)($a.a,{})})}),!1===C.accesos.catalogos.contabilidad.eliminar?null:Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(X.a,{onClick:function(){c(e._id),F()},children:Object(V.jsx)(ur.a,{})})})]},e._id)}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[],component:"div",count:z.length,rowsPerPage:h,page:p,onChangePage:function(e,t){m(t)},onChangeRowsPerPage:function(e){f(parseInt(e.target.value,10)),m(0)}})]}),Object(V.jsx)(zl,{handleModal:F,openModal:w,handleDelete:$})]})}var zl=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete;return Object(V.jsx)("div",{children:Object(V.jsxs)(ze.a,{open:a,onClose:t,children:[Object(V.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"Eliminar"})]})]})})},Pl=Object(k.a)({root:{width:"100%"},flexGrow:{flexGrow:1}});function Dl(){var e=Pl(),t=Object(s.useState)(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useState)({nombre_servicio:""}),i=Object(v.a)(r,2),o=i[0],l=i[1],d=Object(s.useState)({message:"",status:"",open:!1}),j=Object(v.a)(d,2),p=j[0],m=j[1],O=Object(s.useState)(!1),x=Object(v.a)(O,2),f=x[0],C=x[1],I=JSON.parse(localStorage.getItem("sesionCafi")),k=Object(s.useState)(!0),F=Object(v.a)(k,2),z=F[0],P=F[1],D=Object(s.useState)(""),E=Object(v.a)(D,2),A=E[0],T=E[1],W=Object(N.a)(wl),R=Object(v.a)(W,1)[0],$=Object(N.a)(Il),M=Object(v.a)($,1)[0],L=function(){var e=Object(_.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o.nombre_servicio){e.next=6;break}return C(!0),e.abrupt("return");case 6:if(t=o,!z){e.next=16;break}if(!1!==I.accesos.catalogos.contabilidad.agregar){e.next=12;break}return e.abrupt("return",m({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 12:return e.next=14,R({variables:{input:t,empresa:I.empresa._id,sucursal:I.sucursal._id,usuario:I._id}});case 14:e.next=24;break;case 16:if(!1!==I.accesos.catalogos.contabilidad.editar){e.next=20;break}return e.abrupt("return",m({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 20:return a=et(t),e.next=23,M({variables:{input:a,id:A}});case 23:P(!0);case 24:m({message:"\xa1Listo!",status:"success",open:!0}),l({nombre_servicio:""}),c(!n),T("");case 28:e.next=32;break;case 30:e.prev=30,e.t0=e.catch(0);case 32:case"end":return e.stop()}}),e,null,[[0,30]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{className:e.root,children:[Object(V.jsx)(B,{alert:p,setAlert:m}),Object(V.jsx)(y.a,{variant:"h6",children:"Tipo de Servicio"}),Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",mb:2,children:[Object(V.jsx)(S.a,{error:f,id:"outlined-error-helper-text",variant:"outlined",size:"small",name:"nombre_servicio",value:o.nombre_servicio,onChange:function(e){l(Object(u.a)(Object(u.a)({},o),{},Object(h.a)({},e.target.name,e.target.value)))},onKeyPress:function(e){"Enter"===e.key&&L()}}),Object(V.jsx)(b.a,{ml:1}),Object(V.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",onClick:L,disableElevation:!0,children:[Object(V.jsx)(It.a,{}),"Guardar"]})]}),Object(V.jsx)(Fl,{setData:l,idService:A,setIdService:T,setAccion:P,updateData:n,setAlert:m})]})}var El=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),Al=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Tl(){var e=El(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/contabilidad.svg",alt:"icono numero calzado",className:e.icon})}),"Contabilidad"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Al,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Contabilidad"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(b.a,{mt:4,children:Object(V.jsx)(C.a,{maxWidth:"md",children:Object(V.jsx)(Dl,{})})})]})]})}var Wl=[{id:1,label:"No. Cliente",minWidth:100},{id:2,label:"Clave",minWidth:100},{id:3,label:"Nombre",minWidth:150},{id:4,label:"Razon Social",minWidth:150},{id:5,label:"Correo",minWidth:150},{id:6,label:"Fecha registro",minWidth:100},{id:7,label:"Estado",minWidth:100}],Rl=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),$l=Object(k.a)({root:{width:"100%"},container:{height:"75vh"},avatar:{width:130,height:130}});function Ml(e){var t=e.tipo,a=e.filtro,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(s.useState)({message:"",status:"",open:!1}),r=Object(v.a)(c,2),i=r[0],o=r[1],l=$l(),d=Object(He.a)(Ii,{variables:{tipo:t,filtro:a},fetchPolicy:"network-only"}),j=d.loading,u=d.data,p=d.error,m=d.refetch;if(j)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})});if(p)return Object(V.jsx)(Je,{error:p});var O=u.obtenerClientes;return Object(V.jsxs)(Da.a,{className:l.root,children:[Object(V.jsx)(B,{alert:i,setAlert:o}),Object(V.jsx)(ra.a,{className:l.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,"aria-label":"sticky table",size:"small",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Wl.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,children:e.label},e.id)})),!1===n.accesos.catalogos.provedores.editar?null:Object(V.jsx)(sa.a,{align:"right",children:"Editar"},9),!1===n.accesos.catalogos.provedores.eliminar?null:Object(V.jsx)(sa.a,{align:"right",children:"Eliminar"},10)]})}),Object(V.jsx)(la.a,{children:O.map((function(e,t){return Object(V.jsx)(Ll,{datos:e,setAlert:o,refetch:m},t)}))})]})})]})}var Ll=function(e){var t=e.datos,a=e.setAlert,n=e.refetch,c=JSON.parse(localStorage.getItem("sesionCafi"));return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.numero_cliente})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.clave_cliente})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.nombre_cliente})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.razon_social})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.email})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:Qe(t.fecha_registro)})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.estado_cliente?"Activo":"Inactivo"})}),!1===c.accesos.catalogos.provedores.editar?null:Object(V.jsx)(sa.a,{width:50,children:Object(V.jsx)(zi,{tipo:"PRROVEEDOR",accion:"actualizar",datos:t})}),!1===c.accesos.catalogos.provedores.eliminar?null:Object(V.jsx)(sa.a,{width:50,children:Object(V.jsx)(Vl,{datos:t,setAlert:a,refetch:n})})]})},Vl=function(e){var t=e.datos,a=e.setAlert,n=e.refetch,c=Object(s.useState)(!1),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(N.a)(Ni),d=Object(v.a)(l,1)[0],j=Object(s.useState)(!1),u=Object(v.a)(j,2),b=u[0],p=u[1],m=function(){o(!1)},O=function(){var e=Object(_.a)(g.a.mark((function e(){var c,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,d({variables:{id:t._id}});case 4:(c=e.sent)&&(r=c.data.eliminarCliente.message,a({message:r,status:"success",open:!0}),n()),p(!1),m(),e.next=18;break;case 10:if(e.prev=10,e.t0=e.catch(1),console.log(e.t0),p(!1),!e.t0.message){e.next=17;break}return a({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 17:a({message:"Hubo un error",status:"error",open:!0});case 18:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{children:[Object(V.jsx)(X.a,{color:"secondary",onClick:function(){o(!0)},children:Object(V.jsx)(ur.a,{})}),Object(V.jsxs)(ze.a,{open:i,TransitionComponent:Rl,keepMounted:!0,onClose:function(){return m()},"aria-labelledby":"alert-eliminar-cliente",children:[Object(V.jsx)(wt.a,{id:"alert-eliminar-cliente",children:"\xbfEst\xe1 seguro de eliminar esto?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:function(){return m()},color:"inherit",disabled:b,children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){return O()},color:"secondary",disabled:b,startIcon:b?Object(V.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Eliminar"})]})]})]})},Ul=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},root:{display:"flex",paddingLeft:e.spacing(2)}}})),Bl=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Jl(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Ul(),a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(""),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(""),u=Object(v.a)(j,2),p=u[0],m=u[1],O=function(){r(!1)};return Object(V.jsx)("div",{children:Object(V.jsxs)(ji,{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){r(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/distribution.svg",alt:"icono numero calzado",className:t.icon})}),"Proveedores"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:c,onClose:O,TransitionComponent:Bl,children:[Object(V.jsx)(Se.a,{className:t.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:t.title,children:"Proveedores"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:O,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(b.a,{m:3,children:Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsx)(Fe.a,{item:!0,md:6,xs:8,children:Object(V.jsxs)(Da.a,{className:t.root,children:[Object(V.jsx)(us.a,{fullWidth:!0,placeholder:"Buscar proveedor...",onChange:function(e){return m(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&d(e.target.defaultValue)},value:p}),Object(V.jsx)(X.a,{onClick:function(){return d(p)},children:Object(V.jsx)(xc.a,{})})]})}),Object(V.jsx)(Fe.a,{item:!0,md:6,xs:4,style:{display:"flex",justifyContent:"flex-end"},children:!1===e.accesos.catalogos.provedores.ver?null:Object(V.jsx)(zi,{tipo:"PROVEEDOR",accion:"registrar"})})]})}),Object(V.jsx)(b.a,{mx:4,children:Object(V.jsx)(Ml,{tipo:"PROVEEDOR",filtro:l})})]})]})})}var Gl,ql,Hl,Yl,Xl,Kl,Ql,Zl,ed,td=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)}}}));function ad(e){var t=JSON.parse(localStorage.getItem("sesionCafi")),a=td(),n=Object(s.useState)(0),c=Object(v.a)(n,2),r=c[0],i=c[1],o=Object(s.useState)(8),l=Object(v.a)(o,2),d=l[0],j=l[1];return Object(V.jsx)("div",{className:a.root,children:Object(V.jsxs)(Da.a,{className:a.paper,children:[Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{className:a.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Cajas"}),!1===t.accesos.catalogos.cajas.eliminar?null:Object(V.jsx)(sa.a,{padding:"default",children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:e.obtenerCajasSucursal.slice(r*d,r*d+d).map((function(a,n){return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(V.jsxs)(sa.a,{children:[" Caja ",a.numero_caja]}),!1===t.accesos.catalogos.cajas.eliminar?null:Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(X.a,{onClick:function(){return e.deleteCaja(a._id)},children:Object(V.jsx)(ur.a,{})})})]},a.numero_caja)}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[],component:"div",count:e.obtenerCajasSucursal.length,rowsPerPage:d,page:r,onChangePage:function(e,t){i(t)},onChangeRowsPerPage:function(e){j(parseInt(e.target.value,10)),i(0)}})]})})}var nd=Object(z.d)(Gl||(Gl=Object(F.a)(["\n    mutation CrearCaja($input: CrearCajasInput!, $empresa: ID!, $sucursal: ID!){\n        crearCaja(input: $input, empresa: $empresa, sucursal: $sucursal){\n            message\n        }\n    }\n"]))),cd=Object(z.d)(ql||(ql=Object(F.a)(["\n    query ObtenerCajasSucursales($empresa: ID!, $sucursal: ID!){\n        obtenerCajasSucursal(empresa: $empresa, sucursal: $sucursal){\n            _id\n            numero_caja\n            activa\n            usuario_creador {\n            numero_usuario\n            nombre\n            email\n            }\n            cantidad_efectivo_actual\n            usuario_en_caja {\n            _id\n            numero_usuario\n            nombre\n            email\n            }\n             \n        }\n    }\n"]))),rd=Object(z.d)(Hl||(Hl=Object(F.a)(["\n    mutation CrearHistorialCaja($input: CrearHistorialCajasInput!, $empresa: ID!, $sucursal: ID!){\n        crearHistorialCaja(input: $input, empresa: $empresa, sucursal: $sucursal){\n            message\n        }\n    }\n"]))),id=Object(z.d)(Yl||(Yl=Object(F.a)(["\n    query ObtenerHistorialCaja($input: HistorialCajasInput, $id_Caja: ID!,$empresa: ID!, $sucursal: ID!){\n        obtenerHistorialCaja(input: $input, id_Caja: $id_Caja,empresa: $empresa, sucursal: $sucursal){\n            tipo_movimiento\n            concepto\n            horario_turno\n            numero_caja\n            numero_usuario_creador\n            nombre_usuario_creador\n            hora_moviento{\n                hora\n                minutos\n                segundos\n                completa\n            }\n            fecha_movimiento{\n                year\n                mes\n                dia\n                no_dia_year\n                no_semana_year\n                completa\n            }\n            montos_en_caja{\n                monto_efectivo{\n                    monto \n                }\n                monto_tarjeta_credito{\n                    monto \n                }\n                monto_tarjeta_debito{\n                    monto \n                }\n                monto_creditos{\n                    monto \n                }\n                monto_monedero{\n                    monto \n                }\n                monto_transferencia{\n                    monto \n                }\n                monto_cheques{\n                    monto \n                }\n                monto_vales_despensa{\n                    monto \n                }\n            }\n        }\n    }\n"]))),od=Object(z.d)(Xl||(Xl=Object(F.a)(["\n\tmutation eliminarCaja($id: ID!) {\n\t\teliminarCaja(id: $id) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),sd=(Object(z.d)(Kl||(Kl=Object(F.a)(["\n\tmutation ActualizarCaja($input: EditarCaja, $id: ID!) {\n\t\tactualizarCaja(id: $id, input: $input) {\n            _id\n            numero_caja\n            activa\n        }\n    }\n"]))),Object(z.d)(Ql||(Ql=Object(F.a)(["\n    query ObtenerPreCorteCaja($empresa: ID!, $sucursal: ID!, $input: PreCortesDeCajaInput){\n        obtenerPreCorteCaja(empresa: $empresa, sucursal: $sucursal, input: $input){\n            monto_efectivo_precorte         \n        }\n    }\n"])))),ld=Object(z.d)(Zl||(Zl=Object(F.a)(["\n    query ObtenerCortesDeCaja($empresa: ID!, $sucursal: ID!, $input: FiltroCorteDeCajaInput){\n        obtenerCortesDeCaja(empresa: $empresa, sucursal: $sucursal, input: $input){\n            concepto\n            token_turno_user\n            numero_caja\n            horario_en_turno\n            id_caja\n            hora_salida{\n                completa\n            }\n            fecha_salida{\n                completa\n            }\n            fecha_movimiento\n            usuario_en_turno{\n                nombre\n                telefono\n                email\n                numero_usuario\n            }\n            montos_en_caja{\n                monto_efectivo{\n                    monto \n                }\n                monto_tarjeta_credito{\n                    monto \n                }\n                monto_tarjeta_debito{\n                    monto \n                }\n                monto_creditos{\n                    monto \n                }\n                monto_monedero{\n                    monto \n                }\n                monto_transferencia{\n                    monto \n                }\n                monto_cheques{\n                    monto \n                }\n                monto_vales_despensa{\n                    monto \n                }\n            }\n            sucursal{\n                nombre_sucursal\n            }\n        }\n    }\n"]))),dd=Object(z.d)(ed||(ed=Object(F.a)(["\n    query ObtenerCorteCaja($empresa: ID!, $sucursal: ID!, $input: CorteDeCajaInput){\n        obtenerCorteCaja(empresa: $empresa, sucursal: $sucursal, input: $input){\n            montos_en_sistema{\n                monto_efectivo\n                monto_tarjeta_debito\n                monto_tarjeta_credito\n                monto_creditos\n                monto_monedero\n                monto_transferencia\n                monto_cheques\n                monto_vales_despensa\n            }\n        }\n    }\n"])));function jd(){var e=l.a.useState(!1),t=Object(v.a)(e,2),a=t[0],n=t[1],c=Object(s.useState)({message:"",status:"",open:!1}),r=Object(v.a)(c,2),i=r[0],o=r[1],d=JSON.parse(localStorage.getItem("sesionCafi")),j=[],u=Object(N.a)(nd),p=Object(v.a)(u,1)[0],m=Object(N.a)(od),O=Object(v.a)(m,1)[0],x=Object(He.a)(cd,{variables:{empresa:d.empresa._id,sucursal:d.sucursal._id}}),h=x.data,f=x.refetch,C=function(){var e=Object(_.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n(!0),e.next=4,p({variables:{input:{usuario_creador:d._id,numero_usuario_creador:d.numero_usuario,nombre_usuario_creador:d.nombre},empresa:d.empresa._id,sucursal:d.sucursal._id}});case 4:f(),o({message:"\xa1Listo!",status:"success",open:!0}),n(!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),o({message:"Hubo un error",status:"error",open:!0}),n(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(_.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n(!0),e.next=4,O({variables:{id:t}});case 4:f(),o({message:"\xa1Listo!",status:"success",open:!0}),n(!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),o({message:"Hubo un error",status:"error",open:!0}),n(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return h&&(j=h.obtenerCajasSucursal),Object(s.useEffect)((function(){n(!0),f(),n(!1)}),[f]),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(B,{alert:i,setAlert:o}),Object(V.jsx)(Ve,{loading:a,setLoading:n}),Object(V.jsxs)(b.a,{display:"flex",justifyContent:"left",alignItems:"left",my:2,children:[Object(V.jsx)(b.a,{ml:1}),!1===d.accesos.catalogos.cajas.agregar?null:Object(V.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:function(){return C()},children:[Object(V.jsx)(It.a,{}),"Agregar"]})]}),Object(V.jsx)(ad,{obtenerCajasSucursal:j,deleteCaja:y})]})}var ud=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),bd=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function pd(){var e=ud(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/cajas.svg",alt:"icono numero calzado",className:e.icon})}),"Cajas"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:bd,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Cajas"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(b.a,{mt:3,children:Object(V.jsx)(C.a,{maxWidth:"sm",children:Object(V.jsx)(jd,{})})})]})]})}var md={mi_empresa:{datos_empresa:{ver:!1,agregar:!1,editar:!1,eliminar:!1},informacion_fiscal:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},compras:{abrir_compra:{ver:!1,agregar:!1,editar:!1,eliminar:!1},compras_realizadas:{ver:!1,agregar:!1,editar:!1,eliminar:!1},compras_espera:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},tesoreria:{cuentas_empresa:{ver:!1,agregar:!1,editar:!1,eliminar:!1},egresos:{ver:!1,agregar:!1,editar:!1,eliminar:!1},abonos_proveedores:{ver:!1,agregar:!1,editar:!1,eliminar:!1},abonos_clientes:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},reportes:{reporte_historial_cajas:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_turnos:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_compras:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_ventas:{ver:!1,agregar:!1,editar:!1,eliminar:!1},rerporte_almacen:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_corte_caja:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_tesoreria:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},ventas:{cancelar_venta:{ver:!1,agregar:!1,editar:!1,eliminar:!1},precios_productos:{ver:!1,agregar:!1,editar:!1,eliminar:!1},pre_corte:{ver:!1,agregar:!1,editar:!1,eliminar:!1},cotizaciones:{ver:!1,agregar:!1,editar:!1,eliminar:!1},administrador:{ver:!1,agregar:!1,editar:!1,eliminar:!1},eliminar_ventas:{ver:!1,agregar:!1,editar:!1,eliminar:!1},producto_rapido:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},almacenes:{almacen:{ver:!1,agregar:!1,editar:!1,eliminar:!1},traspasos:{ver:!1,agregar:!1,editar:!1,eliminar:!1},inventario_almacen:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},catalogos:{clientes:{ver:!1,agregar:!1,eliminar:!1,editar:!1},usuarios:{ver:!1,agregar:!1,eliminar:!1,editar:!1},marcas:{ver:!1,agregar:!1,eliminar:!1,editar:!1},contabilidad:{ver:!1,agregar:!1,eliminar:!1,editar:!1},provedores:{ver:!1,agregar:!1,eliminar:!1,editar:!1},cajas:{ver:!1,agregar:!1,eliminar:!1,editar:!1},departamentos:{ver:!1,agregar:!1,eliminar:!1,editar:!1},centro_costos:{ver:!1,agregar:!1,eliminar:!1,editar:!1},conceptos_almacen:{ver:!1,agregar:!1,eliminar:!1,editar:!1},categorias:{ver:!1,agregar:!1,eliminar:!1,editar:!1},colores:{ver:!1,agregar:!1,eliminar:!1,editar:!1},tallas_numeros:{ver:!1,agregar:!1,eliminar:!1,editar:!1}}},Od=Object(s.createContext)(),xd=function(e){var t=e.children,a=Object(s.useState)({direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},estado_usuario:!0,accesos:md}),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)({error:!1,message:""}),u=Object(v.a)(j,2),b=u[0],p=u[1],m=Object(s.useState)(!1),O=Object(v.a)(m,2),x=O[0],h=O[1];return Object(V.jsx)(Od.Provider,{value:{usuario:c,setUsuario:r,toUpdate:l,setToUpdate:d,error:b,setError:p,update:x,setUpdate:h},children:t})},hd=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& span":{color:"red"}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:150,height:150,border:"dashed 2px black",borderRadius:"100%"},avatar:{width:130,height:130,"& > .icon":{fontSize:100}}}}));function fd(e){var t=e.accion,a=hd(),n=Object(s.useContext)(Od),c=n.usuario,r=n.setUsuario,i=n.error,o=Object(s.useState)(""),l=Object(v.a)(o,2),d=l[0],j=l[1],p=Object(s.useState)(!1),m=Object(v.a)(p,2),O=m[0],x=m[1],f=Object(s.useCallback)((function(e){var t=new FileReader;t.readAsDataURL(e[0]),t.onload=function(){var e=t.result;j(e)},r(Object(u.a)(Object(u.a)({},c),{},{imagen:e[0]}))}),[c,r]),g=Object(Ht.a)({accept:"image/jpeg, image/png",noKeyboard:!0,onDrop:f}),_=g.getRootProps,C=g.getInputProps,w=function(e){"numero_usuario"!==e.target.name?r(Object(u.a)(Object(u.a)({},c),{},Object(h.a)({},e.target.name,e.target.value))):r(Object(u.a)(Object(u.a)({},c),{},Object(h.a)({},e.target.name,parseInt(e.target.value))))},I=function(e){r(Object(u.a)(Object(u.a)({},c),{},{direccion:Object(u.a)(Object(u.a)({},c.direccion),{},Object(h.a)({},e.target.name,e.target.value))}))};return Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,md:3,children:Object(V.jsxs)(b.a,Object(u.a)(Object(u.a)({className:a.avatarContainer},_()),{},{children:[Object(V.jsx)("input",Object(u.a)({},C())),d?Object(V.jsx)(qt.a,{className:a.avatar,src:"".concat(d)}):Object(V.jsx)(qt.a,{className:a.avatar,src:"".concat(c.imagen)})]}))}),Object(V.jsxs)(Fe.a,{item:!0,md:9,children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("form",{autoComplete:"off",className:a.formInputFlex,children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{children:"* "}),"Nombre usuario"]}),Object(V.jsx)(S.a,{fullWidth:!0,type:"text",size:"small",error:i.error&&!c.nombre,name:"nombre",variant:"outlined",value:c.nombre?c.nombre:"",helperText:i.error&&"Las contrase\xf1as no coinciden"!==i.message?i.message:"",onChange:w})]})})}),"registrar"===t?Object(V.jsxs)("form",{autoComplete:"off",className:a.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{children:"* "}),"Contrase\xf1a"]}),Object(V.jsxs)(G.a,{fullWidth:!0,size:"small",error:!(!i.error||c.password)||!(!i.error||"Las contrase\xf1as no coinciden"!==i.message),name:"password",variant:"outlined",children:[Object(V.jsx)(H.a,{name:"password",type:O?"text":"password",value:c.password?c.password:"",onChange:w,endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(X.a,{size:"small","aria-label":"toggle password visibility",onClick:function(){return x(!O)},onMouseDown:function(){return x(!O)},children:O?Object(V.jsx)(Q.a,{color:"primary"}):Object(V.jsx)(ee.a,{color:"primary"})})})}),Object(V.jsx)(ca.a,{children:i.message})]})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{children:"* "}),"Repetir contrase\xf1a"]}),Object(V.jsxs)(G.a,{fullWidth:!0,size:"small",error:!(!i.error||c.password)||!(!i.error||"Las contrase\xf1as no coinciden"!==i.message),name:"repeatPassword",variant:"outlined",children:[Object(V.jsx)(H.a,{name:"repeatPassword",type:O?"text":"password",value:c.repeatPassword?c.repeatPassword:"",onChange:w,endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(X.a,{size:"small","aria-label":"toggle password visibility",onClick:function(){return x(!O)},onMouseDown:function(){return x(!O)},children:O?Object(V.jsx)(Q.a,{color:"primary"}):Object(V.jsx)(ee.a,{color:"primary"})})})}),Object(V.jsx)(ca.a,{children:i.message})]})]})]}):Object(V.jsx)(gd,{})]}),Object(V.jsxs)(Fe.a,{item:!0,md:12,children:[Object(V.jsxs)("form",{autoComplete:"off",className:a.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{children:"* "}),"Email"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:i.error&&!c.email,name:"email",variant:"outlined",value:c.email?c.email:"",helperText:i.error&&"Las contrase\xf1as no coinciden"!==i.message?i.message:"",onChange:w})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{children:"* "}),"Num. Telefono"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:i.error&&!c.telefono,name:"telefono",variant:"outlined",value:c.telefono?c.telefono:"",helperText:i.error&&"Las contrase\xf1as no coinciden"!==i.message?i.message:"",onChange:w})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Num. Celular"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"celular",variant:"outlined",value:c.celular?c.celular:"",onChange:w})]})]}),Object(V.jsxs)(b.a,{mt:2,children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"usuario domicilio"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)("form",{autoComplete:"off",className:a.formInputFlex,children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Calle"}),Object(V.jsx)(S.a,{size:"small",name:"calle",variant:"outlined",value:c.direccion.calle?c.direccion.calle:"",onChange:I})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Colonia"}),Object(V.jsx)(S.a,{size:"small",name:"colonia",variant:"outlined",value:c.direccion.colonia?c.direccion.colonia:"",onChange:I})]}),Object(V.jsxs)(b.a,{width:"100px",children:[Object(V.jsx)(y.a,{children:"Num. Ext"}),Object(V.jsx)(S.a,{size:"small",name:"no_ext",variant:"outlined",value:c.direccion.no_ext?c.direccion.no_ext:"",onChange:I})]}),Object(V.jsxs)(b.a,{width:"100px",children:[Object(V.jsx)(y.a,{children:"Num. Int"}),Object(V.jsx)(S.a,{size:"small",name:"no_int",variant:"outlined",value:c.direccion.no_int?c.direccion.no_int:"",onChange:I})]}),Object(V.jsxs)(b.a,{width:"100px",children:[Object(V.jsx)(y.a,{children:"CP"}),Object(V.jsx)(S.a,{size:"small",name:"codigo_postal",variant:"outlined",value:c.direccion.codigo_postal?c.direccion.codigo_postal:"",onChange:I})]})]}),Object(V.jsxs)("form",{autoComplete:"off",className:a.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Municipio"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"municipio",variant:"outlined",value:c.direccion.municipio?c.direccion.municipio:"",onChange:I})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Localidad"}),Object(V.jsx)(S.a,{size:"small",name:"localidad",variant:"outlined",value:c.direccion.localidad?c.direccion.localidad:"",onChange:I})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Estado"}),Object(V.jsx)(S.a,{size:"small",name:"estado",variant:"outlined",value:c.direccion.estado?c.direccion.estado:"",onChange:I})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Pais"}),Object(V.jsx)(S.a,{size:"small",name:"pais",variant:"outlined",value:c.direccion.pais?c.direccion.pais:"",onChange:I})]})]})]})]})})}var gd=function(){var e=Object(s.useState)(!1),t=Object(v.a)(e,2),a=t[0],n=t[1],c=Object(s.useContext)(Od),r=c.usuario,i=c.setUsuario,o=c.error,l=c.setError,d=c.update,j=c.setUpdate,p=Object(s.useState)(!1),m=Object(v.a)(p,2),O=m[0],x=m[1],f=Object(s.useState)(!1),C=Object(v.a)(f,2),S=C[0],k=C[1],F=Object(s.useState)({message:"",status:"",open:!1}),z=Object(v.a)(F,2),P=z[0],D=z[1],A=Object(N.a)(E),T=Object(v.a)(A,1)[0],W=function(){n(!1),l({error:!1,message:""})},R=function(e){i(Object(u.a)(Object(u.a)({},r),{},Object(h.a)({},e.target.name,e.target.value)))},$=function(){var e=Object(_.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.password&&r.repeatPassword){e.next=3;break}return l({error:!0,message:"Este campo es requerido"}),e.abrupt("return");case 3:if(r.password===r.repeatPassword){e.next=6;break}return l({error:!0,message:"Las contrase\xf1as no coinciden"}),e.abrupt("return");case 6:return k(!0),e.prev=7,e.next=10,T({variables:{input:{password:r.password,repeatPassword:r.repeatPassword},id:r._id}});case 10:j(!d),D({message:"\xa1Listo!",status:"success",open:!0}),k(!1),W(),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(7),D({message:"Hubo un error",status:"error",open:!0}),k(!1);case 20:case"end":return e.stop()}}),e,null,[[7,16]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(w.a,{color:"primary",variant:"text",onClick:function(){n(!0)},children:"Cambiar contrase\xf1a"}),Object(V.jsxs)(ze.a,{open:a,onClose:W,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(V.jsx)(B,{alert:P,setAlert:D}),Object(V.jsx)(wt.a,{id:"alert-dialog-title",children:"Cambiar contrase\xf1a"}),Object(V.jsx)(Pe.a,{children:Object(V.jsxs)("form",{autoComplete:"off",children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{children:"* "}),"Contrase\xf1a"]}),Object(V.jsxs)(G.a,{fullWidth:!0,size:"small",error:!(!o.error||r.password)||!(!o.error||"Las contrase\xf1as no coinciden"!==o.message),name:"password",variant:"outlined",children:[Object(V.jsx)(H.a,{name:"password",type:O?"text":"password",value:r.password?r.password:"",onChange:R,endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(X.a,{size:"small","aria-label":"toggle password visibility",onClick:function(){return x(!O)},onMouseDown:function(){return x(!O)},children:O?Object(V.jsx)(Q.a,{color:"primary"}):Object(V.jsx)(ee.a,{color:"primary"})})})}),Object(V.jsx)(ca.a,{children:o.message})]})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{children:"* "}),"Repetir contrase\xf1a"]}),Object(V.jsxs)(G.a,{fullWidth:!0,size:"small",error:!(!o.error||r.password)||!(!o.error||"Las contrase\xf1as no coinciden"!==o.message),name:"repeatPassword",variant:"outlined",children:[Object(V.jsx)(H.a,{name:"repeatPassword",type:O?"text":"password",value:r.repeatPassword?r.repeatPassword:"",onChange:R,endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(X.a,{size:"small","aria-label":"toggle password visibility",onClick:function(){return x(!O)},onMouseDown:function(){return x(!O)},children:O?Object(V.jsx)(Q.a,{color:"primary"}):Object(V.jsx)(ee.a,{color:"primary"})})})}),Object(V.jsx)(ca.a,{children:o.message})]})]})]})}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:W,color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:$,color:"primary",variant:"contained",autoFocus:!0,endIcon:S?Object(V.jsx)(I.a,{color:"inherit",size:25}):null,children:"Confirmar"})]})]})]})};function _d(e){var t=e.arregloAccesos,a=e.obtenerAccesos,n=e.departamento,c=e.subDepartamento;return console.log(t),Object(V.jsxs)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:[Object(V.jsx)(aa.a,{control:Object(V.jsx)(na.a,{checked:!!t&&t[n][c].ver,name:"ver",color:"primary",onChange:function(e){return a(e,n,c)}}),label:Object(V.jsx)(b.a,{mr:2,display:"flex",children:"ventas"===n?"Autorizar":"Ver"})}),"informacion_fiscal"===c||"datos_empresa"===c||"abrir_compra"===c||"compras_realizadas"===c||"compras_espera"===c||"traspasos"===c||"inventario_almacen"===c||"cuentas_empresa"===c||"reportes"===n||"ventas"===n||"egresos"===c?null:Object(V.jsx)(aa.a,{control:Object(V.jsx)(na.a,{checked:!!t&&t[n][c].agregar,name:"agregar",disabled:!t||!1===t[n][c].ver,color:"primary",onChange:function(e){return a(e,n,c)}}),label:Object(V.jsx)(b.a,{mr:2,display:"flex",children:"Agregar"})}),"cajas"===c||"abrir_compra"===c||"compras_realizadas"===c||"traspasos"===c||"inventario_almacen"===c||"abonos_proveedores"===c||"abonos_clientes"===c||"egresos"===c||"reportes"===n||"ventas"===n?null:Object(V.jsx)(aa.a,{control:Object(V.jsx)(na.a,{checked:!!t&&t[n][c].editar,name:"editar",disabled:!t||!1===t[n][c].ver,color:"primary",onChange:function(e){return a(e,n,c)}}),label:Object(V.jsx)(b.a,{mr:2,display:"flex",children:"Editar"})}),"informacion_fiscal"===c||"datos_empresa"===c||"abrir_compra"===c||"compras_realizadas"===c||"traspasos"===c||"inventario_almacen"===c||"cuentas_empresa"===c||"abonos_proveedores"===c||"abonos_clientes"===c||"egresos"===c||"reportes"===n||"ventas"===n?null:Object(V.jsx)(aa.a,{control:Object(V.jsx)(na.a,{checked:!!t&&t[n][c].eliminar,name:"eliminar",color:"primary",disabled:!t||!1===t[n][c].ver,onChange:function(e){return a(e,n,c)}}),label:Object(V.jsx)(b.a,{display:"flex",children:"Eliminar"})})]})}function vd(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(y.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Clientes"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"clientes"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Usuarios"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"usuarios"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Marcas"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"marcas"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Provedores"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"provedores"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Contabilidad"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"contabilidad"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Cajas"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"cajas"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Departamento"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"departamentos"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Centro de costos"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"centro_costos"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Conceptos almacen"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"conceptos_almacen"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Categorias"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"categorias"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Colores"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"colores"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Tallas y Numeros"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"tallas_numeros"})]})})})})]})}function Cd(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(y.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Datos de Empresa"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"mi_empresa",subDepartamento:"datos_empresa"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Informaci\xf3n Fiscal"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"mi_empresa",subDepartamento:"informacion_fiscal"})]})})})})]})}function yd(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(y.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Abrir una compra"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"compras",subDepartamento:"abrir_compra"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Compras realizadas"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"compras",subDepartamento:"compras_realizadas"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Compras en espera"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"compras",subDepartamento:"compras_espera"})]})})})})]})}function Sd(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(y.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Almacenes"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"almacenes",subDepartamento:"almacen"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Traspasos"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"almacenes",subDepartamento:"traspasos"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Inventario por almacen"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"almacenes",subDepartamento:"inventario_almacen"})]})})})})]})}function wd(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(y.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Cuentas"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"tesoreria",subDepartamento:"cuentas_empresa"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Abonos Proveedores"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"tesoreria",subDepartamento:"abonos_proveedores"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Abonos Clientes"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"tesoreria",subDepartamento:"abonos_clientes"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Egresos"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"tesoreria",subDepartamento:"egresos"})]})})})})]})}function Id(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(y.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Reportes Historiales Cajas"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_historial_cajas"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Reportes turnos usuarios "})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_turnos"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Reportes de compras "})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_compras"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Reportes de ventas "})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_ventas"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Reportes de almacenes "})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"rerporte_almacen"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Reportes de cortes "})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_corte_caja"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Reportes tesoreria "})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_tesoreria"})]})})})})]})}function kd(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(y.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Cancelar ventas"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"cancelar_venta"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Precios de productos"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"precios_productos"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Pre cortes de caja"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"pre_corte"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Cotizaciones"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"cotizaciones"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Producto Rapido"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"producto_rapido"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Panel de administrador"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"administrador"})]})})})}),Object(V.jsx)(b.a,{p:1,display:"flex",justifyContent:"center",children:Object(V.jsx)(b.a,{width:"80%",children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{ml:1,p:1,flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Eliminar ventas pendientes"})})}),Object(V.jsx)(_d,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"eliminar_ventas"})]})})})})]})}var Nd=["children","value","index"];function Fd(e){var t=e.children,a=e.value,n=e.index,c=Object(fe.a)(e,Nd);return Object(V.jsx)("div",Object(u.a)(Object(u.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(V.jsx)(b.a,{p:1,minHeight:"20vh",children:t})}))}function zd(e){return{id:"reg-product-tab-".concat(e),"aria-controls":"tabpanel-reg-product-".concat(e)}}var Pd=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper},iconSvg:{width:30},icon:{fontSize:30}}}));function Dd(e){var t=e.obtenerAccesos,a=e.arregloAccesos,n=Pd(),c=Object(s.useState)({message:"",status:"",open:!1}),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)(0),d=Object(v.a)(l,2),j=d[0],p=d[1];return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(B,{alert:i,setAlert:o}),Object(V.jsx)(Se.a,{position:"static",color:"default",elevation:0,children:Object(V.jsxs)(we.a,{value:j,onChange:function(e,t){p(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:[Object(V.jsx)(Ie.a,Object(u.a)({label:"Mi empresa",icon:Object(V.jsx)(Ce.r,{className:n.icon})},zd(0))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Almacenes",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/almacen.svg",alt:"icono almacen",className:n.iconSvg})},zd(1))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Compras",icon:Object(V.jsx)(Ce.m,{className:n.icon})},zd(2))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Catalogos",icon:Object(V.jsx)(Ce.j,{className:n.icon})},zd(3))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Tesoreria",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/money.svg",alt:"icono money",className:n.iconSvg})},zd(4))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Reportes",icon:Object(V.jsx)(Ce.s,{className:n.icon})},zd(5))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Facturaci\xf3n",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/factura.svg",alt:"icono factura",className:n.iconSvg})},zd(6))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Ventas",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cart-add.svg",alt:"icono ventas",className:n.iconSvg})},zd(7)))]})}),Object(V.jsx)(Fd,{value:j,index:0,children:Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(Cd,{obtenerAccesos:t,arregloAccesos:a})})}),Object(V.jsx)(Fd,{value:j,index:1,children:Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(Sd,{obtenerAccesos:t,arregloAccesos:a})})}),Object(V.jsx)(Fd,{value:j,index:2,children:Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(yd,{obtenerAccesos:t,arregloAccesos:a})})}),Object(V.jsx)(Fd,{value:j,index:3,children:Object(V.jsx)(b.a,{p:0,children:Object(V.jsx)(vd,{obtenerAccesos:t,arregloAccesos:a})})}),Object(V.jsx)(Fd,{value:j,index:4,children:Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(wd,{obtenerAccesos:t,arregloAccesos:a})})}),Object(V.jsx)(Fd,{value:j,index:5,children:Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(Id,{obtenerAccesos:t,arregloAccesos:a})})}),Object(V.jsx)(Fd,{value:j,index:6,children:Object(V.jsx)(b.a,{p:2})}),Object(V.jsx)(Fd,{value:j,index:7,children:Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(kd,{obtenerAccesos:t,arregloAccesos:a})})})]})}var Ed=["children","value","index"],Ad=["numero_usuario","_id","sucursal","empresa","turno_en_caja_activo","estado_usuario"];function Td(e){var t=e.children,a=e.value,n=e.index,c=Object(fe.a)(e,Ed);return Object(V.jsx)("div",Object(u.a)(Object(u.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(V.jsx)(b.a,{minHeight:"70vh",children:t})}))}function Wd(e){return{id:"reg-product-tab-".concat(e),"aria-controls":"tabpanel-reg-product-".concat(e)}}var Rd=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},rootPrincipal:{padding:0,margin:0},root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper},iconSvg:{width:50}}}));function $d(e){var t=e.accion,a=e.datos,n=Rd(),c=Object(s.useContext)(Od),r=c.usuario,i=c.setUsuario,o=c.setError,l=c.update,d=c.setUpdate,j=Object(s.useState)(!1),p=Object(v.a)(j,2),m=p[0],O=p[1],x=Object(s.useState)(0),f=Object(v.a)(x,2),C=f[0],y=f[1],S=Object(s.useState)(!1),I=Object(v.a)(S,2),k=I[0],F=I[1],z=Object(s.useState)({message:"",status:"",open:!1}),D=Object(v.a)(z,2),A=D[0],T=D[1],W=JSON.parse(localStorage.getItem("sesionCafi")),R=Object(s.useCallback)((function(){i({direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},turno_en_caja_activo:!1,estado_usuario:!0,accesos:md})}),[i]),$=function(){O(!0),"registrar"!==t&&i(a)},M=function(){O(!1),R()},L=Object(N.a)(P),U=Object(v.a)(L,1)[0],J=Object(N.a)(E),G=Object(v.a)(J,1)[0],q=function(){var e=Object(_.a)(g.a.mark((function e(){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("registrar"!==t){e.next=9;break}if(r.nombre&&r.password&&r.repeatPassword&&r.telefono&&r.email){e.next=4;break}return o({error:!0,message:"Este campo es requerido"}),e.abrupt("return");case 4:if(r.password===r.repeatPassword){e.next=7;break}return o({error:!0,message:"Las contrase\xf1as no coinciden"}),e.abrupt("return");case 7:e.next=12;break;case 9:if(r.nombre&&r.telefono&&r.email){e.next=12;break}return o({error:!0,message:"Este campo es requerido"}),e.abrupt("return");case 12:if(F(!0),e.prev=13,"registrar"!==t){e.next=24;break}return r.numero_usuario=(c=1e8,i=999999999,Math.floor(Math.random()*(i-c+1)+c)),r.empresa=W.empresa._id,r.sucursal=W.sucursal._id,r.turno_en_caja_activo=!1,a=r,e.next=22,U({variables:{input:a}});case 22:e.next=27;break;case 24:return r.numero_usuario,r._id,r.sucursal,r.empresa,r.turno_en_caja_activo,r.estado_usuario,n=Object(fe.a)(r,Ad),e.next=27,G({variables:{input:n,id:r._id}});case 27:d(!l),T({message:"\xa1Listo!",status:"success",open:!0}),o({error:!1,message:""}),F(!1),M(),e.next=38;break;case 34:e.prev=34,e.t0=e.catch(13),T({message:"Hubo un error en el servidor",status:"error",open:!0}),F(!1);case 38:case"end":return e.stop()}var c,i}),e,null,[[13,34]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(B,{alert:A,setAlert:T}),"registrar"===t?Object(V.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",onClick:$,children:[Object(V.jsx)(It.a,{})," Nuevo Usuario"]}):Object(V.jsx)(X.a,{onClick:$,children:Object(V.jsx)($a.a,{})}),Object(V.jsxs)(ze.a,{open:m,onClose:M,fullWidth:!0,maxWidth:"md",children:[Object(V.jsxs)(b.a,{className:n.root,children:[Object(V.jsx)(Ve,{loading:k,setLoading:F}),Object(V.jsx)(Se.a,{position:"static",color:"default",elevation:0,children:Object(V.jsxs)(we.a,{value:C,onChange:function(e,t){y(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:[Object(V.jsx)(Ie.a,Object(u.a)({label:"Informaci\xf3n b\xe1sica",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/perfil.svg",alt:"icono perfil",className:n.iconSvg})},Wd(0))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Permisos",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/permisos.svg",alt:"icono factura",className:n.iconSvg})},Wd(1))),Object(V.jsx)(b.a,{ml:58,mt:3,children:Object(V.jsx)(b.a,{children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:M,size:"large",children:Object(V.jsx)($e.a,{})})})})]})}),Object(V.jsx)(Td,{value:C,index:0,children:Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(fd,{accion:t})})}),Object(V.jsx)(Td,{value:C,index:1,children:Object(V.jsx)(Dd,{arregloAccesos:r.accesos,obtenerAccesos:function(e,t,a){var n=e.target,c=n.name,o=n.checked;i(Object(u.a)(Object(u.a)({},r),{},{accesos:Object(u.a)(Object(u.a)({},r.accesos),{},Object(h.a)({},t,Object(u.a)(Object(u.a)({},r.accesos[t]),{},Object(h.a)({},a,Object(u.a)(Object(u.a)({},r.accesos[t][a]),{},Object(h.a)({},c,o))))))}))}})})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{variant:"contained",color:"primary",onClick:q,size:"large",startIcon:Object(V.jsx)(za.a,{}),children:"Guardar"})})]})]})}var Md=a(904),Ld=[{id:1,label:"No. Usuario",minWidth:100},{id:3,label:"Nombre",minWidth:150},{id:5,label:"Correo",minWidth:150},{id:7,label:"Estado",minWidth:100},{id:8,label:"Detalles",minWidth:50,align:"right"}],Vd=Object(k.a)({root:{width:"100%"},container:{maxHeight:"70vh"},avatar:{width:130,height:130}});function Ud(e){var t=e.sucursal,a=e.filtro,n=Vd(),c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(s.useContext)(Od).update,i=Object(s.useState)(0),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(10),u=Object(v.a)(j,2),p=u[0],m=u[1],O=Object(He.a)(D,{variables:{sucursal:t,filtro:a}}),x=O.loading,h=O.data,f=O.error,g=O.refetch;Object(s.useEffect)((function(){g()}),[r,g]);if(x)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})});if(f)return Object(V.jsx)(Je,{error:f});var _=h.obtenerUsuarios;return Object(V.jsxs)(Da.a,{className:n.root,children:[Object(V.jsx)(ra.a,{className:n.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,"aria-label":"sticky table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Ld.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,children:e.label},e.id)})),!1===c.accesos.catalogos.usuarios.editar?null:Object(V.jsx)(sa.a,{align:"right",children:"Editar"},9),!1===c.accesos.catalogos.usuarios.eliminar?null:Object(V.jsx)(sa.a,{align:"right",children:"Eliminar"},10)]})}),Object(V.jsx)(la.a,{children:_.slice(l*p,l*p+p).map((function(e,t){return Object(V.jsx)(Bd,{datos:e},t)}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[],component:"div",count:_.length,rowsPerPage:p,page:l,onChangePage:function(e,t){d(t)},onChangeRowsPerPage:function(e){m(+e.target.value),d(0)}})]})}var Bd=function(e){var t=e.datos,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(s.useState)(!1),c=Object(v.a)(n,2),r=c[0],i=c[1],o=Object(s.useContext)(Od),l=o.update,d=o.setUpdate,j=Object(s.useState)(!1),u=Object(v.a)(j,2),b=u[0],p=u[1],m=Object(N.a)(E),O=Object(v.a)(m,1)[0],x=function(){var e=Object(_.a)(g.a.mark((function e(a){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,O({variables:{input:{estado_usuario:a.target.checked},id:t._id}});case 4:d(!l),p(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),p(!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.numero_usuario})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.nombre})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.email})}),Object(V.jsx)(sa.a,{children:b?Object(V.jsx)(I.a,{size:30}):Object(V.jsx)(bs.a,{checked:t.estado_usuario,onChange:x,color:"primary"})}),Object(V.jsx)(sa.a,{width:50,children:Object(V.jsx)(Jd,{openDetalles:r,handleDetalles:function(){return i(!r)},datos:t})}),!1===a.accesos.catalogos.usuarios.editar?null:Object(V.jsx)(sa.a,{width:50,children:Object(V.jsx)($d,{accion:"actualizar",datos:t})}),!1===a.accesos.catalogos.usuarios.eliminar?null:Object(V.jsx)(sa.a,{width:50,children:Object(V.jsx)(X.a,{color:"secondary",children:Object(V.jsx)(ur.a,{})})})]})},Jd=function(e){var t=e.handleDetalles,a=e.openDetalles,n=e.datos,c=Vd();return Object(V.jsxs)("div",{children:[Object(V.jsx)(X.a,{onClick:t,children:Object(V.jsx)(Md.a,{})}),Object(V.jsxs)(ze.a,{open:a,onClose:t,fullWidth:!0,maxWidth:"md",children:[Object(V.jsx)(wt.a,{children:"Informaci\xf3n completa del cliente"}),Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(b.a,{mt:3,children:[Object(V.jsx)(y.a,{variant:"h6",children:"Informaci\xf3n b\xe1sica"}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{mt:3,height:120,width:120,display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(qt.a,{className:c.avatar,src:n.imagen})}),Object(V.jsxs)("ul",{children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"N\xfamero de usuario: "}),n.numero_usuario]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Nombre: "}),n.nombre]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Correo: "}),n.email?n.email:" -"]})]}),Object(V.jsxs)("ul",{children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Telefono: "}),n.telefono?n.telefono:" -"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Celular: "}),n.celular?n.celular:" -"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Estado del usuario: "}),n.estado_usuario?"Activo":"Inactivo"]})]})]}),Object(V.jsx)(Fe.a,{container:!0,spacing:2,children:Object(V.jsxs)(Fe.a,{item:!0,md:6,children:[Object(V.jsxs)(b.a,{mt:3,children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Direcci\xf3n"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsxs)("ul",{children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Calle: "}),n.direccion.calle?n.direccion.calle:" -"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"No. Exterior: "}),n.direccion.no_ext?n.direccion.no_ext:" -"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"No. Interior: "}),n.direccion.no_int?n.direccion.no_int:" -"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"C\xf3digo postal: "}),n.direccion.codigo_postal?n.direccion.codigo_postal:" -"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Colonia: "}),n.direccion.colonia?n.direccion.colonia:" -"]})]}),Object(V.jsxs)("ul",{children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Municipio: "}),n.direccion.municipio?n.direccion.municipio:" -"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Localidad: "}),n.direccion.localidad?n.direccion.localidad:" -"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Estado: "}),n.direccion.estado?n.direccion.estado:" -"]}),Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Pais: "}),n.direccion.pais?n.direccion.pais:" -"]})]})]})]})})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:t,color:"primary",variant:"contained",size:"large",children:"Cerrar"})})]})]})},Gd=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},root:{display:"flex",paddingLeft:e.spacing(2)}}})),qd=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Hd(){var e=Gd(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=l.a.useState(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(""),o=Object(v.a)(i,2),d=o[0],j=o[1],u=Object(s.useState)(""),p=Object(v.a)(u,2),m=p[0],O=p[1],x=JSON.parse(localStorage.getItem("sesionCafi")),h=function(){r(!1)};return Object(V.jsx)("div",{children:Object(V.jsxs)(xd,{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){r(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/usuarios.svg",alt:"icono numero calzado",className:e.icon})}),"Usuarios"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:c,onClose:h,TransitionComponent:qd,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Usuarios"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:h,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsxs)(b.a,{m:3,display:"flex",justifyContent:"space-between",children:[Object(V.jsx)(b.a,{mr:5,minWidth:"70%",children:Object(V.jsxs)(Da.a,{className:e.root,children:[Object(V.jsx)(us.a,{fullWidth:!0,placeholder:"Buscar cliente...",onChange:function(e){return O(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&j(e.target.defaultValue)},value:m}),Object(V.jsx)(X.a,{onClick:function(){return j(m)},children:Object(V.jsx)(xc.a,{})})]})}),!1===t.accesos.catalogos.usuarios.agregar?null:Object(V.jsx)($d,{accion:"registrar",datos:void 0})]}),Object(V.jsx)(b.a,{mx:4,children:Object(V.jsx)(Ud,{sucursal:x.sucursal._id,filtro:d})})]})]})})}var Yd=Object(s.createContext)(),Xd=function(e){var t=e.children,a=Object(s.useState)({nombre_departamentos:""}),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(!1),u=Object(v.a)(j,2),b=u[0],p=u[1],m=Object(s.useState)(!0),O=Object(v.a)(m,2),x=O[0],h=O[1],f=Object(s.useState)(!1),g=Object(v.a)(f,2),_=g[0],C=g[1],y=Object(s.useState)(""),S=Object(v.a)(y,2),w=S[0],I=S[1],k=Object(s.useState)({message:"",status:"",open:!1}),N=Object(v.a)(k,2),F=N[0],z=N[1],P=Object(s.useState)(!1),D=Object(v.a)(P,2),E=D[0],A=D[1];return Object(V.jsx)(Yd.Provider,{value:{data:c,setData:r,update:l,setUpdate:d,error:b,setError:p,openRegistro:_,setOpenRegistro:C,accion:x,setAccion:h,idDepartamento:w,setIdDepartamento:I,alert:F,setAlert:z,loading:E,setLoading:A},children:t})},Kd=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)}}}));function Qd(){var e,t,a=Kd(),n=Object(s.useState)(0),c=Object(v.a)(n,2),r=c[0],i=c[1],o=Object(s.useState)(8),l=Object(v.a)(o,2),d=l[0],j=l[1],u=Object(s.useState)(!1),b=Object(v.a)(u,2),p=b[0],m=b[1],O=JSON.parse(localStorage.getItem("sesionCafi")),x=[],h=Object(s.useContext)(Yd),f=h.update,C=h.setAccion,y=h.idDepartamento,S=h.setIdDepartamento,w=h.setData,I=h.setAlert,k=h.setLoading,F=Object(N.a)(nr),z=Object(v.a)(F,1)[0],P=Object(He.a)(er,{variables:{empresa:O.empresa._id,sucursal:O.sucursal._id}}),D=P.data,E=P.refetch,A=function(){return m(!p)};Object(s.useEffect)((function(){E()}),[f,E]);var T=function(){var e=Object(_.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(!0),e.prev=1,e.next=4,z({variables:{id:y}});case 4:"false"===(t=e.sent).data.eliminarDepartamento.message?I({message:"Departamento eliminado con exito",status:"success",open:!0}):I({message:t.data.eliminarDepartamento.message,status:"error",open:!0}),E(),k(!1),m(!1),S(""),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0),I({message:"Hubo un error",status:"error",open:!0}),k(!1);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}();return D&&(x=D.obtenerDepartamentos),Object(V.jsxs)("div",{className:a.root,children:[Object(V.jsxs)(Da.a,{className:a.paper,children:[Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{className:a.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Departamentos"}),!1===O.accesos.catalogos.departamentos.editar?null:Object(V.jsx)(sa.a,{padding:"default",children:"Editar"}),!1===O.accesos.catalogos.departamentos.eliminar?null:Object(V.jsx)(sa.a,{padding:"default",children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:null===(e=x)||void 0===e||null===(t=e.slice(r*d,r*d+d))||void 0===t?void 0:t.map((function(e,t){return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:y===e._id,children:[Object(V.jsx)(sa.a,{children:e.nombre_departamentos}),!1===O.accesos.catalogos.departamentos.editar?null:Object(V.jsx)(sa.a,{padding:"checkbox",children:y===e._id?Object(V.jsx)(X.a,{onClick:function(){S(""),w({nombre_departamentos:""})},children:Object(V.jsx)(zt.a,{})}):Object(V.jsx)(X.a,{onClick:function(){C(!1),w({nombre_departamentos:e.nombre_departamentos}),S(e._id)},children:Object(V.jsx)($a.a,{})})}),!1===O.accesos.catalogos.departamentos.eliminar?null:Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(X.a,{onClick:function(){S(e._id),A()},children:Object(V.jsx)(ur.a,{})})})]},e._id)}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[],component:"div",count:x.length,rowsPerPage:d,page:r,onChangePage:function(e,t){i(t)},onChangeRowsPerPage:function(e){j(parseInt(e.target.value,10)),i(0)}})]}),Object(V.jsx)(Zd,{handleModal:A,openModal:p,handleDelete:T})]})}var Zd=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete;return Object(V.jsx)("div",{children:Object(V.jsxs)(ze.a,{open:a,onClose:t,children:[Object(V.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"OK"})]})]})})};function ej(){var e=Object(s.useContext)(Yd),t=e.data,a=e.setData,n=e.update,c=e.setUpdate,r=e.error,i=e.setError,o=e.accion,l=e.setAccion,d=e.idDepartamento,j=e.setIdDepartamento,p=e.setLoading,m=e.setAlert,O=e.loading,x=e.alert,f=JSON.parse(localStorage.getItem("sesionCafi")),C=Object(N.a)(tr),y=Object(v.a)(C,1)[0],I=Object(N.a)(ar),k=Object(v.a)(I,1)[0],F=function(){var e=Object(_.a)(g.a.mark((function e(){var r,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.nombre_departamentos){e.next=6;break}return i(!0),e.abrupt("return");case 6:if(r=t,!o){e.next=16;break}if(!1!==f.accesos.catalogos.departamentos.agregar){e.next=12;break}return e.abrupt("return",m({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 12:return e.next=14,y({variables:{input:r,empresa:f.empresa._id,sucursal:f.sucursal._id}});case 14:e.next=23;break;case 16:if(!1!==f.accesos.catalogos.departamentos.editar){e.next=20;break}return e.abrupt("return",m({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 20:return s=et(r),e.next=23,k({variables:{input:s,id:d}});case 23:c(!n),l(!0),j(""),a({nombre_departamentos:""}),m({message:"\xa1Listo!",status:"success",open:!0}),i(!1),p(!1);case 30:e.next=34;break;case 32:e.prev=32,e.t0=e.catch(0);case 34:case"end":return e.stop()}}),e,null,[[0,32]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(b.a,{children:[Object(V.jsx)(B,{alert:x,setAlert:m}),Object(V.jsx)(Ve,{loading:O,setLoading:p}),Object(V.jsxs)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",my:2,children:[Object(V.jsx)(S.a,{id:"outlined-error-helper-text",label:"Nombre departamento",value:t.nombre_departamentos,name:"nombre_departamentos",variant:"outlined",size:"small",fullWidth:!0,onChange:function(e){a(Object(u.a)(Object(u.a)({},t),{},Object(h.a)({},e.target.name,e.target.value)))},error:r}),Object(V.jsx)(b.a,{ml:1}),Object(V.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:F,children:[Object(V.jsx)(It.a,{}),"Guardar"]})]}),Object(V.jsx)(Qd,{})]})}var tj=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),aj=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function nj(){var e=tj(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(V.jsx)("div",{children:Object(V.jsxs)(Xd,{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/departamentos.svg",alt:"icono numero calzado",className:e.icon})}),"Departamentos"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:aj,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Departamentos"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(b.a,{mt:3,children:Object(V.jsx)(C.a,{maxWidth:"sm",children:Object(V.jsx)(ej,{accion:"registrar"})})})]})]})})}var cj=a(27),rj=a(928),ij=a(905),oj=a(907),sj=a(906),lj=Object(k.a)((function(e){return{root:{width:"100%"},flexGrow:{flexGrow:1},selected:{background:Object(cj.d)(e.palette.secondary.main,.1)}}}));function dj(){var e=lj(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(s.useState)(""),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(""),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(!1),u=Object(v.a)(j,2),p=u[0],m=u[1],O=Object(s.useState)({message:"",status:"",open:!1}),x=Object(v.a)(O,2),h=x[0],f=x[1],C=Object(He.a)(Kc,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id}}),k=C.loading,F=C.data,z=C.error,P=C.refetch,D=Object(N.a)(qc),E=Object(v.a)(D,1)[0],A=Object(N.a)(Yc),T=Object(v.a)(A,1)[0],W=function(){var e=Object(_.a)(g.a.mark((function e(){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=2;break}return e.abrupt("return");case 2:if(m(!0),e.prev=3,l){e.next=14;break}if(!1!==t.accesos.catalogos.categorias.agregar){e.next=10;break}return m(!1),e.abrupt("return",f({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 10:return e.next=12,E({variables:{input:{categoria:c,empresa:t.empresa._id,sucursal:t.sucursal._id}}});case 12:e.next=22;break;case 14:if(!1!==t.accesos.catalogos.categorias.editar){e.next=19;break}return m(!1),e.abrupt("return",f({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 19:return a=et(c),e.next=22,T({variables:{input:{categoria:a},idCategoria:l}});case 22:P(),f({message:"\xa1Listo!",status:"success",open:!0}),m(!1),r(""),d(""),e.next=33;break;case 29:e.prev=29,e.t0=e.catch(3),f({message:"Hubo un error",status:"error",open:!0}),m(!1);case 33:case"end":return e.stop()}}),e,null,[[3,29]])})));return function(){return e.apply(this,arguments)}}();if(k)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})});if(z)return Object(V.jsx)(Je,{error:z});var R=F.obtenerCategorias.map((function(e,t){return Object(V.jsx)(jj,{categoria:e,setToUpdateID:d,setCategoria:r,refetch:P,toUpdateID:l},t)}));return Object(V.jsxs)("div",{className:e.root,children:[Object(V.jsx)(B,{alert:h,setAlert:f}),Object(V.jsx)(Ve,{loading:p,setLoading:m}),Object(V.jsx)(y.a,{variant:"h6",children:"Categorias"}),Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",mb:2,children:[Object(V.jsx)(S.a,{value:c,variant:"outlined",size:"small",onChange:function(e){r(e.target.value)}}),Object(V.jsx)(b.a,{ml:1}),Object(V.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:W,children:[Object(V.jsx)(It.a,{}),"Guardar"]})]}),R]})}var jj=function(e){var t=e.categoria,a=e.setToUpdateID,n=e.setCategoria,c=e.refetch,r=e.toUpdateID,i=lj(),o=JSON.parse(localStorage.getItem("sesionCafi")),l=Object(s.useState)(""),d=Object(v.a)(l,2),j=d[0],u=d[1],p=Object(s.useState)(!1),m=Object(v.a)(p,2),O=m[0],x=m[1],h=Object(s.useState)({message:"",status:"",open:!1}),f=Object(v.a)(h,2),C=f[0],I=f[1],k=Object(N.a)(Hc),F=Object(v.a)(k,1)[0],z=Object(N.a)(Xc),P=Object(v.a)(z,1)[0],D=Object(N.a)(Qc),E=Object(v.a)(D,1)[0],A=t.subcategorias.map((function(e){return Object(V.jsx)(uj,{idCategoria:t._id,subcategoria:e,setToUpdateID:a,toUpdateID:r,setSubcategoria:u,setAlert:I,refetch:c},e._id)})),T=function(){var e=Object(_.a)(g.a.mark((function e(){var n,i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j){e.next=2;break}return e.abrupt("return");case 2:if(x(!0),n="",e.prev=4,r){e.next=17;break}if(!1!==o.accesos.catalogos.categorias.agregar){e.next=11;break}return x(!1),e.abrupt("return",I({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 11:return e.next=13,F({variables:{input:{subcategoria:j},idCategoria:t._id}});case 13:i=e.sent,n="false"===i.data.crearSubcategoria.message?{message:"\xa1Listo!",status:"success",open:!0}:{message:i.data.crearSubcategoria.message,status:"error",open:!0};case 15:e.next=27;break;case 17:if(!1!==o.accesos.catalogos.categorias.editar){e.next=22;break}return x(!1),e.abrupt("return",I({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 22:return s=et(j),e.next=25,P({variables:{input:{subcategoria:s},idCategoria:t._id,idSubcategoria:r}});case 25:i=e.sent,n="false"===i.data.actualizarSubcategoria.message?{message:"\xa1Listo!",status:"success",open:!0}:{message:i.data.actualizarSubcategoria.message,status:"error",open:!0};case 27:c(),I(n),x(!1),u(""),a(""),e.next=38;break;case 34:e.prev=34,e.t0=e.catch(4),I({message:"Hubo un error",status:"error",open:!0}),x(!1);case 38:case"end":return e.stop()}}),e,null,[[4,34]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(_.a)(g.a.mark((function e(a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.stopPropagation(),e.prev=1,e.next=4,E({variables:{idCategoria:t._id}});case 4:n=e.sent,r="false"===n.data.eliminarCategoria.message?{message:"\xa1Listo!",status:"success",open:!0}:{message:n.data.eliminarCategoria.message,status:"error",open:!0},I(r),c(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),I({message:"Hubo un error",status:"error",open:!0});case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(B,{alert:C,setAlert:I}),Object(V.jsx)(Ve,{loading:O,setLoading:x}),Object(V.jsxs)(rj.a,{children:[Object(V.jsx)(ij.a,{className:r&&r===t._id?i.selected:"",expandIcon:Object(V.jsx)(sj.a,{}),"aria-label":"Expand","aria-controls":"categoria-action-".concat(t._id),id:"categoria-".concat(t._id),children:Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",width:"100%",children:[Object(V.jsx)(y.a,{variant:"h6",children:t.categoria}),Object(V.jsx)("div",{className:i.flexGrow}),!1===o.accesos.catalogos.categorias.editar?null:r&&r===t._id?Object(V.jsx)(X.a,{onClick:function(e){e.stopPropagation(),a(""),n("")},onFocus:function(e){return e.stopPropagation()},children:Object(V.jsx)(zt.a,{})}):Object(V.jsx)(X.a,{onClick:function(e){window.scrollTo(0,0),e.stopPropagation(),a(t._id),n(t.categoria)},onFocus:function(e){return e.stopPropagation()},children:Object(V.jsx)($a.a,{})}),!1===o.accesos.catalogos.categorias.eliminar?null:Object(V.jsx)(X.a,{onClick:function(e){return W(e)},onFocus:function(e){return W(e)},children:Object(V.jsx)(ur.a,{})})]})}),Object(V.jsx)(oj.a,{children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(Te.a,{}),Object(V.jsx)(b.a,{mb:2}),Object(V.jsxs)(b.a,{ml:5,width:"100%",display:"flex",children:[Object(V.jsx)(y.a,{variant:"h6",children:"Subcategorias"}),Object(V.jsx)(b.a,{mr:2}),Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",mb:2,children:[Object(V.jsx)(S.a,{value:j,variant:"outlined",size:"small",onChange:function(e){u(e.target.value)}}),Object(V.jsx)(b.a,{ml:1}),Object(V.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:T,children:[Object(V.jsx)(It.a,{}),"Guardar"]})]})]}),Object(V.jsx)(b.a,{ml:5,children:A})]})})]})]})},uj=function(e){var t=e.subcategoria,a=e.idCategoria,n=e.toUpdateID,c=e.setToUpdateID,r=e.setSubcategoria,i=e.setAlert,o=e.refetch,l=JSON.parse(localStorage.getItem("sesionCafi")),d=lj(),j=Object(N.a)(Zc),u=Object(v.a)(j,1)[0],p=function(){var e=Object(_.a)(g.a.mark((function e(n){var c,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.stopPropagation(),e.next=4,u({variables:{idCategoria:a,idSubcategoria:t._id}});case 4:c=e.sent,r="false"===c.data.eliminarSubcategoria.message?{message:"\xa1Listo!",status:"success",open:!0}:{message:c.data.eliminarSubcategoria.message,status:"error",open:!0},i(r),o(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),i({message:"Ocurri\xf3 un error",status:"error",open:!0});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",borderRadius:3,px:1,className:n&&n===t._id?d.selected:"",children:[Object(V.jsx)(y.a,{children:t.subcategoria}),Object(V.jsx)("div",{className:d.flexGrow}),!1===l.accesos.catalogos.categorias.editar?null:n&&n===t._id?Object(V.jsx)(X.a,{onClick:function(e){e.stopPropagation(),c(""),r("")},onFocus:function(e){return e.stopPropagation()},children:Object(V.jsx)(zt.a,{})}):Object(V.jsx)(X.a,{onClick:function(e){e.stopPropagation(),c(t._id),r(t.subcategoria)},onFocus:function(e){return e.stopPropagation()},children:Object(V.jsx)($a.a,{})}),!1===l.accesos.catalogos.categorias.eliminar?null:Object(V.jsx)(X.a,{onClick:function(e){return p(e)},children:Object(V.jsx)(ur.a,{})})]}),Object(V.jsx)(Te.a,{})]})},bj=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),pj=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function mj(){var e=bj(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/categorias.svg",alt:"icono numero calzado",className:e.icon})}),"Categorias"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:pj,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Categorias"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(b.a,{mt:3,children:Object(V.jsx)(C.a,{maxWidth:"md",children:Object(V.jsx)(dj,{})})})]})]})}var Oj=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},color:{display:"flex",alignItems:"center"}}}));function xj(e){var t=e.datos,a=e.toUpdate,n=e.setToUpdate,c=e.setValues,r=e.refetch,i=Oj(),o=JSON.parse(localStorage.getItem("sesionCafi")),l=Object(s.useState)(0),d=Object(v.a)(l,2),j=d[0],u=d[1],p=Object(s.useState)(8),m=Object(v.a)(p,2),O=m[0],x=m[1],h=Object(s.useState)(""),f=Object(v.a)(h,2),g=f[0],_=f[1],C=Object(s.useState)([]),y=Object(v.a)(C,2),w=y[0],I=y[1],k=Object(s.useState)({status:"",message:"",open:!1}),N=Object(v.a)(k,2),F=N[0],z=N[1];return Object(s.useEffect)((function(){I(t.filter((function(e){return e.nombre.toLowerCase().includes(g.toLowerCase())})))}),[g,t]),Object(V.jsxs)("div",{className:i.root,children:[Object(V.jsx)(B,{alert:F,setAlert:z}),Object(V.jsxs)(Da.a,{className:i.paper,children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(S.a,{fullWidth:!0,placeholder:"Buscar...",variant:"outlined",onChange:function(e){return _(e.target.value)}})}),Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{className:i.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{width:150,children:"Color"}),Object(V.jsx)(sa.a,{children:"Nombre"}),!1===o.accesos.catalogos.colores.editar?null:Object(V.jsx)(sa.a,{padding:"default",children:"Editar"}),!1===o.accesos.catalogos.colores.eliminar?null:Object(V.jsx)(sa.a,{padding:"default",children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:w.slice(j*O,j*O+O).map((function(e,t){return Object(V.jsx)(hj,{row:e,setAlert:z,toUpdate:a,setToUpdate:n,setValues:c,refetch:r},t)}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[],component:"div",count:t.length,rowsPerPage:O,page:j,onChangePage:function(e,t){u(t)},onChangeRowsPerPage:function(e){x(parseInt(e.target.value,10)),u(0)}})]})]})}var hj=function(e){var t=e.row,a=e.setAlert,n=e.toUpdate,c=e.setToUpdate,r=e.setValues,i=e.refetch,o=Oj(),l=JSON.parse(localStorage.getItem("sesionCafi")),d=Object(s.useState)(!1),j=Object(v.a)(d,2),p=j[0],m=j[1],O=function(){return m(!p)},x=Object(N.a)(Qn,{update:function(e,a){var n=a.data.eliminarColor;try{var c=e.readQuery({query:Xn,variables:{empresa:t.empresa._id}}).obtenerColores;e.writeQuery({query:Xn,variables:{empresa:t.empresa._id},data:{obtenerColores:Object(u.a)(Object(u.a)({},c),{},{eliminarColor:n})}})}catch(r){}}}),h=Object(v.a)(x,1)[0],f=function(){var e=Object(_.a)(g.a.mark((function e(){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h({variables:{id:t._id}});case 3:n=e.sent,i(i),a({message:n.data.eliminarColor.message,status:"success",open:!0}),O(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),a({message:e.t0.message,status:"error",open:!0});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),C=function(e){if(!e)return c(""),void r({nombre:"",hex:""});c(e._id),r({nombre:e.nombre,hex:e.hex})};return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:n===t._id,children:[Object(V.jsxs)(sa.a,{className:o.color,children:[Object(V.jsx)(b.a,{mr:1,width:30,height:25,bgcolor:t.hex,borderRadius:"10%"}),Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:t.hex})})]}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:t.nombre})})}),!1===l.accesos.catalogos.colores.editar?null:Object(V.jsx)(sa.a,{padding:"checkbox",children:n===t._id?Object(V.jsx)(X.a,{onClick:function(){return C()},children:Object(V.jsx)(zt.a,{})}):Object(V.jsx)(X.a,{onClick:function(){return C(t)},children:Object(V.jsx)($a.a,{})})}),!1===l.accesos.catalogos.colores.eliminar?null:Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(fj,{handleModal:O,openModal:p,handleDelete:f})})]})},fj=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete;return Object(V.jsxs)("div",{children:[Object(V.jsx)(X.a,{color:"secondary",onClick:t,children:Object(V.jsx)(ur.a,{})}),Object(V.jsxs)(ze.a,{open:a,onClose:t,children:[Object(V.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"Eliminar"})]})]})]})};function gj(){var e=Object(s.useState)({}),t=Object(v.a)(e,2),a=t[0],n=t[1],c=Object(s.useState)(""),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)({nombre:"",hex:""}),d=Object(v.a)(l,2),j=d[0],p=d[1],m=Object(s.useState)({message:"",status:"",open:!1}),O=Object(v.a)(m,2),x=O[0],h=O[1],f=JSON.parse(localStorage.getItem("sesionCafi")),C=Object(He.a)(Xn,{variables:{sucursal:f.sucursal._id}}),k=C.loading,F=C.data,z=C.error,P=C.refetch,D=Object(N.a)(Yn),E=Object(v.a)(D,1)[0],A=Object(N.a)(Kn),T=Object(v.a)(A,1)[0];if(k)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})});if(z)return Object(V.jsx)(Je,{error:z});var W=F.obtenerColores,R=function(){var e=Object(_.a)(g.a.mark((function e(){var t,a,n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j.nombre&&j.hex){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,t=j,!i){e.next=16;break}if(!1!==f.accesos.catalogos.colores.editar){e.next=9;break}return e.abrupt("return",h({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 9:return n=et(t),e.next=12,T({variables:{input:{nombre:n.nombre,hex:n.hex},id:i}});case 12:c=e.sent,a=c.data.actualizarColor.message;case 14:e.next=23;break;case 16:if(!1!==f.accesos.catalogos.colores.agregar){e.next=20;break}return e.abrupt("return",h({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 20:return e.next=22,E({variables:{input:{nombre:t.nombre,hex:t.hex,empresa:f.empresa._id,sucursal:f.sucursal._id}}});case 22:a="\xa1Listo!. Color creado.";case 23:P(),p({nombre:"",hex:""}),o(""),h({message:a,status:"success",open:!0}),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(2),h({message:e.t0.message,status:"error",open:!0});case 32:case"end":return e.stop()}}),e,null,[[2,29]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(b.a,{display:"flex",justifyContent:"center",children:[Object(V.jsx)(B,{alert:x,setAlert:h}),Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsxs)(Fe.a,{item:!0,md:4,children:[Object(V.jsx)(Hn.a,{color:a,onChangeComplete:function(e){n(e),p(Object(u.a)(Object(u.a)({},j),{},{hex:e.hex.toUpperCase()}))}}),Object(V.jsxs)(b.a,{mt:2,children:[Object(V.jsx)(y.a,{children:"Color seleccionado:"}),j.hex?Object(V.jsx)(b.a,{bgcolor:j.hex,height:30,width:220}):Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",width:220,children:Object(V.jsx)(y.a,{color:"secondary",children:"NINGUNO"})})]}),Object(V.jsxs)(b.a,{my:2,width:"75%",children:[Object(V.jsx)(S.a,{label:"Nombre del color",variant:"outlined",size:"small",value:j.nombre,onChange:function(e){return p(Object(u.a)(Object(u.a)({},j),{},{nombre:e.target.value.toUpperCase()}))},fullWidth:!0}),Object(V.jsx)(b.a,{my:1}),Object(V.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",fullWidth:!0,onClick:R,children:[Object(V.jsx)(It.a,{}),"Guardar"]})]})]}),Object(V.jsx)(Fe.a,{item:!0,md:7,children:Object(V.jsx)(xj,{datos:W,toUpdate:i,setToUpdate:o,setValues:p,refetch:P})})]})]})}var _j=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),vj=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Cj(){var e=_j(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/colores.svg",alt:"icono numero calzado",className:e.icon})}),"Colores"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:vj,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Colores"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(b.a,{mt:4,children:Object(V.jsx)(C.a,{maxWidth:"md",children:Object(V.jsx)(gj,{})})})]})]})}var yj=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)}}}));function Sj(e){var t,a,n=e.updateData,c=e.toUpdate,r=e.setToUpdate,i=e.setData,o=yj(),l=Object(s.useState)(0),d=Object(v.a)(l,2),j=d[0],u=d[1],b=Object(s.useState)(8),p=Object(v.a)(b,2),m=p[0],O=p[1],x=Object(s.useState)({status:"",message:"",open:!1}),h=Object(v.a)(x,2),f=h[0],g=h[1],_=JSON.parse(localStorage.getItem("sesionCafi")),C=[],y=Object(He.a)(cr,{variables:{empresa:_.empresa._id,sucursal:_.sucursal._id}}),S=y.data,w=y.refetch;Object(s.useEffect)((function(){w()}),[w,n]),S&&(C=S.obtenerMarcas);return Object(V.jsxs)("div",{className:o.root,children:[Object(V.jsx)(B,{alert:f,setAlert:g}),Object(V.jsxs)(Da.a,{className:o.paper,children:[Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{className:o.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Marca"}),!1===_.accesos.catalogos.marcas.editar?null:Object(V.jsx)(sa.a,{padding:"default",children:"Editar"}),!1===_.accesos.catalogos.marcas.eliminar?null:Object(V.jsx)(sa.a,{padding:"default",children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:null===(t=C)||void 0===t||null===(a=t.slice(j*m,j*m+m))||void 0===a?void 0:a.map((function(e,t){return Object(V.jsx)(wj,{setAlert:g,refetch:w,datos:e,toUpdate:c,setToUpdate:r,setData:i},t)}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[],component:"div",count:C.length,rowsPerPage:m,page:j,onChangePage:function(e,t){u(t)},onChangeRowsPerPage:function(e){O(parseInt(e.target.value,10)),u(0)}})]})]})}var wj=function(e){var t=e.datos,a=(e.updateData,e.toUpdate),n=e.setAlert,c=e.setToUpdate,r=e.setData,i=e.refetch,o=JSON.parse(localStorage.getItem("sesionCafi")),l=Object(s.useState)(!1),d=Object(v.a)(l,2),j=d[0],u=d[1],b=function(){return u(!j)},p=Object(N.a)(or),m=Object(v.a)(p,1)[0],O=function(){var e=Object(_.a)(g.a.mark((function e(){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m({variables:{id:t._id,empresa:o.empresa._id,sucursal:o.sucursal._id}});case 3:"false"===(a=e.sent).data.eliminarMarca.message?n({message:"Marca eliminada con exito",status:"success",open:!0}):n({message:a.data.eliminarMarca.message,status:"error",open:!0}),i(),b(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),n({message:e.t0.message,status:"error",open:!0});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),x=function(e){if(!e)return c(""),r(""),void i();i(),c(e._id),r(e)};return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:a===t._id,children:[Object(V.jsx)(sa.a,{children:t.nombre_marca}),!1===o.accesos.catalogos.marcas.editar?null:Object(V.jsx)(sa.a,{padding:"checkbox",children:a===t._id?Object(V.jsx)(X.a,{onClick:function(){return x()},children:Object(V.jsx)(zt.a,{})}):Object(V.jsx)(X.a,{onClick:function(){return x(t)},children:Object(V.jsx)($a.a,{})})}),!1===o.accesos.catalogos.marcas.eliminar?null:Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(Ij,{handleModal:b,openModal:j,handleDelete:O})})]})},Ij=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete;return Object(V.jsxs)("div",{children:[Object(V.jsx)(X.a,{color:"secondary",onClick:t,children:Object(V.jsx)(ur.a,{})}),Object(V.jsxs)(ze.a,{open:a,onClose:t,children:[Object(V.jsx)(wt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"Eliminar"})]})]})]})},kj=Object(s.createContext)(),Nj=function(e){var t=e.children,a=Object(s.useState)({nombre_marca:""}),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(!1),u=Object(v.a)(j,2),b=u[0],p=u[1],m=Object(s.useState)(!1),O=Object(v.a)(m,2),x=O[0],h=O[1];return Object(V.jsx)(kj.Provider,{value:{datosMarcas:c,setDatosMarcas:r,update:l,setUpdate:d,error:b,setError:p,openRegistro:x,setOpenRegistro:h},children:t})};function Fj(){var e=Object(s.useState)({message:"",status:"",open:!1}),t=Object(v.a)(e,2),a=t[0],n=t[1],c=Object(s.useState)({nombre_marca:""}),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)(""),d=Object(v.a)(l,2),j=d[0],p=d[1],m=Object(s.useState)(!1),O=Object(v.a)(m,2),x=O[0],f=O[1],C=Object(s.useContext)(kj),y=C.error,I=C.setError,k=JSON.parse(localStorage.getItem("sesionCafi")),F=Object(N.a)(rr),z=Object(v.a)(F,1)[0],P=Object(N.a)(ir),D=Object(v.a)(P,1)[0],E=function(){var e=Object(_.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i.nombre_marca){e.next=6;break}return I(!0),e.abrupt("return");case 6:if(!j){e.next=17;break}if(!1!==k.accesos.catalogos.marcas.editar){e.next=11;break}return e.abrupt("return",n({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n !",status:"error",open:!0}));case 11:return t=et(i),e.next=14,D({variables:{input:{nombre_marca:t.nombre_marca},id:j}});case 14:o("");case 15:e.next=25;break;case 17:if(!1!==k.accesos.catalogos.marcas.agregar){e.next=21;break}return e.abrupt("return",n({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n !",status:"error",open:!0}));case 21:return a=i,e.next=24,z({variables:{input:a,empresa:k.empresa._id,sucursal:k.sucursal._id}});case 24:o("");case 25:p(""),f(!x),n({message:"\xa1Listo!",status:"success",open:!0}),I(!1);case 29:e.next=33;break;case 31:e.prev=31,e.t0=e.catch(0);case 33:case"end":return e.stop()}}),e,null,[[0,31]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{children:[Object(V.jsx)(B,{alert:a,setAlert:n}),Object(V.jsxs)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",my:2,children:[Object(V.jsx)(S.a,{id:"outlined-error-helper-text",label:"Nombre departamento",value:i.nombre_marca?i.nombre_marca:"",name:"nombre_marca",variant:"outlined",size:"small",fullWidth:!0,onChange:function(e){o(Object(u.a)(Object(u.a)({},i),{},Object(h.a)({},e.target.name,e.target.value)))},error:y,onKeyPress:function(e){"Enter"===e.key&&E()}}),Object(V.jsx)(b.a,{ml:1}),Object(V.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:E,children:[Object(V.jsx)(It.a,{}),"Guardar"]})]}),Object(V.jsx)(Sj,{toUpdate:j,setToUpdate:p,updateData:x,setData:o})]})}var zj=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),Pj=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100}}}));function Dj(){var e=Pj(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(V.jsx)("div",{children:Object(V.jsxs)(Nj,{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Ce.o,{className:e.icon})}),"Marcas"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:zj,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Marcas"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(b.a,{mt:4,children:Object(V.jsx)(C.a,{maxWidth:"md",children:Object(V.jsx)(Fj,{})})})]})]})})}var Ej=Object(k.a)((function(e){return{root:{width:"100%"},flexGrow:{flexGrow:1},selected:{background:Object(cj.d)(e.palette.secondary.main,.1)}}}));function Aj(){var e=Ej(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(s.useState)(""),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(""),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(!1),u=Object(v.a)(j,2),p=u[0],m=u[1],O=Object(s.useState)({message:"",status:"",open:!1}),x=Object(v.a)(O,2),h=x[0],f=x[1],C=Object(He.a)(Wr,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id}}),k=C.loading,F=C.data,z=C.error,P=C.refetch,D=Object(N.a)(Dr),E=Object(v.a)(D,1)[0],A=Object(N.a)(Ar),T=Object(v.a)(A,1)[0];if(k)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})});if(z)return Object(V.jsx)(Je,{error:z});var W=F.obtenerCuentas.map((function(e,t){return Object(V.jsx)(Mj,{cuenta:e,setToUpdateID:d,setCuenta:r,refetch:P,toUpdateID:l},t)})),R=function(){var e=Object(_.a)(g.a.mark((function e(){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=2;break}return e.abrupt("return");case 2:if(m(!0),e.prev=3,l){e.next=14;break}if(!1!==t.accesos.catalogos.centro_costos.agregar){e.next=10;break}return m(!1),e.abrupt("return",f({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 10:return e.next=12,E({variables:{input:{cuenta:c,empresa:t.empresa._id,sucursal:t.sucursal._id}}});case 12:e.next=22;break;case 14:if(!1!==t.accesos.catalogos.centro_costos.editar){e.next=19;break}return m(!1),e.abrupt("return",f({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 19:return a=et(c),e.next=22,T({variables:{input:{cuenta:a},idCuenta:l}});case 22:P(),f({message:"\xa1Listo!",status:"success",open:!0}),m(!1),r(""),d(""),e.next=33;break;case 29:e.prev=29,e.t0=e.catch(3),f({message:"Hubo un error",status:"error",open:!0}),m(!1);case 33:case"end":return e.stop()}}),e,null,[[3,29]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{className:e.root,children:[Object(V.jsx)(B,{alert:h,setAlert:f}),Object(V.jsx)(Ve,{loading:p,setLoading:m}),Object(V.jsx)(y.a,{variant:"h6",children:"Cuentas"}),Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",mb:2,children:[Object(V.jsx)(S.a,{value:c,variant:"outlined",size:"small",onChange:function(e){r(e.target.value)}}),Object(V.jsx)(b.a,{ml:1}),Object(V.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:R,children:[Object(V.jsx)(It.a,{}),"Guardar"]})]}),W]})}var Tj,Wj,Rj,$j,Mj=function(e){var t=e.cuenta,a=e.setToUpdateID,n=e.setCuenta,c=e.refetch,r=e.toUpdateID,i=JSON.parse(localStorage.getItem("sesionCafi")),o=Ej(),l=Object(s.useState)(""),d=Object(v.a)(l,2),j=d[0],u=d[1],p=Object(s.useState)(!1),m=Object(v.a)(p,2),O=m[0],x=m[1],h=Object(s.useState)({message:"",status:"",open:!1}),f=Object(v.a)(h,2),C=f[0],I=f[1],k=Object(N.a)(Rr),F=Object(v.a)(k,1)[0],z=Object(N.a)(Er),P=Object(v.a)(z,1)[0],D=Object(N.a)(Tr),E=Object(v.a)(D,1)[0],A=null!==t.subcuentas?t.subcuentas.map((function(e){return Object(V.jsx)(Lj,{idCuenta:t._id,subcuenta:e,setToUpdateID:a,toUpdateID:r,setSubcuenta:u,refetch:c},e._id)})):Object(V.jsx)("div",{}),T=function(){var e=Object(_.a)(g.a.mark((function e(){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j){e.next=2;break}return e.abrupt("return");case 2:if(x(!0),e.prev=3,r){e.next=14;break}if(!1!==i.accesos.catalogos.centro_costos.agregar){e.next=10;break}return x(!1),e.abrupt("return",I({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 10:return e.next=12,P({variables:{input:{subcuenta:j},idCuenta:t._id}});case 12:e.next=22;break;case 14:if(!1!==i.accesos.catalogos.centro_costos.editar){e.next=19;break}return x(!1),e.abrupt("return",I({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 19:return n=et(j),e.next=22,E({variables:{input:{subcuenta:n},idCuenta:t._id,idSubcuenta:r}});case 22:c(),I({message:"\xa1Listo!",status:"success",open:!0}),x(!1),u(""),a(""),e.next=33;break;case 29:e.prev=29,e.t0=e.catch(3),I({message:"Hubo un error",status:"error",open:!0}),x(!1);case 33:case"end":return e.stop()}}),e,null,[[3,29]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(_.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.prev=1,e.next=4,F({variables:{id:t}});case 4:c(),I({message:"\xa1Listo!",status:"success",open:!0}),x(!1),n(""),a(""),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),I({message:"Hubo un error",status:"error",open:!0}),x(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(B,{alert:C,setAlert:I}),Object(V.jsx)(Ve,{loading:O,setLoading:x}),Object(V.jsxs)(rj.a,{children:[Object(V.jsx)(ij.a,{className:r&&r===t._id?o.selected:"",expandIcon:Object(V.jsx)(sj.a,{}),"aria-label":"Expand","aria-controls":"cuenta-action-".concat(t._id),id:"cuenta-".concat(t._id),children:Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",width:"100%",children:[Object(V.jsx)(y.a,{variant:"h6",children:t.cuenta}),Object(V.jsx)("div",{className:o.flexGrow}),r&&r===t._id?Object(V.jsx)(X.a,{onClick:function(e){e.stopPropagation(),a(""),n("")},onFocus:function(e){return e.stopPropagation()},children:Object(V.jsx)(zt.a,{})}):!1===i.accesos.catalogos.centro_costos.editar?null:Object(V.jsx)(X.a,{onClick:function(e){e.stopPropagation(),a(t._id),n(t.cuenta)},onFocus:function(e){return e.stopPropagation()},children:Object(V.jsx)($a.a,{})}),!1===i.accesos.catalogos.centro_costos.eliminar?null:Object(V.jsx)(X.a,{onClick:function(){return W(t._id)},onFocus:function(e){return e.stopPropagation()},children:Object(V.jsx)(ur.a,{})})]})}),Object(V.jsx)(oj.a,{children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(Te.a,{}),Object(V.jsx)(b.a,{mb:2}),Object(V.jsxs)(b.a,{ml:5,width:"100%",display:"flex",children:[Object(V.jsx)(y.a,{variant:"h6",children:"Subcuenta"}),Object(V.jsx)(b.a,{mr:2}),Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",mb:2,children:[Object(V.jsx)(S.a,{value:j,variant:"outlined",size:"small",onChange:function(e){u(e.target.value)}}),Object(V.jsx)(b.a,{ml:1}),Object(V.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:T,children:[Object(V.jsx)(It.a,{}),"Guardar"]})]})]}),null!==t.subcuentas?Object(V.jsx)(b.a,{ml:5,children:A}):Object(V.jsx)("div",{})]})})]})]})},Lj=function(e){var t=e.idCuenta,a=e.subcuenta,n=e.toUpdateID,c=e.setToUpdateID,r=e.setSubcuenta,i=e.refetch,o=JSON.parse(localStorage.getItem("sesionCafi")),l=Ej(),d=Object(s.useState)(!1),j=Object(v.a)(d,2),u=j[0],p=j[1],m=Object(s.useState)({message:"",status:"",open:!1}),O=Object(v.a)(m,2),x=O[0],h=O[1],f=Object(N.a)($r),C=Object(v.a)(f,1)[0],S=function(){var e=Object(_.a)(g.a.mark((function e(a){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,C({variables:{idCuenta:t,idSubcuenta:a}});case 4:i(),h({message:"\xa1Listo!",status:"success",open:!0}),p(!1),r(""),c(""),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),h({message:"Hubo un error",status:"error",open:!0}),p(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(B,{alert:x,setAlert:h}),Object(V.jsx)(Ve,{loading:u,setLoading:p}),Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",borderRadius:3,px:1,className:n&&n===a._id?l.selected:"",children:[Object(V.jsx)(y.a,{children:a.subcuenta}),Object(V.jsx)("div",{className:l.flexGrow}),!1===o.accesos.catalogos.centro_costos.editar?null:n&&n===a._id?Object(V.jsx)(X.a,{onClick:function(e){e.stopPropagation(),c(""),r("")},onFocus:function(e){return e.stopPropagation()},children:Object(V.jsx)(zt.a,{})}):Object(V.jsx)(X.a,{onClick:function(e){e.stopPropagation(),c(a._id),r(a.subcuenta)},onFocus:function(e){return e.stopPropagation()},children:Object(V.jsx)($a.a,{})}),!1===o.accesos.catalogos.centro_costos.eliminar?null:Object(V.jsx)(X.a,{onClick:function(){return S(a._id)},onFocus:function(e){return e.stopPropagation()},children:Object(V.jsx)(ur.a,{})})]}),Object(V.jsx)(Te.a,{})]})},Vj=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),Uj=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Bj(){var e=Vj(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/costos.svg",alt:"icono numero calzado",className:e.icon})}),"Centro de costos"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Uj,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Centro de costos"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(b.a,{mt:3,children:Object(V.jsx)(C.a,{maxWidth:"md",children:Object(V.jsx)(Aj,{})})})]})]})}var Jj=Object(z.d)(Tj||(Tj=Object(F.a)(["\n    query ObtenerConceptosAlmacen($empresa: ID!, $sucursal: ID!){\n        obtenerConceptosAlmacen(empresa: $empresa, sucursal: $sucursal){\n                _id\n            nombre_concepto\n            destino\n            origen\n            editable\n            empresa{\n                _id\n                nombre_empresa\n            }\n                sucursal{\n                _id\n                nombre_sucursal\n            }\n        }\n    }\n"]))),Gj=Object(z.d)(Wj||(Wj=Object(F.a)(["\n    mutation CrearConceptoAlmacen($input: ConceptoAlmacenInput, $empresa: ID!, $sucursal: ID!, $usuario: ID!){\n        crearConceptoAlmacen(input:$input,empresa:$empresa,sucursal:$sucursal, usuario:$usuario){\n            message\n        }\n    }\n"]))),qj=Object(z.d)(Rj||(Rj=Object(F.a)(["\n    mutation ActualizarConceptoAlmacen($input: ConceptoAlmacenInput, $id: ID!){\n        actualizarConceptoAlmacen(input: $input, id: $id){\n            message\n        }\n    }\n"]))),Hj=Object(z.d)($j||($j=Object(F.a)(["\n    mutation EliminarConceptoAlmacen($id: ID!){\n        eliminarConceptoAlmacen(id: $id){\n            message\n        }\n    }\n"]))),Yj=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)}}}));function Xj(e){var t,a,n=e.setData,c=e.setIdConcepto,r=e.idConcepto,i=e.setAccion,o=e.updateData,l=e.setAlert,d=Yj(),j=Object(s.useState)(0),u=Object(v.a)(j,2),p=u[0],m=u[1],O=Object(s.useState)(10),x=Object(v.a)(O,2),h=x[0],f=x[1],C=JSON.parse(localStorage.getItem("sesionCafi")),y=Object(s.useState)(!1),S=Object(v.a)(y,2),w=S[0],k=S[1],F=function(){return k(!w)},z=[],P=Object(He.a)(Jj,{variables:{empresa:C.empresa._id,sucursal:C.sucursal._id}}),D=P.loading,E=P.data,A=P.error,T=P.refetch,W=Object(N.a)(Hj),R=Object(v.a)(W,1)[0];Object(s.useEffect)((function(){T()}),[o,T]),E&&(z=E.obtenerConceptosAlmacen);var $=function(){var e=Object(_.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R({variables:{id:r}});case 3:T(),l({message:"\xa1Listo!",status:"success",open:!0}),F(),c(""),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),l({message:e.t0.message,status:"error",open:!0});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return A?Object(V.jsx)(Je,{error:A}):D?Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsxs)("div",{className:d.root,children:[Object(V.jsxs)(Da.a,{className:d.paper,children:[Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{className:d.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Concepto almac\xe9n"}),Object(V.jsx)(sa.a,{padding:"default",children:"Origen"}),Object(V.jsx)(sa.a,{padding:"default",children:"Destino"}),!1===C.accesos.catalogos.conceptos_almacen.editar?null:Object(V.jsx)(sa.a,{padding:"default",children:"Editar"}),!1===C.accesos.catalogos.conceptos_almacen.eliminar?null:Object(V.jsx)(sa.a,{padding:"default",children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:null===(t=z)||void 0===t||null===(a=t.slice(p*h,p*h+h))||void 0===a?void 0:a.map((function(e,t){return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:e.nombre_concepto}),Object(V.jsx)(sa.a,{children:e.origen}),Object(V.jsx)(sa.a,{children:e.destino}),!1===C.accesos.catalogos.conceptos_almacen.editar?null:Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(X.a,{onClick:function(){i(!1),c(e._id),n({nombre_concepto:e.nombre_concepto,origen:e.origen,destino:e.destino})},disabled:!e.editable,children:Object(V.jsx)($a.a,{})})}),!1===C.accesos.catalogos.conceptos_almacen.eliminar?null:Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(X.a,{onClick:function(){c(e._id),F()},disabled:!e.editable,children:Object(V.jsx)(ur.a,{})})})]},e._id)}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[],component:"div",count:z.length,rowsPerPage:h,page:p,onChangePage:function(e,t){m(t)},onChangeRowsPerPage:function(e){f(parseInt(e.target.value,10)),m(0)}})]}),Object(V.jsx)(Kj,{handleModal:F,openModal:w,handleDelete:$})]})}var Kj=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete;return Object(V.jsx)("div",{children:Object(V.jsxs)(ze.a,{open:a,onClose:t,children:[Object(V.jsx)(wt.a,{children:"Eliminar este concepto afectar\xe1 c\xe1lculos de estados de resultado ,\xbfSeguro que quieres eliminar esto?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"Eliminar"})]})]})})},Qj=Object(k.a)((function(e){return{root:{width:"100%"},flexGrow:{flexGrow:1},formControl:{marginLeft:e.spacing(5),marginBottom:e.spacing(3),minWidth:200,maxWidth:200}}})),Zj={PaperProps:{style:{maxHeight:908,width:400}}},eu=["SUMA","RESTA","N/A"];function tu(e,t,a){return console.log(t),{fontWeight:-1===t.indexOf(e)?a.typography.fontWeightRegular:a.typography.fontWeightMedium}}function au(){var e=Qj(),t=Object(ve.a)(),a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)({nombre_concepto:"",destino:"",origen:""}),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)({message:"",status:"",open:!1}),p=Object(v.a)(j,2),m=p[0],O=p[1],x=Object(s.useState)(!1),f=Object(v.a)(x,2),C=f[0],I=f[1],k=JSON.parse(localStorage.getItem("sesionCafi")),F=Object(s.useState)(!0),z=Object(v.a)(F,2),P=z[0],D=z[1],E=Object(s.useState)(""),A=Object(v.a)(E,2),T=A[0],W=A[1],R=Object(N.a)(Gj),$=Object(v.a)(R,1)[0],M=Object(N.a)(qj),L=Object(v.a)(M,1)[0],U=Object(s.useState)(!1),J=Object(v.a)(U,2),H=J[0],Y=J[1],X=function(){var e=Object(_.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Y(!1),l.nombre_concepto&&l.origen&&l.destino){e.next=7;break}return I(!0),e.abrupt("return");case 7:if(t=l,!P){e.next=17;break}if(!1!==k.accesos.catalogos.conceptos_almacen.agregar){e.next=13;break}return e.abrupt("return",O({message:"Lo sentimos no tienes los permisos autorizados",status:"error",open:!0}));case 13:return e.next=15,$({variables:{input:t,empresa:k.empresa._id,sucursal:k.sucursal._id,usuario:k._id}});case 15:e.next=24;break;case 17:if(!1!==k.accesos.catalogos.conceptos_almacen.editar){e.next=21;break}return e.abrupt("return",O({message:"Lo sentimos no tienes los permisos autorizados",status:"error",open:!0}));case 21:return e.next=23,L({variables:{input:t,id:T}});case 23:D(!0);case 24:O({message:"\xa1Listo!",status:"success",open:!0}),d({nombre_concepto:"",origen:"",destino:""}),I(!1),r(!c),W("");case 29:e.next=33;break;case 31:e.prev=31,e.t0=e.catch(0);case 33:case"end":return e.stop()}}),e,null,[[0,31]])})));return function(){return e.apply(this,arguments)}}(),K=function(e){var t=e.handleModal,a=e.openModal,n=e.handleSubmit;return Object(V.jsx)("div",{children:Object(V.jsxs)(ze.a,{open:a,onClose:t,children:[Object(V.jsx)(wt.a,{children:"Editar este concepto afectar\xe1 c\xe1lculos de estados de resultado ,\xbfSeguro que quieres editar esto?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"Editar"})]})]})})};return Object(V.jsxs)("div",{className:e.root,children:[Object(V.jsx)(b.a,{flexDirection:"row",children:Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(B,{alert:m,setAlert:O}),Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",mb:2,children:[Object(V.jsx)(y.a,{children:"Concepto "}),Object(V.jsx)(S.a,{error:C,id:"outlined-error-helper-text",variant:"outlined",size:"small",name:"nombre_concepto",style:{marginLeft:2},value:l.nombre_concepto,onChange:function(e){d(Object(u.a)(Object(u.a)({},l),{},Object(h.a)({},e.target.name,e.target.value)))},onKeyPress:function(e){"Enter"===e.key&&X()}})]}),Object(V.jsxs)(G.a,{className:e.formControl,children:[Object(V.jsx)(q.a,{id:"origen-label",children:"Origen"}),Object(V.jsx)(De.a,{error:C,labelId:"origen-label",id:"origen-name",value:l.origen,onChange:function(e){d(Object(u.a)(Object(u.a)({},l),{},{origen:e.target.value}))},input:Object(V.jsx)(Pa.a,{}),MenuProps:Zj,children:eu.map((function(e){return Object(V.jsx)(Ee.a,{value:e,style:tu(e,l.origen,t),children:e},e)}))})]}),Object(V.jsxs)(G.a,{className:e.formControl,children:[Object(V.jsx)(q.a,{id:"destino-label",children:"Destino"}),Object(V.jsx)(De.a,{error:C,labelId:"destino-label",id:"destino-name",value:l.destino,onChange:function(e){d(Object(u.a)(Object(u.a)({},l),{},{destino:e.target.value}))},input:Object(V.jsx)(Pa.a,{}),MenuProps:Zj,children:eu.map((function(e){return Object(V.jsx)(Ee.a,{value:e,style:tu(e,l.destino,t),children:e},e)}))})]}),Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",mb:2,children:[Object(V.jsx)(b.a,{ml:5}),Object(V.jsxs)(w.a,{color:"primary",variant:"contained",size:"large",onClick:function(){return P?X():Y(!0)},disableElevation:!0,children:[Object(V.jsx)(It.a,{}),"Guardar"]})]})]})}),Object(V.jsx)(Xj,{setData:d,idConcepto:T,setIdConcepto:W,setAccion:D,updateData:c,setAlert:O}),Object(V.jsx)(K,{handleModal:function(){return Y(!H)},openModal:H,handleSubmit:X})]})}var nu=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),cu=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function ru(){var e=nu(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/conceptosAlmacen.svg",alt:"icono numero calzado",className:e.icon})}),"Conceptos Almac\xe9n"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:cu,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Conceptos almac\xe9n"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(b.a,{mt:4,alignSelf:"center",children:Object(V.jsx)(C.a,{children:Object(V.jsx)(au,{})})})]})]})}function iu(){var e=JSON.parse(localStorage.getItem("sesionCafi"));return Object(V.jsx)(C.a,{children:Object(V.jsxs)(Fe.a,{container:!0,spacing:5,justify:"center",children:[!1===e.accesos.catalogos.clientes.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(vs,{})})}),Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(sl,{})})}),!1===e.accesos.catalogos.tallas_numeros.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(yl,{})})}),!1===e.accesos.catalogos.contabilidad.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Tl,{})})}),!1===e.accesos.catalogos.provedores.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Jl,{})})}),!1===e.accesos.catalogos.cajas.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(pd,{})})}),!1===e.accesos.catalogos.usuarios.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Hd,{})})}),!1===e.accesos.catalogos.departamentos.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(nj,{})})}),!1===e.accesos.catalogos.categorias.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(mj,{})})}),!1===e.accesos.catalogos.colores.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Cj,{})})}),!1===e.accesos.catalogos.marcas.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Dj,{})})}),!1===e.accesos.catalogos.centro_costos.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Bj,{})})}),!1===e.accesos.catalogos.conceptos_almacen.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(ru,{})})})]})})}var ou,su,lu,du=Object(s.createContext)(),ju=function(e){var t=e.children,a=Object(s.useState)({message:"",status:"",open:!1}),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)([]),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)([]),u=Object(v.a)(j,2),b=u[0],p=u[1],m=Object(s.useState)(!1),O=Object(v.a)(m,2),x=O[0],h=O[1];return Object(V.jsx)(du.Provider,{value:{alert:c,setAlert:r,cuentas:l,setCuentas:d,reload:x,setReload:h,cuenta:b,setCuenta:p},children:t})},uu=a(457),bu=a.n(uu),pu=Object(z.d)(ou||(ou=Object(F.a)(["\n    query ObtenerSucursalesEmpresa($id: ID!){\n        obtenerSucursalesEmpresa(id: $id){\n            _id\n            nombre_sucursal\n            descripcion\n            usuario_sucursal\n            direccion{\n                calle\n                no_ext\n                no_int\n                codigo_postal\n                colonia\n                municipio\n                localidad\n                estado\n                pais\n            }\n            cuenta_sucursal {\n                dinero_actual\n            }         \n        }\n    }\n"]))),mu=Object(z.d)(su||(su=Object(F.a)(["\n    mutation CrearMovimientoCuenta($input: CrearMovimientoCuentaInput, $empresa: ID!, $sucursal: ID!, $tipo: Boolean){\n        crearMovimientoCuenta(input: $input, empresa: $empresa, sucursal: $sucursal, tipo: $tipo){\n            message\n        }\n    }\n"]))),Ou=Object(z.d)(lu||(lu=Object(F.a)(["\n    query ObtenerHistorialCuenta($empresa: ID!, $sucursal: ID!, $input: ObtenerHistorialCuenta, $tipo: Boolean){\n        obtenerHistorialCuenta(empresa: $empresa, sucursal: $sucursal, input: $input, tipo: $tipo){\n            tipo_movimiento\n            id_usuario\n            numero_caja\n            id_Caja\n            numero_usuario_creador\n            nombre_usuario_creador\n            horario_turno\n            concepto\n            comentarios\n            montos_en_caja { \n                monto_efectivo{\n                    monto \n                }\n            }\n            fecha_movimiento{\n                completa\n            }\n            empresa\n            sucursal             \n        }\n    }\n"]))),xu=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},formComboBox:{height:"50%"},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}}}})),hu=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function fu(e){var t=e.cuenta,a=e.refetch,n=e.tipo,c=JSON.parse(localStorage.getItem("sesionCafi")),r=JSON.parse(localStorage.getItem("turnoEnCurso")),i=Object(N.a)(mu),o=Object(v.a)(i,1)[0],l=xu(),d=Object(s.useState)({message:"",status:"",open:!1}),j=Object(v.a)(d,2),p=j[0],m=j[1],O=Object(s.useState)([]),x=Object(v.a)(O,2),f=x[0],C=x[1],I=Object(s.useState)(!1),k=Object(v.a)(I,2),F=k[0],z=k[1],P=function(){z(!F)},D=function(e){C(Object(u.a)(Object(u.a)({},f),{},Object(h.a)({},e.target.name,e.target.value)))},E={tipo_movimiento:"RETIRO"===f.tipo_movimiento?"CUENTA-RETIRO":"CUENTA-DEPOSITO",id_usuario:c._id,rol_movimiento:!0===n?"CUENTA-EMPRESA":"CUENTA",numero_caja:r?parseInt(r.numero_caja):0,id_Caja:r?r.id_caja:null,numero_usuario_creador:c.numero_usuario.toString(),nombre_usuario_creador:c.nombre,horario_turno:r?r.horario_turno:null,concepto:f.concepto,hora_moviento:{hora:xt()().format("hh"),minutos:xt()().format("mm"),segundos:xt()().format("ss"),completa:xt()().format("HH:mm:ss")},fecha_movimiento:{year:xt()().format("YYYY"),mes:xt()().format("MM"),dia:xt()().format("DD"),no_semana_year:xt()().week().toString(),no_dia_year:xt()().dayOfYear().toString(),completa:xt()().locale("es-mx").format()},montos_en_caja:{monto_efectivo:{monto:parseFloat(f.cantidad),metodo_pago:"01"},monto_tarjeta_debito:{monto:0,metodo_pago:"28"},monto_tarjeta_credito:{monto:0,metodo_pago:"04"},monto_creditos:{monto:0,metodo_pago:"99"},monto_monedero:{monto:0,metodo_pago:"05"},monto_transferencia:{monto:0,metodo_pago:"03"},monto_cheques:{monto:0,metodo_pago:"02"},monto_vales_despensa:{monto:0,metodo_pago:"08"}},comentarios:f.comentarios},A=function(){var e=Object(_.a)(g.a.mark((function e(){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,f.concepto&&f.tipo_movimiento&&f.cantidad){e.next=4;break}return m({message:"Por favor complete los datos",status:"error",open:!0}),e.abrupt("return",null);case 4:return e.next=6,o({variables:{input:E,empresa:c.empresa._id,sucursal:t._id,tipo:n}});case 6:r=e.sent,a(),C([]),P(),m({message:r.data.crearMovimientoCuenta.message,status:"success",open:!0}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),m({message:e.t0.message,status:"error",open:!0});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(X.a,{color:"primary",onClick:P,size:"small",children:Object(V.jsx)(bu.a,{style:{fontSize:35}})})}),Object(V.jsx)(B,{alert:p,setAlert:m}),Object(V.jsxs)(ze.a,{open:F,TransitionComponent:hu,maxWidth:"sm",fullWidth:!0,children:[Object(V.jsxs)(Pe.a,{children:[Object(V.jsx)(b.a,{textAlign:"center",p:1,children:Object(V.jsx)(y.a,{variant:"h5",children:"Movimiento en Cuenta"})}),Object(V.jsxs)("div",{className:l.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Usuario"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"usuario",variant:"outlined",disabled:!0,value:null===c||void 0===c?void 0:c.nombre})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha y hora"}),Object(V.jsx)(S.a,{fullWidth:!0,disabled:!0,size:"small",value:xt()().format("D MMMM YYYY, h:mm:ss"),name:"fecha_movimiento",variant:"outlined"})]})]}),Object(V.jsx)("div",{className:l.formInputFlex,children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Movimiento a Realizar"}),Object(V.jsxs)(De.a,{className:l.formComboBox,size:"small",variant:"outlined",name:"tipo_movimiento",onChange:D,fullWidth:!0,children:[Object(V.jsx)(Ee.a,{value:"",children:"Ninguno"}),Object(V.jsx)(Ee.a,{value:"DEPOSITO",children:"Deposito"}),Object(V.jsx)(Ee.a,{value:"RETIRO",children:"Retiro"})]})]})}),Object(V.jsxs)("div",{className:l.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Cantidad"}),Object(V.jsx)(S.a,{className:l.input,fullWidth:!0,onChange:D,size:"small",type:"number",name:"cantidad",variant:"outlined"})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Concepto"}),Object(V.jsx)(S.a,{fullWidth:!0,onChange:D,size:"small",name:"concepto",variant:"outlined"})]})]}),Object(V.jsx)("div",{className:l.formInputFlex,children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Comentarios"}),Object(V.jsx)(S.a,{className:l.input,fullWidth:!0,onChange:D,size:"small",multiline:!0,rows:2,type:"number",name:"monto_movimiento",variant:"outlined"})]})})]}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{color:"primary",variant:"outlined",onClick:A,size:"large",children:"Realizar"}),Object(V.jsx)(w.a,{color:"secondary",variant:"outlined",onClick:P,size:"large",children:"Cancelar"})]})]})]})}var gu=[{id:"movimiento",label:"Origen Movimiento",minWidth:100},{id:"fecha",label:"Fecha",minWidth:100},{id:"name",label:"Usuario",minWidth:150},{id:"cantidad",label:"Cantidad",minWidth:150},{id:"concepto",label:"Concepto",minWidth:150},{id:"tipo",label:"Tipo Movimiento",minWidth:100}],_u=Object(k.a)((function(e){return{root:{width:"100%",height:"50vh"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},formComboBox:{height:"50%"},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}}})),vu=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Cu(e){var t,a=e.cuenta,n=e.tipo,c=JSON.parse(localStorage.getItem("sesionCafi"));xt.a.locale("es");var r=_u(),i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)([]),p=Object(v.a)(j,2),m=p[0],O=p[1],x=Object(ha.useDebounce)(m,500),f=Object(v.a)(x,1)[0],g=function(){d(!l),O([]),k()},_=Object(He.a)(Ou,{variables:{input:{fecha_inicio:m.fecha_inicio?m.fecha_inicio:"",fecha_fin:m.fecha_fin?m.fecha_fin:"",usuario:f.usuario?f.usuario:"",tipo_movimiento:m.tipo_movimiento?m.tipo_movimiento:""},empresa:c.empresa._id,sucursal:a._id,tipo:n}}),C=_.data,I=(_.error,_.loading),k=_.refetch,N=[];C&&(N=C.obtenerHistorialCuenta);var F=function(e){O(Object(u.a)(Object(u.a)({},m),{},Object(h.a)({},e.target.name,e.target.value)))};return Object(s.useEffect)((function(){k()}),[k]),Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(w.a,{color:"primary",onClick:g,size:"small",endIcon:Object(V.jsx)(Q.a,{style:{fontSize:35}}),children:"Ver"})}),Object(V.jsxs)(ze.a,{open:l,TransitionComponent:vu,maxWidth:"lg",fullWidth:!0,children:[Object(V.jsx)(b.a,{m:1,display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:g,size:"large",children:Object(V.jsx)($e.a,{})})}),Object(V.jsxs)(Pe.a,{children:[Object(V.jsx)(b.a,{textAlign:"center",p:1,children:Object(V.jsx)(y.a,{variant:"h6",children:"Historial de cuenta"})}),Object(V.jsx)(b.a,{children:Object(V.jsxs)("div",{className:r.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha inicio:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",type:"date",name:"fecha_inicio",onChange:F,variant:"outlined"})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha fin:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",type:"date",onChange:F,name:"fecha_fin",variant:"outlined"})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Usuario:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",onChange:F,name:"usuario",variant:"outlined"})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Tipo Movimiento:"}),Object(V.jsxs)(De.a,{className:r.formComboBox,size:"small",variant:"outlined",name:"tipo_movimiento",onChange:F,fullWidth:!0,children:[Object(V.jsx)(Ee.a,{value:"TODOS",children:"Ninguno"}),Object(V.jsx)(Ee.a,{value:"CUENTA-DEPOSITO",children:"Deposito"}),Object(V.jsx)(Ee.a,{value:"CUENTA-RETIRO",children:"Retiro"})]})]})]})}),Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(Da.a,{className:r.root,children:Object(V.jsx)(ra.a,{className:r.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:gu.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{children:null===(t=N)||void 0===t?void 0:t.map((function(e,t){return Object(V.jsx)(yu,{row:e,loading:I},t)}))})]})})})})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{color:"secondary",variant:"outlined",onClick:g,size:"large",children:"Cancelar"})})]})]})}function yu(e){var t=e.row;return e.loading?Object(V.jsx)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",handleClickOpen:!0,tabIndex:-1,children:[Object(V.jsxs)(sa.a,{children:["Caja ",""!==t.numero_caja?t.numero_caja:""]}),Object(V.jsx)(sa.a,{children:xt()(null===t||void 0===t?void 0:t.fecha_movimiento.completa).format("D MMMM YYYY")}),Object(V.jsx)(sa.a,{children:null===t||void 0===t?void 0:t.nombre_usuario_creador}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{style:{fontSize:17},children:["$",Ze(t.montos_en_caja.monto_efectivo.monto)]})}),Object(V.jsx)(sa.a,{children:null===t||void 0===t?void 0:t.concepto}),Object(V.jsx)(sa.a,{children:"CUENTA-DEPOSITO"===(null===t||void 0===t?void 0:t.tipo_movimiento)?"DEPOSITO":"RETIRO"})]})}var Su=[{id:"name",label:"Origen",minWidth:150,align:"left"},{id:"tipo",label:"Tipo Cuenta",minWidth:150,align:"left"},{id:"dinero",label:"Dinero Existencia",minWidth:100,align:"left"},{id:"movimiento",label:"Realizar Movimiento",minWidth:100,align:"center"},{id:"historial",label:"Historial",minWidth:100,align:"center"}],wu=Object(k.a)((function(e){return{root:{width:"100%",height:"50vh"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function Iu(){var e,t,a,n,c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(He.a)(pu,{variables:{id:c.empresa._id}}),i=r.data,o=(r.error,r.loading),s=r.refetch,l=Object(He.a)(Ye,{variables:{id:c.empresa._id}}),d=wu(),j=[],u=[];return l.data&&(u=l.data.obtenerEmpresa),i&&(j=i.obtenerSucursalesEmpresa),o&&l.loading?Object(V.jsx)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"50vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(Da.a,{className:d.root,children:Object(V.jsx)(ra.a,{className:d.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:Su.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsxs)(la.a,{children:[Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",handleClickOpen:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:null===(e=u)||void 0===e?void 0:e.nombre_empresa}),Object(V.jsx)(sa.a,{children:"CUENTA PRINCIPAL"}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{style:{fontSize:17},children:["$",Ze(null===(t=u)||void 0===t||null===(a=t.cuenta_empresa)||void 0===a?void 0:a.dinero_actual)]})}),!1===c.accesos.tesoreria.cuentas_empresa.editar?Object(V.jsx)(sa.a,{align:"center",children:"  "}):Object(V.jsxs)(sa.a,{align:"center",children:[" ",Object(V.jsx)(fu,{cuenta:u,refetch:l.refetch,tipo:!0})," "]}),Object(V.jsxs)(sa.a,{align:"center",children:[" ",Object(V.jsx)(Cu,{cuenta:u,tipo:!0})," "]})]}),null===(n=j)||void 0===n?void 0:n.map((function(e,t){return Object(V.jsx)(ku,{refetch:s,cuenta:e,loading:o},t)}))]})]})})})})}function ku(e){var t,a=e.cuenta,n=e.refetch,c=JSON.parse(localStorage.getItem("sesionCafi"));return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",handleClickOpen:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:a.nombre_sucursal}),Object(V.jsx)(sa.a,{children:"SUCURSAL"}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{style:{fontSize:17},children:["$",Ze(null===a||void 0===a||null===(t=a.cuenta_sucursal)||void 0===t?void 0:t.dinero_actual)]})}),!1===c.accesos.tesoreria.cuentas_empresa.editar?Object(V.jsx)(sa.a,{align:"center",children:"  "}):Object(V.jsxs)(sa.a,{align:"center",children:[" ",Object(V.jsx)(fu,{cuenta:a,refetch:n,tipo:!1})," "]}),Object(V.jsxs)(sa.a,{align:"center",children:[" ",Object(V.jsx)(Cu,{cuenta:a,tipo:!1})," "]})]})}var Nu,Fu,zu=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},buttons:{"& > *":{margin:"0px ".concat(e.spacing(1),"px")}}}})),Pu=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Du(){var e=zu(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){return c(!n)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:r,children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/retiro-de-dinero.svg",alt:"icono retiro",className:e.icon})}),"Cuentas de Empresa"]})}),Object(V.jsxs)(ze.a,{open:n,TransitionComponent:Pu,maxWidth:"lg",fullWidth:!0,children:[Object(V.jsx)(b.a,{m:1,display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{})})}),Object(V.jsxs)(Pe.a,{children:[Object(V.jsx)(b.a,{textAlign:"center",children:Object(V.jsx)(y.a,{variant:"h6",children:"Cuentas de empresa"})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(Iu,{})})]})]})]})}var Eu=Object(z.d)(Nu||(Nu=Object(F.a)(["\n    query ObtenerHistorialEgresos($input: ObtenerHistorialEgresosInput, $empresa: ID!, $sucursal: ID!){\n        obtenerHistorialEgresos(input: $input, empresa: $empresa, sucursal: $sucursal){\n            folio_egreso\n            folio_factura\n            empresa_distribuidora\n            provedor\n            productos {\n                cantidad_productos\n                precio_unitario\n                producto\n                total\n            }\n            categoria\n            subCategoria\n            metodo_pago\n            fecha_compra\n            fecha_registro\n            fecha_vencimiento\n            observaciones\n            compra_credito\n            credito_pagado\n            saldo_credito_pendiente\n            saldo_total\n            numero_usuario_creador\n            nombre_usuario_creador\n            id_user\n            empresa\n            sucursal         \n        }\n    }\n"]))),Au=Object(z.d)(Fu||(Fu=Object(F.a)(["\n    mutation CrearEgreso($input: CrearEgresosInput, $empresa: ID!, $sucursal: ID!){\n        crearEgreso(input: $input, empresa: $empresa, sucursal: $sucursal){\n            message\n        }\n    }\n"]))),Tu=a(82),Wu=a.n(Tu),Ru=[{id:"cantidad",label:"Cantidad",minWidth:100},{id:"nombre",label:"Nombre",minWidth:100},{id:"precioU",label:"Precio Unitario",minWidth:100},{id:"total",label:"Total",minWidth:100}],$u=Object(k.a)((function(e){return{root:{width:"100%"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(1),flex:1},table:{minWidth:650}}}));function Mu(e){var t=e.productos,a=e.borrarProducto,n=$u(),c=Object(s.useState)(0),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)(3),d=Object(v.a)(l,2),j=d[0],u=d[1];return Object(V.jsxs)(Da.a,{className:n.root,children:[Object(V.jsx)(ra.a,{className:n.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,className:n.table,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Ru.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)})),Object(V.jsx)(sa.a,{align:"center",style:{minWidth:100},children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:t.slice(i*j,i*j+j).map((function(e,t){return Object(V.jsx)(Lu,{index:t,producto:e,borrarProducto:a})}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[],component:"div",count:t.length,rowsPerPage:j,page:i,onPageChange:function(e,t){o(t)},onRowsPerPageChange:function(e){u(+e.target.value),o(0)}})]})}function Lu(e){var t=e.index,a=e.producto,n=e.borrarProducto;return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:null===a||void 0===a?void 0:a.cantidad_productos}),Object(V.jsx)(sa.a,{children:null===a||void 0===a?void 0:a.producto}),Object(V.jsxs)(sa.a,{children:["$",Ze(null===a||void 0===a?void 0:a.precio_unitario)]}),Object(V.jsxs)(sa.a,{children:["$",Ze(null===a||void 0===a?void 0:a.total)]}),Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)(X.a,{"aria-label":"delete",size:"small",onClick:function(){return n(t)},children:Object(V.jsx)(Wu.a,{fontSize:"medium"})})})]})}var Vu=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(0),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},formComboBox:{height:"50%"},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}}}}));function Uu(e){e.tipo;var t,a=e.handleClickOpen,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(s.useContext)(du).setAlert,r=Object(N.a)(Au),i=Object(v.a)(r,1)[0],o=Vu(),l=Object(s.useState)(!1),d=Object(v.a)(l,2),j=d[0],p=d[1],m=Object(s.useState)([]),O=Object(v.a)(m,2),x=O[0],f=O[1],C=Object(s.useState)(0),I=Object(v.a)(C,2),k=I[0],F=I[1],z=Object(s.useState)([]),P=Object(v.a)(z,2),D=P[0],E=P[1],A=Object(s.useState)([]),T=Object(v.a)(A,2),W=T[0],R=T[1],$=Object(s.useState)([]),M=Object(v.a)($,2),L=M[0],U=M[1],B=Object(He.a)(Wr,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id}}),J=[];B.data&&(J=B.data.obtenerCuentas);var q=function(e){f(Object(u.a)(Object(u.a)({},x),{},Object(h.a)({},e.target.name,e.target.value)))},K=function(e){R(Object(u.a)(Object(u.a)({},W),{},Object(h.a)({},e.target.name,e.target.value)))};Object(s.useEffect)((function(){Q(),U(L),p(!1)}),[j,L]);var Q=function(){for(var e=0,t=0;t<L.length;t++)e+=L[t].total;F(e)},Z={folio_egreso:x.folio_egreso,folio_factura:x.folio_factura,empresa_distribuidora:x.empresa_distribuidora,provedor:x.provedor,productos:x.productos?x.productos:[],categoria:x.categoria,subCategoria:x.subCategoria,metodo_pago:x.metodo_pago,fecha_compra:x.fecha_compra,fecha_vencimiento:x.fecha_vencimiento0?x.fecha_vencimiento:"",observaciones:x.observaciones,compra_credito:!!x.compra_credito&&x.compra_credito,credito_pagado:!!x.credito_pagado&&x.credito_pagado,saldo_credito_pendiente:x.saldo_credito_pendiente?x.saldo_credito_pendiente:0,numero_usuario_creador:n.numero_usuario.toString(),nombre_usuario_creador:n.nombre,id_user:n._id,saldo_total:k||0},ee=function(){var e=Object(_.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,x.folio_egreso){e.next=4;break}return c({message:"Por favor genere un folio.",status:"error",open:!0}),e.abrupt("return",null);case 4:return e.next=7,i({variables:{input:Z,empresa:n.empresa._id,sucursal:n.sucursal._id}});case 7:t=e.sent,a(),f([]),c({message:t.data.crearEgreso.message,status:"success",open:!0}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),c({message:e.t0.message,status:"error",open:!0});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(b.a,{p:1,children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Datos Generales"})})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)("div",{className:o.formInputFlex,children:[Object(V.jsx)(b.a,{width:"100%",children:Object(V.jsxs)(G.a,{variant:"outlined",size:"small",name:"folio_egreso",fullWidth:!0,children:[Object(V.jsx)(y.a,{children:"Folio"}),Object(V.jsx)(H.a,{style:{padding:0},id:"form-producto-codigo-barras",name:"folio_egreso",value:x.folio_egreso?x.folio_egreso:"",onChange:q,endAdornment:Object(V.jsx)(Y.a,{position:"start",children:Object(V.jsx)(X.a,{onClick:function(){return function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();f(Object(u.a)(Object(u.a)({},x),{},{folio_egreso:t}))}()},color:"primary",size:"small",children:Object(V.jsx)(bc.a,{})})})})]})}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"ID Factura:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"id_factura",variant:"outlined",onChange:q})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha de Compra:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_compra",variant:"outlined",onChange:q,type:"date",InputLabelProps:{shrink:!0}})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Metodo de pago:"}),Object(V.jsxs)(De.a,{className:o.formComboBox,size:"small",variant:"outlined",onChange:q,name:"metodo_pago",fullWidth:!0,children:[Object(V.jsx)(Ee.a,{value:"TARJETA",children:"Tarjeta"}),Object(V.jsx)(Ee.a,{value:"EFECTIVO",children:"Efectivo"}),Object(V.jsx)(Ee.a,{value:"CHEQUE",children:"Cheque"}),Object(V.jsx)(Ee.a,{value:"TRANSFERENCIA",children:"Transferencia"}),Object(V.jsx)(Ee.a,{value:"MONEDERO ELECTRONICO",children:"Monedero electronico"})]})]})]}),Object(V.jsxs)("div",{className:o.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Categoria:"}),Object(V.jsxs)(De.a,{className:o.formComboBox,size:"small",variant:"outlined",onChange:q,name:"categoria",fullWidth:!0,children:[Object(V.jsx)(Ee.a,{value:"Ninguno",onClick:function(){return E([])},children:"Ninguno"}),null===(t=J)||void 0===t?void 0:t.map((function(e){return Object(V.jsx)(Ee.a,{onClick:function(){return function(e){E(e.subcuentas)}(e)},value:e.cuenta,children:e.cuenta},e._id)}))]})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"SubCatergoria:"}),Object(V.jsxs)(De.a,{className:o.formComboBox,size:"small",variant:"outlined",onChange:q,name:"subCategoria",fullWidth:!0,children:[Object(V.jsx)(Ee.a,{value:"Ninguno",children:"Ninguno"}),null===D||void 0===D?void 0:D.map((function(e){return Object(V.jsx)(Ee.a,{value:e.subcuenta,children:e.subcuenta})}))]})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Empresa:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"empresa_distribuidora",onChange:q,variant:"outlined"})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Provedor: "}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"provedor",onChange:q,variant:"outlined"})]})]}),Object(V.jsxs)(b.a,{p:1,mt:1,children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Productos Adquiridos"})})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)("div",{className:o.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Cantidad:"}),Object(V.jsx)(S.a,{fullWidth:!0,className:o.input,size:"small",name:"cantidad_productos",value:W.cantidad_productos?W.cantidad_productos:"",onChange:K,variant:"outlined",type:"number"})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Producto:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"producto",value:W.producto?W.producto:"",onChange:K,variant:"outlined"})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Precio Unitario:"}),Object(V.jsx)(S.a,{className:o.input,fullWidth:!0,size:"small",name:"precio_unitario",value:W.precio_unitario?W.precio_unitario:"",onChange:K,variant:"outlined",type:"number"})]}),Object(V.jsx)(b.a,{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(w.a,{variant:"outlined",size:"large",color:"primary",onClick:function(){var e={cantidad_productos:parseFloat(W.cantidad_productos),precio_unitario:parseFloat(W.precio_unitario),producto:W.producto,total:parseFloat(W.cantidad_productos)*parseFloat(W.precio_unitario)};L.push(e),f(Object(u.a)(Object(u.a)({},x),{},{productos:L})),Q(),R([])},startIcon:Object(V.jsx)(En.a,{}),children:"Agregar"})})]}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(Mu,{productos:L,borrarProducto:function(e){L.forEach((function(t,a,n){e===a&&L.splice(e,1)})),p(!0)}})}),Object(V.jsx)(b.a,{display:"flex",justifyContent:"flex-end",p:1,children:Object(V.jsxs)(y.a,{variant:"h6",children:["Total: $",Ze(k)]})}),Object(V.jsx)("div",{className:o.formInputFlex,children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Observaci\xf3nes:"}),Object(V.jsx)(S.a,{multiline:!0,rows:2,fullWidth:!0,size:"small",name:"observaciones",onChange:q,variant:"outlined"})]})}),Object(V.jsxs)(b.a,{display:"flex",justifyContent:"flex-end",children:[Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(w.a,{size:"large",variant:"contained",color:"primary",onClick:ee,children:"Guardar Egreso"})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(w.a,{size:"large",variant:"contained",color:"secondary",children:"Cancelar"})})]})]})}var Bu=["children","value","index"];function Ju(e){var t=e.children,a=e.value,n=e.index,c=Object(fe.a)(e,Bu);return Object(V.jsx)("div",Object(u.a)(Object(u.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(V.jsx)(b.a,{p:3,minHeight:"70vh",children:t})}))}var Gu=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper},iconSvg:{width:50},iconSize:{fontSize:40,color:e.palette.info.main},buttons:{"& > *":{margin:"0px ".concat(e.spacing(1),"px")}}}}));function qu(e){var t,a=e.handleClickOpen,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Gu(),r=(Object(s.useContext)(du).setAlert,Object(s.useState)(0)),i=Object(v.a)(r,2),o=i[0],l=i[1];return Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)("div",{className:c.root,children:[Object(V.jsx)(Se.a,{position:"static",color:"default",elevation:0,children:Object(V.jsxs)(we.a,{value:o,onChange:function(e,t){l(t)},variant:"scrollable",scrollButtons:"on",textColor:"primary",indicatorColor:"primary","aria-label":"scrollable force tabs example",children:[Object(V.jsx)(Ie.a,Object(u.a)({label:"Egreso a Contado",icon:Object(V.jsx)(Ce.f,{className:c.iconSize})},(t=0,{id:"reg-product-tab-".concat(t),"aria-controls":"tabpanel-reg-product-".concat(t)}))),Object(V.jsx)(Fe.a,{container:!0,justify:"flex-end",children:Object(V.jsxs)(b.a,{mt:4,children:[Object(V.jsxs)(y.a,{children:["Usuario: ",Object(V.jsx)("b",{children:n.nombre})]}),Object(V.jsx)(b.a,{children:Object(V.jsx)("b",{children:xt()().format("D MMMM YYYY")})})]})}),Object(V.jsx)(Fe.a,{children:Object(V.jsx)(b.a,{mt:3,ml:5,display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:a,size:"large",children:Object(V.jsx)($e.a,{})})})})]})}),Object(V.jsx)(Ju,{value:o,index:0,children:Object(V.jsx)(Uu,{handleClickOpen:a,tipo:"CONTADO"})})]})})}var Hu=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},root:{flexGrow:1,width:"100%",height:"100vh",backgroundColor:e.palette.background.paper},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)},iconSize:{fontSize:40,color:e.palette.info.main},iconSizeSecond:{width:40}}})),Yu=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Xu(){var e=Hu(),t=Object(s.useState)(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){return c(!n)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:r,children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/income.svg",alt:"icono egreso",className:e.icon})}),"Egresos"]})}),Object(V.jsx)(ze.a,{open:n,TransitionComponent:Yu,fullWidth:!0,maxWidth:"lg",children:Object(V.jsx)(qu,{handleClickOpen:r})})]})}var Ku,Qu,Zu=[{id:"cantidad",label:"Cantidad",minWidth:80},{id:"cantidadR",label:"Cant. Regalo",minWidth:80},{id:"nombre",label:"Producto",minWidth:80},{id:"precio",label:"Precio",minWidth:80},{id:"total",label:"Total",minWidth:80}],eb=Object(k.a)((function(e){return{root:{width:"100%",height:"45vh"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}));function tb(e){var t=e.productos,a=eb();return Object(V.jsx)(Da.a,{className:a.root,children:Object(V.jsx)(ra.a,{className:a.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:Zu.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{children:null===t||void 0===t?void 0:t.map((function(e,t){return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:e.cantidad}),Object(V.jsx)(sa.a,{children:e.cantidad_regalo}),Object(V.jsx)(sa.a,{children:e.producto.datos_generales.nombre_comercial}),Object(V.jsx)(sa.a,{children:e.costo}),Object(V.jsx)(sa.a,{children:e.total})]},t)}))})]})})})}var ab=Object(z.d)(Ku||(Ku=Object(F.a)(["\n    query ObtenerHistorialAbonos($empresa: ID!, $sucursal: ID!, $input: ObtenerHistorialAbonosInput){\n        obtenerHistorialAbonos( empresa: $empresa, sucursal: $sucursal, input: $input ){\n            numero_caja\n            id_Caja\n            horario_turno\n            tipo_movimiento\n            rol_movimiento\n            fecha_movimiento{\n                completa\n            }\n            numero_usuario_creador\n            nombre_usuario_creador\n            monto_total_abonado\n            numero_cliente\n            nombre_cliente\n            telefono_cliente\n            email_cliente\n            montos_en_caja{\n                monto_efectivo{\n                    monto \n                }\n                monto_tarjeta_credito{\n                    monto \n                }\n                monto_tarjeta_debito{\n                    monto \n                }\n                monto_creditos{\n                    monto \n                }\n                monto_monedero{\n                    monto \n                }\n                monto_transferencia{\n                    monto \n                }\n                monto_cheques{\n                    monto \n                }\n                monto_vales_despensa{\n                    monto \n                }\n            }\n        }\n    }\n"]))),nb=Object(z.d)(Qu||(Qu=Object(F.a)(["\n    mutation CrearAbono($empresa: ID!, $sucursal: ID!, $input: CrearAbonoInput){\n        crearAbono(empresa: $empresa, sucursal: $sucursal, input: $input, ){\n            message\n        }\n    }\n"]))),cb=[{id:"fecha",label:"Fecha de abono",minWidth:170,align:"center"},{id:"cliente",label:"Nombre",minWidth:170,align:"center"},{id:"abono",label:"Cantidad abonada",minWidth:170,align:"right"}],rb=Object(k.a)((function(e){return{root:{width:"100%",height:"45vh"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}));function ib(e){var t,a=e.cuenta,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(s.useContext)(du).reload,r=rb(),i=Object(He.a)(ab,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id,input:{fecha_inicio:"",fecha_fin:"",usuario:"",id_cliente:a.proveedor.id_proveedor._id,id_egreso:"",rol_movimiento:"PROVEEDOR",id_compra:a._id}},fetchPolicy:"network-only"}),o=(i.loading,i.data),l=(i.error,i.refetch),d=[];return o&&(d=o.obtenerHistorialAbonos),Object(s.useEffect)((function(){l()}),[c]),Object(V.jsx)(Da.a,{className:r.root,children:Object(V.jsx)(ra.a,{className:r.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:cb.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{children:null===(t=d)||void 0===t?void 0:t.map((function(e,t){return Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:xt()(e.fecha_movimiento.completa).format("D MMMM YYYY")}),Object(V.jsx)(sa.a,{align:"center",children:e.nombre_cliente}),Object(V.jsx)(sa.a,{align:"right",children:Object(V.jsxs)("b",{children:["$",e.monto_total_abonado]})})]},t)}))})]})})})}var ob=a(458),sb=a.n(ob),lb=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),db=Object(k.a)((function(e){return{input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(.5),"px")},"& .obligatorio":{color:"red"},paddingTop:0,alignItems:"center",justifyItems:"center"}}}));function jb(e){var t=e.cuenta,a=Object(N.a)(nb),n=Object(v.a)(a,1)[0],c=Object(s.useContext)(du),r=c.setReload,i=c.setAlert,o=JSON.parse(localStorage.getItem("sesionCafi")),l=db(),d=Object(s.useState)(!1),j=Object(v.a)(d,2),u=j[0],p=j[1],m=Object(s.useState)(!1),O=Object(v.a)(m,2),x=O[0],h=O[1],f=Object(s.useState)(""),C=Object(v.a)(f,2),I=C[0],k=C[1],F=Object(s.useState)(""),z=Object(v.a)(F,2),P=z[0],D=z[1],E={tipo_movimiento:"ABONO",rol_movimiento:"PROVEEDOR",fecha_movimiento:{year:xt()().format("YYYY"),mes:xt()().format("MM"),dia:xt()().format("DD"),no_semana_year:xt()().week().toString(),no_dia_year:xt()().dayOfYear().toString(),completa:xt()().locale("es-mx").format()},monto_total_abonado:parseFloat(I),montos_en_caja:{monto_efectivo:{monto:"01"===P?parseFloat(I):0,metodo_pago:"01"},monto_tarjeta_debito:{monto:"28"===P?parseFloat(I):0,metodo_pago:"28"},monto_tarjeta_credito:{monto:"04"===P?parseFloat(I):0,metodo_pago:"04"},monto_creditos:{monto:"99"===P?parseFloat(I):0,metodo_pago:"99"},monto_monedero:{monto:"05"===P?parseFloat(I):0,metodo_pago:"05"},monto_transferencia:{monto:"03"===P?parseFloat(I):0,metodo_pago:"03"},monto_cheques:{monto:"02"===P?parseFloat(I):0,metodo_pago:"02"},monto_vales_despensa:{monto:"08"===P?parseFloat(I):0,metodo_pago:"08"}},metodo_de_pago:{clave:"",metodo:""},id_usuario:o._id,numero_usuario_creador:o.numero_usuario,nombre_usuario_creador:o.nombre,id_cliente:t.proveedor.id_proveedor._id,numero_cliente:t.proveedor.numero_cliente,nombre_cliente:t.proveedor.nombre_cliente,telefono_cliente:t.proveedor.id_proveedor.telefono,email_cliente:t.proveedor.id_proveedor.email,id_compra:t._id},A=function(){var e=Object(_.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h(!0),e.prev=1,""!==I&&""!==P){e.next=6;break}return i({message:"Por favor complete los datos",status:"error",open:!0}),h(!1),e.abrupt("return");case 6:return e.next=9,n({variables:{empresa:o.empresa._id,sucursal:o.sucursal._id,input:E}});case 9:r(!0),k(""),D(""),i({message:"Abono registrado con exito",status:"success",open:!0}),T(),h(!1),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(1),T(),h(!1),i({message:"Ocurrio un problema en el servidor",status:"error",open:!0});case 22:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(){return e.apply(this,arguments)}}(),T=function(){r(!0),p(!u)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{size:"large",variant:"outlined",fullWidth:!0,color:"primary",startIcon:Object(V.jsx)(sb.a,{style:{fontSize:35}}),onClick:T,children:Object(V.jsx)(y.a,{variant:"h6",children:"Abonar"})}),Object(V.jsxs)(ze.a,{open:u,TransitionComponent:lb,keepMounted:!0,onClose:T,fullWidth:!0,maxWidth:"xs",children:[Object(V.jsx)(Ve,{loading:x,setLoading:h}),Object(V.jsx)(wt.a,{id:"alert-dialog-slide-title",children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{p:1,flexGrow:1,children:"Registrar nuevo abono"}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:T,size:"large",children:Object(V.jsx)($e.a,{})})})]})}),Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(b.a,{width:"100%",mt:2,children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Cantidad a abonar:"})}),Object(V.jsx)(S.a,{fullWidth:!0,className:l.input,onChange:function(e){return k(e.target.value)},value:I,size:"small",name:"abono_recibir",variant:"outlined",type:"number"})]}),Object(V.jsx)("div",{className:l.formInputFlex,children:Object(V.jsxs)(b.a,{width:"100%",mt:2,children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Metodo de pago:"})}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{width:"100%",name:"metodo_pago",variant:"outlined",value:P||"",onChange:function(e){return D(e.target.value)},children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),_t.map((function(e,t){return Object(V.jsx)(Ee.a,{value:e.Value,children:e.Name},t)}))]})})]})}),Object(V.jsxs)(b.a,{width:"100%",mt:2,display:"flex",children:[Object(V.jsx)(b.a,{flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Total cuenta"})})}),Object(V.jsx)(y.a,{style:{color:"#9B9B9B"},variant:"h6",children:Object(V.jsxs)("b",{children:["$",Ze(t.total)]})})]}),Object(V.jsxs)(b.a,{width:"100%",display:"flex",children:[Object(V.jsx)(b.a,{flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Total abonado"})})}),Object(V.jsx)(y.a,{style:{color:"green"},variant:"h6",children:Object(V.jsxs)("b",{children:["$",Ze(t.total-t.saldo_credito_pendiente)]})})]}),Object(V.jsxs)(b.a,{width:"100%",display:"flex",children:[Object(V.jsx)(b.a,{flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Total restante"})})}),Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsxs)("b",{children:["$",Ze(t.saldo_credito_pendiente)]})})]})]}),Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignContent:"center",p:2,children:Object(V.jsx)(w.a,{size:"large",variant:"contained",color:"primary",style:{fontSize:18},onClick:A,children:"Registrar Abono"})})]})]})}var ub=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}}}));function bb(e){var t=e.handleClick,a=e.cuenta,n=JSON.parse(localStorage.getItem("sesionCafi")),c=ub();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(Se.a,{className:c.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:c.title,children:"Detalles de cuenta"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:t,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsxs)("div",{className:c.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",p:1,children:[Object(V.jsxs)(b.a,{width:"100%",display:"flex",p:.5,children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Nombre de proveedor: "})," "]}),Object(V.jsx)(y.a,{style:{paddingLeft:5},children:a.proveedor.id_proveedor.nombre_cliente})]}),Object(V.jsxs)(b.a,{width:"100%",display:"flex",p:.5,children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Clave proveedor: "})," "]}),Object(V.jsx)(y.a,{style:{paddingLeft:5},children:a.proveedor.id_proveedor.clave_cliente})]})]}),Object(V.jsxs)(b.a,{width:"100%",p:1,children:[Object(V.jsxs)(b.a,{width:"100%",display:"flex",p:.5,children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Nombre de usuario: "})," "]}),Object(V.jsx)(y.a,{style:{paddingLeft:5},children:a.usuario.nombre})]}),Object(V.jsxs)(b.a,{width:"100%",display:"flex",p:.5,children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Numero usuario: "})," "]}),Object(V.jsx)(y.a,{style:{paddingLeft:5},children:a.usuario.numero_usuario})]})]}),Object(V.jsxs)(b.a,{width:"100%",p:1,children:[Object(V.jsxs)(b.a,{width:"100%",display:"flex",p:.5,children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Fecha compra: "})," "]}),Object(V.jsx)(y.a,{style:{paddingLeft:5},children:xt()(a.fecha_registro).format("D MMMM YYYY")})]}),Object(V.jsxs)(b.a,{width:"100%",display:"flex",p:.5,children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Fecha vencimiento: "})," "]}),Object(V.jsx)(y.a,{style:{paddingLeft:5},children:xt()(a.fecha_vencimiento_credito).format("D MMMM YYYY")})]})]}),!1===n.accesos.tesoreria.abonos_proveedores.editar?null:Object(V.jsx)(b.a,{width:"60%",p:1,display:"flex",alignItems:"center",children:Object(V.jsx)(jb,{cuenta:a})})]}),Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsxs)(Fe.a,{item:!0,lg:6,xs:12,children:[Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(y.a,{variant:"h6",children:"Lista de abonos"})}),Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(ib,{cuenta:a})}),Object(V.jsx)(b.a,{p:1,mr:3,display:"flex",justifyContent:"flex-end",children:Object(V.jsxs)(y.a,{variant:"h6",children:["Total abonado: ",Object(V.jsxs)("b",{style:{color:"#9B9B9B"},children:["$",a.total-a.saldo_credito_pendiente]})]})}),Object(V.jsx)(b.a,{p:1,mr:3,display:"flex",justifyContent:"flex-end",children:Object(V.jsxs)(y.a,{variant:"h6",children:["Restante: ",Object(V.jsxs)("b",{style:{color:"green"},children:["$",Ze(a.saldo_credito_pendiente)]})]})})]}),Object(V.jsxs)(Fe.a,{item:!0,lg:6,xs:12,children:[Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(y.a,{variant:"h6",children:"Lista de compra"})}),Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(tb,{productos:a.productos})}),Object(V.jsx)(b.a,{p:1,mr:3,display:"flex",justifyContent:"flex-end",children:Object(V.jsxs)(y.a,{variant:"h6",children:["Total a liquidar: ",Object(V.jsxs)("b",{style:{color:"red"},children:["$",Ze(a.total)]})]})})]})]})]})}var pb=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},appBar:{position:"relative"}}}));function mb(e){var t=e.cuenta,a=(e.refetch,JSON.parse(localStorage.getItem("sesionCafi"))),n=Object(s.useContext)(du),c=n.setAlert,r=n.setReload,i=Object(N.a)(nb),o=Object(v.a)(i,1)[0],l=Object(s.useState)(!1),d=Object(v.a)(l,2),j=d[0],u=d[1],p=Object(s.useState)(0),m=Object(v.a)(p,2),O=m[0],x=m[1],h=Object(s.useState)(0),f=Object(v.a)(h,2),C=f[0],I=f[1],k=Object(s.useState)(0),F=Object(v.a)(k,2),z=F[0],P=F[1],D=Object(s.useState)(!1),E=Object(v.a)(D,2),A=E[0],T=E[1],W=Object(s.useState)(""),R=Object(v.a)(W,2),$=R[0],M=R[1],L=function(){u(!j),I(0),P(0),x(0)},U=pb();var B={tipo_movimiento:"ABONO",rol_movimiento:"PROVEEDOR",fecha_movimiento:{year:xt()().format("YYYY"),mes:xt()().format("MM"),dia:xt()().format("DD"),no_semana_year:xt()().week().toString(),no_dia_year:xt()().dayOfYear().toString(),completa:xt()().locale("es-mx").format()},monto_total_abonado:parseFloat(t.saldo_credito_pendiente),descuento:{porciento_descuento:O,dinero_descontado:z,total_con_descuento:C},montos_en_caja:{monto_efectivo:{monto:"01"===$?parseFloat(0===C?t.saldo_credito_pendiente:C):0,metodo_pago:"01"},monto_tarjeta_debito:{monto:"28"===$?parseFloat(0===C?t.saldo_credito_pendiente:C):0,metodo_pago:"28"},monto_tarjeta_credito:{monto:"04"===$?parseFloat(0===C?t.saldo_credito_pendiente:C):0,metodo_pago:"04"},monto_creditos:{monto:"99"===$?parseFloat(0===C?t.saldo_credito_pendiente:C):0,metodo_pago:"99"},monto_monedero:{monto:"05"===$?parseFloat(0===C?t.saldo_credito_pendiente:C):0,metodo_pago:"05"},monto_transferencia:{monto:"03"===$?parseFloat(0===C?t.saldo_credito_pendiente:C):0,metodo_pago:"03"},monto_cheques:{monto:"02"===$?parseFloat(0===C?t.saldo_credito_pendiente:C):0,metodo_pago:"02"},monto_vales_despensa:{monto:"08"===$?parseFloat(0===C?t.saldo_credito_pendiente:C):0,metodo_pago:"08"}},metodo_de_pago:{clave:"",metodo:""},numero_usuario_creador:a.numero_usuario,nombre_usuario_creador:a.nombre,id_cliente:t.proveedor.id_proveedor._id,numero_cliente:t.proveedor.numero_cliente,nombre_cliente:t.proveedor.nombre_cliente,telefono_cliente:t.proveedor.id_proveedor.telefono,email_cliente:t.proveedor.id_proveedor.email,id_compra:t._id},J=function(){var e=Object(_.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(T(!0),e.prev=1,""!==$){e.next=6;break}return c({message:"Por favor complete el metodo de pago",status:"error",open:!0}),T(!1),e.abrupt("return");case 6:return e.next=9,o({variables:{empresa:a.empresa._id,sucursal:a.sucursal._id,input:B}});case 9:r(!0),M(""),c({message:"Cuenta liquidada con exito",status:"success",open:!0}),L(),T(!1),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(1),L(),T(!1),c({message:"Ocurrio un problema en el servidor",status:"error",open:!0});case 21:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{size:"medium",variant:"outlined",color:"primary",startIcon:Object(V.jsx)(za.a,{}),onClick:L,children:"Liquidar"}),Object(V.jsxs)(ze.a,{open:j,fullWidth:!0,maxWidth:"xs",onClose:L,"aria-labelledby":"draggable-dialog-title",children:[Object(V.jsx)(Ve,{loading:A,setLoading:T}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{flexGrow:1,p:2,children:Object(V.jsx)(y.a,{variant:"h6",className:U.title,children:"Liquidar Cuenta"})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:L,size:"large",children:Object(V.jsx)($e.a,{})})})]}),Object(V.jsxs)(Pe.a,{children:[Object(V.jsx)(y.a,{children:"Aplica un descuento por pronto pago a tu cuenta"}),Object(V.jsx)(b.a,{mt:1,textAlign:"center",children:Object(V.jsx)(y.a,{id:"discrete-slider-always",gutterBottom:!0,children:Object(V.jsx)("b",{children:"Porcentaje de descuento"})})}),Object(V.jsx)(b.a,{ml:1,mr:1,mb:2,children:Object(V.jsx)(Ns.a,{getAriaValueText:function(e){return"".concat(e)},valueLabelFormat:O.toFixed(2),"aria-labelledby":"discrete-slider-small-steps",valueLabelDisplay:"auto",onChange:function(e,a){x(a);var n=parseFloat((100-a).toFixed(2)),c=parseFloat((t.saldo_credito_pendiente*n/100).toFixed(2)),r=parseFloat((t.saldo_credito_pendiente-c).toFixed(2));I(c),P(r)}})}),Object(V.jsxs)(b.a,{width:"100%",textAlign:"center",children:[Object(V.jsx)(y.a,{id:"discrete-slider-always",gutterBottom:!0,children:Object(V.jsx)("b",{children:"Dinero a liquidar con descuento"})}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"descuento",variant:"outlined",value:C||0,onChange:function(e){var a=parseFloat(e.target.value),n=parseFloat((100*a/t.saldo_credito_pendiente).toFixed(2)),c=parseFloat((t.saldo_credito_pendiente-a).toFixed(2));I(a),P(c),x(n)}})]}),Object(V.jsxs)(b.a,{width:"100%",mt:2,textAlign:"center",children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Metodo de pago:"})}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{width:"100%",name:"metodo_pago",variant:"outlined",onChange:function(e){return M(e.target.value)},children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),_t.map((function(e,t){return Object(V.jsx)(Ee.a,{value:e.Value,children:e.Name},t)}))]})})]}),Object(V.jsxs)(b.a,{display:"flex",mt:2,children:[Object(V.jsx)(b.a,{flexGrow:1,children:Object(V.jsx)(y.a,{children:"Total cuenta: "})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{children:Object(V.jsxs)("b",{children:["$",Ze(t.total)]})})})]}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{flexGrow:1,children:Object(V.jsx)(y.a,{children:"Saldo pendiente: "})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{children:Object(V.jsxs)("b",{children:["$",Ze(t.saldo_credito_pendiente)]})})})]}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{flexGrow:1,children:Object(V.jsx)(y.a,{children:"Dinero Descontado: "})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{children:Object(V.jsxs)("b",{children:["$",Ze(z)]})})})]}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{flexGrow:1,children:Object(V.jsx)(y.a,{children:"Porciento Descontado: "})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{children:Object(V.jsxs)("b",{children:[Ze(O),"%"]})})})]}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{flexGrow:1,children:Object(V.jsx)(y.a,{variant:"h6",children:"Total a pagar:"})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsxs)("b",{style:{color:"green"},children:["$",Ze(0===C?t.saldo_credito_pendiente:C)]})})})]})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:J,color:"primary",variant:"contained",size:"large",children:"Liquidar"})})]})]})}a(102);var Ob=[{id:"fecha",label:"Fecha Compra",minWidth:100,align:"center"},{id:"provedor",label:"Provedor",minWidth:100,align:"center"},{id:"abonado",label:"Abonado",minWidth:100,align:"center"},{id:"restante",label:"Restante",minWidth:100,align:"center"},{id:"total",label:"Total",minWidth:100,align:"center"}],xb=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}})),hb=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function fb(e){var t=e.loading,a=Object(s.useContext)(du).cuentas,n=xb();return t?Object(V.jsx)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"50vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsx)(s.Fragment,{children:Object(V.jsx)("div",{className:n.root,children:Object(V.jsx)(Da.a,{className:n.paper,children:Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{className:n.table,"aria-labelledby":"tableTitle",stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Ob.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)})),Object(V.jsx)(sa.a,{align:"center",style:{minWidth:100},children:"Liquidar"})]})}),Object(V.jsx)(la.a,{children:null===a||void 0===a?void 0:a.map((function(e,a){if(!1===e.credito_pagado)return Object(V.jsx)(gb,{loading:t,cuentaSelect:e},a)}))})]})})})})})}function gb(e){var t=e.cuentaSelect,a=e.loading,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(s.useState)(!1),r=Object(v.a)(c,2),i=r[0],o=r[1],l=function(){o(!i)};return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,onClick:function(e){return function(e){try{clearTimeout(void 0),2===e.detail&&l()}catch(t){}}(e)},children:[Object(V.jsx)(sa.a,{align:"center",children:xt()(t.fecha_registro).format("D MMMM YYYY")}),Object(V.jsx)(sa.a,{align:"center",children:t.proveedor.id_proveedor.nombre_cliente}),Object(V.jsxs)(sa.a,{align:"center",children:["$",Ze(t.total-t.saldo_credito_pendiente)]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",Ze(t.saldo_credito_pendiente)]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",Ze(t.total)]}),!1===n.accesos.tesoreria.abonos_proveedores.editar?Object(V.jsx)(sa.a,{align:"center"}):Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)(mb,{cuenta:t})})]}),Object(V.jsx)(ze.a,{fullScreen:!0,open:i,onClose:l,TransitionComponent:hb,children:Object(V.jsx)(bb,{cuenta:t,loading:a,handleClick:l})})]})}var _b=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},rootSearch:{display:"flex",paddingLeft:e.spacing(2)}}})),vb=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Cb(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(s.useContext)(du),a=t.reload,n=t.setReload,c=t.setCuentas,r=_b(),i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(""),u=Object(v.a)(j,2),p=(u[0],u[1]),m=Object(s.useRef)(null),O=Object(He.a)(Ei,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,fecha:""},fetchPolicy:"network-only"}),x=O.loading,h=O.data,f=(O.error,O.refetch);h&&c(h.obtenerComprasRealizadas),Object(s.useEffect)((function(){f(),n(!1)}),[a,f]);var g=function(){return d(!l)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:g,children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/salary.svg",alt:"icono abono",className:r.icon})}),"Abonos de provedores"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:l,onClose:g,TransitionComponent:vb,children:[Object(V.jsx)(Se.a,{className:r.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:r.title,children:"Abonos a Provedores"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:g,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(b.a,{display:"flex",p:2,children:Object(V.jsx)(b.a,{minWidth:"70%",children:Object(V.jsx)("form",{onSubmit:function(e){return function(e,t){e.preventDefault(),f({filtro:t,fecha:""}),p(t)}(e,e.target[0].value)},children:Object(V.jsx)(S.a,{inputRef:m,fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",InputProps:{endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(X.a,{type:"submit",color:"primary",size:"medium",children:Object(V.jsx)(go.a,{})})})}})})})}),Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(fb,{loading:x,refetch:f})})]})]})}var yb=[{id:"name",label:"Name",minWidth:170},{id:"code",label:"ISO\xa0Code",minWidth:100},{id:"population",label:"Population",minWidth:170,align:"right",format:function(e){return e.toLocaleString("en-US")}},{id:"size",label:"Size\xa0(km\xb2)",minWidth:170,align:"right",format:function(e){return e.toLocaleString("en-US")}},{id:"density",label:"Density",minWidth:170,align:"right",format:function(e){return e.toFixed(2)}}];function Sb(e,t,a,n){return{name:e,code:t,population:a,size:n,density:a/n}}var wb=[Sb("India","IN",1324171354,3287263),Sb("China","CN",1403500365,9596961),Sb("Italy","IT",60483973,301340),Sb("United States","US",327167434,9833520),Sb("Canada","CA",37602103,9984670),Sb("Australia","AU",25475400,7692024),Sb("Germany","DE",83019200,357578),Sb("Ireland","IE",4857e3,70273),Sb("Mexico","MX",126577691,1972550),Sb("Japan","JP",126317e3,377973),Sb("France","FR",67022e3,640679),Sb("United Kingdom","GB",67545757,242495),Sb("Russia","RU",146793744,17098246),Sb("Nigeria","NG",200962417,923768),Sb("Brazil","BR",210147125,8515767)],Ib=Object(k.a)((function(e){return{root:{width:"100%"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}));function kb(){var e=Ib(),t=Object(s.useState)(0),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useState)(5),i=Object(v.a)(r,2),o=i[0],l=i[1];return Object(V.jsxs)(Da.a,{className:e.root,children:[Object(V.jsx)(ra.a,{className:e.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:yb.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{children:wb.slice(n*o,n*o+o).map((function(e){return Object(V.jsx)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:yb.map((function(t){var a=e[t.id];return Object(V.jsx)(sa.a,{align:t.align,children:t.format&&"number"===typeof a?t.format(a):a},t.id)}))},e.code)}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[10,25,100],component:"div",count:wb.length,rowsPerPage:o,page:n,onChangePage:function(e,t){c(t)},onChangeRowsPerPage:function(e){l(+e.target.value),c(0)}})]})}var Nb=[{id:"name",label:"Name",minWidth:170},{id:"code",label:"ISO\xa0Code",minWidth:100},{id:"population",label:"Population",minWidth:170,align:"right",format:function(e){return e.toLocaleString("en-US")}},{id:"size",label:"Size\xa0(km\xb2)",minWidth:170,align:"right",format:function(e){return e.toLocaleString("en-US")}},{id:"density",label:"Density",minWidth:170,align:"right",format:function(e){return e.toFixed(2)}}];function Fb(e,t,a,n){return{name:e,code:t,population:a,size:n,density:a/n}}var zb=[Fb("India","IN",1324171354,3287263),Fb("China","CN",1403500365,9596961),Fb("Italy","IT",60483973,301340),Fb("United States","US",327167434,9833520),Fb("Canada","CA",37602103,9984670),Fb("Australia","AU",25475400,7692024),Fb("Germany","DE",83019200,357578),Fb("Ireland","IE",4857e3,70273),Fb("Mexico","MX",126577691,1972550),Fb("Japan","JP",126317e3,377973),Fb("France","FR",67022e3,640679),Fb("United Kingdom","GB",67545757,242495),Fb("Russia","RU",146793744,17098246),Fb("Nigeria","NG",200962417,923768),Fb("Brazil","BR",210147125,8515767)],Pb=Object(k.a)((function(e){return{root:{width:"100%"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}));function Db(){var e=Pb(),t=Object(s.useState)(0),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useState)(5),i=Object(v.a)(r,2),o=i[0],l=i[1];return Object(V.jsxs)(Da.a,{className:e.root,children:[Object(V.jsx)(ra.a,{className:e.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:Nb.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{children:zb.slice(n*o,n*o+o).map((function(e){return Object(V.jsx)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:Nb.map((function(t){var a=e[t.id];return Object(V.jsx)(sa.a,{align:t.align,children:t.format&&"number"===typeof a?t.format(a):a},t.id)}))},e.code)}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[10,25,100],component:"div",count:zb.length,rowsPerPage:o,page:n,onChangePage:function(e,t){c(t)},onChangeRowsPerPage:function(e){l(+e.target.value),c(0)}})]})}var Eb=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(4),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}})),Ab=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Tb(){var e=Object(s.useState)(!1),t=Object(v.a)(e,2),a=t[0],n=t[1],c=Eb(),r=function(){n(!a)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{size:"medium",variant:"contained",color:"primary",onClick:r,children:"Detalles"}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:a,onClose:r,TransitionComponent:Ab,children:[Object(V.jsx)(Se.a,{className:c.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:c.title,children:"Detalle de cuenta"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsxs)("div",{className:c.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Nombre de Cliente:"}),Object(V.jsx)(b.a,{mt:1,children:Object(V.jsx)(y.a,{children:"Hola mundo"})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha:"}),Object(V.jsx)(b.a,{mt:1,children:Object(V.jsx)(y.a,{children:"Hola mundo"})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Factura:"}),Object(V.jsx)(b.a,{mt:1,children:Object(V.jsx)(y.a,{children:"Hola mundo"})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Empresa:"}),Object(V.jsx)(b.a,{mt:1,children:Object(V.jsx)(y.a,{children:"Hola mundo"})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Domicilio:"}),Object(V.jsx)(b.a,{mt:1,children:Object(V.jsx)(y.a,{children:"Hola mundo"})})]})]}),Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsxs)(Fe.a,{item:!0,lg:6,xs:12,children:[Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(y.a,{variant:"h6",children:"Lista de abonos"})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(Db,{})}),Object(V.jsx)(b.a,{p:1,mr:3,display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(y.a,{children:"Total a abonado: $ 150,000.00"})}),Object(V.jsx)(b.a,{p:1,mr:3,display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(y.a,{children:"Restante: $ 150,000.00"})})]}),Object(V.jsxs)(Fe.a,{item:!0,lg:6,xs:12,children:[Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(y.a,{variant:"h6",children:"Lista de compra"})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(kb,{})}),Object(V.jsx)(b.a,{p:1,mr:3,display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(y.a,{children:"Total a liquidar: $ 150,000.00"})})]})]})]})]})}var Wb=a(939),Rb=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},appBar:{position:"relative"}}}));function $b(){var e=Object(s.useState)(!1),t=Object(v.a)(e,2),a=t[0],n=t[1],c=function(){n(!a)},r=Rb();return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{size:"medium",variant:"contained",color:"primary",onClick:c,children:"Liquidar"}),Object(V.jsxs)(ze.a,{open:a,onClose:c,"aria-labelledby":"draggable-dialog-title",children:[Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",m:1,children:[Object(V.jsx)(y.a,{variant:"h6",className:r.title,children:"Abonos a Proveedores"}),Object(V.jsx)(b.a,{m:1,ml:8,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:c,size:"large",children:Object(V.jsx)($e.a,{})})})]}),Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(b.a,{width:"100%",textAlign:"center",children:[Object(V.jsx)(y.a,{children:"Descuento por pronto pago"}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsxs)(Wb.a,{exclusive:!0,"aria-label":"text alignment",children:[Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"primary",children:"Por decuento"})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"primary",children:"Por pesos"})})]})}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"nombre_comercial",id:"form-producto-nombre-comercial",variant:"outlined",value:"10% o $100.00"})]}),Object(V.jsxs)("div",{className:r.formInputFlex,children:[Object(V.jsx)(b.a,{width:"100%",children:Object(V.jsx)(y.a,{children:"Sub Total: "})}),Object(V.jsx)(b.a,{width:"100%",children:Object(V.jsx)(y.a,{children:"$150000"})})]}),Object(V.jsxs)("div",{className:r.formInputFlex,children:[Object(V.jsx)(b.a,{width:"100%",children:Object(V.jsx)(y.a,{children:"Descuento: "})}),Object(V.jsx)(b.a,{width:"100%",children:Object(V.jsx)(y.a,{children:"$150000"})})]}),Object(V.jsxs)("div",{className:r.formInputFlex,children:[Object(V.jsx)(b.a,{width:"100%",children:Object(V.jsx)(y.a,{children:"Total a pagar:"})}),Object(V.jsx)(b.a,{width:"100%",children:Object(V.jsx)(y.a,{children:"$150000"})})]})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:c,color:"primary",variant:"contained",size:"large",children:"Liquidar"})})]})]})}function Mb(e,t,a,n,c){return{name:e,calories:t,fat:a,carbs:n,protein:c}}var Lb=[Mb("Cupcake",305,3.7,67,4.3),Mb("Donut",452,25,51,4.9),Mb("Eclair",262,16,24,6),Mb("Frozen yoghurt",159,6,24,4),Mb("Gingerbread",356,16,49,3.9),Mb("Honeycomb",408,3.2,87,6.5),Mb("Ice cream sandwich",237,9,37,4.3),Mb("Jelly Bean",375,0,94,0),Mb("KitKat",518,26,65,7),Mb("Lollipop",392,.2,98,0),Mb("Marshmallow",318,0,81,2),Mb("Nougat",360,19,9,37),Mb("Oreo",437,18,63,4)],Vb=[{id:"name",numeric:!1,disablePadding:!0,label:"Cliente"},{id:"calories",numeric:!0,disablePadding:!1,label:"Abondado"},{id:"fat",numeric:!0,disablePadding:!1,label:"Restante"},{id:"abono",numeric:!0,disablePadding:!1,label:"Abono a percibir"},{id:"carbs",numeric:!0,disablePadding:!1,label:"Detalles"},{id:"protein",numeric:!0,disablePadding:!1,label:"Liquidar"}];function Ub(e){var t=e.onSelectAllClick,a=e.numSelected,n=e.rowCount;return Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(na.a,{indeterminate:a>0&&a<n,checked:n>0&&a===n,onChange:t,inputProps:{"aria-label":"select all desserts"}})}),Vb.map((function(e){return Object(V.jsx)(sa.a,{align:e.numeric?"right":"left",padding:e.disablePadding?"none":"default",children:e.label},e.id)}))]})})}var Bb=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function Jb(){var e=Bb(),t=Object(s.useState)([]),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useState)(0),i=Object(v.a)(r,2),o=i[0],l=i[1],d=Object(s.useState)(10),j=Object(v.a)(d,2),u=j[0],b=j[1],p=u-Math.min(u,Lb.length-o*u);return Object(V.jsx)("div",{className:e.root,children:Object(V.jsxs)(Da.a,{className:e.paper,children:[Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{className:e.table,"aria-labelledby":"tableTitle",stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(Ub,{classes:e,numSelected:n.length,onSelectAllClick:function(e){if(e.target.checked){var t=Lb.map((function(e){return e.name}));c(t)}else c([])},rowCount:Lb.length}),Object(V.jsxs)(la.a,{children:[Lb.slice(o*u,o*u+u).map((function(e,t){var a,r=(a=e.name,-1!==n.indexOf(a)),i="enhanced-table-checkbox-".concat(t);return Object(V.jsxs)(oa.a,{hover:!0,onClick:function(t){return function(e,t){var a=n.indexOf(t),r=[];-1===a?r=r.concat(n,t):0===a?r=r.concat(n.slice(1)):a===n.length-1?r=r.concat(n.slice(0,-1)):a>0&&(r=r.concat(n.slice(0,a),n.slice(a+1))),c(r)}(0,e.name)},role:"checkbox","aria-checked":r,tabIndex:-1,selected:r,children:[Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(na.a,{checked:r,inputProps:{"aria-labelledby":i}})}),Object(V.jsx)(sa.a,{component:"th",id:i,scope:"row",padding:"none",children:e.name}),Object(V.jsx)(sa.a,{align:"right",children:e.calories}),Object(V.jsx)(sa.a,{align:"right",children:e.fat}),Object(V.jsx)(sa.a,{align:"right",children:e.carbs}),Object(V.jsx)(sa.a,{align:"right",children:Object(V.jsx)(Tb,{})}),Object(V.jsx)(sa.a,{align:"right",children:Object(V.jsx)($b,{})})]},t)})),p>0&&Object(V.jsx)(oa.a,{style:{height:53*p},children:Object(V.jsx)(sa.a,{colSpan:6})})]})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[],component:"div",count:Lb.length,rowsPerPage:u,page:o,onChangePage:function(e,t){l(t)},onChangeRowsPerPage:function(e){b(parseInt(e.target.value,10)),l(0)}})]})})}var Gb=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function qb(){var e=Object(s.useState)(!1),t=Object(v.a)(e,2),a=t[0],n=t[1],c=function(){n(!a)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{size:"large",variant:"contained",color:"primary",onClick:c,children:"Abonar"}),Object(V.jsxs)(ze.a,{open:a,TransitionComponent:Gb,keepMounted:!0,onClose:c,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description",children:[Object(V.jsx)(wt.a,{id:"alert-dialog-slide-title",children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"flex-start",children:"Abono a recibir por cuenta"}),Object(V.jsx)(b.a,{ml:3,display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:c,size:"large",children:Object(V.jsx)($e.a,{})})})]})}),Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Cuenta No. 2501265"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"nombre_comercial",id:"form-producto-nombre-comercial",variant:"outlined",value:"$150,000.00 Mx"})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Cuenta No. 2501265"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"nombre_comercial",id:"form-producto-nombre-comercial",variant:"outlined",value:"$150,000.00 Mx"})]}),Object(V.jsx)(b.a,{width:"100%",p:1,mt:1,children:Object(V.jsx)(y.a,{children:"Nombre de Cliente: SUTANO"})}),Object(V.jsx)(b.a,{width:"100%",p:1,children:Object(V.jsx)(y.a,{children:"Total a abonar:  $15,100"})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsxs)(yt.a,{severity:"info",children:["Si desea editar el abono del cliente, ",Object(V.jsx)("br",{}),"procure este sea mayor al establecido"]})})]}),Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignContent:"center",p:2,children:Object(V.jsx)(w.a,{size:"large",variant:"contained",color:"primary",style:{fontSize:16},onClick:c,children:"Registrar Abono"})})]})]})}var Hb=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}})),Yb=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Xb(){var e=Hb(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){return c(!n)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:r,children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/salary.svg",alt:"icono abono",className:e.icon})}),"Abonos de Clientes"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Yb,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Abonos de Clientes"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsxs)(b.a,{width:"50%",p:2,children:[Object(V.jsx)(y.a,{children:"Busqueda por cliente o por cuenta"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"nombre_comercial",id:"form-producto-nombre-comercial",variant:"outlined"})]}),Object(V.jsx)(b.a,{mt:5,children:Object(V.jsx)(w.a,{size:"large",variant:"contained",color:"primary",children:"Buscar"})}),Object(V.jsx)(Fe.a,{item:!0,lg:5,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",mt:4,children:Object(V.jsx)(qb,{})})})]}),Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(Jb,{})})]})]})}function Kb(){var e=Object(s.useContext)(du),t=e.alert,a=e.setAlert,n=JSON.parse(localStorage.getItem("sesionCafi"));return Object(V.jsxs)(C.a,{children:[Object(V.jsx)(B,{alert:t,setAlert:a}),Object(V.jsxs)(Fe.a,{container:!0,spacing:2,justify:"center",children:[!1===n.accesos.tesoreria.cuentas_empresa.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Du,{})})}),!1===n.accesos.tesoreria.egresos.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Xu,{})})}),!1===n.accesos.tesoreria.abonos_proveedores.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Cb,{})})}),!1===n.accesos.tesoreria.abonos_clientes.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Xb,{})})})]})]})}function Qb(){return Object(V.jsx)(ju,{children:Object(V.jsx)(Kb,{})})}var Zb=Object(s.createContext)(),ep=function(e){var t=e.children,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(s.useState)({serie:"",currency:"MXN",expedition_place:"",folio:"",cfdi_type:"I",payment_form:"",payment_method:"",logo_url:a.imagen,date:"0",issuer:{FiscalRegime:a.empresa.regimen_fiscal,Rfc:a.empresa.rfc,Name:a.empresa.nombre_fiscal},receiver:{Rfc:"",Name:"",CfdiUse:""},items:[],empresa:a.empresa._id,sucursal:a.sucursal._id}),c=Object(v.a)(n,2),r=c[0],i=c[1],o=Object(s.useState)(null),l=Object(v.a)(o,2),d=l[0],j=l[1],u=Object(s.useState)([]),b=Object(v.a)(u,2),p=b[0],m=b[1],O=Object(s.useState)(!1),x=Object(v.a)(O,2),h=x[0],f=x[1],g=Object(s.useState)(""),_=Object(v.a)(g,2),C=_[0],y=_[1],S=Object(s.useState)({status:!1,message:""}),w=Object(v.a)(S,2),I=w[0],k=w[1];return Object(V.jsx)(Zb.Provider,{value:{datosFactura:r,setDatosFactura:i,cp_valido:h,setCPValido:f,codigo_postal:C,setCodigoPostal:y,error_validation:I,setError:k,venta_factura:d,setVentaFactura:j,productos:p,setProductos:m},children:t})},tp=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function ap(){var e=l.a.useState(!1),t=Object(v.a)(e,2),a=t[0],n=t[1],c=function(e){e.stopPropagation(),n(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{variant:"outlined",color:"primary",onClick:function(e){e.stopPropagation(),n(!0)},children:"Slide in alert dialog"}),Object(V.jsxs)(ze.a,{open:a,TransitionComponent:tp,keepMounted:!0,onClose:c,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description",children:[Object(V.jsx)(wt.a,{id:"alert-dialog-slide-title",children:"Use Google's location service?"}),Object(V.jsx)(Pe.a,{children:Object(V.jsx)(Lt.a,{id:"alert-dialog-slide-description",children:"Let Google help apps determine location. This means sending anonymous location data to Google, even when no apps are running."})}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:c,color:"primary",children:"Disagree"}),Object(V.jsx)(w.a,{onClick:c,color:"primary",children:"Agree"})]})]})]})}var np={folio:"12345",descuento:5.4,ieps:2.5862100000000003,impuestos:6.724146000000001,iva:4.137936000000001,monedero:0,subTotal:23.875854,total:30.6,venta_cliente:!0,montos_en_caja:{monto_efectivo:50,monto_tarjeta:0,monto_creditos:0,monto_monedero:0,monto_transferencia:0,monto_cheques:0,monto_vales_despensa:0},credito:!1,descuento_general_activo:!1,decuento_general:{cantidad_descontado:0,porciento:0,precio_neto:0},dias_de_credito_venta:null,fecha_de_vencimiento_credito:null,fecha_vencimiento_cotizacion:null,cliente:{banco:null,celular:null,clave_cliente:"23233",curp:null,dias_credito:null,direccion:{calle:"Antonio",no_ext:"1",no_int:"1",codigo_postal:"1",colonia:"Antonio",municipio:"1",localidad:"1",estado:"1",pais:"1"},email:"antonio.poday@gmail.com",imagen:null,limite_credito:null,nombre_cliente:"Antonio",numero_cliente:"2323",razon_social:null,rfc:null,telefono:"1212",monedero_electronico:null},productos:[{cantidad:1,cantidad_venta:1,codigo_barras:"226216505720",concepto:"unidades",default:!0,descuento:{cantidad_unidad:null,dinero_descontado:21.59,ieps_precio:0,iva_precio:3.5856,numero_precio:1,porciento:49.07,precio_general:0,precio_neto:25.0453,precio_venta:22.41,unidad_maxima:!1,utilidad:-43.97},descuento_activo:!0,granel_producto:{granel:!1,valor:0},precio_actual_object:{cantidad_unidad:null,dinero_descontado:21.59,ieps_precio:0,iva_precio:3.5856,numero_precio:1,porciento:49.07,precio_general:0,precio_neto:25.0453,precio_venta:22.41,unidad_maxima:!1,utilidad:-43.97},precio_unidad:{cantidad_unidad:null,ieps_precio:0,iva_precio:6.72,numero_precio:5,precio_general:null,precio_neto:48.72,precio_venta:42,unidad_maxima:!1,unidad_mayoreo:0},precio:36,precio_a_vender:30.6,precio_actual_producto:30.6,precio_anterior:36,iva_total_producto:1.03,ieps_total_producto:0,impuestos_total_producto:1.03,subtotal_total_producto:7.22,total_total_producto:36,unidad:"Caja",codigo_unidad:"XBX",unidad_principal:!0,inventario_general:[{cantidad_existente:120,cantidad_existente_maxima:10,unidad_inventario:"Pz",codigo_unidad:null,unidad_maxima:"Caja"}],id_producto:{_id:"61b7bf6e3454b727a0c2e357",datos_generales:{clave_alterna:"COCA",codigo_barras:"226216505720",nombre_comercial:"COCACOLA",tipo_producto:"OTROS",nombre_generico:"COCACOLA",descripcion:null,id_categoria:null,categoria:null,subcategoria:null,id_subcategoria:null,id_departamento:null,departamento:null,id_marca:null,marca:null,receta_farmacia:!1,clave_producto_sat:{Name:"Refrescos",Value:"50202306"}},precios:{ieps:10,ieps_activo:!1,inventario:{inventario_maximo:15,inventario_minimo:5,unidad_de_inventario:"Caja",codigo_unidad:"XBX"},iva:16,iva_activo:!0,monedero:!1,monedero_electronico:0,precio_de_compra:{precio_con_impuesto:180,precio_sin_impuesto:155.1724,iva:24.8276,ieps:0},precios_producto:[{numero_precio:1,precio_neto:8.25,unidad_mayoreo:0,utilidad:10},{numero_precio:2,precio_neto:0,unidad_mayoreo:0,utilidad:0},{numero_precio:3,precio_neto:0,unidad_mayoreo:0,utilidad:0},{numero_precio:4,precio_neto:0,unidad_mayoreo:0,utilidad:0},{numero_precio:5,precio_neto:0,unidad_mayoreo:0,utilidad:0},{numero_precio:6,precio_neto:0,unidad_mayoreo:0,utilidad:0}],unidad_de_compra:{cantidad:24,precio_unitario_con_impuesto:7.5,precio_unitario_sin_impuesto:6.4655,unidad:"Caja",codigo_unidad:"XBX"}}},medida:null,color:null}]},cp=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),rp=Object(k.a)((function(e){return{container:{height:"50vh"}}}));function ip(){var e=Object(s.useState)(!1),t=Object(v.a)(e,2),a=t[0],n=t[1],c=Object(s.useContext)(Zb),r=(c.datosFactura,c.setDatosFactura,c.setVentaFactura),i=c.setProductos,o=function(){return n(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(X.a,{onClick:function(){return n(!0)},size:"small",children:Object(V.jsx)(xc.a,{})}),Object(V.jsxs)(ze.a,{maxWidth:"md",fullWidth:!0,open:a,onClose:function(){return o()},TransitionComponent:cp,children:[Object(V.jsx)(wt.a,{children:"Seleccionar cliente"}),Object(V.jsx)(Pe.a,{children:Object(V.jsx)(op,{})}),Object(V.jsxs)(We.a,{style:{justifyContent:"center"},children:[Object(V.jsx)(w.a,{onClick:function(){o()},children:"Cancelar"}),Object(V.jsx)(w.a,{color:"primary",startIcon:Object(V.jsx)(za.a,{}),onClick:function(){console.log(np),r(np),i(np.productos),o()},children:"Seleccionar"})]})]})]})}var op=function(){var e=rp(),t=Object(s.useState)(""),a=Object(v.a)(t,2),n=a[0],c=(a[1],Object(s.useState)("")),r=Object(v.a)(c,2),i=(r[0],r[1],Object(s.useContext)(Zb)),o=i.datosFactura,l=(i.setDatosFactura,Object(He.a)(Ii,{variables:{tipo:"CLIENTE",filtro:n}})),d=l.loading,j=l.data,p=l.error;if(d)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"55vh",children:Object(V.jsx)(I.a,{})});if(p)return Object(V.jsx)(Je,{});var m=j.obtenerClientes;return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{mb:2,children:Object(V.jsx)(ta.a,{id:"usuarios-factura",size:"small",placeholder:"Buscar por: Numero de cliente, clave o nombre",options:m,getOptionLabel:function(e){return e.nombre_cliente},fullWidth:!0,renderInput:function(e){return Object(V.jsx)(S.a,Object(u.a)(Object(u.a)({},e),{},{variant:"outlined"}))},onChange:function(e,t){return a=t,void console.log(a);var a},getOptionSelected:function(e,t){return e.nombre_cliente===t.nombre_cliente}})}),Object(V.jsx)(Da.a,{variant:"outlined",children:Object(V.jsx)(ra.a,{className:e.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Folio"}),Object(V.jsx)(sa.a,{children:"Cliente"}),Object(V.jsx)(sa.a,{children:"Subtotal"}),Object(V.jsx)(sa.a,{children:"Descuento"}),Object(V.jsx)(sa.a,{children:"Impuestos"}),Object(V.jsx)(sa.a,{children:"Total"}),Object(V.jsx)(sa.a,{children:"Detalles"})]})}),Object(V.jsx)(la.a,{children:m.map((function(e,t){return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:e.nombre_cliente===o.cliente,children:[Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:e.numero_cliente})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:e.clave_cliente})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:e.nombre_cliente})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:e.razon_social})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:e.razon_social})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:e.razon_social})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(ap,{})})]},t)}))})]})})})]})};function sp(){var e=l.a.useState(!1),t=Object(v.a)(e,2),a=t[0],n=t[1],c=l.a.useContext(Zb),r=c.cp_valido,i=c.setCPValido,o=(c.codigo_postal,c.setCodigoPostal),s=c.error_validation,d=l.a.useState(""),j=Object(v.a)(d,2),u=j[0],b=j[1],p=Object(ha.useDebounce)(u,500),m=Object(v.a)(p,1)[0],O=l.a.useCallback(function(){var e=Object(_.a)(g.a.mark((function e(t){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,n(!0),e.next=6,Sc.Catalogs.PostalCodes(t,(function(e){return e}));case 6:(a=e.sent)&&(i(!0),n(!1),o(a[0].Value)),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),n(!1),i(!1),o("");case 15:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),[]);return l.a.useEffect((function(){O(m)}),[m]),Object(V.jsx)(l.a.Fragment,{children:Object(V.jsx)("form",{onSubmit:O,children:Object(V.jsx)(S.a,{fullWidth:!0,name:"expedition_place",size:"small",variant:"outlined",value:u,label:"C\xf3digo postal",onChange:function(e){return b(e.target.value)},InputProps:{endAdornment:Object(V.jsx)(Y.a,{position:"end",children:u?a?Object(V.jsx)(I.a,{size:20}):r?Object(V.jsx)(Go.a,{color:"primary"}):Object(V.jsx)(Qi.a,{color:"error"}):Object(V.jsx)("div",{})})},error:!(!s.status||u)||!!u&&!r,helperText:s.status&&!u?s.message:u?r?"":"Introduce un CP valido":""})})})}var lp=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),dp=Object(k.a)((function(e){return{container:{height:"50vh"}}}));function jp(){var e=Object(s.useState)(!1),t=Object(v.a)(e,2),a=t[0],n=t[1],c=Object(s.useContext)(Zb),r=c.datosFactura,i=c.setDatosFactura,o=function(){return n(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(X.a,{onClick:function(){return n(!0)},size:"small",children:Object(V.jsx)(xc.a,{})}),Object(V.jsxs)(ze.a,{maxWidth:"md",fullWidth:!0,open:a,onClose:function(){return o()},TransitionComponent:lp,children:[Object(V.jsx)(wt.a,{children:"Seleccionar cliente"}),Object(V.jsx)(Pe.a,{children:Object(V.jsx)(up,{})}),Object(V.jsxs)(We.a,{style:{justifyContent:"center"},children:[Object(V.jsx)(w.a,{onClick:function(){o(),i(Object(u.a)(Object(u.a)({},r),{},{receiver:{Rfc:"",Name:"",CfdiUse:""}}))},children:"Cancelar"}),Object(V.jsx)(w.a,{color:"primary",startIcon:Object(V.jsx)(za.a,{}),onClick:function(){return o()},disabled:!r.receiver.Name,children:"Seleccionar"})]})]})]})}var up=function(){var e=dp(),t=Object(s.useState)(""),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useState)(""),i=Object(v.a)(r,2),o=i[0],l=i[1],d=Object(s.useContext)(Zb),j=d.datosFactura,p=d.setDatosFactura,m=Object(He.a)(Ii,{variables:{tipo:"CLIENTE",filtro:n}}),O=m.loading,x=m.data,h=m.error,f=m.refetch;if(O)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"55vh",children:Object(V.jsx)(I.a,{})});if(h)return Object(V.jsx)(Je,{});var g=x.obtenerClientes;return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(b.a,{mb:2,display:"flex",alignItems:"center",children:[Object(V.jsx)(S.a,{fullWidth:!0,size:"small",placeholder:"Buscar por: Numero de cliente, clave o nombre",variant:"outlined",onChange:function(e){return l(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&c(e.target.value)},value:o,InputProps:{endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(X.a,{onClick:function(){return c(o)},children:Object(V.jsx)(xc.a,{})})})}}),Object(V.jsx)(ji,{children:Object(V.jsx)(zi,{tipo:"CLIENTE",accion:"registrar",refetch:f})})]}),Object(V.jsx)(Da.a,{variant:"outlined",children:Object(V.jsx)(ra.a,{className:e.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{minwidth:"100",children:"No. Cliente"}),Object(V.jsx)(sa.a,{minwidth:"100",children:"Clave"}),Object(V.jsx)(sa.a,{minwidth:"150",children:"Nombre"}),Object(V.jsx)(sa.a,{minwidth:"150",children:"Razon Social"})]})}),Object(V.jsx)(la.a,{children:g.map((function(e,t){return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,onClick:function(){return p(Object(u.a)(Object(u.a)({},j),{},{receiver:Object(u.a)(Object(u.a)({},j.receiver),{},{Name:e.nombre_cliente,Rfc:e.rfc})}))},selected:e.nombre_cliente===j.receiver.Name,children:[Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:e.numero_cliente})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:e.clave_cliente})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:e.nombre_cliente})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:e.razon_social})})]},t)}))})]})})})]})};function bp(e){var t=e.serie_default,a=Object(s.useContext)(Zb),n=a.datosFactura,c=a.setDatosFactura,r=a.error_validation;Object(s.useEffect)((function(){var e=t[0],a=e.folio,r=e.serie;c(Object(u.a)(Object(u.a)({},n),{},{folio:a.toString(),serie:r}))}),[]);var i=function(e){var t=e.target,a=t.name,r=t.value;console.log(a,r),c(Object(u.a)(Object(u.a)({},n),{},Object(h.a)({},a,r)))};return Object(V.jsxs)("div",{children:[Object(V.jsxs)(Fe.a,{container:!0,spacing:5,children:[Object(V.jsxs)(Fe.a,{item:!0,md:6,xs:12,children:[Object(V.jsxs)(b.a,{mb:1,children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Emisor: ".concat(n.issuer.Name)})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsxs)(Fe.a,{item:!0,md:4,xs:12,children:[Object(V.jsx)(y.a,{children:"RFC"}),Object(V.jsx)(S.a,{size:"small",variant:"outlined",fullWidth:!0,value:n.issuer.Rfc,disabled:!0,error:r.status&&!n.issuer.Rfc,helperText:r.status&&!n.issuer.Rfc?r.message:""})]}),Object(V.jsxs)(Fe.a,{item:!0,md:4,xs:12,children:[Object(V.jsx)(y.a,{children:"Regimen fiscal"}),Object(V.jsx)(G.a,{fullWidth:!0,size:"small",variant:"outlined",children:Object(V.jsx)(S.a,{size:"small",variant:"outlined",fullWidth:!0,value:n.issuer.FiscalRegime,disabled:!0,error:r.status&&!n.issuer.FiscalRegime,helperText:r.status&&!n.issuer.FiscalRegime?r.message:""})})]})]})]}),Object(V.jsxs)(Fe.a,{item:!0,md:6,xs:12,children:[Object(V.jsxs)(b.a,{mb:1,children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Receptor"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsxs)(Fe.a,{item:!0,md:4,xs:12,children:[Object(V.jsx)(y.a,{children:"Cliente"}),Object(V.jsx)(S.a,{value:n.receiver.Name,placeholder:"Selecciona un cliente",fullWidth:!0,size:"small",variant:"outlined",InputProps:{endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(jp,{})}),readOnly:!0,disabled:!0},error:r.status&&!n.receiver.Name,helperText:r.status&&!n.receiver.Name?r.message:""})]}),Object(V.jsxs)(Fe.a,{item:!0,md:4,xs:12,children:[Object(V.jsx)(y.a,{children:"RFC"}),Object(V.jsx)(S.a,{size:"small",variant:"outlined",fullWidth:!0,value:n.receiver.Rfc,disabled:!0,error:r.status&&!n.receiver.Rfc,helperText:r.status&&!n.receiver.Rfc?r.message:""})]})]})]})]}),Object(V.jsxs)(b.a,{mt:1,mb:2,children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Datos factura"})}),Object(V.jsx)(Te.a,{})]}),Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsx)(Fe.a,{item:!0,xs:12,sm:4,md:3,children:Object(V.jsx)(S.a,{value:n.cliente,placeholder:"Selecciona venta a facturar",fullWidth:!0,size:"small",label:"Folio Venta",variant:"outlined",InputProps:{endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(ip,{})}),readOnly:!0,disabled:!0}})}),Object(V.jsx)(Fe.a,{item:!0,xs:12,sm:4,md:1,children:Object(V.jsx)(S.a,{value:n.folio,label:"Folio",fullWidth:!0,size:"small",variant:"outlined",disabled:!0,error:r.status&&!n.folio,helperText:r.status&&!n.folio?r.message:""})}),Object(V.jsx)(Fe.a,{item:!0,xs:12,sm:4,md:1,children:Object(V.jsx)(S.a,{value:n.serie,label:"Serie",fullWidth:!0,size:"small",variant:"outlined",disabled:!0,error:r.status&&!n.serie,helperText:r.status&&!n.serie?r.message:""})}),Object(V.jsx)(Fe.a,{item:!0,xs:12,sm:4,md:2,children:Object(V.jsxs)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"cfdi_type",error:r.status&&!n.cfdi_type,children:[Object(V.jsx)(q.a,{id:"cfdi_type",children:"Tipo de CFDI"}),Object(V.jsxs)(De.a,{labelId:"cfdi_type",value:n.cfdi_type,name:"cfdi_type",onChange:i,label:"tipo de CFDI",children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),ft.map((function(e,t){return Object(V.jsx)(Ee.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(V.jsx)(ca.a,{children:r.status&&!n.cfdi_type?r.message:""})]})}),Object(V.jsx)(Fe.a,{item:!0,xs:12,sm:4,md:2,children:Object(V.jsxs)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"currency",error:r.status&&!n.currency,children:[Object(V.jsx)(q.a,{id:"moneda",children:"Moneda"}),Object(V.jsxs)(De.a,{labelId:"moneda",value:n.currency,name:"currency",onChange:i,label:"moneda",children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),gt.map((function(e,t){return Object(V.jsx)(Ee.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(V.jsx)(ca.a,{children:r.status&&!n.currency?r.message:""})]})}),Object(V.jsx)(Fe.a,{item:!0,xs:12,sm:4,md:3,children:Object(V.jsx)(sp,{})})]})]})}var pp=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function mp(e){e.venta;var t=e.producto,a=(e.index,Object(s.useState)(!1)),n=Object(v.a)(a,2),c=n[0],r=n[1],i=t.id_producto.datos_generales,o=function(){r(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(X.a,{size:"small",onClick:function(){r(!0)},children:Object(V.jsx)($a.a,{})}),Object(V.jsxs)(ze.a,{open:c,TransitionComponent:pp,keepMounted:!0,onClose:o,fullWidth:!0,maxWidth:"md",children:[Object(V.jsx)(wt.a,{children:i.nombre_comercial}),Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(b.a,{mb:2,children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Impuestos"})})}),Object(V.jsx)(Te.a,{}),Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{padding:"checkbox",children:"Activo"}),Object(V.jsx)(sa.a,{style:{width:50},children:"Base"}),Object(V.jsx)(sa.a,{style:{width:50},children:"Impuesto"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Tasa o Cuota"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Valor Tasa o Cuota"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Importe"})]})}),Object(V.jsxs)(la.a,{children:[Object(V.jsxs)(oa.a,{tabIndex:-1,children:[Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(na.a,{size:"small",name:"iva_activo"})}),Object(V.jsx)(sa.a,{style:{width:50},children:"IVA"}),Object(V.jsx)(sa.a,{style:{width:50},children:"IEPS"}),Object(V.jsx)(sa.a,{style:{width:100},children:Object(V.jsx)(G.a,{fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{children:[Object(V.jsx)(Ee.a,{value:"Tasa",children:"Tasa"}),Object(V.jsx)(Ee.a,{value:"Cuota",children:"Cuota"})]})})}),Object(V.jsx)(sa.a,{style:{width:100},children:"Valor Tasa o Cuota"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Importe"})]}),Object(V.jsxs)(oa.a,{tabIndex:-1,children:[Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(na.a,{size:"small",name:"iva_activo"})}),Object(V.jsx)(sa.a,{style:{width:50},children:"Base"}),Object(V.jsx)(sa.a,{style:{width:50},children:"Impuesto"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Tasa o Cuota"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Valor Tasa o Cuota"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Importe"})]})]})]})})]}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Venta"})})}),Object(V.jsx)(Te.a,{}),Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{style:{width:50},children:"IVA"}),Object(V.jsx)(sa.a,{style:{width:50},children:"IEPS"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Subtotal"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Impuestos"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Total"})]})}),Object(V.jsx)(la.a,{children:Object(V.jsxs)(oa.a,{tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:"% IVA"}),Object(V.jsx)(sa.a,{children:"% IEPS"}),Object(V.jsxs)(sa.a,{children:["$",Ze(t.subtotal_total_producto)]}),Object(V.jsxs)(sa.a,{children:["$",Ze(t.impuestos_total_producto)]}),Object(V.jsxs)(sa.a,{children:["$",Ze(t.total_total_producto)]})]})})]})})]}),Object(V.jsxs)(We.a,{style:{justifyContent:"center"},children:[Object(V.jsx)(w.a,{onClick:o,color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:o,color:"primary",children:"Guardar"})]})]})]})}var Op=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function xp(e){var t=e.venta,a=e.producto,n=e.index,c=Object(s.useState)(!1),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(s.useContext)(Zb),d=l.setVentaFactura,j=l.setProductos,b=l.productos,p=a.id_producto.datos_generales,m=function(){o(!1)},O=function(){var e=Object(_.a)(g.a.mark((function e(){var c,r,i,o,s,l,p,O,x,h,f,_,v,C,y,S,w,I;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object(u.a)({},t),r=Object(ea.a)(b),i=a.cantidad_venta,o=a.granel_producto,s=a.precio_actual_object,l=c.iva,p=c.ieps,O=c.impuestos,x=c.subTotal,h=c.total,f=c.monedero,e.next=6,nt({newP:a,cantidad:i,granel:o,precio_boolean:!0,precio:s});case 6:_=e.sent,console.log(_),v=_.ivaCalculo,C=_.iepsCalculo,y=_.impuestoCalculo,S=_.subtotalCalculo,w=_.totalCalculo,I=_.monederoCalculo,c.iva=l-v,c.ieps=p-C,c.impuestos=O-y,c.subTotal=x-S,c.total=h-w,c.monedero=f-I,r.splice(n,1),d(c),j(r),m();case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{children:[Object(V.jsx)(X.a,{size:"small",onClick:function(){o(!0)},children:Object(V.jsx)(zt.a,{})}),Object(V.jsxs)(ze.a,{open:i,TransitionComponent:Op,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&m()},children:[Object(V.jsx)(wt.a,{children:"\xbfEst\xe1 seguro de eliminar este producto?"}),Object(V.jsx)(Pe.a,{children:Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{style:{width:100},children:"Producto"}),Object(V.jsx)(sa.a,{style:{width:50},children:"Cantidad"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Subtotal"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Impuestos"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Total"})]})}),Object(V.jsx)(la.a,{children:Object(V.jsxs)(oa.a,{tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:p.nombre_comercial}),Object(V.jsx)(sa.a,{children:a.cantidad_venta}),Object(V.jsxs)(sa.a,{children:["$",Ze(a.subtotal_total_producto)]}),Object(V.jsxs)(sa.a,{children:["$",Ze(a.impuestos_total_producto)]}),Object(V.jsxs)(sa.a,{children:["$",Ze(a.total_total_producto)]})]})})]})})}),Object(V.jsxs)(We.a,{style:{justifyContent:"center"},children:[Object(V.jsx)(w.a,{onClick:function(){return m()},color:"inherit",children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){return O()},color:"secondary",children:"Eliminar"})]})]})]})}var hp=Object(k.a)({root:{width:"100%"},container:{height:"36vh"}});function fp(){var e=hp(),t=Object(s.useContext)(Zb),a=t.venta_factura,n=t.productos;return a?(console.log(a),Object(V.jsxs)(Da.a,{className:e.root,variant:"elevation",children:[Object(V.jsx)(b.a,{textAlign:"center",children:Object(V.jsx)(y.a,{variant:"button",children:"Detalles de Venta"})}),Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{style:{width:250},children:"Folio"}),Object(V.jsx)(sa.a,{style:{width:50},children:"Descuento"}),Object(V.jsx)(sa.a,{style:{width:50},children:"IVA"}),Object(V.jsx)(sa.a,{style:{width:50},children:"IEPS"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Subtotal"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Impuestos"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Total"}),Object(V.jsx)(sa.a,{style:{width:50},children:"Usuario"}),Object(V.jsx)(sa.a,{style:{width:50},children:"Caja"})]})}),Object(V.jsx)(la.a,{children:Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(V.jsx)(sa.a,{style:{width:200},children:a.folio}),Object(V.jsxs)(sa.a,{style:{width:200},children:["$",Ze(a.descuento)]}),Object(V.jsxs)(sa.a,{style:{width:200},children:["$",Ze(a.iva)]}),Object(V.jsxs)(sa.a,{style:{width:200},children:["$",Ze(a.ieps)]}),Object(V.jsxs)(sa.a,{style:{width:200},children:["$",Ze(a.subTotal)]}),Object(V.jsxs)(sa.a,{style:{width:200},children:["$",Ze(a.impuestos)]}),Object(V.jsxs)(sa.a,{style:{width:200},children:["$",Ze(a.total)]}),Object(V.jsx)(sa.a,{style:{width:200},children:"aqui ira usuario"}),Object(V.jsx)(sa.a,{style:{width:200},children:"aqui ira caja"})]})})]})}),Object(V.jsx)(b.a,{textAlign:"center",mt:1,children:Object(V.jsx)(y.a,{variant:"button",children:"Productos de Venta"})}),Object(V.jsx)(ra.a,{className:e.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{style:{width:250},children:"Producto"}),Object(V.jsx)(sa.a,{style:{width:50},children:"Cantidad"}),Object(V.jsx)(sa.a,{style:{width:50},children:"IVA"}),Object(V.jsx)(sa.a,{style:{width:50},children:"IEPS"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Subtotal"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Impuestos"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Total"}),Object(V.jsx)(sa.a,{style:{width:50},children:"Modificar"}),Object(V.jsx)(sa.a,{style:{width:50},children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:n.map((function(e,t){return Object(V.jsx)(gp,{venta:a,producto:e,index:t},t)}))})]})})]})):null}var gp=function(e){var t=e.venta,a=e.producto,n=e.index,c=a.id_producto.datos_generales;return Object(V.jsxs)(oa.a,{tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:c.nombre_comercial}),Object(V.jsx)(sa.a,{children:a.cantidad_venta}),Object(V.jsxs)(sa.a,{children:["$",Ze(a.iva_total_producto)]}),Object(V.jsxs)(sa.a,{children:["$",Ze(a.ieps_total_producto)]}),Object(V.jsxs)(sa.a,{children:["$",Ze(a.subtotal_total_producto)]}),Object(V.jsxs)(sa.a,{children:["$",Ze(a.impuestos_total_producto)]}),Object(V.jsxs)(sa.a,{children:["$",Ze(a.total_total_producto)]}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(mp,{venta:t,producto:a,index:n})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(xp,{venta:t,producto:a,index:n})})]})},_p=function(e){var t=e.cfdi_type,a=e.currency,n=e.date,c=e.empresa,r=e.expedition_place,i=e.folio,o=e.issuer,s=e.items,l=e.logo_url,d=e.payment_form,j=e.payment_method,u=e.receiver,b=e.serie,p=e.sucursal;return console.log(e),t&&a&&n&&c&&r&&i&&o&&s&&l&&d&&j&&u&&b&&p?[]:[{message:"Campo requerido"}]},vp=JSON.parse(localStorage.getItem("sesionCafi")),Cp={serie:"",currency:"MXN",expedition_place:"",folio:"",cfdi_type:"I",payment_form:"",payment_method:"",logo_url:vp?vp.imagen:"",date:"0",issuer:{FiscalRegime:vp?vp.empresa.regimen_fiscal:"",Rfc:vp?vp.empresa.rfc:"",Name:vp?vp.empresa.nombre_fiscal:""},receiver:{Rfc:"",Name:"",CfdiUse:""},items:[],empresa:vp?vp.empresa._id:"",sucursal:vp?vp.sucursal._id:""},yp=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Sp(e){var t=e.setAlert,a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=(o[0],o[1]),d=Object(s.useContext)(Zb),j=d.datosFactura,b=(d.setDatosFactura,d.codigo_postal),p=(d.setCodigoPostal,d.productosFactura,d.setProductosFactura,d.setError),m=Object(N.a)(Dt),O=(Object(v.a)(m,1)[0],function(){r(!1)}),x=function(){var e=Object(_.a)(g.a.mark((function e(){var a,n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l(!0),a=Object(u.a)({},j),n=[{ProductCode:"50202306",IdentificationNumber:"61b7bf6e3454b727a0c2e357",Description:"COCACOLA",UnitCode:"XBX",UnitPrice:"36",Quantity:"1",Subtotal:"36",Discount:"5.4",Taxes:[{Total:"4.89",Name:"IVA",Base:"30.6",Rate:"0.16",IsRetention:"false"}],Total:"35.49"}],"1"===j.date?a.date=xt()().subtract(1,"d").format("YYYY-MM-DDTHH:mm:ss"):"2"===j.date?a.date=xt()().subtract(2,"d").format("YYYY-MM-DDTHH:mm:ss"):a.date=xt()().format("YYYY-MM-DDTHH:mm:ss"),a.items=n,a.expedition_place=b,c=_p(a),console.log(a),!c.length){e.next=13;break}return p({status:!0,message:c[0].message}),l(!1),e.abrupt("return");case 13:p({status:!1,message:""}),l(!1),e.next=23;break;case 17:e.prev=17,e.t0=e.catch(0),console.log(e.t0),console.log(e.t0.response),l(!1),e.t0.response?t({message:e.t0.response,status:"error",open:!0}):e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 23:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{color:"primary",startIcon:Object(V.jsx)(za.a,{}),size:"large",onClick:function(){r(!0)},children:"Generar CFDI"}),Object(V.jsxs)(ze.a,{open:c,TransitionComponent:yp,keepMounted:!0,onClose:function(){return O()},fullWidth:!0,maxWidth:"xs",children:[Object(V.jsx)(Pe.a,{children:Object(V.jsx)(wp,{})}),Object(V.jsxs)(We.a,{style:{justifyContent:"center"},children:[Object(V.jsx)(w.a,{onClick:function(){return O()},color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{startIcon:Object(V.jsx)(Pt.a,{}),onClick:function(){return x()},color:"primary",children:"Realizar Factura"})]})]})]})}var wp=function(){var e,t=Object(s.useContext)(Zb),a=t.datosFactura,n=t.setDatosFactura,c=t.error_validation,r=function(e){var t=e.target,c=t.name,r=t.value;console.log(c,r),n(Object(u.a)(Object(u.a)({},a),{},Object(h.a)({},c,r)))};return Object(V.jsxs)(b.a,{children:[Object(V.jsxs)(b.a,{my:1,children:[Object(V.jsx)(y.a,{children:"Fecha de facturaci\xf3n"}),Object(V.jsxs)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"date",error:c.status&&!a.date,children:[Object(V.jsxs)(De.a,{value:a.date,name:"date",onChange:r,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona una fecha"})}),Object(V.jsx)(Ee.a,{value:"0",children:xt()().format("LL")}),Object(V.jsx)(Ee.a,{value:"1",children:xt()().subtract(1,"d").format("LL")}),Object(V.jsx)(Ee.a,{value:"2",children:xt()().subtract(2,"d").format("LL")})]}),Object(V.jsx)(ca.a,{children:c.status&&!a.date?c.message:""})]})]}),Object(V.jsxs)(b.a,{my:1,children:[Object(V.jsx)(y.a,{children:"Forma de pago"}),Object(V.jsxs)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"payment_form",error:c.status&&!a.payment_form,children:[Object(V.jsxs)(De.a,{value:a.payment_form,name:"payment_form",onChange:r,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),_t.map((function(e,t){return Object(V.jsx)(Ee.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(V.jsx)(ca.a,{children:c.status&&!a.payment_form?c.message:""})]})]}),Object(V.jsxs)(b.a,{my:1,children:[Object(V.jsx)(y.a,{children:"M\xe9todo de pago"}),Object(V.jsxs)(G.a,{variant:"outlined",fullWidth:!0,size:"small",name:"payment_method",error:c.status&&!a.payment_method,children:[Object(V.jsxs)(De.a,{value:a.payment_method,name:"payment_method",onChange:r,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),vt.map((function(e,t){return Object(V.jsx)(Ee.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(V.jsx)(ca.a,{children:c.status&&!a.payment_method?c.message:""})]})]}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{children:"Uso de CFDi"}),Object(V.jsxs)(G.a,(e={fullWidth:!0,size:"small",variant:"outlined"},Object(h.a)(e,"fullWidth",!0),Object(h.a)(e,"error",c.status&&!a.receiver.CfdiUse),Object(h.a)(e,"children",[Object(V.jsxs)(De.a,{value:a.receiver.CfdiUse,name:"CfdiUse",onChange:function(e){var t=e.target,c=t.name,r=t.value;n(Object(u.a)(Object(u.a)({},a),{},{receiver:Object(u.a)(Object(u.a)({},a.receiver),{},Object(h.a)({},c,r))}))},children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),ht.map((function(e,t){return Object(V.jsx)(Ee.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(V.jsx)(ca.a,{children:c.status&&!a.receiver.CfdiUse?c.message:""})]),e))]})]})},Ip=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}})),kp=Object(s.forwardRef)((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Np(){var e=Ip(),t=Object(s.useState)(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(V.jsx)("div",{children:Object(V.jsxs)(ji,{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",mb:2,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/factura-2.png",alt:"icono Factura",style:{width:100}})}),"Generar nuevo CFDI"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:function(){return r()},TransitionComponent:kp,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Generar nuevo CFDI"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{color:"inherit",onClick:function(){return r()},size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(ep,{children:Object(V.jsx)(Fp,{handleClose:r})})]})]})})}var Fp=function(e){var t=e.handleClose,a=Object(s.useContext)(Zb),n=a.setDatosFactura,c=a.setCodigoPostal,r=a.setProductosFactura,i=JSON.parse(localStorage.getItem("sesionCafi")),o=Object(s.useState)({message:"",status:"",open:!1}),l=Object(v.a)(o,2),d=l[0],j=l[1],u=Object(He.a)(Wt,{variables:{sucursal:i.sucursal._id,empresa:i.empresa._id},fetchPolicy:"network-only"}),p=u.loading,m=u.data,O=u.error;if(p)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})});if(O)return Object(V.jsx)(Je,{error:O});var x=m.obtenerSeriesCdfi.seriesCfdi,h=[];(h=x.filter((function(e){return!0===e.default}))).length||(h=[{folio:"",serie:""}],console.log(h));var f=function(){n(Cp),r([]),c(""),t()};return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(Pe.a,{children:[Object(V.jsx)(B,{alert:d,setAlert:j}),x.length?null:Object(V.jsx)(yt.a,{severity:"warning",children:"No tienes Series CFDI registradas"}),Object(V.jsx)(b.a,{my:2,children:Object(V.jsx)(bp,{serie_default:h})}),Object(V.jsx)(fp,{})]}),Object(V.jsxs)(We.a,{style:{justifyContent:"center"},children:[Object(V.jsx)(w.a,{onClick:function(){return f()},size:"large",children:"Cancelar"}),Object(V.jsx)(Sp,{setAlert:j})]})]})},zp=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Pp(e){var t=e.refetch,a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)({folio:"",serie:"",default:!1}),o=Object(v.a)(i,2),l=o[0],d=o[1],j=JSON.parse(localStorage.getItem("sesionCafi")),p=Object(s.useState)({message:"",status:"",open:!1}),m=Object(v.a)(p,2),O=m[0],x=m[1],f=Object(s.useState)(!1),C=Object(v.a)(f,2),k=C[0],F=C[1],z=Object(N.a)(Et),P=Object(v.a)(z,1)[0],D=function(){r(!1),d({folio:"",serie:"",default:!1})},E=function(e){var t=e.target,a=t.name,n=t.value;d(Object(u.a)(Object(u.a)({},l),{},Object(h.a)({},a,n)))},A=function(){var e=Object(_.a)(g.a.mark((function e(){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.folio&&l.serie){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,F(!0),e.next=6,P({variables:{input:{serie:l.serie,folio:parseInt(l.folio),default:l.default,empresa:j.empresa._id,sucursal:j.sucursal._id}}});case 6:a=e.sent,x({message:"\xa1Listo! ".concat(a.data.crearSerieCFDI.message),status:"success",open:!0}),t(),F(!1),D(),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(2),F(!1),x({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 19:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{children:[Object(V.jsx)(B,{alert:O,setAlert:x}),Object(V.jsx)(b.a,{display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(w.a,{onClick:function(){r(!0)},color:"primary",variant:"contained",size:"large",startIcon:Object(V.jsx)(It.a,{}),children:"Nueva serie"})}),Object(V.jsxs)(ze.a,{maxWidth:"xs",fullWidth:!0,open:c,onClose:function(){return D()},TransitionComponent:zp,children:[Object(V.jsx)(wt.a,{children:"Registrar nueva serie"}),Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Serie para CDFI:"}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",name:"serie",onChange:E})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Folio Inicial:"}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",name:"folio",onChange:E})})]}),Object(V.jsx)(aa.a,{style:{marginTop:8},control:Object(V.jsx)(na.a,{checked:l.default,onChange:function(e){var t=e.target,a=t.name,n=t.checked;d(Object(u.a)(Object(u.a)({},l),{},Object(h.a)({},a,n)))},name:"default"}),label:"Serie predeterminada"})]}),Object(V.jsxs)(We.a,{style:{justifyContent:"center"},children:[Object(V.jsx)(w.a,{startIcon:Object(V.jsx)(zt.a,{}),onClick:function(){return D()},children:"Cancelar"}),Object(V.jsx)(w.a,{color:"primary",startIcon:k?Object(V.jsx)(I.a,{size:20}):Object(V.jsx)(Pt.a,{}),disabled:!l.serie||!l.folio||k,onClick:function(){return A()},children:"Guardar"})]})]})]})}var Dp=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),Ep=Object(k.a)((function(e){return{container:{height:"80vh"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}}));function Ap(e){var t=e.obtenerSeriesCdfi,a=e.refetch,n=Ep(),c=Object(s.useState)(!1),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)({message:"",status:"",open:!1}),d=Object(v.a)(l,2),j=d[0],u=d[1],b=JSON.parse(localStorage.getItem("sesionCafi")),p=t.seriesCfdi,m=Object(N.a)(At),O=Object(v.a)(m,1)[0],x=function(){var e=Object(_.a)(g.a.mark((function e(t,n){var c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.prev=1,e.next=4,O({variables:{id:n._id,empresa:b.empresa._id,sucursal:b.sucursal._id}});case 4:c=e.sent,a(),o(!1),u({message:"\xa1Listo! ".concat(c.data.modificarDefaultSerie.message),status:"success",open:!0}),o(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),o(!1),u({message:"Error: ".concat(e.t0.message),status:"success",open:!0});case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,a){return e.apply(this,arguments)}}();return Object(V.jsxs)(Da.a,{variant:"outlined",children:[Object(V.jsx)(Me.a,{className:n.backdrop,open:i,children:Object(V.jsx)(I.a,{color:"inherit"})}),Object(V.jsx)(B,{alert:j,setAlert:u}),Object(V.jsx)(ra.a,{className:n.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Serie"}),Object(V.jsx)(sa.a,{children:"Folio"}),Object(V.jsx)(sa.a,{children:"Predeterminado"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:p.map((function(e,t){return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:e.serie}),Object(V.jsx)(sa.a,{children:e.folio}),Object(V.jsx)(sa.a,{align:"center",padding:"checkbox",children:Object(V.jsx)(na.a,{checked:e.default,onChange:function(t){return x(t.target.checked,e)},name:"checkedA"})}),Object(V.jsx)(sa.a,{align:"center",padding:"checkbox",children:Object(V.jsx)(Tp,{row:e,refetch:a,setAlert:u})})]},t)}))})]})})]})}var Tp=function(e){var t=e.row,a=e.refetch,n=e.setAlert,c=Object(s.useState)(!1),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)(!1),d=Object(v.a)(l,2),j=d[0],u=d[1],b=Object(N.a)(Tt),p=Object(v.a)(b,1)[0],m=function(){return o(!1)},O=function(){var e=Object(_.a)(g.a.mark((function e(){var c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,p({variables:{id:t._id}});case 4:c=e.sent,a(),u(!1),m(),n({message:"\xa1Listo! ".concat(c.data.eliminarSerie.message),status:"success",open:!0}),u(!1),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),u(!1),n({message:"Error: ".concat(e.t0.message),status:"success",open:!0});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(X.a,{"aria-label":"delete",size:"small",onClick:function(){return o(!0)},disabled:t.default,children:Object(V.jsx)(Wu.a,{})}),Object(V.jsxs)(ze.a,{open:i,onClose:function(){return m()},TransitionComponent:Dp,children:[Object(V.jsx)(wt.a,{children:"Se eliminara esta serie"}),Object(V.jsxs)(We.a,{style:{justifyContent:"center"},children:[Object(V.jsx)(w.a,{startIcon:Object(V.jsx)(zt.a,{}),onClick:function(){return m()},children:"Cancelar"}),Object(V.jsx)(w.a,{color:"secondary",disabled:j,startIcon:j?Object(V.jsx)(I.a,{size:20}):Object(V.jsx)(Pt.a,{}),onClick:function(){return O()},children:"Eliminar"})]})]})]})},Wp=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),Rp=Object(s.forwardRef)((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function $p(){var e=Wp(),t=Object(s.useState)(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!n)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:r,children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",mb:2,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/factura-1.png",alt:"icono Factura",style:{width:100}})}),"Registrar Series CFDI"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Rp,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Seleccion de Series para CFDI"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{color:"inherit",onClick:r,size:"large",children:Object(V.jsx)($e.a,{})})})]})}),Object(V.jsx)(Mp,{})]})]})}var Mp=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(He.a)(Wt,{variables:{sucursal:e.sucursal._id,empresa:e.empresa._id},fetchPolicy:"network-only"}),a=t.loading,n=t.data,c=t.error,r=t.refetch;if(a)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})});if(c)return Object(V.jsx)(Je,{error:c});var i=n.obtenerSeriesCdfi;return Object(V.jsxs)(C.a,{maxWidth:"md",children:[Object(V.jsx)(b.a,{my:2,children:Object(V.jsx)(Pp,{refetch:r})}),Object(V.jsx)(Ap,{obtenerSeriesCdfi:i,refetch:r})]})},Lp=Co.a.ExcelFile,Vp=Co.a.ExcelFile.ExcelSheet,Up=Co.a.ExcelFile.ExcelColumn;function Bp(e){var t=e.compra,a=t.almacen,n=t.proveedor,c=t.fecha_registro,r=t.subtotal,i=t.impuestos,o=t.total,l=t.productos,d=[{almacen:a.nombre_almacen,proveedor:n.nombre_cliente,fecha_registro:Ke(c),subtotal:Ze(r),impuestos:Ze(i),total:Ze(o)}],j=l.map((function(e){var t=e.producto,a=e.medida,n=e.color,c=e.unidad,r=e.cantidad,i=e.Cantidad_regalo,o=e.cantidad_total,s=e.descuento_precio,l=e.descuento_porcentaje,d=e.subtotal,j=e.impuestos,u=e.total;return{producto:t.datos_generales.nombre_comercial,medida:a?a.medida:"N/A",color:n?n.color:"N/A",unidad:c,cantidad:r,Cantidad_regalo:i,cantidad_total:o,descuento_precio:s,descuento_porcentaje:l,subtotal:Ze(d),impuestos:Ze(j),total:Ze(u)}}));return Object(V.jsx)(s.Fragment,{children:Object(V.jsx)(Fe.a,{children:Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsxs)(Lp,{element:Object(V.jsx)(b.a,{display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(w.a,{variant:"contained",color:"primary",startIcon:Object(V.jsx)(_o.a,{}),children:"Exportar a Excel"})}),filename:"Detalle de compra",children:[Object(V.jsxs)(Vp,{data:d,name:"Detalle compra",children:[Object(V.jsx)(Up,{label:"Almacen",value:"almacen"}),Object(V.jsx)(Up,{label:"Proveedor",value:"proveedor"}),Object(V.jsx)(Up,{label:"Fecha de compra",value:"fecha_registro"}),Object(V.jsx)(Up,{label:"Subtotal",value:"subtotal"}),Object(V.jsx)(Up,{label:"Impuestos",value:"impuestos"}),Object(V.jsx)(Up,{label:"Total",value:"total"})]}),Object(V.jsxs)(Vp,{data:j,name:"Productos de la compra",children:[Object(V.jsx)(Up,{label:"Producto",value:"producto"}),Object(V.jsx)(Up,{label:"Medida",value:"medida"}),Object(V.jsx)(Up,{label:"Color",value:"color"}),Object(V.jsx)(Up,{label:"Unidad",value:"unidad"}),Object(V.jsx)(Up,{label:"Cantidad",value:"cantidad"}),Object(V.jsx)(Up,{label:"Cantidad de regalo",value:"cantidad_regalo"}),Object(V.jsx)(Up,{label:"Cantidad total",value:"cantidad_total"}),Object(V.jsx)(Up,{label:"Precio de descuento",value:"descuento_precio"}),Object(V.jsx)(Up,{label:"Porcentaje de descuento",value:"descuento_porcentaje"}),Object(V.jsx)(Up,{label:"Subtotal",value:"subtotal"}),Object(V.jsx)(Up,{label:"Impuestos",value:"impuestos"}),Object(V.jsx)(Up,{label:"Total",value:"total"})]})]})})})})}var Jp=Object(k.a)({root:{width:"100%"},container:{height:"50vh"}});function Gp(e){var t=e.compra,a=Jp(),n=Object(ve.a)(),c=t.productos,r=Object(s.useState)(""),i=Object(v.a)(r,2),o=i[0],l=i[1],d=Object(s.useState)([]),j=Object(v.a)(d,2),u=j[0],p=j[1];return Object(s.useEffect)((function(){p(c.filter((function(e){return e.producto.datos_generales.nombre_comercial.toLowerCase().includes(o.toLowerCase())})))}),[o,c]),Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(b.a,{mb:1,display:"flex",children:[Object(V.jsxs)(y.a,{style:{marginRight:16},children:[Object(V.jsx)("b",{children:"Proveedor: "}),t.proveedor.nombre_cliente]}),Object(V.jsxs)(y.a,{style:{marginRight:16},children:[Object(V.jsx)("b",{children:"Almacen: "}),t.almacen.nombre_almacen]}),Object(V.jsx)(y.a,{style:{marginRight:16},children:Object(V.jsxs)("b",{children:["Subtotal: $",t.subtotal]})}),Object(V.jsx)(y.a,{style:{marginRight:16},children:Object(V.jsxs)("b",{children:["Impuestos: $",t.impuestos]})}),Object(V.jsx)(y.a,{style:{marginRight:16},children:Object(V.jsxs)("b",{children:["Total: $",t.total]})})]}),Object(V.jsx)(b.a,{mb:2,display:"flex",children:Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,sm:6,xs:12,children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",onChange:function(e){return t=e.target.value,l(t);var t},InputProps:{startAdornment:Object(V.jsx)(Y.a,{position:"start",children:Object(V.jsx)(go.a,{color:"action"})})}})}),Object(V.jsx)(Fe.a,{item:!0,sm:6,xs:12,children:Object(V.jsx)(Bp,{compra:t})})]})}),Object(V.jsx)(Da.a,{className:a.root,children:Object(V.jsx)(ra.a,{className:a.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Producto"}),Object(V.jsx)(sa.a,{children:"Medida"}),Object(V.jsx)(sa.a,{children:"Color"}),Object(V.jsx)(sa.a,{children:"Unidad"}),Object(V.jsx)(sa.a,{children:"Cantidad"}),Object(V.jsx)(sa.a,{children:"C. regalo"}),Object(V.jsx)(sa.a,{children:"C. total"}),Object(V.jsx)(sa.a,{children:"Descuento"}),Object(V.jsx)(sa.a,{children:"Subtotal"}),Object(V.jsx)(sa.a,{children:"Impuestos"}),Object(V.jsx)(sa.a,{children:"Total"})]})}),Object(V.jsx)(la.a,{children:u.map((function(e,t){return Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:e.producto.datos_generales.nombre_comercial}),Object(V.jsx)(sa.a,{padding:"checkbox",children:e.medida&&e.medida.medida?e.medida.medida:"N/A"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:e.color&&e.color.hex?Object(V.jsx)(Ea.a,{label:e.color.color,size:"small",style:{backgroundColor:e.color.hex,color:n.palette.getContrastText(e.color.hex)}}):"N/A"}),Object(V.jsx)(sa.a,{children:e.unidad}),Object(V.jsx)(sa.a,{children:e.cantidad}),Object(V.jsx)(sa.a,{children:e.cantidad_regalo}),Object(V.jsx)(sa.a,{children:e.cantidad_total}),Object(V.jsx)(sa.a,{children:"$".concat(e.descuento_precio," - %").concat(e.descuento_porcentaje)}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(e.subtotal)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(e.impuestos)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(e.total)]})})]},t)}))})]})})})]})}var qp=Object(k.a)({root:{width:"100%"},container:{height:"72vh"}});function Hp(e){var t=e.obtenerComprasRealizadas,a=qp();return Object(V.jsx)(Da.a,{className:a.root,variant:"outlined",children:Object(V.jsx)(ra.a,{className:a.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Almacen"}),Object(V.jsx)(sa.a,{children:"Proveedor"}),Object(V.jsx)(sa.a,{children:"Fecha de compra"}),Object(V.jsx)(sa.a,{children:"Subtotal"}),Object(V.jsx)(sa.a,{children:"Impuestos"}),Object(V.jsx)(sa.a,{children:"Total"}),Object(V.jsx)(sa.a,{children:"Productos"})]})}),Object(V.jsx)(la.a,{children:t.map((function(e,t){return Object(V.jsx)(Yp,{compra:e},t)}))})]})})})}var Yp=function(e){var t=e.compra,a=t.almacen,n=t.proveedor,c=t.fecha_registro,r=t.subtotal,i=t.impuestos,o=t.total;return Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:a.nombre_almacen}),Object(V.jsx)(sa.a,{children:n.nombre_cliente}),Object(V.jsx)(sa.a,{children:Ke(c)}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(r)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(i)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsxs)("b",{children:["$",Ze(o)]})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(Kp,{compra:t})})]})},Xp=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),Kp=function(e){var t=e.compra,a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=function(){r(!c)};return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(X.a,{onClick:function(){return i()},children:Object(V.jsx)(Fo.a,{})}),Object(V.jsxs)(ze.a,{open:c,onClose:i,fullWidth:!0,maxWidth:"lg",TransitionComponent:Xp,children:[Object(V.jsx)(wt.a,{children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(y.a,{variant:"h6",style:{flexGrow:1},children:"Datos de compra"}),Object(V.jsx)(w.a,{variant:"text",color:"primary",onClick:i,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})]})}),Object(V.jsx)(Pe.a,{children:Object(V.jsx)(Gp,{compra:t})}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{variant:"text",color:"primary",size:"large",startIcon:Object(V.jsx)(Pt.a,{}),onClick:function(){return i()},children:"Acpetar"})})]})]})},Qp=Co.a.ExcelFile,Zp=Co.a.ExcelFile.ExcelSheet,em=Co.a.ExcelFile.ExcelColumn;function tm(e){var t=e.obtenerComprasRealizadas,a=e.filtro,n=e.filtroFecha,c=t.map((function(e){var t=e.almacen,a=e.proveedor,n=e.fecha_registro,c=e.subtotal,r=e.impuestos,i=e.total;return{almacen:t.nombre_almacen,proveedor:a.nombre_cliente,fecha_registro:Ke(n),subtotal:Ze(c),impuestos:Ze(r),total:Ze(i)}})),r="";return a&&n.fecha?r="Lista de compras realizadas desde hace ".concat(n.since," y filtradas por ").concat(a):a&&!n.fecha?r="Lista de compras realizadas filtradas por ".concat(a):!a&&n.fecha?r="Lista de compras realizadas desde hace ".concat(n.since):a||n.fecha||(r="Lista de compras realizadas"),Object(V.jsx)(s.Fragment,{children:Object(V.jsx)(Fe.a,{children:Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsx)(Qp,{element:Object(V.jsx)(b.a,{display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(w.a,{variant:"contained",color:"primary",startIcon:Object(V.jsx)(_o.a,{}),children:"Exportar a Excel"})}),filename:r,children:Object(V.jsxs)(Zp,{data:c,name:r,children:[Object(V.jsx)(em,{label:"Almacen",value:"almacen"}),Object(V.jsx)(em,{label:"Proveedor",value:"proveedor"}),Object(V.jsx)(em,{label:"Fecha de compra",value:"fecha_registro"}),Object(V.jsx)(em,{label:"Subtotal",value:"subtotal"}),Object(V.jsx)(em,{label:"Impuestos",value:"impuestos"}),Object(V.jsx)(em,{label:"Total",value:"total"})]})})})})})}var am=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}})),nm=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function cm(){var e=am(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",mb:2,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/factura-3.png",alt:"icono Factura",style:{width:100}})})}),"CFDis realizados"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:nm,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"CFDis realizados"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(C.a,{maxWidth:"xl",children:Object(V.jsx)(rm,{})})]})]})}var rm=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(s.useState)(""),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useState)({fecha:"",since:"todos"}),i=Object(v.a)(r,2),o=i[0],l=i[1],d=Object(s.useRef)(null),j=Object(s.useRef)(null),u=Object(He.a)(Ei,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,fecha:o.fecha},fetchPolicy:"network-only"}),p=u.loading,m=u.data,O=u.error,x=u.refetch;if(p)return Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:[Object(V.jsx)(I.a,{}),Object(V.jsx)(y.a,{variant:"h5",children:"Cargando"})]});if(O)return Object(V.jsx)(Je,{error:O,altura:300});var h=[];m&&(h=m.obtenerComprasRealizadas);return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{my:3,children:Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsx)(Fe.a,{item:!0,md:4,xs:12,children:Object(V.jsx)("form",{onSubmit:function(e){return function(e,t){e.preventDefault(),x({filtro:t,fecha:o.fecha}),c(t)}(e,e.target[0].value)},children:Object(V.jsx)(S.a,{inputRef:d,fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",InputProps:{endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(X.a,{type:"submit",color:"primary",size:"medium",children:Object(V.jsx)(To.a,{})})})}})})}),Object(V.jsx)(Fe.a,{item:!0,md:4,xs:12,children:Object(V.jsxs)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:[Object(V.jsx)(q.a,{id:"label-select-fecha-filter",children:"Filtrar desde..."}),Object(V.jsxs)(De.a,{inputRef:j,labelId:"label-select-fecha-filter",value:o.since,onChange:function(e){return function(e){switch(e){case"7 dias":l({since:e,fecha:xt()().subtract(7,"d").format()}),x({filtro:n,fecha:xt()().subtract(7,"d").format()});break;case"2 semanas":l({since:e,fecha:xt()().subtract(2,"w").format()}),x({filtro:n,fecha:xt()().subtract(2,"w").format()});break;case"1 mes":l({since:e,fecha:xt()().subtract(1,"M").format()}),x({filtro:n,fecha:xt()().subtract(1,"M").format()});break;case"3 meses":l({since:e,fecha:xt()().subtract(3,"M").format()}),x({filtro:n,fecha:xt()().subtract(3,"M").format()});break;case"6 meses":l({since:e,fecha:xt()().subtract(6,"M").format()}),x({filtro:n,fecha:xt()().subtract(6,"M").format()});break;case"8 meses":l({since:e,fecha:xt()().subtract(8,"M").format()}),x({filtro:n,fecha:xt()().subtract(8,"M").format()});break;case"1 a\xf1o":l({since:e,fecha:xt()().subtract(1,"y").format()}),x({filtro:n,fecha:xt()().subtract(1,"y").format()});break;default:l({since:"todos",fecha:""}),x({filtro:n,fecha:""})}}(e.target.value)},label:"Filtrar desde...",children:[Object(V.jsx)(Ee.a,{value:"todos",children:Object(V.jsx)("em",{children:"Todos los registros"})}),Object(V.jsx)(Ee.a,{value:"7 dias",children:"hace 7 d\xedas"}),Object(V.jsx)(Ee.a,{value:"2 semanas",children:"hace 2 semanas"}),Object(V.jsx)(Ee.a,{value:"1 mes",children:"hace 1 mes"}),Object(V.jsx)(Ee.a,{value:"3 meses",children:"hace 3 meses"}),Object(V.jsx)(Ee.a,{value:"6 meses",children:"hace 6 meses"}),Object(V.jsx)(Ee.a,{value:"8 meses",children:"hace 8 meses"}),Object(V.jsx)(Ee.a,{value:"1 a\xf1o",children:"hace 1 a\xf1o"})]})]})}),Object(V.jsx)(Fe.a,{item:!0,md:4,xs:12,children:Object(V.jsx)(tm,{obtenerComprasRealizadas:h,filtro:n,filtroFecha:o})})]})}),n||o.fecha?Object(V.jsxs)(b.a,{display:"flex",mb:1,children:[Object(V.jsx)(y.a,{variant:"h6",children:"Resultados de:"}),Object(V.jsx)(b.a,{mr:1}),n?Object(V.jsx)(Ea.a,{variant:"outlined",size:"medium",label:n,onDelete:function(){x({filtro:"",fecha:o.fecha}),c(""),d.current.value=""}}):null,Object(V.jsx)(b.a,{mx:1}),o.fecha?Object(V.jsx)(Ea.a,{variant:"outlined",size:"medium",label:"Desde hace ".concat(o.since),onDelete:function(){x({filtro:n,fecha:""}),l({since:"todos",fecha:""}),j.current.value="todos"}}):null]}):null,Object(V.jsx)(Hp,{obtenerComprasRealizadas:h})]})};function im(){return Object(V.jsx)("div",{children:Object(V.jsx)(C.a,{children:Object(V.jsxs)(Fe.a,{container:!0,spacing:2,justify:"center",children:[Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Np,{})})}),Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(cm,{})})}),Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)($p,{})})})]})})})}var om=Object(k.a)({table:{minWidth:650},root:{width:"100%"}}),sm=[{id:1,label:"Nombre",minWidth:100},{id:2,label:"Encargado",minWidth:100},{id:3,label:"Sucursal",minWidth:150},{id:4,label:"Calle",minWidth:150},{id:5,label:"No. exterior",minWidth:150},{id:6,label:"No. interior",minWidth:100},{id:7,label:"Codigo postal",minWidth:100},{id:8,label:"Colonia",minWidth:100},{id:9,label:"Municipio",minWidth:50,align:"right"},{id:10,label:"Localidad",minWidth:50,align:"right"},{id:11,label:"Estado",minWidth:50,align:"right"},{id:12,label:"Pais",minWidth:50,align:"right"},{id:13,label:"Editar",minWidth:50,align:"right"},{id:14,label:"Eliminar",minWidth:50,align:"right"}];function lm(){var e,t=om(),a=l.a.useState(0),n=Object(v.a)(a,2),c=n[0],r=n[1],i=l.a.useState(10),o=Object(v.a)(i,2),d=o[0],j=o[1],u=Object(s.useContext)(Cn).update,p=JSON.parse(localStorage.getItem("sesionCafi")),m=Object(He.a)(wn,{variables:{id:p.sucursal._id}}),O=m.loading,x=m.data,h=m.error,f=m.refetch;Object(s.useEffect)((function(){f()}),[u,f]);if(O)return Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})});if(h)return Object(V.jsx)(Je,{error:h});var g=x.obtenerAlmacenes;return Object(V.jsxs)(Da.a,{className:t.root,children:[Object(V.jsx)(ra.a,{component:Da.a,children:Object(V.jsxs)(da.a,{className:t.table,"aria-label":"simple table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:sm.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{children:null===g||void 0===g||null===(e=g.slice(c*d,c*d+d))||void 0===e?void 0:e.map((function(e,t){return Object(V.jsx)(dm,{datos:e},t)}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[],component:"div",count:g.length,rowsPerPage:d,page:c,onChangePage:function(e,t){r(t)},onChangeRowsPerPage:function(e){j(+e.target.value),r(0)}})]})}var dm=function(e){var t=e.datos;return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.nombre_almacen})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.id_usuario_encargado?t.id_usuario_encargado.nombre:"Sin encargado"})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.id_sucursal.nombre_sucursal})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.direccion.calle?t.direccion.calle:""})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.direccion.no_ext?t.direccion.no_ext:""})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.direccion.no_int?t.direccion.no_int:""})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.direccion.codigo_postal?t.direccion.codigo_postal:""})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.direccion.colonia?t.direccion.colonia:""})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.direccion.municipio?t.direccion.municipio:""})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.direccion.localidad?t.direccion.localidad:""})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.direccion.estado?t.direccion.estado:""})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(y.a,{children:t.direccion.pais?t.direccion.pais:""})}),Object(V.jsx)(sa.a,{width:50,children:Object(V.jsx)($n,{accion:"actualizar",datos:t})}),Object(V.jsx)(sa.a,{width:50,children:Object(V.jsx)(X.a,{color:"secondary",children:Object(V.jsx)(ur.a,{})})})]})},jm=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100}}})),um=Object(s.forwardRef)((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function bm(){var e=jm(),t=l.a.useState(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(V.jsx)("div",{children:Object(V.jsxs)(yn,{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Ce.n,{className:e.icon})}),"Agregar almacen"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:um,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Agregar almacen"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(b.a,{m:3,display:"flex",justifyContent:"flex-end",children:Object(V.jsx)($n,{accion:"registrar"})}),Object(V.jsx)(b.a,{mx:4,children:Object(V.jsx)(lm,{})})]})]})})}var pm=a(934),mm=a(908),Om=a(925),xm=a.p+"static/media/almacen.31993015.svg",hm=a(7),fm=a(933),gm=a(459),_m=a.n(gm),vm=Object(s.createContext)(),Cm=function(e){var t=e.children,a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(!1),u=Object(v.a)(j,2),b=u[0],p=u[1],m=Object(s.useState)([]),O=Object(v.a)(m,2),x=O[0],h=O[1],f=Object(s.useState)([]),g=Object(v.a)(f,2),_=g[0],C=g[1],y=Object(s.useState)([]),S=Object(v.a)(y,2),w=S[0],I=S[1],k=Object(s.useState)([]),N=Object(v.a)(k,2),F=N[0],z=N[1];return Object(V.jsx)(vm.Provider,{value:{update:c,setUpdate:r,error:l,setError:d,openRegistro:b,setOpenRegistro:p,productos:x,setProductos:h,productosTras:F,setProductosTras:z,productosTo:_,setProductosTo:C,productosEmpTo:w,setProductosEmpTo:I},children:t})},ym=function(e,t){if(e.medida.talla&&t.medida.talla)return e.medida.talla.localeCompare(t.medida.talla)},Sm=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},container:{},tableRow:{"&.Mui-selected, &.Mui-selected:hover":{backgroundColor:Object(Ma.fade)(e.palette.primary.main,.1)}},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",height:30,width:30,borderRadius:"15%"}}}));function wm(e){var t=e.datos,a=e.setOnUpdate,n=e.onUpdate,c=e.setNew_medidas,r=Sm(),i=Object(ea.a)(t).sort((function(e,t){return ym(e,t)}));return Object(V.jsx)("div",{className:r.root,children:Object(V.jsx)(Da.a,{className:r.paper,children:Object(V.jsx)(ra.a,{className:r.container,children:Object(V.jsxs)(da.a,{className:r.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",stickyHeader:!0,children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Existencia"}),Object(V.jsx)(sa.a,{children:"C\xf3digo de barras"}),Object(V.jsx)(sa.a,{width:200,children:"Nombre"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Medida"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Color"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Precio"}),Object(V.jsx)(s.Fragment,{children:Object(V.jsx)(sa.a,{padding:"checkbox",children:"Cantidad"})}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Editar"})]})}),Object(V.jsx)(la.a,{children:i.map((function(e,r){return Object(V.jsx)(Im,{producto:e,index:r,datos:t,setNew_medidas:c,setOnUpdate:a,onUpdate:n},r)}))})]})})})})}var Im=function(e){var t=e.producto,a=e.index,n=e.datos,c=e.setNew_medidas,r=(e.from,e.setOnUpdate),i=e.onUpdate,o=(e.withoutPrice,e.onlyPrice,Object(s.useState)(!0)),l=Object(v.a)(o,2),d=l[0],j=l[1],p=Sm(),m=Object(s.useRef)(null),O=Object(ea.a)(n).sort((function(e,t){return ym(e,t)})),x=Object(u.a)({},O[a]),h={},f=Object(u.a)({},t),g=function(e){var t=e.target,n=t.name,r=t.value;if("cantidad"===n){if(!r)return x.medida.cantidad="",x.medida.existencia=!1,O.splice(a,1,x),void c(c);x.medida.cantidad=parseFloat(r),x.medida.existencia=!0}else if("nuevaCantidad"===n){if(!r)return x.nuevaCantidad="",x.medida.existencia=f.medida.existencia,O.splice(a,1,x),void c(O);x.nuevaCantidad=parseFloat(r),x.medida.existencia=!0}else if("precio"===n){if(!r)return x.medida.precio=0,O.splice(a,1,x),void c(O);if(x.medida.descuento_activo&&!0===x.medida.descuento_activo){var i=Math.round(r*x.medida.descuento.porciento/100);h.medida.precio_con_descuento=parseFloat(i),x.medida.precio=parseFloat(r),x.medida.descuento=h}else x.medida.precio=parseFloat(r)}else if("descuento"===n)x.medida.descuento=r;else{if(!r)return x.medida.codigo_barras="",O.splice(a,1,x),void c(O);x.medida.codigo_barras=r}O.splice(a,1,x),c(O)},_=function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();x.medida.codigo_barras=t},C=function(){d?(j(!d),r([].concat(Object(ea.a)(i),[a]))):(f.medida.cantidad||(x.medida.cantidad=0),f.nuevaCantidad||(x.nuevaCantidad=0),f.precio||(x.precio=f.precio),O.splice(a,1,x),c(O),j(!0),i.splice(i.length-1,1),r(Object(ea.a)(i)))};return Object(V.jsxs)(oa.a,{hover:!0,selected:!d,className:p.tableRow,children:[Object(V.jsx)(sa.a,{align:"center",padding:"checkbox",children:Object(V.jsx)(na.a,{checked:f.medida.existencia,color:"primary"})}),Object(V.jsx)(sa.a,{width:220,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(Pa.a,{inputRef:m,onChange:function(e){return g(e)},value:f.medida.codigo_barras,type:"number",name:"codigo_barras",disabled:!(!n.medidas_registradas||f.medida.nuevo)||d}),!n.medidas_registradas&&f.medida.nuevo||n.medidas_registradas&&f.medida.nuevo?Object(V.jsx)(X.a,{color:"primary",size:"small",onClick:function(){return _()},children:Object(V.jsx)(Wa.a,{})}):null]})}),Object(V.jsx)(sa.a,{width:200,children:f.medida.nombre_comercial}),Object(V.jsx)(sa.a,{padding:"checkbox",children:f.medida.medida._id?Object(V.jsx)(Ea.a,{label:f.medida.medida.talla,color:"primary"}):""}),Object(V.jsx)(sa.a,{padding:"checkbox",children:f.medida.color._id?Object(V.jsx)(Aa.a,{title:f.medida.color.nombre,placement:"top",arrow:!0,TransitionComponent:Ta.a,children:Object(V.jsx)("div",{className:p.colorContainer,style:{backgroundColor:f.medida.color.hex}})}):null}),Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(sa.a,{width:110,children:Object(V.jsx)(Pa.a,{inputRef:m,onChange:function(e){return g(e)},disabled:d,value:f.medida.precio,type:"tel",name:"precio"})}),Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(Pa.a,{inputRef:m,onChange:function(e){return g(e)},disabled:d,value:f.nuevaCantidad,type:"tel",name:"nuevaCantidad"})})]}),Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(X.a,{size:"small",onClick:function(){return C()},children:d?Object(V.jsx)($a.a,{}):Object(V.jsx)(zt.a,{})})})]})},km=Object(k.a)((function(e){return{colorContainer:{border:"1px solid rgba(0,0,0, .3)",display:"flex",justifyContent:"center",alignItems:"center",height:50,width:50,margin:1,borderRadius:"15%",cursor:"pointer"}}})),Nm=function(){return Math.floor(9e11*Math.random()+1e11).toString()};function Fm(e){var t=e.producto,a=e.new_medidas,n=e.setNew_medidas,c=e.obtenerConsultasProducto,r=e.refetch,i=Object(s.useState)([]),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)([]),u=Object(v.a)(j,2),p=u[0],m=u[1],O=Object(s.useState)([]),x=Object(v.a)(O,2),h=x[0],f=x[1],g=Object(s.useCallback)((function(){var e=[],t=[];Object(ea.a)(a).forEach((function(a){a.medida.color._id&&e.push(a.medida.color),a.medida.medida._id&&t.push(a.medida.medida)}));var n={},c={},r=e.filter((function(e){var t=!n[e._id];return n[e._id]=!0,t})),i=t.filter((function(e){var t=!c[e._id];return c[e._id]=!0,t}));m(Object(ea.a)(r)),d(Object(ea.a)(i))}),[a,m,d]);return Object(s.useEffect)((function(){g()}),[g]),Object(V.jsx)("div",{children:Object(V.jsxs)(b.a,{alignContent:"center",m:5,children:[Object(V.jsxs)(Fe.a,{container:!0,spacing:4,children:[Object(V.jsx)(Fe.a,{item:!0,md:6,children:Object(V.jsxs)(b.a,{width:"100%",style:h.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(y.a,{children:"ROPA"===t.datos_generales.tipo_producto?"Talla":"N\xfamero"}),Object(V.jsx)(b.a,{mx:1}),Object(V.jsx)(cc,{setMedidasSeleccionadas:d,refetch:r})]}),"ROPA"===t.datos_generales.tipo_producto?void 0!==c.tallas?Object(V.jsx)(Fe.a,{container:!0,children:c.tallas.map((function(e,c){return Object(V.jsx)(zm,{producto:t,talla:e,coloresSeleccionados:p,medidasSeleccionadas:l,setMedidasSeleccionadas:d,datos:a,setNew_medidas:n},c)}))}):Object(V.jsx)("div",{}):void 0!==c.calzados?Object(V.jsx)(Fe.a,{container:!0,children:c.calzados.map((function(e,c){return Object(V.jsx)(zm,{producto:t,talla:e,coloresSeleccionados:p,medidasSeleccionadas:l,setMedidasSeleccionadas:d,datos:a,setNew_medidas:n},c)}))}):Object(V.jsx)("div",{})]})}),Object(V.jsx)(Fe.a,{item:!0,md:6,children:Object(V.jsxs)(b.a,{width:"100%",style:h.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(y.a,{children:"Color"}),Object(V.jsx)(b.a,{mx:1}),Object(V.jsx)(Zn,{refetch:r})]}),void 0!==c.colores?Object(V.jsx)(Fe.a,{container:!0,children:c.colores.map((function(e,c){return Object(V.jsx)(Pm,{producto:t,color:e,coloresSeleccionados:p,setColoresSeleccionados:m,medidasSeleccionadas:l,datos:a,setNew_medidas:n},c)}))}):Object(V.jsx)("div",{})]})})]}),Object(V.jsx)(b.a,{mt:2}),Object(V.jsx)(wm,{datos:a,setOnUpdate:f,onUpdate:h,setNew_medidas:n})]})})}var zm=function(e){var t=e.producto,a=e.talla,n=e.coloresSeleccionados,c=e.setMedidasSeleccionadas,r=e.medidasSeleccionadas,i=e.setNew_medidas,o=e.datos,l=km(),d=Object(ve.a)(),j=Object(s.useState)(!1),u=Object(v.a)(j,2),b=u[0],p=u[1],m=Object(s.useCallback)((function(){r.forEach((function(e){e._id===a._id&&p(!0)}))}),[a._id,r]);Object(s.useEffect)((function(){if(o)return m()}),[o,m]);return Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsx)("div",{className:l.colorContainer,onClick:function(){return function(e){var s=Object(ea.a)(r);b?s.forEach((function(t,n){t._id===a._id&&(s.splice(n,1),p(e))})):(s.push(a),p(e));var l=[],d=Object(ea.a)(o);if(n.length||d.length){if(!n.length&&d.length>0)for(var j=function(e){var a=s[e],n=d.filter((function(e){return e.medida.medida._id===a._id}));n.length?l.push(n[0]):l.push({medida:{_id:"",existencia:!1,codigo_barras:Nm(),nombre_comercial:t.datos_generales.nombre_comercial,medida:a,color:{nombre:"",hex:""},precio:t.precios.precios_producto[0].precio_neto,cantidad:0},nuevaCantidad:0})},u=0;u<s.length;u++)j(u);else if(n.length>0&&1===s.length&&e)for(var m=0;m<d.length;m++)for(var O=0;O<s.length;O++)l.push({medida:{_id:"",existencia:d[m].medida.existencia,codigo_barras:d[m].medida.codigo_barras,nombre_comercial:d[m].medida.nombre_comercial,medida:s[O],color:d[m].medida.color,precio:d[m].medida.precio,cantidad:d[m].medida.cantidad},nuevaCantidad:d[m].nuevaCantidad});else if(n.length>0&&s.length>0)for(var x=function(e){for(var a=s[e],c=function(e){var c=n[e],r=d.filter((function(e){return e.medida.medida._id===a._id&&c._id===e.medida.color._id}));r.length?l.push(r[0]):l.push({medida:{_id:"",existencia:!1,codigo_barras:Nm(),nombre_comercial:t.datos_generales.nombre_comercial,medida:a,color:c,precio:0,cantidad:0},nuevaCantidad:0})},r=0;r<n.length;r++)c(r)},h=0;h<s.length;h++)x(h);else if(n.length>0&&!s.length){var f=d.filter((function(e){return e.medida.medida._id}));if(f.length)for(var g=0;g<d.length;g++){var _=d[g];l.push({medida:{_id:"",existencia:_.medida.existencia,codigo_barras:_.medida.codigo_barras,nombre_comercial:_.medida.nombre_comercial,medida:_.medida.medida,color:_.medida.color,precio:_.medida.precio,cantidad:_.medida.cantidad},nuevaCantidad:_.nuevaCantidad})}}}else for(var v=0;v<s.length;v++){var C=s[v];l.push({medida:{_id:"",existencia:!1,codigo_barras:Nm(),nombre_comercial:t.datos_generales.nombre_comercial,medida:C,color:{nombre:"",hex:""},precio:t.precios.precios_producto[0].precio_neto,cantidad:0},nuevaCantidad:0})}c(Object(ea.a)(s)),i(l)}(!b)},style:b?{backgroundColor:d.palette.primary.main}:null,children:Object(V.jsx)(y.a,{variant:"button",style:{color:d.palette.getContrastText(b?d.palette.primary.main:"#FFFFFF"),fontSize:16},children:a.talla})})})},Pm=function(e){var t=e.producto,a=e.color,n=e.coloresSeleccionados,c=e.setColoresSeleccionados,r=e.medidasSeleccionadas,i=e.datos,o=e.setNew_medidas,l=km(),d=Object(ve.a)(),j=Object(s.useState)(!1),u=Object(v.a)(j,2),b=u[0],p=u[1],m=Object(s.useCallback)((function(){n.forEach((function(e){e._id===a._id&&p(!0)}))}),[a._id,n]);Object(s.useEffect)((function(){if(t)return m()}),[t,m]);return Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsx)(Aa.a,{title:a.nombre,placement:"top",arrow:!0,TransitionComponent:Ta.a,children:Object(V.jsx)("div",{className:l.colorContainer,style:{backgroundColor:a.hex,color:d.palette.getContrastText(a.hex)},onClick:function(){return function(e){b?n.forEach((function(t,c){t._id===a._id&&(n.splice(c,1),p(e))})):(n.push(a),p(e));var s=[],l=Object(ea.a)(i);if(r.length||l.length){if(!r.length&&l.length>0)for(var d=function(e){var a=n[e],c=l.filter((function(e){return e.medida.color._id===a._id}));c.length?s.push(c[0]):s.push({medida:{_id:"",existencia:!1,codigo_barras:Nm(),nombre_comercial:t.datos_generales.nombre_comercial,medida:{},color:a,precio:t.precios.precios_producto[0].precio_neto,cantidad:0},nuevaCantidad:0})},j=0;j<n.length;j++)d(j);else if(r.length>0&&1===n.length&&e)for(var u=0;u<l.length;u++)for(var m=0;m<n.length;m++)s.push({medida:{_id:"",existencia:l[u].medida.existencia,codigo_barras:l[u].medida.codigo_barras,nombre_comercial:l[u].medida.nombre_comercial,medida:l[u].medida.medida,color:n[m],precio:l[u].medida.precio,cantidad:l[u].medida.cantidad},nuevaCantidad:l[u].nuevaCantidad});else if(r.length>0&&n.length>0)for(var O=function(e){for(var a=n[e],c=function(e){var n=r[e],c=l.filter((function(e){return e.medida.medida._id===n._id&&a._id===e.medida.color._id}));c.length?s.push(c[0]):s.push({medida:{_id:"",existencia:!1,codigo_barras:Nm(),nombre_comercial:t.datos_generales.nombre_comercial,medida:n,color:a,precio:0,cantidad:0},nuevaCantidad:0})},i=0;i<r.length;i++)c(i)},x=0;x<n.length;x++)O(x);else if(r.length>0&&!n.length){var h=l.filter((function(e){return e.medida.color._id}));if(h.length)for(var f=0;f<l.length;f++){var g=l[f];s.push({medida:{_id:g.medida._id,existencia:g.medida.existencia,codigo_barras:g.medida.codigo_barras,nombre_comercial:g.medida.nombre_comercial,medida:g.medida.medida,color:{nombre:"",hex:""},precio:g.medida.precio,cantidad:g.medida.cantidad},nuevaCantidad:g.nuevaCantidad})}}}else for(var _=0;_<n.length;_++){var v=n[_];s.push({medida:{_id:"",existencia:!1,codigo_barras:Nm(),nombre_comercial:t.datos_generales.nombre_comercial,medida:{},color:v,precio:t.precios.precios_producto[0].precio_neto,cantidad:0},nuevaCantidad:0})}c(Object(ea.a)(n)),o(s)}(!b)},children:b?Object(V.jsx)(Pt.a,{}):null})})})},Dm=Object(k.a)((function(e){return{root:{alignSelf:"center",width:"90%",paddingLeft:e.spacing(2),paddingRight:e.spacing(1)},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:"100%",maxWidth:"100%"},tableRow:{"&.Mui-selected, &.Mui-selected:hover":{backgroundColor:Object(Ma.fade)(e.palette.primary.main,.1)}},cell:{align:"center"},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",height:30,width:30,borderRadius:"15%"}}}));function Em(e){var t=e.producto,a=e.setOnUpdate,n=e.onUpdate,c=e.new_medidas,r=e.setNew_medidas,i=Dm();return Object(V.jsx)("div",{className:i.root,children:Object(V.jsx)(Da.a,{className:i.paper,children:Object(V.jsx)(ra.a,{style:{height:400},children:Object(V.jsxs)(da.a,{className:i.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Medida"}),Object(V.jsx)(sa.a,{children:"Color"}),Object(V.jsx)(sa.a,{children:"Cantidad existente"}),Object(V.jsx)(sa.a,{children:"Cantidad a traspasar"})]})}),Object(V.jsx)(la.a,{children:t.medidas_producto.map((function(e,i){return Object(V.jsx)(Am,{idProducto:t._id,medida:e,index:i,setOnUpdate:a,onUpdate:n,new_medidas:c,setNew_medidas:r},i)}))})]})})})})}var Am=function(e){var t=e.medida,a=e.index,n=(e.setOnUpdate,e.onUpdate,e.new_medidas),c=e.setNew_medidas,r=e.idProducto,i=Object(s.useState)(!0),o=Object(v.a)(i,2),l=o[0],d=(o[1],Dm()),j=Object(s.useState)(0),b=Object(v.a)(j,2),p=b[0],m=b[1],O=Object(s.useState)(0),x=Object(v.a)(O,2),f=x[0],g=(x[1],Object(u.a)({},t)),_=Object(s.useContext)(vm).productosTras;Object(s.useEffect)((function(){return _.forEach((function(e){if(e.product_selected._id!==r);else{var a=[],n=null;for(var i in e.new_medidas)Object.hasOwnProperty.call(e.new_medidas,i)&&(n=e.new_medidas[i],a.push(n),t._id===n.medida._id&&m(n.cantidad));c(e.new_medidas)}})),function(){}}),[_]);return Object(V.jsxs)(oa.a,{selected:!l,className:d.tableRow,children:[Object(V.jsx)(sa.a,{children:g.medida._id?Object(V.jsx)(Ea.a,{label:g.medida.talla,color:"primary"}):""}),Object(V.jsx)(sa.a,{style:{width:"20%"},children:g.color._id?Object(V.jsx)(Aa.a,{title:g.color.nombre,placement:"top",arrow:!0,TransitionComponent:Ta.a,children:Object(V.jsx)("div",{className:d.colorContainer,style:{backgroundColor:g.color.hex}})}):null}),Object(V.jsx)(sa.a,{className:d.cell,style:{width:"25%"},children:t.cantidad}),Object(V.jsx)(sa.a,{style:{width:"25%"},children:Object(V.jsx)(S.a,{size:"small",variant:"outlined",InputProps:{inputProps:{min:0}},inputMode:"numeric",type:"number",value:p,onChange:function(e){return function(e){var r=f>0?parseInt(e-f):e;r<=t.cantidad&&(m(e),c(Object(u.a)(Object(u.a)({},n),{},Object(h.a)({},a,{medida:t,nuevaCantidad:parseInt(r)}))))}(e.target.value)},name:"nuevaCantidad"})})]})};function Tm(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}function Wm(e,t){return"desc"===e?function(e,a){return Tm(e,a,t)}:function(e,a){return-Tm(e,a,t)}}function Rm(e,t){var a=e.map((function(e,t){return[e,t]}));return a.sort((function(e,a){var n=t(e[0],a[0]);return 0!==n?n:e[1]-a[1]})),a.map((function(e){return e[0]}))}var $m=[{id:"codeBarras",numeric:!1,disablePadding:!1,label:"C\xf3digo de barras"},{id:"name",numeric:!1,disablePadding:!0,label:"Nombre"},{id:"tipo",numeric:!0,disablePadding:!1,label:"Tipo"},{id:"cantidad",numeric:!0,disablePadding:!1,label:"Cantidad"}];function Mm(e){var t=e.classes,a=e.order,n=e.orderBy,c=e.onRequestSort;return Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:$m.map((function(e){return Object(V.jsx)(sa.a,{align:e.numeric?"right":"left",sortDirection:n===e.id&&a,children:Object(V.jsxs)(fm.a,{active:n===e.id,direction:n===e.id?a:"asc",onClick:(r=e.id,function(e){c(e,r)}),children:[e.label,n===e.id?Object(V.jsx)("span",{className:t.visuallyHidden,children:"desc"===a?"sorted descending":"sorted ascending"}):null]})},e.id);var r}))})})}var Lm=Object(k.a)((function(e){return{root:{paddingLeft:e.spacing(2),paddingRight:e.spacing(1),maxWidth:650},input:{width:180},inputCantidad:{width:120,height:10},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(cj.f)(e.palette.primary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},title:{fontSize:16,flex:"1",display:"flex",flexWrap:"wrap"}}})),Vm=function(e){var t=Object(s.useState)([]),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useContext)(vm),i=r.setProductosTras,o=r.productosTras,l=function(){try{e.setOpenTallas(),e.setproduct_selected(void 0)}catch(t){}};return Object(s.useEffect)((function(){var t=[];o.forEach((function(a){if(a.product_selected._id===e.product_selected._id){var n=null;for(var c in a.new_medidas)Object.hasOwnProperty.call(a.new_medidas,c)&&(n=a.new_medidas[c],t.push(n))}})),c(t)}),[o,e.product_selected._id]),Object(V.jsxs)(ze.a,{open:e.openTallas,TransitionComponent:Um,fullWidth:!0,maxWidth:"md",children:[Object(V.jsx)(b.a,{m:1,display:"flex",justifyContent:"flex-end",children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){return l()},size:"large",children:Object(V.jsx)($e.a,{})})}),null===e.almacenOrigen?Object(V.jsx)("div",{children:Object(V.jsx)(Fm,{obtenerConsultasProducto:e.obtenerConsultasProducto,refetch:e.obtenerConsultasProducto.refetch,producto:e.product_selected,new_medidas:n,setNew_medidas:c})}):Object(V.jsx)("div",{children:Object(V.jsx)(Em,{producto:e.product_selected,new_medidas:n,setNew_medidas:c})}),Object(V.jsx)(b.a,{display:"flex",justifyContent:"flex-end",m:1,mr:5,children:Object(V.jsx)(w.a,{variant:"contained",color:"primary",style:{width:"20%"},onClick:function(){var t=n,a=0;try{var r;r=null!==e.almacenOrigen?{_id:e.product_selected._id,datos_generales:e.product_selected.datos_generales,medidas_producto:e.product_selected.medidas_producto,inventario_general:e.product_selected.inventario_general,unidades_de_venta:e.product_selected.unidades_de_venta,precios:e.product_selected.precios,empresa:e.product_selected.empresa,sucursal:e.product_selected.sucursal,usuario:e.product_selected.usuario}:{_id:e.product_selected._id,datos_generales:e.product_selected.datos_generales,precios:e.product_selected.precios,medidas_producto:[],inventario_general:[{unidad_maxima:""}],unidades_de_venta:[],empresa:e.product_selected.empresa,sucursal:e.product_selected.sucursal,usuario:e.product_selected.usuario};var s=!1,d=o,j=[];for(var u in t)a+=t[u].nuevaCantidad,j.push(t[u]);if(a>0){if(d.length){if(d.forEach((function(t){if(t.product_selected._id===e.product_selected._id)return s=!0,t.new_medidas=j,void(t.cantidad_total=a)})),!s){var b={product_selected:r,new_medidas:j,cantidad_total:parseInt(a),unidad_maxima:!1};d.push(b)}}else{var p={product_selected:r,new_medidas:j,cantidad_total:parseInt(a),unidad_maxima:!1};d.push(p)}i(Object(ea.a)(d)),c([]),l()}}catch(m){}},children:"AGREGAR"})})]})},Um=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),Bm=function(e){var t=Lm(),a=Object(s.useState)(""),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)({error:!1,mensaje:""}),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(!1),u=Object(v.a)(j,2),p=u[0],m=u[1],O=e.product_selected,x=e.setproduct_selected,f=e.tipoPieza,g=e.update,_=Object(s.useContext)(vm),C=_.setProductosTras,w=_.productosTras,I=function(t){try{if(d({error:!1,mensaje:""}),0===t||""===t)return;var a=w.find((function(e){return e.product_selected._id===O._id}));if(a){var n=t+a.cantidad_total;return void(e.add?void 0!==O.inventario_general?f.piezas?n<=O.inventario_general[0].cantidad_existente?a.cantidad_total+=t:d({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente del producto seleccionado."}):n<=O.inventario_general[0].cantidad_existente_maxima?a.cantidad_total+=t:d({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente del producto seleccionado."}):a.cantidad_total+=t:a.cantidad_total=t)}var c={_id:e.product_selected._id,datos_generales:e.product_selected.datos_generales,inventario_general:e.product_selected.inventario_general,unidades_de_venta:e.product_selected.unidades_de_venta,medidas_producto:e.product_selected.medidas_producto,precios:e.product_selected.precios,empresa:e.product_selected.empresa,sucursal:e.product_selected.sucursal,usuario:e.product_selected.usuario};if(void 0!==O.inventario_general)if(t<=O.inventario_general[0].cantidad_existente){var r={product_selected:c,new_medidas:[],cantidad_total:t,unidad_maxima:f.cajas};C([].concat(Object(ea.a)(w),[r]))}else d({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente."});else{var i={product_selected:c,new_medidas:[],cantidad_total:t,unidad_maxima:f.cajas};C([].concat(Object(ea.a)(w),[i]))}return}catch(l){}};function k(t){var a=t.toString().replace(/[^0-9]/g,""),n=parseInt(a);try{if(null===e.almacenOrigen)return void r(n);if(f.piezas){if(n<=O.inventario_general[0].cantidad_existente)return void r(n)}else if(n<=O.inventario_general[0].cantidad_existente_maxima)return void r(n)}catch(l){}}Object(s.useEffect)((function(){try{e.add&&m(!0),r(e.cant)}catch(l){}}),[O]);var N,F,z=function(){try{var e={Pz:{unidad_maxima:null,unidad_minima:"Pz"},Caja:{unidad_maxima:"Caja",unidad_minima:"Pz"},Kg:{unidad_maxima:null,unidad_minima:"Kg"},Costal:{unidad_maxima:"Costal",unidad_minima:"Kg"},Lt:{unidad_maxima:null,unidad_minima:"Lt"}};return Object(V.jsxs)(b.a,{flexDirection:"row",display:"flex",children:[Object(V.jsxs)(b.a,{flexDirection:"row",children:[Object(V.jsx)(na.a,{checked:f.piezas,color:"primary",onChange:function(){g(),r(0)},disabled:null===e[O.precios.unidad_de_compra.unidad].unidad_maxima}),Object(V.jsx)(y.a,{color:"primary",style:{marginLeft:10},children:e[O.precios.unidad_de_compra.unidad].unidad_minima})]}),null!==e[O.precios.unidad_de_compra.unidad].unidad_maxima?Object(V.jsxs)(b.a,{flexDirection:"row",children:[Object(V.jsx)(na.a,{checked:f.cajas,color:"primary",onChange:function(){g(),r(0)}}),Object(V.jsxs)(y.a,{color:"primary",style:{marginLeft:10},children:[e[O.precios.unidad_de_compra.unidad].unidad_maxima," "]})]}):Object(V.jsx)("div",{})]})}catch(l){}};return Object(V.jsx)(ye.a,{className:Object(hm.a)(t.root,Object(h.a)({},t.highlight,void 0!==O)),children:Object(V.jsxs)(Fe.a,{container:!0,children:[void 0!==O?Object(V.jsx)(b.a,{style:{width:"100%"},children:Object(V.jsx)(y.a,{className:t.title,color:"inherit",variant:"subtitle2",children:O.datos_generales.nombre_comercial})}):Object(V.jsx)(y.a,{className:t.title,variant:"h6",id:"tableTitle",component:"div",children:e.title}),void 0!==O?Object(V.jsxs)(b.a,{children:[l.error?Object(V.jsx)(y.a,{color:"inherit",children:l.mensaje}):Object(V.jsx)("div",{}),e.add?"OTROS"===O.datos_generales.tipo_producto?Object(V.jsxs)(Fe.a,{container:!0,justifyContent:"space-evenly",ml:1,children:[null===e.almacenOrigen?Object(V.jsx)(z,{}):Object(V.jsxs)(b.a,{flexDirection:"row",display:"flex",children:[Object(V.jsxs)(b.a,{flexDirection:"row",children:[Object(V.jsx)(na.a,{checked:f.piezas,color:"primary",onChange:function(){g(),r(0)},disabled:null===e.product_selected.inventario_general[0].cantidad_existente_maxima}),Object(V.jsx)(y.a,{color:"primary",style:{marginLeft:10},children:e.product_selected.inventario_general[0].unidad_inventario})]}),null!==e.product_selected.inventario_general[0].cantidad_existente_maxima?Object(V.jsxs)(b.a,{flexDirection:"row",children:[Object(V.jsx)(na.a,{checked:f.cajas,color:"primary",onChange:function(){g(),r(0)}}),Object(V.jsxs)(y.a,{color:"primary",style:{marginLeft:10},children:[""+e.product_selected.inventario_general[0].unidad_maxima," "]})]}):Object(V.jsx)("div",{})]}),Object(V.jsxs)(b.a,{width:"180px",ml:2,children:[Object(V.jsx)(y.a,{color:"primary",children:"Cantidad"}),Object(V.jsx)(S.a,{className:t.inputCantidad,size:"small",name:"cantidad",variant:"outlined",type:"number",InputProps:{inputProps:{min:0}},value:c,onChange:function(e){return k(e.target.value)}}),Object(V.jsx)(Aa.a,{title:"Agregar",children:Object(V.jsx)(X.a,{"aria-label":"add",onClick:function(){return I(c)},children:Object(V.jsx)(En.a,{})})})]}),e.almacenOrigen?Object(V.jsx)(b.a,{width:"150px",children:null!==e.product_selected.inventario_general[0].cantidad_existente_maxima?Object(V.jsx)(y.a,{color:"primary",style:{flexWrap:"wrap"},children:(N=e.product_selected.inventario_general[0].cantidad_existente_maxima,F=e.product_selected.inventario_general[0].unidad_maxima,{Caja:"Cantidad existente en cajas: "+N,Costal:"Cantidad existente en costales: "+N}[F])}):Object(V.jsx)("div",{})}):Object(V.jsx)("div",{})]}):Object(V.jsx)("div",{children:Object(V.jsx)(Vm,{openTallas:p,setOpenTallas:m,setproduct_selected:x,product_selected:O,almacenOrigen:e.almacenOrigen,obtenerConsultasProducto:e.obtenerConsultasProducto,refetch:e.refetch})}):Object(V.jsxs)(Fe.a,{width:"100%",container:!0,children:["OTROS"===O.datos_generales.tipo_producto?Object(V.jsxs)("div",{children:[Object(V.jsx)(y.a,{color:"primary",children:"Cantidad"}),Object(V.jsx)(S.a,{className:t.inputCantidad,size:"small",name:"cantidad",variant:"outlined",type:"number",InputProps:{inputProps:{min:0}},value:c,onChange:function(e){return k(e.target.value)}}),Object(V.jsx)(Aa.a,{title:"Agregar",children:Object(V.jsx)(X.a,{"aria-label":"add",onClick:function(){return I(c)},children:Object(V.jsx)(En.a,{})})})]}):Object(V.jsx)(Vm,{openTallas:p,setOpenTallas:m,setproduct_selected:x,product_selected:O,almacenOrigen:e.almacenOrigen,obtenerConsultasProducto:e.obtenerConsultasProducto,refetch:e.refetch}),Object(V.jsxs)(b.a,{mt:3,children:["OTROS"!==O.datos_generales.tipo_producto?Object(V.jsx)(Aa.a,{title:"Editar",children:Object(V.jsx)(X.a,{"aria-label":"delete",onClick:function(){return function(){try{"OTROS"!==O.datos_generales.tipo_producto&&m(!0)}catch(l){}}()},children:Object(V.jsx)(_m.a,{})})}):Object(V.jsx)("div",{}),Object(V.jsx)(Aa.a,{title:"Eliminar",children:Object(V.jsx)(X.a,{"aria-label":"delete",onClick:function(){return function(){try{var e=[];w.length&&(e=w),x(void 0),C(e.filter((function(e){return e.product_selected._id!==O._id})))}catch(l){}}()},children:Object(V.jsx)(Wu.a,{})})})]})]})]}):Object(V.jsx)("div",{})]})})},Jm=Object(k.a)((function(e){return{root:{marginLeft:e.spacing(1),marginRight:e.spacing(1)},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:600,maxWidth:600},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function Gm(e){var t=Jm(),a=Object(s.useState)("asc"),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)("calories"),o=Object(v.a)(i,2),d=o[0],j=o[1],b=Object(s.useState)(void 0),p=Object(v.a)(b,2),m=p[0],O=p[1],x=Object(s.useState)(0),h=Object(v.a)(x,2),f=h[0],g=h[1],_=l.a.useState(0),C=Object(v.a)(_,2),y=C[0],S=C[1],w=Object(s.useState)(5),I=Object(v.a)(w,2),k=I[0],N=(I[1],Object(s.useState)({piezas:!0,cajas:!1})),F=Object(v.a)(N,2),z=F[0],P=F[1],D=JSON.parse(localStorage.getItem("sesionCafi")),E=Object(s.useContext)(vm),A=E.productosTras,T=E.productosTo,W=E.productosEmpTo,R=Object(He.a)(pn,{variables:{empresa:D.empresa._id,sucursal:D.sucursal._id}}),$=e.add?e.almacenOrigen?T:W:A,M=function(t,a,n){if("OTROS"===a.datos_generales.tipo_producto&&g(e.add?0:n),void 0!==m){var c=m._id===a._id;O(c?void 0:a)}else O(a)},L=k-Math.min(k,$.length-y*k);return Object(V.jsx)("div",{className:t.root,children:Object(V.jsxs)(Da.a,{className:t.paper,children:[Object(V.jsx)(Bm,{product_selected:m,setproduct_selected:O,title:e.title,add:e.add,almacenOrigen:e.almacenOrigen,productosTras:A,tipoPieza:z,update:function(){P(Object(u.a)(Object(u.a)({},z),{},{piezas:!z.piezas,cajas:!z.cajas}))},cant:f,obtenerConsultasProducto:R.data?R.data.obtenerConsultasProducto:[],refetch:R.refetch?R.refetch:null}),Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{className:t.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table",children:[Object(V.jsx)(Mm,{classes:t,product_selected:m,order:c,orderBy:d,handleSelectAllClick:function(e){if(e.target.checked){$.map((function(e){return e.name}));O(e.target.checked)}else O([])},onRequestSort:function(e,t){r(d===t&&"asc"===c?"desc":"asc"),j(t)},rowCount:$.length}),Object(V.jsxs)(la.a,{children:[Rm($,Wm(c,d)).slice(y*k,y*k+k).map((function(t,a){var n,c=(n=e.add?t._id:t.product_selected._id,void 0!==m&&!(m._id!==n)),r="enhanced-table-checkbox-".concat(a);return e.add?e.almacenOrigen?Object(V.jsxs)(oa.a,{hover:!0,onClick:function(e){return M(0,t)},role:"checkbox","aria-checked":c,tabIndex:-1,selected:c,children:[Object(V.jsx)(sa.a,{id:r,scope:"row",children:null==t.datos_generales.codigo_barras?"SIN C\xd3DIGO":t.datos_generales.codigo_barras}),Object(V.jsx)(sa.a,{component:"th",id:r,scope:"row",children:t.datos_generales.nombre_comercial}),Object(V.jsxs)(sa.a,{children:[" ",t.datos_generales.tipo_producto]}),Object(V.jsxs)(sa.a,{children:[" ",t.inventario_general[0].cantidad_existente,"  ",t.inventario_general[0].unidad_inventario," "]})]},t._id):Object(V.jsxs)(oa.a,{hover:!0,onClick:function(e){return M(0,t)},role:"checkbox","aria-checked":c,tabIndex:-1,selected:c,children:[Object(V.jsx)(sa.a,{id:r,scope:"row",children:null==t.datos_generales.codigo_barras?"SIN C\xd3DIGO":t.datos_generales.codigo_barras}),Object(V.jsx)(sa.a,{component:"th",id:r,scope:"row",children:t.datos_generales.nombre_comercial}),Object(V.jsxs)(sa.a,{align:"right",children:[" ",t.datos_generales.tipo_producto]}),Object(V.jsx)(sa.a,{align:"right",children:" N/A"})]},t._id):Object(V.jsxs)(oa.a,{hover:!0,onClick:function(e){return M(0,t.product_selected,t.cantidad_total)},role:"checkbox","aria-checked":c,tabIndex:-1,selected:c,children:[Object(V.jsx)(sa.a,{id:r,scope:"row",children:null==t.product_selected.datos_generales.codigo_barras?"SIN C\xd3DIGO":t.product_selected.datos_generales.codigo_barras}),Object(V.jsx)(sa.a,{component:"th",id:r,scope:"row",children:t.product_selected.datos_generales.nombre_comercial}),Object(V.jsxs)(sa.a,{align:"right",children:[" ",t.product_selected.datos_generales.tipo_producto]}),Object(V.jsxs)(sa.a,{align:"right",children:[" ",t.cantidad_total]})]},t._id)})),L>0&&Object(V.jsx)(oa.a,{style:{height:53*L},children:Object(V.jsx)(sa.a,{colSpan:6})})]})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[5,10,25],component:"div",count:$.length,rowsPerPage:k,page:y,onPageChange:function(e,t){S(t)},labelRowsPerPage:""})]})})}var qm=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:50},imagen:{width:50},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& span":{color:"red"}},subtitle:{marginLeft:"10px",width:"50%"},boxUpData:{height:80},formControl:{margin:e.spacing(1),minWidth:300,maxWidth:300},selected2:{width:"50%",height:50},selected:{width:"50%",height:50},input:{width:"100%"},inputBox:{margin:20,marginTop:5,marginBottom:10},button:{margin:e.spacing(3),marginTop:e.spacing(2),marginBottom:e.spacing(0)},boxControl:{margin:e.spacing(2.5),marginTop:0,minWidth:"20%",maxWidth:"20%",minHeight:20},centerControl:{marginTop:10}}}));function Hm(e,t,a){return{fontWeight:-1===t.indexOf(e)?a.typography.fontWeightRegular:a.typography.fontWeightMedium}}var Ym=Object(s.forwardRef)((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),Xm={PaperProps:{style:{maxHeight:908,width:400}}},Km=["Barco","Moto","Carro","Camioneta"],Qm=["Datos traspaso","Seleccionar productos"];function Zm(){var e=qm(),t=Object(ve.a)(),a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(s.useContext)(vm),c=n.setProductos,r=n.setProductosTras,i=n.setProductosTo,o=n.setProductosEmpTo,l=n.productosTras,d=Object(s.useState)({message:"",status:"",open:!1}),j=Object(v.a)(d,2),p=j[0],m=j[1],O=Object(s.useState)(!1),x=Object(v.a)(O,2),h=x[0],f=x[1],C=Object(s.useState)(!1),I=Object(v.a)(C,2),k=I[0],F=I[1],z=Object(s.useState)(""),P=Object(v.a)(z,2),D=P[0],E=P[1],A=Object(ps.a)(D,1e3),T=Object(v.a)(A,1)[0],W=Object(s.useState)(!1),R=Object(v.a)(W,2),$=R[0],M=R[1],L=Object(s.useState)(null),U=Object(v.a)(L,2),J=U[0],K=U[1],Q=Object(s.useState)(!1),Z=Object(v.a)(Q,2),ee=Z[0],te=Z[1],ae=Object(s.useState)(!1),ne=Object(v.a)(ae,2),ce=ne[0],re=ne[1],ie=Object(s.useState)(null),oe=Object(v.a)(ie,2),se=oe[0],le=oe[1],de=Object(s.useState)(null),je=Object(v.a)(de,2),ue=je[0],be=je[1],pe=Object(s.useState)([]),me=Object(v.a)(pe,2),Oe=me[0],xe=me[1],he=Object(s.useState)(""),fe=Object(v.a)(he,2),ge=fe[0],_e=fe[1],we=Object(s.useState)(""),Ie=Object(v.a)(we,2),ke=Ie[0],Ne=Ie[1],Pe=Object(s.useState)(""),Ae=Object(v.a)(Pe,2),Re=Ae[0],$e=Ae[1],Me=Object(s.useState)(0),Le=Object(v.a)(Me,2),Ue=Le[0],Be=Le[1],Je=Object(s.useState)(new Set),Ge=Object(v.a)(Je,2),qe=Ge[0],Ye=Ge[1],Xe=Object(s.useState)(!1),Ke=Object(v.a)(Xe,2),Qe=Ke[0],Ze=Ke[1],et=Object(N.a)(Fn),tt=Object(v.a)(et,1)[0],at=[],nt=[],ct=Object(He.a)(wn,{variables:{id:a.sucursal._id},fetchPolicy:"network-only"}),rt=Object(He.a)(Jj,{variables:{empresa:a.empresa._id,sucursal:a.sucursal._id},fetchPolicy:"network-only"}),it=Object(He.a)(Nn,{variables:{empresa:a.empresa._id,sucursal:a.sucursal._id},fetchPolicy:"network-only"}),ot=Object(He.a)(On,{variables:{empresa:a.empresa._id,sucursal:a.sucursal._id,filtro:T,almacen:se?se._id:"",existencias:!0},fetchPolicy:"network-only"}),st=Object(He.a)(zn,{variables:{empresa:a.empresa._id,filtro:T},fetchPolicy:"network-only"}),lt=function(){try{xe(ct.data.obtenerAlmacenes.filter((function(e){return e._id!==se._id})))}catch(e){console.log(e)}};Object(s.useEffect)((function(){se&&(lt(),jt())}),[se,lt]);var dt=Object(s.useCallback)(Object(_.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{st.refetch()}catch(t){console.log("errorObtenerProductosEmpresa",t)}case 1:case"end":return e.stop()}}),e)}))),[st]),jt=Object(s.useCallback)(Object(_.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{ot.refetch()}catch(t){}case 1:case"end":return e.stop()}}),e)}))),[ot]);Object(s.useEffect)((function(){try{null!==J&&("N/A"===J.origen?dt():jt())}catch(e){console.log("conceptoTraspaso",e)}}),[J]),Object(s.useEffect)((function(){null!==J&&("N/A"===J.destino?M(null!==se):"N/A"===J.origen?M(null!==ue):M(null!==se&&null!==ue))}),[J,se,ue,M]),Object(s.useEffect)((function(){st.data&&o(st.data.obtenerProductosPorEmpresa)}),[st.data,o]),Object(s.useEffect)((function(){if(ot.data)return c(ot.data.obtenerProductos),void i(ot.data.obtenerProductos)}),[ot,c,i]),Object(s.useEffect)((function(){F(!0),it.refetch(),F(!1)}),[it]);var ut=function(){f(!1)},bt=function(e){return qe.has(e)},pt=function(){Be((function(e){return e-1}))};rt.data&&(at=rt.data.obtenerConceptosAlmacen),ct.data&&(nt=ct.data.obtenerAlmacenes);var mt=function(){Ze(!Qe)},Ot=function(){var e=Object(_.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!l.length){e.next=12;break}return Ze(!1),F(!0),t={variables:{input:{concepto_traspaso:{_id:J._id,nombre_concepto:J.nombre_concepto,destino:J.destino,origen:J.origen,editable:J.editable},almacen_origen:null!==se?se._id:"",almacen_destino:null!==ue?ue._id:"",productos:l,datos_transporte:{transporte:ge,placas:ke,nombre_encargado:Re},sucursalOrigen:a.sucursal._id,sucursalDestino:a.sucursal._id,fecha_registro:xt()().locale("es-mx").format()},usuario:a._id,empresa:a.empresa._id}},e.next=7,tt(t);case 7:n=e.sent,m({message:n.data.crearTraspaso.message,status:n.data.crearTraspaso.resp,open:!0}),"error"!==n.data.crearTraspaso.resp&&(r([]),le(null),be(null),K(null),pt()),e.next=13;break;case 12:m({message:"No es posible realizar un traspaso sin agregar productos.",status:"error",open:!0});case 13:F(!1),e.next=22;break;case 16:e.prev=16,e.t0=e.catch(0),F(!1),Ze(!1),void 0!==e.t0.networkError?console.log("traspaso networkError",e.t0.networkError):void 0!==e.t0.graphQLErrors&&console.log("traspaso graphQLErrors",e.t0.graphQLErrors),m({message:"Ocurri\xf3 un error al realizar el traspaso...",status:"error",open:!0});case 22:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsx)(V.Fragment,{children:Object(V.jsxs)(b.a,{sx:{width:"100%"},children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){f(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Ce.a,{className:e.icon})}),Object(V.jsxs)(Fe.a,{container:!0,spacing:10,justify:"center",children:[Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:xm,alt:"icono almacen",className:e.imagen})})})}),Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(b.a,{display:"flex",flexDirection:"column",children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:xm,alt:"icono almacen",className:e.imagen})})})})})]}),"Traspasos"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:h,onClose:ut,TransitionComponent:Ym,children:[Object(V.jsx)(Ve,{loading:k,setLoading:F}),Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Traspasos"}),Object(V.jsx)(b.a,{mx:3,children:Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:ut,children:Object(V.jsx)(zt.a,{style:{fontSize:30}})})})}),Object(V.jsx)(X.a,{edge:"start",color:"inherit",onClick:ut,"aria-label":"close"})]})}),Object(V.jsx)(b.a,{style:{width:"50%",alignSelf:"center"},children:Object(V.jsx)(pm.a,{activeStep:Ue,children:Qm.map((function(e,t){var a={};return bt(t)&&(a.completed=!1),Object(V.jsx)(mm.a,Object(u.a)(Object(u.a)({},a),{},{children:Object(V.jsx)(Om.a,Object(u.a)(Object(u.a)({},{}),{},{children:e}))}),e)}))})}),Object(V.jsxs)(b.a,{children:[0===Ue?Object(V.jsx)(Fe.a,{container:!0,justify:"center",children:Object(V.jsx)(Fe.a,{item:!0,lg:6,children:Object(V.jsxs)(b.a,{children:[Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{className:e.subtitle,children:Object(V.jsx)("b",{children:"Datos traspaso"})}),Object(V.jsx)(Te.a,{}),Object(V.jsxs)(b.a,{mt:2,style:{display:"flex",width:"100%",justifyContent:"center"},children:[Object(V.jsxs)(b.a,{m:3,children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Usuario"})}),Object(V.jsxs)(y.a,{children:[" ",a.nombre," "]})]}),Object(V.jsxs)(b.a,{m:3,children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Sucursal"})}),Object(V.jsxs)(y.a,{children:[" ",a.sucursal.nombre_sucursal," "]})]}),Object(V.jsxs)(b.a,{m:3,children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Fecha"})}),Object(V.jsxs)(y.a,{children:["  ",xt()().format("MM/DD/YYYY")," "]})]})]}),Object(V.jsxs)(b.a,{m:2,style:{width:"100%",justifyContent:"center"},children:[Object(V.jsx)(b.a,{style:{width:"100%"},children:Object(V.jsxs)(G.a,{className:e.formControl,children:[Object(V.jsx)(q.a,{id:"concepto-label",children:"Concepto traspaso"}),Object(V.jsx)(De.a,{labelId:"concepto-label",id:"concepto-name",value:J||"",onChange:function(e){try{var t=e.target.value;xe([]),nt=[],le(null),be(null),"N/A"===t.origen?xe(ct.data.obtenerAlmacenes):xe([]),te("N/A"!==t.origen),re("N/A"!==t.destino),K(t)}catch(a){}},input:Object(V.jsx)(Pa.a,{}),MenuProps:Xm,children:at.map((function(e){return Object(V.jsx)(Ee.a,{value:e,children:e.nombre_concepto},e._id)}))})]})}),null!==J?Object(V.jsxs)(b.a,{style:{display:"flex"},children:[ee?Object(V.jsx)(b.a,{children:Object(V.jsxs)(G.a,{className:e.formControl,children:[Object(V.jsx)(q.a,{id:"almacen-origen-label",children:"Almac\xe9n origen"}),Object(V.jsx)(De.a,{labelId:"almacen-origen-label",id:"almacen-origen-name",value:se||"",onChange:function(e){le(e.target.value),r([])},input:Object(V.jsx)(Pa.a,{}),MenuProps:Xm,children:nt.map((function(e){return Object(V.jsx)(Ee.a,{value:e,children:e.nombre_almacen},e._id)}))})]})}):Object(V.jsx)(V.Fragment,{}),ce?Object(V.jsxs)(G.a,{className:e.formControl,children:[Object(V.jsx)(q.a,{id:"almacen-destino-label",children:"Almac\xe9n destino"}),Object(V.jsx)(De.a,{labelId:"almacen-destino-label",id:"almacen-destino-name",value:ue||"",onChange:function(e){be(e.target.value),r([])},input:Object(V.jsx)(Pa.a,{}),MenuProps:Xm,children:Oe.map((function(e){return Object(V.jsx)(Ee.a,{value:e,children:e.nombre_almacen},e._id)}))})]}):Object(V.jsx)(V.Fragment,{})]}):Object(V.jsx)(V.Fragment,{})]})]}),Object(V.jsxs)(b.a,{className:e.centerControl,style:{width:"100%"},children:[Object(V.jsx)(y.a,{className:e.subtitle,children:Object(V.jsx)("b",{children:"Datos transporte traspaso"})}),Object(V.jsx)(Te.a,{}),Object(V.jsxs)(Fe.a,{justify:"center",children:[Object(V.jsxs)(G.a,{className:e.formControl,style:{marginTop:15},children:[Object(V.jsx)(q.a,{id:"transporte-label",children:"Transporte"}),Object(V.jsx)(De.a,{labelId:"transporte-label",id:"transporte-name",value:ge,onChange:function(e){_e(e.target.value)},input:Object(V.jsx)(Pa.a,{}),MenuProps:Xm,children:Km.map((function(e){return Object(V.jsx)(Ee.a,{value:e,style:Hm(e,ge,t),children:e},e)}))})]}),Object(V.jsxs)(b.a,{justify:"center",children:[Object(V.jsxs)(G.a,{className:e.formControl,children:[Object(V.jsx)(y.a,{children:"Placas"}),Object(V.jsx)(S.a,{fullWidth:!0,className:e.input,type:"text",size:"small",name:"placas",variant:"outlined",value:ke.toUpperCase(),onChange:function(e){return Ne(e.target.value)}})]}),Object(V.jsxs)(G.a,{className:e.formControl,children:[Object(V.jsx)(y.a,{children:"Nombre de encargado de transporte"}),Object(V.jsx)(S.a,{fullWidth:!0,className:e.input,type:"text",size:"small",name:"nombreQuien",variant:"outlined",value:Re,onChange:function(e){return $e(e.target.value)}})]})]})]})]})]})})}):Object(V.jsx)(b.a,{children:Object(V.jsxs)(b.a,{style:{width:"100%"},ml:1,children:[Object(V.jsx)(y.a,{className:e.subtitle,children:Object(V.jsx)("b",{children:"Buscar producto"})}),Object(V.jsx)(b.a,{style:{width:"500px"},children:Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsx)(H.a,{id:"search-producto",type:"text",value:D,onChange:function(e){return E(e.target.value)},endAdornment:Object(V.jsx)(Y.a,{position:"start",children:Object(V.jsx)(X.a,{type:"submit","aria-label":"search producto",edge:"end",children:Object(V.jsx)(xc.a,{})})})})})}),Object(V.jsx)(b.a,{mt:2,children:Object(V.jsxs)(Fe.a,{container:!0,spacing:2,style:{width:"100%"},children:[Object(V.jsx)(Fe.a,{item:!0,md:6,children:ee?Object(V.jsx)(Gm,{title:"Productos",add:!0,almacenOrigen:se}):Object(V.jsx)(Gm,{title:"Productos",add:!0,almacenOrigen:null})}),Object(V.jsx)(Fe.a,{item:!0,md:6,children:Object(V.jsx)(Gm,{title:"Productos a traspasar",add:!1,almacenOrigen:se})})]})})]})}),Object(V.jsxs)(b.a,{style:{display:"flex",flexDirection:"row",pt:2},children:[Object(V.jsx)(w.a,{color:"inherit",disabled:0===Ue,onClick:pt,sx:{mr:1},children:"Atr\xe1s"}),Object(V.jsx)(b.a,{style:{flex:"1 1 auto"}}),Object(V.jsx)(w.a,{disabled:!$,onClick:function(){return Ue<Qm.length-1?function(){var e=qe;bt(Ue)&&(e=new Set(e.values())).delete(Ue),Be((function(e){return e+1})),Ye(e)}():mt()},children:Ue<Qm.length-1?"Siguiente":"Terminar"})]})]}),Object(V.jsxs)(ze.a,{open:Qe,onClose:mt,children:[Object(V.jsx)(wt.a,{children:"\xbfEst\xe1 seguro de realizar este traspaso?"}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:function(){return mt()},color:"primary",children:"Cancelar"}),Object(V.jsx)(w.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:function(){return Ot()},children:"Traspasar"})]})]}),Object(V.jsx)(B,{alert:p,setAlert:m})]})]})})}var eO=a(460),tO=a.n(eO),aO=Co.a.ExcelFile,nO=Co.a.ExcelSheet,cO=Co.a.ExcelColumn;var rO=Object(x.f)((function(e){return Object(V.jsx)(s.Fragment,{children:Object(V.jsx)(Fe.a,{children:Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsx)(aO,{element:Object(V.jsx)(w.a,{size:"large",color:"primary",variant:"contained",startIcon:Object(V.jsx)(tO.a,{}),children:"Exportar Excel"}),filename:e.fileName,children:Object(V.jsx)(nO,{data:e.data,name:e.fileName,children:e.columnName.map((function(e){return Object(V.jsx)(cO,{label:e.label,value:e.id})}))})})})})})})),iO=Object(k.a)({root:{width:"100%"},container:{maxHeight:"70vh"}});function oO(e){var t=iO(),a=l.a.useState(0),n=Object(v.a)(a,2),c=n[0],r=n[1],i=l.a.useState(10),o=Object(v.a)(i,2),d=o[0],j=o[1],p=JSON.parse(localStorage.getItem("sesionCafi")),m=Object(He.a)(wn,{variables:{id:p.sucursal._id}}),O=m.loading,x=m.error,f=m.refetch,g=[],_=[{id:"codigo_barras",label:"C\xf3digo de barras",minWidth:60,widthPx:160},{id:"nombre_comercial",label:"Nombre comercial",minWidth:170,widthPx:160}];Object(s.useEffect)((function(){f()}),[f]),e.obtenerAlmacenes&&(e.obtenerAlmacenes.forEach((function(e){_.push({id:e._id,label:e.nombre_almacen,minWidth:60,widthPx:160})})),_.push({id:"total",label:"Total existencias",minWidth:60,widthPx:160}));var C=function(t){var a=t.producto,n=[],c={codigo_barras:a.datos_generales.codigo_barras,nombre_comercial:a.datos_generales.nombre_comercial,style:{font:{sz:"12"},alignment:{wrapText:!0,horizontal:"center",vertical:"top"},border:{bottom:{style:"thin",color:{rgb:"000000"}}}}},r=0;return e.obtenerAlmacenes.forEach((function(e){var t=a.existencia_almacenes.filter((function(t){return t._id.almacen._id===e._id}));t.length>0?(n.push(t[0].cantidad_existente),c=Object(u.a)(Object(u.a)({},c),{},Object(h.a)({},e._id,t[0].cantidad_existente)),r+=t[0].cantidad_existente):(n.push(0),c=Object(u.a)(Object(u.a)({},c),{},Object(h.a)({},e._id,0)))})),c=Object(u.a)(Object(u.a)({},c),{},{total:r}),g.push(c),Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(V.jsx)(sa.a,{style:{minWidth:60},children:a.datos_generales.codigo_barras}),Object(V.jsx)(sa.a,{style:{minWidth:170},children:a.datos_generales.nombre_comercial}),n.map((function(e,t){return Object(V.jsx)(sa.a,{style:{backgroundColor:"rgba(255, 253, 150, 0.1)",color:"black",fontSize:17,textAlign:"center",minWidth:60},children:e},t)})),Object(V.jsx)(sa.a,{style:{backgroundColor:"rgba(255, 253, 150, 0.1)",color:"black",fontSize:18,fontWeight:"bold",textAlign:"center",minWidth:60},children:r})]},a._id)};return O?Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})}):x?Object(V.jsx)(Je,{error:x}):Object(V.jsxs)("div",{children:[Object(V.jsxs)(Da.a,{className:t.root,children:[Object(V.jsx)(ra.a,{className:t.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,"aria-label":"sticky table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:_.map((function(e,t){return Object(V.jsx)(sa.a,{align:e.align,style:{textAlign:t>1?"center":"left",minWidth:e.minWidth,width:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{children:e.productos.slice(c*d,c*d+d).map((function(e,t){return Object(V.jsx)(C,{producto:e},t)}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[10,25,100],component:"div",count:e.productos.length,rowsPerPage:d,page:c,onChangePage:function(e,t){r(t)},onChangeRowsPerPage:function(e){j(+e.target.value),r(0)},labelRowsPerPage:"Renglones por p\xe1gina"})]}),e.productos.length>0?Object(V.jsx)(b.a,{m:2,alignContent:"flex-end",children:Object(V.jsx)(rO,{fileName:"Inventarios almacen",data:g,columnName:_})}):Object(V.jsx)("div",{})]})}var sO=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},boxControl:{margin:e.spacing(2.5),marginTop:0,minWidth:"20%",maxWidth:"20%"},icon:{fontSize:100},imagen:{width:100},inputBox:{margin:20},button:{margin:e.spacing(3)}}})),lO=Object(s.forwardRef)((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),dO={PaperProps:{style:{maxHeight:908,width:400}}};function jO(e,t,a){return{fontWeight:-1===t.indexOf(e)?a.typography.fontWeightRegular:a.typography.fontWeightMedium}}function uO(){var e=sO(),t=(Object(ve.a)(),l.a.useState(!1)),a=Object(v.a)(t,2),n=a[0],c=a[1];return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/conceptosAlmacen.svg",alt:"icono almacen",className:e.imagen})}),"Inventario por almacen"]})}),Object(V.jsx)(bO,{open:n,handleClose:function(){c(!1)}})]})}var bO=function(e){var t=sO(),a=Object(ve.a)(),n=l.a.useState(!0),c=Object(v.a)(n,2),r=c[0],i=c[1],o=l.a.useState({codigo_barras:"",clave_alterna:"",tipo_producto:"",nombre_comercial:"",nombre_generico:"",categoria:"",subcategoria:""}),s=Object(v.a)(o,2),d=s[0],j=s[1],p=l.a.useState({}),m=Object(v.a)(p,2),O=m[0],x=m[1],f=l.a.useState(""),g=Object(v.a)(f,1)[0],_=l.a.useState(""),C=Object(v.a)(_,1)[0],k=l.a.useState(""),N=Object(v.a)(k,2),F=N[0],z=N[1],P=l.a.useState(""),D=Object(v.a)(P,2),E=D[0],A=D[1],T=l.a.useState([]),W=Object(v.a)(T,2),R=W[0],$=W[1],M=Object(ps.a)(d,1e3),L=Object(v.a)(M,1)[0],U=JSON.parse(localStorage.getItem("sesionCafi")),B=[],J=[],H=[],Y=Object(He.a)(kn,{variables:{empresa:U.empresa._id,sucursal:U.sucursal._id,filtro:L}}),K=Object(He.a)(Nn,{variables:{empresa:U.empresa._id,sucursal:U.sucursal._id}}),Q=Object(He.a)(wn,{variables:{id:U.sucursal._id}});l.a.useEffect((function(){x(L)}),[L]),l.a.useEffect((function(){Y.refetch()}),[O,Y]),l.a.useEffect((function(){Q.refetch()}),[Q.update,Q]),l.a.useEffect((function(){Y.refetch(),i(!1)}),[Y]),l.a.useEffect((function(){K.refetch()}),[K.refetch]),Y.data&&(B=Y.data.obtenerProductosAlmacenes),K.data&&(J=K.data.obtenerCategorias),Q.data&&(H=Q.data.obtenerAlmacenes);var Z=function(e,t){try{if(i(!0),"categoria"===e&&""!==t){var a=J.find((function(e){return e.categoria===t}));$(a.subcategorias)}if("categoria"===e){var n=Object(u.a)(Object(u.a)({},d),{},{subcategoria:E,categoria:t});Y.refetch({filtro:n}),z(""!==t?t:""),A("")}var c;if("subcategoria"===e&&""!==t&&(Y.refetch({filtro:Object(u.a)(Object(u.a)({},d),{},{subcategoria:t,categoria:F})}),A(""!==t?t:"")),"categoria"!==e&&"subcategoria"!==e)j(Object(u.a)(Object(u.a)({},d),{},(c={},Object(h.a)(c,e,t),Object(h.a)(c,"subcategoria",E),Object(h.a)(c,"categoria",F),c)))}catch(r){}};return Object(V.jsxs)(ze.a,{fullScreen:!0,open:e.open,onClose:e.handleClose,TransitionComponent:lO,children:[Object(V.jsx)(Se.a,{className:t.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:t.title,children:"Almacenes"}),Object(V.jsx)(b.a,{mx:3,children:Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:e.handleClose,size:"large",children:Object(V.jsx)(zt.a,{style:{fontSize:30}})})})}),Object(V.jsx)(X.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"})]})}),Object(V.jsxs)(Fe.a,{container:!0,direction:"row",children:[Object(V.jsxs)(b.a,{width:"20%",className:t.inputBox,children:[Object(V.jsx)(y.a,{children:"C\xf3digo de barras"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",onChange:function(e){return Z("codigo_barras",e.target.value)}})})]}),Object(V.jsxs)(b.a,{width:"20%",className:t.inputBox,children:[Object(V.jsx)(y.a,{children:"Clave alterna"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"clave_alterna",id:"form-producto-clave-alterna",variant:"outlined",onChange:function(e){return Z("clave_alterna",e.target.value)}})})]}),Object(V.jsxs)(b.a,{width:"20%",className:t.inputBox,children:[Object(V.jsx)(y.a,{children:"Nombre comercial"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"clave_alterna",id:"form-producto-clave-alterna",variant:"outlined",onChange:function(e){return Z("nombre_comercial",e.target.value)}})})]}),Object(V.jsxs)(b.a,{width:"20%",className:t.inputBox,children:[Object(V.jsx)(y.a,{children:"Nombre g\xe9nerico"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"nombre_generico",id:"form-producto-nombre-generico",variant:"outlined",onChange:function(e){return Z("nombre_generico",e.target.value)}})})]}),Object(V.jsxs)(G.a,{className:t.boxControl,children:[Object(V.jsx)(q.a,{id:"tipo-label",children:"Tipo"}),Object(V.jsxs)(De.a,{labelId:"tipo-label",id:"tipo_producto",value:d.tipo_producto,onChange:function(e){return Z("tipo_producto",e.target.value)},input:Object(V.jsx)(Pa.a,{}),MenuProps:dO,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),Object(V.jsx)(Ee.a,{value:"ROPA",children:"Ropa"}),Object(V.jsx)(Ee.a,{value:"CALZADO",children:"Calzado"}),Object(V.jsx)(Ee.a,{value:"OTROS",children:"Otros"})]})]}),Object(V.jsxs)(G.a,{className:t.boxControl,children:[Object(V.jsx)(q.a,{id:"categoria-label",children:"Categor\xeda"}),Object(V.jsxs)(De.a,{labelId:"categoria-label",id:"categoria",value:F,onChange:function(e){return Z("categoria",e.target.value)},input:Object(V.jsx)(Pa.a,{}),MenuProps:dO,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona una"})}),J.map((function(e){return Object(V.jsx)(Ee.a,{value:e.categoria,style:jO(e._id,g,a),children:e.categoria},e._id)}))]})]}),Object(V.jsxs)(G.a,{className:t.boxControl,children:[Object(V.jsx)(q.a,{id:"subcategoria-label",children:"Subcategor\xeda"}),Object(V.jsxs)(De.a,{labelId:"subcategoria-label",id:"subcategoria",value:E,onChange:function(e){return Z("subcategoria",e.target.value)},input:Object(V.jsx)(Pa.a,{}),MenuProps:dO,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona una"})}),R.map((function(e){return Object(V.jsx)(Ee.a,{value:e.subcategoria,style:jO(e._id,C,a),children:e.subcategoria},e._id)}))]})]})]}),r?Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})}):Y.error||K.error?Object(V.jsx)(Je,{error:Y.error}):Object(V.jsx)(b.a,{mx:5,children:Object(V.jsx)(oO,{productos:B,obtenerAlmacenes:H})})]})};function pO(){return Object(V.jsx)(C.a,{children:Object(V.jsxs)(Fe.a,{container:!0,spacing:3,justify:"center",children:[Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(bm,{})})}),Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Cm,{children:Object(V.jsx)(Zm,{})})})}),Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(uO,{})})})]})})}var mO=[{id:"fecha",label:"Fecha",minWidth:100},{id:"hora",label:"Hora",minWidth:100},{id:"movimiento",label:"Movimieto",minWidth:100},{id:"usuario",label:"Usuario",minWidth:100},{id:"hTurno",label:"Horario Turno",minWidth:100},{id:"concepto",label:"Concepto",minWidth:100}],OO=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"70%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function xO(e){var t=e.loading,a=e.historial,n=OO();return t?Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsx)(V.Fragment,{children:Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(Da.a,{className:n.root,children:Object(V.jsx)(ra.a,{className:n.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:mO.map((function(e){return Object(V.jsx)(sa.a,{align:"center",style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{children:a.map((function(e){return Object(V.jsx)(hO,{datos:e},e._id)}))})]})})})})})}function hO(e){var t=e.datos,a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=function(){return r(!c)},o=OO();return console.log(t),Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",onClick:i,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:xt()(t.fecha_movimiento.completa).format("YYYY-MM-DD")}),Object(V.jsx)(sa.a,{align:"center",children:t.hora_moviento.completa}),Object(V.jsx)(sa.a,{align:"center",children:t.tipo_movimiento}),Object(V.jsx)(sa.a,{align:"center",children:t.nombre_usuario_creador}),Object(V.jsx)(sa.a,{align:"center",children:t.horario_turno}),Object(V.jsx)(sa.a,{align:"center",children:t.concepto})]}),Object(V.jsx)(ze.a,{fullWidth:!0,maxWidth:"xs",open:c,onClose:i,children:Object(V.jsx)(Pe.a,{children:Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{lg:12,xs:12,children:Object(V.jsx)(b.a,{textAlign:"center",p:2,children:Object(V.jsx)(y.a,{variant:"h6",children:"Informaci\xf3n de movimiento"})})}),Object(V.jsxs)(Fe.a,{lg:12,xs:12,children:[Object(V.jsx)(b.a,{display:"flex",textAlign:"left",p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Fecha Movimiento: "})," ",xt()(t.fecha_movimiento.completa).format("YYYY-MM-DD")]})}),Object(V.jsx)(b.a,{display:"flex",textAlign:"left",p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Hora Movimiento: "})," ",t.hora_moviento.completa]})}),Object(V.jsx)(b.a,{display:"flex",textAlign:"left",p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Usuario: "})," ",t.nombre_usuario_creador]})}),Object(V.jsx)(b.a,{display:"flex",textAlign:"left",p:1,children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Horario en Turno: "})})}),Object(V.jsx)(b.a,{display:"flex",textAlign:"left",p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Tipo Movimiento: "})," ",t.tipo_movimiento]})}),Object(V.jsx)(b.a,{display:"flex",textAlign:"left",p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Concepto: "})," ",t.concepto]})}),Object(V.jsx)(b.a,{display:"flex",textAlign:"left",p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Caja: "})," ",t.numero_caja]})}),Object(V.jsx)(Da.a,{className:o.root,children:Object(V.jsx)(ra.a,{className:o.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{align:"center",style:{minWidth:100},children:"Concepto"}),Object(V.jsx)(sa.a,{align:"center",style:{minWidth:100},children:"Monto depositado"})]})}),Object(V.jsxs)(la.a,{children:[Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)("b",{children:"Monto Total Efectivo:"})}),Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsxs)("b",{children:["$",t.montos_en_caja.monto_efectivo.monto]})})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"Creditos"}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_creditos.monto]})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"Tarjeta Debito"}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_debito.monto]})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"Tarjeta Credito"}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_credito.monto]})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"Monedero"}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_monedero.monto]})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"Cheques"}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_cheques.monto]})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"Transferencias"}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_transferencia.monto]})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"Vales de despensa"}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_vales_despensa.monto]})]})]})]})})})]})]})})})]})}var fO=a(145),gO=a.n(fO),_O=a(199),vO=a.n(_O),CO=a(171),yO=a.n(CO),SO=a(48),wO=a.n(SO),IO=Object(k.a)((function(e){return{title:{marginLeft:e.spacing(2),flex:1},appBar:{position:"relative"},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},icon:{fontSize:40,width:40},iconSave:{zIndex:10,position:"fixed",bottom:e.spacing(2),right:e.spacing(10)}}})),kO=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),NO=["TODOS","VENTA","DEPOSITO","RETIRO","TRANSFERENCIA"];function FO(e){var t=IO(),a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(s.useState)([]),c=Object(v.a)(n,2),r=c[0],i=c[1],o=Object(s.useState)([]),l=Object(v.a)(o,2),d=l[0],j=(l[1],Object(ha.useDebounce)(r,500)),p=Object(v.a)(j,1)[0],m=[],O=Object(He.a)(id,{variables:{id_Caja:e.cajaSelected._id,empresa:a.empresa._id,sucursal:a.sucursal._id,input:{tipo_movimiento:r.tipo_movimiento?r.tipo_movimiento:"",fecha_incio:r.fecha_incio?r.fecha_incio:"",fecha_fin:r.fecha_fin?r.fecha_fin:"",usuario:p.usuario?p.usuario:""}}}),x=O.data,f=O.refetch,g=O.loading;Object(s.useEffect)((function(){f()}),[f]);var _=[];x&&function(e){d.splice(0,d.length);for(var t=0;t<e.length;t++)_={fecha:e[t].fecha_movimiento.completa,hora_movimiento:e[t].hora_moviento.completa,nombre:e[t].nombre_usuario_creador,horario_turno:e[t].horario_turno,tipo_movimiento:e[t].tipo_movimiento,concepto:e[t].concepto,caja:e[t].numero_caja,monto_efectivo:e[t].montos_en_caja.monto_efectivo.monto,monto_creditos:e[t].montos_en_caja.monto_creditos.monto,monto_tarjeta_debito:e[t].montos_en_caja.monto_tarjeta_debito.monto,monto_tarjeta_credito:e[t].montos_en_caja.monto_tarjeta_credito.monto,monto_monedero:e[t].montos_en_caja.monto_monedero.monto,monto_cheques:e[t].montos_en_caja.monto_cheques.monto,monto_transferencia:e[t].montos_en_caja.monto_transferencia.monto,monto_vales_despensa:e[t].montos_en_caja.monto_vales_despensa.monto},d.push(_)}(m=x.obtenerHistorialCaja);var C=function(e){i(Object(u.a)(Object(u.a)({},r),{},Object(h.a)({},e.target.name,e.target.value)))};return Object(V.jsxs)(ze.a,{fullScreen:!0,open:e.open,onClose:function(){e.handleClose()},TransitionComponent:kO,children:[Object(V.jsx)(Se.a,{className:t.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsxs)(y.a,{variant:"h5",className:t.title,children:["Caja ",e.cajaSelected.numero_caja]}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:function(){e.handleClose()},size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(vO.a,{element:Object(V.jsxs)(w.a,{variant:"contained",color:"primary","aria-label":"Guardar",className:t.iconSave,children:[Object(V.jsx)(gO.a,{className:t.margin}),"Exportar"]}),filename:"Reporte de Historial de Caja ".concat(e.cajaSelected.numero_caja),children:Object(V.jsxs)(yO.a,{data:d,name:"Reporte de Historial de Caja ".concat(e.cajaSelected.numero_caja),children:[Object(V.jsx)(wO.a,{label:"Usuario",value:"nombre"}),Object(V.jsx)(wO.a,{label:"Fecha Movimiento",value:"fecha"}),Object(V.jsx)(wO.a,{label:"Hora Movimiento",value:"hora_movimiento"}),Object(V.jsx)(wO.a,{label:"Horario en Turno",value:"horario_turno"}),Object(V.jsx)(wO.a,{label:"Concepto",value:"concepto"}),Object(V.jsx)(wO.a,{label:"Tipo Movimiento",value:"tipo_movimiento"}),Object(V.jsx)(wO.a,{label:"No. de Caja",value:"caja"}),Object(V.jsx)(wO.a,{label:"M. en Efectivo",value:"monto_efectivo"}),Object(V.jsx)(wO.a,{label:"M. en Creditos",value:"monto_creditos"}),Object(V.jsx)(wO.a,{label:"M. en Tarjeta Debito",value:"monto_tarjeta_debito"}),Object(V.jsx)(wO.a,{label:"M. en Tarjeta Credito",value:"monto_tarjeta_credito"}),Object(V.jsx)(wO.a,{label:"M. en monedero",value:"monto_monedero"}),Object(V.jsx)(wO.a,{label:"M. en Cheques",value:"monto_cheques"}),Object(V.jsx)(wO.a,{label:"M. en Transferencia",value:"monto_transferencia"}),Object(V.jsx)(wO.a,{label:"M. en Vale Despensa",value:"monto_vales_despensa"})]})}),Object(V.jsx)(Fe.a,{item:!0,lg:12,md:12,xs:12,children:Object(V.jsxs)("div",{className:t.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Movimiento"}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"form-producto-tipo",name:"tipo_movimiento",onChange:C,value:r.tipo_movimiento?r.tipo_movimiento:"",children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),NO.map((function(e,t){return Object(V.jsx)(Ee.a,{value:e,children:e},t)}))]})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha inicio:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_incio",variant:"outlined",type:"date",value:r.fecha_incio?r.fecha_incio:"",onChange:C})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha fin:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_fin",variant:"outlined",type:"date",value:r.fecha_fin?r.fecha_fin:"",onChange:C})]}),Object(V.jsx)("form",{onSubmit:function(e){e.preventDefault(),f()},style:{display:"flex",alignItems:"center",width:"100%"},children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Usuario:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"usuario",variant:"outlined",value:r.usuario?r.usuario:"",onChange:C})]})}),Object(V.jsx)(b.a,{width:"70%",display:"flex",justifyContent:"center",justifyItems:"center",alignItems:"center",children:Object(V.jsx)(b.a,{mt:2,children:Object(V.jsx)(w.a,{color:"primary",size:"large",variant:"contained",onClick:function(){i([])},children:"Limpiar"})})})]})}),Object(V.jsx)(Fe.a,{item:!0,lg:12,md:12,xs:12,children:Object(V.jsx)(xO,{loading:g,historial:m})})]})]})}var zO=a(14),PO=a(909),DO=a(910),EO=a(262),AO=Object(zO.a)((function(e){return{badge:{color:function(e){return e.props.color},background:function(e){return e.props.color},boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(uc.a),TO=Object(k.a)((function(e){return{root:{minWidth:230,maxWidth:230,margin:5},media:{height:0,paddingTop:"56.25%"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{color:EO.a[500]},textActive:{position:"relative",bottom:8}}}));function WO(e){var t={color:e.activa?"#44b700":"red"},a=TO();return Object(V.jsx)("div",{children:Object(V.jsxs)(PO.a,{className:a.root,children:[Object(V.jsx)(DO.a,{color:"secondary",avatar:Object(V.jsx)(AO,{overlap:"circle",props:t,anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",badgeContent:"",children:Object(V.jsx)(qt.a,{alt:"Cajero X",src:"/static/images/avatar/1.jpg"})})}),Object(V.jsx)(b.a,{m:1,mb:2,children:Object(V.jsxs)(y.a,{variant:"h4",color:"textSecondary",component:"p",children:["Caja ",e.name]})})]})})}var RO=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),$O=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function MO(){var e,t=RO(),a=l.a.useState(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=l.a.useState(!1),o=Object(v.a)(i,2),d=o[0],j=o[1],u=l.a.useState(!1),p=Object(v.a)(u,2),m=p[0],O=p[1],x=Object(s.useState)({message:"",status:"",open:!1}),h=Object(v.a)(x,2),f=h[0],g=h[1],_=l.a.useState({name:""}),C=Object(v.a)(_,2),S=C[0],I=C[1],k=JSON.parse(localStorage.getItem("sesionCafi")),N=[],F=Object(He.a)(cd,{variables:{empresa:k.empresa._id,sucursal:k.sucursal._id}}),z=F.data,P=F.refetch;Object(s.useEffect)((function(){r(!0),P(),r(!1)}),[P]),z&&(N=z.obtenerCajasSucursal);var D=function(){O(!0)},E=function(){j(!1)};return Object(V.jsxs)("div",{children:[Object(V.jsx)(B,{alert:f,setAlert:g}),Object(V.jsx)(Ve,{loading:c,setLoading:r}),Object(V.jsx)(w.a,{fullWidth:!0,onClick:function(){j(!0)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/cajas.svg",alt:"icono numero calzado",className:t.icon})}),"Historial de Cajas"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:d,onClose:E,TransitionComponent:$O,children:[Object(V.jsx)(Se.a,{className:t.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:t.title,children:"Historial de Cajas"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:E,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(Fe.a,{container:!0,spacing:1,justify:"center",children:null===(e=N)||void 0===e?void 0:e.map((function(e,t){return Object(V.jsx)(w.a,{onClick:function(){D(),I(e)},children:Object(V.jsx)(WO,{name:e.numero_caja,activa:e.activa,cantidad_efectivo_actual:e.cantidad_efectivo_actual})},t)}))})]}),Object(V.jsx)(FO,{open:m,fetchCajas:P,handleClickOpen:D,cajaSelected:S,handleClose:function(){O(!1)},obtenerCajasSucursal:N})]})}var LO,VO,UO=a(798),BO=[{id:"fecha",label:"Fecha",minWidth:100},{id:"hora",label:"Hora",minWidth:100},{id:"usuario",label:"Usuario",minWidth:100},{id:"hTurno",label:"Horario Turno",minWidth:100},{id:"concepto",label:"Concepto",minWidth:100},{id:"caja",label:"Caja",minWidth:100}],JO=Object(k.a)((function(e){return{root:{width:"100%"},container:{maxHeight:500},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function GO(e){var t=e.loading,a=e.turnos,n=JO();return t?Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsx)(V.Fragment,{children:Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(Da.a,{className:n.root,children:Object(V.jsx)(ra.a,{className:n.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:BO.map((function(e){return Object(V.jsx)(sa.a,{align:"center",style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{children:a.map((function(e){return Object(V.jsx)(qO,{turno:e},e._id)}))})]})})})})})}function qO(e){var t=e.turno,a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=JO(),o=function(){return r(!c)};return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",onClick:o,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:t.fecha_movimiento}),Object(V.jsx)(sa.a,{align:"center",children:"ABRIR TURNO"===t.concepto?Object(V.jsx)(V.Fragment,{children:t.hora_entrada.completa}):Object(V.jsx)(V.Fragment,{children:t.hora_salida.completa})}),Object(V.jsx)(sa.a,{align:"center",children:t.usuario_en_turno.nombre}),Object(V.jsx)(sa.a,{align:"center",children:t.horario_en_turno}),Object(V.jsx)(sa.a,{align:"center",children:t.concepto}),Object(V.jsx)(sa.a,{align:"center",children:t.numero_caja})]},t._id),Object(V.jsx)(ze.a,{fullWidth:!0,maxWidth:"md",open:c,onClose:o,children:Object(V.jsx)(Pe.a,{children:Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{lg:12,xs:12,children:Object(V.jsx)(b.a,{textAlign:"center",p:2,children:Object(V.jsx)(y.a,{variant:"h6",children:"Informaci\xf3n del turno"})})}),Object(V.jsxs)(Fe.a,{lg:6,xs:12,children:[Object(V.jsx)(b.a,{p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Usuario"}),": ",t.usuario_en_turno.nombre]})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Numero de caja"}),": ",t.numero_caja]})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Moviento de turno"}),": ",t.concepto]})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Horario de turno"}),": ",t.horario_en_turno]})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(y.a,{children:"ABRIR TURNO"===t.concepto?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("b",{children:"Hora de Entrada de turno: "}),t.hora_entrada.completa]}):Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("b",{children:"Hora de Salida de turno: "}),t.hora_salida.completa]})})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Comentarios"}),": ",t.comentarios]})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Fecha de movimiento"}),": ",t.fecha_movimiento]})})]}),Object(V.jsx)(Fe.a,{lg:6,xs:12,children:Object(V.jsx)(Da.a,{className:i.root,children:Object(V.jsx)(ra.a,{className:i.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{align:"center",style:{minWidth:100},children:"Concepto"}),Object(V.jsx)(sa.a,{align:"center",style:{minWidth:100},children:"Monto depositado"})]})}),Object(V.jsxs)(la.a,{children:[Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)("b",{children:"Monto Total Efectivo:"})}),Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsxs)("b",{children:["$",t.montos_en_caja.monto_efectivo.monto]})})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"Creditos"}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_creditos.monto]})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"Tarjeta Debito"}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_debito.monto]})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"Tarjeta Credito"}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_credito.monto]})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"Monedero"}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_monedero.monto]})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"Cheques"}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_cheques.monto]})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"Transferencias"}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_transferencia.monto]})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"Vales de despensa"}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_vales_despensa.monto]})]})]})]})})})})]})})})]})}var HO=Object(z.d)(LO||(LO=Object(F.a)(["\n\tmutation crearRegistroDeTurno( $input: AbrirCerrarTurnoInput, $activa: Boolean) {\n\t\tcrearRegistroDeTurno(input: $input, activa: $activa) {\n\t\t\thorario_en_turno\n\t\t\ttoken_turno_user\n\t\t\tconcepto\n\t\t\tnumero_caja\n\t\t\tid_caja\n\t\t\tcomentarios\n\t\t\thora_entrada {\n\t\t\t\thora\n\t\t\t\tminutos\n\t\t\t\tsegundos\n\t\t\t}\n\t\t\thora_salida{\n\t\t\t\thora\n\t\t\t\tminutos\n\t\t\t\tsegundos\n\t\t\t}\n\t\t\tfecha_entrada{\n\t\t\t\tyear\n\t\t\t\tmes\n\t\t\t\tdia\n\t\t\t\tno_semana_year\n\t\t\t\tno_dia_year\n\t\t\t}\n\t\t\tfecha_salida{\n\t\t\t\tyear\n\t\t\t\tmes\n\t\t\t\tdia\n\t\t\t\tno_semana_year\n\t\t\t\tno_dia_year\n\t\t\t}\n\t\t\tmontos_en_caja {\n\t\t\t\tmonto_efectivo{\n                    monto \n                }\n                monto_tarjeta_credito{\n                    monto \n                }\n                monto_tarjeta_debito{\n                    monto \n                }\n                monto_creditos{\n                    monto \n                }\n                monto_monedero{\n                    monto \n                }\n                monto_transferencia{\n                    monto \n                }\n                monto_cheques{\n                    monto \n                }\n                monto_vales_despensa{\n                    monto \n                }\n\t\t\t}\n\t\t\tusuario_en_turno {\n\t\t\t\tnumero_usuario\n\t\t\t\tnombre\n\t\t\t}\n\t\t\tempresa\n\t\t\tsucursal\n\t\t}\n\t}\n"]))),YO=Object(z.d)(VO||(VO=Object(F.a)(["\n\tquery obtenerFiltroTurnos($input: HistorialTurnosInput, $empresa: ID!, $sucursal: ID!) {\n\t\tobtenerFiltroTurnos(input: $input, empresa: $empresa, sucursal: $sucursal) {\n\t\t\thorario_en_turno\n\t\t\tconcepto\n\t\t\tnumero_caja\n\t\t\tid_caja\n\t\t\tcomentarios\n\t\t\thora_entrada {\n\t\t\t\thora\n\t\t\t\tminutos\n\t\t\t\tsegundos\n\t\t\t\tcompleta\n\t\t\t}\n\t\t\thora_salida{\n\t\t\t\thora\n\t\t\t\tminutos\n\t\t\t\tsegundos\n\t\t\t\tcompleta\n\t\t\t}\n\t\t\tfecha_entrada{\n\t\t\t\tyear\n\t\t\t\tmes\n\t\t\t\tdia\n\t\t\t\tno_semana_year\n\t\t\t\tno_dia_year\n\t\t\t\tcompleta\n\t\t\t}\n\t\t\tfecha_salida{\n\t\t\t\tyear\n\t\t\t\tmes\n\t\t\t\tdia\n\t\t\t\tno_semana_year\n\t\t\t\tno_dia_year\n\t\t\t\tcompleta\n\t\t\t}\n\t\t\tfecha_movimiento\n\t\t\tmontos_en_caja {\n\t\t\t\tmonto_efectivo{\n                    monto \n                }\n                monto_tarjeta_credito{\n                    monto \n                }\n                monto_tarjeta_debito{\n                    monto \n                }\n                monto_creditos{\n                    monto \n                }\n                monto_monedero{\n                    monto \n                }\n                monto_transferencia{\n                    monto \n                }\n                monto_cheques{\n                    monto \n                }\n                monto_vales_despensa{\n                    monto \n                }\n\t\t\t}\n\t\t\tusuario_en_turno {\n\t\t\t\tnumero_usuario\n\t\t\t\tnombre\n\t\t\t}\n\t\t\tempresa\n\t\t\tsucursal\n\t\t}\n\t}\n"])));xt.a.locale("es");var XO=Co.a.ExcelFile,KO=Co.a.ExcelSheet,QO=Co.a.ExcelColumn,ZO=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),ex=Object(UO.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& .obligatorio":{color:"red"}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},margin:{margin:e.spacing(1)},iconSave:{zIndex:10,position:"fixed",bottom:e.spacing(2),right:e.spacing(10)}}}));function tx(){var e=Object(s.useState)(!1),t=Object(v.a)(e,2),a=t[0],n=t[1],c=function(){n(!a)},r=ex();return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:c,children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/shift.svg",alt:"icono caja",style:{width:100}})}),"Turnos de Usuarios"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:a,onClose:c,TransitionComponent:ZO,children:[Object(V.jsx)(Se.a,{className:r.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:r.title,children:"Reportes Turnos de Usuarios"}),Object(V.jsx)(b.a,{m:1,display:"flex",children:Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:c,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})})]})}),Object(V.jsx)(nx,{})]})]})}var ax,nx=function(){var e,t,a=ex(),n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(s.useState)([]),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)([]),d=Object(v.a)(l,2),j=d[0],p=(d[1],Object(ps.a)(i,500)),m=Object(v.a)(p,1)[0],O=[],x=Object(He.a)(cd,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id}}),f=Object(He.a)(YO,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id,input:{horario_en_turno:i.horario_turno?i.horario_turno:"",usuario_en_turno:m.usuario_en_turno?m.usuario_en_turno:"",numero_caja:i.numero_caja?i.numero_caja:"",fechaInicio:i.fechaInicio?i.fechaInicio:"",fechaFin:i.fechaFin?i.fechaFin:""}}}),g=f.loading,_=f.data,C=f.error,I=f.refetch;Object(s.useEffect)((function(){I()}),[I]);var k=function(e){o(Object(u.a)(Object(u.a)({},i),{},Object(h.a)({},e.target.name,e.target.value.toString())))},N=[];if(_&&!1===x.loading&&function(e){j.splice(0,j.length);for(var t=0;t<e.length;t++)N={fecha:e[t].fecha_movimiento,nombre:e[t].usuario_en_turno.nombre,numero_usuario:e[t].usuario_en_turno.numero_usuario,fecha_entrada:e[t].fecha_entrada.completa,fecha_salida:e[t].fecha_salida.completa,hora_entrada:e[t].hora_entrada.completa,hora_salida:e[t].hora_salida.completa,horario_en_turno:e[t].horario_en_turno,concepto:e[t].concepto,caja:e[t].numero_caja},j.push(N)}(O=_.obtenerFiltroTurnos),C)return Object(V.jsx)(Je,{error:C});return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(XO,{element:Object(V.jsxs)(w.a,{variant:"contained",color:"primary","aria-label":"Guardar",className:a.iconSave,children:[Object(V.jsx)(gO.a,{className:a.margin}),"Exportar"]}),filename:"Reporte de Turnos Usuarios",children:Object(V.jsxs)(KO,{data:j,name:"Reporte de Turnos Usuarios",children:[Object(V.jsx)(QO,{label:"No. Usuario",value:"numero_usuario"}),Object(V.jsx)(QO,{label:"Usuario",value:"nombre"}),Object(V.jsx)(QO,{label:"Fecha Movimiento",value:"fecha"}),Object(V.jsx)(QO,{label:"Fecha Entrada",value:"fecha_entrada"}),Object(V.jsx)(QO,{label:"Fecha Salida",value:"fecha_salida"}),Object(V.jsx)(QO,{label:"Hora Entrada",value:"hora_entrada"}),Object(V.jsx)(QO,{label:"Hora Salida",value:"hora_salida"}),Object(V.jsx)(QO,{label:"Horario en Turno",value:"horario_en_turno"}),Object(V.jsx)(QO,{label:"Concepto",value:"concepto"}),Object(V.jsx)(QO,{label:"No. de Caja",value:"caja"})]})}),Object(V.jsx)(Fe.a,{item:!0,lg:12,children:Object(V.jsxs)("div",{className:a.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha inicio:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fechaInicio",variant:"outlined",type:"date",onChange:k,value:i.fechaInicio?i.fechaInicio:""})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha fin:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fechaFin",variant:"outlined",type:"date",onChange:k,value:i.fechaFin?i.fechaFin:""})]}),Object(V.jsx)("form",{onSubmit:function(e){e.preventDefault(),I()},style:{display:"flex",alignItems:"center",width:"100%"},children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Usuario:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"usuario_en_turno",value:i.usuario_en_turno?i.usuario_en_turno:"",variant:"outlined",onChange:k})]})}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Caja:"}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"form-producto-tipo",name:"numero_caja",onChange:k,value:i.numero_caja?i.numero_caja:"",children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),null===(e=x.data)||void 0===e||null===(t=e.obtenerCajasSucursal)||void 0===t?void 0:t.map((function(e){return Object(V.jsxs)(Ee.a,{value:e.numero_caja,children:["Caja ",e.numero_caja]},e.numero_caja)}))]})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Horario de Turno:"}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"form-producto-tipo",name:"horario_turno",value:i.horario_turno?i.horario_turno:"",onChange:k,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),Object(V.jsx)(Ee.a,{value:"VESPERTINO",children:"Vespertino"}),Object(V.jsx)(Ee.a,{value:"MATUTINO",children:"Matutino"})]})})]}),Object(V.jsx)(b.a,{width:"70%",display:"flex",justifyContent:"center",justifyItems:"center",alignItems:"center",children:Object(V.jsx)(b.a,{mt:2,children:Object(V.jsx)(w.a,{color:"primary",size:"large",variant:"contained",onClick:function(){o([])},children:"Limpiar"})})})]})})]}),Object(V.jsx)(Fe.a,{item:!0,lg:12,children:Object(V.jsx)(GO,{loading:g,turnos:O})})]})},cx=[{label:"Nombre producto",minWidth:160},{label:"Fecha de Compra",minWidth:160},{label:"Almacen",minWidth:100},{label:"Proveedor",minWidth:100},{label:"M. pago",minWidth:90},{label:"F. pago",minWidth:100},{label:"Cantidad",minWidth:90},{label:"Descuento",minWidth:100},{label:"Subtotal",minWidth:90},{label:"Impuestos",minWidth:90},{label:"Total",minWidth:100}],rx=Object(k.a)((function(e){return{container:{maxHeight:"70vh"}}}));function ix(e){var t=e.data,a=rx();return Object(V.jsx)(b.a,{my:2,children:Object(V.jsx)(Da.a,{variant:"outlined",children:Object(V.jsx)(ra.a,{className:a.container,children:Object(V.jsxs)(da.a,{size:"small",stickyHeader:!0,"aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:cx.map((function(e,t){return Object(V.jsx)(sa.a,{style:{minWidth:e.minWidth},children:e.label},t)}))})}),Object(V.jsx)(la.a,{children:t.map((function(e,t){var a=_t.filter((function(t){return t.Value===e.forma_pago}))[0];return Object(V.jsxs)(oa.a,{role:"checkbox",tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:e.producto.datos_generales.nombre_comercial}),Object(V.jsx)(sa.a,{children:Qe(e.fecha_registro)}),Object(V.jsx)(sa.a,{children:e.almacen.nombre_almacen}),Object(V.jsx)(sa.a,{children:e.proveedor.nombre_cliente}),Object(V.jsx)(sa.a,{children:e.compra_credito?"Cr\xe9dito":"Contado"}),Object(V.jsx)(sa.a,{children:"".concat(a.Value,"-").concat(a.Name)}),Object(V.jsx)(sa.a,{children:"".concat(e.cantidad_total," - ").concat(e.unidad)}),Object(V.jsx)(sa.a,{children:"%".concat(e.descuento_porcentaje," - $").concat(e.descuento_precio?Ze(e.descuento_precio):0)}),Object(V.jsxs)(sa.a,{children:["$",Ze(e.subtotal)]}),Object(V.jsxs)(sa.a,{children:["$",Ze(e.impuestos)]}),Object(V.jsxs)(sa.a,{children:["$",Ze(e.total)]})]},t)}))})]})})})})}var ox=Object(z.d)(ax||(ax=Object(F.a)(["\n  query obtenerProductoMovimientos(\n    $empresa: ID!\n    $sucursal: ID\n    $input: ObteneReportesCompras\n  ) {\n    obtenerProductoMovimientos(\n      empresa: $empresa\n      sucursal: $sucursal\n      input: $input\n    ) {\n      _id\n      id_compra\n      id_traspaso\n      id_producto\n      id_proveedor\n      id_almacen\n      almacen {\n        id_almacen\n        nombre_almacen\n      }\n      proveedor {\n        _id\n        clave_cliente\n        numero_cliente\n        nombre_cliente\n      }\n      producto {\n        almacen_inicial {\n          almacen\n          cantidad\n          fecha_de_expiracion\n          id_almacen\n        }\n        datos_generales {\n          codigo_barras\n          clave_alterna\n          tipo_producto\n          nombre_comercial\n          nombre_generico\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          ieps\n          ieps_activo\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          granel\n          litros\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n            codigo_unidad\n          }\n          precio_de_compra {\n            precio_con_impuesto\n            precio_sin_impuesto\n            iva\n            ieps\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            unidad\n            codigo_unidad\n          }\n        }\n        unidades_de_venta {\n          cantidad\n          codigo_barras\n          id_producto\n          precio\n          unidad\n          unidad_principal\n          _id\n          precio_unidad {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n        }\n      }\n      concepto\n      cantidad\n      cantidad_regalo\n      unidad_regalo\n      cantidad_total\n      iva_total\n      ieps_total\n      costo\n      descuento_porcentaje\n      descuento_precio\n      compra_credito\n      forma_pago\n      impuestos\n      mantener_precio\n      subtotal\n      total\n      medida {\n        id_medida\n        medida\n        tipo\n      }\n      color {\n        id_color\n        color\n        hex\n      }\n      unidad\n      id_unidad_venta\n      empresa\n      sucursal\n      usuario\n      year_registro\n      numero_semana_year\n      numero_mes_year\n      fecha_registro\n    }\n  }\n"]))),sx=a(911),lx=a(256),dx=Co.a.ExcelFile,jx=Co.a.ExcelFile.ExcelSheet,ux=Co.a.ExcelFile.ExcelColumn;function bx(e){var t=e.data.map((function(e){var t=e.producto,a=e.fecha_registro,n=e.almacen,c=e.proveedor,r=e.color,i=e.medida,o=e.cantidad,s=e.unidad,l=e.unidad_regalo,d=e.cantidad_regalo,j=e.cantidad_total,u=e.compra_credito,b=e.costo,p=e.descuento_porcentaje,m=e.descuento_precio,O=(e.iva_precio,e.ieps_precio),x=e.subtotal,h=e.impuestos,f=e.total,g=_t.filter((function(t){return t.Value===e.forma_pago}))[0];return{producto:t.datos_generales.nombre_comercial,fecha_registro:Qe(a),almacen:n.nombre_almacen,proveedor:c.nombre_cliente,color:r?r.color:"N/A",medida:i?"".concat(i.medida,"/").concat(i.tipo):"N/A",cantidad:o,unidad:s,unidad_regalo:l,cantidad_regalo:d,cantidad_total:j,compra_credito:!0===u?"Credito":"Contado",forma_pago:"".concat(g.Value," - ").concat(g.Name),costo:"$".concat(b?Ze(b):0),descuento_porcentaje:"%".concat(p),descuento_precio:"$".concat(m?Ze(m):0),iva_precio:"$".concat(O?Ze(O):0),subtotal:"$".concat(x?Ze(x):0),impuestos:"$".concat(h?Ze(h):0),total:"$".concat(f?Ze(f):0)}}));return Object(V.jsx)(dx,{element:Object(V.jsx)(w.a,{color:"primary",startIcon:Object(V.jsx)(lx.a,{}),children:"Exportar a Excel"}),filename:"Reporte de compras",children:Object(V.jsxs)(jx,{data:t,name:"Reporte de compras",children:[Object(V.jsx)(ux,{label:"Producto",value:"producto"}),Object(V.jsx)(ux,{label:"Fecha de compra",value:"fecha_registro"}),Object(V.jsx)(ux,{label:"Almacen",value:"almacen"}),Object(V.jsx)(ux,{label:"Proveedor",value:"proveedor"}),Object(V.jsx)(ux,{label:"Color",value:"color"}),Object(V.jsx)(ux,{label:"Medida",value:"medida"}),Object(V.jsx)(ux,{label:"Cantidad",value:"cantidad"}),Object(V.jsx)(ux,{label:"Unidad",value:"unidad"}),Object(V.jsx)(ux,{label:"Unidad de Regalo",value:"unidad_regalo"}),Object(V.jsx)(ux,{label:"Cantidad de Regalo",value:"cantidad_regalo"}),Object(V.jsx)(ux,{label:"Cantidad Total",value:"cantidad_total"}),Object(V.jsx)(ux,{label:"Metodo de Pago",value:"compra_credito"}),Object(V.jsx)(ux,{label:"Forma de pago",value:"forma_pago"}),Object(V.jsx)(ux,{label:"Costo",value:"costo"}),Object(V.jsx)(ux,{label:"Descuento en Porcentaje",value:"descuento_porcentaje"}),Object(V.jsx)(ux,{label:"Descuento en Cantidad",value:"descuento_precio"}),Object(V.jsx)(ux,{label:"IVA",value:"iva_precio"}),Object(V.jsx)(ux,{label:"IEPS",value:"ieps_precio"}),Object(V.jsx)(ux,{label:"Subtotal",value:"subtotal"}),Object(V.jsx)(ux,{label:"Impuestos",value:"impuestos"}),Object(V.jsx)(ux,{label:"Total",value:"total"})]})})}function px(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(He.a)(ox,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,input:{fecha_inicio:"",fecha_fin:"",proveedor:"",metodo_pago:"",forma_pago:"",producto:""}},fetchPolicy:"network-only"}),a=t.loading,n=t.data,c=t.error,r=t.refetch;if(a)return Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:[Object(V.jsx)(I.a,{}),Object(V.jsx)(y.a,{variant:"h6",children:"Cargando..."})]});if(c)return Object(V.jsx)(Je,{error:c});var i=n.obtenerProductoMovimientos;return Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(Pe.a,{children:[Object(V.jsx)(mx,{refetch:r,data:i}),Object(V.jsx)(ix,{data:i})]})})}var mx=function(e){var t=e.refetch,a=e.data,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(s.useState)({fecha_inicio:"",fecha_fin:"",proveedor:"",metodo_pago:"",forma_pago:"",producto:""}),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(ha.useDebounce)(i,800),d=Object(v.a)(l,1)[0],j=function(e){var t=e.target,a=t.name,n=t.value;o(Object(u.a)(Object(u.a)({},i),{},Object(h.a)({},a,n)))};Object(s.useEffect)((function(){p(d)}),[d]);var p=function(e){t({empresa:n.empresa._id,sucursal:n.sucursal._id,input:e})};return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsxs)(Fe.a,{item:!0,md:2,children:[Object(V.jsx)(y.a,{children:"Fecha compra inicio:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_inicio",variant:"outlined",type:"date",onChange:j,value:i.fecha_inicio})]}),Object(V.jsxs)(Fe.a,{item:!0,md:2,children:[Object(V.jsx)(y.a,{children:"Fecha compra fin:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_fin",variant:"outlined",type:"date",onChange:j,value:i.fecha_fin})]}),Object(V.jsxs)(Fe.a,{item:!0,md:2,children:[Object(V.jsx)(y.a,{children:"Proveedor:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"proveedor",variant:"outlined",placeholder:"Nombre, Clave o numero",onChange:j,value:i.proveedor})]}),Object(V.jsxs)(Fe.a,{item:!0,md:2,children:[Object(V.jsx)(y.a,{children:"M\xe9todo de pago:"}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{name:"metodo_pago",onChange:j,value:i.metodo_pago,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Cualquier metodo"})}),Object(V.jsx)(Ee.a,{value:"CREDITO",children:"Cr\xe9dito"}),Object(V.jsx)(Ee.a,{value:"CONTADO",children:"Contado"})]})})]}),Object(V.jsxs)(Fe.a,{item:!0,md:2,children:[Object(V.jsx)(y.a,{children:"Forma de Pago:"}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{name:"forma_pago",onChange:j,value:i.forma_pago,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Cualquier forma"})}),_t.map((function(e,t){return Object(V.jsx)(Ee.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]})})]}),Object(V.jsxs)(Fe.a,{item:!0,md:2,children:[Object(V.jsx)(y.a,{children:"Producto:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"producto",variant:"outlined",placeholder:"Nombre, c\xf3digo, clave...",onChange:j,value:i.producto})]})]}),Object(V.jsxs)(b.a,{mt:1,display:"flex",children:[Object(V.jsx)(w.a,{color:"primary",startIcon:Object(V.jsx)(sx.a,{}),onClick:function(){o({fecha_inicio:"",fecha_fin:"",proveedor:"",metodo_pago:"",forma_pago:"",producto:""})},children:"Limpiar filtros"}),Object(V.jsx)(b.a,{mx:1}),Object(V.jsx)(bx,{data:a})]})]})},Ox=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),xx=Object(UO.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}));function hx(){var e=xx(),t=Object(s.useState)(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!n)};return Object(V.jsxs)(b.a,{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:r,children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Ce.m,{fontSize:100})}),"Reportes Compras"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Ox,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Reportes Compras"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(px,{})]})]})}var fx=[{id:"name",label:"F. Venta",minWidth:100},{id:"code",label:"Producto",minWidth:100},{id:"code",label:"P. de Compra",minWidth:100},{id:"code",label:"Cantidad",minWidth:100},{id:"code",label:"Total",minWidth:100},{id:"code",label:"Provedor",minWidth:100},{id:"code",label:"Fomas",minWidth:100},{id:"code",label:"M. de Pago",minWidth:100}],gx=Object(k.a)((function(e){return{root:{width:"100%"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function _x(){var e=gx();return Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(Da.a,{className:e.root,children:Object(V.jsx)(ra.a,{className:e.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:fx.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{})]})})})})}var vx=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),Cx=Object(UO.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& .obligatorio":{color:"red"}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},margin:{margin:e.spacing(1)},iconSave:{zIndex:10,position:"fixed",bottom:e.spacing(2),right:e.spacing(10)}}}));function yx(){var e=Cx(),t=Object(s.useState)(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!n)};return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:r,children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cart-add.svg",alt:"icono ventas",style:{width:100}})}),"Reportes Ventas"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:vx,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Reportes Ventas"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsxs)(w.a,{variant:"contained",color:"primary","aria-label":"Guardar",className:e.iconSave,children:[Object(V.jsx)(gO.a,{className:e.margin}),"Exportar"]}),Object(V.jsx)(Fe.a,{item:!0,lg:12,children:Object(V.jsxs)("div",{className:e.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha inicio:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fechaInicio",variant:"outlined",type:"date"})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha fin:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fechaFin",variant:"outlined",type:"date"})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Clientes:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"provedor",variant:"outlined"})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Metodos de Pago:"}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"form-producto-tipo",name:"tipo_producto",children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),Object(V.jsx)(Ee.a,{value:"EFECTIVO",children:"Efectivo"}),Object(V.jsx)(Ee.a,{value:"PUNTOS",children:"Puntos"}),Object(V.jsx)(Ee.a,{value:"DEBITO",children:"T. Debito"}),Object(V.jsx)(Ee.a,{value:"CREDITO",children:"T. Credito"}),Object(V.jsx)(Ee.a,{value:"CHEQUES",children:"Cheques"})]})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Nombre Producto:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"provedor",variant:"outlined"})]})]})}),Object(V.jsx)(Fe.a,{item:!0,lg:12,children:Object(V.jsx)(_x,{})})]})]})]})}var Sx=Co.a.ExcelFile,wx=Co.a.ExcelFile.ExcelSheet,Ix=Co.a.ExcelFile.ExcelColumn;function kx(e){var t=e.data.map((function(e){return{producto:e.producto.datos_generales.nombre_comercial,cantidad:e.cantidad,fecha:Qe(e.id_traspaso.fecha_registro),concepto:e.id_traspaso.concepto_traspaso.nombre_concepto,almacen_origen:null!==e.almacen_origen?e.almacen_origen.nombre_almacen:"",almacen_destino:null!==e.almacen_destino?e.almacen_destino.nombre_almacen:""}}));return Object(V.jsx)(Sx,{element:Object(V.jsx)(w.a,{color:"primary",startIcon:Object(V.jsx)(lx.a,{}),children:"Exportar a Excel"}),filename:"Reporte de traspasos",children:Object(V.jsxs)(wx,{data:t,name:"Reporte de traspasos",children:[Object(V.jsx)(Ix,{label:"Producto",value:"producto"}),Object(V.jsx)(Ix,{label:"Cantidad",value:"cantidad"}),Object(V.jsx)(Ix,{label:"Fecha",value:"fecha"}),Object(V.jsx)(Ix,{label:"Concepto",value:"concepto"}),Object(V.jsx)(Ix,{label:"Almac\xe9n Origen",value:"almacen_origen"}),Object(V.jsx)(Ix,{label:"Almac\xe9n Destino",value:"almacen_destino"})]})})}var Nx=[{id:"producto",label:"Producto",minWidth:200},{id:"cantidad",label:"Cantidad",minWidth:50},{id:"fecha",label:"Fecha ",minWidth:50},{id:"concepto",label:"Concepto ",minWidth:100},{id:"almacen_origen",label:"Almac\xe9n Origen",minWidth:100},{id:"almacen_destino",label:"Almac\xe9n Destino",minWidth:100}],Fx=Object(k.a)((function(e){return{root:{width:"100%"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function zx(e){var t=e.data,a=Fx();return Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(Da.a,{className:a.root,children:Object(V.jsx)(ra.a,{className:a.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:Nx.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{children:t.map((function(e,t){return Object(V.jsxs)(oa.a,{role:"checkbox",tabIndex:-1,children:[Object(V.jsx)(sa.a,{children:e.producto.datos_generales.nombre_comercial}),Object(V.jsx)(sa.a,{children:e.cantidad}),Object(V.jsx)(sa.a,{children:Qe(e.id_traspaso.fecha_registro)}),Object(V.jsx)(sa.a,{children:e.id_traspaso.concepto_traspaso.nombre_concepto}),Object(V.jsx)(sa.a,{children:null!==e.almacen_origen?e.almacen_origen.nombre_almacen:""}),Object(V.jsx)(sa.a,{children:null!==e.almacen_destino?e.almacen_destino.nombre_almacen:""})]},t)}))})]})})})})}var Px=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),Dx=Object(UO.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& .obligatorio":{color:"red"}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},margin:{margin:e.spacing(1)},CircularProgress:{width:"100%",height:200,marginTop:100,display:"flex",justifyContent:"center"},iconSave:{zIndex:10,position:"fixed",bottom:e.spacing(2),right:e.spacing(10)}}}));function Ex(){var e=Dx(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)(null),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(null),p=Object(v.a)(j,2),m=p[0],O=p[1],x=Object(s.useState)(!1),f=Object(v.a)(x,2),g=f[0],_=f[1],C=Object(s.useState)({empresa:t.empresa._id,sucursal:t.sucursal._id,producto:"",fecha_inicio:"",fecha_final:"",usuario:""}),k=Object(v.a)(C,2),N=k[0],F=k[1],z=Object(s.useState)(""),P=Object(v.a)(z,2),E=P[0],A=P[1],T=Object(ps.a)(N,1e3),W=Object(v.a)(T,1)[0],R=[],$=[],M=[],L=Object(He.a)(wn,{variables:{id:t.sucursal._id},fetchPolicy:"network-only"}),U=Object(He.a)(D,{variables:{sucursal:"".concat(t.sucursal._id)},fetchPolicy:"network-only"}),B=Object(He.a)(Pn,{variables:{input:W},fetchPolicy:"network-only"}),J=function(){r(!c)};L.data&&(R=L.data.obtenerAlmacenes);var q=function(e){var t,a=Object(u.a)(Object(u.a)({},N),{},(t={},Object(h.a)(t,e.target.name,e.target.value),Object(h.a)(t,"almacen_destino",m),Object(h.a)(t,"almacen_origen",l),t));F(a)};if(B.data)try{$=B.data.obtenerTraspasos}catch(H){}if(U.data)try{M=U.data.obtenerUsuarios}catch(H){}return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:J,children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/almacen.svg",alt:"icono almacen",style:{width:100}})}),"Reportes Almacen"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:c,onClose:J,TransitionComponent:Px,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Reportes Almacen"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:J,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsxs)(Fe.a,{item:!0,lg:12,children:[Object(V.jsxs)("div",{className:e.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha inicio:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_inicio",variant:"outlined",value:N.fecha_inicio,type:"date",onChange:function(e){return q(e)}})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha fin:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_final",variant:"outlined",type:"date",onChange:function(e){return q(e)},value:N.fecha_final})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Encargado"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(ta.a,{id:"encargado",size:"small",options:M,getOptionLabel:function(e){return e.nombre?"".concat(e.nombre):""},fullWidth:!0,renderInput:function(e){return Object(V.jsx)(S.a,Object(u.a)(Object(u.a)({},e),{},{variant:"outlined",InputProps:Object(u.a)(Object(u.a)({},e.InputProps),{},{endAdornment:Object(V.jsx)(s.Fragment,{children:e.InputProps.endAdornment})})}))},renderOption:function(e){return Object(V.jsx)(s.Fragment,{children:"".concat(e.nombre)})},onChange:function(e,t){return function(e){try{var t=null!==m?m._id:"",a=null!==l?l._id:"",n=""!==e?e._id:"",c=Object(u.a)(Object(u.a)({},N),{},{usuario:n,almacen_destino:t,almacen_origen:a});B.refetch({input:c}),A(e),_(!1)}catch(H){}}(t)},getOptionSelected:function(e,t){return e.nombre===t.nombre},value:E.nombre?E:null})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Producto:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"producto",variant:"outlined",placeholder:"Nombre, c\xf3digo, clave...",onChange:function(e){return q(e)},value:N.producto})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Almacen origen:"}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsx)(De.a,{id:"form-almacen-origen",name:"almacen_origen",onChange:function(e){return function(e){var t=null!==m?m._id:"";if(""!==e._id){_(!0);var a=Object(u.a)(Object(u.a)({},N),{},{almacen_origen:e._id,almacen_destino:t});B.refetch({input:a})}d(e),_(!1)}(e.target.value)},value:null!==l?l:"",children:R.map((function(e){return Object(V.jsx)(Ee.a,{value:e,children:e.nombre_almacen},e._id)}))})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Almacen destino:"}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsx)(De.a,{id:"form-almacen-destino",name:"almacen_destino",onChange:function(e){return function(e){var t=null!==l?l._id:"";if(""!==e._id){var a=Object(u.a)(Object(u.a)({},N),{},{almacen_origen:t,almacen_destino:e._id});_(!0),B.refetch({input:a})}O(e),_(!1)}(e.target.value)},value:null!==m?m:"",children:R.map((function(e){return Object(V.jsx)(Ee.a,{value:e,children:e.nombre_almacen},e._id)}))})})]})]}),Object(V.jsx)("div",{className:e.formInputFlex,children:Object(V.jsxs)(b.a,{mt:1,display:"flex",children:[Object(V.jsx)(w.a,{color:"primary",startIcon:Object(V.jsx)(sx.a,{}),onClick:function(){return function(){try{var e={empresa:t.empresa._id,sucursal:t.sucursal._id,producto:"",fecha_inicio:"",fecha_final:"",usuario:""};F(e),_(!0),B.refetch({input:e}),A(""),d(null),O(null),_(!1)}catch(H){}}()},children:"Limpiar filtros"}),Object(V.jsx)(b.a,{mx:1}),Object(V.jsx)(kx,{data:$})]})})]}),B.loading||g?Object(V.jsx)("div",{className:e.CircularProgress,children:Object(V.jsx)(I.a,{})}):Object(V.jsx)(Fe.a,{item:!0,lg:12,children:Object(V.jsx)(zx,{data:$})})]})]})]})}var Ax=[{label:"Fecha Corte",minWidth:100},{label:"Hora Corte",minWidth:100},{label:"Usuario",minWidth:100},{label:"Turno Horario",minWidth:100},{label:"Caja",minWidth:100},{label:"Sucursal",minWidth:100}],Tx=Object(k.a)((function(e){return{root:{width:"100%"},container:{maxHeight:"70vh","& ::-webkit-scrollbar":{display:"none"}},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function Wx(e){var t=e.loading,a=e.cortes,n=Tx();return t?Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(Da.a,{className:n.root,children:Object(V.jsx)(ra.a,{className:n.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:Ax.map((function(e){return Object(V.jsx)(sa.a,{align:"center",style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{children:a.map((function(e){return Object(V.jsx)(Rx,{corte:e},e._id)}))})]})})})})}function Rx(e){var t=e.corte,a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=JSON.parse(localStorage.getItem("sesionCafi")),o=Object(ri.a)(dd,{variables:{sucursal:i.sucursal._id,empresa:i.empresa._id,input:{usuario:i._id,caja:t.id_caja,token_turno_user:t.token_turno_user,number_user:i.numero_usuario}},fetchPolicy:"network-only"}),l=Object(v.a)(o,2),d=l[0],j=l[1],u=j.data,p=(j.error,j.loading),m=[];u&&(m=u.obtenerCorteCaja.montos_en_sistema);var O=function(){r(!c),d()};return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",handleClickOpen:!0,onClick:O,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:t.fecha_salida.completa}),Object(V.jsx)(sa.a,{align:"center",children:t.hora_salida.completa}),Object(V.jsx)(sa.a,{align:"center",children:t.usuario_en_turno.nombre}),Object(V.jsx)(sa.a,{align:"center",children:t.horario_en_turno}),Object(V.jsx)(sa.a,{align:"center",children:t.numero_caja}),Object(V.jsx)(sa.a,{align:"center",children:t.sucursal.nombre_sucursal})]},t._id),Object(V.jsxs)(ze.a,{fullWidth:!0,maxWidth:"lg",open:c,onClose:O,children:[Object(V.jsx)($x,{corte:t,montos_sistema:m,loading:p}),Object(V.jsx)(We.a,{children:Object(V.jsx)(b.a,{p:2,display:"flex",flexDirection:"row-reverse",children:Object(V.jsx)(w.a,{color:"primary",size:"large",variant:"contained",onClick:O,children:"Imprimir Ticket"})})})]})]})}function $x(e){var t=e.corte,a=e.montos_sistema,n=e.loading,c=Tx();return n?Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(Fe.a,{item:!0,lg:12,md:12,xs:12,children:[Object(V.jsx)(b.a,{p:1,textAlign:"center",children:Object(V.jsx)(y.a,{variant:"h5",children:Object(V.jsx)("b",{children:"Reporte de Corte de Caja"})})}),Object(V.jsx)(b.a,{p:1,textAlign:"center",children:Object(V.jsxs)(y.a,{variant:"h6",children:[Object(V.jsx)("b",{children:"Fecha y hora de Corte: "}),xt()(t.fecha_movimiento).format("Do MMMM YYYY, h:mm:ss")]})})]}),Object(V.jsx)(Fe.a,{item:!0,lg:12,md:12,xs:12,children:Object(V.jsxs)(b.a,{p:2,display:"flex",justifyContent:"center",children:[Object(V.jsx)(b.a,{p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Usuario: "})," ",t.usuario_en_turno.nombre]})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"No. de usuario: "}),t.usuario_en_turno.numero_usuario]})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Horario en turno: "}),t.horario_en_turno]})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Numero de caja: "}),t.numero_caja]})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Sucursal: "}),t.sucursal.nombre_sucursal]})})]})}),Object(V.jsx)(Fe.a,{children:Object(V.jsx)(Da.a,{className:c.root,children:Object(V.jsx)(ra.a,{className:c.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{align:"center",children:"CONCEPTO"}),Object(V.jsx)(sa.a,{align:"center",children:"CAJERO"}),Object(V.jsx)(sa.a,{align:"center",children:"SISTEMA"}),Object(V.jsx)(sa.a,{align:"center",children:"DIFERENCIA"})]})}),Object(V.jsxs)(la.a,{children:[Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)("b",{children:"MONTO EFECTIVO"})}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_efectivo.monto]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",a.monto_efectivo]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_efectivo.monto-a.monto_efectivo]})]}),Object(V.jsxs)(la.a,{children:[Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)("b",{children:"MONTO TARJETA DEBITO"})}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_debito.monto]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",a.monto_tarjeta_debito]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_debito.monto-a.monto_tarjeta_debito]})]}),Object(V.jsxs)(la.a,{children:[Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)("b",{children:"MONTO TARJETA DE CREDITO"})}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_credito.monto]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",a.monto_tarjeta_credito]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_credito.monto-a.monto_tarjeta_credito]})]}),Object(V.jsxs)(la.a,{children:[Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)("b",{children:"MONTO TRANSFERENCIAS"})}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_transferencia.monto]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",a.monto_transferencia]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_transferencia.monto-a.monto_transferencia]})]}),Object(V.jsxs)(la.a,{children:[Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)("b",{children:"MONTO EN MONEDERO"})}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_monedero.monto]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",a.monto_monedero]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_monedero.monto-a.monto_monedero]})]}),Object(V.jsxs)(la.a,{children:[Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)("b",{children:"MONTO EN CREDITOS"})}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_creditos.monto]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",a.monto_creditos]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_creditos.monto-a.monto_creditos]})]}),Object(V.jsxs)(la.a,{children:[Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)("b",{children:"MONTO EN CHEQUES"})}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_cheques.monto]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",a.monto_cheques]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_cheques.monto-a.monto_cheques]})]}),Object(V.jsxs)(la.a,{children:[Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)("b",{children:"MONTO EN VALE DE DESPENSA"})}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_vales_despensa.monto]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",a.monto_vales_despensa]}),Object(V.jsxs)(sa.a,{align:"center",children:["$",t.montos_en_caja.monto_vales_despensa.monto-a.monto_vales_despensa]})]})]})})})})]})}var Mx=Object(k.a)((function(e){return{icon:{fontSize:40,width:40},iconSave:{zIndex:10,position:"fixed",bottom:e.spacing(2),right:e.spacing(10)}}}));function Lx(e){var t=e.historialCortes,a=Object(s.useState)([]),n=Object(v.a)(a,2),c=n[0],r=(n[1],Mx()),i=[];return Object(V.jsx)(V.Fragment,{children:Object(V.jsx)(vO.a,{element:Object(V.jsxs)(w.a,{variant:"contained",color:"primary","aria-label":"Guardar",className:r.iconSave,onClick:function(){return function(e){c.splice(0,c.length);for(var t=0;t<e.length;t++)i={fecha:e[t].fecha_salida.completa,hora_movimiento:e[t].hora_salida.completa,horario_turno:e[t].horario_en_turno,sucursal:e[t].sucursal.nombre_sucursal,nombre:e[t].usuario_en_turno.nombre,numero_usuario:e[t].usuario_en_turno.numero_usuario,concepto:"Corte Caja",caja:e[t].numero_caja,monto_efectivo:e[t].montos_en_caja.monto_efectivo.monto,monto_creditos:e[t].montos_en_caja.monto_creditos.monto,monto_tarjeta_debito:e[t].montos_en_caja.monto_tarjeta_debito.monto,monto_tarjeta_credito:e[t].montos_en_caja.monto_tarjeta_credito.monto,monto_monedero:e[t].montos_en_caja.monto_monedero.monto,monto_cheques:e[t].montos_en_caja.monto_cheques.monto,monto_transferencia:e[t].montos_en_caja.monto_transferencia.monto,monto_vales_despensa:e[t].montos_en_caja.monto_vales_despensa.monto},c.push(i)}(t)},children:[Object(V.jsx)(gO.a,{className:r.margin}),"Exportar"]}),filename:"Reporte de Historial de Cortes",children:Object(V.jsxs)(yO.a,{data:c,name:"Reporte de Historial de Cortes",children:[Object(V.jsx)(wO.a,{label:"Usuario",value:"nombre"}),Object(V.jsx)(wO.a,{label:"No. Usuario",value:"numero_usuario"}),Object(V.jsx)(wO.a,{label:"Sucursal",value:"sucursal"}),Object(V.jsx)(wO.a,{label:"Fecha Corte",value:"fecha"}),Object(V.jsx)(wO.a,{label:"Hora Corte",value:"hora_movimiento"}),Object(V.jsx)(wO.a,{label:"Horario Turno",value:"horario_turno"}),Object(V.jsx)(wO.a,{label:"Concepto",value:"concepto"}),Object(V.jsx)(wO.a,{label:"No. de Caja",value:"caja"}),Object(V.jsx)(wO.a,{label:"M. en Efectivo",value:"monto_efectivo"}),Object(V.jsx)(wO.a,{label:"M. en Creditos",value:"monto_creditos"}),Object(V.jsx)(wO.a,{label:"M. en Tarjeta Debito",value:"monto_tarjeta_debito"}),Object(V.jsx)(wO.a,{label:"M. en Tarjeta Credito",value:"monto_tarjeta_credito"}),Object(V.jsx)(wO.a,{label:"M. en Monedero",value:"monto_monedero"}),Object(V.jsx)(wO.a,{label:"M. en Cheques",value:"monto_cheques"}),Object(V.jsx)(wO.a,{label:"M. en Transferencia",value:"monto_transferencia"}),Object(V.jsx)(wO.a,{label:"M. en Vale Despensa",value:"monto_vales_despensa"})]})})})}var Vx=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),Ux=Object(UO.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& .obligatorio":{color:"red"}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},margin:{margin:e.spacing(1)},iconSave:{zIndex:10,position:"fixed",bottom:e.spacing(2),right:e.spacing(10)}}}));function Bx(){var e,t=JSON.parse(localStorage.getItem("sesionCafi")),a=Ux(),n=Object(s.useState)(!1),c=Object(v.a)(n,2),r=c[0],i=c[1],o=Object(s.useState)([]),l=Object(v.a)(o,2),d=l[0],j=l[1],p=Object(ha.useDebounce)(d,500),m=Object(v.a)(p,1)[0],O=[],x=[],f=Object(He.a)(cd,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id}}),g=Object(He.a)(ld,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id,input:{fecha_consulta:d.fecha_consulta?d.fecha_consulta:"",usuario:m.usuario?m.usuario:"",numero_caja:d.numero_caja?parseInt(d.numero_caja):null}}}),_=g.loading,C=g.data,I=(g.error,g.refetch);!1===f.loading&&!1===_&&(O=f.data.obtenerCajasSucursal,x=C.obtenerCortesDeCaja);var k=function(){i(!r)},N=function(e){j(Object(u.a)(Object(u.a)({},d),{},Object(h.a)({},e.target.name,e.target.value)))};return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{fullWidth:!0,onClick:k,children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cash-register.svg",alt:"icono caja",style:{width:100}})}),"Reportes Cortes de caja"]})}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:r,onClose:k,TransitionComponent:Vx,children:[Object(V.jsx)(Se.a,{className:a.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:a.title,children:"Reportes Cortes de caja"}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:k,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Lx,{historialCortes:x}),Object(V.jsx)(Fe.a,{item:!0,lg:12,md:12,xs:12,children:Object(V.jsxs)("div",{className:a.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha de corte:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_consulta",variant:"outlined",type:"date",onChange:N,value:d.fecha_consulta?d.fecha_consulta:""})]}),Object(V.jsx)("form",{onSubmit:function(e){e.preventDefault(),I()},style:{display:"flex",alignItems:"center",width:"100%"},children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Usuario:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"usuario",variant:"outlined",onChange:N,value:d.usuario?d.usuario:""})]})}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Caja:"}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"form-producto-tipo",name:"numero_caja",onChange:N,value:d.numero_caja?d.numero_caja:"",children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),null===(e=O)||void 0===e?void 0:e.map((function(e){return Object(V.jsxs)(Ee.a,{value:e.numero_caja,children:["Caja ",e.numero_caja]},e.numero_caja)}))]})})]}),Object(V.jsx)(b.a,{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",mt:2,children:Object(V.jsx)(w.a,{color:"primary",size:"large",variant:"contained",onClick:function(){j([])},children:"Limpiar Filtro"})})]})}),Object(V.jsx)(Fe.a,{item:!0,lg:12,md:12,xs:12,children:Object(V.jsx)(Wx,{cortes:x,loading:_})})]})]})]})}var Jx=a(478),Gx=a(912),qx=[{id:"folio",label:"Folio",minWidth:170},{id:"nombre",label:"Usuario",minWidth:170},{id:"fecha",label:"Fecha",minWidth:170},{id:"folioF",label:"Folio Factura",minWidth:170},{id:"tipo",label:"Tipo Compra",minWidth:170}],Hx=Object(k.a)((function(e){return{root:{width:"100%",height:"70vh"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}}));function Yx(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Hx(),a=Object(s.useState)([]),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(ha.useDebounce)(c,500),o=Object(v.a)(i,1)[0],l=Object(He.a)(Eu,{variables:{input:{fecha_inicio:c.fecha_inicio?c.fecha_inicio:"",fecha_fin:c.fecha_fin?c.fecha_fin:"",usuario:o.usuario?o.usuario:"",tipo_movimiento:c.tipo_movimiento?"CREDITO"===c.tipo_movimiento:null},empresa:e.empresa._id,sucursal:e.sucursal._id}}),d=l.loading,j=l.data,p=(l.error,l.refetch);Object(s.useEffect)((function(){p()}),[p]);var m=[];j&&(m=j.obtenerHistorialEgresos);var O=function(e){r(Object(u.a)(Object(u.a)({},c),{},Object(h.a)({},e.target.name,e.target.value)))};return Object(V.jsxs)(Fe.a,{children:[Object(V.jsx)(Fe.a,{item:!0,lg:12,md:12,xs:12,children:Object(V.jsxs)("div",{className:t.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha Inicio:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_inicio",variant:"outlined",type:"date",onChange:O,value:c.fecha_inicio?c.fecha_inicio:""})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha Fin:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_fin",variant:"outlined",type:"date",onChange:O,value:c.fecha_fin?c.fecha_fin:""})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Usuario:"}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"usuario",variant:"outlined",onChange:O,value:c.usuario?c.usuario:""})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Tipo Egreso:"}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"form-producto-tipo",name:"tipo_movimiento",onChange:O,children:[Object(V.jsx)(Ee.a,{value:"TODOS",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),Object(V.jsx)(Ee.a,{value:"CONTADO",children:"Egreso Contado"}),Object(V.jsx)(Ee.a,{value:"CREDITO",children:"Egreso Credito"})]})})]}),Object(V.jsx)(b.a,{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",mt:2,children:Object(V.jsx)(w.a,{color:"primary",size:"large",variant:"contained",onClick:function(){r([])},children:"Limpiar Filtro"})})]})}),Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(Da.a,{className:t.root,children:Object(V.jsx)(ra.a,{className:t.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:qx.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{children:m.map((function(e,t){return Object(V.jsx)(Kx,{row:e,loading:d},t)}))})]})})})})]})}var Xx=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Kx(e){var t=e.row,a=e.loading,n=Object(s.useState)(!1),c=Object(v.a)(n,2),r=c[0],i=c[1],o=function(){return i(!r)};return a?Object(V.jsx)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsxs)(s.Fragment,{children:[Object(V.jsxs)(ze.a,{open:r,TransitionComponent:Xx,fullWidth:!0,maxWidth:"md",children:[Object(V.jsx)(Qx,{row:t}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{variant:"outlined",color:"secondary",size:"large",onClick:o,children:"Cerrar"})})]}),Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,onClick:o,children:[Object(V.jsx)(sa.a,{children:t.folio_egreso}),Object(V.jsx)(sa.a,{children:t.nombre_usuario_creador}),Object(V.jsx)(sa.a,{children:t.fecha_compra}),Object(V.jsx)(sa.a,{children:t.folio_factura}),Object(V.jsx)(sa.a,{children:!1===t.compra_credito?"Contado":"Credito"})]},t.code)]})}function Qx(e){var t=e.row;return Object(V.jsx)(s.Fragment,{children:Object(V.jsx)(Pe.a,{children:Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,lg:12,xs:12,children:Object(V.jsx)(b.a,{textAlign:"center",p:2,children:Object(V.jsx)(y.a,{variant:"h6",children:"Informaci\xf3n de movimiento"})})}),Object(V.jsx)(Fe.a,{item:!0,lg:5,xs:12,children:Object(V.jsx)(b.a,{display:"flex",textAlign:"left",p:1,children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)("b",{children:"Fecha Compra: "})," ",xt()(t.fecha_compra).format("YYYY-MM-DD"),Object(V.jsx)("br",{}),Object(V.jsx)("b",{children:"Folio movimiento: "})," ",t.folio_egreso,Object(V.jsx)("br",{}),Object(V.jsx)("b",{children:"Usuario: "})," ",t.nombre_usuario_creador,Object(V.jsx)("br",{}),Object(V.jsx)("b",{children:"Categoria: "})," ",t.categoria,Object(V.jsx)("br",{}),Object(V.jsx)("b",{children:"Sub-Categoria: "})," ",t.subCategoria,Object(V.jsx)("br",{}),Object(V.jsx)("b",{children:"Folio Factura: "})," ",t.folio_factura,Object(V.jsx)("br",{}),Object(V.jsx)("b",{children:"Empresa: "})," ",t.empresa_distribuidora,Object(V.jsx)("br",{}),Object(V.jsx)("b",{children:"Provedor: "})," ",t.provedor,Object(V.jsx)("br",{}),Object(V.jsx)("b",{children:"Metodo de pago: "})," ",t.metodo_pago,Object(V.jsx)("br",{}),Object(V.jsx)("b",{children:"Compra credito: "})," ",!1===t.compra_credito?"NO":"Si",!1===t.compra_credito?null:Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("br",{}),Object(V.jsx)("b",{children:"Fecha Vencimiento: "})," ",t.fecha_vencimiento,Object(V.jsx)("br",{}),Object(V.jsx)("b",{children:"Saldo Pendiente: "})," ",t.saldo_credito_pendiente]})]})})}),Object(V.jsxs)(Fe.a,{item:!0,lg:7,xs:12,children:[Object(V.jsx)(b.a,{textAlign:"center",children:Object(V.jsx)(y.a,{children:"Productos Adquiridos"})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(Da.a,{style:{width:"100%",height:"30vh"},children:Object(V.jsx)(ra.a,{style:{maxHeight:"100%"},children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{align:"center",style:{minWidth:100},children:"CANTIDAD"}),Object(V.jsx)(sa.a,{align:"center",style:{minWidth:100},children:"PRODUCTO"}),Object(V.jsx)(sa.a,{align:"center",style:{minWidth:100},children:"P. UNITARIO"}),Object(V.jsx)(sa.a,{align:"center",style:{minWidth:100},children:"TOTAL"})]})}),Object(V.jsx)(la.a,{children:null===t||void 0===t?void 0:t.productos.map((function(e,t){return Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:e.cantidad_productos}),Object(V.jsx)(sa.a,{align:"center",children:e.producto}),Object(V.jsx)(sa.a,{align:"center",children:e.precio_unitario}),Object(V.jsx)(sa.a,{align:"center",children:e.total})]},t)}))})]})})})}),Object(V.jsx)(b.a,{display:"flex",justifyContent:"flex-end",p:1,children:Object(V.jsxs)(y.a,{variant:"h6",children:["Total: $",Ze(t.saldo_total)]})})]})]})})})}var Zx=[{id:"name",label:"Name",minWidth:170},{id:"code",label:"ISO\xa0Code",minWidth:100},{id:"population",label:"Population",minWidth:170,align:"right",format:function(e){return e.toLocaleString("en-US")}},{id:"size",label:"Size\xa0(km\xb2)",minWidth:170,align:"right",format:function(e){return e.toLocaleString("en-US")}},{id:"density",label:"Density",minWidth:170,align:"right",format:function(e){return e.toFixed(2)}}];function eh(e,t,a,n){return{name:e,code:t,population:a,size:n,density:a/n}}var th=[eh("India","IN",1324171354,3287263),eh("China","CN",1403500365,9596961),eh("Italy","IT",60483973,301340),eh("United States","US",327167434,9833520),eh("Canada","CA",37602103,9984670),eh("Australia","AU",25475400,7692024),eh("Germany","DE",83019200,357578),eh("Ireland","IE",4857e3,70273),eh("Mexico","MX",126577691,1972550),eh("Japan","JP",126317e3,377973),eh("France","FR",67022e3,640679),eh("United Kingdom","GB",67545757,242495),eh("Russia","RU",146793744,17098246),eh("Nigeria","NG",200962417,923768),eh("Brazil","BR",210147125,8515767)],ah=Object(k.a)((function(e){return{root:{width:"100%"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function nh(){var e=ah(),t=Object(s.useState)(0),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useState)(14),i=Object(v.a)(r,2),o=i[0],l=i[1];return Object(V.jsxs)(Fe.a,{children:[Object(V.jsx)("div",{className:e.root,children:Object(V.jsx)(b.a,{m:2,display:"flex",justifyContent:"space-between",children:Object(V.jsx)(b.a,{mr:5,minWidth:"70%",children:Object(V.jsxs)(Da.a,{className:e.rootBusqueda,children:[Object(V.jsx)(us.a,{fullWidth:!0,placeholder:"Buscar transferencias..."}),Object(V.jsx)(X.a,{children:Object(V.jsx)(xc.a,{})})]})})})}),Object(V.jsx)(b.a,{p:2,children:Object(V.jsxs)(Da.a,{className:e.root,children:[Object(V.jsx)(ra.a,{className:e.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:Zx.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{children:th.slice(n*o,n*o+o).map((function(e){return Object(V.jsx)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:Zx.map((function(t){var a=e[t.id];return Object(V.jsx)(sa.a,{align:t.align,children:t.format&&"number"===typeof a?t.format(a):a},t.id)}))},e.code)}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[10,25,100],component:"div",count:th.length,rowsPerPage:o,page:n,onChangePage:function(e,t){c(t)},onChangeRowsPerPage:function(e){l(+e.target.value),c(0)}})]})})]})}var ch=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},root:{flexGrow:1,width:"100%",height:"100vh",backgroundColor:e.palette.background.paper},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}})),rh=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function ih(){var e=ch(),t=Object(s.useState)(""),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useState)(!1),i=Object(v.a)(r,2),o=i[0],l=i[1],d=function(){return l(!o)},j=Object(s.useState)(null),u=Object(v.a)(j,2),p=u[0],m=u[1];return Object(V.jsxs)("div",{children:[Object(V.jsx)(w.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){m(e.currentTarget)},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Ce.s,{style:{fontSize:100}})}),"Reportes Tesoreria"]})}),Object(V.jsxs)(Jx.a,{id:"customized-menu",anchorEl:p,keepMounted:!0,open:Boolean(p),onClose:function(){m(null)},children:[Object(V.jsxs)(Ee.a,{onClick:function(){d(),c("egresos")},children:[Object(V.jsx)(Gx.a,{children:Object(V.jsx)(Ce.s,{style:{fontSize:35}})}),"Historial Egresos"]}),Object(V.jsxs)(Ee.a,{onClick:function(){d(),c("transferencias")},children:[Object(V.jsx)(Gx.a,{children:Object(V.jsx)(Ce.s,{style:{fontSize:35}})}),"Historial Transferencias"]})]}),Object(V.jsxs)(ze.a,{fullScreen:!0,open:o,onClose:d,TransitionComponent:rh,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsxs)(y.a,{variant:"h6",className:e.title,children:["Histotorial de ",n]}),Object(V.jsx)(b.a,{m:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:d,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]})}),Object(V.jsx)(b.a,{children:"egresos"===n?Object(V.jsx)(Yx,{}):"transferencias"===n?Object(V.jsx)(nh,{}):null})]})]})}function oh(){var e=JSON.parse(localStorage.getItem("sesionCafi"));return Object(V.jsx)(C.a,{children:Object(V.jsxs)(Fe.a,{container:!0,spacing:3,justify:"center",children:[!1===e.accesos.reportes.reporte_historial_cajas.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(MO,{})})}),!1===e.accesos.reportes.reporte_turnos.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(tx,{})})}),!1===e.accesos.reportes.reporte_compras.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(hx,{})})}),!1===e.accesos.reportes.reporte_ventas.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(yx,{})})}),!1===e.accesos.reportes.rerporte_almacen.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Ex,{})})}),!1===e.accesos.reportes.reporte_corte_caja.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Bx,{})})}),!1===e.accesos.reportes.reporte_tesoreria.ver?null:Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(ih,{})})})]})})}var sh=["children","value","index"];function lh(e){var t=e.children,a=e.value,n=e.index,c=Object(fe.a)(e,sh);return Object(V.jsx)("div",Object(u.a)(Object(u.a)({role:"tabpanel",hidden:a!==n,id:"scrollable-force-tabpanel-".concat(n),"aria-labelledby":"scrollable-force-tab-".concat(n)},c),{},{children:a===n&&Object(V.jsx)(b.a,{p:3,my:6,minHeight:"50vh",children:t})}))}function dh(e){return{id:"scrollable-force-tab-".concat(e),"aria-controls":"scrollable-force-tabpanel-".concat(e)}}var jh=Object(k.a)((function(e){return{root:{flexGrow:1,width:"100%",height:"100vh",backgroundColor:e.palette.background.paper},icon:{fontSize:100},iconSvg:{width:100},iconSvgVenta:{width:90}}}));var uh=Object(x.f)((function(e){var t=jh(),a=Object(ve.a)(),n=l.a.useState(0),c=Object(v.a)(n,2),r=c[0],i=c[1];return Object(V.jsxs)("div",{className:t.root,children:[Object(V.jsx)(ye.a,{}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(Se.a,{position:"static",color:"default",elevation:0,children:Object(V.jsxs)(we.a,{value:r,onChange:function(e,t){i(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"on",children:[Object(V.jsx)(Ie.a,Object(u.a)({label:"Mi empresa",icon:Object(V.jsx)(Ce.r,{className:t.icon})},dh(0))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Almacenes",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/almacen.svg",alt:"icono almacen",className:t.iconSvg})},dh(1))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Compras",icon:Object(V.jsx)(Ce.m,{className:t.icon})},dh(2))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Catalogos",icon:Object(V.jsx)(Ce.j,{className:t.icon})},dh(3))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Tesoreria",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/money.svg",alt:"icono money",className:t.iconSvg})},dh(4))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Reportes",icon:Object(V.jsx)(Ce.s,{className:t.icon})},dh(5))),Object(V.jsx)(Ie.a,Object(u.a)({label:"Facturaci\xf3n",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/factura.svg",alt:"icono factura",className:t.iconSvg})},dh(6))),Object(V.jsx)(Ie.a,Object(u.a)(Object(u.a)({label:"Ventas",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cart-add.svg",alt:"icono ventas",className:t.iconSvg})},dh(7)),{},{onClick:function(){return e.history.push("/ventas/venta-general")}}))]})}),Object(V.jsxs)(_e.a,{axis:"rtl"===a.direction?"x-reverse":"x",index:r,onChangeIndex:function(e){i(e)},children:[Object(V.jsx)(lh,{value:r,index:0,children:Object(V.jsx)(Zt,{})}),Object(V.jsx)(lh,{value:r,index:1,children:Object(V.jsx)(pO,{})}),Object(V.jsx)(lh,{value:r,index:2,children:Object(V.jsx)(js,{})}),Object(V.jsx)(lh,{value:r,index:3,children:Object(V.jsx)(iu,{})}),Object(V.jsx)(lh,{value:r,index:4,children:Object(V.jsx)(Qb,{})}),Object(V.jsx)(lh,{value:r,index:5,children:Object(V.jsx)(oh,{})}),Object(V.jsx)(lh,{value:r,index:6,children:Object(V.jsx)(im,{})}),Object(V.jsx)(lh,{value:r,index:7})]})]})]})})),bh=a(462),ph=a.n(bh),mh=a(261),Oh=Object(k.a)((function(e){return{appbar:{backgroundColor:e.palette.navbar,color:mh.a[800]},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,marginLeft:e.spacing(2)}}}));var xh=Object(x.f)((function(e){var t,a=Oh(),n=localStorage.getItem("sesionCafi"),c=JSON.parse(localStorage.getItem("turnoEnCurso")),r=JSON.parse(localStorage.getItem("sesionCafi"));return null!==n&&(t=JSON.parse(localStorage.getItem("sesionCafi"))),Object(V.jsx)("div",{children:Object(V.jsx)(Se.a,{position:"fixed",className:a.appbar,elevation:0,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(qt.a,{alt:"Remy Sharp",src:t.imagen}),Object(V.jsx)(b.a,{className:a.title,children:Object(V.jsxs)(y.a,{variant:"h6",color:"inherit",children:["Bienvenido ","".concat(t.nombre)]})}),!0===r.turno_en_caja_activo&&c?Object(V.jsx)(w.a,{color:"secondary",size:"large",className:a.menuButton,variant:"contained",disabled:!0,children:"TURNO ACTIVO"}):Object(V.jsx)(w.a,{color:"secondary",size:"large",className:a.menuButton,startIcon:Object(V.jsx)(ph.a,{}),variant:"contained",onClick:function(){localStorage.removeItem("sesionCafi"),localStorage.removeItem("tokenCafi"),localStorage.removeItem("ListaEnEspera"),e.history.push("/")},children:"Cerrar sesi\xf3n"})]})})})}));var hh=a(914),fh=a(206),gh=Object(k.a)((function(e){return{appBar:{zIndex:e.zIndex.drawer+1,backgroundColor:"white"},drawer:{width:"22%",flexShrink:0,backgroundColor:"white"},drawerColor:{height:"100%",backgroundColor:"white"},drawerPaper:{width:"22%",backgroundColor:e.palette.navbar},root:{display:"flex",flexDirection:"column",height:"100%"},navigationTop:{height:"100%"},iconSizeSuperior:{fontSize:30,color:e.palette.info.main},iconSizeSecondSuperior:{width:20},iconSizeInferior:{fontSize:50,color:e.palette.info.main},iconSizeSecondInferior:{width:40},iconSizeSecondInferiorGrande:{width:100},iconSizeInferiorGrande:{fontSize:110,color:e.palette.info.main},avatar:{width:e.spacing(3),height:e.spacing(3),marginRight:e.spacing(1)},borderBoton:{minWidth:"100%",height:"50%",border:".6px solid #DBDBDB"},borderBotonChico:{minWidth:"100%",border:".6px solid #DBDBDB"}}})),_h=a(913),vh=Object(k.a)((function(e){return{root:{marginTop:e.spacing(2)},rootPrecioProductos:{minHeight:"40vh"},containerImage:{maxWidth:150,maxHeight:150,display:"flex",justifyContent:"center",alignItems:"center",justifyItems:"ceter"},imagen:{maxWidth:"100%",maxHeight:"100%",display:"flex",justifyContent:"center",alignItems:"center",justifyItems:"ceter"},rootBusqueda:{height:35,display:"flex",padding:e.spacing(1)},rootBusquedaProductos:{height:35,display:"flex",padding:e.spacing(1)},rootFecha:{height:40,maxWidth:150,display:"flex"},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(.5),"px")},"& .obligatorio":{color:"red"},paddingTop:0,alignItems:"center",justifyItems:"center"},formInput:{},iconSize:{width:28},iconSizeDialogs:{width:80},iconSizeDialogsPequeno:{width:50},containerImagenesProducto:{maxHeight:300,maxWidth:300,display:"flex",justifyItems:"center",alignContent:"center",justifyContent:"center",alignItems:"center"},imagenProducto:{height:"100%",width:"100%"},borderBoton:{minWidth:"100%",height:"50%",border:".6px solid #DBDBDB"},borderBotonChico:{minWidth:"100%",height:"100%",border:".6px solid #DBDBDB"},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}}}})),Ch=Object(s.createContext)(),yh=function(e){var t=e.children,a=Object(s.useState)({_id:null,cantidad:null,codigo_barras:null,concepto:null,default:null,descuento:null,descuento_activo:null,id_producto:{},precio:null,unidad:null,unidad_principal:null}),n=Object(v.a)(a,2),c=n[0],r=n[1],i=Object(s.useState)([]),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)({productos:[],cliente:{},subtotal:0,impuestos:0,total:0,usuario:{}}),u=Object(v.a)(j,2),b=u[0],p=u[1],m=Object(s.useState)({}),O=Object(v.a)(m,2),x=O[0],h=O[1],f=Object(s.useState)([]),g=Object(v.a)(f,2),_=g[0],C=g[1],y=Object(s.useState)([]),S=Object(v.a)(y,2),w=S[0],I=S[1],k=Object(s.useState)(),N=Object(v.a)(k,2),F=N[0],z=N[1],P=Object(s.useState)(""),D=Object(v.a)(P,2),E=D[0],A=D[1],T=Object(s.useState)(!1),W=Object(v.a)(T,2),R=W[0],$=W[1],M=Object(s.useState)(!1),L=Object(v.a)(M,2),U=L[0],B=L[1],J=Object(s.useState)({message:"",status:"",open:!1}),G=Object(v.a)(J,2),q=G[0],H=G[1],Y=Object(s.useState)(!1),X=Object(v.a)(Y,2),K=X[0],Q=X[1],Z=Object(s.useState)(!1),ee=Object(v.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(s.useState)(!1),ce=Object(v.a)(ne,2),re=ce[0],ie=ce[1],oe=Object(s.useState)(!1),se=Object(v.a)(oe,2),le=se[0],de=se[1];return Object(V.jsx)(Ch.Provider,{value:{alert:q,setAlert:H,update:R,setUpdate:$,error:U,setError:B,datosProductoVentas:c,setDatosProductoVentas:r,productosVentas:l,setProductosVentas:d,datosVentas:b,setDatosVentas:p,abrirTurnosDialog:K,setAbrirTurnosDialog:Q,setUpdateClientVenta:ae,updateClientVenta:te,setProductoCambioPrecio:h,productoCambioPrecio:x,setPrecioSelectProductoVenta:C,precioSelectProductoVenta:_,setUpdateTablaVentas:de,updateTablaVentas:le,setOpen:ie,open:re,clientesVentas:w,setClientesVentas:I,turnoActivo:F,setTurnoActivo:z,ubicacionTurno:E,setUbicacionTurno:A},children:t})},Sh=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function wh(){var e=JSON.parse(localStorage.getItem("turnoEnCurso")),t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(N.a)(rd),n=Object(v.a)(a,1)[0];xt.a.locale("es");var c=vh(),r=Object(s.useContext)(Ch).setAlert,i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(!1),p=Object(v.a)(j,2),m=p[0],O=p[1],x=Object(s.useState)("DEPOSITO"),f=Object(v.a)(x,2),C=f[0],k=f[1],F=Object(s.useState)([]),z=Object(v.a)(F,2),P=z[0],D=z[1],E=Object(He.a)(Sl,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id}}),A=E.loading,T=E.data,W={horario_en_turno:"ABRIR TURNO",id_caja:e?e.id_caja:"",id_usuario:t._id,token_turno_user:e?e.token_turno_user:""},R=Object(He.a)(sd,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id,input:W}}),$=function(){d(!l),R.refetch()},M=0;if(!T||!R.data)return null;if(M=R.data.obtenerPreCorteCaja.monto_efectivo_precorte,A||m||R.loading)return Object(V.jsx)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:Object(V.jsx)(I.a,{})});window.addEventListener("keydown",(function(e){e.altKey&&68===e.keyCode&&$()}));var L=function(e){D(Object(u.a)(Object(u.a)({},P),{},Object(h.a)({},e.target.name,e.target.value)))},U=function(){var a=Object(_.a)(g.a.mark((function a(){var c;return g.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(O(!0),a.prev=1,e||!1!==(null===t||void 0===t?void 0:t.turno_en_caja_activo)){a.next=8;break}return O(!1),r({message:"Por el momento no hay ningun turno activo.",status:"error",open:!0}),a.abrupt("return",null);case 8:if(P.tipo_movimiento&&P.monto_efectivo&&P.concepto){a.next=14;break}return O(!1),r({message:"Por favor complete los datos.",status:"error",open:!0}),a.abrupt("return",null);case 14:if(!("RETIRO"===P.tipo_movimiento&&M<parseFloat(P.monto_efectivo))){a.next=18;break}return O(!1),r({message:"Lo sentimos no hay dinero suficiente en la caja para esta acci\xf3n.",status:"error",open:!0}),a.abrupt("return",null);case 18:return c={tipo_movimiento:P.tipo_movimiento,concepto:P.concepto,numero_caja:parseInt(e.numero_caja),id_Caja:e.id_caja,horario_turno:e.horario_en_turno,rol_movimiento:"CAJA",hora_moviento:{hora:xt()().format("hh"),minutos:xt()().format("mm"),segundos:xt()().format("ss"),completa:xt()().format("HH:mm:ss")},fecha_movimiento:{year:xt()().format("YYYY"),mes:xt()().format("DD"),dia:xt()().format("MM"),no_semana_year:xt()().week().toString(),no_dia_year:xt()().dayOfYear().toString(),completa:xt()().locale("es-mx").format()},id_User:t._id,numero_usuario_creador:t.numero_usuario,nombre_usuario_creador:t.nombre,montos_en_caja:{monto_efectivo:{monto:parseFloat(P.monto_efectivo),metodo_pago:"01"},monto_tarjeta_debito:{monto:0,metodo_pago:"28"},monto_tarjeta_credito:{monto:0,metodo_pago:"04"},monto_creditos:{monto:0,metodo_pago:"99"},monto_monedero:{monto:0,metodo_pago:"05"},monto_transferencia:{monto:0,metodo_pago:"03"},monto_cheques:{monto:0,metodo_pago:"02"},monto_vales_despensa:{monto:0,metodo_pago:"08"}},empresa:t.empresa._id,sucursal:t.sucursal._id},a.next=21,n({variables:{empresa:t.empresa._id,sucursal:t.sucursal._id,input:c}});case 21:r({message:"Registro de movimiento exitoso.",status:"success",open:!0}),$(),O(!1);case 24:a.next=31;break;case 26:a.prev=26,a.t0=a.catch(1),O(!1),r({message:"Error: ".concat(a.t0.message),status:"error",open:!0}),$();case 31:case"end":return a.stop()}}),a,null,[[1,26]])})));return function(){return a.apply(this,arguments)}}();return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{onClick:function(){$()},style:{textTransform:"none",height:"100%",width:"60%"},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cash-register2.svg",alt:"icono caja",style:{width:20}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Deposito/Retiro Caja"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"Alt + D"})})})]})}),Object(V.jsxs)(ze.a,{maxWidth:"lg",open:l,onClose:$,TransitionComponent:Sh,children:[Object(V.jsxs)(Pe.a,{children:[Object(V.jsx)(Fe.a,{container:!0,item:!0,lg:12,children:Object(V.jsxs)(b.a,{display:"flex",textAlign:"center",children:[Object(V.jsxs)(b.a,{display:"flex",justifyContent:"center",flexGrow:1,children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cash-register2.svg",alt:"icono caja",className:c.iconSizeDialogs})}),Object(V.jsx)(b.a,{m:2,children:Object(V.jsx)(Te.a,{orientation:"vertical"})}),Object(V.jsxs)(b.a,{mt:1,children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"h6",children:"Deposito / Retiro Caja"})}),Object(V.jsxs)(b.a,{display:"flex",textAlign:"right",children:[Object(V.jsx)(b.a,{textAlign:"right",children:Object(V.jsx)(y.a,{variant:"caption",children:xt()().format("MM/DD/YYYY")})}),Object(V.jsx)(b.a,{textAlign:"right",ml:2,children:Object(V.jsx)(y.a,{variant:"caption",children:Object(V.jsxs)("b",{children:[xt()().format("h:mm")," hrs."]})})}),Object(V.jsx)(b.a,{textAlign:"right",ml:2,children:Object(V.jsxs)(y.a,{variant:"caption",children:[Object(V.jsx)("b",{children:"Caja: "}),null===e||void 0===e?void 0:e.numero_caja]})})]})]})]}),Object(V.jsx)(b.a,{ml:10,mb:7,display:"flex",alignItems:"center",children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:$,size:"large",children:Object(V.jsx)($e.a,{})})})]})}),Object(V.jsx)(Fe.a,{children:!0===t.turno_en_caja_activo?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("div",{className:c.formInputFlex,children:Object(V.jsx)(b.a,{width:"100%",textAlign:"center",children:Object(V.jsxs)(Wb.a,{onChange:function(e,t){k(t),D(Object(u.a)(Object(u.a)({},P),{},{tipo_movimiento:t}))},value:C,exclusive:!0,children:[Object(V.jsx)(_h.a,{value:"DEPOSITO",children:Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(y.a,{variant:"h4",children:Object(V.jsx)("b",{children:"DEPOSITO"})})})}),Object(V.jsx)(_h.a,{value:"RETIRO",children:Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(y.a,{variant:"h4",children:Object(V.jsx)("b",{children:"RETIRO"})})})})]})})}),Object(V.jsx)("div",{className:c.formInputFlex,children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Monto:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",type:"number",name:"monto_efectivo",onChange:L,id:"form-producto-codigo-barras",variant:"outlined"})})]})}),Object(V.jsx)("div",{className:c.formInputFlex,children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Concepto de Movimiento:"}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"form-producto-tipo",onChange:L,name:"concepto",children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),null===T||void 0===T?void 0:T.obtenerContabilidad.map((function(e){return Object(V.jsx)(Ee.a,{value:e.nombre_servicio,children:e.nombre_servicio})}))]})})]})})]}):Object(V.jsx)(b.a,{textAlign:"center",p:2,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Por el momento no hay un turno en sesi\xf3n"})})})})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:U,variant:"contained",color:"primary",size:"large",children:"Registrar"})})]})]})}function Ih(e){var t=e.handleClickOpen,a=e.loading,n=e.type,c=e.setLoading,r=JSON.parse(localStorage.getItem("sesionCafi")),i=JSON.parse(localStorage.getItem("turnoEnCurso")),o=Object(N.a)(HO),l=Object(v.a)(o,1)[0],d=Object(s.useContext)(Ch),j=d.setTurnoActivo,p=d.setAlert,m=Object(s.useState)(!1),O=Object(v.a)(m,2),x=(O[0],O[1]),f=Object(s.useState)([]),C=Object(v.a)(f,2),k=C[0],F=C[1],z=Object(s.useState)(""),P=Object(v.a)(z,2),D=P[0],E=P[1],A=vh(),T=[],W=Object(He.a)(cd,{variables:{empresa:r.empresa._id,sucursal:r.sucursal._id}}),R=function(e){F(Object(u.a)(Object(u.a)({},k),{},Object(h.a)({},e.target.name,e.target.value)))};W.data&&(T=W.data.obtenerCajasSucursal);var $={accesos:r.accesos,email:r.email,empresa:r.empresa,estado:r.estado,exp:r.exp,iat:r.iat,imagen:r.imagen,nombre:r.nombre,numero_usuario:r.numero_usuario,sucursal:r.sucursal,telefono:r.telefono,turno_en_caja_activo:!0,_id:r._id};Object(s.useEffect)((function(){W.refetch()}),[a]);var M=function(){var e=Object(_.a)(g.a.mark((function e(){var a,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c(!0),e.prev=1,k.turno_en_curso&&k.caja_elegida&&k.monto_abrir){e.next=9;break}return x(!0),c(!1),p({message:"Por favor complete los datos obligatorios",status:"error",open:!0}),e.abrupt("return");case 9:return a={horario_en_turno:k.turno_en_curso,concepto:"ABRIR TURNO",numero_caja:D.toString(),comentarios:k.comentarios,id_caja:k.caja_elegida,empresa:r.empresa._id,sucursal:r.sucursal._id,id_usuario:r._id,usuario_en_turno:{nombre:r.nombre,telefono:r.telefono,numero_usuario:r.numero_usuario.toString(),email:r.email},hora_entrada:{hora:xt()().format("hh"),minutos:xt()().format("mm"),segundos:xt()().format("ss"),completa:xt()().format("HH:mm:ss")},hora_salida:{hora:"",minutos:"",segundos:"",completa:""},fecha_entrada:{year:xt()().format("YYYY"),mes:xt()().format("MM"),dia:xt()().format("DD"),no_semana_year:xt()().week().toString(),no_dia_year:xt()().dayOfYear().toString(),completa:xt()().format("YYYY-MM-DD")},fecha_salida:{year:"",mes:"",dia:"",no_semana_year:"",no_dia_year:"",completa:""},fecha_movimiento:xt()().locale("es-mx").format(),montos_en_caja:{monto_efectivo:{monto:parseFloat(k.monto_abrir),metodo_pago:"01"},monto_tarjeta_debito:{monto:0,metodo_pago:"28"},monto_tarjeta_credito:{monto:0,metodo_pago:"04"},monto_creditos:{monto:0,metodo_pago:"99"},monto_monedero:{monto:0,metodo_pago:"05"},monto_transferencia:{monto:0,metodo_pago:"03"},monto_cheques:{monto:0,metodo_pago:"02"},monto_vales_despensa:{monto:0,metodo_pago:"08"}}},e.next=12,l({variables:{activa:!0,input:a}});case 12:null===(i=e.sent).data.crearRegistroDeTurno?(c(!1),W.refetch(),p({message:"Lo sentimos esta caja ya esta en uso",status:"error",open:!0})):(localStorage.setItem("turnoEnCurso",JSON.stringify(i.data.crearRegistroDeTurno)),localStorage.setItem("sesionCafi",JSON.stringify($)),j(!0),p({message:"Turno abierto con exito",status:"success",open:!0}),W.refetch(),"FRENTE"!==n&&t());case 14:e.next=21;break;case 16:e.prev=16,e.t0=e.catch(1),c(!1),p({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),"FRENTE"!==n&&t();case 21:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();return W.loading?Object(V.jsx)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsxs)("div",{children:[Object(V.jsx)(Pe.a,{children:Object(V.jsxs)(Fe.a,{children:[Object(V.jsxs)("div",{className:A.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:" Empleado:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"nombre_usuario",onChange:R,disabled:!0,value:r?r.nombre:"",id:"form-producto-codigo-barras",variant:"outlined"})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:"obligatorio",children:"* "}),"Turno:"]}),Object(V.jsx)(G.a,{variant:"outlined",disabled:!!i,fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"form-producto-tipo",name:"turno_en_curso",onChange:R,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),Object(V.jsx)(Ee.a,{value:"VESPERTINO",children:"Vespertino"}),Object(V.jsx)(Ee.a,{value:"MATUTINO",children:"Matutino"})]})})]})]}),Object(V.jsxs)("div",{className:A.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:"obligatorio",children:"* "}),"Caja:"]}),Object(V.jsx)(G.a,{variant:"outlined",disabled:!!i,fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"form-producto-tipo",name:"caja_elegida",onChange:R,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),T.map((function(e){return!0===e.activa?null:Object(V.jsxs)(Ee.a,{value:e._id,onClick:function(){return E(e.numero_caja)},children:["Caja ",e.numero_caja]},e.numero_caja)}))]})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[" ",Object(V.jsx)("span",{className:"obligatorio",children:"* "}),"Monto para abrir:"]}),Object(V.jsx)(b.a,{display:"flex",className:A.input,children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"monto_abrir",inputProps:{min:0},type:"number",onChange:R,id:"form-producto-codigo-barras",variant:"outlined"})})]})]}),Object(V.jsx)("div",{className:A.formInputFlex,children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:" Comentarios:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"comentarios",multiline:!0,rows:5,onChange:R,id:"form-producto-codigo-barras",variant:"outlined"})})]})})]})}),Object(V.jsx)(We.a,{children:Object(V.jsx)(b.a,{display:"flex",alignItems:"flex-end",children:Object(V.jsx)(w.a,{onClick:M,variant:"contained",color:"primary",size:"large",children:"ABRIR TURNO"})})})]})}xt.a.locale("es"),xt.a.locale("es");var kh=Object(x.f)((function(e){var t=e.handleClickOpen,a=e.setLoading,n=Object(N.a)(HO),c=Object(v.a)(n,1)[0],r=Object(s.useContext)(Ch),i=r.setAlert,o=r.setTurnoActivo,l=r.ubicacionTurno,d=Object(s.useState)(!1),j=Object(v.a)(d,2),p=(j[0],j[1]),m=JSON.parse(localStorage.getItem("sesionCafi")),O=JSON.parse(localStorage.getItem("turnoEnCurso")),x=vh(),f=Object(s.useState)([]),C=Object(v.a)(f,2),I=C[0],k=C[1],F=Object(s.useState)([]),z=Object(v.a)(F,2),P=z[0],D=z[1],E=function(e){k(Object(u.a)(Object(u.a)({},I),{},Object(h.a)({},e.target.name,e.target.value)))},A=function(e){D(Object(u.a)(Object(u.a)({},P),{},Object(h.a)({},e.target.name,e.target.value)))},T={horario_en_turno:P.horario_en_turno,concepto:"CERRAR TURNO",token_turno_user:O?O.token_turno_user:"",numero_caja:O?null===O||void 0===O?void 0:O.numero_caja.toString():"",comentarios:P.comentarios,id_caja:O?O.id_caja:"",empresa:m.empresa._id,sucursal:m.sucursal._id,id_usuario:m._id,usuario_en_turno:{nombre:m.nombre,telefono:m.telefono,numero_usuario:m.numero_usuario.toString(),email:m.email},hora_entrada:{hora:"",minutos:"",segundos:"",completa:""},hora_salida:{hora:xt()().format("hh"),minutos:xt()().format("mm"),segundos:xt()().format("ss"),completa:xt()().format("HH:mm:ss")},fecha_entrada:{year:"",mes:"",dia:"",no_semana_year:"",no_dia_year:"",completa:""},fecha_salida:{year:xt()().format("YYYY"),mes:xt()().format("MM"),dia:xt()().format("DD"),no_semana_year:xt()().week().toString(),no_dia_year:xt()().dayOfYear().toString(),completa:xt()().format("YYYY-MM-DD")},fecha_movimiento:xt()().locale("es-mx").format(),montos_en_caja:{monto_efectivo:{monto:parseFloat(I.monto_efectivo?I.monto_efectivo:0),metodo_pago:"01"},monto_tarjeta_debito:{monto:parseFloat(I.monto_tarjeta_debito?I.monto_tarjeta_debito:0),metodo_pago:"28"},monto_tarjeta_credito:{monto:parseFloat(I.monto_tarjeta_credito?I.monto_tarjeta_credito:0),metodo_pago:"04"},monto_creditos:{monto:parseFloat(I.monto_creditos?I.monto_creditos:0),metodo_pago:"99"},monto_monedero:{monto:parseFloat(I.monto_puntos?I.monto_puntos:0),metodo_pago:"05"},monto_transferencia:{monto:parseFloat(I.monto_transferencia?I.monto_transferencia:0),metodo_pago:"03"},monto_cheques:{monto:parseFloat(I.monto_cheques?I.monto_cheques:0),metodo_pago:"02"},monto_vales_despensa:{monto:parseFloat(I.monto_vales_despensa?I.monto_vales_despensa:0),metodo_pago:"08"}}},W={accesos:m.accesos,email:m.email,empresa:m.empresa,estado:m.estado,exp:m.exp,iat:m.iat,imagen:m.imagen,nombre:m.nombre,numero_usuario:m.numero_usuario,sucursal:m.sucursal,telefono:m.telefono,turno_en_caja_activo:!1,_id:m._id},R=function(t){"SESION"===t?(localStorage.removeItem("sesionCafi"),localStorage.removeItem("tokenCafi"),localStorage.removeItem("turnoEnCurso"),localStorage.removeItem("ListaEnEspera"),localStorage.removeItem("DatosVentas"),e.history.push("/")):(localStorage.setItem("sesionCafi",JSON.stringify(W)),localStorage.removeItem("DatosVentas"),localStorage.removeItem("ListaEnEspera"),localStorage.removeItem("turnoEnCurso"))},$=function(){var e=Object(_.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a(!0),e.prev=1,P.horario_en_turno){e.next=9;break}return p(!0),a(!1),i({message:"Por favor elija que turno esta cerrando",status:"error",open:!0}),e.abrupt("return");case 9:return e.next=11,c({variables:{activa:!1,input:T}});case 11:i({message:"Turno cerrado con exito",status:"success",open:!0}),R(l),a(!1),t(),o(!0);case 16:e.next=23;break;case 18:e.prev=18,e.t0=e.catch(1),i({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),a(!1),t();case 23:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(Pe.a,{style:{padding:0},children:[Object(V.jsx)(b.a,{width:"100%",textAlign:"center",children:Object(V.jsx)(y.a,{variant:"h6",children:"Montos a Depositar"})}),Object(V.jsxs)("div",{className:x.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",className:x.input,children:[Object(V.jsx)(y.a,{children:" Monto Efectivo:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{name:"monto_efectivo",variant:"outlined",size:"small",inputProps:{min:0},type:"number",defaultValue:0,color:"primary",onChange:E})})]}),Object(V.jsxs)(b.a,{width:"100%",className:x.input,children:[Object(V.jsx)(y.a,{children:" Creditos:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{name:"monto_creditos",variant:"outlined",size:"small",inputProps:{min:0},type:"number",defaultValue:0,color:"primary",onChange:E})})]})]}),Object(V.jsxs)("div",{className:x.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",className:x.input,children:[Object(V.jsx)(y.a,{children:" Tarjeta Debito:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{name:"monto_tarjeta_debito",variant:"outlined",size:"small",inputProps:{min:0},type:"number",defaultValue:0,color:"primary",onChange:E})})]}),Object(V.jsxs)(b.a,{width:"100%",className:x.input,children:[Object(V.jsx)(y.a,{children:" Tarjeta Credito:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{name:"monto_tarjeta_credito",variant:"outlined",size:"small",inputProps:{min:0},type:"number",defaultValue:0,color:"primary",onChange:E})})]})]}),Object(V.jsxs)("div",{className:x.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",className:x.input,children:[Object(V.jsx)(y.a,{children:"Monedero:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{name:"monto_puntos",variant:"outlined",size:"small",inputProps:{min:0},type:"number",defaultValue:0,color:"primary",onChange:E})})]}),Object(V.jsxs)(b.a,{width:"100%",className:x.input,children:[Object(V.jsx)(y.a,{children:"Transferencias:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{name:"monto_transferencia",variant:"outlined",size:"small",inputProps:{min:0},type:"number",defaultValue:0,color:"primary",onChange:E})})]})]}),Object(V.jsxs)("div",{className:x.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",className:x.input,children:[Object(V.jsx)(y.a,{children:"Cheques:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{name:"monto_cheques",variant:"outlined",size:"small",inputProps:{min:0},type:"number",defaultValue:0,color:"primary",onChange:E})})]}),Object(V.jsxs)(b.a,{width:"100%",className:x.input,children:[Object(V.jsx)(y.a,{children:"Vales de despensa:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{name:"monto_vales_despensa",variant:"outlined",size:"small",inputProps:{min:0},type:"number",defaultValue:0,color:"primary",onChange:E})})]})]}),Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,lg:6,children:Object(V.jsx)(b.a,{mt:1,textAlign:"center",children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Monto total efectivo:  "})})})}),Object(V.jsx)(Fe.a,{item:!0,lg:6,justify:"flex-end",children:Object(V.jsx)(b.a,{mt:1,textAlign:"center",children:Object(V.jsxs)(y.a,{children:["$",I.monto_efectivo," Mx."]})})})]}),Object(V.jsx)("div",{className:x.formInputFlex,children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:"obligatorio",children:"* "})," Turno:"]}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{onChange:A,id:"form-producto-tipo",name:"horario_en_turno",children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),Object(V.jsx)(Ee.a,{value:"VESPERTINO",children:"Vespertino"}),Object(V.jsx)(Ee.a,{value:"MATUTINO",children:"Matutino"})]})})]})}),Object(V.jsx)("div",{className:x.formInputFlex,children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Comentarios:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,multiline:!0,onChange:A,rows:2,size:"small",name:"comentarios",id:"form-producto-codigo-barras",variant:"outlined"})})]})})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(b.a,{display:"flex",alignItems:"flex-end",children:Object(V.jsx)(w.a,{onClick:$,variant:"contained",color:"primary",size:"large",children:"Aceptar"})})})]})})),Nh=["children","value","index"];function Fh(e){var t=e.children,a=e.value,n=e.index,c=Object(fe.a)(e,Nh);return Object(V.jsx)("div",Object(u.a)(Object(u.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(V.jsx)(b.a,{p:3,height:"70vh",children:t})}))}function zh(e){return{id:"reg-product-tab-".concat(e),"aria-controls":"tabpanel-reg-product-".concat(e)}}xt.a.locale("es");var Ph=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(0),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(0),"px")},root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper},iconSvg:{width:50},dialogContent:{padding:0}}})),Dh=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Eh(){var e=Object(s.useContext)(Ch),t=e.abrirTurnosDialog,a=e.setAbrirTurnosDialog,n=e.setTurnoActivo,c=JSON.parse(localStorage.getItem("sesionCafi")),r=JSON.parse(localStorage.getItem("turnoEnCurso")),i=Ph(),o=Object(s.useState)(0),l=Object(v.a)(o,2),d=l[0],j=l[1],p=function(){a(!t),n(!0)};return window.addEventListener("keydown",(function(e){e.altKey&&85===e.keyCode&&p()})),r?console.log(!1):console.log(!0),Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{onClick:function(){return p()},style:{textTransform:"none",height:"100%",width:"60%"},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",style:{height:"100%",width:"100%"},children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/shift.svg",alt:"icono caja",style:{width:20}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Abrir/Cerrar turno"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"Alt + U"})})})]})}),Object(V.jsxs)(ze.a,{maxWidth:"lg",open:t,onClose:p,TransitionComponent:Dh,children:[Object(V.jsx)(Se.a,{position:"static",color:"default",elevation:0,children:Object(V.jsxs)(we.a,{value:d,onChange:function(e,t){j(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:[!0===(null===c||void 0===c?void 0:c.turno_en_caja_activo)&&r?Object(V.jsx)(Ie.a,Object(u.a)({label:"Cerrar Turno",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/shift.svg",alt:"icono almacen",className:i.iconSvg})},zh(0))):Object(V.jsx)(Ie.a,Object(u.a)({label:"Abrir Turno",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/shift.svg",alt:"icono almacen",className:i.iconSvg})},zh(0))),Object(V.jsx)(Fe.a,{container:!0,justify:"flex-end",children:Object(V.jsxs)(b.a,{mt:2,textAlign:"right",children:[Object(V.jsx)(b.a,{textAlign:"right",children:Object(V.jsx)(y.a,{variant:"caption",children:xt()().format("L")})}),Object(V.jsx)(b.a,{textAlign:"right",children:Object(V.jsxs)(y.a,{variant:"caption",children:[xt()().format("LT")," hrs."]})}),Object(V.jsx)(b.a,{textAlign:"right",children:Object(V.jsxs)(y.a,{variant:"caption",children:["Caja ",r?r.numero_caja:null]})})]})}),Object(V.jsx)(b.a,{mt:3,ml:3,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:p,size:"medium",children:Object(V.jsx)($e.a,{})})})]})}),Object(V.jsx)(Ah,{handleClickOpen:p,value:d})]})]})}var Ah=function(e){var t=e.handleClickOpen,a=e.value,n=JSON.parse(localStorage.getItem("turnoEnCurso")),c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(s.useState)(!1),i=Object(v.a)(r,2),o=i[0],l=i[1];return o?Object(V.jsx)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsx)(Pe.a,{style:{padding:0},children:!0===(null===c||void 0===c?void 0:c.turno_en_caja_activo)&&n?Object(V.jsx)(Fh,{style:{padding:0},value:a,index:0,children:Object(V.jsx)(kh,{setLoading:l,handleClickOpen:t})}):Object(V.jsx)(Fh,{value:a,index:0,children:Object(V.jsx)(Ih,{loading:o,setLoading:l,handleClickOpen:t})})})};xt.a.locale("es");var Th=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Wh(){var e,t=JSON.parse(localStorage.getItem("turnoEnCurso")),a=JSON.parse(localStorage.getItem("sesionCafi")),n={horario_en_turno:"ABRIR TURNO",id_caja:t?t.id_caja:"",id_usuario:a._id,token_turno_user:t?t.token_turno_user:""},c=Object(He.a)(sd,{variables:{empresa:a.empresa._id,sucursal:a.sucursal._id,input:n}}),r=c.data,i=c.refetch,o=vh(),l=Object(s.useState)(!1),d=Object(v.a)(l,2),j=d[0],u=d[1],p=function(){!0===a.accesos.ventas.pre_corte.ver&&u(!j)};if(!r)return null;return window.addEventListener("keydown",(function(e){e.altKey&&79===e.keyCode&&(p(),i())})),Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{onClick:function(){p(),i()},style:{textTransform:"none",height:"100%",width:"60%"},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cash-register.svg",alt:"icono caja",style:{width:20}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Pre corte caja"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"Alt + O"})})})]})}),Object(V.jsxs)(ze.a,{maxWidth:"lg",open:j,onClose:p,TransitionComponent:Th,children:[Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,lg:10,children:Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cash-register.svg",alt:"icono caja",className:o.iconSizeDialogs})}),Object(V.jsxs)(b.a,{ml:2,children:[Object(V.jsx)(b.a,{textAlign:"left",children:Object(V.jsx)(y.a,{variant:"h6",children:"Pre-Corte de Caja"})}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{textAlign:"right",children:Object(V.jsx)(y.a,{variant:"caption",children:xt()().format("MM/DD/YYYY")})}),Object(V.jsx)(b.a,{textAlign:"right",ml:2,children:Object(V.jsx)(y.a,{variant:"caption",children:Object(V.jsxs)("b",{children:[xt()().format("h:mm")," hrs."]})})})]})]})]})}),Object(V.jsx)(Fe.a,{item:!0,lg:2,children:Object(V.jsx)(b.a,{ml:4,display:"flex",alignItems:"center",justifyContent:"flex-end",children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:p,size:"large",children:Object(V.jsx)($e.a,{})})})})]}),Object(V.jsx)(Fe.a,{children:Object(V.jsx)(b.a,{p:2,children:!0===a.turno_en_caja_activo&&t?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(b.a,{children:Object(V.jsxs)(y.a,{variant:"subtitle1",children:[Object(V.jsx)("b",{children:"Usuario: "})," ",a.nombre]})}),Object(V.jsx)(b.a,{children:Object(V.jsxs)(y.a,{variant:"subtitle1",children:[Object(V.jsx)("b",{children:"Caja: "})," ",t?t.numero_caja:""]})}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{variant:"subtitle1",children:Object(V.jsx)("b",{children:"Fecha y hora al precorte: "})}),Object(V.jsx)(y.a,{variant:"subtitle1",children:xt()().format("MMMM D YYYY, h:mm:ss a")})]}),Object(V.jsxs)(b.a,{textAlign:"center",p:2,children:[Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Monto total en efectivo: "})}),Object(V.jsx)(y.a,{variant:"h3",style:{color:"green"},children:Object(V.jsxs)("b",{children:["$",null===r||void 0===r||null===(e=r.obtenerPreCorteCaja)||void 0===e?void 0:e.monto_efectivo_precorte]})})]})]}):Object(V.jsx)(b.a,{textAlign:"center",p:2,children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:"Por el momento no hay un turno en sesi\xf3n"})})})})})]}),Object(V.jsx)(We.a,{children:!0===a.turno_en_caja_activo&&t?Object(V.jsx)(w.a,{onClick:p,color:"primary",variant:"outlined",size:"large",autoFocus:!0,children:"Imprimir Ticket"}):null})]})]})}var Rh,$h=a(257),Mh=a.n($h),Lh=a(463),Vh=a.n(Lh),Uh=Object(z.d)(Rh||(Rh=Object(F.a)(["\nmutation crearCotizacion( $input: CrearVentasInput!, $empresa: ID!, $sucursal: ID!, $usuario: ID!, $caja: ID!) {\n    crearCotizacion(input: $input, empresa: $empresa, sucursal: $sucursal, usuario: $usuario, caja: $caja, ) {\n\t\t\tmessage\n\t\t}\n\t}\n"])));function Bh(e){var t,a,n,c,r,i,o,l,d,j=e.handleClickOpen,p=Object(s.useContext)(Ch).setAlert,m=Object(N.a)(Uh),O=Object(v.a)(m,1)[0],x=JSON.parse(localStorage.getItem("DatosVentas")),f=(JSON.parse(localStorage.getItem("turnoEnCurso")),JSON.parse(localStorage.getItem("sesionCafi"))),C=Object(s.useState)([]),I=Object(v.a)(C,2),k=I[0],F=I[1],z=Object(s.useState)([]),P=Object(v.a)(z,2),D=P[0],E=P[1],A=Object(s.useState)(D?null===D||void 0===D||null===(t=D.descuento_general)||void 0===t?void 0:t.precio_con_descuento:0),T=Object(v.a)(A,2),W=T[0],R=T[1],$=Object(s.useState)((null===D||void 0===D||null===(a=D.descuento_general)||void 0===a?void 0:a.porciento)?null===D||void 0===D||null===(n=D.descuento_general)||void 0===n?void 0:n.porciento:0),M=Object(v.a)($,2),L=M[0],U=M[1],B=[],J=null===x||void 0===x?void 0:x.total,q=vh(),H=function(e){F(Object(u.a)(Object(u.a)({},k),{},Object(h.a)({},e.target.name,e.target.value)))},Y={folio:"12345",descuento:x.descuento,ieps:x.ieps,impuestos:x.impuestos,iva:x.iva,monedero:x.monedero,subTotal:x.subTotal,total:x.total,venta_cliente:!1,montos_en_caja:{},credito:!1,descuento_general_activo:!!(null===D||void 0===D?void 0:D.descuento_general_activo)&&(null===D||void 0===D?void 0:D.descuento_general_activo),decuento_general:(null===D||void 0===D?void 0:D.descuento_general)?null===D||void 0===D?void 0:D.descuento_general:{porciento:0,precio_con_descuento:0,cantidad_descontado:0},dias_de_credito_venta:null,fecha_de_vencimiento_credito:null,fecha_vencimiento_cotizacion:k.fecha_vencimiento,cliente:{banco:null,celular:null,clave_cliente:"23233",curp:null,dias_credito:null,direccion:{calle:"Antonio",no_ext:"1",no_int:"1",codigo_postal:"1",colonia:"Antonio",municipio:"1",localidad:"1",estado:"1",pais:"1"},email:"antonio.poday@gmail.com",imagen:null,limite_credito:null,nombre_cliente:"Antonio",numero_cliente:"2323",razon_social:null,rfc:null,telefono:"1212",monedero_electronico:null},productos:[{cantidad:1,cantidad_venta:1,codigo_barras:"226216505720",concepto:"unidades",default:!0,descuento:{porciento:15,dinero_descontado:5.4,precio_con_descuento:30.6},descuento_activo:!0,granel_producto:{granel:!1,valor:0},precio:8.25,precio_a_vender:8.25,precio_actual_producto:8.25,precio_anterior:8.25,iva_total_producto:1.03,ieps_total_producto:0,impuestos_total_producto:1.03,subtotal_total_producto:7.22,total_total_producto:8.25,unidad:"Caja",codigo_unidad:"XBX",unidad_principal:!0,inventario_general:[{cantidad_existente:120,cantidad_existente_maxima:10,unidad_inventario:"Pz",codigo_unidad:null,unidad_maxima:"Caja"}],id_producto:{_id:"61b7bf6e3454b727a0c2e357",datos_generales:{clave_alterna:"COCA",codigo_barras:"226216505720",nombre_comercial:"COCACOLA",tipo_producto:"OTROS",nombre_generico:"COCACOLA",descripcion:null,id_categoria:null,categoria:null,subcategoria:null,id_subcategoria:null,id_departamento:null,departamento:null,id_marca:null,marca:null,receta_farmacia:!1,clave_producto_sat:{Name:"Refrescos",Value:"50202306"}},imagenes:[{url_imagen:""}],precios:{ieps:10,ieps_activo:!1,inventario:{inventario_maximo:15,inventario_minimo:5,unidad_de_inventario:"Caja",codigo_unidad:"XBX"},iva:16,iva_activo:!0,monedero:!1,monedero_electronico:0,precio_de_compra:{precio_con_impuesto:180,precio_sin_impuesto:155.1724,iva:24.8276,ieps:0},precios_producto:[{numero_precio:1,precio_neto:8.25,unidad_mayoreo:0,utilidad:10},{numero_precio:2,precio_neto:0,unidad_mayoreo:0,utilidad:0},{numero_precio:3,precio_neto:0,unidad_mayoreo:0,utilidad:0},{numero_precio:4,precio_neto:0,unidad_mayoreo:0,utilidad:0},{numero_precio:5,precio_neto:0,unidad_mayoreo:0,utilidad:0},{numero_precio:6,precio_neto:0,unidad_mayoreo:0,utilidad:0}],unidad_de_compra:{cantidad:24,precio_unitario_con_impuesto:7.5,precio_unitario_sin_impuesto:6.4655,unidad:"Caja",codigo_unidad:"XBX"}}},medida:null,color:null}]},X=function(){var e=Object(_.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,k.fecha_vencimiento&&k.tipo_venta){e.next=6;break}return p({message:"Por favor completa los datos necesarios",status:"error",open:!0}),e.abrupt("return",null);case 6:return e.next=8,O({variables:{input:Y,empresa:"60c120b6a694891f58d32a1d",sucursal:"60c8e180340d5d223432a916",usuario:"60dde52c5cda9d5510c4b7d0",caja:"61a5037918594a4ecdc1c7bf"}});case 8:t=e.sent,console.log(t);case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0),e.t0.networkError.result?console.log(e.t0.networkError.result.errors):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors.message);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();console.log(x);return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(Pe.a,{style:{padding:0},children:[Object(V.jsxs)("div",{className:q.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Usuario:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",disabled:!0,variant:"outlined",onChange:H,value:f?f.nombre:""})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",disabled:!0,onChange:H,variant:"outlined",value:xt()().format("L")})})]})]}),Object(V.jsxs)("div",{className:q.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Cliente:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",disabled:!0,onChange:H,variant:"outlined",value:(null===(c=x.cliente)||void 0===c?void 0:c.nombre_cliente)?null===(r=x.cliente)||void 0===r?void 0:r.nombre_cliente:"Publico General"})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Fecha Vencimiento:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,type:"date",onChange:H,size:"small",name:"fecha_vencimiento",variant:"outlined"})})]})]}),Object(V.jsxs)("div",{className:q.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"No. Cliente:"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",disabled:!0,onChange:H,variant:"outlined",value:x?null===(i=x.cliente)||void 0===i?void 0:i.numero_cliente:""})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:"Tipo de Venta:"}),Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"form-producto-tipo",onChange:H,name:"tipo_venta",children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),Object(V.jsx)(Ee.a,{value:"CREDITO",children:"Credito"}),Object(V.jsx)(Ee.a,{value:"CONTADO",children:"Contado"})]})})]})]}),Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{lg:6,children:Object(V.jsx)(b.a,{p:1,children:Object(V.jsxs)(Da.a,{elevation:3,children:[Object(V.jsx)(b.a,{p:2,textAlign:"center",children:Object(V.jsx)(y.a,{variant:"h6",children:"Agregar descuento total a la venta."})}),Object(V.jsxs)(b.a,{textAlign:"center",p:2,children:[Object(V.jsx)("div",{className:q.formInputFlex,children:Object(V.jsxs)(b.a,{width:"95%",children:[Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",p:1,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/price-tag.png",alt:"icono admin",style:{width:30}})}),Object(V.jsx)(y.a,{variant:"h6",children:"Porciento descuento"})]}),Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",justifyItems:"center",className:q.rootSlice,children:Object(V.jsx)(Ns.a,{getAriaValueText:function(e){return"".concat(e)},value:L.toFixed(2),"aria-labelledby":"discrete-slider-small-steps",valueLabelDisplay:"auto",onChange:function(e,t){U(t);var a=parseFloat((100-t).toFixed(6)),n=parseFloat((J*a/100).toFixed(6)),c=parseFloat((J-n).toFixed(6));E(B={descuento_general_activo:!0,descuento_general:{porciento:t,precio_con_descuento:n,cantidad_descontado:c}}),R(n)}})})]})}),Object(V.jsx)("div",{className:q.formInputFlex,children:Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{variant:"h6",children:"Total con descuento:"}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",mr:1,children:Object(V.jsx)(Vh.a,{style:{fontSize:38,color:"green"}})}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",type:"number",name:"precioConDescuento",onChange:function(e){var t=parseFloat(e.target.value);R(t);var a=parseFloat((t/J*100).toFixed(6)),n=parseFloat((100-a).toFixed(6)),c=parseFloat((J-t).toFixed(6));E(B={descuento_general_activo:!0,descuento_general:{porciento:n,precio_con_descuento:t,cantidad_descontado:c}}),U(n)},value:W,className:q.input,variant:"outlined"})]})]})})]}),Object(V.jsx)(b.a,{p:1,display:"flex",flexDirection:"row-reverse",children:Object(V.jsx)(w.a,{variant:"outlined",color:"secondary",size:"large",onClick:function(){B={descuento_general_activo:!1,descuento_general:{porciento:0,precio_con_descuento:0,cantidad_descontado:0}},U(0),R(0),E(B)},children:"Eliminar Descuento"})})]})})}),Object(V.jsxs)(Fe.a,{lg:6,children:[Object(V.jsxs)(b.a,{mr:2,mt:2,children:[Object(V.jsx)(b.a,{display:"flex",flexDirection:"row-reverse",width:"100%",children:Object(V.jsxs)(y.a,{style:{fontSize:18},children:[Object(V.jsx)("b",{children:"No. Productos: "})," ",x.productos.length]})}),Object(V.jsx)(b.a,{display:"flex",flexDirection:"row-reverse",width:"100%",children:Object(V.jsxs)(y.a,{style:{fontSize:18},children:[Object(V.jsx)("b",{children:"Sub total:"})," $",x?x.subTotal.toFixed(2):0]})}),Object(V.jsx)(b.a,{display:"flex",flexDirection:"row-reverse",width:"100%",children:Object(V.jsxs)(y.a,{style:{fontSize:18},children:[Object(V.jsx)("b",{children:"Impuestos:"})," $",x?x.impuestos.toFixed(2):0]})}),Object(V.jsx)(b.a,{display:"flex",flexDirection:"row-reverse",width:"100%",children:Object(V.jsxs)(y.a,{style:{fontSize:18},children:[Object(V.jsx)("b",{children:"I.V.A.:"})," $",x?x.iva.toFixed(2):0]})}),Object(V.jsx)(b.a,{display:"flex",flexDirection:"row-reverse",width:"100%",children:Object(V.jsxs)(y.a,{style:{fontSize:18},children:[Object(V.jsx)("b",{children:"Descuento:"})," ",Object(V.jsxs)("b",{style:{color:"green"},children:["$",(null===D||void 0===D?void 0:D.descuento_general)?(null===D||void 0===D||null===(o=D.descuento_general)||void 0===o?void 0:o.cantidad_descontado).toFixed(2):0," "]})]})})]}),Object(V.jsxs)(b.a,{display:"flex",flexDirection:"row-reverse",p:1,children:[Object(V.jsxs)(y.a,{variant:"h4",children:["Total:",Object(V.jsxs)("b",{style:{color:"green"},children:["$",(null===D||void 0===D?void 0:D.descuento_general)&&(null===D||void 0===D||null===(l=D.descuento_general)||void 0===l?void 0:l.precio_con_descuento)>0?(null===D||void 0===D||null===(d=D.descuento_general)||void 0===d?void 0:d.precio_con_descuento).toFixed(2):x?x.total.toFixed(2):0]})]}),Object(V.jsx)(b.a,{mt:.5,mr:1,children:Object(V.jsx)(Mh.a,{style:{fontSize:37,color:"green"}})})]})]})]})]}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{color:"primary",variant:"outlined",size:"large",onClick:X,children:"Crear cotizaci\xf3n"}),Object(V.jsx)(w.a,{color:"secondary",variant:"outlined",size:"large",onClick:j,children:"Cancelar"})]})]})}var Jh=[{id:"folio",label:"Folio",minWidth:20,align:"center"},{id:"cliente",label:"Cliente",minWidth:330},{id:"fecha",label:"Fecha",minWidth:100,align:"center"},{id:"total",label:"Total",minWidth:100,align:"center"}];function Gh(e,t,a,n){return{folio:e,cliente:t,fecha:a,total:n}}var qh=[Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10),Gh(2,"Jabon",50,10)],Hh=Object(k.a)({root:{width:"100%"},container:{maxHeight:"65vh"}});function Yh(e){e.handleClickOpen;var t=Hh(),a=l.a.useState(0),n=Object(v.a)(a,2),c=n[0],r=n[1],i=l.a.useState(10),o=Object(v.a)(i,2),s=o[0],d=o[1];return Object(V.jsxs)(Da.a,{className:t.root,children:[Object(V.jsx)(ra.a,{className:t.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Jh.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{width:e.minWidth},children:e.label},e.id)})),Object(V.jsx)(sa.a,{align:"center",style:{width:35},children:"Retomar"}),Object(V.jsx)(sa.a,{align:"center",style:{width:35},children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:qh.slice(c*s,c*s+s).map((function(e){return Object(V.jsx)(Xh,{row:e})}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[10,25,100],component:"div",count:qh.length,rowsPerPage:s,page:c,onChangePage:function(e,t){r(t)},onChangeRowsPerPage:function(e){d(+e.target.value),r(0)}})]})}var Xh=function(e){var t=e.row;return Object(V.jsx)(V.Fragment,{children:Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:"uno"}),Object(V.jsx)(sa.a,{children:"uno"}),Object(V.jsx)(sa.a,{align:"center",children:"uno"}),Object(V.jsx)(sa.a,{align:"center",children:"uno"}),Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)(X.a,{"aria-label":"delete",size:"small",children:Object(V.jsx)(Wu.a,{fontSize:"small"})})}),Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)(X.a,{"aria-label":"delete",size:"small",children:Object(V.jsx)(Wu.a,{fontSize:"small"})})})]},t.code)})},Kh=["children","value","index"],Qh=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Zh(e){var t=e.children,a=e.value,n=e.index,c=Object(fe.a)(e,Kh);return Object(V.jsx)("div",Object(u.a)(Object(u.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(V.jsx)(b.a,{p:3,height:"70vh",children:t})}))}function ef(e){return{id:"reg-product-tab-".concat(e),"aria-controls":"tabpanel-reg-product-".concat(e)}}function tf(e){var t=e.type;xt.a.locale("es");var a=JSON.parse(localStorage.getItem("sesionCafi")),n=JSON.parse(localStorage.getItem("turnoEnCurso")),c=JSON.parse(localStorage.getItem("DatosVentas")),r=Object(s.useState)(!1),i=Object(v.a)(r,2),o=i[0],l=i[1],d=Object(s.useState)(0),j=Object(v.a)(d,2),p=j[0],m=j[1],O=function(){!0===(null===a||void 0===a?void 0:a.accesos.ventas.cotizaciones.ver)&&l(!o)};return window.addEventListener("keydown",(function(e){e.altKey&&84===e.keyCode&&O()})),Object(V.jsxs)(V.Fragment,{children:["GENERAR"===t?c?Object(V.jsx)(w.a,{variant:"outlined",color:"primary",startIcon:Object(V.jsx)(Ce.d,{style:{fontSize:30}}),onClick:function(){O()},children:"Generar Cotizaci\xf3n"}):"":Object(V.jsx)(w.a,{onClick:function(){O()},style:{textTransform:"none",height:"100%",width:"60%"},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Ce.d,{style:{fontSize:25}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Cotizaciones"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"Alt + T"})})})]})}),Object(V.jsxs)(ze.a,{fullWidth:!0,open:o,maxWidth:"GENERAR"===t?"md":"lg",onClose:O,TransitionComponent:Qh,children:[Object(V.jsx)(Se.a,{position:"static",color:"default",elevation:0,children:Object(V.jsxs)(we.a,{value:p,onChange:function(e,t){m(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:["GENERAR"===t?Object(V.jsx)(Ie.a,Object(u.a)({label:"Nueva Cotizaci\xf3n",icon:Object(V.jsx)(Ce.d,{style:{fontSize:60}})},ef(0))):Object(V.jsx)(Ie.a,Object(u.a)({label:"Cotizaciones pendientes",icon:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/lista-de-espera.svg",alt:"icono caja2",style:{width:58}})},ef(1))),Object(V.jsx)(Fe.a,{container:!0,justify:"flex-end",children:Object(V.jsxs)(b.a,{mt:2,textAlign:"right",children:[Object(V.jsx)(b.a,{textAlign:"right",children:Object(V.jsx)(y.a,{variant:"caption",children:xt()().format("L")})}),Object(V.jsx)(b.a,{textAlign:"right",children:Object(V.jsxs)(y.a,{variant:"caption",children:[xt()().format("LT")," hrs."]})}),Object(V.jsx)(b.a,{textAlign:"right",children:Object(V.jsx)(y.a,{variant:"caption",children:null===a||void 0===a?void 0:a.nombre})}),Object(V.jsx)(b.a,{textAlign:"right",children:Object(V.jsxs)(y.a,{variant:"caption",children:["Caja ",n?n.numero_caja:null]})})]})}),Object(V.jsx)(b.a,{mt:3,ml:3,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:O,size:"medium",children:Object(V.jsx)($e.a,{})})})]})}),Object(V.jsx)(af,{handleClickOpen:O,value:p,type:t})]})]})}var af=function(e){var t=e.handleClickOpen,a=e.value,n=e.type,c=Object(s.useState)(!1),r=Object(v.a)(c,2),i=r[0];r[1];return i?Object(V.jsx)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:Object(V.jsx)(I.a,{})}):"GENERAR"===n?Object(V.jsx)(Zh,{style:{padding:0},value:a,index:0,children:Object(V.jsx)(Bh,{handleClickOpen:t})}):Object(V.jsx)(Zh,{style:{padding:0},value:a,index:0,children:Object(V.jsx)(Yh,{handleClickOpen:t})})};xt.a.locale("es");var nf=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function cf(){var e=Object(s.useContext)(Ch),t=e.updateTablaVentas,a=e.setUpdateTablaVentas,n=Object(s.useState)(!1),c=Object(v.a)(n,2),r=c[0],i=c[1],o=function(){i(!r)};window.addEventListener("keydown",(function(e){e.altKey&&69===e.keyCode&&o()}));return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{onClick:function(){return function(){var e=JSON.parse(localStorage.getItem("DatosVentas")),n=localStorage.getItem("ListaEnEspera");if(null!==e)if(null===n)localStorage.setItem("ListaEnEspera",JSON.stringify([{VentaEnEspera:e,fecha:xt()().format("MM/DD/YYYY")}])),localStorage.removeItem("DatosVentas"),a(!t);else{var c=JSON.parse(n);c.push({VentaEnEspera:e,fecha:xt()().format("MM/DD/YYYY")}),localStorage.setItem("ListaEnEspera",JSON.stringify(c)),localStorage.removeItem("DatosVentas"),a(!t)}}()},style:{textTransform:"none",height:"100%",width:"60%"},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Ce.g,{style:{fontSize:25}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"En espera"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"Alt + E"})})})]})}),Object(V.jsxs)(ze.a,{maxWidth:"lg",open:r,onClose:o,TransitionComponent:nf,children:[Object(V.jsx)(Pe.a,{children:Object(V.jsx)(Fe.a,{container:!0,item:!0,lg:12,children:Object(V.jsxs)(b.a,{display:"flex",textAlign:"center",justifyContent:"center",alignContent:"center",alignSelf:"center",justifySelf:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(Ce.g,{style:{fontSize:80}})}),Object(V.jsx)(b.a,{m:2,children:Object(V.jsx)(Te.a,{orientation:"vertical"})}),Object(V.jsx)(b.a,{mt:3,children:Object(V.jsx)(y.a,{variant:"h5",children:"Venta pasada a espera"})})]})})}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:function(){o()},variant:"contained",color:"primary",size:"large",children:"Aceptar"})})]})]})}var rf=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& .obligatorio":{color:"red"}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}}));function of(e){var t=e.setAbrirTallaColor,a=e.setCantidad,n=e.cantidad,c=e.obtenerConsultasProducto,r=e.refetch,i=Object(s.useContext)(xe),o=i.datos_generales,l=i.precios,d=i.setPrecios,j=i.setDatosGenerales,p=i.validacion,m=Object(s.useContext)(xe),O=m.unidadVentaXDefecto,x=m.setUnidadVentaXDefecto,f=m.update,g=function(e){"codigo_barras"===e.target.name&&x(Object(u.a)(Object(u.a)({},O),{},{codigo_barras:e.target.value})),j(Object(u.a)(Object(u.a)({},o),{},Object(h.a)({},e.target.name,e.target.value))),"CALZADO"!==e.target.value&&"ROPA"!==e.target.value||t(!0)},_=rf();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Informaci\xf3n General"})})}),Object(V.jsx)(Te.a,{}),Object(V.jsxs)("div",{className:_.formInputFlex,children:[Object(V.jsx)(b.a,{width:"100%",children:Object(V.jsxs)(G.a,{variant:"outlined",size:"small",name:"codigo_barras",fullWidth:!0,children:[Object(V.jsx)(y.a,{children:"C\xf3digo de barras"}),Object(V.jsx)(H.a,{disabled:f&&o.codigo_barras,style:{padding:0},id:"form-producto-codigo-barras",name:"codigo_barras",value:o.codigo_barras?o.codigo_barras:"",onChange:g,endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(w.a,{disabled:f&&o.codigo_barras,onClick:function(){return function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();j(Object(u.a)(Object(u.a)({},o),{},{codigo_barras:t})),x(Object(u.a)(Object(u.a)({},O),{},{codigo_barras:t}))}()},color:"primary",variant:"outlined",size:"large",children:"Generar"})})})]})}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:"obligatorio",children:"* "}),"Clave alterna"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:p.error&&!o.clave_alterna,name:"clave_alterna",id:"form-producto-clave-alterna",variant:"outlined",value:o.clave_alterna?o.clave_alterna:"",helperText:p.message,onChange:g})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:"obligatorio",children:"* "}),"Nombre comercial"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:p.error&&!o.nombre_comercial,name:"nombre_comercial",id:"form-producto-nombre-comercial",variant:"outlined",value:o.nombre_comercial?o.nombre_comercial:"",helperText:p.message,onChange:g})]}),Object(V.jsx)(b.a,{width:"100%",children:Object(V.jsx)(Fc,{refetch:r,codigos:c.codigos})})]}),Object(V.jsxs)("div",{className:_.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:"obligatorio",children:"* "}),"Nombre gen\xe9rico"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:p.error&&!o.nombre_generico,name:"nombre_generico",id:"form-producto-nombre-generico",variant:"outlined",value:o.nombre_generico?o.nombre_generico:"",helperText:p.message,onChange:g})]}),Object(V.jsxs)(b.a,{width:"60%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:"obligatorio",children:"* "}),"Tipo de producto"]}),Object(V.jsxs)(G.a,{variant:"outlined",fullWidth:!0,size:"small",error:p.error&&!o.tipo_producto,children:[Object(V.jsxs)(De.a,{id:"form-producto-tipo",name:"tipo_producto",value:o.tipo_producto?o.tipo_producto:"",onChange:g,children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),Object(V.jsx)(Ee.a,{value:"ROPA",children:"Ropa"}),Object(V.jsx)(Ee.a,{value:"CALZADO",children:"Calzado"}),Object(V.jsx)(Ee.a,{value:"OTROS",children:"Otros"})]}),Object(V.jsx)(ca.a,{children:p.message})]})]}),"OTROS"===o.tipo_producto?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(b.a,{width:"50%",children:[Object(V.jsxs)(y.a,{children:[Object(V.jsx)("span",{className:"obligatorio",children:"* "}),"Cantidad"]}),Object(V.jsx)(S.a,{fullWidth:!0,size:"small",error:p.error&&!n,name:"cantidad",type:"number",id:"form-producto-nombre-generico",variant:"outlined",value:n||"",helperText:p.message,onChange:function(e){return a(parseInt(e.target.value))}})]}),Object(V.jsxs)(b.a,{width:"80%",children:[Object(V.jsx)(y.a,{children:"Granel"}),Object(V.jsx)(aa.a,{control:Object(V.jsx)(na.a,{onChange:function(e){var t,a;"granel"===e.target.name&&e.target.checked?(d(Object(u.a)(Object(u.a)({},l),{},(t={},Object(h.a)(t,e.target.name,e.target.checked),Object(h.a)(t,"inventario",Object(u.a)(Object(u.a)({},l.inventario),{},{unidad_de_inventario:"Kg"})),Object(h.a)(t,"unidad_de_compra",Object(u.a)(Object(u.a)({},l.unidad_de_compra),{},{unidad:"Kg"})),t))),x(Object(u.a)(Object(u.a)({},O),{},{unidad:"Kg"}))):(d(Object(u.a)(Object(u.a)({},l),{},(a={},Object(h.a)(a,e.target.name,e.target.checked),Object(h.a)(a,"inventario",Object(u.a)(Object(u.a)({},l.inventario),{},{unidad_de_inventario:"Pz"})),Object(h.a)(a,"unidad_de_compra",Object(u.a)(Object(u.a)({},l.unidad_de_compra),{},{unidad:"Pz"})),a))),x(Object(u.a)(Object(u.a)({},O),{},{unidad:"Pz"})))},name:"granel"}),label:"Vender a granel"})]}),Object(V.jsxs)(b.a,{width:"80%",children:[Object(V.jsx)(y.a,{children:"Medicamento"}),Object(V.jsx)(aa.a,{control:Object(V.jsx)(na.a,{onChange:function(e){j(Object(u.a)(Object(u.a)({},o),{},{receta_farmacia:e.target.checked}))},name:"receta_farmacia"}),label:"Necesita receta",name:"receta_farmacia"})]})]}):null]})]})}var sf=function(e,t){if(e.medida.talla&&t.medida.talla)return e.medida.talla.localeCompare(t.medida.talla)},lf=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},container:{maxHeight:"65vh"},tableRow:{"&.Mui-selected, &.Mui-selected:hover":{backgroundColor:Object(Ma.fade)(e.palette.primary.main,.1)}},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",height:30,width:30,borderRadius:"15%"}}}));function df(e){var t=e.from,a=e.setOnUpdate,n=e.onUpdate,c=lf(),r=Object(s.useContext)(xe).presentaciones,i=Object(ea.a)(r).sort((function(e,t){return sf(e,t)}));return Object(V.jsx)("div",{className:c.root,children:Object(V.jsx)(Da.a,{className:c.paper,children:Object(V.jsx)(ra.a,{className:c.container,children:Object(V.jsxs)(da.a,{className:c.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",stickyHeader:!0,children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{children:"Existencia"}),Object(V.jsx)(sa.a,{children:"C\xf3digo de barras"}),Object(V.jsx)(sa.a,{width:200,children:"Nombre"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Medida"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Color"}),Object(V.jsx)(sa.a,{children:"Precio"}),t&&"compra"===t?Object(V.jsx)(sa.a,{padding:"checkbox",children:"Existente"}):null,Object(V.jsx)(sa.a,{padding:"checkbox",children:"Cantidad"}),Object(V.jsx)(sa.a,{padding:"checkbox",children:"Editar"})]})}),Object(V.jsx)(la.a,{children:i.map((function(e,c){return Object(V.jsx)(jf,{producto:e,index:c,from:t,setOnUpdate:a,onUpdate:n},c)}))})]})})})})}var jf=function(e){var t=e.producto,a=e.index,n=e.from,c=e.setOnUpdate,r=e.onUpdate,i=Object(s.useContext)(xe),o=i.presentaciones,l=i.setPresentaciones,d=i.preciosP,j=i.precios,p=Object(s.useState)(!0),m=Object(v.a)(p,2),O=m[0],x=m[1],h=lf(),f=Object(s.useRef)(null),g=Object(ea.a)(o).sort((function(e,t){return sf(e,t)})),_=Object(u.a)({},g[a]),C=Object(u.a)({},t);n&&"compra"===n&&(C.cantidad=0);var y=function(e){var t=e.target,n=t.value,c=t.name;if(console.log(c),"cantidad"===c){if(!n)return _.cantidad="",_.existencia=!1,g.splice(a,1,_),void l(g);_.cantidad=parseFloat(n),_.existencia=!0}else if("precio"===c){var r=j.iva,i=j.ieps;if(!n)return _.precio="",g.splice(a,1,_),void l(g);var o=parseFloat(n),s=r<10?"0".concat(r):r,d=i<10?"0".concat(i):i,u=parseFloat("0.".concat(s))+parseFloat("0.".concat(d)),b=parseFloat((o/(u+1)).toFixed(2)),p=parseFloat((b*parseFloat("0.".concat(s))).toFixed(2)),m=parseFloat((b*parseFloat("0.".concat(d))).toFixed(2)),O=j.unidad_de_compra.precio_unitario_sin_impuesto,x=parseFloat(((b-O)/O*100).toFixed(2));_.precio_unidad.precio_venta=b,_.precio_unidad.precio_neto=o,_.precio_unidad.utilidad=x,_.precio_unidad.iva_precio=p,_.precio_unidad.ieps_precio=m,_.precio=parseFloat(n)}else{if(!n)return _.codigo_barras="",g.splice(a,1,_),void l(g);_.codigo_barras=n}g.splice(a,1,_),l(g)},S=function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();_.codigo_barras=t,g.splice(a,1,_),l(g)},w=function(){O?(x(!O),c([].concat(Object(ea.a)(r),[a]))):(C.cantidad||(_.cantidad=0),C.precio||(_.precio=d[0].precio_neto),g.splice(a,1,_),l(g),x(!0),r.splice(r.length-1,1),c(Object(ea.a)(r)))};return Object(V.jsxs)(oa.a,{hover:!0,selected:!O,className:h.tableRow,children:[Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)(na.a,{checked:C.existencia,color:"primary"})}),Object(V.jsx)(sa.a,{width:220,children:Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(Pa.a,{inputRef:f,onChange:function(e){return y(e)},value:C.codigo_barras,type:"number",name:"precio",disabled:!C.nuevo||O}),C.nuevo||C.nuevo?Object(V.jsx)(X.a,{color:"primary",size:"small",onClick:function(){return S()},children:Object(V.jsx)(Wa.a,{})}):null]})}),Object(V.jsx)(sa.a,{width:200,children:C.nombre_comercial}),Object(V.jsx)(sa.a,{padding:"checkbox",children:C.medida._id?Object(V.jsx)(Ea.a,{label:C.medida.talla,color:"primary"}):""}),Object(V.jsx)(sa.a,{padding:"checkbox",children:C.color._id?Object(V.jsx)(Aa.a,{title:C.color.nombre,placement:"top",arrow:!0,TransitionComponent:Ta.a,children:Object(V.jsx)("div",{className:h.colorContainer,style:{backgroundColor:C.color.hex}})}):null}),Object(V.jsx)(sa.a,{width:110,children:Object(V.jsx)(Pa.a,{inputRef:f,onChange:function(e){return y(e)},disabled:O,value:C.precio,type:"tel",name:"precio"})}),n&&"compra"===n?Object(V.jsx)(sa.a,{padding:"checkbox",children:t.cantidad}):null,Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(Pa.a,{inputRef:f,onChange:function(e){return y(e)},disabled:O,value:C.cantidad,type:"tel",name:"cantidad"})}),Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(X.a,{size:"small",onClick:function(){return w()},children:O?Object(V.jsx)($a.a,{}):Object(V.jsx)(zt.a,{})})})]})},uf=Object(k.a)((function(e){return{colorContainer:{border:"1px solid rgba(0,0,0, .3)",display:"flex",justifyContent:"center",alignItems:"center",height:50,width:50,margin:1,borderRadius:"15%",cursor:"pointer"}}})),bf=function(){return Math.floor(9e11*Math.random()+1e11).toString()};function pf(e){var t=e.obtenerConsultasProducto,a=e.refetch,n=(e.datos,e.from),c=Object(s.useContext)(xe),r=c.presentaciones,i=c.datos_generales,o=t.colores,l=t.tallas,d=t.calzados,j=Object(s.useState)([]),u=Object(v.a)(j,2),p=u[0],m=u[1],O=Object(s.useState)([]),x=Object(v.a)(O,2),h=x[0],f=x[1],g="ROPA"===i.tipo_producto?Object(ea.a)(l):Object(ea.a)(d),_=Object(s.useState)([]),C=Object(v.a)(_,2),S=C[0],w=C[1],I=Object(s.useCallback)((function(){var e=[],t=[];Object(ea.a)(r).forEach((function(a){a.color._id&&e.push(a.color),a.medida._id&&t.push(a.medida)}));var a={},n={},c=e.filter((function(e){var t=!a[e._id];return a[e._id]=!0,t})),i=t.filter((function(e){var t=!n[e._id];return n[e._id]=!0,t}));f(Object(ea.a)(c)),m(Object(ea.a)(i))}),[r]);return Object(s.useEffect)((function(){I()}),[I]),Object(V.jsx)("div",{children:Object(V.jsxs)(Fe.a,{container:!0,spacing:2,children:[Object(V.jsx)(Fe.a,{item:!0,md:9,children:Object(V.jsx)(df,{from:n,setOnUpdate:w,onUpdate:S})}),Object(V.jsxs)(Fe.a,{item:!0,md:3,children:[Object(V.jsxs)(b.a,{width:"100%",my:2,style:S.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(V.jsx)(y.a,{children:"ROPA"===i.tipo_producto?"Talla":"N\xfamero"}),Object(V.jsx)(cc,{setMedidasSeleccionadas:m,refetch:a}),Object(V.jsx)(Fe.a,{container:!0,children:g.map((function(e,t){return Object(V.jsx)(mf,{talla:e,coloresSeleccionados:h,medidasSeleccionadas:p,setMedidasSeleccionadas:m},t)}))})]}),Object(V.jsx)(Te.a,{}),Object(V.jsxs)(b.a,{width:"100%",mt:1,style:S.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(V.jsx)(y.a,{children:"Color"}),Object(V.jsx)(Zn,{refetch:a}),Object(V.jsx)(Fe.a,{container:!0,children:o.map((function(e,t){return Object(V.jsx)(Of,{color:e,coloresSeleccionados:h,setColoresSeleccionados:f,medidasSeleccionadas:p},t)}))})]})]})]})})}var mf=function(e){var t=e.talla,a=e.coloresSeleccionados,n=e.medidasSeleccionadas,c=e.setMedidasSeleccionadas,r=uf(),i=Object(ve.a)(),o=Object(s.useContext)(xe),l=o.setPresentaciones,d=o.presentaciones,j=o.datos_generales,u=o.preciosP,b=o.precios,p=o.presentaciones_eliminadas,m=o.setPresentacionesEliminadas,O=Object(s.useState)(!1),x=Object(v.a)(O,2),h=x[0],f=x[1];return Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsx)("div",{className:r.colorContainer,onClick:function(){return function(e){var r=Object(ea.a)(n);h?r.forEach((function(a,n){a._id===t._id&&(r.splice(n,1),f(e),d.forEach((function(e){e.nuevo||e.medida._id===a._id&&m([].concat(Object(ea.a)(p),[e]))})))})):(r.push(t),f(e));var i=[],o=Object(ea.a)(d),s=b.iva,O=b.ieps;if(a.length||o.length){if(!a.length&&o.length>0)for(var x=function(e){var t=r[e],a=o.filter((function(e){return e.medida._id===t._id})),n=s<10?"0".concat(s):s,c=O<10?"0".concat(O):O,l=parseFloat((u[0].precio_venta*parseFloat("0.".concat(n))).toFixed(2)),d=parseFloat((u[0].precio_venta*parseFloat("0.".concat(c))).toFixed(2));a.length?i.push(a[0]):i.push({_id:"",existencia:!1,codigo_barras:bf(),nombre_comercial:j.nombre_comercial,medida:t,color:{nombre:"",hex:""},precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:l,ieps_precio:d,utilidad:u[0].utilidad,unidad_maxima:!1}})},g=0;g<r.length;g++)x(g);else if(a.length>0&&1===r.length&&e)for(var _=0;_<o.length;_++)for(var v=0;v<r.length;v++)i.push({_id:"",existencia:o[_].existencia,codigo_barras:o[_].codigo_barras,nombre_comercial:o[_].nombre_comercial,medida:r[v],color:o[_].color,precio:o[_].precio,cantidad:o[_].cantidad,nuevo:!0,precio_unidad:o[_].precio_unidad});else if(a.length>0&&r.length>0)for(var C=function(e){for(var t=r[e],n=function(e){var n=a[e],c=o.filter((function(e){return e.medida._id===t._id&&n._id===e.color._id})),r=s<10?"0".concat(s):s,l=O<10?"0".concat(O):O,d=parseFloat((u[0].precio_venta*parseFloat("0.".concat(r))).toFixed(2)),b=parseFloat((u[0].precio_venta*parseFloat("0.".concat(l))).toFixed(2));c.length?i.push(c[0]):i.push({_id:"",existencia:!1,codigo_barras:bf(),nombre_comercial:j.nombre_comercial,medida:t,color:n,precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:d,ieps_precio:b,utilidad:u[0].utilidad,unidad_maxima:!1}})},c=0;c<a.length;c++)n(c)},y=0;y<r.length;y++)C(y);else if(a.length>0&&!r.length&&o.filter((function(e){return e.medida._id})).length)for(var S=0;S<o.length;S++){var w=o[S];i.push({_id:w._id,existencia:w.existencia,codigo_barras:w.codigo_barras,nombre_comercial:w.nombre_comercial,medida:{},color:w.color,precio:w.precio,cantidad:w.cantidad,nuevo:!0,precio_unidad:w.precio_unidad})}}else for(var I=0;I<r.length;I++){var k=r[I],N=s<10?"0".concat(s):s,F=O<10?"0".concat(O):O,z=parseFloat((u[0].precio_venta*parseFloat("0.".concat(N))).toFixed(2)),P=parseFloat((u[0].precio_venta*parseFloat("0.".concat(F))).toFixed(2));i.push({_id:"",existencia:!1,codigo_barras:bf(),nombre_comercial:j.nombre_comercial,medida:k,color:{nombre:"",hex:""},precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:z,ieps_precio:P,utilidad:u[0].utilidad,unidad_maxima:!1}})}c(Object(ea.a)(r)),l(i)}(!h)},style:h?{backgroundColor:i.palette.primary.main}:null,children:Object(V.jsx)(y.a,{variant:"button",style:{color:i.palette.getContrastText(h?i.palette.primary.main:"#FFFFFF"),fontSize:16},children:t.talla})})})},Of=function(e){var t=e.color,a=e.coloresSeleccionados,n=e.setColoresSeleccionados,c=e.medidasSeleccionadas,r=(e.datos,uf()),i=Object(ve.a)(),o=Object(s.useContext)(xe),l=o.presentaciones,d=o.setPresentaciones,j=o.datos_generales,u=o.preciosP,b=o.precios,p=o.presentaciones_eliminadas,m=o.setPresentacionesEliminadas,O=Object(s.useState)(!1),x=Object(v.a)(O,2),h=x[0],f=x[1];return Object(V.jsx)(Fe.a,{item:!0,children:Object(V.jsx)(Aa.a,{title:t.nombre,placement:"top",arrow:!0,TransitionComponent:Ta.a,children:Object(V.jsx)("div",{className:r.colorContainer,style:{backgroundColor:t.hex,color:i.palette.getContrastText(t.hex)},onClick:function(){return function(e){h?a.forEach((function(n,c){n._id===t._id&&(a.splice(c,1),f(e),l.forEach((function(e){e.nuevo||e.color._id===n._id&&m([].concat(Object(ea.a)(p),[e]))})))})):(a.push(t),f(e));var r=[],i=Object(ea.a)(l),o=b.iva,s=b.ieps;if(c.length||i.length){if(!c.length&&i.length>0)for(var O=function(e){var t=a[e],n=i.filter((function(e){return e.color._id===t._id})),c=o<10?"0".concat(o):o,l=s<10?"0".concat(s):s,d=parseFloat((u[0].precio_venta*parseFloat("0.".concat(c))).toFixed(2)),b=parseFloat((u[0].precio_venta*parseFloat("0.".concat(l))).toFixed(2));n.length?r.push(n[0]):r.push({_id:"",existencia:!1,codigo_barras:bf(),nombre_comercial:j.nombre_comercial,medida:{},color:t,precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:d,ieps_precio:b,utilidad:u[0].utilidad,unidad_maxima:!1}})},x=0;x<a.length;x++)O(x);else if(c.length>0&&1===a.length&&e)for(var g=0;g<i.length;g++)for(var _=0;_<a.length;_++)r.push({_id:"",existencia:i[g].existencia,codigo_barras:i[g].codigo_barras,nombre_comercial:i[g].nombre_comercial,medida:i[g].medida,color:a[_],precio:i[g].precio,cantidad:i[g].cantidad,nuevo:!0,precio_unidad:i[g].precio_unidad});else if(c.length>0&&a.length>0)for(var v=function(e){for(var t=a[e],n=function(e){var a=c[e],n=i.filter((function(e){return e.medida._id===a._id&&t._id===e.color._id})),l=o<10?"0".concat(o):o,d=s<10?"0".concat(s):s,b=parseFloat((u[0].precio_venta*parseFloat("0.".concat(l))).toFixed(2)),p=parseFloat((u[0].precio_venta*parseFloat("0.".concat(d))).toFixed(2));n.length?r.push(n[0]):r.push({_id:"",existencia:!1,codigo_barras:bf(),nombre_comercial:j.nombre_comercial,medida:a,color:t,precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:b,ieps_precio:p,utilidad:u[0].utilidad,unidad_maxima:!1}})},l=0;l<c.length;l++)n(l)},C=0;C<a.length;C++)v(C);else if(c.length>0&&!a.length&&i.filter((function(e){return e.color._id})).length)for(var y=0;y<i.length;y++){var S=i[y];r.push({_id:S._id,existencia:S.existencia,codigo_barras:S.codigo_barras,nombre_comercial:S.nombre_comercial,medida:S.medida,color:{nombre:"",hex:""},precio:S.precio,cantidad:S.cantidad,nuevo:!0,precio_unidad:S.precio_unidad})}}else for(var w=0;w<a.length;w++){var I=a[w],k=o<10?"0".concat(o):o,N=s<10?"0".concat(s):s,F=parseFloat((u[0].precio_venta*parseFloat("0.".concat(k))).toFixed(2)),z=parseFloat((u[0].precio_venta*parseFloat("0.".concat(N))).toFixed(2));r.push({_id:"",existencia:!1,codigo_barras:bf(),nombre_comercial:j.nombre_comercial,medida:{},color:I,precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:F,ieps_precio:z,utilidad:u[0].utilidad,unidad_maxima:!1}})}n(Object(ea.a)(a)),d(r)}(!h)},children:h?Object(V.jsx)(Pt.a,{}):null})})})},xf=["children","value","index"];function hf(e){var t=e.children,a=e.value,n=e.index,c=Object(fe.a)(e,xf);return Object(V.jsx)("div",Object(u.a)(Object(u.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(V.jsx)(b.a,{p:3,height:"70vh",children:t})}))}function ff(e){return{id:"reg-product-tab-".concat(e),"aria-controls":"tabpanel-reg-product-".concat(e)}}var gf=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},iconSizeDialogs:{width:80},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper},iconSvg:{width:50},dialogContent:{padding:0},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},iconSizeSecondSuperior:{width:20}}})),_f=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function vf(){var e=gf(),t=Object(s.useState)(0),a=Object(v.a)(t,2),n=a[0],c=a[1],r=Object(s.useState)(!1),i=Object(v.a)(r,2),o=i[0],l=i[1],d=Object(s.useContext)(xe),j=d.datos_generales,p=d.setDatosGenerales,m=d.precios,O=d.setPrecios,x=d.validacion,h=d.setValidacion,f=d.setPreciosP,C=d.preciosP,S=d.unidadesVenta,k=d.setUnidadesVenta,F=d.unidadVentaXDefecto,z=d.setUnidadVentaXDefecto,P=d.setCentroDeCostos,D=d.presentaciones,E=d.setPresentaciones,A=Object(s.useContext)(Ch),T=A.setAlert,W=A.open,R=A.setOpen,$=JSON.parse(localStorage.getItem("sesionCafi")),M=Object(N.a)(_n),L=Object(v.a)(M,1)[0],U=Object(He.a)(pn,{variables:{empresa:$.empresa._id,sucursal:$.sucursal._id}}),B=U.data,J=U.refetch,G=U.loading,q=function(){p(ae),O(ne),z(ce),f(re),k([]),P({}),h({error:!1,message:""}),E([]),c(0)},H=Object(s.useState)(!1),Y=Object(v.a)(H,2),X=Y[0],K=Y[1],Q=Object(s.useState)(0),Z=Object(v.a)(Q,2),ee=Z[0],te=Z[1],ie=function(){!0===$.accesos.ventas.producto_rapido.ver&&(q(),R(!W),K(!1))};if(Object(s.useEffect)((function(){return function(){J()}}),[]),G||!B)return null;if(G)return Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:[Object(V.jsx)(I.a,{}),Object(V.jsx)(y.a,{variant:"h6",children:"Cargando..."})]});var oe=B.obtenerConsultasProducto;window.addEventListener("keydown",(function(e){e.altKey&&65===e.keyCode&&ie()}));var se=function(){var e=Object(_.a)(g.a.mark((function e(){var t,a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l(!0),!("OTROS"===j.tipo_producto&&ee<1)){e.next=5;break}return e.abrupt("return",h(!0));case 5:if(j.clave_alterna&&j.tipo_producto&&j.nombre_generico&&j.nombre_comercial&&m.precio_de_compra.precio_con_impuesto&&m.precio_de_compra.precio_sin_impuesto&&m.unidad_de_compra.cantidad){e.next=7;break}return e.abrupt("return",h(!0));case 7:return(0===S.length||0===S.filter((function(e){return e.default})).length)&&S.push(F),m.precios_producto=C,"OTROS"===j.tipo_producto&&ee<1&&(E(Oe),te(0)),t={datos_generales:j,precios:m,unidades_de_venta:S,presentaciones:D,cantidad:ee,empresa:$.empresa._id,sucursal:$.sucursal._id,usuario:$._id},e.prev=12,a=et(t),e.next=16,L({variables:{input:a}});case 16:n=e.sent,q(),J(),T({message:"\xa1Listo ".concat(n.data.crearProductoRapido.message,"!"),status:"success",open:!0}),l(!1),ie(),e.next=31;break;case 24:e.prev=24,e.t0=e.catch(12),q(),J(),T({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),l(!1),ie();case 31:case"end":return e.stop()}}),e,null,[[12,24]])})));return function(){return e.apply(this,arguments)}}(),le=Object(V.jsx)(w.a,{variant:"contained",color:"primary",onClick:function(){return se()},size:"large",startIcon:Object(V.jsx)(za.a,{}),disabled:"OTROS"===j.tipo_producto?!(j.clave_alterna&&j.tipo_producto&&j.nombre_generico&&j.nombre_comercial&&ee&&m.precio_de_compra.precio_con_impuesto&&m.precio_de_compra.precio_sin_impuesto&&m.unidad_de_compra.cantidad):!(j.clave_alterna&&j.tipo_producto&&j.nombre_generico&&j.nombre_comercial&&m.precio_de_compra.precio_con_impuesto&&m.precio_de_compra.precio_sin_impuesto&&m.unidad_de_compra.cantidad),children:"Guardar"}),de=function(){return 1===n?le:"OTROS"!==j.tipo_producto&&j.tipo_producto?Object(V.jsx)(w.a,{variant:"contained",color:"primary",onClick:function(){return c(n+1)},size:"large",endIcon:Object(V.jsx)(Hr.a,{}),disableElevation:!0,children:"Siguiente"}):le};return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{onClick:function(){ie()},value:"articulo-rapido",style:{textTransform:"none",height:"100%",width:"60%"},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/tiempo-rapido.svg",alt:"icono caja2",className:e.iconSizeSecondSuperior})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Producto Rapido"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"Alt + A"})})})]})}),Object(V.jsxs)(ze.a,{maxWidth:"lg",open:W,onClose:ie,TransitionComponent:_f,children:[Object(V.jsx)(Se.a,{position:"static",color:"default",elevation:0,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"space-between",children:Object(V.jsxs)(we.a,{value:n,onChange:function(e,t){c(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:[Object(V.jsx)(Ie.a,Object(u.a)({label:"Datos generales",icon:Object(V.jsx)(uc.a,{color:"secondary",badgeContent:Object(V.jsx)(y.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!x.error||!x.vista1,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/portapapeles.svg",alt:"icono registro",className:e.iconSvg})})},ff(0))),!1===X||"OTROS"===j.tipo_producto?null:Object(V.jsx)(Ie.a,Object(u.a)({label:"Tallas y colores",icon:Object(V.jsx)(uc.a,{color:"secondary",badgeContent:Object(V.jsx)(y.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!x.error||!x.vista7,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/tallas-colores.svg",alt:"icono colores",className:e.iconSvg})})},ff(6)))]})})}),Object(V.jsxs)(Pe.a,{className:e.dialogContent,children:[Object(V.jsx)(Me.a,{className:e.backdrop,open:o,children:Object(V.jsx)(I.a,{color:"inherit"})}),Object(V.jsxs)("div",{className:e.root,children:[Object(V.jsxs)(hf,{value:n,index:0,children:[Object(V.jsx)(of,{setAbrirTallaColor:K,setCantidad:te,cantidad:ee,obtenerConsultasProducto:oe,refetch:J}),Object(V.jsx)(Sa,{})]}),Object(V.jsx)(hf,{value:n,index:1,children:Object(V.jsx)(pf,{obtenerConsultasProducto:oe,refetch:J})})]})]}),Object(V.jsxs)(We.a,{style:{display:"flex",justifyContent:"center"},children:[Object(V.jsx)(w.a,{variant:"outlined",color:"primary",onClick:function(){return c(n-1)},size:"large",startIcon:Object(V.jsx)(Yr.a,{}),disabled:0===n,children:"Anterior"}),Object(V.jsx)(w.a,{variant:"outlined",color:"inherit",onClick:function(){ie(),q()},size:"large",startIcon:Object(V.jsx)(zt.a,{}),disableElevation:!0,children:"Cancelar"}),Object(V.jsx)(de,{})]})]})]})}function Cf(e){var t=e.handleClickOpen;return Object(V.jsx)(he,{children:Object(V.jsx)(vf,{handleClickOpen:t})})}var yf=Object(x.f)((function(e){var t=Object(s.useContext)(Ch),a=t.alert,n=t.setAlert,c=t.abrirTurnosDialog,r=t.setAbrirTurnosDialog,i=t.setUbicacionTurno,o=gh(),l=Object(s.useState)("venta-general"),d=Object(v.a)(l,2),j=d[0],u=d[1],p=JSON.parse(localStorage.getItem("sesionCafi")),m=JSON.parse(localStorage.getItem("turnoEnCurso"));return xt.a.locale("es"),window.addEventListener("keydown",(function(t){112===t.keyCode&&e.history.push("/admin"),115===t.keyCode&&e.history.push("/")})),Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(B,{alert:a,setAlert:n}),Object(V.jsxs)(hh.a,{value:j,onChange:function(e,t){u(t)},showLabels:!0,className:o.navigationTop,children:[Object(V.jsx)(Cf,{}),Object(V.jsx)(Te.a,{orientation:"vertical"}),Object(V.jsx)(tf,{}),Object(V.jsx)(Te.a,{orientation:"vertical"}),Object(V.jsx)(wh,{}),Object(V.jsx)(Te.a,{orientation:"vertical"}),Object(V.jsx)(Eh,{}),Object(V.jsx)(Te.a,{orientation:"vertical"}),Object(V.jsx)(Wh,{}),Object(V.jsx)(Te.a,{orientation:"vertical"}),Object(V.jsx)(cf,{}),Object(V.jsx)(Te.a,{orientation:"vertical"}),Object(V.jsx)(w.a,{onClick:function(){!0===p.accesos.ventas.administrador.ver&&e.history.push("/admin")},style:{textTransform:"none",height:"100%",width:"60%"},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/admin.svg",alt:"icono admin",className:o.iconSizeSecondSuperior})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Administrador"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"F1"})})})]})}),Object(V.jsx)(Te.a,{orientation:"vertical"}),Object(V.jsx)(w.a,{onClick:function(){!0===p.turno_en_caja_activo&&m?(r(!c),i("SESION")):(localStorage.removeItem("sesionCafi"),localStorage.removeItem("tokenCafi"),localStorage.removeItem("DatosVentas"),localStorage.removeItem("turnoEnCurso"),localStorage.removeItem("ListaEnEspera"),e.history.push("/"))},style:{textTransform:"none",height:"100%",width:"40%"},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",style:{textTransform:"none",height:"100%",width:"100%"},children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(fh.c,{className:o.iconSizeSuperior,style:{color:"red"}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Salir"})})})]})}),Object(V.jsxs)(b.a,{display:"flex",justifyContent:"flex-end",style:{height:"100%",width:"100%"},children:[Object(V.jsxs)(b.a,{mr:3,display:"flex",alignItems:"center",children:[Object(V.jsx)(qt.a,{alt:"Remy Sharp",srsc:"/static/images/avatar/1.jpg",className:o.avatar}),Object(V.jsx)("div",{children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{color:"textSecondary",children:null===p||void 0===p?void 0:p.nombre}),(null===m||void 0===m?void 0:m.numero_caja)?Object(V.jsxs)(y.a,{color:"textSecondary",children:[Object(V.jsx)("b",{children:"Caja: "}),null===m||void 0===m?void 0:m.numero_caja]}):""]})})]}),Object(V.jsxs)(b.a,{mr:3,display:"flex",alignItems:"center",children:[Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/calendario.svg",alt:"icono admin",className:o.avatar}),Object(V.jsx)("div",{children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(y.a,{color:"textSecondary",children:xt()().format("MM/DD/YYYY")}),Object(V.jsx)(y.a,{color:"textSecondary",children:Object(V.jsxs)("b",{children:[xt()().format("h:mm")," hrs."]})})]})})]})]})]})]})})),Sf=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function wf(){var e=vh(),t=Object(s.useState)(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!n)};return window.addEventListener("keydown",(function(e){117===e.keyCode&&r()})),Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{className:e.borderBotonChico,onClick:r,children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(Ce.f,{style:{fontSize:35}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Abonos"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"F6"})})})]})}),Object(V.jsxs)(ze.a,{maxWidth:"lg",open:n,onClose:r,TransitionComponent:Sf,children:[Object(V.jsx)(Pe.a,{children:"Abonitos"}),Object(V.jsx)(We.a,{})]})]})}var If,kf,Nf,Ff,zf=a(258),Pf=a.n(zf),Df=[{id:"clave",label:"Clave",minWidth:40,align:"center"},{id:"codigo",label:"C. Barras",minWidth:40,align:"center"},{id:"descripcion",label:"Nombre/Descrip.",minWidth:330},{id:"existencia",label:"Exist.",minWidth:30,align:"center"},{id:"unidad",label:"Unidad",minWidth:30,align:"center"},{id:"precio",label:"Precio",minWidth:30,align:"center"}],Ef=Object(k.a)({root:{width:"100%",marginTop:15},container:{height:"40vh"}});function Af(e){var t=e.productosBusqueda,a=e.setProductoSeleccionado,n=e.loading,c=Ef();return n?Object(V.jsx)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"50vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsx)(Da.a,{className:c.root,children:Object(V.jsx)(ra.a,{className:c.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:Df.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{width:e.minWidth},children:e.label},e.id)}))})}),Object(V.jsx)(la.a,{children:t.map((function(e){return Object(V.jsx)(Tf,{producto:e,setProductoSeleccionado:a})}))})]})})})}function Tf(e){var t=e.producto,a=e.setProductoSeleccionado;return Object(V.jsx)(V.Fragment,{children:Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,onClick:function(){return a(t)},children:[Object(V.jsx)(sa.a,{align:"center",children:t.id_producto.datos_generales.clave_alterna}),Object(V.jsx)(sa.a,{align:"center",children:t.id_producto.datos_generales.codigo_barras}),Object(V.jsx)(sa.a,{children:t.id_producto.datos_generales.nombre_comercial}),Object(V.jsx)(sa.a,{align:"center",children:t.cantidad}),Object(V.jsx)(sa.a,{align:"center",children:t.unidad}),Object(V.jsx)(sa.a,{align:"center",children:t.precio})]},t._id)})}Object(z.d)(If||(If=Object(F.a)(["\n  query ObtenerConsultaGeneralVentas($empresa: ID!, $sucursal: ID!) {\n    obtenerConsultaGeneralVentas(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      precio\n      cantidad\n      concepto\n      unidad\n      unidad_principal\n      codigo_barras\n      descuento {\n        porciento\n        dinero_descontado\n        precio_con_descuento\n      }\n      descuento_activo\n      default\n      id_producto {\n        datos_generales {\n          nombre_comercial\n          codigo_barras\n          tipo_producto\n          clave_alterna\n        }\n      }\n      inventario_general {\n        cantidad_existente\n        unidad_inventario\n        cantidad_existente_maxima\n        unidad_maxima\n      }\n    }\n  }\n"])));var Wf=Object(z.d)(kf||(kf=Object(F.a)(["\n   query ObtenerUnProductoVentas(\n    $empresa: ID!\n    $sucursal: ID!\n    $datosProductos: ID!\n  ) {\n    obtenerUnProductoVentas(\n      empresa: $empresa\n      sucursal: $sucursal\n      datosProductos: $datosProductos\n    ) {\n      _id\n      precio\n      cantidad\n      concepto\n      unidad\n      unidad_principal\n      codigo_barras\n      codigo_unidad\n      precio_unidad{\n        numero_precio\n        precio_neto\n        precio_venta\n        iva_precio\n        ieps_precio\n        unidad_mayoreo\n        precio_general\n        cantidad_unidad\n        unidad_maxima\n      }\n      descuento {\n        cantidad_unidad\n        numero_precio\n        unidad_maxima\n        precio_general\n        precio_neto\n        precio_venta\n        iva_precio\n        ieps_precio\n        utilidad\n        dinero_descontado\n        porciento\n      }\n      medida{\n        talla\n        tipo\n        _id\n      }\n      color{\n        hex\n        nombre\n        _id\n      }\n      descuento_activo\n      default\n      id_producto {\n        imagenes{\n          url_imagen\n        }\n        _id\n        datos_generales {\n          nombre_comercial\n          codigo_barras\n          tipo_producto\n          clave_alterna\n          nombre_generico\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat{\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          ieps\n          ieps_activo\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n            codigo_unidad\n          }\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          precio_de_compra {\n            precio_con_impuesto\n            precio_sin_impuesto\n            iva\n            ieps\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n            codigo_unidad\n          }\n        }\n      }\n      inventario_general {\n        cantidad_existente\n        unidad_inventario\n        cantidad_existente_maxima\n        unidad_maxima\n        codigo_unidad\n      }\n      \n    }\n  }\n"]))),Rf=Object(z.d)(Nf||(Nf=Object(F.a)(["\n  query ObtenerProductosVentas($empresa: ID!$sucursal: ID! $input: ObtenerProductosVentasInput) {\n    obtenerProductosVentas(empresa: $empresa sucursal: $sucursal input: $input) {\n      _id\n      precio\n      cantidad\n      concepto\n      unidad\n      unidad_principal\n      codigo_barras\n      descuento {\n        porciento\n        dinero_descontado\n        precio_con_descuento\n      }\n      descuento_activo\n      default\n      id_producto {\n        imagenes{\n          url_imagen\n        }\n        _id\n        datos_generales {\n          nombre_comercial\n          codigo_barras\n          tipo_producto\n          clave_alterna\n        }\n        precios {\n          ieps\n          ieps_activo\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n          }\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          precio_de_compra {\n            precio_con_impuesto\n            precio_sin_impuesto\n            iva\n            ieps\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            unidad_mayoreo\n            utilidad\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n          }\n        }\n      }\n      inventario_general {\n        cantidad_existente\n        unidad_inventario\n        cantidad_existente_maxima\n        unidad_maxima\n      }\n    }\n  }\n"]))),$f=Object(z.d)(Ff||(Ff=Object(F.a)(["\n  query ObtenerClientesVentas($empresa: ID!, $sucursal: ID!) {\n    obtenerClientesVentas(empresa: $empresa, sucursal: $sucursal) {\n      numero_cliente\n      clave_cliente\n      nombre_cliente\n      rfc\n      curp\n      telefono\n      celular\n      email\n      numero_descuento\n      limite_credito\n      dias_credito\n      razon_social\n      direccion {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      imagen\n      banco\n      numero_cuenta\n      monedero_electronico\n      credito_disponible\n    }\n  }\n"])));function Mf(e){var t,a,n,c,r=e.productoSeleccionado,i=vh();return r?Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,lg:12,children:Object(V.jsxs)("div",{className:i.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Nombre:"})}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(y.a,{children:null===r||void 0===r||null===(t=r.id_producto)||void 0===t||null===(a=t.datos_generales)||void 0===a?void 0:a.nombre_comercial})})]}),Object(V.jsxs)(b.a,{width:"100%",children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Codigo Barras:"})}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(y.a,{children:null===r||void 0===r?void 0:r.codigo_barras})})]}),Object(V.jsxs)(b.a,{width:"70%",children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Cantidad:"})}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(y.a,{children:null===r||void 0===r?void 0:r.cantidad})})]}),Object(V.jsxs)(b.a,{width:"70%",children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Unidad:"})}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(y.a,{children:null===r||void 0===r?void 0:r.unidad})})]}),Object(V.jsxs)(b.a,{width:"70%",children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Descuento:"})}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(y.a,{children:(null===r||void 0===r?void 0:r.descuento)?null===r||void 0===r?void 0:r.descuento.precio_neto:0})})]}),Object(V.jsxs)(b.a,{width:"70%",children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"% Descuento:"})}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(y.a,{children:(null===r||void 0===r?void 0:r.descuento)?null===r||void 0===r?void 0:r.descuento.precio_neto:0})})]})]})}),Object(V.jsx)(Fe.a,{item:!0,lg:12,children:Object(V.jsx)(Lf,{precios:null===r||void 0===r||null===(n=r.id_producto)||void 0===n||null===(c=n.precios)||void 0===c?void 0:c.precios_producto})})]}):null}function Lf(e){var t=e.precios;return Object(V.jsx)("div",{children:Object(V.jsx)(ra.a,{children:Object(V.jsxs)(da.a,{"aria-label":"simple table",size:"small",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{style:{minWidth:150},children:"Precios de venta"}),[1,2,3,4,5,6].map((function(e,t){return Object(V.jsx)(sa.a,{style:{minWidth:100},children:e},t)}))]})}),Object(V.jsx)(la.a,{children:["Precio de venta"].map((function(e,a){return Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{style:{border:0},children:Object(V.jsx)("b",{children:e})}),null===t||void 0===t?void 0:t.map((function(e,t){return Object(V.jsx)(sa.a,{style:{border:0},children:null===e||void 0===e?void 0:e.precio_neto},t)}))]},a)}))})]})})})}var Vf=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Uf(){var e,t,a=vh(),n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(s.useState)(!1),r=Object(v.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)([]),d=Object(v.a)(l,2),j=d[0],p=d[1],m=Object(s.useState)([]),O=Object(v.a)(m,2),x=O[0],f=O[1],C=Object(ha.useDebounce)(j,500),S=Object(v.a)(C,1)[0],I=Object(He.a)(Rf,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id,input:{producto:S.producto?S.producto:""}}}),k=I.data,N=I.refetch,F=I.loading,z=[];k&&(z=k.obtenerProductosVentas);var P=function(){var e=Object(_.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"Enter"!==t.code&&"NumpadEnter"!==t.code||(p(Object(u.a)(Object(u.a)({},j),{},Object(h.a)({},t.target.name,t.target.value))),N());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){f([]),N(),o(!i)};return window.addEventListener("keydown",(function(e){e.altKey&&80===e.keyCode&&D()})),Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{className:a.borderBotonChico,onClick:D,children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(Ce.q,{style:{fontSize:45}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Productos"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"Alt + P"})})})]})}),Object(V.jsxs)(ze.a,{maxWidth:"md",fullWidth:!0,open:i,onClose:D,TransitionComponent:Vf,children:[Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,lg:3,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",children:(null===x||void 0===x||null===(e=x.id_producto)||void 0===e?void 0:e.imagenes.length)>0?Object(V.jsx)(b.a,{className:a.containerImage,children:Object(V.jsx)("img",{alt:"Imagen producto",src:null===x||void 0===x||null===(t=x.id_producto)||void 0===t?void 0:t.imagenes[0].url_imagen,className:a.imagen})}):Object(V.jsx)(b.a,{p:8,display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Pf.a,{style:{fontSize:40}})})})}),Object(V.jsxs)(Fe.a,{item:!0,lg:9,children:[Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{display:"flex",flexGrow:1,children:Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"h6",children:"Buscar Productos"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:D,size:"large",children:Object(V.jsx)($e.a,{})})})]}),Object(V.jsx)("div",{className:a.formInputFlex,children:Object(V.jsx)(b.a,{width:"50%",children:Object(V.jsxs)(Da.a,{className:a.rootBusqueda,children:[Object(V.jsx)(us.a,{fullWidth:!0,name:"producto",placeholder:"Buscar producto...",onChange:function(e){p(Object(u.a)(Object(u.a)({},j),{},Object(h.a)({},e.target.name,e.target.value)))},onKeyUp:P}),Object(V.jsx)(X.a,{children:Object(V.jsx)(xc.a,{})})]})})})]})]}),Object(V.jsx)(Mf,{productoSeleccionado:x}),Object(V.jsx)(Fe.a,{children:Object(V.jsx)(Af,{productosBusqueda:z,setProductoSeleccionado:f,loading:F})})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:D,variant:"contained",color:"primary",size:"large",children:"AGREGAR"})})]})]})}var Bf=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))})),Jf=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},root:{display:"flex",paddingLeft:e.spacing(2)}}}));function Gf(){var e=Jf(),t=Object(s.useState)(""),a=Object(v.a)(t,2),n=(a[0],a[1],Object(s.useState)("")),c=Object(v.a)(n,2),r=c[0],i=c[1],o=Object(s.useState)(!1),l=Object(v.a)(o,2),d=l[0],j=l[1],u=function(){j(!d)};return window.addEventListener("keydown",(function(e){e.altKey&&67===e.keyCode&&u()})),Object(V.jsx)(V.Fragment,{children:Object(V.jsxs)(ji,{children:[Object(V.jsx)(w.a,{style:{height:"100%",width:"100%",border:".6px solid #DBDBDB"},onClick:u,children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(Ce.b,{style:{fontSize:45}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Clientes"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"aLT + C"})})})]})}),Object(V.jsx)(ze.a,{maxWidth:"lg",open:d,onClose:u,TransitionComponent:Bf,children:Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(Fe.a,{container:!0,item:!0,lg:12,children:[Object(V.jsxs)(b.a,{ml:3,display:"flex",flexGrow:1,alignItems:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(Ce.b,{style:{fontSize:65}})}),Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Clientes"})]}),Object(V.jsx)(b.a,{mr:2,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:u,size:"large",children:Object(V.jsx)($e.a,{style:{fontSize:30}})})})]}),Object(V.jsxs)(b.a,{m:2,display:"flex",justifyContent:"space-between",children:[Object(V.jsx)(b.a,{mr:5,minWidth:"70%",children:Object(V.jsxs)(Da.a,{className:e.root,children:[Object(V.jsx)(us.a,{fullWidth:!0,placeholder:"Buscar cliente...",onChange:function(e){return i(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&i(e.target.defaultValue)},value:r}),Object(V.jsx)(X.a,{onClick:function(){return i(r)},children:Object(V.jsx)(xc.a,{})})]})}),Object(V.jsx)(zi,{tipo:"CLIENTE",accion:"registrar",ventas:!0,handleClickOpen:u})]}),Object(V.jsx)(b.a,{mx:2,children:Object(V.jsx)(xs,{tipo:"CLIENTE",filtro:r,ventas:!0,handleClickOpen:u})})]})})]})})}var qf=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Hf(){var e=vh(),t=Object(s.useState)(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!n)};return window.addEventListener("keydown",(function(e){119===e.keyCode&&r()})),Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{className:e.borderBotonChico,onClick:r,children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cajon.svg",alt:"icono ventas",style:{width:38}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Cajon"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"F8"})})})]})}),Object(V.jsxs)(ze.a,{maxWidth:"lg",open:n,onClose:r,TransitionComponent:qf,children:[Object(V.jsx)(Pe.a,{children:Object(V.jsx)(Fe.a,{container:!0,item:!0,lg:12,children:Object(V.jsxs)(b.a,{display:"flex",textAlign:"center",justifyContent:"center",alignContent:"center",alignSelf:"center",justifySelf:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cajon.svg",alt:"icono caja",style:{width:40}})}),Object(V.jsx)(b.a,{m:2,children:Object(V.jsx)(Te.a,{orientation:"vertical"})}),Object(V.jsx)(b.a,{mt:3,children:Object(V.jsx)(y.a,{variant:"h5",children:"Cajon Abierto"})})]})})}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:r,variant:"contained",color:"primary",children:"Aceptar"})})]})]})}var Yf=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Xf(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=vh(),a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=function(){!0===e.accesos.ventas.cancelar_venta.ver&&r(!c)};return window.addEventListener("keydown",(function(e){118===e.keyCode&&i()})),Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{className:t.borderBotonChico,onClick:i,children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/shopping-cart.svg",alt:"icono cancelarventa",style:{width:35}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Cancelar Venta"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"F7"})})})]})}),Object(V.jsxs)(ze.a,{maxWidth:"lg",open:c,onClose:i,TransitionComponent:Yf,children:[Object(V.jsxs)(Pe.a,{children:[Object(V.jsx)(Fe.a,{container:!0,item:!0,lg:12,children:Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",justifyContent:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/shopping-cart.svg",alt:"icono caja",className:t.iconSizeDialogs})}),Object(V.jsx)(b.a,{m:2,children:Object(V.jsx)(Te.a,{orientation:"vertical"})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"h5",children:"Cancelar Venta"})})]})}),Object(V.jsx)(b.a,{p:2,children:Object(V.jsx)(y.a,{variant:"h5",children:"\xbfEsta seguro que desea cancelar esta venta?"})})]}),Object(V.jsxs)(We.a,{children:[Object(V.jsx)(w.a,{onClick:function(){localStorage.removeItem("DatosVentas"),i()},variant:"contained",color:"primary",size:"large",autoFocus:!0,children:"Aceptar"}),Object(V.jsx)(w.a,{onClick:i,variant:"contained",color:"secondary",size:"large",autoFocus:!0,children:"Cancelar"})]})]})]})}var Kf=a.p+"static/media/tarjeta-de-credito.2374ca73.svg",Qf=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Zf(){var e=vh(),t=Object(s.useState)(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!n)},i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(!1),u=Object(v.a)(j,2),p=u[0],m=(u[1],Object(s.useState)(0)),O=Object(v.a)(m,2),x=O[0],h=O[1],f=Object(s.useState)("EFECTIVO"),g=Object(v.a)(f,2),_=g[0],C=g[1],I=Object(s.useState)(0),k=Object(v.a)(I,2),N=k[0],F=k[1],z=Object(s.useState)(0),P=Object(v.a)(z,2),D=P[0],E=P[1],A=Object(s.useState)({}),T=Object(v.a)(A,2),W=T[0],R=T[1],$=Object(s.useState)(),M=Object(v.a)($,2),L=M[0],U=M[1],B=function(){var e=JSON.parse(localStorage.getItem("DatosVentas")),t=null===e?0:e.total;h(t.toFixed(2)),F(t.toFixed(2)),d(!l),R(null===e?{}:e.cliente),U(null===e?0:e.monedero)};var J=function(e){C(e)},G=function(e,t){_===t&&(F(e.target.value),E(e.target.value-parseFloat(x)))};return window.onkeydown=function(e){27===e.keyCode&&B()},Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{className:e.borderBotonChico,onClick:B,children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cart.svg",alt:"icono ventas",style:{width:38}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Pagar"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"ESC"})})})]})}),Object(V.jsxs)(ze.a,{maxWidth:"lg",open:l,onClose:B,TransitionComponent:Qf,children:[Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(Fe.a,{container:!0,item:!0,lg:12,justify:"center",children:[Object(V.jsxs)(b.a,{display:"flex",justifyContent:"center",flexGrow:1,children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/cart.svg",alt:"icono ventas",className:e.iconSizeDialogsPequeno})}),Object(V.jsx)(b.a,{m:2,children:Object(V.jsx)(Te.a,{orientation:"vertical"})}),Object(V.jsx)(b.a,{mt:1,textAlign:"center",children:Object(V.jsx)(y.a,{variant:"h4",children:"Ticket"})})]}),Object(V.jsx)(b.a,{children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:B,size:"large",children:Object(V.jsx)($e.a,{})})})]}),Object(V.jsxs)(Fe.a,{children:[Object(V.jsx)("div",{className:e.formInputFlex,children:Object(V.jsxs)(b.a,{width:"100%",textAlign:"center",children:[Object(V.jsx)(y.a,{children:"Total a pagar:"}),Object(V.jsxs)(y.a,{variant:"h3",style:{color:"green"},children:["$",x]}),Object(V.jsx)(y.a,{variant:"caption",children:"(CIENTO CICUENTA PESOS 00/100 MNX)"})]})}),Object(V.jsxs)("div",{className:e.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"25%",textAlign:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/money.svg",alt:"icono ventas",className:e.iconSizeDialogsPequeno,onClick:function(){return J("EFECTIVO")},style:{cursor:"pointer"}})}),Object(V.jsx)(y.a,{variant:"caption",children:"Efectivo"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"efectivo",id:"form-producto-efectivo",variant:"outlined",value:"EFECTIVO"===_?N:"0.00",onChange:function(e){return G(e,"EFECTIVO")}})})]}),Object(V.jsxs)(b.a,{width:"25%",textAlign:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/tarjeta-de-credito.svg",alt:"icono ventas",className:e.iconSizeDialogsPequeno,onClick:function(){return J("TARJETA")},style:{cursor:"pointer"}})}),Object(V.jsx)(y.a,{variant:"caption",children:"Tarjeta"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",value:"TARJETA"===_?N:"0.00",onChange:function(e){return G(e,"TARJETA")}})})]}),Object(V.jsxs)(b.a,{width:"25%",textAlign:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(Ce.r,{style:{fontSize:50,cursor:"pointer"},onClick:function(){return J("PUNTOS")}})}),Object(V.jsx)(y.a,{variant:"caption",children:"Puntos"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",value:"PUNTOS"===_?N:"0.00",onChange:function(e){return G(e,"PUNTOS")}})})]}),Object(V.jsxs)(b.a,{width:"25%",textAlign:"center",children:[Object(V.jsx)(b.a,{p:0,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/transferencia-bancaria.svg",alt:"icono ventas",className:e.iconSizeDialogsPequeno,onClick:function(){return J("TRANSFERENCIA")},style:{cursor:"pointer"}})}),Object(V.jsx)(y.a,{variant:"caption",children:"Transferencia"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",value:"TRANSFERENCIA"===_?N:"0.00",onChange:function(e){return G(e,"TRANSFERENCIA")}})})]}),Object(V.jsxs)(b.a,{width:"25%",textAlign:"center",children:[Object(V.jsx)(b.a,{p:0,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/cheque.png",alt:"icono ventas",className:e.iconSizeDialogsPequeno,onClick:function(){return J("CHEQUE")},style:{cursor:"pointer"}})}),Object(V.jsx)(y.a,{variant:"caption",children:"Cheque"}),Object(V.jsx)(b.a,{display:"flex",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",value:"CHEQUE"===_?N:"0.00",onChange:function(e){return G(e,"CHEQUE")}})})]})]}),Object(V.jsxs)("div",{className:e.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"40%",children:[Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(b.a,{mt:.5,mr:.5,children:Object(V.jsx)(Ce.b,{style:{fontSize:19}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",children:Object(V.jsx)("b",{children:"Cliente:"})})})]}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsx)(y.a,{variant:"subtitle1",children:Object(V.jsx)("b",{style:{fontSize:16},children:W?W.nombre_cliente:"Sin cliente"})})})]}),Object(V.jsxs)(b.a,{width:"60%",children:[Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(b.a,{mt:.5,mr:.5,children:Object(V.jsx)(Ce.p,{style:{fontSize:19}})}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsx)(y.a,{variant:"caption",align:"center",children:Object(V.jsx)("b",{children:"Puntos Generados:"})})})]}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsxs)(y.a,{variant:"subtitle1",children:["$ ",L]})})]}),Object(V.jsxs)(b.a,{width:"60%",children:[Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",children:[Object(V.jsx)(b.a,{mt:.5,mr:.5,children:Object(V.jsx)(Ce.p,{style:{fontSize:19}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",children:Object(V.jsx)("b",{children:"Puntos Disponibles:"})})})]}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsx)(y.a,{variant:"subtitle1",children:"$ 800"})})]}),Object(V.jsxs)(b.a,{width:"100%",textAlign:"right",children:[Object(V.jsx)(y.a,{variant:"caption",children:Object(V.jsx)("b",{children:"Su cambio:"})}),Object(V.jsxs)(y.a,{variant:"h4",style:{color:"green"},children:["$ ",D]}),Object(V.jsx)(y.a,{variant:"caption",children:"(CIENTO CICUENTA PESOS 00/100 MNX)"})]})]}),Object(V.jsxs)(b.a,{display:"flex",children:[Object(V.jsx)(b.a,{width:"20%",children:Object(V.jsx)(w.a,{color:"primary",variant:"outlined",startIcon:Object(V.jsx)("img",{src:Kf,alt:"icono ventas",style:{width:30}}),children:"Venta a Credito"})}),Object(V.jsx)(b.a,{width:"50%",children:Object(V.jsx)(w.a,{color:"primary",variant:"outlined",startIcon:Object(V.jsx)("img",{src:Kf,alt:"icono ventas",style:{width:30}}),children:"Agregar Descuento"})})]}),Object(V.jsxs)("div",{className:e.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"20%",children:[Object(V.jsx)(y.a,{variant:"caption",children:Object(V.jsx)("b",{children:"Dias de Cr\xe9dito:"})}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined"})})]}),Object(V.jsxs)(b.a,{width:"20%",children:[Object(V.jsx)(y.a,{variant:"caption",children:Object(V.jsx)("b",{children:"L\xedmite de Cr\xe9dito:"})}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined"})})]}),Object(V.jsxs)(b.a,{width:"20%",children:[Object(V.jsx)(y.a,{variant:"caption",children:Object(V.jsx)("b",{children:"Cr\xe9dito Disponible:"})}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined"})})]}),Object(V.jsx)(b.a,{children:Object(V.jsx)(b.a,{width:"100%",mt:2.5,children:Object(V.jsx)(w.a,{color:"primary",variant:"outlined",size:"large",startIcon:Object(V.jsx)($a.a,{}),children:"Editar"})})})]}),Object(V.jsxs)("div",{className:e.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"20%",children:[Object(V.jsx)(y.a,{variant:"caption",children:Object(V.jsx)("b",{children:"Total a Cr\xe9dito:"})}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined"})})]}),Object(V.jsxs)(b.a,{width:"20%",children:[Object(V.jsx)(y.a,{variant:"caption",children:Object(V.jsx)("b",{children:"Dias de Cr\xe9dito:"})}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined"})})]}),Object(V.jsxs)(b.a,{width:"20%",children:[Object(V.jsx)(y.a,{variant:"caption",children:Object(V.jsx)("b",{children:"Fecha de Vencimiento:"})}),Object(V.jsx)(b.a,{display:"flex",alignItems:"center",children:Object(V.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",type:"date"})})]})]})]})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{size:"large",onClick:function(){r()},variant:"contained",color:"primary",autoFocus:!0,children:"Terminar"})})]}),Object(V.jsxs)(ze.a,{open:p,onClose:r,TransitionComponent:Qf,children:[Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(b.a,{textAlign:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(Ce.f,{style:{fontSize:80}})}),Object(V.jsx)(b.a,{textAlign:"center",children:Object(V.jsx)(y.a,{variant:"h5",children:"Su cambio"})})]}),Object(V.jsx)(Fe.a,{item:!0,lg:12,children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{p:3,width:"100%",textAlign:"center",children:[Object(V.jsx)(y.a,{variant:"h3",style:{color:"red"},children:"$150.000"}),Object(V.jsx)(y.a,{variant:"caption",children:"(CIENTO CICUENTA PESOS 00/100 MNX)"})]})})})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:B,variant:"contained",size:"large",color:"primary",autoFocus:!0,children:"Aceptar"})})]}),Object(V.jsxs)(ze.a,{open:n,onClose:r,TransitionComponent:Qf,children:[Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(b.a,{textAlign:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(Ce.f,{style:{fontSize:80}})}),Object(V.jsx)(b.a,{textAlign:"center",children:Object(V.jsx)(y.a,{variant:"h5",children:"Su cambio"})})]}),Object(V.jsx)(Fe.a,{item:!0,lg:12,children:Object(V.jsx)(Da.a,{elevation:3,children:Object(V.jsxs)(b.a,{p:3,width:"100%",textAlign:"center",children:[Object(V.jsx)(y.a,{variant:"h3",style:{color:"red"},children:"$150.000"}),Object(V.jsx)(y.a,{variant:"caption",children:"(CIENTO CICUENTA PESOS 00/100 MNX)"})]})})})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:B,variant:"contained",size:"large",color:"primary",autoFocus:!0,children:"Aceptar"})})]})]})}var eg=a(464),tg=a.n(eg),ag=a(468),ng=a.n(ag),cg=a(469),rg=a.n(cg),ig=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function og(){var e,t,a,n,c,r,i,o,l,d,j,u,p,m,O,x,h,f,C=JSON.parse(localStorage.getItem("sesionCafi")),S=Object(s.useState)(0),k=Object(v.a)(S,2),N=k[0],F=k[1],z=Object(ri.a)(Wf,{variables:{sucursal:C.sucursal._id,empresa:C.empresa._id},fetchPolicy:"network-only"}),P=Object(v.a)(z,2),D=P[0],E=P[1],A=E.data,T=E.loading,W=null;A&&(W=A.obtenerUnProductoVentas);var R=Object(s.useState)(!1),$=Object(v.a)(R,2),M=$[0],L=$[1],U=vh(),B=function(){L(!M),W=[]},J=function(){var e=Object(_.a)(g.a.mark((function e(t){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"Enter"!==t.code&&"NumpadEnter"!==t.code||(a=t.target.value,D({variables:{datosProductos:a,sucursal:C.sucursal._id,empresa:C.empresa._id},fetchPolicy:"network-only"}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();window.addEventListener("keydown",(function(e){120===e.keyCode&&B()}));return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{className:U.borderBotonChico,onClick:B,children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/precios.svg",alt:"icono ventas",style:{width:36}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Consultar Precio"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"F9"})})})]})}),Object(V.jsxs)(ze.a,{maxWidth:"md",fullWidth:!0,open:M,onClose:B,TransitionComponent:ig,children:[Object(V.jsxs)(Pe.a,{open:M,onClose:B,TransitionComponent:ig,children:[Object(V.jsxs)(Fe.a,{container:!0,item:!0,lg:12,children:[Object(V.jsxs)(b.a,{display:"flex",textAlign:"center",flexGrow:1,children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/productos.svg",alt:"icono productos",className:U.iconSizeDialogs})}),Object(V.jsx)(b.a,{m:2,children:Object(V.jsx)(Te.a,{orientation:"vertical"})}),Object(V.jsx)(b.a,{mt:3,children:Object(V.jsx)(y.a,{variant:"h6",children:"Precio Producto"})})]}),Object(V.jsx)(b.a,{displa:"flex",justifyContent:"center",children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:B,size:"large",children:Object(V.jsx)($e.a,{})})})]}),Object(V.jsx)("div",{className:U.formInputFlex,children:Object(V.jsx)(b.a,{width:"50%",children:Object(V.jsxs)(Da.a,{className:U.rootBusquedaProductos,children:[Object(V.jsx)(us.a,{fullWidth:!0,onKeyUp:J,placeholder:"Buscar producto..."}),Object(V.jsx)(X.a,{children:Object(V.jsx)(xc.a,{})})]})})}),T?Object(V.jsx)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsx)(V.Fragment,{children:Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,lg:6,md:6,children:(null===(e=W)||void 0===e||null===(t=e.id_producto)||void 0===t?void 0:t.imagenes.length)>0?Object(V.jsx)(b.a,{p:7,children:Object(V.jsx)(tg.a,{requestToChangeActive:F,activeItemIndex:N,numberOfCards:1,leftChevron:Object(V.jsx)(X.a,{"aria-label":"delete",disabled:!0,color:"primary",children:Object(V.jsx)(ng.a,{})}),rightChevron:Object(V.jsx)(X.a,{"aria-label":"delete",disabled:!0,color:"primary",children:Object(V.jsx)(rg.a,{})}),infiniteLoop:!0,outsideChevron:!0,chevronWidth:40,children:null===(a=W)||void 0===a||null===(n=a.id_producto)||void 0===n?void 0:n.imagenes.map((function(e){return Object(V.jsx)(b.a,{className:U.containerImagenesProducto,display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{alt:"Imagen producto",src:e.url_imagen,className:U.imagenProducto})})}))})}):Object(V.jsx)(b.a,{p:1,mt:15,display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(Pf.a,{style:{fontSize:40}})})}),Object(V.jsx)(Fe.a,{item:!0,lg:6,md:6,children:Object(V.jsxs)(Da.a,{elevation:3,className:U.rootPrecioProductos,children:[Object(V.jsx)("div",{className:U.formInputFlex,children:Object(V.jsx)(b.a,{width:"100%",textAlign:"center",children:Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:null===(c=W)||void 0===c?void 0:c.codigo_barras})})})}),Object(V.jsx)("div",{className:U.formInputFlex,children:Object(V.jsx)(b.a,{width:"100%",textAlign:"center",children:Object(V.jsx)(y.a,{variant:"h6",children:Object(V.jsx)("b",{children:null===(r=W)||void 0===r||null===(i=r.id_producto)||void 0===i?void 0:i.datos_generales.nombre_comercial})})})}),Object(V.jsx)("div",{className:U.formInputFlex,children:Object(V.jsxs)(b.a,{width:"100%",textAlign:"center",children:[Object(V.jsx)(y.a,{children:!0===(null===(o=W)||void 0===o?void 0:o.descuento_activo)?Object(V.jsx)("b",{children:"Precio Promoci\xf3n"}):null}),Object(V.jsx)(y.a,{variant:"h3",children:!0===(null===(l=W)||void 0===l?void 0:l.descuento_activo)?Object(V.jsxs)("b",{style:{color:"red"},children:["$",null===(d=W)||void 0===d||null===(j=d.descuento)||void 0===j?void 0:j.precio_con_descuento.toFixed(2)]}):Object(V.jsxs)("b",{style:{color:"green"},children:["$",null===(u=W)||void 0===u?void 0:u.precio]})})]})}),!0===(null===(p=W)||void 0===p?void 0:p.descuento_activo)?Object(V.jsx)("div",{className:U.formInputFlex,children:Object(V.jsxs)(b.a,{width:"100%",textAlign:"center",children:[Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:"Precio S/D"})}),Object(V.jsx)(y.a,{variant:"h5",style:{color:"green"},children:Object(V.jsxs)("b",{children:[" $",null===(m=W)||void 0===m?void 0:m.precio," "]})})]})}):null,Object(V.jsxs)("div",{className:U.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",textAlign:"center",children:[Object(V.jsx)(y.a,{children:"Unidad"}),Object(V.jsx)(y.a,{children:Object(V.jsx)("b",{children:null===(O=W)||void 0===O?void 0:O.unidad})})]}),Object(V.jsxs)(b.a,{width:"100%",textAlign:"center",children:[Object(V.jsx)(y.a,{children:"Existencia"}),Object(V.jsx)(y.a,{children:Object(V.jsxs)("b",{children:[" ",(null===(x=W)||void 0===x?void 0:x.inventario_general)?null===(h=W)||void 0===h||null===(f=h.inventario_general[0])||void 0===f?void 0:f.cantidad_existente:0]})})]})]})]})})]})})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:B,variant:"contained",color:"primary",size:"large",children:"Aceptar"})})]})]})}var sg=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function lg(){var e,t,a,n,c,r=vh(),i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)({}),p=Object(v.a)(j,2),m=p[0],O=p[1],x=Object(s.useContext)(Ch),h=x.productoCambioPrecio,f=x.precioSelectProductoVenta,C=x.setPrecioSelectProductoVenta,S=x.setUpdateTablaVentas,I=x.updateTablaVentas,k=Object(s.useState)(f.length>0?f[0]:{}),N=Object(v.a)(k,2),F=N[0],z=N[1],P=Object(s.useState)({message:"",status:"",open:!1}),D=Object(v.a)(P,2),E=D[0],A=D[1],T=function(){d(!l)};Object(s.useEffect)((function(){O(h)}),[h]);var W=function(){var e=Object(_.a)(g.a.mark((function e(){var t,a,n,c,r,i,o,s,l,d,j;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=JSON.parse(localStorage.getItem("DatosVentas")),a=null===t?[]:t.productos,n=null===t?[]:t,c=null===t?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:t,r=a,!(F.precio_neto>0||f.length>0)){e.next=34;break}return i=Object(u.a)({},h),o=Object(u.a)({},h),e.next=10,tt(h);case 10:if(!(s=e.sent).found){e.next=31;break}return e.next=14,nt({newP:i,cantidad:i.cantidad_venta,precio_boolean:!0,precio:i.precio_actual_object,granel:i.granel_producto,origen:""});case 14:return l=e.sent,e.next=17,nt({newP:o,cantidad:o.cantidad_venta,precio_boolean:!0,precio:f[0],granel:o.granel_producto,origen:"Tabla"});case 17:d=e.sent,o.precio_a_vender=f[0].precio_neto,o.precio_seleccionado=!0,o.precio_actual_producto=parseFloat(f[0].precio_neto.toFixed(2)),o.precio_actual_object=f[0],r.splice(s.producto_found.index,1,o),j={subTotal:parseFloat(c.subTotal)-parseFloat(l.subtotalCalculo)+d.subtotalCalculo,total:parseFloat(c.total)-parseFloat(l.totalCalculo)+d.totalCalculo,impuestos:parseFloat(c.impuestos)-parseFloat(l.impuestoCalculo)+d.impuestoCalculo,iva:parseFloat(c.iva)-parseFloat(l.ivaCalculo)+d.ivaCalculo,ieps:parseFloat(c.ieps)-parseFloat(l.iepsCalculo)+d.iepsCalculo,descuento:parseFloat(c.descuento)-parseFloat(l.descuentoCalculo)+d.descuentoCalculo,monedero:parseFloat(c.monedero)-parseFloat(l.monederoCalculo)+d.monederoCalculo},localStorage.setItem("DatosVentas",JSON.stringify(Object(u.a)(Object(u.a)({},j),{},{cliente:!0===n.venta_cliente?n.cliente:{},venta_cliente:!0===n.venta_cliente&&n.venta_cliente,productos:r}))),S(!I),C([]),O({}),T(),e.next=32;break;case 31:console.log("Producto no encontrado");case 32:e.next=35;break;case 34:A({message:"Este precio no es valido.",status:"error",open:!0});case 35:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(e){var t=[];t=t.concat([],e),z(e),C(t)};return window.addEventListener("keydown",(function(e){114===e.keyCode&&T()})),Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(B,{alert:E,setAlert:A}),Object(V.jsx)(w.a,{className:r.borderBotonChico,onClick:T,children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/money.svg",alt:"icono money",style:{fontSize:25}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Precios"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"F3"})})})]})}),Object(V.jsxs)(ze.a,{maxWidth:"lg",open:l,onClose:T,TransitionComponent:sg,children:[Object(V.jsxs)(Pe.a,{children:[Object(V.jsx)(Fe.a,{container:!0,item:!0,lg:12,children:Object(V.jsxs)(b.a,{display:"flex",justifyContent:"center",children:[Object(V.jsx)(b.a,{mt:3,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/money.svg",alt:"icono caja",className:r.iconSizeDialogs})}),Object(V.jsx)(b.a,{m:2,children:Object(V.jsx)(Te.a,{orientation:"vertical"})}),Object(V.jsxs)(b.a,{children:[Object(V.jsx)(b.a,{textAlign:"right",mb:1,children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:T,size:"medium",children:Object(V.jsx)($e.a,{})})}),Object(V.jsx)(b.a,{mt:2,children:Object(V.jsx)(y.a,{variant:"h6",children:"Precios de Producto"})})]})]})}),Object(V.jsxs)(Fe.a,{children:[Object(V.jsx)("div",{className:r.formInputFlex,children:Object(V.jsx)(b.a,{width:"100%",children:Object(V.jsxs)(y.a,{children:["Nombre:"," ",h?null===h||void 0===h||null===(e=h.id_producto)||void 0===e||null===(t=e.datos_generales)||void 0===t?void 0:t.nombre_comercial:""]})})}),Object(V.jsx)(Da.a,{className:r.root,children:Object(V.jsx)(ra.a,{className:r.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{style:{width:25}}),Object(V.jsx)(sa.a,{style:{width:20},children:"Precio"}),Object(V.jsx)(sa.a,{style:{width:20},children:"Precio neto"}),Object(V.jsx)(sa.a,{style:{width:200},children:"Unidad mayoreo"}),Object(V.jsx)(sa.a,{style:{width:100},children:"Utilidad"})]})}),Object(V.jsx)(la.a,{children:null===m||void 0===m||null===(a=m.id_producto)||void 0===a||null===(n=a.precios)||void 0===n||null===(c=n.precios_producto)||void 0===c?void 0:c.map((function(e,t){var a,n=(a=e,-1!==f.indexOf(a)),c="enhanced-table-checkbox-".concat(t);return Object(V.jsx)(dg,{precio:e,isItemSelected:n,labelId:c,handleClick:R},t)}))})]})})})]})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:function(){return W()},variant:"contained",color:"primary",size:"large",children:"Aceptar"})})]})]})}var dg=function(e){var t=e.precio,a=e.isItemSelected,n=e.labelId,c=e.handleClick;return Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(oa.a,{role:"checkbox","aria-checked":a,tabIndex:-1,selected:a,hover:!0,onClick:function(e){return function(e){try{2===e.detail&&c(t)}catch(a){console.log(a)}}(e)},children:[Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(na.a,{onClick:function(e){c(t)},checked:a,inputProps:{"aria-labelledby":n}})}),Object(V.jsx)(sa.a,{align:"center",children:t.numero_precio}),Object(V.jsx)(sa.a,{align:"center",children:t.precio_neto>0?t.precio_neto.toFixed(2):0}),Object(V.jsx)(sa.a,{align:"center",children:t.unidad_mayoreo}),Object(V.jsxs)(sa.a,{align:"center",children:[t.utilidad," %"]})]},t.numero_precio)})},jg=a(470),ug=a.n(jg),bg=[{id:"folio",label:"Folio",minWidth:20,align:"center"},{id:"fecha",label:"Fecha",minWidth:20,align:"center"},{id:"cliente",label:"Cliente",minWidth:330,align:"center"},{id:"productos",label:"Productos",minWidth:20,align:"center"},{id:"total",label:"Total",minWidth:200,align:"center"}],pg=Object(k.a)({root:{width:"100%"},container:{height:"45vh","& ::-webkit-scrollbar":{display:"none"}}});function mg(){var e=pg(),t=JSON.parse(localStorage.getItem("ListaEnEspera"));return Object(V.jsx)(Da.a,{className:e.root,children:Object(V.jsx)(ra.a,{className:e.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[bg.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{width:e.minWidth},children:e.label},e.id)})),Object(V.jsx)(sa.a,{align:"center",style:{width:35},children:"Regresar"}),Object(V.jsx)(sa.a,{align:"center",style:{width:35},children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:null===t||void 0===t?void 0:t.map((function(e,t){return Object(V.jsx)(Og,{venta:e,index:t})}))})]})})})}var Og=function(e){var t=e.venta,a=e.index,n=Object(s.useContext)(Ch),c=n.updateTablaVentas,r=n.setUpdateTablaVentas,i=Object(s.useState)(!1),o=Object(v.a)(i,2),l=o[0],d=o[1],j=JSON.parse(localStorage.getItem("sesionCafi")),u=JSON.parse(localStorage.getItem("ListaEnEspera")),p=JSON.parse(localStorage.getItem("DatosVentas"));var m=function(){d(!l)};return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(oa.a,{hover:!0,tabIndex:-1,children:[Object(V.jsx)(sa.a,{align:"center",children:a+1}),Object(V.jsx)(sa.a,{align:"center",children:t.fecha?t.fecha:""}),Object(V.jsx)(sa.a,{align:"center",children:t.VentaEnEspera.cliente?t.VentaEnEspera.cliente.nombre_cliente:"Pub. General"}),Object(V.jsx)(sa.a,{align:"center",children:t.VentaEnEspera.productos.length}),Object(V.jsxs)(sa.a,{align:"center",children:["$ ",t.VentaEnEspera.total.toFixed(4)]}),Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)(X.a,{"aria-label":"regresar",color:"primary",size:"small",onClick:function(){return e=a,void(null===p?(u.forEach((function(t,a){a===e&&(localStorage.setItem("DatosVentas",JSON.stringify(t.VentaEnEspera)),u.splice(e,1)),localStorage.setItem("ListaEnEspera",JSON.stringify(u))})),r(!c)):d(!l));var e},children:Object(V.jsx)(ug.a,{fontSize:"medium"})})}),Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)(X.a,{"aria-label":"delete",size:"small",onClick:function(){return function(e){if(!0!==j.accesos.ventas.eliminar_ventas.ver)return null;u.forEach((function(t,a,n){e===a&&u.splice(e,1)})),r(!c),localStorage.setItem("ListaEnEspera",JSON.stringify(u))}(a)},children:Object(V.jsx)(Wu.a,{fontSize:"medium"})})})]},a),Object(V.jsxs)(ze.a,{open:l,onClose:m,children:[Object(V.jsx)(Pe.a,{children:Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(y.a,{variant:"h6",children:"No puedes agregar una venta, cuando ya esta una en curso."})})}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{color:"primary",size:"large",variant:"contained",onClick:m,children:"Aceptar"})})]})]})},xg=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function hg(){var e=JSON.parse(localStorage.getItem("ListaEnEspera")),t=vh(),a=Object(s.useState)(!1),n=Object(v.a)(a,2),c=n[0],r=n[1],i=function(){r(!c)};return window.addEventListener("keydown",(function(e){e.altKey&&76===e.keyCode&&i()})),Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{className:t.borderBotonChico,onClick:i,children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(uc.a,{badgeContent:e?e.length:0,color:"primary",style:{fontSize:45},children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/lista-de-espera.svg",alt:"icono caja2",style:{width:38}})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Ventas en Espera"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"Alt + L"})})})]})}),Object(V.jsxs)(ze.a,{maxWidth:"lg",open:c,onClose:i,TransitionComponent:xg,children:[Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(Fe.a,{container:!0,item:!0,lg:12,children:[Object(V.jsxs)(b.a,{display:"flex",flexGrow:1,children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/lista-de-espera.svg",alt:"icono caja",className:t.iconSizeDialogs})}),Object(V.jsx)(b.a,{m:2,children:Object(V.jsx)(Te.a,{orientation:"vertical"})}),Object(V.jsx)(b.a,{mt:3,children:Object(V.jsx)(y.a,{variant:"h6",children:"Ventas en espera"})})]}),Object(V.jsx)(b.a,{children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:i,size:"large",children:Object(V.jsx)($e.a,{})})})]}),Object(V.jsx)(Fe.a,{children:Object(V.jsx)(mg,{})})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:i,variant:"contained",color:"primary",size:"large",children:"Aceptar"})})]})]})}var fg=[{id:"folio",label:"Folio",minWidth:20,align:"center"},{id:"cliente",label:"Cliente",minWidth:330},{id:"fecha",label:"Fecha.",minWidth:100,align:"center"},{id:"total",label:"Total",minWidth:100,align:"center"}];function gg(e,t,a,n){return{folio:e,cliente:t,fecha:a,total:n}}var _g=[gg(2,"Jabon",50,10),gg(2,"Jabon",50,10),gg(2,"Jabon",50,10),gg(2,"Jabon",50,10),gg(2,"Jabon",50,10),gg(2,"Jabon",50,10),gg(2,"Jabon",50,10),gg(2,"Jabon",50,10),gg(2,"Jabon",50,10),gg(2,"Jabon",50,10),gg(2,"Jabon",50,10),gg(2,"Jabon",50,10),gg(2,"Jabon",50,10),gg(2,"Jabon",50,10)],vg=Object(k.a)({root:{width:"100%"},container:{maxHeight:"50vh"}});function Cg(){var e=vg(),t=l.a.useState(0),a=Object(v.a)(t,2),n=a[0],c=a[1],r=l.a.useState(8),i=Object(v.a)(r,2),o=i[0],s=i[1];return Object(V.jsxs)(Da.a,{className:e.root,children:[Object(V.jsx)(ra.a,{className:e.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[fg.map((function(e){return Object(V.jsx)(sa.a,{align:e.align,style:{width:e.minWidth},children:e.label},e.id)})),Object(V.jsx)(sa.a,{align:"center",style:{width:35},children:"Eliminar"})]})}),Object(V.jsx)(la.a,{children:_g.slice(n*o,n*o+o).map((function(e){return Object(V.jsxs)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[fg.map((function(t){var a=e[t.id];return Object(V.jsx)(sa.a,{align:t.align,children:t.format&&"number"===typeof a?t.format(a):a},t.id)})),Object(V.jsx)(sa.a,{align:"center",children:Object(V.jsx)(X.a,{"aria-label":"delete",size:"small",children:Object(V.jsx)(Wu.a,{fontSize:"small"})})})]},e.code)}))})]})}),Object(V.jsx)(ll.a,{rowsPerPageOptions:[10,25,100],component:"div",count:_g.length,rowsPerPage:o,page:n,onChangePage:function(e,t){c(t)},onChangeRowsPerPage:function(e){s(+e.target.value),c(0)}})]})}var yg=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Sg(){var e=vh(),t=Object(s.useState)(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!n)};return window.addEventListener("keydown",(function(e){e.altKey&&86===e.keyCode&&r()})),Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(w.a,{className:e.borderBotonChico,onClick:r,children:Object(V.jsxs)(b.a,{children:[Object(V.jsx)(b.a,{children:Object(V.jsx)(Ce.q,{style:{fontSize:45}})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"body2",children:Object(V.jsx)("b",{children:"Buscar Folio"})})}),Object(V.jsx)(b.a,{children:Object(V.jsx)(y.a,{variant:"caption",style:{color:"#808080"},children:Object(V.jsx)("b",{children:"Alt + V"})})})]})}),Object(V.jsxs)(ze.a,{maxWidth:"lg",open:n,onClose:r,TransitionComponent:yg,children:[Object(V.jsxs)(Pe.a,{children:[Object(V.jsxs)(Fe.a,{container:!0,item:!0,lg:12,children:[Object(V.jsxs)(b.a,{display:"flex",flexGrow:1,children:[Object(V.jsx)(b.a,{children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/lista-de-espera.svg",alt:"icono caja",className:e.iconSizeDialogs})}),Object(V.jsx)(b.a,{m:2,children:Object(V.jsx)(Te.a,{orientation:"vertical"})}),Object(V.jsx)(b.a,{mt:3,children:Object(V.jsx)(y.a,{variant:"h6",children:"Ventas Realizadas"})})]}),Object(V.jsx)(b.a,{children:Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{})})})]}),Object(V.jsxs)(Fe.a,{children:[Object(V.jsx)("div",{className:e.formInputFlex,children:Object(V.jsx)(b.a,{width:"100%",children:Object(V.jsxs)(Da.a,{className:e.rootBusqueda,children:[Object(V.jsx)(us.a,{fullWidth:!0,placeholder:"Buscar venta..."}),Object(V.jsx)(X.a,{children:Object(V.jsx)(xc.a,{})})]})})}),Object(V.jsx)(Cg,{})]})]}),Object(V.jsx)(We.a,{children:Object(V.jsx)(w.a,{onClick:r,variant:"contained",color:"primary",size:"large",children:"Aceptar"})})]})]})}function wg(){var e=gh();return Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(Fe.a,{container:!0,className:e.drawerColor,children:[Object(V.jsx)(Fe.a,{item:!0,lg:6,md:6,xs:6,children:Object(V.jsx)(Zf,{})}),Object(V.jsx)(Fe.a,{item:!0,lg:6,md:6,xs:6,children:Object(V.jsx)(Uf,{})}),Object(V.jsx)(Fe.a,{item:!0,lg:6,md:6,xs:6,children:Object(V.jsx)(Xf,{})}),Object(V.jsx)(Fe.a,{item:!0,lg:6,md:6,xs:6,children:Object(V.jsx)(Hf,{})}),Object(V.jsx)(Fe.a,{item:!0,lg:6,md:6,xs:6,children:Object(V.jsx)(lg,{})}),Object(V.jsx)(Fe.a,{item:!0,lg:6,md:6,xs:6,children:Object(V.jsx)(hg,{})}),Object(V.jsx)(Fe.a,{item:!0,lg:6,md:6,xs:6,children:Object(V.jsx)(Gf,{})}),Object(V.jsx)(Fe.a,{item:!0,lg:6,md:6,xs:6,children:Object(V.jsx)(Sg,{})}),Object(V.jsx)(Fe.a,{item:!0,lg:6,md:6,xs:6,children:Object(V.jsx)(og,{})}),Object(V.jsx)(Fe.a,{item:!0,lg:6,md:6,xs:6,children:Object(V.jsx)(wf,{})})]})})}var Ig=a(472),kg=(a(471),["cantidad_venta"]),Ng=Object(s.forwardRef)((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Fg(e){var t=e.producto,a=(e.setNewProductoVentas,e.newProductoVentas,e.setDatosVentasActual),n=Object(s.useState)(!1),c=Object(v.a)(n,2),r=c[0],i=c[1],o=Object(s.useState)(!1),l=Object(v.a)(o,2),d=l[0],j=(l[1],Object(s.useContext)(Ch)),b=j.updateTablaVentas,p=j.setUpdateTablaVentas,m=function(){return i(!r)},O=function(){var e=Object(_.a)(g.a.mark((function e(){var n,c,r,i,o,s,l,d,j,m;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.parse(localStorage.getItem("DatosVentas")),c=null===n?[]:n.productos,r=null===n?[]:n,i=c,o=null===n?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:n,e.next=7,tt(c,t);case 7:if(!(s=e.sent).found){e.next=18;break}return l=t.cantidad_venta,d=Object(fe.a)(t,kg),e.next=12,at(d,l,d.granel_producto,d.precio_actual_producto);case 12:j=e.sent,i.splice(s.producto_found.index,1),m={subTotal:parseFloat(o.subTotal)-parseFloat(j.subtotalCalculo),total:parseFloat(o.total)-parseFloat(j.totalCalculo),impuestos:parseFloat(o.impuestos)-parseFloat(j.impuestoCalculo),iva:parseFloat(o.iva)-parseFloat(j.ivaCalculo),ieps:parseFloat(o.ieps)-parseFloat(j.iepsCalculo),descuento:parseFloat(o.descuento)-parseFloat(j.descuentoCalculo),monedero:parseFloat(o.monedero)-parseFloat(j.monederoCalculo)},localStorage.setItem("DatosVentas",JSON.stringify(Object(u.a)(Object(u.a)({},m),{},{cliente:!0===r.venta_cliente?r.cliente:{},venta_cliente:!0===r.venta_cliente&&r.venta_cliente,productos:i}))),a(m),p(!b);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(X.a,{size:"small",onClick:function(){return m()},children:Object(V.jsx)(ur.a,{size:"small",color:"error"})}),Object(V.jsxs)(ze.a,{open:r,TransitionComponent:Ng,keepMounted:!0,onClose:function(){return m()},"aria-labelledby":"alert-dialog-delete-producto",children:[Object(V.jsx)(wt.a,{id:"alert-dialog-delete-producto",children:"\xbfEst\xe1s seguro de eliminar este producto?"}),Object(V.jsxs)(We.a,{style:{display:"flex",justifyContent:"center"},children:[Object(V.jsx)(w.a,{onClick:function(){return m()},color:"inherit",children:"Cancelar"}),Object(V.jsx)(w.a,{onClick:function(){return O()},color:"secondary",startIcon:d?Object(V.jsx)(I.a,{color:"inherit",size:20}):null,children:"Eliminar"})]})]})]})}var zg=["cantidad_venta"];Object(k.a)((function(e){return{root:{paddingLeft:e.spacing(2),paddingRight:e.spacing(1)},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(cj.f)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},title:{flex:"1 1 100%"}}}));var Pg=Object(k.a)((function(e){return{root:{width:"100%",marginTop:7},paper:{width:"100%",marginBottom:e.spacing(2)},container:{height:"100%","& ::-webkit-scrollbar":{display:"none"}},table:{minWidth:750,height:"55vh"},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function Dg(e){var t=e.setDatosVentasActual,a=Pg(),n=Object(s.useState)([]),c=Object(v.a)(n,2),r=c[0],i=c[1],o=(JSON.parse(localStorage.getItem("sesionCafi")),Object(s.useContext)(Ch)),l=o.setProductoCambioPrecio,d=o.setPrecioSelectProductoVenta,j=o.updateTablaVentas,u=o.setUpdateTablaVentas,b=Object(s.useState)([]),p=Object(v.a)(b,2),m=p[0],O=p[1];Object(s.useEffect)((function(){var e=JSON.parse(localStorage.getItem("DatosVentas"));O(null===e?[]:e.productos)}),[j]);var x=function(e){var t=[];t=-1!==r.indexOf(e)?[]:t.concat([],e);var a=e.id_producto.precios.precios_producto.filter((function(t){return t.precio_neto===e.precio_actual_producto}));a.length>0&&d(a),l(e),i(t)},h=function(e,t){try{clearTimeout(undefined),2===e.detail&&(x(t),l(t))}catch(a){console.log(a)}};return Object(V.jsx)("div",{className:a.root,children:Object(V.jsx)(Da.a,{children:Object(V.jsx)(ra.a,{className:a.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-labelledby":"tableTitle","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsxs)(oa.a,{children:[Object(V.jsx)(sa.a,{style:{width:25,textAlign:"center"}}),Object(V.jsx)(sa.a,{style:{width:20,textAlign:"center"},children:"Cantidad"}),Object(V.jsx)(sa.a,{style:{width:340},children:"Descripcion"}),Object(V.jsx)(sa.a,{style:{width:40,textAlign:"center"},children:"Exis."}),Object(V.jsx)(sa.a,{style:{width:50,textAlign:"center"},children:Object(V.jsx)("b",{children:"% Desct."})}),Object(V.jsx)(sa.a,{style:{width:40,textAlign:"center"},children:"Rx."}),Object(V.jsx)(sa.a,{style:{width:50,textAlign:"center"},children:"U. Venta"}),Object(V.jsx)(sa.a,{style:{width:100,textAlign:"center"},children:"Precio U"}),Object(V.jsx)(sa.a,{align:"center",style:{width:10}})]})}),Object(V.jsx)(la.a,{children:null===m||void 0===m?void 0:m.map((function(e,a){var n,c=(n=e,-1!==r.indexOf(n)),o="enhanced-table-checkbox-".concat(a);return Object(V.jsx)(Eg,{producto:e,setUpdateTablaVentas:u,updateTablaVentas:j,setDatosVentasActual:t,isItemSelected:c,labelId:o,handleClick:x,selected:r,TwoClickInRowTableBuy:h,setSelected:i},a)}))})]})})})})}var Eg=function(e){var t=e.producto,a=e.setUpdateTablaVentas,n=e.updateTablaVentas,c=e.setDatosVentasActual,r=e.TwoClickInRowTableBuy,i=e.handleClick,o=e.isItemSelected,l=e.labelId,d=e.setSelected,j=e.selected,b=Object(s.useState)(t.cantidad_venta),p=Object(v.a)(b,2),m=p[0],O=p[1],x=Object(s.useState)(t.cantidad_venta),h=Object(v.a)(x,2),f=h[0],C=h[1],y=Object(s.useRef)(null),S=Object(ps.a)(m,500),w=Object(v.a)(S,1)[0];Object(s.useEffect)((function(){C(t.cantidad_venta)}),[t.cantidad_venta]),Object(s.useEffect)((function(){I(w)}),[w]);var I=function(){var e=Object(_.a)(g.a.mark((function e(r){var i,o,s,l,d,j,b,p,m,O,x,h,f,_;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==r&&0!=r){e.next=4;break}C(t.cantidad_venta),e.next=35;break;case 4:return i=JSON.parse(localStorage.getItem("DatosVentas")),o=null===i?[]:i.productos,s=null===i?[]:i,l=o,d=null===i?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:i,j={},e.next=12,tt(t);case 12:if(!(b=e.sent).found){e.next=31;break}return p=b.producto_found.producto,m=p.cantidad_venta,(O=Object(fe.a)(p,zg)).cantidad_venta=r,e.next=18,ct(O);case 18:return x=e.sent,h=x.found?x.object_prising:O.precio_actual_object,e.next=22,nt({newP:O,cantidad:m,precio_boolean:!0,precio:O.precio_actual_object,granel:O.granel_producto,origen:"Tabla"});case 22:return f=e.sent,e.next=25,nt({newP:O,cantidad:r,precio_boolean:!0,precio:h,granel:O.granel_producto,origen:"Tabla"});case 25:_=e.sent,x.found?(O.precio_a_vender=_.totalCalculo,O.precio_anterior=O.precio_actual_porducto,O.precio_actual_producto=x.pricing,O.precio_actual_object=x.object_prising):(O.cantidad_venta=parseInt(r),O.precio_anterior=O.precio_actual_producto,O.precio_a_vender=_.totalCalculo),l.splice(b.producto_found.index,1,O),j={subTotal:parseFloat(d.subTotal)-parseFloat(f.subtotalCalculo)+_.subtotalCalculo,total:parseFloat(d.total)-parseFloat(f.totalCalculo)+_.totalCalculo,impuestos:parseFloat(d.impuestos)-parseFloat(f.impuestoCalculo)+_.impuestoCalculo,iva:parseFloat(d.iva)-parseFloat(f.ivaCalculo)+_.ivaCalculo,ieps:parseFloat(d.ieps)-parseFloat(f.iepsCalculo)+_.iepsCalculo,descuento:parseFloat(d.descuento)-parseFloat(f.descuentoCalculo)+_.descuentoCalculo,monedero:parseFloat(d.monedero)-parseFloat(f.monederoCalculo)+_.monederoCalculo},e.next=32;break;case 31:console.log("El producto no existe");case 32:localStorage.setItem("DatosVentas",JSON.stringify(Object(u.a)(Object(u.a)({},j),{},{cliente:!0===s.venta_cliente?s.cliente:{},venta_cliente:!0===s.venta_cliente&&s.venta_cliente,productos:l}))),c(j),a(!n);case 35:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(V.jsx)(s.Fragment,{children:Object(V.jsxs)(oa.a,{role:"checkbox",style:{height:"15px"},"aria-checked":o,tabIndex:-1,selected:o,hover:!0,onClick:function(e){return r(e,t)},children:[Object(V.jsx)(sa.a,{padding:"checkbox",children:Object(V.jsx)(na.a,{onClick:function(e){j.length>0&&d([]),i(t)},checked:o,inputProps:{"aria-labelledby":l}})}),Object(V.jsx)(sa.a,{children:Object(V.jsx)(Pa.a,{inputRef:y,onChange:function(e){return function(e){try{C(e),O(e)}catch(t){return!1}}(e.target.value)},value:f,type:"number",name:"cantidad_venta"})}),Object(V.jsx)(sa.a,{children:t.id_producto.datos_generales.nombre_comercial}),Object(V.jsx)(sa.a,{style:{textAlign:"center"},children:"medida"===t.concepto?t.cantidad:t.inventario_general.map((function(e){return"".concat(e.cantidad_existente)}))}),Object(V.jsxs)(sa.a,{style:{textAlign:"center"},children:["%"," ",!0===t.descuento_activo?t.descuento.porciento:0]}),Object(V.jsx)(sa.a,{style:{textAlign:"center"},children:!0===t.id_producto.datos_generales.receta_farmacia?"Si":"No"}),Object(V.jsx)(sa.a,{style:{textAlign:"center"},children:t.inventario_general.map((function(e){return"".concat(e.unidad_inventario)}))}),Object(V.jsxs)(sa.a,{style:{textAlign:"center"},children:["$ ",t.precio_actual_producto]}),Object(V.jsx)(sa.a,{style:{textAlign:"center"},children:Object(V.jsx)(Fg,{producto:t,setDatosVentasActual:c})})]},t._id)})};function Ag(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(s.useContext)(di),a=t.setUpdateClientVenta,n=t.updateClientVenta,c=Object(s.useContext)(Ch).setClientesVentas,r=Object(s.useState)({}),i=Object(v.a)(r,2),o=i[0],l=i[1],d=Object(He.a)($f,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id},fetchPolicy:"network-only"}),j=d.loading,b=d.data,p=(d.error,d.refetch),m=[];b&&(m=b.obtenerClientesVentas),Object(s.useEffect)((function(){!function(){var e=JSON.parse(localStorage.getItem("DatosVentas"));null!==e&&(l(e.cliente),c(e.cliente),p())}()}),[p,n]);return j?null:Object(V.jsx)("div",{children:Object(V.jsx)(ta.a,{id:"combo-box-producto-codigo",size:"small",fullWidth:!0,options:m,getOptionLabel:function(e){return e.nombre_cliente?e.nombre_cliente:"N/A"},renderInput:function(e){return Object(V.jsx)(S.a,Object(u.a)(Object(u.a)({},e),{},{variant:"outlined"}))},onChange:function(e,t){return function(e){try{var t,c=JSON.parse(localStorage.getItem("DatosVentas")),r=null===c?{}:c;l(e);var i={subTotal:void 0===r.subTotal?0:r.subTotal,total:void 0===r.total?0:r.total,impuestos:void 0===r.impuestos?0:r.impuestos,iva:void 0===r.iva?0:r.iva,ieps:void 0===r.ieps?0:r.ieps,descuento:void 0===r.descuento?0:r.descuento,monedero:void 0===r.monedero?0:r.monedero,tipo_cambio:r.tipo_cambio?r.tipo_cambio:{},venta_cliente:null!==e,productos:(null===(t=r.productos)||void 0===t?void 0:t.length)>0?r.productos:[]};null!==e&&(i=Object(u.a)(Object(u.a)({},i),{},{cliente:e})),localStorage.setItem("DatosVentas",JSON.stringify(i)),a(!n)}catch(o){console.log(o)}}(t)},getOptionSelected:function(e){return e.nombre_cliente},value:o||null})})}var Tg=a.p+"static/media/peso.1c192c88.svg",Wg=[{id:"icono",label:"Icono",minWidth:50},{id:"moneda",label:"Moneda",minWidth:50},{id:"descripcion",label:"Descripcion",minWidth:190},{id:"cambio",label:"Cambio",minWidth:20}];function Rg(e,t,a){return{moneda:e,descripcion:t,cambio:a}}var $g=[Rg(2,"Pesos Mex.",18.9),Rg(2,"Dolar E.U.",18.9),Rg(2,"Dolar Canadiense",18.9),Rg(2,"Euro",18.9)],Mg=Object(k.a)((function(e){return{root:{flexGrow:1,width:"100%",height:"30vh",backgroundColor:e.palette.background.paper},appBar:{position:"relative"},title:{marginLeft:e.spacing(1),flex:1},iconSvg:{width:100},iconSize:{width:28},rootBusqueda:{height:35,display:"flex"}}})),Lg=l.a.forwardRef((function(e,t){return Object(V.jsx)(Ae.a,Object(u.a)({direction:"up",ref:t},e))}));function Vg(){var e=Mg(),t=Object(s.useState)(!1),a=Object(v.a)(t,2),n=a[0],c=a[1],r=function(){c(!n)};return Object(V.jsxs)("div",{children:[Object(V.jsxs)(b.a,{width:"100%",display:"flex",justifyItems:"center",alignSelf:"center",justifySelf:"center",alignItems:"center",children:[Object(V.jsx)(b.a,{mt:1,children:Object(V.jsx)("img",{src:Tg,alt:"iconoBander",className:e.iconSize})}),Object(V.jsx)(b.a,{width:"100%",ml:1,onClick:function(){return r()},children:Object(V.jsx)(Da.a,{width:"100%",children:Object(V.jsx)(us.a,{className:e.rootBusqueda})})})]}),Object(V.jsxs)(ze.a,{open:n,onClose:r,TransitionComponent:Lg,children:[Object(V.jsx)(Se.a,{className:e.appBar,children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(y.a,{variant:"h6",className:e.title,children:"Tipo de Moneda"}),Object(V.jsx)(w.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(V.jsx)($e.a,{})})]})}),Object(V.jsx)("div",{className:e.root,children:Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(ra.a,{className:e.container,children:Object(V.jsxs)(da.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(V.jsx)(ia.a,{children:Object(V.jsx)(oa.a,{children:Wg.map((function(e,t){return Object(V.jsx)(sa.a,{style:{minWidth:e.minWidth},children:e.label},t)}))})}),Object(V.jsx)(la.a,{children:$g.map((function(e,t){return Object(V.jsx)(oa.a,{hover:!0,role:"checkbox",tabIndex:-1,children:Wg.map((function(t,a){var n=e[t.id];return Object(V.jsx)(sa.a,{align:t.align,children:t.format&&"number"===typeof n?t.format(n):n},a)}))},t)}))})]})})})})]})]})}var Ug=["cantidad_venta"];function Bg(){var e,t,a,n,c=JSON.parse(localStorage.getItem("sesionCafi")),r=vh(),i=Object(s.useState)({granel:!1,valor:0}),o=Object(v.a)(i,2),l=o[0],d=o[1],j=Object(s.useContext)(Ch),p=j.updateTablaVentas,m=j.setUpdateTablaVentas,O=j.setOpen,x=j.clientesVentas,h=Object(s.useState)({subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0,tipo_cambio:{}}),f=Object(v.a)(h,2),C=f[0],S=f[1],w=Object(s.useState)({message:"",status:"",open:!1}),I=Object(v.a)(w,2),k=I[0],N=I[1],F=Object(ri.a)(Wf,{fetchPolicy:"network-only"}),z=Object(v.a)(F,2),P=z[0],D=z[1],E=D.data,A=D.loading,T=D.error,W=Object(s.useState)(!1),R=Object(v.a)(W,2),$=R[0],M=R[1],L=null;T&&(console.log(E,A,T.networkError),console.log(E,A,T.graphQLErrors)),E&&(L=E.obtenerUnProductoVentas),Object(s.useEffect)((function(){if(T){if(T.networkError)N({message:"Error de servidor",status:"error",open:!0});else if(T.graphQLErrors){var e;N({message:"".concat(null===(e=T.graphQLErrors[0])||void 0===e?void 0:e.message),status:"error",open:!0})}}else null!==L&&(null!==L.cantidad?J(L):(O(!0),N({message:"Este producto no existe",status:"error",open:!0})))}),[A]),Object(s.useEffect)((function(){d({granel:!1,valor:0});var e=JSON.parse(localStorage.getItem("DatosVentas"));null!==e&&S({subTotal:parseFloat(e.subTotal),total:parseFloat(e.total),impuestos:parseFloat(e.impuestos),iva:parseFloat(e.iva),ieps:parseFloat(e.ieps),descuento:parseFloat(e.descuento),monedero:parseFloat(e.monedero)})}),[p]);var U=function(){var e=Object(_.a)(g.a.mark((function e(t){var a,n,r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"Enter"!==t.code&&"NumpadEnter"!==t.code||(a=t.target.value.trim(),(n=a.split("*")).length>1?(r=isNaN(n[0])?n[1]:n[0],i=isNaN(n[0])?n[0]:n[1],d({granel:!0,valor:r}),P({variables:{datosProductos:i,sucursal:c.sucursal._id,empresa:c.empresa._id},fetchPolicy:"network-only"}),M(!$)):(d({granel:!1,valor:0}),P({variables:{datosProductos:a,sucursal:c.sucursal._id,empresa:c.empresa._id},fetchPolicy:"network-only"}),M(!$)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(_.a)(g.a.mark((function e(t){var a,n,c,r,i,o,s,d,j,b,O,x,h,f,_,v,C,y;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.parse(localStorage.getItem("DatosVentas")),n=null===a?[]:a.productos,c=null===a?[]:a,r=null===a?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:a,i=n,o={subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0},e.next=8,tt(t);case 8:if((s=e.sent).found||!t._id){e.next=22;break}return d=Object(u.a)({},t),j=d.descuento_activo?d.descuento.precio_neto:d.precio_unidad.precio_neto,e.next=14,nt({newP:d,cantidad:0,granel:l,origen:"Ventas1",precio_boolean:!1});case 14:(b=e.sent).newP.precio_anterior=j,b.newP.iva_total_producto=parseFloat(b.iva),console.log(b.newP),i.push(b.newP),o={subTotal:parseFloat(r.subTotal)+parseFloat(b.subtotalCalculo),total:parseFloat(r.total)+parseFloat(b.totalCalculo),impuestos:parseFloat(r.impuestos)+parseFloat(b.impuestoCalculo),iva:parseFloat(r.iva)+parseFloat(b.ivaCalculo),ieps:parseFloat(r.ieps)+parseFloat(b.iepsCalculo),descuento:parseFloat(r.descuento)+parseFloat(b.descuentoCalculo),monedero:parseFloat(r.monedero)+parseFloat(b.monederoCalculo)},e.next=50;break;case 22:if(!s.found||!t._id){e.next=50;break}return O=s.producto_found.producto,x=O.cantidad_venta,(h=Object(fe.a)(O,Ug)).cantidad_venta=parseInt(x)+1,e.next=27,ct(h);case 27:if(!(f=e.sent).found){e.next=43;break}return e.next=31,nt({newP:h,cantidad_venta:x,granel:h.granel_producto,origen:"",precio_boolean:!0,precio:h.precio_actual_object});case 31:return _=e.sent,e.next=34,nt({newP:h,cantidad_venta:h.cantidad_venta,granel:h.granel_producto,origen:"",precio_boolean:!0,precio:f.pricing});case 34:v=e.sent,h.precio_a_vender=v.totalCalculo,h.precio_anterior=h.precio_actual_producto,h.precio_actual_producto=f.pricing,h.precio_actual_object=f.object_prising,i.splice(s.producto_found.index,1,h),o={subTotal:parseFloat(r.subTotal)-parseFloat(_.subtotalCalculo)+v.subtotalCalculo,total:parseFloat(r.total)-parseFloat(_.totalCalculo)+v.totalCalculo,impuestos:parseFloat(r.impuestos)-parseFloat(_.impuestoCalculo)+v.impuestoCalculo,iva:parseFloat(r.iva)-parseFloat(_.ivaCalculo)+v.ivaCalculo,ieps:parseFloat(r.ieps)-parseFloat(_.iepsCalculo)+v.iepsCalculo,descuento:parseFloat(r.descuento)-parseFloat(_.descuentoCalculo)+v.descuentoCalculo,monedero:parseFloat(r.monedero)-parseFloat(_.monederoCalculo)+v.monederoCalculo},e.next=50;break;case 43:return C=h.descuento_activo?h.descuento.precio_neto:h.precio_unidad.precio_neto,e.next=46,nt({newP:h,cantidad:0,granel:l,origen:"Ventas2"});case 46:(y=e.sent).newP.precio_actual_producto=C,i.splice(s.producto_found.index,1,y.newP),o={subTotal:parseFloat(r.subTotal)+parseFloat(y.subtotalCalculo),total:parseFloat(r.total)+y.totalCalculo,impuestos:parseFloat(r.impuestos)+y.impuestoCalculo,iva:parseFloat(r.iva)+y.ivaCalculo,ieps:parseFloat(r.ieps)+y.iepsCalculo,descuento:parseFloat(r.descuento)+y.descuentoCalculo,monedero:parseFloat(r.monedero)+y.monederoCalculo};case 50:localStorage.setItem("DatosVentas",JSON.stringify(Object(u.a)(Object(u.a)({},o),{},{cliente:!0===c.venta_cliente?c.cliente:{},venta_cliente:!0===c.venta_cliente&&c.venta_cliente,productos:i}))),S(Object(u.a)({},o)),m(!p);case 53:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(V.jsxs)(s.Fragment,{children:[Object(V.jsx)(B,{alert:k,setAlert:N}),Object(V.jsx)(b.a,{height:"9%",children:Object(V.jsxs)("div",{className:r.formInputFlex,children:[Object(V.jsxs)(b.a,{width:"100%",display:"flex",justifyItems:"center",alignSelf:"center",justifySelf:"center",alignItems:"center",children:[Object(V.jsx)(b.a,{mt:1,mr:1,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/busqueda-de-codigos-de-barras.svg",alt:"iconoBander",className:r.iconSize})}),Object(V.jsx)(b.a,{width:"100%",children:Object(V.jsxs)(Da.a,{className:r.rootBusqueda,children:[Object(V.jsx)(us.a,{width:"100%",fullWidth:!0,placeholder:"Buscar producto...",onKeyUp:U}),Object(V.jsx)(X.a,{children:Object(V.jsx)(xc.a,{})})]})})]}),Object(V.jsxs)(b.a,{width:"100%",display:"flex",justifyItems:"center",alignSelf:"center",justifySelf:"center",alignItems:"center",children:[Object(V.jsx)(b.a,{mt:1,mr:1,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/usuarios.svg",alt:"iconoBander",className:r.iconSize})}),Object(V.jsx)(b.a,{width:"100%",alignItems:"center",children:Object(V.jsx)(Ag,{sesion:c})})]}),Object(V.jsx)(b.a,{width:"100%",children:Object(V.jsx)(Vg,{})}),Object(V.jsxs)(b.a,{width:"100%",display:"flex",children:[Object(V.jsx)(b.a,{mr:1,children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/ventas/publicalo.svg",alt:"iconoBander",className:r.iconSize})}),Object(V.jsx)(b.a,{width:"100%",children:Object(V.jsx)(G.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(V.jsxs)(De.a,{id:"tipo_documento",name:"tipo_documento",children:[Object(V.jsx)(Ee.a,{value:"",children:Object(V.jsx)("em",{children:"Selecciona uno"})}),Object(V.jsx)(Ee.a,{value:"TICKET",children:"TICKET"}),Object(V.jsx)(Ee.a,{value:"FACTURA",children:"FACTURA"}),Object(V.jsx)(Ee.a,{value:"NOTA REMISION",children:"NOTA REMISION"})]})})})]})]})}),Object(V.jsx)(b.a,{height:"65%",children:Object(V.jsx)(Dg,{setDatosVentasActual:S})}),Object(V.jsx)(b.a,{display:"flex",justifyContent:"flex-end",flexDirection:"column",height:"25%",children:Object(V.jsxs)(Da.a,{elevantion:3,style:{padding:2,marginTop:2},children:[Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsx)(Fe.a,{item:!0,lg:7,children:Object(V.jsxs)(Fe.a,{container:!0,direction:"row",justifyContent:"flex-end",alignItems:"center",children:[Object(V.jsxs)(Fe.a,{item:!0,lg:7,children:[Object(V.jsxs)(b.a,{flexDirection:"row-reverse",display:"flex",alignItems:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsxs)(y.a,{variant:"subtitle1",children:["Cliente: ",Object(V.jsx)("b",{style:{fontSize:16},children:x?x.nombre_cliente:""})]})}),Object(V.jsx)(b.a,{mt:.5,mr:1,children:Object(V.jsx)(Ce.b,{style:{fontSize:19}})})]}),Object(V.jsxs)(b.a,{flexDirection:"row-reverse",display:"flex",alignItems:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsxs)(y.a,{variant:"subtitle1",children:["Cliente.: ",Object(V.jsx)("b",{style:{fontSize:16},children:x?x.numero_cliente:""})]})}),Object(V.jsx)(b.a,{mt:.5,mr:1,children:Object(V.jsx)(Ig.a,{style:{fontSize:22}})})]}),Object(V.jsxs)(b.a,{flexDirection:"row-reverse",display:"flex",alignItems:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsxs)(y.a,{variant:"subtitle1",children:["Clave Clte.: ",Object(V.jsx)("b",{style:{fontSize:16},children:x?x.clave_cliente:""})]})}),Object(V.jsx)(b.a,{mt:.5,mr:1,children:Object(V.jsx)(fh.a,{style:{fontSize:19}})})]})]}),Object(V.jsxs)(Fe.a,{item:!0,lg:5,children:[Object(V.jsxs)(b.a,{flexDirection:"row-reverse",display:"flex",alignItems:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsxs)(y.a,{variant:"subtitle1",children:["Limite Credito: ",Object(V.jsxs)("b",{style:{fontSize:16},children:["$",x?x.limite_credito:0]})]})}),Object(V.jsx)(b.a,{mt:.5,mr:1,children:Object(V.jsx)(fh.b,{style:{fontSize:19}})})]}),"P",Object(V.jsxs)(b.a,{flexDirection:"row-reverse",display:"flex",alignItems:"center",children:[Object(V.jsx)(b.a,{children:Object(V.jsxs)(y.a,{variant:"subtitle1",children:["Dias Credito: ",Object(V.jsxs)("b",{style:{fontSize:16},children:[x?x.dias_credito:0," Dias"]})]})}),Object(V.jsx)(b.a,{mt:.5,mr:1,children:Object(V.jsx)(Ce.c,{style:{fontSize:19}})})]})]})]})}),Object(V.jsx)(Fe.a,{item:!0,lg:5,children:Object(V.jsxs)(Fe.a,{container:!0,children:[Object(V.jsxs)(Fe.a,{item:!0,lg:7,children:[Object(V.jsxs)(b.a,{display:"flex",alignItems:"center",flexDirection:"row-reverse",children:[Object(V.jsx)(b.a,{children:Object(V.jsxs)(y.a,{variant:"subtitle1",children:["Monedero : ",Object(V.jsxs)("b",{style:{fontSize:17},children:["$ ",C?null===C||void 0===C||null===(e=C.monedero)||void 0===e?void 0:e.toFixed(2):0]})]})}),Object(V.jsx)(b.a,{mt:.5,mr:1,children:Object(V.jsx)(Ce.p,{style:{fontSize:19}})})]}),Object(V.jsxs)(b.a,{flexDirection:"row-reverse",alignItems:"center",display:"flex",children:[Object(V.jsx)(b.a,{children:Object(V.jsxs)(y.a,{variant:"subtitle1",children:["Descuento: ",Object(V.jsxs)("b",{style:{fontSize:17},children:["$",C?null===C||void 0===C||null===(t=C.descuento)||void 0===t?void 0:t.toFixed(2):0]})]})}),Object(V.jsx)(b.a,{mt:.5,mr:1,children:Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsx)("img",{src:"https://cafi-sistema-pos.s3.us-west-2.amazonaws.com/Iconos/price-tag.png",alt:"icono admin",style:{width:20}})})})]})]}),Object(V.jsxs)(Fe.a,{item:!0,lg:5,children:[Object(V.jsx)(b.a,{flexDirection:"row-reverse",display:"flex",mr:1,children:Object(V.jsxs)(y.a,{variant:"subtitle1",children:["Subtotal: ",Object(V.jsxs)("b",{style:{fontSize:17},children:["$ ",(null===C||void 0===C?void 0:C.subTotal)?null===C||void 0===C||null===(a=C.subTotal)||void 0===a?void 0:a.toFixed(2):0]})]})}),Object(V.jsx)(b.a,{display:"flex",flexDirection:"row-reverse",mr:1,children:Object(V.jsxs)(y.a,{variant:"subtitle1",children:["Impuestos: ",Object(V.jsxs)("b",{style:{fontSize:17},children:["$ ",(null===C||void 0===C?void 0:C.impuestos)?null===C||void 0===C||null===(n=C.impuestos)||void 0===n?void 0:n.toFixed(2):0]})]})})]})]})})]}),Object(V.jsxs)(b.a,{display:"flex",flexDirection:"row-reverse",p:1,children:[Object(V.jsxs)(y.a,{variant:"h4",children:["Total: ",Object(V.jsxs)("b",{style:{color:"green"},children:["$",(null===C||void 0===C?void 0:C.total)?null===C||void 0===C?void 0:C.total.toFixed(2):0]})]}),Object(V.jsx)(b.a,{mt:.5,mr:1,children:Object(V.jsx)(Mh.a,{style:{fontSize:37,color:"green"}})}),Object(V.jsx)(b.a,{p:1,children:Object(V.jsx)(tf,{type:"GENERAR"})})]})]})})]})}function Jg(){var e=Object(s.useContext)(Ch),t=e.turnoActivo,a=e.setTurnoActivo,n=Object(s.useState)(!1),c=Object(v.a)(n,2),r=c[0],i=c[1],o=JSON.parse(localStorage.getItem("turnoEnCurso"));return Object(s.useEffect)((function(){var e=JSON.parse(localStorage.getItem("sesionCafi"));i(e.turno_en_caja_activo),a(!1)}),[t]),Object(V.jsx)(ji,{children:!0===r&&o?Object(V.jsx)(Bg,{}):Object(V.jsx)(Gg,{})})}function Gg(){var e=Object(s.useState)(!1),t=Object(v.a)(e,2),a=t[0],n=t[1];return a?Object(V.jsx)(b.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:Object(V.jsx)(I.a,{})}):Object(V.jsx)(Fe.a,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",children:Object(V.jsx)(b.a,{mt:5,children:Object(V.jsxs)(Da.a,{elevation:5,children:[Object(V.jsx)(b.a,{p:2,textAlign:"center",children:Object(V.jsx)(y.a,{variant:"h6",children:"Si deseas realizar ventas inicia tu turno primeramente."})}),Object(V.jsx)(Ih,{type:"FRENTE",setLoading:n})]})})})}var qg=Object(k.a)((function(e){return{root:{display:"flex"},content:{flexGrow:1},toolbar:{height:e.spacing(9)}}}));var Hg=a.p+"static/media/logochafa.744b44f9.PNG",Yg=a.p+"static/media/admin.cecfcd64.svg",Xg=a.p+"static/media/cart-add.d563c74d.svg",Kg=a(473),Qg=a.n(Kg),Zg=Object(k.a)((function(e){return{icon:{width:150,fontSize:150}}}));var e_=[{path:"/",component:function(e){var t=te(),a=localStorage.getItem("sesionCafi"),n=Object(s.useState)([]),c=Object(v.a)(n,2),r=c[0],i=c[1],o=Object(s.useState)(!1),l=Object(v.a)(o,2),d=l[0],j=l[1],p=Object(s.useState)({message:"",status:"",open:!1}),m=Object(v.a)(p,2),O=m[0],x=m[1],f=Object(s.useState)(!1),k=Object(v.a)(f,2),F=k[0],z=k[1];a&&e.history.push("/ventas/venta-general");var P=Object(N.a)(A),D=Object(v.a)(P,1)[0],E=function(){var t=Object(_.a)(g.a.mark((function t(a){var n,c,i;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),r.numero_usuario&&r.password){t.next=4;break}return x({message:"Los campos estan vac\xedos",status:"error",open:!0}),t.abrupt("return");case 4:return j(!0),t.prev=5,t.next=8,D({variables:{input:r}});case 8:n=t.sent,c=n.data.logearUsuario.token,i=Object(J.a)(c),j(!1),localStorage.setItem("sesionCafi",JSON.stringify(i)),localStorage.setItem("tokenCafi",JSON.stringify(c)),e.history.push("/ventas/venta-general"),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(5),x({message:t.t0.message,status:"error",open:!0}),j(!1);case 21:case"end":return t.stop()}}),t,null,[[5,17]])})));return function(e){return t.apply(this,arguments)}}(),T=function(e){"numero_usuario"===e.target.name?i(Object(u.a)(Object(u.a)({},r),{},Object(h.a)({},e.target.name,parseInt(e.target.value)))):i(Object(u.a)(Object(u.a)({},r),{},Object(h.a)({},e.target.name,e.target.value)))};return Object(V.jsxs)(C.a,{maxWidth:"sm",children:[Object(V.jsx)(B,{alert:O,setAlert:x}),Object(V.jsx)(b.a,{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",children:Object(V.jsxs)(b.a,{boxShadow:"3",p:3,width:"80%",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",alignItems:"center",justifyItems:"center",children:Object(V.jsx)(b.a,{className:t.containerImagen,textAlign:"center",children:Object(V.jsx)("img",{className:t.imagen,src:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAkFBMVEX///8AAAD7+/t1dXXU1NSCgYFbW1vOzs7e3t7q6urt7e34+Pj09PTi4uLn5+f5+fnExMSpqak7Ozu+vr6xsbHS0tKenp6Pj4+YmJhXV1e3t7eJiYmvr6+oqKhdXV27u7spKSkuLi5zc3NISEhpaGgeHh4XFhZAPz81NTV8fHxPT08iIiIrKysREBBlZGQZGRh0tFriAAAUSElEQVR4nO1d63qquhaNCOUi0CgIyKV4ayu22vd/uzMDiSIGCAq69ncce//o0ghzkGTeMkMQeuGFF1544YUXXnjhhRdeeOGFF1544f8EkjXHruevjx+LxdvHcex7IZbtZ0vVDywcrGejOmzGHtafLeLtMJxoU8utjIWP358tbGdMnOwgxI5hFanPlrkDbE+s76r4iM1niy4Cw6ufdu3Yx5NnE2hBuK+XfrU/jhWC9XGzrG92xM8mUQ874kn8efRjVbsef4amJtHii/OLr+DfHK3zt2ty40RuE9aYe8drpbS2HiJzF+DvKrssFTfpVrytcvyQB5S2O/DuUrxZoHW+hhz9XF5k8e9wnF/238671R/T/M/Lfvw3xqr1cSGV0r33ylAvh2v2fJ0jXejPnSvdfUXTu+jIpAch74FTVoOLvhyvtOw07J45HY1jSZLjfcPzEmrZ71N6vHA3hGWl0Cc/ArWkvj7nPV9cDO8lnTAbYiSlpfkYDXD9Nsglfysc6B7B+RbfDw+UvdI0uV9/1qE80Z3B7sLF+c6rvifgJfBzRqpx9q/8oe8lrc/WaLjBUsH8rOSG7cAC5278edBkTE93XD/mhubZOD7iiZZ0jPuI2+XwT/d8QAJAYfc6PNLxx497rGN2p83Dpn0O/WR+42FvdFJs42Hvcw3plOOaDnmbUw8GQ96lBtsHUFQe8hjbbz/YXDxptHSoO7Tg5KcO5MHFD9TYNThZqkGiYvx8ggglTIgBFh+1gUeIINhAPfS+vmEye/Q4R4YPlvna9H1hZo28vi/cGcwkZ/1elj25Z2QTqlgMMZocetG3Pi96M9jSXI+OsUEvuervkveAibPs75IsPjP6u+RdUKk8vTnHTEP/O7UEzPL3ZJqZJWxPyWhyBfOrKhJrXm1zBUsgV8FWY/uxijthAzS6wpV7kF234eDvzXcavRaJNtzeTusMNiLaJ6F6LerVkoNy3aYOP36DsmTZsB7GqU4vJWB9OIUKh2qbDgwBm/qpTy/0dRe5HHT980Og6YojY7UbujEEjrVDh7qRdydsWUQhYCh0noTVrEpXhvXjUKbf3xtl0Oy2SFA/5clXVQU8hqsoLyTKPjjfjepXgWlK5XgfQRqPfYu05QsowPA8AzC3YqwmpcD06X2Li/QiQiE1vwcqP+UxLHu73LKqGgNJkw53xVHUmxHK3mOebFdZuTaG3AZ1HKilvsNivNM7CPmjNTpk097qMmLhFfXVGA1qgGc3kctBu1AsKPzkSEZw6Vi1Mww5Leps1eLeTuTKWAO7hmDl9u0MJU6LUU3hEHWZhRQhD1SRitnUhCcYwaXj1s4QHTlN6nqJtr016jk0Pr8KFhy5cvxcNBNgyHtWdU+ZdqKIx8UBTV0IpmbqCFacDgGGPKVcG0PQB3tbQoNG9mKBfY2tILjw2QUYWpwmteqSqtObyqaslqd3iQZ/c9vWrsKQ599eDvUyqE28ZTWTeheCKwRUkvGKI165nQBDg9Pks/bGbtHglqKl4peC1pSNLJWnCMvlBTcyrO9D6pXsuxOkE0twTZklAiSeIiznyW8cpQ2+J82LdC9EoSuugqmePROEpybKz/dGTdOQwteuH6MYit8J6hnmh3h8561kUW+0Fk3xaaFrOjun9DaCHh8TSiuttpdQcjkEGMacJk32js6QrrE+XeERbE3nwqFGvpLTIMCQk3DcNd2cesRdh2nxK9G0+ejcnOeBl9Y7BBhy4vzmRF/xg47alKZ5BAcpy4rn+V9efHdWdO0MOY9o2Xx7GuR126VJfyToKVwkjcfXEpbscTtDTh6jxevQSs9XGEUZ+UKwNfVgC3XGi2DPaZBWhhx737rlotDfnRaFJ8WlBSevSSUpUjI8g/0nzvB6A2N7/VWhFn87EGQeu2A1J1shpoNpdyVj6UptDK+3+AkMPjpsuuwgotNQsDWbeQ0kTqOhMV86ia92Iu5FgjeqnLqka94u79wCKgzzf5yqlKOSKucx/PtY5Pi7+qZhZeYCRWa+yxJGcX3BAkS2gMAUJi82OPm3HdYtDuLb4ApHSlQxolOvCz5Atgh+Mnq81Dy7ljDDTZfSNWquxH9AFY1gYQLdoHR2XHyOwGwEdejDb1+Y5LyTwKjjI2GD8jwLOGvBJ9e/2+rarycWvVELJa5qCt9XsDyIbU44j2mTJ6xxC8ORqPoolJR4YW8x7gTzV6zOrPQR76URaT3DhWkQ2NqUlwMR6pnijuJeTWGVBBMYVI6yaQk4co7rGZZ+avC+F3jUypUMjaCjTEyVMltRfh5zjpjLeoYX04E3idvnS6E5/lrbUdBEiZg1Yv1VDrEnHClpmN4eW8icFq2dQ5WBKEN6D7HQiRq/y8fHW8RIBBly6wHanI9OIp+yLkJtma24nCseR8g3UYZcj6FlQNFhJ7p8Me3AkEWDlwpP48hYxOAiDHmObctiPX3QokULxdRqzP6cwFJrlY95DOeiDCXeC5ia9Z7Ee871KPIIYn4svX+1Ma/yxBdleN5dVUJL5raokBJdvViLXLIAU3zVRAMvub8RZsjLSLZk34tEhmhGsegAoRIT5mRXpzh3IpqiDLm/bh6mRYZPdMNZoeuFXCCasbgqQeQm9x1RhtwIs1n6QhDRGHgvzJBbrFeLsShD6TrabxtTBUPRzRLiDLkTpha/ogzRitOq2V7MBmLIjQXqYYsy5Nn8ZuvVrQ+F5yG3uKcBU1GG1ddqETRv9ug2D4V1KS+GaMLxnj5sZlhk20R16ZqJ0wZeQqYR98zD5lFa6CbRVy4J+zS87HYjZDGG7zy3rXn1rPBpRLfvivqlbB1scbWTBKDxVtmCO+xho16gFRmifiktUWltx2wFf/2SV+27EWPIi/ObPTJqmEXTj6LxIXOv+WlKbh2YGEPu/G6MjKifJ7qWT5u3pSpZrqJmOHNTGSqvZ68Yrng/bRSHRgCCBEXzNGws1ZlZXk4x4nVPlSF3kDar9rAbQ/r026Yt6446p5+XU9yIMOTZ+5bQorjXUowfYvnSNuPCbEXd97yk2YhnyysMeU+mrdC5yNKLby4pxldLIpbZivrL8iTl4ZIhv5y6JQMzE5G4hELhtRSosKRffWq8ZpdPI0OTl8Fol/2rRZQq6GNsbsRW3OuXtGqL2ys45XsNlVeqMmr3r7oteKKTMmssaGTGoKFijpuM4OCwyrHkxb05WsudqMDipQrUa2pUpsygN4Vkggzb0B7HdausOIvWGG0x56RpZPDnVEd8Coy9YsZ32adX5HkbB8cvFaBpqYBXHtURK6F3QxTju8urndqXuVkhb+Nz48YIHbCMxFxpKkyXehpqrBuuz8xy88Lyzdw+F2MPCysOGuR02pFQ/OQZb/S6BUVCrFsddJFuu3lP2INReJnd3ixDJ+Lz36Ytgm7lvhTUWNftMX4W+OLQeKXjcyl+xNeUDbu4BgY/ZF3l33XdoUcNOvepcSPU5zGk463rGyMpC+4w/ccY0kHaWWcUP+NWsvxjDIt0d/dd+XRfBy82KhjupqEyOnjp9O+I16MvDLFSMHoL3UWGP0bw8WGdgr3JcBqGP15IlLOPw9BzwDxjZ41DJ5jhFH4dOGGYfcfuevSHg1EEX0Qjxx1leP+J4VcefL3eu+62jiF93t1fVknXJHhZyuKa5myEt7Yx0iYZeDh/ZDrgNcxfOURj3R5ppg8f7z3SWlZGUUhWSBckMUfMbICyBbKQM5JsDAH6jwTSzxQkjVy03aJ4YgKZJL+mBtHtLv+6hiF1728wbMUPl3UMdyhc/SjgXCcI5wzBKmEDRMlClCAXninEBMtNQFqb2n60IJP6jTAcB+/IhzGCSCmTPsHoG/Rg8vn9h+HPGB1XCJvGnyNZB8JQhlG4Rt4hP16Iw5CWqN3y/g/qeXJil6IP5yCgAi6hhwzGUM3vNwXKCcljRUjbBUhPFPD+tBVhmMbbGKWuCgyDAIXIwtIbRmH8YxPnUs2QnyBH11aSnq01NCsYxvHSpD4IhyH1TW556QANDDgJhJzhYecbwI0wtIDh54nhbA6iT4GhSaQLiPXcgbgWYbgfbSJTmhKGqTLboHSGPAet4GLeBDnBD5p76Aj/v1vhT4KUguFo9DVLpFwxcBgWeua2Vw3RRNJ1JVXOcAGSm3P4O4RJBQqbUMAaWo4iCToPA514dQBVTlqTryYFw5kfoqOcj1J4eDAPrRTtRuOEuCSJZ0oJmYeJaWieC0NBLhj6PjxBj8uQ1k/dFiNQJXW9f634QvV9c6OYsekrSE5imHd4PdOtxI3RWDFiM/Jm4Az7MEoTK8l0n2gaZ+oEWwSCBiSfvIAHIZkqCqexHAWGTdZ4DLT9QOqEzBG4k5kkJnKn8VxJDP48/K5X+QKgYfxVQopS338Qnx5U3NdyNYM75Rni39Xo7/eQf0wKTn6/lr+z2eH7SK71udzNZn+j5ehn+fX7BQP99xP+/PmBT0eLBWl/WC6Xh9Fy+UPowFfw29+f2Ww3elvw7SEV5daXw9MkxFUi6B+y+Juaz0VBl2KrnfjvMKSSdNhKUgFN6VZnorYdPwfb6vogXQW5401RNY/uX0F6bxee1ibuucSQ+Lq7C1ki8qkvuK4H9bpufDkNBR0H9S/eeATkwFeyYzTeRkqinhe7jX7mELWogx8nUwvDjzycosAGXxBLEQ62n+MkDyQ2fD3YFWz96Enn9JnKWAutCXr/0BLoK5XYZnVuBgpoVVqxc3c+kK7o3fFOtDsQf+uIuJz2h70FNxXNSRGuoyLLGUdmERref7YeWyd8Rv5bmYKzkYTpWoHe3ALRN7KjwZEdMvUih+TL+njyYT8TujuCSAISqYxQHt7ax0yJkQQCWUS1mzqGh97PaaV0i8+yj2t1QKYjG6Jj+Gue5Fpg7qiqip10vvaQ5CtbSe3r9EemlR90uhNFNNFjLUSqjPQ5AgVjxhqSMcYWMPWjtYUmx3nQ11v+aSXf0Kf0XCCUVRWm3BTHZKhC8JgiB4MChYgZAkqYMR/RXgUPuafbHR8+Fc2to2nSPB+dMFDjEJv0iFPTMqdoimQXaclWtXo6ymDCqiQethblT2ysp4X+VsEqOhLd8IOzsY4SlEaEb2Zpck9nL7ICrkdZRQMmGLhnMvThdDpV1s57sZxvREmuWbGeKwUFqXbS08BixT/3ebnC8CZIdRyk4jSNNFm2sAbTUrOj/Jhnc2srSp7khCGq4r4MNSscecy5rpmpakgLUwdhYvssC/shfguQnitP2w9DFcsTRKK6ifh7CVrAigof4duA+LZG0mfqewL608DSHOyFB1ogg7Grh7L5bk4MnMbwaZAFPZ00a7L6+QecNJMQr4XcR5eAg7/2DQ3GTqgiYw3uqYpwiFUM/1TTdSaT6dgPTlVqw58j7YMvkxYp0CSDf7jbheekzluWocnClsMiRjRdy85Dc6uvQ9JOi9uD96Ivm5NT0okot1h2nBTPXbJ+EZwDOXlu5ZMw6+vwp1MR19Bz0QMLQOIk3c1w6gbIVTExf1qamtZbObc5t1P4YtqfPKed8gMfiuRDX0ngI8boPYV/xSpVl+8pPubjUvMDP+/kUMJoGvaYgTjtsx/WC7fCd4wkJ4CpCIS2KvSno5A1OktdELfKc2QPeTGK7ImMHQW5PZ7CdqLY+6FgZUCfGe40JHKHXnZUTQTmHxkKccXfPNV113EiI7zGQRbrXmriPh3mU2Xz5wCn1zFYnjZBRQZzoSFMRir5G0J7FSPdH8uYKKAJDKTENd1o4vd6zBwLpQZNokbgvMi5zgR7CG7NJFffugsWUCL/Bj2Av7/hGWeanm7Uab/nNJ0rooZLMWpElZH8Re5mkwCRfKrOEZmSYOq3WgjxvupqimXM7W3Q87mv550im8GiKWMM4aAeQti7WytgKvIIAuYhDsFBDn1fdueGgcN5puB1gEy/50MZjXNR/XDHPVq+4kEnYhl9qMSHiwJlggx1G2I9iTQ6Q0JZcU1QuXJPrukJ0vn9M9tubw3tBBMHY4gLgwQTK09sfojXMDXeie4xYhL0h0DVBsvR/4lwpU12Q57aacB8NDLk4tzkGy625ZGWT0zV1y3FRjp8g320HmC6lCowF8Od6U4Uzha6L52D4+2oGNSrHwUkZszjCTIx8XjpTftKSF3AKO2hG0ypkgtvLaQuPmKM0/EHGI2xShiq+cRzdeR4LjLVgQ5HLW8lHOAWkq8AEfhvHHhSAr3phEgej7G5IAxzC5gzzGzUfArdHZBL27V/+56O0wN5u1YEGgUl2CGRMIk4TNkJPDIPz6MURm0wXA6wvKt31yNHKckXsCeEQ4qIoowsI1sjM/B3cqFpAsOmmiYNej5W9gJaeUfrMr7llIlrmGy7ioaSFE2Az8RQow/FO2ZzkgKWcmuRxJPCWhh/A7rIqPoCl+j+m2nn/WAQ3mOYjBay5dSVkamr8kQNweLL1OKn8yg0g6ED8snlBvRFeo8PYE4vtjmvif+G5qBWNAPUpykbthltbN9XU1nX1VQdp4pyGH6xwa7swhvf6OqbTmVfrUI0iJk5+sR0TCtQPPXNzxRws9daigGptla2wSDnrFehVU5EOKydrupNd6vbhhXmismJl8RJSByLyFHTce4J4MUe+q7noKIJ1tVuyk0wF2VpYP/qNSkK19VUEm+6H0cwSN4cDVRo8sh9SzrnlRe7KNSap6UpT7Prt6Ac6t6uiyNPxdNs5yaeg1zHi3o/RL4R0pT7wpqfYzRVNftSFtOSsRe9cTc37xssKy5WDLUE2UmUPOGQabnxvN+v3w3ge8l7wc6p+/wWgwM+m7ZVIt8dzuFvAeadwyKKTCCU9cMH6pcaYLGTmyv4iQQj9X+jGFRLRN8ZUWAbP23Q3QHN5R5SVsW3kg7rWA4MzQnGvHfxEOwzDz+pJLB/GJrquJ7vR1Hk+17oqNp/Y4/xCy+88MILL7zwwgsvvPDCCy+88MILPeJ/6rkiEY2oJj0AAAAASUVORK5CYII=",alt:"imagen no disponible"})})}),Object(V.jsx)(b.a,{display:"flex",textAlign:"center",justifyContent:"center",children:Object(V.jsx)(y.a,{variant:"h4",component:"p",className:t.margin,children:Object(V.jsx)("b",{children:"Inicia sesi\xf3n"})})}),Object(V.jsxs)("form",{autoComplete:"off",onSubmit:E,children:[Object(V.jsx)(S.a,{label:"Numero de usuario",variant:"outlined",name:"numero_usuario",fullWidth:!0,className:t.margin,onChange:T}),Object(V.jsxs)(G.a,{variant:"outlined",name:"password",className:t.margin,fullWidth:!0,children:[Object(V.jsx)(q.a,{htmlFor:"usuario-password",children:"Contrase\xf1a"}),Object(V.jsx)(H.a,{name:"password",id:"usuario-password",type:F?"text":"password",onChange:T,endAdornment:Object(V.jsx)(Y.a,{position:"end",children:Object(V.jsx)(X.a,{onClick:function(){z(!F)},onMouseDown:function(e){e.preventDefault()},edge:"end",children:F?Object(V.jsx)(Q.a,{}):Object(V.jsx)(ee.a,{})})}),labelWidth:70})]}),Object(V.jsx)(w.a,{fullWidth:!0,size:"large",variant:"contained",disableElevation:!0,className:t.margin,color:"primary",type:"submit",endIcon:d?Object(V.jsx)(I.a,{size:25,color:"inherit"}):null,children:"Entrar"})]})]})})]})},exact:!0},{path:"/home",component:function(e){var t=Zg();return JSON.parse(localStorage.getItem("sesionCafi"))||e.history.push("/"),Object(V.jsx)(C.a,{maxWidth:"md",children:Object(V.jsxs)(b.a,{height:"90vh",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",children:Object(V.jsx)("img",{alt:"logo ab",src:Hg})}),Object(V.jsxs)(b.a,{display:"flex",justifyContent:"center",my:6,children:[Object(V.jsx)(w.a,{component:O.b,to:"/admin/inicio",children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",textAlign:"center",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",children:Object(V.jsx)("img",{src:Yg,alt:"icono numero calzado",className:t.icon})}),"Admin"]})}),Object(V.jsx)(w.a,{component:O.b,to:"/ventas/venta-general",children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",textAlign:"center",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",children:Object(V.jsx)("img",{src:Xg,alt:"icono numero calzado",className:t.icon})}),"Ventas"]})}),Object(V.jsx)(w.a,{color:"secondary",onClick:function(){localStorage.removeItem("sesionCafi"),localStorage.removeItem("tokenCafi"),e.history.push("/")},children:Object(V.jsxs)(b.a,{display:"flex",flexDirection:"column",textAlign:"center",children:[Object(V.jsx)(b.a,{display:"flex",justifyContent:"center",children:Object(V.jsx)(Qg.a,{className:t.icon})}),"Cerrar sesion"]})})]})]})})},exact:!0},{path:"/admin",component:function(e){return localStorage.getItem("sesionCafi")||e.history.push("/"),Object(V.jsx)("div",{children:Object(V.jsxs)(he,{children:[Object(V.jsx)(xh,{}),Object(V.jsx)(uh,{})]})})},exact:!1,routes:[{path:"/admin/inicio",component:uh,exact:!0}]},{path:"/ventas/venta-general",component:function(e){return qg(),localStorage.getItem("sesionCafi")||e.history.push("/"),Object(V.jsx)(b.a,{height:"100vh",children:Object(V.jsxs)(yh,{children:[Object(V.jsx)(Fe.a,{lg:12,style:{height:"10vh"},children:Object(V.jsx)(yf,{})}),Object(V.jsxs)(Fe.a,{container:!0,style:{height:"90vh"},children:[Object(V.jsx)(Fe.a,{lg:9,children:Object(V.jsx)(Jg,{})}),Object(V.jsx)(Fe.a,{lg:3,children:Object(V.jsx)(wg,{})})]})]})})},exact:!1}],t_=e_,a_=a(263),n_=a(476),c_=Object(n_.a)({palette:{navbar:mh.a[50],primary:{main:a_.a[500]},secondary:{main:"#f50057"}}}),r_=a(234),i_=a(921),o_=a(915),s_=a.n(o_)()({uri:"https://cafi-punto-venta.herokuapp.com/"}),l_=new r_.a({connectToDevTools:!0,cache:new i_.a({addTypename:!1}),link:s_}),d_=a(916);function j_(e){return Object(V.jsx)(x.a,{path:e.path,exact:e.exact,render:function(t){return Object(V.jsx)(e.component,Object(u.a)({routes:e.routes},t))}})}var u_=function(){return Object(V.jsx)(b.a,{height:"100vh",children:Object(V.jsx)(d_.a,{client:l_,children:Object(V.jsx)("div",{className:"App",children:Object(V.jsxs)(p.a,{theme:c_,children:[Object(V.jsx)(m.a,{}),Object(V.jsx)(O.a,{children:Object(V.jsx)(x.c,{children:t_.map((function(e,t){return Object(V.jsx)(j_,Object(u.a)({},e),t)}))})})]})})})})},b_=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,940)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;a(e),n(e),c(e),r(e),i(e)}))};a(783);j.a.render(Object(V.jsx)(u_,{}),document.getElementById("root")),b_()}},[[784,1,2]]]);
//# sourceMappingURL=main.6c36900c.chunk.js.map